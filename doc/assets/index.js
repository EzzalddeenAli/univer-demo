var t,e,n=Object.defineProperty,i=Object.defineProperties,o=Object.getOwnPropertyDescriptors,s=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(t,e,i)=>e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,h=(t,e)=>{for(var n in e||(e={}))r.call(e,n)&&l(t,n,e[n]);if(s)for(var n of s(e))a.call(e,n)&&l(t,n,e[n]);return t},c=(t,e)=>i(t,o(e));import{n as d,a as u,d as g,F as _,k as p,w as m,b as T,y as f,_ as v,O as E,H as I,c as b,e as A,f as C,B as S}from"./vendor.js";(e=t||(t={}))[e.OBSERVER_ACTION=1]="OBSERVER_ACTION",e[e.SERVER_ACTION=2]="SERVER_ACTION",e[e.UNDO_ACTION=3]="UNDO_ACTION",e[e.EXTENSION_ACTION=4]="EXTENSION_ACTION",e[e.DEFAULT_ACTION=7]="DEFAULT_ACTION";class N{constructor(t,e){this._doActionData=t,this._observers=e,this._operation=1}getDoActionData(){return this._doActionData}getOldActionData(){return this._oldActionData}hasOperation(t){return(this._operation&t)===t}addOperation(t){this._operation|=t}removeOperation(t){this._operation&=~t}}class R{constructor(t=!1){this.isStopPropagation=!1,this.initialize(t)}initialize(t=!1){return this.skipNextObservers=t,this}stopPropagation(){this.isStopPropagation=!0}}class w{constructor(t){this.callback=t,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class O{constructor(t){this._observers=new Array,this._eventState=new R,t&&(this._onObserverAdded=t)}get observers(){return this._observers}add(t,e=!1,n=!1){if(!t)return null;const i=new w(t);return i.unregisterOnNextCall=n,e?this._observers.unshift(i):this._observers.push(i),this._onObserverAdded&&this._onObserverAdded(i),i}addOnce(t){return this.add(t,void 0,!0)}remove(t){if(!t)return!1;return-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0)}removeCallback(t){for(let e=0;e<this._observers.length;e++){const n=this._observers[e];if(!n._willBeUnregistered&&n.callback===t)return this._deferUnregister(n),!0}return!1}makeObserverTopPriority(t){this._remove(t),this._observers.unshift(t)}makeObserverBottomPriority(t){this._remove(t),this._observers.push(t)}notifyObservers(t){if(!this._observers.length)return null;const e=this._eventState;e.skipNextObservers=!1,e.lastReturnValue=t,e.isStopPropagation=!1;let n=!1;for(let i=0;i<this._observers.length;i++){const o=this._observers[i];if(!o._willBeUnregistered&&(e.lastReturnValue=o.callback(t,e),o.unregisterOnNextCall&&this._deferUnregister(o),e.isStopPropagation&&(n=!0),e.skipNextObservers))return{lastReturnValue:e.lastReturnValue,stopPropagation:n}}return{lastReturnValue:e.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(t){let e=Promise.resolve(t);if(!this._observers.length)return e;const n=this._eventState;n.skipNextObservers=!1;for(let i=0;i<this._observers.length;i++){const o=this._observers[i];n.skipNextObservers||(o._willBeUnregistered||(e=e.then((()=>o.callback(t,n))),o.unregisterOnNextCall&&this._deferUnregister(o)))}return e.then((()=>t))}notifyObserver(t,e){if(t._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,t.callback(e,n),t.unregisterOnNextCall&&this._deferUnregister(t),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const t=new O;return t._observers=this._observers.slice(0),t}_deferUnregister(t){t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,setTimeout((()=>{this._remove(t)}),0)}_remove(t){if(!t)return!1;const e=this._observers.indexOf(t);return-1!==e&&(this._observers.splice(e,1),!0)}}class y{constructor(t,e){this.name=t,this.observableHooks=e}}class M{constructor(){this._observableHooksArray=new Array}addHooks(t,e){this._observableHooksArray.push(new y(t,e))}getHooks(t){const e=this._observableHooksArray.find((e=>e.name===t));return e?e.observableHooks:null}}const D=t=>null!=t,L=t=>{let e=Object.keys(t),n=/^\d+$/,i=0;for(let o=0;o<e.length;o++){let t=e[o];if(!n.test(t))return-1;let s=parseInt(t)+1;s>i&&(i=s)}return i};class x{constructor(...t){switch(t.length){case 0:return this._array={},void(this._length=0);case 1:{if("number"==typeof t[0])return this._array={},void(this._length=t[0]);const e=L(t[0]);if(e>-1)return this._array=t[0],void(this._length=e);throw new Error(`create object array error ${JSON.stringify(t[0])}`)}case 2:if(L(t[0])>-1)return this._array=t[0],void(this._length=t[1]);throw new Error(`create object array error ${JSON.stringify(t[0])}`)}}static objectKeys(t){if(t){const e=Object.keys(t),n=e.indexOf("length");return n>-1&&e.splice(n,1),e}return[]}static getMaxLength(t){if(t){if(t.length)return t.length;const e=x.objectKeys(t);if(e.length)return Math.max(...e)+1}return 0}obtain(t,e){var n;return null!=(n=this._array[t])?n:e}getKeys(){return x.objectKeys(this._array)}get(t){return this._array[t]}set(t,e){if(D(e)){const n=this._length;this._array[t]=e,t>=n&&(this._length=t+1)}}pop(){const t=this._length,e=this._array;if(t>0){const n=t-1,i=e[n];return n>0&&(delete e[n],this._length--),i}return null}push(t){if(D(t)){let e=this._length;this._array[e++]=t,this._length=e}}first(){return this._array[0]}last(){const t=this._length-1;return this._array[t]}shift(){const t=this._length;if(t>0){const e=this._array[0],n=t-1;let i;for(let t=0;t<n;t++)i=this._array[t+1],D(i)&&(this._array[t]=i);return this._length--,delete this._array[n],e}return null}unshift(t){if(D(t)){const e=this._length,n=this._array,i=e+1;let o=n[0];for(let t=1;t<i;t++){const e=this._array[t];D(o)&&(n[t]=o),o=e}n[0]=t,this._length=i}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const t=this._array;return Object.keys(t).length}toJSON(){return this._array}toArray(){const t=new Array,e=this._array,n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){const i=+n[o];t[i]=e[i]}return t}forEach(t){const e=this._array,n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){const i=+n[o];if(!1===t(i,e[i]))return this}return this}clone(t){const e=new x;return t?this.forEach(((n,i)=>{e.set(n,t(i))})):this.forEach(((t,n)=>{e.set(t,n)})),e}isEmpty(){const t=this._array;return 0===Object.keys(t).length}delete(t){this.splice(t,1)}includes(t){const e=this._array,n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){if(e[+n[o]]===t)return!0}return!1}slice(t,e){const n=this._array;if(this._length>0){const i={};let o=0;for(let s=t;s<e;s++){const t=n[s];D(t)&&(i[o]=n[s],o++)}return new x(i,o)}return new x}concat(t){const e=this._array,n=Object.keys(e),i=n.length,o=t._array,s=Object.keys(o),r=s.length,a=new x(i+r),l=a._array;let h=0;for(let c=0;c<i;c++,h++){const t=n[c];l[h]=e[t]}for(let c=0;c<r;c++,h++){const t=s[c];l[h]=o[t]}return a}find(t){const e=this._array,n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){const i=+n[o],s=e[i];if(!0===t(i,s))return s}return null}splice(t,e){const n=this._length;if(n>0){const i=t+e,o=this._array;let s=0;const r={};for(let e=t;e<i;e++){const t=o[e];D(t)&&(delete o[e],r[s]=t,s++)}const a=i-t,l=n;if(this._length-=a,this._length<=0)this._array={},this._length=0;else for(let t=i;t<l;t++){const e=o[t];D(e)&&(o[t-a]=o[t],delete o[t])}return new x(r,s)}return new x}findIndex(t){const e=this._array,n=Object.keys(e),i=n.length;for(let o=0;o<i;o++){const i=+n[o];if(!0===t(i,e[i]))return o}return-1}map(t){const e=this._array,n=Object.keys(e),i=n.length,o={};for(let s=0;s<i;s++){const i=e[+n[s]];o[s]=t(i)}return new x(o)}filter(t){const e=this._array,n=Object.keys(e),i=n.length,o={};let s=0;for(let r=0;r<i;r++){const i=+n[r],a=e[i];t(i,a)&&(o[s]=a,s++)}return new x(o,s)}insert(t,e){const n=this._length,i=this._array;for(let o=n-1;o>=t;o--)i[o+1]=i[o];return i[t]=e,this._length=n+1,this}inserts(t,e){const n=e._array,i=e._length,o=this._array;for(let s=this._length-1;s>=t;s--){const t=o[s];D(t)&&(delete o[s],o[s+i]=t)}for(let s=0;s<i;s++){const e=n[s];D(e)&&(o[s+t]=n[s])}return this._length+=i,this}[Symbol.iterator](){return new k(this)}}class k{constructor(t){this._array=t,this._keys=t.getKeys(),this._cursor=0}next(){const t=this._array,e=this._keys,n=this._cursor;if(n<e.length){const i=e[n],o=t.get(+i);return this._cursor++,{value:o,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new k(this._array)}}class H{constructor(t={}){this._matrix=t,this._option=new x(t)}static MakeObjectMatrixSize(t){return new H({[t-1]:{}})}getMatrix(){return this._matrix}forEach(t){const e=this._option.getKeys();for(let n=0;n<e.length;n++){const i=+e[n];if(!1===t(i,this.getRow(i)))return this}return this}forValue(t){const e=this._option.getKeys();for(let n=0;n<e.length;n++){const i=+e[n],o=this.getRow(i),s=o.getKeys(),r=s.length;for(let e=0;e<r;e++){const n=+s[e];if(!1===t(i,n,o.get(n)))return this}}return this}swapRow(t,e){const n=this._option.get(t),i=this._option.get(e);this._option.set(e,n),this._option.set(t,i)}getRow(t){let e=this._option.get(t);if(e)return new x(e)}getRowOrCreate(t){let e=this.getRow(t);if(null==e){let e={};return this._option.set(t,e),new x(e)}return e}reset(){this._matrix={}}hasValue(){const t=this._option;for(const e of t)if(!new x(e).isEmpty())return!0;return!1}getValue(t,e){const n=this.getRow(t);return n?n.get(e):null}setValue(t,e,n){this.getRowOrCreate(t).set(e,n)}deleteValue(t,e){const n=this.getRow(t);n&&n.delete(e)}spliceRows(t,e){const n=this._option.splice(t,e);return new H(n.toJSON())}pushRow(t){this._option.push(t.toJSON())}insertRow(t,e){this._option.insert(t,e.toJSON())}insertRows(t,e){this._option.inserts(t,e._option),console.dir(this._option)}spliceColumns(t,e){const n=new H;return this._option.forEach(((i,o)=>{for(let r=t;r<t+e;r++)n.setValue(i,r-t,this.getValue(i,r));let s=this._option.get(i);s&&new x(s).splice(t,e)})),n}insertColumns(t,e){let n=0;e.forEach((t=>{const i=e.getRow(t);if(i)return n=i.getLength(),!1})),this.forEach(((i,o)=>{var s,r;for(let a=t;a<t+n;a++)null==(s=e.getRow(i))||s.get(a-t),o.insert(a,null==(r=e.getRow(i))?void 0:r.get(a-t))}))}getFragments(t,e,n,i){const o=new H;for(let s=t;s<=e;s++){const t=new x;for(let e=n;e<=i;e++){const n=this.getValue(s,e);t.push(n)}o.pushRow(t)}return o}getSizeOf(){return this._option.getSizeOf()}getLength(){return this._option.getLength()}getRange(){const t=this.getSizeOf();let e=0;const n=this.getLength();for(let i=0;i<n;i++){const t=this.getRow(i);if(t){const n=t.getSizeOf();t.getSizeOf()>e&&(e=n-1)}}return{startRow:0,startColumn:0,endRow:t,endColumn:e}}toArray(){return this._option.toArray().map((t=>new x(t).toArray()))}toJSON(){return this._matrix}getData(){const t=JSON.stringify(this);return JSON.parse(t)}getArrayData(){let t=0,e=0,n=!1,i=!1;const o=new H;return this.forEach(((s,r)=>{n||(n=!0,t=s),r.forEach(((n,r)=>{i?n<e&&(e=n):(i=!0,e=n);const a=this.getValue(s,n);o.setValue(s-t,n-e,a)}))})),o.getData()}getDataRange(){let t=0,e=0,n=0,i=!1,o=!1;this.forEach(((s,r)=>{i||(i=!0,t=s);const a=r.getLength()-1;a>n&&(n=a),r.forEach(((t,n)=>{o?t<e&&(e=t):(o=!0,e=t)}))}));const s=t+this.getSizeOf()-1;return{startRow:t,startColumn:e,endRow:s,endColumn:n}}}const P=/^-ms-/,B=/-([a-z])/g,F=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class U{static stringAt(t){let e="",n=t;for(;n>=F.length;)n/=F.length,n-=1,e+=F[n%F.length];return e+=F[t%F.length],e}static getEnvironment(){const{appVersion:t}=navigator,e=this.getSystemType();return{app_version:t,os:e,os_version:e,device_id:"",platform:"web"}}static indexAt(t){let e=0;for(let n=0;n<t.length-1;n+=1){const i=t.charCodeAt(n)-65,o=t.length-1-n;e+=F.length**o+F.length*i}return e+=t.charCodeAt(t.length-1)-65,e}static deleteBlank(t){return U.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){const t=navigator.userAgent,e="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!e&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(e){if(t.indexOf("Windows NT 5.0")>-1||t.indexOf("Windows 2000")>-1)return"Windows 2000";if(t.indexOf("Windows NT 5.1")>-1||t.indexOf("Windows XP")>-1)return"Windows XP";if(t.indexOf("Windows NT 5.2")>-1||t.indexOf("Windows 2003")>-1)return"Windows 2003";if(t.indexOf("Windows NT 6.0")>-1||t.indexOf("Windows Vista")>-1)return"Windows Vista";if(t.indexOf("Windows NT 6.1")>-1||t.indexOf("Windows 7")>-1)return"Windows 7";if(t.indexOf("Windows NT 10")>-1||t.indexOf("Windows 10")>-1)return"Windows 10";if(t.indexOf("Windows NT 11")>-1||t.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const t=navigator.userAgent,e=t.indexOf("Opera")>-1,n=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!e,i=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,o=t.indexOf("Edge")>-1,s=t.indexOf("Firefox")>-1,r=t.indexOf("Safari")>-1&&-1===t.indexOf("Chrome"),a=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(t);const e=parseFloat(RegExp.$1);return 7===e?"IE7":8===e?"IE8":9===e?"IE9":10===e?"IE10":"0"}return s?"FF":e?"Opera":r?"Safari":a?"Chrome":o?"Edge":i?"IE11":"Unknown browser"}static generateRandomId(t=21){return d(t)}static getClassName(t){return t.constructor.name}static deepMerge(t,...e){function n(t,e){t.forEach(((t,o)=>{var s,r;if(U.isArray(t)){const i=null!=(s=e[o])?s:[];return e[o]=i,void n(t,i)}if(U.isObject(t)){const n=null!=(r=e[o])?r:{};return e[o]=n,void i(t,n)}e[o]=t}))}function i(t,e){Object.keys(t).forEach((o=>{var s,r;const a=t[o];if(U.isObject(a)){const t=null!=(s=e[o])?s:{};return e[o]=t,void i(a,t)}if(U.isArray(a)){const t=null!=(r=e[o])?r:[];return e[o]=t,void n(a,t)}e[o]=a}))}return e.forEach((e=>e&&function(e){Object.keys(e).forEach((o=>{var s,r;const a=e[o];if(U.isArray(a)){const e=null!=(s=t[o])?s:[];return t[o]=e,void n(a,e)}if(U.isObject(a)){const e=null!=(r=t[o])?r:{};return t[o]=e,void i(a,e)}t[o]=a}))}(e))),t}static numberFixed(t,e){return Number(Number(t).toFixed(e))}static diffValue(t,e){function n(i,o){return U.getValueType(i)===U.getValueType(o)&&(U.isArray(i)?function(i,o){if(t.length!==e.length)return!1;for(let t=0,e=i.length;t<e;t++){if(!n(i[t],o[t]))return!1}return!0}(i,o):U.isObject(i)?function(t,e){const i=Object.keys(t),o=Object.keys(e);if(i.length!==o.length)return!1;for(const s of i){if(!o.includes(s))return!1;if(!n(t[s],e[s]))return!1}return!0}(i,o):U.isDate(i)?i.getTime()===o.getTime():U.isRegExp(i)?i.toString()===o.toString():i===o)}return n(t,e)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){const e=[];return t.forEach(((t,n)=>{e[n]=U.deepClone(t)})),e}if(this.isObject(t)){const e={};return Object.keys(t).forEach((n=>{const i=t[n];e[n]=U.deepClone(i)})),Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}return t}static getLanguage(){const t="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||t}static getValueType(t){return Object.prototype.toString.apply(t)}static isDefine(t){return null!=t}static isBlank(t){return!this.isDefine(t)||!!this.isString(t)&&""===t.trim()}static isAssignableFrom(t,e){return t instanceof e}static isBoolean(t){return"[object Boolean]"===this.getValueType(t)}static isPlainObject(t){return!!this.isDefine(t)&&Object.getPrototypeOf(t)===Object.getPrototypeOf({})}static isFunction(t){return"[object Function]"===this.getValueType(t)}static isDate(t){return"[object Date]"===this.getValueType(t)}static isRegExp(t){return"[object RegExp]"===this.getValueType(t)}static isArray(t){return"[object Array]"===this.getValueType(t)}static isString(t){return"[object String]"===this.getValueType(t)}static isNumber(t){return"[object Number]"===this.getValueType(t)}static isStringNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)}static isObject(t){return"[object Object]"===this.getValueType(t)}static isEmptyObject(t){for(const e in t)return!1;return!0}static isMobile(){let t=0,e=0;return document.body.clientWidth&&(t=document.body.clientWidth),document.body.clientHeight&&(e=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||t<350&&e<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const t=navigator.userAgent.toLowerCase();return"micromessenger"===String(t.match(/MicroMessenger/i))}static isAndroid(){const t=navigator.userAgent;return t.indexOf("Android")>-1||t.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(t){return e=>{for(let n=0;n<t;n++)e&&e()}}static hasLength(t,e){return!!U.isDefine(t)&&(U.isDefine(e)?t.length===e:t.length>0)}static capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}static fCamelCase(t,e){return e.toUpperCase()}static camelCase(t){return t.replace(P,"ms-").replace(B,this.fCamelCase)}static removeNull(t){if(this.isObject(t)){const e={};return Object.keys(t).forEach((e=>{const n=t[e];null==n?delete t[e]:U.removeNull(n)})),e}return t}static fillTwoDimensionalArray(t,e,n){return new Array(t).fill(n).map((t=>new Array(e).fill(n)))}static fillObjectMatrix(t,e,n){const i=new H;for(let o=0;o<t;o++)for(let t=0;t<e;t++)i.setValue(o,t,n);return i.getData()}static numToWord(t){let e="";for(;t>0;){let n=t%26;n=0===n?n=26:n,e=String.fromCharCode(96+n)+e,t=(t-n)/26}return e.toLocaleUpperCase()}static ABCatNum(t){if(null==t||0===t.length)return NaN;const e=t.toLowerCase().split(""),n=e.length;let i=0,o=0;for(let s=0;s<n;s++)o=e[s].charCodeAt(0)-96,i+=o*26**(n-s-1);return 0===i?NaN:i-1}static chatAtABC(t){const e="a".charCodeAt(0),n="z".charCodeAt(0)-e+1;let i="";for(;t>=0;)i=String.fromCharCode(t%n+e)+i,t=Math.floor(t/n)-1;return i.toUpperCase()}static randSort(t){for(let e=0,n=t.length;e<n;e++){const i=parseInt((Math.random()*n).toString()),o=t[i];t[i]=t[e],t[e]=o}return t}static commonExtend(t,e){let n={};for(let i in t)n[i]=t[i];for(let i in e)null!=e[i]&&(n[i]=e[i]);return n}static commonExtend1(t,e){for(let n in t)null==e[n]&&(e[n]=t[n]);return e}static arrayToObject(t){const e={};return t.forEach(((t,n)=>{e[n]={},t.forEach(((t,i)=>{e[n][i]=t}))})),e}}var z,W,G,V,Y,X,j,K,$,Z,q,Q,J,tt,et,nt,it,ot,st,rt,at,lt,ht,ct,dt,ut,gt,_t,pt,mt,Tt,ft,vt,Et,It,bt,At,Ct,St,Nt,Rt,wt,Ot,yt,Mt,Dt,Lt,xt,kt,Ht,Pt,Bt,Ft,Ut,zt,Wt,Gt,Vt,Yt,Xt,jt,Kt,$t,Zt,qt,Qt,Jt,te,ee,ne,ie,oe,se,re,ae,le,he,ce,de,ue,ge,_e,pe,me,Te,fe,ve,Ee,Ie,be,Ae,Ce,Se,Ne,Re,we,Oe,ye,Me,De,Le,xe,ke,He,Pe,Be,Fe,Ue,ze,We,Ge,Ve,Ye,Xe,je,Ke;(W=z||(z={}))[W.TAB=0]="TAB",W[W.SPACE=1]="SPACE",W[W.NOTHING=2]="NOTHING",(V=G||(G={}))[V.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",V[V.NONE=1]="NONE",V[V.DECIMAL=2]="DECIMAL",V[V.ZERO_DECIMAL=3]="ZERO_DECIMAL",V[V.UPPER_ALPHA=4]="UPPER_ALPHA",V[V.ALPHA=5]="ALPHA",V[V.UPPER_ROMAN=6]="UPPER_ROMAN",V[V.ROMAN=7]="ROMAN",(X=Y||(Y={}))[X.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",X[X.START=1]="START",X[X.CENTER=2]="CENTER",X[X.END=3]="END",(K=j||(j={}))[K.PARAGRAPH=0]="PARAGRAPH",K[K.TABLE=1]="TABLE",K[K.SECTION_BREAK=2]="SECTION_BREAK",K[K.CUSTOM=3]="CUSTOM",(Z=$||($={}))[Z.DEFAULT=0]="DEFAULT",Z[Z.LINES=1]="LINES",Z[Z.LINES_AND_CHARS=2]="LINES_AND_CHARS",Z[Z.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",(Q=q||(q={}))[Q.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",Q[Q.CONTINUOUS=1]="CONTINUOUS",Q[Q.NEXT_PAGE=2]="NEXT_PAGE",Q[Q.EVEN_PAGE=3]="EVEN_PAGE",Q[Q.ODD_PAGE=4]="ODD_PAGE",(tt=J||(J={}))[tt.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",tt[tt.NONE=1]="NONE",tt[tt.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",(nt=et||(et={}))[nt.NORMAL=0]="NORMAL",nt[nt.TBRL=1]="TBRL",nt[nt.LRTBV=2]="LRTBV",(ot=it||(it={}))[ot.TEXT_RUN=0]="TEXT_RUN",ot[ot.AUTO_TEXT=1]="AUTO_TEXT",ot[ot.PAGE_BREAK=2]="PAGE_BREAK",ot[ot.COLUMN_BREAK=3]="COLUMN_BREAK",ot[ot.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",ot[ot.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",ot[ot.EQUATION=6]="EQUATION",ot[ot.DRAWING=7]="DRAWING",ot[ot.PERSON=8]="PERSON",ot[ot.RICH_LINK=9]="RICH_LINK",(rt=st||(st={}))[rt.BOTH_SIDES=0]="BOTH_SIDES",rt[rt.LEFT=1]="LEFT",rt[rt.RIGHT=2]="RIGHT",rt[rt.LARGEST=3]="LARGEST",(lt=at||(at={}))[lt.INLINE=0]="INLINE",lt[lt.WRAP_NONE=1]="WRAP_NONE",lt[lt.WRAP_POLYGON=2]="WRAP_POLYGON",lt[lt.WRAP_SQUARE=3]="WRAP_SQUARE",lt[lt.WRAP_THROUGH=4]="WRAP_THROUGH",lt[lt.WRAP_TIGHT=5]="WRAP_TIGHT",lt[lt.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",(ct=ht||(ht={}))[ct.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",ct[ct.NORMAL_TEXT=1]="NORMAL_TEXT",ct[ct.TITLE=2]="TITLE",ct[ct.SUBTITLE=3]="SUBTITLE",ct[ct.HEADING_1=4]="HEADING_1",ct[ct.HEADING_2=5]="HEADING_2",ct[ct.HEADING_3=6]="HEADING_3",ct[ct.HEADING_4=7]="HEADING_4",ct[ct.HEADING_5=8]="HEADING_5",ct[ct.HEADING_6=9]="HEADING_6",(ut=dt||(dt={}))[ut.AUTO=0]="AUTO",ut[ut.AT_LEAST=1]="AT_LEAST",ut[ut.EXACT=2]="EXACT",(_t=gt||(gt={}))[_t.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",_t[_t.SOLID=1]="SOLID",_t[_t.DOT=2]="DOT",_t[_t.DASH=3]="DASH",(mt=pt||(pt={}))[mt.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",mt[mt.START=1]="START",mt[mt.CENTER=2]="CENTER",mt[mt.END=3]="END",(ft=Tt||(Tt={})).EVENLY_DISTRIBUTED="0",ft.FIXED_WIDTH="1",(Et=vt||(vt={}))[Et.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",Et[Et.CONTENT_ALIGNMENT_UNSUPPORTED=1]="CONTENT_ALIGNMENT_UNSUPPORTED",Et[Et.TOP=2]="TOP",Et[Et.MIDDLE=3]="MIDDLE",Et[Et.BOTTOM=4]="BOTTOM",(bt=It||(It={})).NORMAL="normal",bt.BOLD="bold",bt.ITALIC="italic",(Ct=At||(At={}))[Ct.CHARACTER=0]="CHARACTER",Ct[Ct.COLUMN=1]="COLUMN",Ct[Ct.INSIDE_MARGIN=2]="INSIDE_MARGIN",Ct[Ct.LEFT_MARGIN=3]="LEFT_MARGIN",Ct[Ct.MARGIN=4]="MARGIN",Ct[Ct.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",Ct[Ct.PAGE=6]="PAGE",Ct[Ct.RIGHT_MARGIN=7]="RIGHT_MARGIN",(Nt=St||(St={}))[Nt.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",Nt[Nt.INSIDE_MARGIN=1]="INSIDE_MARGIN",Nt[Nt.LINE=2]="LINE",Nt[Nt.MARGIN=3]="MARGIN",Nt[Nt.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",Nt[Nt.PAGE=5]="PAGE",Nt[Nt.PARAGRAPH=6]="PARAGRAPH",Nt[Nt.TOP_MARGIN=7]="TOP_MARGIN",(wt=Rt||(Rt={}))[wt.POINT=0]="POINT",wt[wt.LINE=1]="LINE",wt[wt.CHARACTER=2]="CHARACTER",(yt=Ot||(Ot={}))[yt.CENTER=0]="CENTER",yt[yt.INSIDE=1]="INSIDE",yt[yt.LEFT=2]="LEFT",yt[yt.OUTSIDE=3]="OUTSIDE",yt[yt.RIGHT=4]="RIGHT",(Dt=Mt||(Mt={}))[Dt.BOTTOM=0]="BOTTOM",Dt[Dt.CENTER=1]="CENTER",Dt[Dt.INSIDE=2]="INSIDE",Dt[Dt.OUTSIDE=3]="OUTSIDE",Dt[Dt.TOP=4]="TOP",(xt=Lt||(Lt={}))[xt.compressPunctuation=0]="compressPunctuation",xt[xt.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",xt[xt.doNotCompress=2]="doNotCompress",(Ht=kt||(kt={}))[Ht.PORTRAIT=0]="PORTRAIT",Ht[Ht.LANDSCAPE=1]="LANDSCAPE",(Bt=Pt||(Pt={})).INSERT_ROW_DATA_ACTION="InsertRowDataAction",Bt.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",Bt.INSERT_ROW_ACTION="InsertRowAction",Bt.REMOVE_ROW_ACTION="RemoveRowAction",Bt.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",Bt.SET_SELECTION_ACTION="SetSelectionActivateAction",Bt.SET_RANGE_DATA_ACTION="SetRangeDataAction",Bt.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",Bt.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",Bt.DELETE_RANGE_ACTION="DeleteRangeAction",Bt.INSERT_SHEET_ACTION="InsertSheetAction",Bt.REMOVE_SHEET_ACTION="RemoveSheetAction",Bt.CLEAR_RANGE_ACTION="ClearRangeAction",Bt.INSERT_RANGE_ACTION="InsertRangeAction",Bt.SET_TAB_COLOR_ACTION="SetTabColorAction",Bt.HIDE_SHEET_ACTION="SetWorkSheetHideAction",Bt.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",Bt.INSERT_COLUMN_ACTION="InsertColumnAction",Bt.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",Bt.REMOVE_COLUMN_ACTION="RemoveColumnAction",Bt.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",Bt.SET_HIDE_ROW_ACTION="SetRowHideAction",Bt.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",Bt.SET_SHOW_ROW_ACTION="SetRowShowAction",Bt.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",Bt.ADD_MERGE_ACTION="AddMergeAction",Bt.REMOVE_MERGE_ACTION="RemoveMergeAction",Bt.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",Bt.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",Bt.SET_BORDER_ACTION="SetBorderAction",Bt.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",Bt.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",Bt.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",Bt.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",Bt.DELETE_BANDING_ACTION="DeleteBandingAction",Bt.SET_BANDING_ACTION="SetBandingAction",Bt.ADD_BANDING_ACTION="AddBandingAction",Bt.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",Bt.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",Bt.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",Bt.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",Bt.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",Bt.SET_FROZEN_COLUMNS_ACTION="SetFrozenColumnsAction",Bt.SET_FROZEN_ROWS_ACTION="SetFrozenRowsAction",(Ut=Ft||(Ft={}))[Ut.DEFAULT_SERIES=0]="DEFAULT_SERIES",Ut[Ut.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",(Wt=zt||(zt={})).CELL_EMPTY="CELL_EMPTY",Wt.CELL_NOT_EMPTY="CELL_NOT_EMPTY",Wt.DATE_AFTER="DATE_AFTER",Wt.DATE_BEFORE="DATE_BEFORE",Wt.DATE_EQUAL_TO="DATE_EQUAL_TO",Wt.DATE_NOT_EQUAL_TO="DATE_NOT_EQUAL_TO",Wt.DATE_AFTER_RELATIVE="DATE_AFTER_RELATIVE",Wt.DATE_BEFORE_RELATIVE="DATE_BEFORE_RELATIVE",Wt.DATE_EQUAL_TO_RELATIVE="DATE_EQUAL_TO_RELATIVE",Wt.NUMBER_BETWEEN="NUMBER_BETWEEN",Wt.NUMBER_EQUAL_TO="NUMBER_EQUAL_TO",Wt.NUMBER_GREATER_THAN="NUMBER_GREATER_THAN",Wt.NUMBER_GREATER_THAN_OR_EQUAL_TO="NUMBER_GREATER_THAN_OR_EQUAL_TO",Wt.NUMBER_LESS_THAN="NUMBER_LESS_THAN",Wt.NUMBER_LESS_THAN_OR_EQUAL_TO="NUMBER_LESS_THAN_OR_EQUAL_TO",Wt.NUMBER_NOT_BETWEEN="NUMBER_NOT_BETWEEN",Wt.NUMBER_NOT_EQUAL_TO="NUMBER_NOT_EQUAL_TO",Wt.TEXT_CONTAINS="TEXT_CONTAINS",Wt.TEXT_DOES_NOT_CONTAIN="TEXT_DOES_NOT_CONTAIN",Wt.TEXT_EQUAL_TO="TEXT_EQUAL_TO",Wt.TEXT_NOT_EQUAL_TO="TEXT_NOT_EQUAL_TO",Wt.TEXT_STARTS_WITH="TEXT_STARTS_WITH",Wt.TEXT_ENDS_WITH="TEXT_ENDS_WITH",Wt.CUSTOM_FORMULA="CUSTOM_FORMULA",(Vt=Gt||(Gt={}))[Vt.NONE=0]="NONE",Vt[Vt.THIN=1]="THIN",Vt[Vt.HAIR=2]="HAIR",Vt[Vt.DOTTED=3]="DOTTED",Vt[Vt.DASHED=4]="DASHED",Vt[Vt.DASH_DOT=5]="DASH_DOT",Vt[Vt.DASH_DOT_DOT=6]="DASH_DOT_DOT",Vt[Vt.DOUBLE=7]="DOUBLE",Vt[Vt.MEDIUM=8]="MEDIUM",Vt[Vt.MEDIUM_DASHED=9]="MEDIUM_DASHED",Vt[Vt.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",Vt[Vt.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",Vt[Vt.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",Vt[Vt.THICK=13]="THICK",(Xt=Yt||(Yt={})).TOP="top",Xt.BOTTOM="bottom",Xt.LEFT="left",Xt.RIGHT="right",Xt.NONE="none",Xt.ALL="all",Xt.OUTSIDE="outside",Xt.INSIDE="inside",Xt.HORIZONTAL="horizontal",Xt.VERTICAL="vertical",(Kt=jt||(jt={}))[Kt.UNSUPPORTED=0]="UNSUPPORTED",Kt[Kt.RGB=1]="RGB",Kt[Kt.HEX=2]="HEX",Kt[Kt.THEME=3]="THEME",(Zt=$t||($t={}))[Zt.ON=0]="ON",Zt[Zt.OFF=1]="OFF",(Qt=qt||(qt={}))[Qt.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",Qt[Qt.NUMNUMBER_BETWEENR_GREATER=1]="NUMNUMBER_BETWEENR_GREATER",Qt[Qt.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",Qt[Qt.NUMBER_LESS=3]="NUMBER_LESS",Qt[Qt.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",Qt[Qt.NUMBER_EQ=5]="NUMBER_EQ",Qt[Qt.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",Qt[Qt.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",Qt[Qt.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",Qt[Qt.TEXT_CONTAINS=9]="TEXT_CONTAINS",Qt[Qt.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",Qt[Qt.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",Qt[Qt.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",Qt[Qt.TEXT_EQ=13]="TEXT_EQ",Qt[Qt.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",Qt[Qt.TEXT_IS_URL=15]="TEXT_IS_URL",Qt[Qt.DATE_EQ=16]="DATE_EQ",Qt[Qt.DATE_BEFORE=17]="DATE_BEFORE",Qt[Qt.DATE_AFTER=18]="DATE_AFTER",Qt[Qt.DATE_ON_OR_BEFORE=19]="DATE_ON_OR_BEFORE",Qt[Qt.DATE_ON_OR_AFTER=20]="DATE_ON_OR_AFTER",Qt[Qt.DATE_BETWEEN=21]="DATE_BETWEEN",Qt[Qt.DATE_NOT_BETWEEN=22]="DATE_NOT_BETWEEN",Qt[Qt.DATE_IS_VALID=23]="DATE_IS_VALID",Qt[Qt.ONE_OF_RANGE=24]="ONE_OF_RANGE",Qt[Qt.ONE_OF_LIST=25]="ONE_OF_LIST",Qt[Qt.BLANK=26]="BLANK",Qt[Qt.NOT_BLANK=27]="NOT_BLANK",Qt[Qt.CUSTOM_FORMULA=28]="CUSTOM_FORMULA",Qt[Qt.BOOLEAN=29]="BOOLEAN",Qt[Qt.TEXT_NOT_EQ=30]="TEXT_NOT_EQ",Qt[Qt.DATE_NOT_EQ=31]="DATE_NOT_EQ",(te=Jt||(Jt={}))[te.PASTE_NORMAL=0]="PASTE_NORMAL",te[te.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",te[te.PASTE_FORMAT=2]="PASTE_FORMAT",te[te.PASTE_FORMULA=3]="PASTE_FORMULA",te[te.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",te[te.PASTE_VALUES=5]="PASTE_VALUES",te[te.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",te[te.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",(ne=ee||(ee={}))[ne.DOCUMENT=0]="DOCUMENT",ne[ne.PROJECT=1]="PROJECT",(oe=ie||(ie={}))[oe.COLUMNS=0]="COLUMNS",oe[oe.ROWS=1]="ROWS",(re=se||(se={}))[re.LEFT=0]="LEFT",re[re.RIGHT=1]="RIGHT",re[re.TOP=2]="TOP",re[re.BOTTOM=3]="BOTTOM",(le=ae||(ae={}))[le.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",le[le.TEXT=1]="TEXT",le[le.NUMBER=2]="NUMBER",le[le.PERCENT=3]="PERCENT",le[le.CURRENCY=4]="CURRENCY",le[le.DATE=5]="DATE",le[le.TIME=6]="TIME",le[le.DATE_TIME=7]="DATE_TIME",le[le.SCIENTIFIC=8]="SCIENTIFIC",(ce=he||(he={}))[ce.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",ce[ce.MIN=1]="MIN",ce[ce.MAX=2]="MAX",ce[ce.NUMBER=3]="NUMBER",ce[ce.PERCENT=4]="PERCENT",ce[ce.PERCENTILE=5]="PERCENTILE",(ue=de||(de={}))[ue.BACKSPACE=8]="BACKSPACE",ue[ue.TAB=9]="TAB",ue[ue.ENTER=13]="ENTER",ue[ue.SHIFT=16]="SHIFT",ue[ue.CTRL=17]="CTRL",ue[ue.PAUSE=19]="PAUSE",ue[ue.CAPS_LOCK=20]="CAPS_LOCK",ue[ue.ESC=27]="ESC",ue[ue.SPACE=33]="SPACE",ue[ue.PAGE_UP=33]="PAGE_UP",ue[ue.PAGE_DOWN=34]="PAGE_DOWN",ue[ue.END=35]="END",ue[ue.HOME=36]="HOME",ue[ue.LEFT=37]="LEFT",ue[ue.UP=38]="UP",ue[ue.RIGHT=39]="RIGHT",ue[ue.DOWN=40]="DOWN",ue[ue.INSERT=45]="INSERT",ue[ue.DELETE=46]="DELETE",ue[ue.WIN=91]="WIN",ue[ue.WIN_R=92]="WIN_R",ue[ue.MENU=93]="MENU",ue[ue.F1=112]="F1",ue[ue.F2=113]="F2",ue[ue.F3=114]="F3",ue[ue.F4=115]="F4",ue[ue.F5=116]="F5",ue[ue.F6=117]="F6",ue[ue.F7=118]="F7",ue[ue.F8=119]="F8",ue[ue.F9=120]="F9",ue[ue.F10=121]="F10",ue[ue.F11=122]="F11",ue[ue.F12=123]="F12",ue[ue.NUM_LOCK=144]="NUM_LOCK",ue[ue.SCROLL_LOCK=145]="SCROLL_LOCK",(_e=ge||(ge={})).backspace="Backspace",_e.delete="Delete",(me=pe||(pe={})).EN="en",me.ZH="zh",(fe=Te||(Te={}))[fe.RANGE=0]="RANGE",fe[fe.SHEET=1]="SHEET",(Ee=ve||(ve={}))[Ee.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",Ee[Ee.PAST_YEAR=1]="PAST_YEAR",Ee[Ee.PAST_MONTH=2]="PAST_MONTH",Ee[Ee.PAST_WEEK=3]="PAST_WEEK",Ee[Ee.YESTERDAY=4]="YESTERDAY",Ee[Ee.TODAY=5]="TODAY",Ee[Ee.TOMORROW=6]="TOMORROW",(be=Ie||(Ie={}))[be.GRID=0]="GRID",be[be.KANBAN=1]="KANBAN",be[be.GANTT=2]="GANTT",(Ce=Ae||(Ae={}))[Ce.UNSPECIFIED=0]="UNSPECIFIED",Ce[Ce.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",Ce[Ce.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",(Ne=Se||(Se={}))[Ne.DASH=0]="DASH",Ne[Ne.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",Ne[Ne.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",Ne[Ne.DASHED_HEAVY=3]="DASHED_HEAVY",Ne[Ne.DASH_LONG=4]="DASH_LONG",Ne[Ne.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",Ne[Ne.DOT_DASH=6]="DOT_DASH",Ne[Ne.DOT_DOT_DASH=7]="DOT_DOT_DASH",Ne[Ne.DOTTED=8]="DOTTED",Ne[Ne.DOTTED_HEAVY=9]="DOTTED_HEAVY",Ne[Ne.DOUBLE=10]="DOUBLE",Ne[Ne.NONE=11]="NONE",Ne[Ne.SINGLE=12]="SINGLE",Ne[Ne.THICK=13]="THICK",Ne[Ne.WAVE=14]="WAVE",Ne[Ne.WAVY_DOUBLE=15]="WAVY_DOUBLE",Ne[Ne.WAVY_HEAVY=16]="WAVY_HEAVY",Ne[Ne.WORDS=17]="WORDS",(we=Re||(Re={}))[we.UNSPECIFIED=0]="UNSPECIFIED",we[we.LEFT=1]="LEFT",we[we.CENTER=2]="CENTER",we[we.RIGHT=3]="RIGHT",we[we.JUSTIFIED=4]="JUSTIFIED",(ye=Oe||(Oe={}))[ye.UNSPECIFIED=0]="UNSPECIFIED",ye[ye.TOP=1]="TOP",ye[ye.MIDDLE=2]="MIDDLE",ye[ye.BOTTOM=3]="BOTTOM",(De=Me||(Me={}))[De.UNSPECIFIED=0]="UNSPECIFIED",De[De.OVERFLOW=1]="OVERFLOW",De[De.CLIP=2]="CLIP",De[De.WRAP=3]="WRAP",(xe=Le||(Le={}))[xe.NORMAL=0]="NORMAL",xe[xe.ITALIC=1]="ITALIC",(He=ke||(ke={}))[He.NORMAL=0]="NORMAL",He[He.BOLD=1]="BOLD",(Be=Pe||(Pe={}))[Be.NORMAL=0]="NORMAL",Be[Be.SUBSCRIPT=1]="SUBSCRIPT",Be[Be.SUPERSCRIPT=2]="SUPERSCRIPT",(Ue=Fe||(Fe={}))[Ue.FALSE=0]="FALSE",Ue[Ue.TRUE=1]="TRUE",(We=ze||(ze={}))[We.STRING=0]="STRING",We[We.NUMBER=1]="NUMBER",We[We.BOOLEAN=2]="BOOLEAN",We[We.FORCE_STRING=3]="FORCE_STRING",(Ve=Ge||(Ge={}))[Ve.DARK1=0]="DARK1",Ve[Ve.LIGHT1=1]="LIGHT1",Ve[Ve.DARK2=2]="DARK2",Ve[Ve.LIGHT2=3]="LIGHT2",Ve[Ve.ACCENT1=4]="ACCENT1",Ve[Ve.ACCENT2=5]="ACCENT2",Ve[Ve.ACCENT3=6]="ACCENT3",Ve[Ve.ACCENT4=7]="ACCENT4",Ve[Ve.ACCENT5=8]="ACCENT5",Ve[Ve.ACCENT6=9]="ACCENT6",Ve[Ve.HYPERLINK=10]="HYPERLINK",Ve[Ve.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",(Xe=Ye||(Ye={})).OFFICE="Office",Xe.OFFICE_2007_2010="Office 2007-2010",Xe.GRAYSCALE="Grayscale",Xe.BLUE_WARM="Blue Warm",Xe.BLUE="Blue",Xe.BLUE_II="Blue II",Xe.BLUE_GREEN="Blue Green",Xe.GREEN="Green",Xe.GREEN_YELLOW="Green Yellow",Xe.YELLOW="Yellow",Xe.YELLOW_ORANGE="Yellow Orange",Xe.ORANGE="Orange",Xe.ORANGE_RED="Orange Red",Xe.RED_ORANGE="Red Orange",Xe.RED="Red",Xe.RED_VIOLET="Red Violet",Xe.VIOLET="Violet",Xe.VIOLET_II="Violet II",Xe.MEDIAN="Median",Xe.PAPER="Paper",Xe.MARQUEE="Marquee",Xe.SLIPSTREAM="Slipstream",Xe.Aspect="Aspect",(Ke=je||(je={}))[Ke.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",Ke[Ke.TEXT_BOX=1]="TEXT_BOX",Ke[Ke.RECTANGLE=2]="RECTANGLE",Ke[Ke.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",Ke[Ke.ELLIPSE=4]="ELLIPSE",Ke[Ke.ARC=5]="ARC",Ke[Ke.BENT_ARROW=6]="BENT_ARROW",Ke[Ke.BENT_UP_ARROW=7]="BENT_UP_ARROW",Ke[Ke.BEVEL=8]="BEVEL",Ke[Ke.BLOCK_ARC=9]="BLOCK_ARC",Ke[Ke.BRACE_PAIR=10]="BRACE_PAIR",Ke[Ke.BRACKET_PAIR=11]="BRACKET_PAIR",Ke[Ke.CAN=12]="CAN",Ke[Ke.CHEVRON=13]="CHEVRON",Ke[Ke.CHORD=14]="CHORD",Ke[Ke.CLOUD=15]="CLOUD",Ke[Ke.CORNER=16]="CORNER",Ke[Ke.CUBE=17]="CUBE",Ke[Ke.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",Ke[Ke.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",Ke[Ke.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",Ke[Ke.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",Ke[Ke.DECAGON=22]="DECAGON",Ke[Ke.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",Ke[Ke.DIAMOND=24]="DIAMOND",Ke[Ke.DODECAGON=25]="DODECAGON",Ke[Ke.DONUT=26]="DONUT",Ke[Ke.DOUBLE_WAVE=27]="DOUBLE_WAVE",Ke[Ke.DOWN_ARROW=28]="DOWN_ARROW",Ke[Ke.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",Ke[Ke.FOLDED_CORNER=30]="FOLDED_CORNER",Ke[Ke.FRAME=31]="FRAME",Ke[Ke.HALF_FRAME=32]="HALF_FRAME",Ke[Ke.HEART=33]="HEART",Ke[Ke.HEPTAGON=34]="HEPTAGON",Ke[Ke.HEXAGON=35]="HEXAGON",Ke[Ke.HOME_PLATE=36]="HOME_PLATE",Ke[Ke.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",Ke[Ke.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",Ke[Ke.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",Ke[Ke.LEFT_ARROW=40]="LEFT_ARROW",Ke[Ke.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",Ke[Ke.LEFT_BRACE=42]="LEFT_BRACE",Ke[Ke.LEFT_BRACKET=43]="LEFT_BRACKET",Ke[Ke.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",Ke[Ke.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",Ke[Ke.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",Ke[Ke.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",Ke[Ke.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",Ke[Ke.MATH_DIVIDE=49]="MATH_DIVIDE",Ke[Ke.MATH_EQUAL=50]="MATH_EQUAL",Ke[Ke.MATH_MINUS=51]="MATH_MINUS",Ke[Ke.MATH_MULTIPLY=52]="MATH_MULTIPLY",Ke[Ke.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",Ke[Ke.MATH_PLUS=54]="MATH_PLUS",Ke[Ke.MOON=55]="MOON",Ke[Ke.NO_SMOKING=56]="NO_SMOKING",Ke[Ke.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",Ke[Ke.OCTAGON=58]="OCTAGON",Ke[Ke.PARALLELOGRAM=59]="PARALLELOGRAM",Ke[Ke.PENTAGON=60]="PENTAGON",Ke[Ke.PIE=61]="PIE",Ke[Ke.PLAQUE=62]="PLAQUE",Ke[Ke.PLUS=63]="PLUS",Ke[Ke.QUAD_ARROW=64]="QUAD_ARROW",Ke[Ke.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",Ke[Ke.RIBBON=66]="RIBBON",Ke[Ke.RIBBON_2=67]="RIBBON_2",Ke[Ke.RIGHT_ARROW=68]="RIGHT_ARROW",Ke[Ke.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",Ke[Ke.RIGHT_BRACE=70]="RIGHT_BRACE",Ke[Ke.RIGHT_BRACKET=71]="RIGHT_BRACKET",Ke[Ke.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",Ke[Ke.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",Ke[Ke.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",Ke[Ke.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",Ke[Ke.SMILEY_FACE=76]="SMILEY_FACE",Ke[Ke.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",Ke[Ke.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",Ke[Ke.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",Ke[Ke.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",Ke[Ke.STAR_10=81]="STAR_10",Ke[Ke.STAR_12=82]="STAR_12",Ke[Ke.STAR_16=83]="STAR_16",Ke[Ke.STAR_24=84]="STAR_24",Ke[Ke.STAR_32=85]="STAR_32",Ke[Ke.STAR_4=86]="STAR_4",Ke[Ke.STAR_5=87]="STAR_5",Ke[Ke.STAR_6=88]="STAR_6",Ke[Ke.STAR_7=89]="STAR_7",Ke[Ke.STAR_8=90]="STAR_8",Ke[Ke.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",Ke[Ke.SUN=92]="SUN",Ke[Ke.TRAPEZOID=93]="TRAPEZOID",Ke[Ke.TRIANGLE=94]="TRIANGLE",Ke[Ke.UP_ARROW=95]="UP_ARROW",Ke[Ke.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",Ke[Ke.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",Ke[Ke.UTURN_ARROW=98]="UTURN_ARROW",Ke[Ke.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",Ke[Ke.WAVE=100]="WAVE",Ke[Ke.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",Ke[Ke.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",Ke[Ke.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",Ke[Ke.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",Ke[Ke.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",Ke[Ke.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",Ke[Ke.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",Ke[Ke.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",Ke[Ke.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",Ke[Ke.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",Ke[Ke.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",Ke[Ke.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",Ke[Ke.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",Ke[Ke.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",Ke[Ke.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",Ke[Ke.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",Ke[Ke.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",Ke[Ke.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",Ke[Ke.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",Ke[Ke.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",Ke[Ke.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",Ke[Ke.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",Ke[Ke.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",Ke[Ke.FLOW_CHART_OR=124]="FLOW_CHART_OR",Ke[Ke.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",Ke[Ke.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",Ke[Ke.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",Ke[Ke.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",Ke[Ke.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",Ke[Ke.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",Ke[Ke.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",Ke[Ke.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",Ke[Ke.ARROW_EAST=133]="ARROW_EAST",Ke[Ke.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",Ke[Ke.ARROW_NORTH=135]="ARROW_NORTH",Ke[Ke.SPEECH=136]="SPEECH",Ke[Ke.STARBURST=137]="STARBURST",Ke[Ke.TEARDROP=138]="TEARDROP",Ke[Ke.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",Ke[Ke.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",Ke[Ke.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",Ke[Ke.CUSTOM=142]="CUSTOM";const $e={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};Fe.FALSE,pe.EN;const Ze={type:Ie.GRID,name:"Sheet1",id:"sheet-01",tabColor:"",hidden:Fe.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:Fe.FALSE,showGridlines:Fe.TRUE,rowTitle:{width:46,hidden:Fe.FALSE},columnTitle:{height:20,hidden:Fe.FALSE},selections:["A1"],rightToLeft:Fe.FALSE,pluginMeta:{}},qe={ff:"Times New Roman",fs:14,it:Fe.FALSE,bl:Fe.FALSE,ul:{s:Fe.FALSE},st:{s:Fe.FALSE},ol:{s:Fe.FALSE},tr:{a:0,v:Fe.FALSE},td:Ae.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Re.UNSPECIFIED,vt:Oe.UNSPECIFIED,tb:Me.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Qe={id:"default_doc",documentStyle:{}};var Je,tn;(tn=Je||(Je={})).ARRAY_CONVERTOR="ARRAY_CONVERTOR",tn.MATRIX_CONVERTOR="MATRIX_CONVERTOR";const en={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var nn,on;(on=nn||(nn={})).BASE_COMPONENT="baseComponent",on.BASE_RENDER="renderEngine",on.BASE_UI="baseUI",on.SPREADSHEET="spreadsheet",on.DOCUMENT="document",on.SLIDE="slide";const sn={[Ye.OFFICE]:{[Ge.ACCENT1]:"#4472C4",[Ge.ACCENT2]:"#ED7D31",[Ge.ACCENT3]:"#A5A5A5",[Ge.ACCENT4]:"#70AD47",[Ge.ACCENT5]:"#5B9BD5",[Ge.ACCENT6]:"#70AD47",[Ge.DARK1]:"#000000",[Ge.DARK2]:"#44546A",[Ge.LIGHT1]:"#FFFFFF",[Ge.LIGHT2]:"#E7E6E6",[Ge.HYPERLINK]:"#0563C1",[Ge.FOLLOWED_HYPERLINK]:"#954F72"}};var rn,an,ln,hn,cn,dn;(an=rn||(rn={}))[an.SLIDE=0]="SLIDE",an[an.MASTER=1]="MASTER",an[an.LAYOUT=2]="LAYOUT",an[an.HANDOUT_MASTER=3]="HANDOUT_MASTER",an[an.NOTES_MASTER=4]="NOTES_MASTER",(hn=ln||(ln={}))[hn.SHAPE=0]="SHAPE",hn[hn.IMAGE=1]="IMAGE",hn[hn.TEXT=2]="TEXT",hn[hn.SPREADSHEET=3]="SPREADSHEET",hn[hn.DOCUMENT=4]="DOCUMENT",hn[hn.SLIDE=5]="SLIDE",(dn=cn||(cn={}))[dn.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",dn[dn.NEXT_SLIDE=1]="NEXT_SLIDE",dn[dn.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",dn[dn.FIRST_SLIDE=3]="FIRST_SLIDE",dn[dn.LAST_SLIDE=4]="LAST_SLIDE";class un{constructor(){this._colorType=jt.UNSUPPORTED,this._themeColors=Ye.OFFICE,this._themeTint=0}asRgbColor(){return new mn(this._rgbValue,this)}asThemeColor(){return new fn(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case jt.THEME:return this.asThemeColor();case jt.RGB:return this.asRgbColor();case jt.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(t){return this._colorType=jt.RGB,this._rgbValue=t,this}setThemeColors(t){this._colorType=jt.THEME,this._themeColors=t}setThemeTint(t){this._colorType=jt.THEME,this._themeTint=t}setThemeColor(t){return this._colorType=jt.THEME,this._themeValue=t,this}getColorType(){return this._colorType}}class gn{constructor(t){this._builder=t}static rgbColorToHexValue(t){return`#${((1<<24)+(t.getRed()<<16)+(t.getGreen()<<8)+t.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(t){t?t.indexOf("#")>-1&&(t=t.substring(1)):t="#000000";let e=+`0x${t[0]}${t[1]}`,n=+`0x${t[2]}${t[3]}`,i=+`0x${t[4]}${t[5]}`;return(new un).setRgbColor(`rgb(${e},${n},${i})`).asRgbColor()}static hexToRgbString(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((t,e,n,i)=>e+e+n+n+i+i));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);let n=null;if(e){n=`rgba(${parseInt(e[1],16)},${parseInt(e[2],16)},${parseInt(e[3],16)})`}return n}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new gn(this._builder)}equals(t){return!1}}class _n{constructor(t){const e=t.getRed()/255,n=t.getGreen()/255,i=t.getBlue()/255,o=t.getAlpha()/255,s=Math.min(e,Math.min(n,i)),r=Math.max(e,Math.max(n,i)),a=r-s;if(r===s)return this._hue=0,this._saturation=0,void(this._lightness=r);this._lightness=(s+r)/2,this._lightness<.5?this._saturation=a/(r+s):this._saturation=a/(2-r-s),e===r&&(this._hue=(n-i)/a),n===r&&(this._hue=2+(i-e)/a),i===r&&(this._hue=4+(e-n)/a),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const t=new un;if(0===this._saturation)return t.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),t.asRgbColor();let e;e=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-e,i=this._hue/360,o=i+1/3,s=this.setColor(e,n,o),r=this.setColor(e,n,i),a=i-1/3,l=this.setColor(e,n,a);return t.setRgbColor(`rgba(${Math.round(255*s)},${Math.round(255*r)},${Math.round(255*l)},${255*this._alpha})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(t,e,n){let i;return n<0&&(n+=1),n>1&&(n-=1),i=6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e,i}setLightness(t){this._lightness=t}}const pn=class extends gn{constructor(t,e){super(e);let n=t.match(pn.RGBA_EXTRACT);if(n){const e=+n[1],i=+n[2],o=+n[3],s=+n[4];return this._cssString=t,this._red=e,this._green=i,this._blue=o,void(this._alpha=s)}if(n=t.match(pn.RGB_EXTRACT),n){const e=+n[1],i=+n[2],o=+n[3];return this._cssString=t,this._red=e,this._green=i,this._blue=o,void(this._alpha=1)}throw new Error("Invalid rgba or rgb color")}asHexString(){return gn.rgbColorToHexValue(this)}getRed(){let t=this._red+pn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getGreen(){let t=this._green+pn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getBlue(){let t=this._blue+pn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getAlpha(){return this._alpha}getColorType(){return jt.RGB}clone(){return new pn(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(t){return t instanceof pn&&(t._red===this._red&&t._blue===this._blue&&t._green===this._green&&t._alpha===this._alpha)}getCssString(){return this._cssString}};let mn=pn;mn.RGB_COLOR_AMT=0,mn.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*"),mn.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const Tn=class extends gn{constructor(t,e,n,i){super(i),this._themeColorType=t,this._themeTint=e,this._themeColors=n}lumValue(t,e){if(null==t)return e;let n;return n=t<0?e*(1+t):e*(1-t)+(255-255*(1-t)),n}asRgbColor(){const t=sn[this._themeColors];if(null==t)throw new Error("not find themeColors type");const e=t.get(this._themeColorType);if(null==e)throw new Error("not find themeColors value");let n;if(Tn._cacheThemeColor.has(this._themeColors)){if(n=Tn._cacheThemeColor.get(this._themeColors),n.has(this._themeColorType))return n.get(this._themeColorType)}else n=new Map,Tn._cacheThemeColor.set(this._themeColors,n);const i=new _n(gn.hexValueToRgbColor(e));i.setLightness(this.lumValue(this._themeTint,255*i.getLightness())/255);const o=i.asRgbColor();return n.set(this._themeColorType,o),o}clone(){return new Tn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(t){return t instanceof Tn&&t._themeColorType===this._themeColorType}getColorType(){return jt.THEME}getThemeColorType(){return this._themeColorType}};let fn=Tn;fn._cacheThemeColor=new Map;class vn{constructor(t,e){this._workSheet=t,this._columnData=new x(e)}getColumnData(){return this._columnData}getColumnDatas(t,e){const n=new x;for(let i=t;i<t+e;i++){const t=this.getColumnOrCreate(i);n.push(t)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...t){const{_workSheet:e}=this,{_columnData:n}=this,i=e.getConfig();let o=0;if(1===t.length){o=n.obtain(t[0],{hd:Fe.FALSE,w:i.defaultColumnWidth}).w}else if(2===t.length)for(let s=t[0];s<t[0]+t[1];s++){o+=n.obtain(s,{hd:Fe.FALSE,w:i.defaultColumnWidth}).w}return o}setColumnWidth(t,e){const n=this._workSheet.getContext(),i=this._workSheet.getCommandManager(),o={sheetId:this._workSheet.getSheetId(),actionName:Pt.SET_COLUMN_WIDTH_ACTION,columnIndex:t,columnWidth:e},s=new Ei({WorkBookUnit:n.getWorkBook()},o);i.invoke(s)}getColumn(t){const e=this._columnData.get(t);if(e)return e}getColumnOrCreate(t){const{_workSheet:e}=this,{_columnData:n}=this,i=e.getConfig(),o=n.get(t);if(o)return o;const s={w:i.defaultColumnWidth,hd:Fe.FALSE};return this._columnData.set(t,s),s}}class En{constructor(t,e){this._worksheet=t,this._rectangleList=e,fi.getCommandObservers().add((({actions:e})=>{if(!e||0===e.length)return;const n=e[0];try{n.getWorkBook()}catch(l){return}if(t.getContext().getWorkBook().getUnitId()!==n.getWorkBook().getUnitId())return;let i=e.find((t=>t instanceof Oo)),o=e.find((t=>t instanceof Ro)),s=e.find((t=>t instanceof ko)),r=e.find((t=>t instanceof Do)),a=e.find((t=>t instanceof No));if(i){const t=i.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=U.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],o=t.rowCount;t.rowIndex>i.endRow||(t.rowIndex>=i.startRow&&t.rowIndex<=i.endRow||(i.startRow+=o),i.endRow+=o)}this.modifyMerge(this._rectangleList,e)}}if(o){const t=o.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=U.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],o=t.columnCount;t.columnIndex>i.endColumn||(t.columnIndex>=i.startColumn&&t.columnIndex<=i.endColumn||(i.startColumn+=o),i.endColumn+=o)}this.modifyMerge(this._rectangleList,e)}}if(s){const t=s.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=U.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],o=t.rowCount;t.rowIndex>i.endRow||(t.rowIndex>=i.startRow&&t.rowIndex<=i.endRow||(i.startRow-=o),i.endRow-=o)}this.modifyMerge(this._rectangleList,e)}}if(r){const t=r.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=U.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],o=t.columnCount;t.columnIndex>i.endColumn||(t.columnIndex>=i.startColumn&&t.columnIndex<=i.endColumn||(i.startColumn-=o),i.endColumn-=o)}this.modifyMerge(this._rectangleList,e)}}if(a){const t=a.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=U.deepClone(this._rectangleList),n=this.getByRowColumn(t.rangeData.startRow,t.rangeData.endRow,t.rangeData.startColumn,t.rangeData.endColumn);if(n&&n.forEach((t=>{const n=new Jn(t);for(let i=0;i<e.length;i++){const t=e[i];n.intersects(new Jn(t))&&e.splice(i,1)}})),t.shiftDimension)for(let i=0;i<e.length;i++){const n=e[i];if(n.endRow>=t.rangeData.startRow){if(n.endColumn<t.rangeData.startColumn)continue;if(n.startColumn>t.rangeData.endColumn)continue;if(!(n.startColumn>=t.rangeData.startColumn&&n.endColumn<=t.rangeData.endColumn))return;{const e=t.rangeData.endRow-t.rangeData.startRow;n.startRow-=e,n.endRow-=e}}}else for(let i=0;i<e.length;i++){const n=e[i];if(n.startColumn>t.rangeData.endColumn){if(n.endRow<t.rangeData.startRow)continue;if(n.startRow>t.rangeData.endRow)continue;if(!(n.startRow>=t.rangeData.startRow&&n.endRow<=t.rangeData.endRow))return;{const e=t.rangeData.endColumn-t.rangeData.startColumn;n.startColumn-=e,n.endColumn-=e}}}this.modifyMerge(this._rectangleList,e)}}}))}getMergeData(){return this._rectangleList}getByRowColumn(...t){const{_rectangleList:e}=this;let n;hi.checkup(t,hi.NUMBER_TYPE,hi.NUMBER_TYPE,hi.NUMBER_TYPE,hi.NUMBER_TYPE)?n=new Jn(t[0],t[2],t[1],t[3]):hi.checkup(t,hi.NUMBER_TYPE,hi.NUMBER_TYPE)&&(n=new Jn(t[0],t[1],t[0],t[1]));const i=[];for(let o=0;o<e.length;o++){const t=e[o];n.intersects(new Jn(t))&&i.push(t)}return i.length?i:null}remove(t){let e=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),i={actionName:xo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},o=new Ei({WorkBookUnit:n.getWorkBook()},i);e.invoke(o)}size(){return this._rectangleList.length}add(t){let e=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),i={actionName:xo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},o={actionName:mo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},s=new Ei({WorkBookUnit:n.getWorkBook()},i,o);e.invoke(s)}union(t){const{_rectangleList:e}=this,{length:n}=e;let i=new Jn(t);for(let o=0;o<n;o++){const t=e[o];i=i.union(new Jn(t))}return i.getData()}getMergedRanges(t){const{_rectangleList:e}=this,{length:n}=e,i=[];for(let o=0;o<n;o++){const n=e[o];new Jn(t).intersects(new Jn(n))&&i.push(n)}return i}modifyMerge(t,e){let n=this._worksheet.getCommandManager(),i=this._worksheet.getContext(),o={actionName:xo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...t]},s={actionName:mo.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...e]},r=new Ei({WorkBookUnit:i.getWorkBook()},o,s);n.invoke(r)}}const In={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function bn(t){return null!==t&&""!==t.toString().replace(/\s/g,"")&&("boolean"!=typeof t&&!Number.isNaN(t))}let An=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(An.getFullYear())&&(An=new Date("2/19/17"));const Cn=2017===An.getFullYear();const Sn=new Date(1900,2,1,0,0,0);function Nn(t){let e=null,n={},i=t;if(null===t)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(t)){e=t,i=Number(t.split(".")[0].replace(",",""));let o="#,##0";if(t.split(".")[1]){o="#,##0.";for(let e=0;e<t.split(".")[1].length;e++)o+=0}n={fa:o,t:"n"}}else if("'"===t.toString().substr(0,1))e=t.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===t.toString().toUpperCase())e="TRUE",n={fa:"General",t:"b"},i=!0;else if("FALSE"===t.toString().toUpperCase())e="FALSE",n={fa:"General",t:"b"},i=!1;else if(function(t){let e=!1;for(const n in In)if(t===In[n]){e=!0;break}return e}(t))e=t.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(t))e=t.toString(),n={fa:"@",t:"s"};else if(bn(t)&&Math.abs(parseFloat(t))>0&&(Math.abs(parseFloat(t))>=1e11||Math.abs(parseFloat(t))<1e-9)){i=u(t).value();const o=i.toExponential();if(o.indexOf(".")>-1){let t=o.split(".")[1].split("e")[0].length;t>5&&(t=5),n={fa:`#0.${new Array(t+1).join("0")}E+00`,t:"n"}}else n={fa:"#0.E+00",t:"n"};e=Rn.format(n.fa,i)}else if(t.toString().indexOf("%")>-1){const o=t.toString().indexOf("%");let s=t.toString().substr(0,o);const r=s.replace(/,/g,"");if(o===t.toString().length-1&&bn(r))if(s.indexOf(".")>-1)if(s.indexOf(".")===s.lastIndexOf(".")){const o=s.split(".")[0];let r=s.split(".")[1].length;if(r>9&&(r=9),o.indexOf(",")>-1){let s=!0,a=o.split(",");for(let t=1;t<a.length;t++)if(a[t].length<3){s=!1;break}s?(n={fa:`#,##0.${new Array(r+1).join("0")}%`,t:"n"},i=u(t).value(),e=Rn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else n={fa:`0.${new Array(r+1).join("0")}%`,t:"n"},i=u(t).value(),e=Rn.format(n.fa,i)}else e=t.toString(),n={fa:"@",t:"s"};else if(s.indexOf(",")>-1){let o=!0,r=s.split(",");for(let t=1;t<r.length;t++)if(r[t].length<3){o=!1;break}o?(n={fa:"#,##0%",t:"n"},i=u(t).value(),e=Rn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},i=u(t).value(),e=Rn.format(n.fa,i);else e=t.toString(),n={fa:"@",t:"s"}}else if(t.toString().indexOf(".")>-1)if(t.toString().indexOf(".")===t.toString().lastIndexOf(".")){const o=t.toString().split(".")[0];let s=t.toString().split(".")[1],r=s.length;if(r>9&&(r=9),o.indexOf(",")>-1){let s=!0,a=o.split(",");for(let t=1;t<a.length;t++)if(!bn(a[t])||a[t].length<3){s=!1;break}s?(n={fa:`#,##0.${new Array(r+1).join("0")}`,t:"n"},i=u(t).value(),e=Rn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else bn(o)&&bn(s)?(n={fa:`0.${new Array(r+1).join("0")}`,t:"n"},i=u(t).value(),e=Rn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else e=t.toString(),n={fa:"@",t:"s"};else bn(t)?(e=t.toString(),n={fa:"General",t:"n"},i=parseFloat(t)):null===(o=t)||o.toString().length<5||!function(t){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(t)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(t))return!1;const e=RegExp.$1,n=RegExp.$2,i=RegExp.$3;if(e<1900)return!1;if(n>12)return!1;if(i>31)return!1;if(2===n){if(29===new Date(e,1,29).getDate()&&i>29)return!1;if(29!==new Date(e,1,29).getDate()&&i>28)return!1}return!0}(o)||!(t.toString().indexOf(".")>-1||t.toString().indexOf(":")>-1||t.toString().length<16)?(e=t,n.fa="General",n.t="g"):(i=function(t,e){let n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());const i=Date.UTC(1899,11,31,0,0,0);return e?n-=1262304e5:t>=Sn&&(n+=864e5),(n-i)/864e5}(function(t,e){const n=new Date(t);if(Cn)return e>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):e<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(t instanceof Date)return t;if(1917===An.getFullYear()&&!Number.isNaN(n.getFullYear())){const e=n.getFullYear();return t.indexOf(`${e}`)>-1||n.setFullYear(n.getFullYear()+100),n}const i=t.match(/\d+/g)||["2017","2","19","0","0","0"];let o=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(o=new Date(o.getTime()-60*o.getTimezoneOffset()*1e3)),o}(t.toString().replace(/-/g,"/"))),i.toString().indexOf(".")>-1?t.toString().length>18?n.fa="yyyy-MM-dd hh:mm:ss":t.toString().length>11?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",e=Rn.format(n.fa,i));var o;return[e,n,i]}const Rn={format(t,e){}};class wn{static getApplyData(t,e,n,i,o){const s=this,r=[];s.applyType=i,s.direction=o;const a=Math.floor(n/e),l=n%e,h=t.number,c=[];if(h)for(let A=0;A<h.length;A++){const t=s.getLenS(h[A].index,l),r=h[A].index.length*a+t;let d;d=1===i?s.getDataByType(h[A].data,r,o,i,"number"):"2"===i?s.getDataByType(h[A].data,r,o,i):s.getDataByType(h[A].data,r,o,"0");const u=s.getDataIndex(e,n,h[A].index);c.push({data:d,index:u})}const d=t.extendNumber,u=[];if(d)for(let A=0;A<d.length;A++){const t=s.getLenS(d[A].index,l),r=d[A].index.length*a+t;let h;h="1"===i||"3"===i?s.getDataByType(d[A].data,r,o,i,"extendNumber"):"2"===i?s.getDataByType(d[A].data,r,o,i):s.getDataByType(d[A].data,r,o,"0");const c=s.getDataIndex(e,n,d[A].index);u.push({data:h,index:c})}const g=t.date,_=[];if(g)for(let A=0;A<g.length;A++){const t=s.getLenS(g[A].index,l),r=g[A].index.length*a+t;let h;h="1"===i||"3"===i?s.getDataByType(g[A].data,r,o,i,"date"):"8"===i?s.getDataByType(g[A].data,r,o,"0"):s.getDataByType(g[A].data,r,o,i);const c=s.getDataIndex(e,n,g[A].index);_.push({data:h,index:c})}const p=t.chnNumber,m=[];if(p)for(let A=0;A<p.length;A++){const t=s.getLenS(p[A].index,l),r=p[A].index.length*a+t;let h;h="1"===i||"3"===i?s.getDataByType(p[A].data,r,o,i,"chnNumber"):"2"===i||"8"===i?s.getDataByType(p[A].data,r,o,i):s.getDataByType(p[A].data,r,o,"0");const c=s.getDataIndex(e,n,p[A].index);m.push({data:h,index:c})}const T=t.chnWeek2,f=[];if(T)for(let A=0;A<T.length;A++){const t=s.getLenS(T[A].index,l),r=T[A].index.length*a+t;let h;h="1"===i||"3"===i?s.getDataByType(T[A].data,r,o,i,"chnWeek2"):"2"===i?s.getDataByType(T[A].data,r,o,i):s.getDataByType(T[A].data,r,o,"0");const c=s.getDataIndex(e,n,T[A].index);f.push({data:h,index:c})}const v=t.chnWeek3,E=[];if(v)for(let A=0;A<v.length;A++){const t=s.getLenS(v[A].index,l),r=v[A].index.length*a+t;let h;h="1"===i||"3"===i?s.getDataByType(v[A].data,r,o,i,"chnWeek3"):"2"===i?s.getDataByType(v[A].data,r,o,i):s.getDataByType(v[A].data,r,o,"0");const c=s.getDataIndex(e,n,v[A].index);E.push({data:h,index:c})}const I=t.other,b=[];if(I)for(let A=0;A<I.length;A++){const t=s.getLenS(I[A].index,l),r=I[A].index.length*a+t;let h;h="2"===i||"3"===i?s.getDataByType(I[A].data,r,o,i):s.getDataByType(I[A].data,r,o,"0");const c=s.getDataIndex(e,n,I[A].index);b.push({data:h,index:c})}for(let A=1;A<=n;A++){if(c.length>0)for(let t=0;t<c.length;t++)A in c[t].index&&r.push(c[t].data[c[t].index[A]]);if(u.length>0)for(let t=0;t<u.length;t++)A in u[t].index&&r.push(u[t].data[u[t].index[A]]);if(_.length>0)for(let t=0;t<_.length;t++)A in _[t].index&&r.push(_[t].data[_[t].index[A]]);if(m.length>0)for(let t=0;t<m.length;t++)A in m[t].index&&r.push(m[t].data[m[t].index[A]]);if(f.length>0)for(let t=0;t<f.length;t++)A in f[t].index&&r.push(f[t].data[f[t].index[A]]);if(E.length>0)for(let t=0;t<E.length;t++)A in E[t].index&&r.push(E[t].data[E[t].index[A]]);if(b.length>0)for(let t=0;t<b.length;t++)A in b[t].index&&r.push(b[t].data[b[t].index[A]])}return r}static getCopyData(t,e,n,i,o,s){const r=this,a=[];let l=0,h=0,c=0,d=0;s===se.BOTTOM||s===se.TOP?(l=i,h=o,c=e,d=n):s!==se.RIGHT&&s!==se.LEFT||(l=e,h=n,c=i,d=o);for(let u=l;u<=h;u++){const e={};let n=[],i=[],o="",s=null,l=null,h=!0;for(let a=c,u=0;a<=d;a++,u++){const g=t[u];let _;if(g&&g.v&&!g.f)if(g.fm&&g.fm.t===ae.NUMBER)_="number",s=null,l=null;else if(g.fm&&g.fm.t===ae.DATE)_="date",s=null,l=null;else if(r.isExtendNumber(g.m)[0]){_="extendNumber";const t=r.isExtendNumber(g.m);null===s||null===l?(h=!0,s=t[2],l=t[3]):t[2]!==s||t[3]!==l?(h=!1,s=t[2],l=t[3]):h=!0}else r.isChnNumber(g.m)?(_="chnNumber",s=null,l=null):r.isChnWeek2(g.m)?(_="chnWeek2",s=null,l=null):r.isChnWeek3(g.m)?(_="chnWeek3",s=null,l=null):(_="other",s=null,l=null);else _="other",s=null,l=null;"extendNumber"===_?a===c?c===d?(o=_,n.push(g),i.push(a-c+1),e[o]=[],e[o].push({data:n,index:i})):(o=_,n.push(g),i.push(a-c+1)):a===d?o===_&&h?(n.push(g),i.push(a-c+1),o in e||(e[o]=[],e[o].push({data:n,index:i}))):(o in e||(e[o]=[]),e[o].push({data:n,index:i}),o=_,n=[],n.push(g),i=[],i.push(a-c+1),o in e||(e[o]=[]),e[o].push({data:n,index:i})):o===_&&h?(n.push(g),i.push(a-c+1)):(o in e||(e[o]=[]),e[o].push({data:n,index:i}),o=_,n=[],n.push(g),i=[],i.push(a-c+1)):a===c?c===d?(o=_,n.push(g),i.push(a-c+1),e[o]=[],e[o].push({data:n,index:i})):(o=_,n.push(g),i.push(a-c+1)):a===d?o===_?(n.push(g),i.push(a-c+1),o in e||(e[o]=[]),e[o].push({data:n,index:i})):(o in e||(e[o]=[]),e[o].push({data:n,index:i}),o=_,n=[],n.push(g),i=[],i.push(a-c+1),o in e||(e[o]=[]),e[o].push({data:n,index:i})):o===_?(n.push(g),i.push(a-c+1)):(o in e||(e[o]=[]),e[o].push({data:n,index:i}),o=_,n=[],n.push(g),i=[],i.push(a-c+1))}a.push(e)}return a}static ChineseToNumber(t){const e=this;let n=0,i=0,o=0,s=!1;const r=t.split("");for(let a=0;a<r.length;a++){const t=e.chnNumChar[r[a]];if(void 0!==t)o=t,a===r.length-1&&(i+=o);else{const t=e.chnNameValue[r[a]].value;s=e.chnNameValue[r[a]].secUnit,s?(i=(i+o)*t,n+=i,i=0):i+=o*t,o=0}}return n+i}static NumberToChinese(t){const e=this;let n=0,i="",o="",s=!1;if(0===t)return e.chnNumChar2[0];for(;t>0;){const r=t%1e4;s&&(o=e.chnNumChar2[0]+o),i=e.SectionToChinese(r),i+=0!==r?e.chnUnitSection[n]:e.chnUnitSection[0],o=i+o,s=r<1e3&&r>0,t=Math.floor(t/1e4),n++}return o}static SectionToChinese(t){const e=this;let n="",i="",o=0,s=!0;for(;t>0;){const r=t%10;0===r?s||(s=!0,i=e.chnNumChar2[r]+i):(s=!1,n=e.chnNumChar2[r],n+=e.chnUnitChar[o],i=n+i),o++,t=Math.floor(t/10)}return i}static getLenS(t,e){let n=0;for(let i=0;i<t.length&&t[i]<=e;i++)n++;return n}static getDataByType(t,e,n,i,o){const s=this;let r=[];if(i===Ft.ALTERNATE_SERIES)n!==se.TOP&&n!==se.LEFT||t.reverse(),r=s.FillCopy(t,e);else if(i===Ft.DEFAULT_SERIES)if("number"===o)r=s.FillSeries(t,e,n);else if("extendNumber"===o)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillExtendNumber(t,e,i)}else{const i=[];for(let e=0;e<t.length;e++){const n=t[e].m;i.push(Number(s.isExtendNumber(n)[1]))}if(n!==se.TOP&&n!==se.LEFT||(t.reverse(),i.reverse()),s.isEqualDiff(i)){const n=i[1]-i[0];r=s.FillExtendNumber(t,e,n)}else r=s.FillCopy(t,e)}else if("date"===o)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillDays(t,e,i)}else{n!==se.TOP&&n!==se.LEFT||t.reverse();const i=s.judgeDate(t);if(i[0]&&i[3]){const n=g(t[1].m).diff(g(t[0].m),"months");r=s.FillMonths(t,e,n)}else if(!i[0]&&i[2]){const n=g(t[1].m).diff(g(t[0].m),"days");r=s.FillDays(t,e,n)}else r=s.FillCopy(t,e)}else if("chnNumber"===o)if(1===t.length)if("日"===t[0].m||s.ChineseToNumber(t[0].m)<7){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillChnWeek(t,e,i)}else{let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillChnNumber(t,e,i)}else{let i=!1;for(let e=0;e<t.length;e++)if("日"===t[e].m){i=!0;break}const o=[];let a=0;for(let e=0;e<t.length;e++)"日"===t[e].m?0===e?o.push(0):(a++,o.push(7*a)):i&&s.ChineseToNumber(t[e].m)>0&&s.ChineseToNumber(t[e].m)<7?o.push(s.ChineseToNumber(t[e].m)+7*a):o.push(s.ChineseToNumber(t[e].m));if(n!==se.TOP&&n!==se.LEFT||(t.reverse(),o.reverse()),s.isEqualDiff(o))if(i||o[o.length-1]<6&&o[0]>0||o[0]<6&&o[o.length-1]>0){const n=o[1]-o[0];r=s.FillChnWeek(t,e,n)}else{const n=o[1]-o[0];r=s.FillChnNumber(t,e,n)}else r=s.FillCopy(t,e)}else if("chnWeek2"===o)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillChnWeek2(t,e,i)}else{const i=[];let o=0;for(let e=0;e<t.length;e++){const n=t[e].m.substr(t[e].m.length-1,1);"周日"===t[e].m?0===e?i.push(0):(o++,i.push(7*o)):i.push(s.ChineseToNumber(n)+7*o)}if(n!==se.TOP&&n!==se.LEFT||(t.reverse(),i.reverse()),s.isEqualDiff(i)){const n=i[1]-i[0];r=s.FillChnWeek2(t,e,n)}else r=s.FillCopy(t,e)}else if("chnWeek3"===o)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillChnWeek3(t,e,i)}else{const i=[];let o=0;for(let e=0;e<t.length;e++){const n=t[e].m.substr(t[e].m.length-1,1);"星期日"===t[e].m?0===e?i.push(0):(o++,i.push(7*o)):i.push(s.ChineseToNumber(n)+7*o)}if(n!==se.TOP&&n!==se.LEFT||(t.reverse(),i.reverse()),s.isEqualDiff(i)){const n=i[1]-i[0];r=s.FillChnWeek3(t,e,n)}else r=s.FillCopy(t,e)}else n!==se.TOP&&n!==se.LEFT||t.reverse(),r=s.FillCopy(t,e);else if("2"===i)n!==se.TOP&&n!==se.LEFT||t.reverse(),r=s.FillOnlyFormat(t,e);else if("3"===i){const i=s.getDataByType(t,e,n,"1",o);r=s.FillWithoutFormat(i)}else if("4"===i)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillDays(t,e,i)}else if(2===t.length){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"days");r=s.FillDays(t,e,i)}else{n!==se.TOP&&n!==se.LEFT||t.reverse();const i=s.judgeDate(t);if(i[0]&&i[3]){const n=g(t[1].m).diff(g(t[0].m),"months");r=s.FillMonths(t,e,n)}else if(!i[0]&&i[2]){const n=g(t[1].m).diff(g(t[0].m),"days");r=s.FillDays(t,e,n)}else r=s.FillCopy(t,e)}else if("5"===i)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1);const o=Math.round(1.5*e);for(let n=1;n<=o;n++){const o=h({},t[n]),s=g(o.m).add(n,"days").day();if(0===s||6===s)continue;const a=g(o.m).add(i*n,"days").format("YYYY-MM-DD");if(o.m=a,o.v=Nn(a)[2],r.push(o),r.length===e)break}}else if(2===t.length)if(g(t[1].m).date()===g(t[0].m).date()&&0!==g(t[1].m).diff(g(t[0].m),"months")){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),s=g(t[t.length-1]).add(i*n,"months").day();let a;a=0===s?g(t[t.length-1]).add(i*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===s?g(t[t.length-1]).add(i*n,"months").subtract(1,"days").format("YYYY-MM-DD"):g(t[t.length-1]).add(i*n,"months").format("YYYY-MM-DD"),o.m=a,o.v=Nn(a)[2],r.push(o)}}else if(Math.abs(g(t[1].m).diff(g(t[0].m)))>7){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"months").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").day();let c;c=0===l?g(s.m).add(o,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(s.m).add(o,"days").subtract(1,"days").format("YYYY-MM-DD"):g(s.m).add(o,"days").format("YYYY-MM-DD"),s.m=c,s.v=Nn(c)[2],r.push(s)}}else{let i=0;n===se.BOTTOM||n===se.RIGHT?i=7:n!==se.TOP&&n!==se.LEFT||(i=-7,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"days").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").day();let c;c=0===l?g(s.m).add(o,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(s.m).add(o,"days").subtract(1,"days").format("YYYY-MM-DD"):g(s.m).add(o,"days").format("YYYY-MM-DD"),s.m=c,s.v=Nn(c)[2],r.push(s)}}else{const i=s.judgeDate(t);if(i[0]&&i[3]){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),s=g(t[t.length-1].m).add(i*n,"months").day();let a;a=0===s?g(t[t.length-1].m).add(i*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===s?g(t[t.length-1].m).add(i*n,"months").subtract(1,"days").format("YYYY-MM-DD"):g(t[t.length-1].m).add(i*n,"months").format("YYYY-MM-DD"),o.m=a,o.v=Nn(a)[2],r.push(o)}}else if(!i[0]&&i[2])if(Math.abs(g(t[1].m).diff(g(t[0].m)))>7){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"months").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").day();let c;c=0===l?g(s.m).add(o,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(s.m).add(o,"days").subtract(1,"days").format("YYYY-MM-DD"):g(s.m).add(o,"days").format("YYYY-MM-DD"),s.m=c,s.v=Nn(c)[2],r.push(s)}}else{let i=0;n===se.BOTTOM||n===se.RIGHT?i=7:n!==se.TOP&&n!==se.LEFT||(i=-7,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"days").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").day();let c;c=0===l?g(s.m).add(o,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(s.m).add(o,"days").subtract(1,"days").format("YYYY-MM-DD"):g(s.m).add(o,"days").format("YYYY-MM-DD"),s.m=c,s.v=Nn(c)[2],r.push(s)}}else n!==se.TOP&&n!==se.LEFT||t.reverse(),r=s.FillCopy(t,e)}else if("6"===i)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillMonths(t,e,i)}else if(2===t.length)if(g(t[1].m).date()===g(t[0].m).date()&&0!==g(t[1].m).diff(g(t[0].m),"months")){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");r=s.FillMonths(t,e,i)}else{let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"months").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").format("YYYY-MM-DD");s.m=l,s.v=Nn(l)[2],r.push(s)}}else{const i=s.judgeDate(t);if(i[0]&&i[3]){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");r=s.FillMonths(t,e,i)}else if(!i[0]&&i[2]){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"months").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").format("YYYY-MM-DD");s.m=l,s.v=Nn(l)[2],r.push(s)}}else n!==se.TOP&&n!==se.LEFT||t.reverse(),r=s.FillCopy(t,e)}else if("7"===i)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillYears(t,e,i)}else if(2===t.length)if(g(t[1].m).date()===g(t[0].m).date()&&g(t[1].m).month()===g(t[0].m).month()&&0!==g(t[1].m).diff(g(t[0].m),"years")){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"years");r=s.FillYears(t,e,i)}else{let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"years").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").format("YYYY-MM-DD");s.m=l,s.v=Nn(l)[2],r.push(s)}}else{const i=s.judgeDate(t);if(i[0]&&i[1]&&i[4]){n!==se.TOP&&n!==se.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"years");r=s.FillYears(t,e,i)}else if(i[0]&&i[3]||i[2]){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1,t.reverse());let o=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(o=g(s.m).add(i*a,"years").diff(g(s.m),"days"));const l=g(s.m).add(o,"days").format("YYYY-MM-DD");s.m=l,s.v=Nn(l)[2],r.push(s)}}else n!==se.TOP&&n!==se.LEFT||t.reverse(),r=s.FillCopy(t,e)}else if("8"===i)if(1===t.length){let i=0;n===se.BOTTOM||n===se.RIGHT?i=1:n!==se.TOP&&n!==se.LEFT||(i=-1),r=s.FillChnNumber(t,e,i)}else{const i=[];for(let e=0;e<t.length;e++)i.push(s.ChineseToNumber(t[e].m));if(n!==se.TOP&&n!==se.LEFT||(t.reverse(),i.reverse()),s.isEqualDiff(i)){const n=i[1]-i[0];r=s.FillChnNumber(t,e,n)}else r=s.FillCopy(t,e)}return r}static getDataIndex(t,e,n){const i={},o=Math.floor(e/t),s=e%t;let r=0;if(o>0){for(let e=1;e<=o;e++)for(let o=0;o<n.length;o++)i[n[o]+(e-1)*t]=r,r++;for(let e=0;e<n.length&&n[e]<=s;e++)i[n[e]+t*o]=r,r++}else for(let a=0;a<n.length&&n[a]<=s;a++)i[n[a]]=r,r++;return i}static FillCopy(t,e){const n=[];for(let i=1;i<=e;i++){const e=(i-1)%t.length,o=h({},t[e]);n.push(o)}return n}static FillSeries(t,e,n){const i=this,o=[],s=[];for(let r=0;r<t.length;r++)s.push(Number(t[r].v));if(t.length>2&&i.isEqualRatio(s))for(let r=1;r<=e;r++){const e=(r-1)%t.length,i=h({},t[e]);let s;n===se.BOTTOM||n===se.RIGHT?s=Number(t[t.length-1].v)*(Number(t[1].v)/Number(t[0].v))**r:n!==se.TOP&&n!==se.LEFT||(s=Number(t[0].v)/(Number(t[1].v)/Number(t[0].v))**r),i.v=s,i.m=s,o.push(i)}else{const r=i.getXArr(t.length);for(let a=1;a<=e;a++){const e=(a-1)%t.length,l=h({},t[e]);let c;n===se.BOTTOM||n===se.RIGHT?c=i.forecast(t.length+a,s,r):n!==se.TOP&&n!==se.LEFT||(c=i.forecast(1-a,s,r)),l.v=c,l.m=c,o.push(l)}}return o}static FillExtendNumber(t,e,n){const i=[],o=/0|([1-9]+[0-9]*)/g;for(let s=1;s<=e;s++){const e=(s-1)%t.length,r=h({},t[e]),a=t[t.length-1].m,l=a.match(o),c=l[l.length-1],d=Math.abs(Number(c)+n*s),u=a.lastIndexOf(c),g=a.substr(0,u)+d.toString()+a.substr(u+c.length);r.v=g,r.m=g,i.push(r)}return i}static FillOnlyFormat(t,e){const n=[];for(let i=1;i<=e;i++){const e=(i-1)%t.length,o=h({},t[e]);delete o.f,delete o.m,delete o.v,n.push(o)}return n}static FillWithoutFormat(t){const e=[];for(let n=0;n<t.length;n++){const i=h({},t[n]);let o;o=null===i.f?{m:i.v.toString(),v:i.v}:{f:i.f,m:i.v.toString(),v:i.v},e.push(o)}return e}static FillDays(t,e,n){const i=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,s=h({},t[e]);let r=void s.v;r=g(r).add(n*o,"days").format("YYYY-MM-DD"),s.v=Nn(r)[2],s.m=(s.fm.f,void s.v),i.push(s)}return i}static FillMonths(t,e,n){const i=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,s=h({},t[e]);let r=void s.v;r=g(r).add(n*o,"months").format("YYYY-MM-DD"),s.v=Nn(r)[2],s.m=(s.fm.f,void s.v),i.push(s)}return i}static FillYears(t,e,n){const i=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,s=h({},t[e]);let r=void s.v;r=g(r).add(n*o,"years").format("YYYY-MM-DD"),s.v=Nn(r)[2],s.m=(s.fm.t,void s.v),i.push(s)}return i}static FillChnWeek(t,e,n){const i=this,o=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,r=h({},t[e]);let a;a="日"===t[t.length-1].m?7+n*s:i.ChineseToNumber(t[t.length-1].m)+n*s,a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(r.m="日",r.v="日"):1===l?(r.m="一",r.v="一"):2===l?(r.m="二",r.v="二"):3===l?(r.m="三",r.v="三"):4===l?(r.m="四",r.v="四"):5===l?(r.m="五",r.v="五"):6===l&&(r.m="六",r.v="六"),o.push(r)}return o}static FillChnWeek2(t,e,n){const i=this,o=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,r=h({},t[e]);let a;if("周日"===t[t.length-1].m)a=7+n*s;else{const e=t[t.length-1].m,o=e.substr(e.length-1,1);a=i.ChineseToNumber(o)+n*s}a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(r.m="周日",r.v="周日"):1===l?(r.m="周一",r.v="周一"):2===l?(r.m="周二",r.v="周二"):3===l?(r.m="周三",r.v="周三"):4===l?(r.m="周四",r.v="周四"):5===l?(r.m="周五",r.v="周五"):6===l&&(r.m="周六",r.v="周六"),o.push(r)}return o}static FillChnWeek3(t,e,n){const i=this,o=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,r=h({},t[e]);let a;if("星期日"===t[t.length-1].m)a=7+n*s;else{const e=t[t.length-1].m,o=e.substr(e.length-1,1);a=i.ChineseToNumber(o)+n*s}a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(r.m="星期日",r.v="星期日"):1===l?(r.m="星期一",r.v="星期一"):2===l?(r.m="星期二",r.v="星期二"):3===l?(r.m="星期三",r.v="星期三"):4===l?(r.m="星期四",r.v="星期四"):5===l?(r.m="星期五",r.v="星期五"):6===l&&(r.m="星期六",r.v="星期六"),o.push(r)}return o}static FillChnNumber(t,e,n){const i=this,o=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,r=h({},t[e]),a=i.ChineseToNumber(t[t.length-1].m)+n*s;let l;l=a<=0?"零":i.NumberToChinese(a),r.v=l,r.m=l.toString(),o.push(r)}return o}static isEqualDiff(t){let e=!0;const n=t[1]-t[0];for(let i=1;i<t.length;i++)if(t[i]-t[i-1]!==n){e=!1;break}return e}static isChnNumber(t){const e=this;let n=!0;if(1===t.length)n="日"===t||t in e.chnNumChar;else{const i=t.split("");for(let t=0;t<i.length;t++)if(!(i[t]in e.chnNumChar)&&!(i[t]in e.chnNameValue)){n=!1;break}}return n}static isExtendNumber(t){const e=/0|([1-9]+[0-9]*)/g,n=e.test(t);if(n){const i=t.match(e),o=i[i.length-1],s=t.lastIndexOf(o),r=t.substr(0,s),a=t.substr(s+o.length);return[n,Number(o),r,a]}return[n]}static isChnWeek1(t){const e=this;let n;return n=1===t.length&&("日"===t||e.ChineseToNumber(t)<7),n}static isChnWeek2(t){let e;return e=2===t.length&&("周一"===t||"周二"===t||"周三"===t||"周四"===t||"周五"===t||"周六"===t||"周日"===t),e}static isChnWeek3(t){let e;return e=3===t.length&&("星期一"===t||"星期二"===t||"星期三"===t||"星期四"===t||"星期五"===t||"星期六"===t||"星期日"===t),e}static isEqualRatio(t){let e=!0;const n=t[1]/t[0];for(let i=1;i<t.length;i++)if(t[i]/t[i-1]!==n){e=!1;break}return e}static getXArr(t){const e=[];for(let n=1;n<=t;n++)e.push(n);return e}static forecast(t,e,n){function i(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}const o=i(n),s=i(e);let r,a=0,l=0;for(let c=0;c<n.length;c++)a+=(n[c]-o)*(e[c]-s),l+=(n[c]-o)*(n[c]-o);r=0===l?1:a/l;const h=s-r*o;return Math.round(1e5*(h+r*t))/1e5}static judgeDate(t){let e=!0,n=!0,i=!0,o=!0,s=!0;const r=g(t[0].m).date(),a=g(t[0].m).month(),l=g(t[1].m).diff(g(t[0].m),"days"),h=g(t[1].m).diff(g(t[0].m),"months"),c=g(t[1].m).diff(g(t[0].m),"years");for(let d=1;d<t.length;d++)g(t[d].m).date()!==r&&(e=!1),g(t[d].m).month()!==a&&(n=!1),g(t[d].m).diff(g(t[d-1].m),"days")!==l&&(i=!1),g(t[d].m).diff(g(t[d-1].m),"months")!==h&&(o=!1),g(t[d].m).diff(g(t[d-1].m),"years")!==c&&(s=!1);return 0===l&&(i=!1),0===h&&(o=!1),0===c&&(s=!1),[e,n,i,o,s]}}class On{constructor(t,e){this._context=t.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=t,this._rangeList=[],e.forEach((t=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(t).rangeData)})),-1===this._rangeList[0].startRow&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return-1===this._rangeList[0].startRow?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:o}=this;const s=e.map((e=>{let{startRow:n,startColumn:i,endRow:s,endColumn:r}=e,a=new H;for(let o=n;o<=s;o++)for(let e=i;e<=r;e++)a.setValue(n,i,{m:`${t}`,v:t});return{sheetId:o.getSheetId(),actionName:Ao.NAME,cellValue:a.getData()}}));let r=new Ei({WorkBookUnit:n.getWorkBook()},...s);return i.invoke(r),this}clear(...t){const{_context:e,_worksheet:n,_commandManager:i,_rangeList:o}=this;let s={formatOnly:!0,contentsOnly:!0};hi.checkup(t,hi.OBJECT_TYPE)&&(s=t[0]);const r=o.map((t=>({sheetId:n.getSheetId(),actionName:Co.NAME,options:s,rangeData:t})));let a=new Ei({WorkBookUnit:e.getWorkBook()},...r);return i.invoke(a),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}setBackground(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:o}=this;const s=e.map((e=>{let{startRow:n,startColumn:i,endRow:s,endColumn:r}=e;const a={bg:{rgb:t}},l=U.fillObjectMatrix(s-n+1,r-i+1,a);return{sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Ei({WorkBookUnit:n.getWorkBook()},...s);return i.invoke(r),this}setBackgroundRGB(t,e,n){const i=`RGB(${t},${e},${n})`;let{_rangeList:o,_context:s,_commandManager:r,_worksheet:a}=this;const l=o.map((t=>{let{startRow:e,startColumn:n,endRow:o,endColumn:s}=t;const r={bg:{rgb:i}},l=U.fillObjectMatrix(o-e+1,s-n+1,r);return{sheetId:a.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let h=new Ei({WorkBookUnit:s.getWorkBook()},...l);return r.invoke(h),this}setFontColor(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:o}=this;const s=e.map((e=>{let{startRow:n,startColumn:i,endRow:s,endColumn:r}=e;const a={cl:{rgb:t}},l=U.fillObjectMatrix(s-n+1,r-i+1,a);return{sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Ei({WorkBookUnit:n.getWorkBook()},...s);return i.invoke(r),this}setFontFamily(t){return this._setStyle(t,"ff")}setUnderline(t){const e={s:t?Fe.TRUE:Fe.FALSE};return this._setStyle(e,"ul")}setOverline(t){const e={s:t?Fe.TRUE:Fe.FALSE};return this._setStyle(e,"ol")}setStrikeThrough(t){const e={s:t?Fe.TRUE:Fe.FALSE};return this._setStyle(e,"st")}setFontSize(t){return this._setStyle(t,"fs")}setFontStyle(t){const e=t?Fe.TRUE:Fe.FALSE;return this._setStyle(e,"it")}setFontWeight(t){const e=t?Fe.TRUE:Fe.FALSE;return this._setStyle(e,"bl")}setHorizontalAlignment(t){return this._setStyle(t,"ht")}setTextDirection(t){return this._setStyle(t,"td")}setTextRotation(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:o}=this;const s=e.map((e=>{let{startRow:n,startColumn:i,endRow:s,endColumn:r}=e;const a={tr:{v:0,a:Number(t)}},l=U.fillObjectMatrix(s-n+1,r-i+1,a);return{sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Ei({WorkBookUnit:n.getWorkBook()},...s);return i.invoke(r),this}setVerticalAlignment(t){return this._setStyle(t,"vt"),this}setVerticalText(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:o}=this;const s=e.map((e=>{let{startRow:n,startColumn:i,endRow:s,endColumn:r}=e;const a={tr:{v:t,a:0}},l=U.fillObjectMatrix(s-n+1,r-i+1,a);return{sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Ei({WorkBookUnit:n.getWorkBook()},...s);return i.invoke(r),this}setWrap(t){return this._setStyle(t,"tb")}setWrapStrategy(t){return this._setStyle(t,"tb")}trimWhitespace(){let{_rangeList:t,_context:e,_commandManager:n,_worksheet:i}=this;const o=t.map((t=>{let{startRow:e,startColumn:n,endRow:o,endColumn:s}=t;const r=this._worksheet.getCellMatrix(),a=/\s+/g;let l=new H;for(let i=e;i<o+1;i++)for(let t=n;t<s+1;t++){const e=r.getValue(i,t).m.replace(a,"");l.setValue(i,t,e||"")}return{sheetId:i.getSheetId(),actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:l.getData(),rangeData:t}}));let s=new Ei({WorkBookUnit:e.getWorkBook()},...o);return n.invoke(s),this}_setStyle(t,e){let{_rangeList:n,_context:i,_commandManager:o,_worksheet:s}=this;const r=n.map((n=>{let{startRow:i,startColumn:o,endRow:r,endColumn:a}=n;const l={[e]:t},h=U.fillObjectMatrix(r-i+1,a-o+1,l);return{sheetId:s.getSheetId(),value:h,rangeData:n,actionName:Ko.NAME}}));let a=new Ei({WorkBookUnit:i.getWorkBook()},...r);return o.invoke(a),this}}class yn{constructor(t,e){this._workSheet=t,this._rowData=new x(e)}getRowData(){return this._rowData}getRowDatas(t,e){const n=new x;for(let i=t;i<t+e;i++){const t=this.getRowOrCreate(i);n.push(t)}return n}getRowHeight(...t){const{_workSheet:e}=this,{_rowData:n}=this,i=e.getConfig();let o=0;if(1===t.length){o=n.obtain(t[0],{hd:Fe.FALSE,h:i.defaultRowHeight}).h}else if(2===t.length)for(let s=t[0];s<t[0]+t[1];s++){o+=n.obtain(s,{hd:Fe.FALSE,h:i.defaultRowHeight}).h}return o}setRowHeight(t,e){const n=this._workSheet.getContext(),i=this._workSheet.getCommandManager(),o={sheetId:this._workSheet.getSheetId(),actionName:qo.NAME,rowIndex:t,rowHeight:e},s=new Ei({WorkBookUnit:n.getWorkBook()},o);i.invoke(s)}getRow(t){const{_rowData:e}=this;return e.get(t)}getSize(){return this._rowData.getLength()}getRowOrCreate(t){const{_workSheet:e}=this,{_rowData:n}=this,i=n.get(t);if(i)return i;const o=e.getConfig(),s={hd:Fe.FALSE,h:o.defaultRowHeight};return n.set(t,s),s}}class Mn{constructor(...t){var e;if(U.hasLength(t,1)){t=[t[0],c(h({},Ze),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:Fe.FALSE},columnTitle:{height:20,hidden:Fe.FALSE},selections:["A1"],rightToLeft:Fe.FALSE,pluginMeta:{}})]}if(U.hasLength(t,2)){this._context=t[0],this._config=Object.assign(t[1],h(c(h({},Ze),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:Fe.FALSE},columnTitle:{height:20,hidden:Fe.FALSE},selections:["A1"],rightToLeft:Fe.FALSE,pluginMeta:{}}),t[1]));const{columnData:n,rowData:i,cellData:o}=this._config;this._sheetId=null!=(e=this._config.id)?e:U.generateRandomId(6),this._initialized=!1,this._cellData=new H(o),this._rowManager=new yn(this,i),this._columnManager=new vn(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===Fe.TRUE)return this;const{_context:t}=this,e=this.getCommandManager(),n=t.getContextObserver("onBeforeChangeActiveSheetObservable"),i=t.getContextObserver("onAfterChangeActiveSheetObservable"),o={sheetId:this._sheetId,actionName:rs.NAME,status:Fe.TRUE},s=new Ei({WorkBookUnit:t.getWorkBook()},o);return n.notifyObservers({sheet:this}),e.invoke(s),i.notifyObservers({sheet:this}),this}setConfig(t){return this._config=U.commonExtend(Ze,t),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o=e.getContextObserver("onBeforeChangeSheetNameObservable"),s=e.getContextObserver("onAfterChangeSheetNameObservable"),r={actionName:cs.NAME,sheetName:t,sheetId:n},a=e.getWorkBook().getSheets();for(let h=0;h<a.length;h++){const e=a[h];if(e!==this&&e.getName()===t)return console.warn("Duplicate name"),this}o.notifyObservers();const l=new Ei({WorkBookUnit:e.getWorkBook()},r);return i.invoke(l),s.notifyObservers({name:t,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:t,_context:e}=this,n=U.deepClone(t);return new Mn(e,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._context.getCommandManager()}getSheetData(){return[]}getRange(...t){return U.hasLength(t,1)?new Dn(this,t[0]):U.hasLength(t,2)?new Dn(this,{row:[t[0],t[0]],column:[t[1],t[1]]}):U.hasLength(t,3)?new Dn(this,{row:[t[0],t[2]],column:[t[1],t[1]]}):U.hasLength(t,4)?new Dn(this,{row:[t[0],t[2]],column:[t[1],t[3]]}):void 0}getRangeList(t){return new On(this,t)}getStatus(){const{_config:t}=this;return t.status}setStatus(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o={actionName:ds.NAME,sheetId:n,sheetStatus:t},s=new Ei({WorkBookUnit:e.getWorkBook()},o);return i.invoke(s),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o={actionName:us.NAME,zoom:t,sheetId:n},s=new Ei({WorkBookUnit:e.getWorkBook()},o);i.invoke(s);e.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:t})}getSelection(){return this._selection}copy(t){const{_config:e,_context:n}=this,i=U.deepClone(e);return i.name=t,i.status=Fe.FALSE,i.id=U.generateRandomId(),new Mn(n,i)}getConfig(){return this._config}insertRows(...t){let e=0,n=1;U.hasLength(t,1)&&(e=t[0]),U.hasLength(t,2)&&(e=t[0],n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:yo.NAME,sheetId:o,rowIndex:e,rowData:H.MakeObjectMatrixSize(n).toJSON()},a={actionName:Oo.NAME,sheetId:o,rowIndex:e,rowCount:n},l=new Ei({WorkBookUnit:i.getWorkBook()},r,a);return s.invoke(l),this}insertRowAfter(...t){let e=0,n=1;U.hasLength(t,1)&&(e=t[0]+1),U.hasLength(t,2)&&(e=t[0]+1,n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:yo.NAME,sheetId:o,rowIndex:e,rowData:H.MakeObjectMatrixSize(n).toJSON()},a={actionName:Oo.NAME,sheetId:o,rowIndex:e,rowCount:n},l=new Ei({WorkBookUnit:i.getWorkBook()},r,a);return s.invoke(l),this}insertRowBefore(...t){let e=0,n=1;U.hasLength(t,1)&&(e=t[0]-1),U.hasLength(t,2)&&(e=t[0]-1,n=t[1]),e<0&&(e=0);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:yo.NAME,sheetId:o,rowIndex:e,rowData:H.MakeObjectMatrixSize(n).toJSON()},a={actionName:Oo.NAME,sheetId:o,rowIndex:e,rowCount:n},l=new Ei({WorkBookUnit:i.getWorkBook()},r,a);return s.invoke(l),this}insertColumns(...t){let e=0,n=1;U.hasLength(t,1)&&(e=t[0]),U.hasLength(t,2)&&(e=t[0],n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r=new H;this._cellData.forEach((t=>{for(let i=e;i<e+n;i++)r.setValue(t,i-e,{})}));const a={actionName:wo.NAME,sheetId:o,columnIndex:e,columnData:r.toJSON()},l={actionName:Ro.NAME,sheetId:o,columnIndex:e,columnCount:n},h=new Ei({WorkBookUnit:i.getWorkBook()},l,a);return s.invoke(h),this}insertColumnBefore(...t){let e=0,n=1;U.hasLength(t,1)&&(e=t[0]-1),U.hasLength(t,2)&&(e=t[0]-1,n=t[1]),e<0&&(e=0);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r=new H;if(this._cellData.getLength())this._cellData.forEach((t=>{for(let i=e;i<e+n;i++)r.setValue(t,i-e,{})}));else for(let c=0;c<this._config.rowCount;c++)for(let t=e;t<e+n;t++)r.setValue(c,t-e,{});const a={actionName:wo.NAME,sheetId:o,columnIndex:e,columnData:r.toJSON()},l={actionName:Ro.NAME,sheetId:o,columnIndex:e,columnCount:n},h=new Ei({WorkBookUnit:i.getWorkBook()},l,a);return s.invoke(h),this}insertColumnAfter(...t){let e=0,n=1;U.hasLength(t,1)&&(e=t[0]+1),U.hasLength(t,2)&&(e=t[0]+1,n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r=new H;this._cellData.forEach((t=>{for(let i=e;i<e+n;i++)r.setValue(t,i-e,{})}));const a={actionName:wo.NAME,sheetId:o,columnIndex:e,columnData:r.toJSON()},l={actionName:Ro.NAME,sheetId:o,columnIndex:e,columnCount:n},h=new Ei({WorkBookUnit:i.getWorkBook()},a,l);return s.invoke(h),this}clear(...t){const{_context:e}=this,n=this.getCommandManager(),i={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let o={formatOnly:!0,contentsOnly:!0};hi.checkup(t,hi.OBJECT_TYPE)&&(o=t[0]);const s={sheetId:this._sheetId,actionName:Co.NAME,options:o,rangeData:i},r=new Ei({WorkBookUnit:e.getWorkBook()},s);return n.invoke(r),this}setTabColor(t){const{_context:e}=this,n=this.getCommandManager(),i=e.getContextObserver("onSheetTabColorChangeObservable"),o={sheetId:this._sheetId,actionName:os.NAME,color:t},s=new Ei({WorkBookUnit:e.getWorkBook()},o);return n.invoke(s),i.notifyObservers(),this}hideSheet(){const{_context:t}=this,e=this.getCommandManager(),n=t.getWorkBook();if(!this._config.hidden){const i=t.getContextObserver("onHideSheetObservable"),o={hidden:Fe.TRUE,sheetId:this._sheetId,actionName:ls.NAME},s=new Ei({WorkBookUnit:t.getWorkBook()},o);e.invoke(s),i.notifyObservers({sheet:this});const r=n.getSheetIndex(this);null!=r&&n.activateSheetByIndex(r)}return this}showSheet(){if(!this._config.hidden)return this;const{_context:t}=this,e=this.getCommandManager(),n={hidden:Fe.FALSE,sheetId:this._sheetId,actionName:ls.NAME},i=new Ei({WorkBookUnit:t.getWorkBook()},n);return e.invoke(i),t.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setActiveSelection(...t){const e=t[0];return e?this._selection.setSelection({selection:e}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:t}=this,{columnCount:e}=t;return e}getMaxRows(){const{_config:t}=this,{rowCount:e}=t;return e}getType(){const{_config:t}=this,{type:e}=t;return e}clearContents(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o={actionName:Lo.NAME,sheetId:n,columnCount:1,columnIndex:t},s={actionName:Do.NAME,sheetId:n,columnCount:1,columnIndex:t},r=new Ei({WorkBookUnit:e.getWorkBook()},o,s);return i.invoke(r),this}deleteColumns(t,e){const{_context:n,_sheetId:i}=this,o=this.getCommandManager(),s={actionName:Lo.NAME,sheetId:i,columnCount:e,columnIndex:t},r={actionName:Do.NAME,sheetId:i,columnCount:e,columnIndex:t},a=new Ei({WorkBookUnit:n.getWorkBook()},s,r);return o.invoke(a),this}deleteRow(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o={actionName:Ho.NAME,sheetId:n,rowCount:1,rowIndex:t},s={actionName:ko.NAME,sheetId:n,rowCount:1,rowIndex:t},r=new Ei({WorkBookUnit:e.getWorkBook()},o,s);return i.invoke(r),this}deleteRows(t,e){const{_context:n,_sheetId:i}=this,o=this.getCommandManager(),s={actionName:Ho.NAME,sheetId:i,rowCount:e,rowIndex:t},r={actionName:ko.NAME,sheetId:i,rowCount:e,rowIndex:t},a=new Ei({WorkBookUnit:n.getWorkBook()},s,r);return o.invoke(a),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(t,e,n){const{_sheetId:i}=this,o=this.getCommandManager(),s=this.getContext(),r=this.getCellMatrix(),a=s.getWorkBook(),l=a.getStyles(),h=this.getRange({startRow:t.startRow-1,startColumn:t.startColumn,endRow:t.startRow-1,endColumn:t.endColumn}),c=this.getRange({startRow:t.startRow,startColumn:t.startColumn-1,endRow:t.startRow,endColumn:t.endColumn-1}),d=this.getRange({startRow:t.endRow+1,startColumn:t.startColumn,endRow:t.endRow+1,endColumn:t.endColumn}),u=this.getRange({startRow:t.startRow,startColumn:t.endColumn+1,endRow:t.startRow,endColumn:t.endColumn+1}),g=this.getRange(t),_=new H,p=new H,m=new H,T=new H,f=new H;h.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=U.deepClone(i);n.bd&&delete n.bd.b,_.setValue(t,e,n)}}})),d.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=U.deepClone(i);n.bd&&delete n.bd.t,m.setValue(t,e,n)}}})),c.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=U.deepClone(i);n.bd&&delete n.bd.r,p.setValue(t,e,n)}}})),u.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=U.deepClone(i);n.bd&&delete n.bd.l,T.setValue(t,e,n)}}})),g.forEach(((t,n)=>{f.setValue(t,n,e)}));const v=[];if(n.includes(se.TOP)){const t={sheetId:i,actionName:Bo.NAME,styles:m.toJSON()};v.push(t)}if(n.includes(se.BOTTOM)){const t={sheetId:i,actionName:Bo.NAME,styles:_.toJSON()};v.push(t)}if(n.includes(se.LEFT)){const t={sheetId:i,actionName:Bo.NAME,styles:T.toJSON()};v.push(t)}if(n.includes(se.RIGHT)){const t={sheetId:i,actionName:Bo.NAME,styles:p.toJSON()};v.push(t)}const E={sheetId:i,actionName:Bo.NAME,styles:f.toJSON()};v.push(E);const I=new Ei({WorkBookUnit:a},...v);return o.invoke(I),this}setCurrentCell(t){return t.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex((t=>t&&t.getSheetId()===this._sheetId));return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(t){return this.getSelection().setSelection(t)}setActiveRangeList(t){const e=this.getSelection();return e.setSelection(t),e.getActiveRangeList()}hideRow(t){const e=t.getRangeData(),n=e.startRow,i=e.endRow-e.startRow+1,{_context:o,_sheetId:s}=this,r=this.getCommandManager(),a={actionName:Qo.NAME,sheetId:s,rowCount:i,rowIndex:n},l=new Ei({WorkBookUnit:o.getWorkBook()},a);return r.invoke(l),this}hideRows(...t){const e=--t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:Qo.NAME,sheetId:o,rowCount:n,rowIndex:e},a=new Ei({WorkBookUnit:i.getWorkBook()},r);return s.invoke(a),this}hideColumn(t){const e=t.getRangeData(),n=e.startColumn,i=e.endColumn-e.startColumn+1,{_context:o,_sheetId:s}=this,r=this.getCommandManager(),a={actionName:Fo.NAME,sheetId:s,columnCount:i,columnIndex:n},l=new Ei({WorkBookUnit:o.getWorkBook()},a);return r.invoke(l),this}hideColumns(...t){const e=t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:Fo.NAME,sheetId:o,columnCount:n,columnIndex:e},a=new Ei({WorkBookUnit:i.getWorkBook()},r);return s.invoke(a),this}unhideRow(t){const e=t.getRangeData(),n=e.startRow,i=e.endRow-e.startRow+1,{_context:o,_sheetId:s}=this,r=this.getCommandManager(),a={actionName:Jo.NAME,rowCount:i,rowIndex:n,sheetId:s},l=new Ei({WorkBookUnit:o.getWorkBook()},a);return r.invoke(l),this}unhideColumn(t){const e=t.getRangeData(),n=e.startColumn,i=e.endColumn-e.startColumn+1,{_context:o,_sheetId:s}=this,r=this.getCommandManager(),a={actionName:Uo.NAME,sheetId:s,columnCount:i,columnIndex:n},l=new Ei({WorkBookUnit:o.getWorkBook()},a);return r.invoke(l),this}showColumns(...t){const e=t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:Uo.NAME,sheetId:o,columnCount:n,columnIndex:e},a=new Ei({WorkBookUnit:i.getWorkBook()},r);return s.invoke(a),this}showRows(...t){const e=--t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:o}=this,s=this.getCommandManager(),r={actionName:Jo.NAME,sheetId:o,rowCount:n,rowIndex:e},a=new Ei({WorkBookUnit:i.getWorkBook()},r);return s.invoke(a),this}hasHiddenGridlines(){const{_config:t}=this,{showGridlines:e}=t;return 0===e}getTabColor(){const{_config:t}=this,{tabColor:e}=t;return e}getColumnWidth(t){return this.getColumnManager().getColumnWidth(t)}getRowHeight(t){return this.getRowManager().getRowHeight(t)}setColumnWidth(...t){let e,n=[];if(U.hasLength(t,2)&&(e=t[0],n=[t[1]]),U.hasLength(t,3)){e=t[0];for(let e=0;e<t[1];e++)n.push(t[2])}return this.getColumnManager().setColumnWidth(e,n),this}setRowHeights(t,e,n){const i=[];for(let o=0;o<e;o++)i.push(n);return this.getRowManager().setRowHeight(t,i),this}setRowHeight(t,e){const n=[e];return this.getRowManager().setRowHeight(t,n),this}setHiddenGridlines(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o={actionName:Wo.NAME,hideGridlines:t,sheetId:n},s=new Ei({WorkBookUnit:e.getWorkBook()},o);return i.invoke(s),this}isRightToLeft(){const{_config:t}=this,{rightToLeft:e}=t;return e}setRightToLeft(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),o={actionName:Zo.NAME,rightToLeft:t,sheetId:n},s=new Ei({WorkBookUnit:e.getWorkBook()},o);return i.invoke(s),this}getPluginMeta(t){return this._config.pluginMeta[t]}setPluginMeta(t,e){this._config.pluginMeta[t]=e}copyTo(t){const e=this._context.getWorkBook().getSheets()[t];if(!e)return this;const n=U.deepClone(this._config);return n.sheetId=e.getConfig().id,e.setConfig(n),e}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(t,e,n,i){return new Dn(this,{startRow:t,startColumn:e,endRow:t+n-1,endColumn:e+i-1}).getValues()}getDataRange(){return new Dn(this,this._cellData.getRange())}moveRows(t,e){const{startRow:n}=t.getRangeData(),{endRow:i}=t.getRangeData(),o=this._cellData.spliceRows(n,i-n+1);return this._cellData.insertRows(e,o),this}moveColumns(t,e){const n=t.getRangeData().startColumn,i=t.getRangeData().endColumn,o=this._cellData.spliceColumns(n,i-n+1);return this._cellData.insertColumns(e,o),this}_initialize(){this._merges=new En(this,this._config.mergeData)}}class Dn{constructor(t,e){this._context=t.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(e).rangeData,this._worksheet=t,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}static foreach(t,e){const{startRow:n,startColumn:i,endRow:o,endColumn:s}=t;for(let r=n;r<=o;r++)for(let t=i;t<=s;t++)e(r,t)}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData,o=[];for(let s=t;s<=e;s++){const t=[];for(let e=n;e<=i;e++)t.push(this.getMatrix().getValue(s,e)||null);o.push(t)}return o}getMatrix(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData,o=this._worksheet.getCellMatrix(),s=new H;for(let r=t;r<=e;r++)for(let t=n;t<=i;t++)s.setValue(r,t,o.getValue(r,t)||null);return s}getMatrixObject(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData,o=this._worksheet.getCellMatrix(),s=new H;for(let r=t;r<=e;r++)for(let e=n;e<=i;e++)s.setValue(r-t,e-n,o.getValue(r,e)||{});return s}getDisplayValue(){const t=this.getValue();return t&&t.p?t.p:t&&t.m?t.m:""}getDisplayValues(){return this.getValues().map((t=>t.map((t=>t&&t.p?t.p:t&&t.m?t.m:""))))}getA1Notation(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData;let o,s;return n<i?(o=U.numToWord(n+1)+(t+1),s=U.numToWord(i+1)+(e+1)):(o=U.numToWord(i+1)+(e+1),s=U.numToWord(n+1)+(t+1)),o===s?`${o}`:`${o}:${s}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map((t=>t.map((t=>{var e,n,i;const o=this._context.getWorkBook().getStyles();let s=null==(e=qe.bg)?void 0:e.rgb;return s=null==(i=null==(n=o.getStyleByCell(t))?void 0:n.bg)?void 0:i.rgb,s}))))}getCell(t,e){const{startRow:n,endRow:i,startColumn:o,endColumn:s}=this._rangeData,r={startRow:n+t,endRow:n+t,startColumn:o+e,endColumn:o+e};return new Dn(this._worksheet,r)}getColumn(){return this._rangeData.startColumn}getObjectValue(t={}){return this.getObjectValues(t)[0][0]}getObjectValues(t={}){const{startRow:e,endRow:n,startColumn:i,endColumn:o}=this._rangeData,s=this._worksheet.getCellMatrix().getFragments(e,n,i,o).getData();if(t.isIncludeStyle){const t=this._context.getWorkBook().getStyles();for(let r=0;r<=n-e;r++)for(let e=0;e<=o-i;e++){if(!s[r][e])continue;const n=s[r][e].s;n&&(s[r][e].s=t.get(n))}}return s}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map((t=>t.map((t=>{var e,n;const i=this._context.getWorkBook().getStyles().getStyleByCell(t);return(null==(e=null==i?void 0:i.cl)?void 0:e.rgb)||(null==(n=qe.cl)?void 0:n.rgb)}))))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:t,_worksheet:e}=this,{startRow:n,endRow:i}=t;let o=0;for(let s=0;s<=i-n;s++){o+=e.getRowHeight(s)}return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:t,endRow:e,startColumn:n,endColumn:i}).map((t=>new Dn(this._worksheet,t)))}getNextDataCell(t){const{_worksheet:e}=this,{startRow:n,endRow:i,startColumn:o,endColumn:s}=this._rangeData,r=e.getMaxRows(),a=e.getMaxColumns();if(t===se.BOTTOM){for(let t=0;t<r-o;t++){this._worksheet.getCellMatrix().getValue(n+t,o)&&e.getRange(n+t,o,n+t,o)}return e.getRange(r,o,r,o)}if(t===se.TOP){for(let t=0;t<n;t++){this._worksheet.getCellMatrix().getValue(n-t,o)&&e.getRange(n-t,o,n-t,n)}return e.getRange(0,o,0,o)}if(t===se.RIGHT){for(let t=0;t<a-o;t++){this._worksheet.getCellMatrix().getValue(n,o+t)&&e.getRange(n,o+t,n,o+t)}return e.getRange(n,a,n,a)}if(t===se.LEFT){for(let t=0;t<r-o;t++){this._worksheet.getCellMatrix().getValue(n,o-t)&&e.getRange(n,o-t,n,o-t)}return e.getRange(n,0,n,0)}return e.getRange($e)}getNumColumns(){const{startColumn:t,endColumn:e}=this._rangeData;return e-t+1}getNumRows(){const{startRow:t,endRow:e}=this._rangeData;return e-t+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map((t=>t.map((t=>(null==t?void 0:t.p)||""))))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map((t=>t.map((t=>this._context.getWorkBook().getStyles().getStyleByCell(t)))))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:t,_worksheet:e}=this,{startColumn:n,endColumn:i}=t;let o=0;for(let s=0;s<=i-n;s++)o+=e.getColumnWidth(s);return o}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some((t=>t.some((t=>""===(null==t?void 0:t.m)))))}isPartOfMerge(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(t,e,n,i)}setBackground(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={bg:{rgb:t}},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setBackgrounds(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let d=0;d<s-o+1;d++)for(let e=0;e<a-r+1;e++)l.setValue(d,e,{bg:{rgb:t[d][e]}});const h={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Ei({WorkBookUnit:e.getWorkBook()},h);return i.invoke(c),this}setBackgroundRGB(t,e,n){const{_context:i,_worksheet:o,_commandManager:s}=this,{startRow:r,endRow:a,startColumn:l,endColumn:h}=this._rangeData,c={bg:{rgb:`RGB(${t},${e},${n})`}},d=U.fillObjectMatrix(a-r+1,h-l+1,c),u={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:d,rangeData:this._rangeData},g=new Ei({WorkBookUnit:i.getWorkBook()},u);return s.invoke(g),this}setFontColors(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let d=0;d<s-o+1;d++)for(let e=0;e<a-r+1;e++)l.setValue(d,e,{cl:{rgb:t[d][e]}});const h={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Ei({WorkBookUnit:e.getWorkBook()},h);return i.invoke(c),this}setFontFamilies(t){return this._setStyles(t,"ff"),this}setUnderline(t){return this._setStyle(t,"ul"),this}setOverline(t){return this._setStyle(t,"ol"),this}setStrikeThrough(t){return this._setStyle(t,"st"),this}setUnderlines(t){return this._setStyles(t,"ul"),this}setOverlines(t){return this._setStyles(t,"ol"),this}setStrikeThroughs(t){return this._setStyles(t,"st"),this}setFontSizes(t){return this._setStyles(t,"fs"),this}setFontStyle(t){return this._setStyle(t,"it"),this}setFontStyles(t){return this._setStyles(t,"it"),this}setFontWeight(t){return this._setStyle(t,"bl"),this}setFontWeights(t){return this._setStyles(t,"bl"),this}setHorizontalAlignments(t){return this._setStyles(t,"ht"),this}setTextDirections(t){return this._setStyles(t,"td"),this}setTextRotation(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={tr:{v:0,a:Number(t)}},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setTextRotations(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let d=0;d<s-o+1;d++)for(let e=0;e<a-r+1;e++)l.setValue(d,e,{tr:{v:0,a:t[d][e]}});l.getData();const h={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Ei({WorkBookUnit:e.getWorkBook()},h);return i.invoke(c),this}setTextStyle(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=h({},t),c=U.fillObjectMatrix(s-o+1,a-r+1,l),d={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Ei({WorkBookUnit:e.getWorkBook()},d);return i.invoke(u),this}setTextStyles(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let u=0;u<s-o+1;u++)for(let e=0;e<a-r+1;e++)l.setValue(u,e,h({},t[u][e]));const c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setVerticalAlignments(t){return this._setStyles(t,"vt"),this}setVerticalText(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={tr:{v:t,a:90}},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setWrap(t){return this._setStyle(t,"tb"),this}setWrapStrategies(t){return this._setStyles(t,"tb"),this}setWraps(t){return this._setStyles(t,"tb"),this}autoFill(t,e){const{_worksheet:n,_context:i,_commandManager:o}=this,{startRow:s,endRow:r,startColumn:a,endColumn:l}=this._rangeData,{startRow:h,endRow:c,startColumn:d,endColumn:u}=t._rangeData;let g=se.BOTTOM,_=0,p=0;const m=s,T=r,f=a,v=l,E=h,I=c,b=d,A=u,C=new H;if(g=b===f&&A===v?I>T?se.BOTTOM:se.TOP:A>v?se.RIGHT:se.LEFT,g===se.BOTTOM||g===se.TOP){_=T-m+1,p=I-E+1;for(let t=0;t<=l-a;t++){const n=this.getColumnMatrix(t).toArray();wn.getCopyData(n,m,T,f,v,g).forEach((n=>{wn.getApplyData(n,_,p,e,g).forEach(((e,n)=>{C.setValue(n,t,e)}))}))}}else if(g===se.RIGHT||g===se.LEFT){p=A-b,_=v-f;for(let t=0;t<=r-s;t++){const n=this.getRowMatrix(t).toArray();wn.getCopyData(n,m,T,f,v,g).forEach((t=>{wn.getApplyData(t,_,p,e,g)}))}}const S={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:C.getData()},N=new Ei({WorkBookUnit:i.getWorkBook()},S);return o.invoke(N),this}getDataRegion(...t){const{startRow:e,endRow:n,startColumn:i,endColumn:o}=this._rangeData;let s,r;const a=this._worksheet.getCellMatrix();if(!U.isNumber(t[0])){let t=e,n=e;const o=this._worksheet.getRowCount();for(let s=1;s<e;s++){if(!a.getValue(e-s,i)){t=e-s+1;break}}const l=0;for(;l<o-e;){if(!a.getValue(e+l,i)){n=e-l-1;break}}let h=e,c=e;const d=this._worksheet.getColumnCount();for(let s=1;s<e;s++){if(!a.getValue(e,i-s)){h=e-s+1;break}}const u=0;for(;u<d-i;){if(!a.getValue(e,i+u)){c=e-u-1;break}}return r=h-c,r=t-n,s=e,this._worksheet.getRange(t,h,s,r)}{const n=t[0];if(n===ie.COLUMNS){let t=e,n=e;const o=this._worksheet.getRowCount();for(let s=1;s<e;s++){if(!a.getValue(e-s,i)){t=e-s+1;break}}const l=0;for(;l<o-e;){if(!a.getValue(e+l,i)){n=e-l-1;break}}return r=t-n,s=0,this._worksheet.getRange(e,t,s,r)}if(n===ie.ROWS){let t=e,n=e;const o=this._worksheet.getColumnCount();for(let s=1;s<e;s++){if(!a.getValue(e,i-s)){t=e-s+1;break}}const l=0;for(;l<o-i;){if(!a.getValue(e,i+l)){n=e-l-1;break}}return r=0,s=t-n,this._worksheet.getRange(t,i,s,r)}}return this}trimWhitespace(){var t;const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=this._worksheet.getCellMatrix(),h=/\s+/g,c=new H;for(let g=0;g<=s-o;g++)for(let e=0;e<=a-r;e++){const n=null==(t=l.getValue(g,e).m)?void 0:t.replace(h,"");c.setValue(g+o,e+r,n||"")}const d={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},u=new Ei({WorkBookUnit:e.getWorkBook()},d);return i.invoke(u),this}activate(){var t;return-1===(null==(t=this._rangeData)?void 0:t.startRow)?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(t){const e=this._rangeData.startRow,n=this._rangeData.endRow,i=this._rangeData.startColumn,o=this._rangeData.endColumn,s=t.getRangeData().startRow,r=t.getRangeData().endRow,a=t.getRangeData().startColumn,l=t.getRangeData().endColumn,h=Math.abs(i+o-a-l),c=Math.abs(i-o)+Math.abs(a-l),d=Math.abs(e+n-s-r),u=Math.abs(e-n)+Math.abs(s-r);return h<=c&&d<=u}setFontColor(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={cl:{rgb:t}},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}copyTo(...t){const{_context:e,_worksheet:n,_commandManager:i}=this,o=t[0],[s,r]=this._handleCopyRange(this,o),{startRow:a,startColumn:l,endRow:h,endColumn:c}=r;if(hi.checkup(t,Dn,hi.BOOLEAN_TYPE)){const o=t[1];if(t[2],o===Jt.PASTE_NORMAL){const t=new H;s.forEach(((e,n)=>e.forEach(((e,i)=>{e=e,t.setValue(n+a,i+l,e||{})}))));const o={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:t.getData()},r=new Ei({WorkBookUnit:e.getWorkBook()},o);i.invoke(r)}else if(o===Jt.PASTE_FORMAT){const t=e.getWorkBook().getStyles(),o=new H;s.map(((e,n)=>e.forEach(((e,i)=>{e=e,o.setValue(n,i,t.getStyleByCell(e)||{})}))));const a={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:o.getData(),rangeData:r},l=new Ei({WorkBookUnit:e.getWorkBook()},a);i.invoke(l)}else if(o===Jt.PASTE_VALUES){const t=new H;s.forEach(((e,n)=>e.forEach(((e,i)=>{e=e,t.setValue(n+a,i+l,(null==e?void 0:e.v)||"")}))));const o={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:t.getData(),rangeData:r},h=new Ei({WorkBookUnit:e.getWorkBook()},o);i.invoke(h)}else if(o===Jt.PASTE_COLUMN_WIDTHS){const t=this._rangeData.startColumn;for(let e=0;e<c-t;e++){const i=n.getColumnWidth(t+e);n.setColumnWidth(t+e,i)}}}else if(hi.checkup(t,Dn,hi.OBJECT_TYPE)){const o=t[1],r=new H;s.forEach(((t,e)=>t.forEach(((t,n)=>{t=t,r.setValue(e+a,n+l,t||{})}))));const h={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:r.getData(),options:o},c=new Ei({WorkBookUnit:e.getWorkBook()},h);i.invoke(c)}else if(hi.checkup(t,Dn)){const t=new H;s.forEach(((e,n)=>e.forEach(((e,i)=>{e=e,t.setValue(n+a,i+l,e||{})}))));const o={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:t.getData()},r=new Ei({WorkBookUnit:e.getWorkBook()},o);i.invoke(r)}}copyFormatToRange(...t){const{_context:e,_commandManager:n}=this,i=t[1],o=t[2],s=t[3],r=t[4],a=U.isAssignableFrom(t[0],Mn)?t[0].getSheetId():t[0],[l,h]=this._handleCopyRange(this,{startRow:i,endRow:o,startColumn:s,endColumn:r}),c=e.getWorkBook().getStyles(),d=new H;l.map(((t,e)=>t.map(((t,n)=>(t=t,d.setValue(e,n,c.getStyleByCell(t)||{}),c.getStyleByCell(t)||{})))));const u={sheetId:a,actionName:Pt.SET_RANGE_STYLE_ACTION,value:d.getData(),rangeData:h},g=new Ei({WorkBookUnit:e.getWorkBook()},u);n.invoke(g)}copyValuesToRange(...t){const{_context:e,_commandManager:n}=this,i=t[1],o=t[2],s=t[3],r=t[4],a=U.isAssignableFrom(t[0],Mn)?t[0].getSheetId():t[0],[l,h]=this._handleCopyRange(this,{startRow:i,endRow:o,startColumn:s,endColumn:r}),c=new H;l.forEach(((t,e)=>t.forEach(((t,n)=>{t=t,c.setValue(e+h.startRow,n+h.startColumn,(null==t?void 0:t.v)||"")}))));const d={sheetId:a,actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:h},u=new Ei({WorkBookUnit:e.getWorkBook()},d);n.invoke(u)}moveTo(t){const{_context:e,_worksheet:n,_commandManager:i,_rangeData:o}=this,s={sheetId:n.getSheetId(),actionName:Pt.CLEAR_RANGE_ACTION,options:{formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},rangeData:o},r=this.getMatrix(),{startRow:a,endRow:l,startColumn:h,endColumn:c}=this._rangeData,{startRow:d,startColumn:u}=t.getRangeData(),g=new H;for(let m=a;m<=l;m++)for(let t=h;t<=c;t++)g.setValue(d+(m-a),u+(t-h),r.getValue(m,t)||{});const _={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:g.getData()},p=new Ei({WorkBookUnit:e.getWorkBook()},s,_);i.invoke(p)}offset(...t){const{startRow:e,endRow:n,startColumn:i,endColumn:o}=this._rangeData,s=t[0],r=t[1],a=t[2],l=t[3],h={startRow:e+s,endRow:n+s,startColumn:i+r,endColumn:o+r};return U.isNumber(a)&&(h.endRow=h.startRow+a-1),U.isNumber(l)&&(h.endColumn=h.endColumn+l-1),new Dn(this._worksheet,h)}setBorder(...t){const e=t[0],n=t[1],i=t[2],o=t[3],s=t[4],r=t[5],a=t[6]?t[6]:"black",l=t[7]?t[7]:Gt.DASH_DOT,{_context:h,_worksheet:c,_commandManager:d}=this,u=h.getWorkBook(),g=this._rangeData,_=c.getSheetId(),p={startRow:g.startRow-1,startColumn:g.startColumn,endRow:g.startRow-1,endColumn:g.endColumn},m={startRow:g.startRow,startColumn:g.startColumn-1,endRow:g.endRow,endColumn:g.startColumn-1},T={startRow:g.endRow+1,startColumn:g.startColumn,endRow:g.endRow+1,endColumn:g.endColumn},f={startRow:g.startRow,startColumn:g.endColumn+1,endRow:g.endRow,endColumn:g.endColumn+1},v={startRow:g.startRow,startColumn:g.startColumn,endRow:g.startRow,endColumn:g.endColumn},E={startRow:g.startRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.startColumn},I={startRow:g.endRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.endColumn},b={startRow:g.startRow,startColumn:g.endColumn,endRow:g.endRow,endColumn:g.endColumn},A=new Dn(c,p),C=new Dn(c,m),S=new Dn(c,T),N=new Dn(c,f),R=new Dn(c,v),w=new Dn(c,E),O=new Dn(c,I),y=new Dn(c,b),M=new H,D=new H,L=new H,x=new H,k=new H,P=[],B={s:l,cl:{rgb:a}};if(!0===e||!1===e){if(A.isValid()){A.forEach(((t,e)=>{M.setValue(t,e,{bd:{b:null}})}));const t={sheetId:_,actionName:Pt.SET_RANGE_STYLE_ACTION,value:M.getArrayData(),rangeData:p};P.push(t)}R.forEach(((t,n)=>{if(!0===e){const e=U.deepMerge(k.getValue(t,n)||{},{bd:{t:U.deepClone(B)}});k.setValue(t,n,e)}else if(!1===e){const e=U.deepMerge(k.getValue(t,n)||{},{bd:{t:null}});k.setValue(t,n,e)}}))}if(!0===i||!1===i){if(S.isValid()){S.forEach(((t,e)=>{L.setValue(t,e,{bd:{t:null}})}));const t={sheetId:_,actionName:Pt.SET_RANGE_STYLE_ACTION,value:L.getArrayData(),rangeData:T};P.push(t)}O.forEach(((t,e)=>{if(!0===i){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{b:U.deepClone(B)}});k.setValue(t,e,n)}else if(!1===i){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{b:null}});k.setValue(t,e,n)}}))}if(!0===n||!1===n){if(C.isValid()){C.forEach(((t,e)=>{D.setValue(t,e,{bd:{r:null}})}));const t={sheetId:_,actionName:Pt.SET_RANGE_STYLE_ACTION,value:D.getArrayData(),rangeData:m};P.push(t)}w.forEach(((t,e)=>{if(!0===n){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{l:U.deepClone(B)}});k.setValue(t,e,n)}else if(!1===n){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{l:null}});k.setValue(t,e,n)}}))}if(!0===o||!1===o){if(N.isValid()){N.forEach(((t,e)=>{x.setValue(t,e,{bd:{l:null}})}));const t={sheetId:_,actionName:Pt.SET_RANGE_STYLE_ACTION,value:x.getArrayData(),rangeData:f};P.push(t)}y.forEach(((t,e)=>{if(!0===o){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{r:U.deepClone(B)}});k.setValue(t,e,n)}else if(!1===o){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{r:null}});k.setValue(t,e,n)}}))}!0!==s&&!1!==s||this.forEach(((t,e)=>{if(e!==g.endColumn)if(!0===s){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{r:U.deepClone(B)}});k.setValue(t,e,n)}else if(!1===s){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{r:null}});k.setValue(t,e,n)}if(e!==g.startColumn){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{l:null}});k.setValue(t,e,n)}})),!0!==r&&!1!==r||this.forEach(((t,e)=>{if(t!==g.endRow)if(!0===r){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{b:U.deepClone(B)}});k.setValue(t,e,n)}else if(!1===r){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{b:null}});k.setValue(t,e,n)}if(t!==g.startRow){const n=U.deepMerge(k.getValue(t,e)||{},{bd:{t:null}});k.setValue(t,e,n)}}));const F={sheetId:_,actionName:Pt.SET_RANGE_STYLE_ACTION,value:k.getArrayData(),rangeData:k.getDataRange()};P.push(F);const z=new Ei({WorkBookUnit:u},...P);return d.invoke(z),this}setBorderByType(t,e,n){let i=null,o=null,s=null,r=null,a=null,l=null;switch(t){case Yt.TOP:i=!0;break;case Yt.BOTTOM:s=!0;break;case Yt.LEFT:o=!0;break;case Yt.RIGHT:r=!0;break;case Yt.NONE:i=!1,o=!1,s=!1,r=!1,a=!1,l=!1;break;case Yt.ALL:i=!0,o=!0,s=!0,r=!0,a=!0,l=!0;break;case Yt.OUTSIDE:i=!0,o=!0,s=!0,r=!0;break;case Yt.INSIDE:a=!0,l=!0;break;case Yt.HORIZONTAL:l=!0;break;case Yt.VERTICAL:a=!0}this.setBorder(i,o,s,r,a,l,e,n)}setFontFamily(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={ff:t},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setFontSize(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={fs:t},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setHorizontalAlignment(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={ht:t},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setVerticalAlignment(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={vt:t},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setTextDirection(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={td:t},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setWrapStrategy(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l={tb:t},h=U.fillObjectMatrix(s-o+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Ei({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setValue(t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:o}=this,{startRow:s,startColumn:r,endRow:a,endColumn:l}=e,h=new H;for(let u=s;u<=a;u++)for(let e=r;e<=l;e++)h.setValue(u,e,t);const c={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Ei({WorkBookUnit:n.getWorkBook()},c);return i.invoke(d),this}setValues(...t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:o}=this,s=t[0];if(hi.checkup(t,Array)){const{startRow:t,startColumn:r,endRow:a,endColumn:l}=e,h=new H;for(let e=0;e<=a-t;e++)for(let n=0;n<=l-r;n++)h.setValue(e+t,n+r,s[e][n]);const c={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Ei({WorkBookUnit:n.getWorkBook()},c);i.invoke(d)}else if(hi.checkup(t,H)){const t={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:s,rangeData:this._rangeData},e=new Ei({WorkBookUnit:n.getWorkBook()},t);i.invoke(e)}return this}setRangeData(t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:o}=this,{startRow:s,startColumn:r}=e,a={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:{[s]:{[r]:t}}},l=new Ei({WorkBookUnit:n.getWorkBook()},a);return i.invoke(l),this}setRangeDatas(...t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:o}=this,s=t[0];if(hi.checkup(t,Array)){const{startRow:t,startColumn:r,endRow:a,endColumn:l}=e,h=new H;for(let e=0;e<=a-t;e++)for(let n=0;n<=l-r;n++)h.setValue(e+t,n+r,s[e][n]);const c={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:h.getData()},d=new Ei({WorkBookUnit:n.getWorkBook()},c);i.invoke(d)}else if(hi.checkup(t,hi.OBJECT_TYPE)){const t={sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:s},e=new Ei({WorkBookUnit:n.getWorkBook()},t);i.invoke(e)}return this}clear(...t){const{_context:e,_worksheet:n,_commandManager:i,_rangeData:o}=this;let s={formatOnly:!0,contentsOnly:!0};hi.checkup(t,hi.OBJECT_TYPE)&&(s=t[0]);const r={sheetId:n.getSheetId(),actionName:Pt.CLEAR_RANGE_ACTION,options:s,rangeData:o},a=new Ei({WorkBookUnit:e.getWorkBook()},r);return i.invoke(a),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}deleteCells(t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:o}=this,s={sheetId:o.getSheetId(),actionName:Pt.DELETE_RANGE_ACTION,shiftDimension:t,rangeData:e},r=new Ei({WorkBookUnit:n.getWorkBook()},s);i.invoke(r)}insertCells(...t){const e=t[0],n=t[1],{_rangeData:i,_context:o,_commandManager:s,_worksheet:r}=this,{startRow:a,endRow:l,startColumn:h,endColumn:c}=this._rangeData;let d=this._rangeData,u=new H;if(n){u=n.getMatrixObject();const t=n.getRangeData();d={startRow:a,endRow:a+t.endRow-t.startRow,startColumn:h,endColumn:a+t.endColumn-t.startColumn}}else for(let p=a;p<=l;p++)for(let t=h;t<=c;t++)u.setValue(p,t,{m:"",v:""});const g={sheetId:r.getSheetId(),actionName:Pt.INSERT_RANGE_ACTION,shiftDimension:e,rangeData:d,cellValue:u.getData()},_=new Ei({WorkBookUnit:o.getWorkBook()},g);return s.invoke(_),this}merge(){const{_worksheet:t}=this;return t.getMerges().add(this._rangeData),this}mergeAcross(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),i=t.getSheetId(),{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=[];for(let d=o;d<=s;d++){const t={startRow:d,endRow:d,startColumn:r,endColumn:a};l.push(t)}const h={actionName:Pt.ADD_MERGE_ACTION,sheetId:i,rectangles:l},c=new Ei({WorkBookUnit:n.getWorkBook()},h);return e.invoke(c),this}mergeVertically(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),i=t.getSheetId(),{startRow:o,endRow:s,startColumn:r,endColumn:a}=this._rangeData,l=[];for(let d=r;d<=a;d++){const t={startRow:o,endRow:s,startColumn:d,endColumn:d};l.push(t)}const h={actionName:Pt.ADD_MERGE_ACTION,sheetId:i,rectangles:l},c=new Ei({WorkBookUnit:n.getWorkBook()},h);return e.invoke(c),this}breakApart(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),i=t.getSheetId(),o=this._worksheet.getMerges().getMergedRanges(this._rangeData),s={actionName:Pt.REMOVE_MERGE_ACTION,sheetId:i,rectangles:o},r=new Ei({WorkBookUnit:n.getWorkBook()},s);return e.invoke(r),this}removeDuplicates(...t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:o}=this;Array.isArray(t[0])&&t[0];const s=this.getMatrix().getData(),r=[];for(let d=0;d<=e.endColumn-e.startColumn;d++){const t=[],e={},n=this.getColumnMatrix(d).getData();for(const i in n){const o=n[i][d].m;e.hasOwnProperty(o)||(e[o]=1,t.push(d))}r.push(t)}const a=Array.from(new Set(r.flat())),l={};a.forEach(((t,e)=>{l[e]=s[t]}));const h=[{sheetId:o.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:l}],c=new Ei({WorkBookUnit:n.getWorkBook()},...h);return i.invoke(c),this}getRowMatrix(t){const{startColumn:e,endColumn:n}=this._rangeData,i=this._worksheet.getCellMatrix(),o=new H;for(let s=t;s<=t;s++)for(let t=e;t<=n;t++)o.setValue(s,t,i.getValue(s,t)||{});return o}getColumnMatrix(t){const{startRow:e,endRow:n}=this._rangeData,i=this._worksheet.getCellMatrix(),o=new H;for(let s=e;s<=n;s++)for(let e=t;e<=t;e++)o.setValue(s,e,i.getValue(s,e)||{});return o}forEach(t){Dn.foreach(this._rangeData,t)}randomize(){const{_context:t,_worksheet:e,_commandManager:n,_rangeData:i}=this,{startRow:o,startColumn:s}=i,r=new H;U.randSort(this.getMatrix().toArray()).forEach(((t,e)=>t.forEach(((t,n)=>{t=t,r.setValue(e+o,n+s,t||{})}))));const a={sheetId:e.getSheetId(),actionName:Pt.SET_RANGE_DATA_ACTION,cellValue:r.getData()},l=new Ei({WorkBookUnit:t.getWorkBook()},a);n.invoke(l)}isValid(){return!Object.values(this._rangeData).includes(-1)}_handleCopyRange(...t){const e=t[0];let n=t[1];n=hi.checkup(t,Dn,Dn)?n.getRangeData():n;const i=e._worksheet.getCellMatrix(),{startRow:o,endRow:s,startColumn:r,endColumn:a}=e.getRangeData();let{startRow:l,endRow:h,startColumn:c,endColumn:d}=n;const u=s-o+1,g=a-r+1,_=h-l+1,p=d-c+1;let m,T=[];if(_%u==0&&p%g==0){for(let t=0;t<_;t++){const e=[];for(let n=0;n<p;n++){const s=i.getValue((t+o)%u,(n+r)%g)||{};e.push(s)}T.push(e)}m=n}else T=i.getFragments(o,s,r,a).getData(),h+=u-_,d+=g-p,m={startRow:l,endRow:h,startColumn:c,endColumn:d};return[T,m]}_getStyles(t){return this.getValues().map((e=>e.map((e=>{const n=this._context.getWorkBook().getStyles(),i=n&&n.getStyleByCell(e);return i&&i[t]||qe[t]}))))}_setStyle(t,e){const{_context:n,_worksheet:i,_commandManager:o}=this,{startRow:s,endRow:r,startColumn:a,endColumn:l}=this._rangeData,h={[e]:t},c=U.fillObjectMatrix(r-s+1,l-a+1,h),d={sheetId:i.getSheetId(),actionName:Ko.NAME,value:c,rangeData:this._rangeData},u=new Ei({WorkBookUnit:n.getWorkBook()},d);return o.invoke(u),this}_setStyles(t,e){const{_context:n,_worksheet:i,_commandManager:o}=this,{startRow:s,endRow:r,startColumn:a,endColumn:l}=this._rangeData,h=new H;for(let u=0;u<r-s+1;u++)for(let n=0;n<l-a+1;n++)h.setValue(u,n,{[e]:t[u][n]});const c={sheetId:i.getSheetId(),actionName:Pt.SET_RANGE_STYLE_ACTION,value:h.getData(),rangeData:this._rangeData},d=new Ei({WorkBookUnit:n.getWorkBook()},c);return o.invoke(d),this}}function Ln(t){if(t){if(t.rgb)return t.rgb;if(t.th)return(new un).setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function xn(t){return t instanceof FormData}const kn=()=>{},Hn=t=>t;var Pn,Bn,Fn,Un,zn,Wn;(Bn=Pn||(Pn={})).POST="POST",Bn.GET="GET",Bn.PUT="PUT",Bn.DELETE="DELETE",(Un=Fn||(Fn={}))[Un.UNSENT=0]="UNSENT",Un[Un.OPENED=1]="OPENED",Un[Un.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",Un[Un.LOADING=3]="LOADING",Un[Un.DONE=4]="DONE",(Wn=zn||(zn={})).ARRAY_BUFFER="arraybuffer",Wn.BLOB="blob",Wn.TEXT="text",Wn.DOCUMENT="document",Wn.JSON="json",Wn.STREAM="stream";const Gn={type:Pn.POST,url:"",async:!0,header:{},dataType:zn.JSON,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:kn,beforeSend:Hn,dataFilter:Hn,success:kn,complete:kn};function Vn(t){return new Promise(((e,n)=>{const i=function(t,...e){for(const n of e)if(n)for(const e in n)n.hasOwnProperty(e)&&null!=n[e]&&(t[e]=n[e]);return t}({},Gn,t),o=new XMLHttpRequest;switch(i.beforeSend(i),o.responseType=i.dataType,o.timeout=i.timeout,o.addEventListener("readystatechange",(t=>{if(4===o.readyState)if(200===o.status){const t=i.dataFilter(o.response);i.success(t),i.complete(),e(t)}else i.error(t),n(t)})),o.addEventListener("timeout",(t=>{i.error(t)})),o.open(i.type,i.url,i.async,i.username,i.password),Object.keys(i.header).forEach((t=>{const e=i.header[t];o.setRequestHeader(t,e)})),xn(i.data)?o.setRequestHeader("Content-Type","multipart/form-data"):i.contentType&&o.setRequestHeader("Content-Type",i.contentType),i.type){case Pn.DELETE:case Pn.GET:o.send();break;case Pn.POST:case Pn.PUT:if((s=i.data)&&Object.getPrototypeOf(s)===Object.getPrototypeOf({}))return void o.send(JSON.stringify(i.data));if(function(t){return"[object String]"===Object.prototype.toString.apply(t)}(i.data))return void o.send(i.data);if(function(t){return"[object Array]"===Object.prototype.toString.apply(t)}(i.data))return void o.send(JSON.stringify(i.data));xn(i.data)&&o.send(i.data)}var s}))}var Yn,Xn;(Xn=Yn||(Yn={})).MESSAGE="message",Xn.OPEN="open",Xn.CLOSE="close",Xn.ERROR="error",Xn.RETRY="retry",Xn.DESTROY="destroy";const jn={url:"",heartbeatTime:3e4};class Kn{constructor(t){const e=Object.assign(jn,t);if(function(t){return null==t}(n=e.url)||""===n.toString())throw new Error("url must be input");var n;this._listens=new Map,this._timer=-1,this._config=e}link(){this._create(),this._bind()}send(t){this._socket.send(t)}destroy(){const t=this._listens.get(Yn.DESTROY);t&&t(),this._clear(),this._listens.clear()}on(t,e){this._listens.set(t,e)}close(){this._socket&&this._socket.close()}_create(){const{_config:t}=this;this._socket=new WebSocket(t.url)}_bind(){this._socket.addEventListener(Yn.MESSAGE,this._message.bind(this)),this._socket.addEventListener(Yn.OPEN,this._open.bind(this)),this._socket.addEventListener(Yn.CLOSE,this._close.bind(this)),this._socket.addEventListener(Yn.ERROR,this._error.bind(this))}_message(t){const e=this._listens.get(Yn.MESSAGE);e&&e(t)}_open(t){const e=this._listens.get(Yn.OPEN);e&&(e(t),this._heartbeat())}_error(t){const e=this._listens.get(Yn.ERROR);e&&(e(t),this._retry())}_close(t){const e=this._listens.get(Yn.CLOSE);e&&(e(t),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener(Yn.MESSAGE,this._message.bind(this)),this._socket.removeEventListener(Yn.OPEN,this._open.bind(this)),this._socket.removeEventListener(Yn.CLOSE,this._close.bind(this)),this._socket.removeEventListener(Yn.ERROR,this._error.bind(this))}_heartbeat(){const{_socket:t,_config:e}=this,{heartbeatTime:n}=e;this._timer=setInterval((function(){t.send("heart_beat_message")}),n)}_retry(){const t=this._listens.get(Yn.RETRY);t&&t(),this._clear(),this._create(),this._bind()}}Object.keys(en).reduce(((t,e)=>[...t,...en[e]]),[]);const $n={},Zn={};class qn{static getValue(t,e){try{return t[e]?t[e]:e.split(".").reduce(((t,e)=>t[e]),t)}catch(n){console.error("Key %s not found",e)}}initialize(t){this.options={currentLocale:t||["zh","zh-CN"].includes(U.getLanguage())?pe.ZH:pe.EN,locales:{zh:$n,en:Zn}}}get(t){if(t){const{locales:e,currentLocale:n}=this.options;return qn.getValue(e[n],t)||t}return String()}getObject(t){const{locales:e,currentLocale:n}=this.options;return qn.getValue(e[n],t)}load(t){U.deepMerge(this.options.locales,t)}change(t){this.options.currentLocale=t}getCurrentLocale(){return this.options.currentLocale}}class Qn{static log(...t){console&&console.log(...t)}static info(...t){console&&console.info(...t)}static error(...t){console&&console.error(...t)}static warn(...t){console&&console.warn(...t)}static br(){Qn.info("\n")}static capsule(t,e,n="",i=""){console&&console.log(`%c${n}%c${t}%c${e}%c${i}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class Jn{constructor(...t){if(U.hasLength(t,0))return this.startRow=0,this.startColumn=0,this.endRow=0,void(this.endColumn=0);if(U.hasLength(t,1)){const e=t[0];return this.startRow=e.startRow,this.startColumn=e.startColumn,this.endRow=e.endRow,void(this.endColumn=e.endColumn)}if(U.hasLength(t,4)){const e=t[0],n=t[1],i=t[2],o=t[3];this.startRow=e,this.startColumn=n,this.endRow=i,this.endColumn=o}}static equals(t,e){return t.endRow===e.endRow&&t.endColumn===e.endColumn&&t.startRow===e.startRow&&t.startColumn===e.startColumn}static intersects(t,e){const n=t.startRow,i=t.endRow,o=t.startColumn,s=t.endColumn,r=e.startRow,a=e.endRow,l=e.startColumn,h=e.endColumn,c=Math.abs(o+s-l-h),d=Math.abs(o-s)+Math.abs(l-h),u=Math.abs(n+i-r-a),g=Math.abs(n-i)+Math.abs(r-a);return c<=d&&u<=g}intersects(t){return Jn.intersects(this,t)}union(t){const{startRow:e,startColumn:n,endRow:i,endColumn:o}=this;return new Jn(t.startRow<this.startRow?t.startRow:e,t.startColumn<n?t.startColumn:n,t.endRow>i?t.endRow:i,t.endColumn>o?t.endColumn:o)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(t){return Jn.equals(this,t)}}const ti="A".charCodeAt(0),ei="Z".charCodeAt(0),ni="a".charCodeAt(0);function ii(t){const e=ei-ti+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+ti)+n,t=Math.floor(t/e)-1;return n}function oi(t,e=!1){const n=ei-ti+1;let i=ni;e&&(i=ti);return function(t,e){let n="";for(;e>0;)n+=t,e--;return n}(String.fromCharCode(t%n+i),Math.floor(t/n)+1)}class si{static fromSequence(t){if(U.isObject(t)&&si.requiredNewInstance(this)){return this.newInstance(t)}if(U.isArray(t)&&si.requiredNewInstance(this)){const e=this;return t.map((t=>e.newInstance(t)))}return[]}toSequence(){return{className:U.getClassName(this)}}}function ri(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function ai(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}(si||(si={})).requiredNewInstance=function(t){if(U.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")};const li=class{static checkup(t,...e){if(t.length!==e.length)return!1;const n=t.length;for(let i=0;i<n;i++){const n=t[i],o=e[i];switch(o){case li.BOOLEAN_TYPE:if(!U.isBoolean(n))return!1;break;case li.NUMBER_TYPE:if(!U.isNumber(n))return!1;break;case li.STRING_TYPE:if(!U.isString(n))return!1;break;case li.FUNCTION_TYPE:if(!U.isFunction(n))return!1;break;case li.OBJECT_TYPE:if(!U.isPlainObject(n))return!1;break;default:if(!U.isAssignableFrom(n,o))return!1}}return!0}};let hi=li;function ci(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)&&("[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)?Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every((n=>ci(t[n],e[n]))):t===e)}hi.STRING_TYPE=1,hi.NUMBER_TYPE=2,hi.BOOLEAN_TYPE=3,hi.FUNCTION_TYPE=4,hi.OBJECT_TYPE=5;class di{constructor(t,e,n){this.path=t,this.namespace=e,this.observable=n}}class ui{constructor(){this._observableArray=[]}hasObserver(t,e){return null!=this.getObserver(t,e)}getObserver(...t){if(1===t.length){const e=t[0],n=this._observableArray.find((t=>t.path===e));return n?n.observable:null}if(2===t.length){const e=t[0],n=t[1],i=this._observableArray.find((t=>t.path===e&&t.namespace===n));return i?i.observable:null}}requiredObserver(...t){if(U.hasLength(t,1)){const e=t[0],n=this.getObserver(e);if(null==n)throw new Error(`not found observable ${e}`);return n}if(U.hasLength(t,2)){const e=t[0],n=t[1],i=this.getObserver(e,n);if(null==i)throw new Error(`not found observable ${e}`);return i}throw new Error("requiredObserver arguments error")}removeObserver(...t){if(U.hasLength(t,1)){const e=t[0],n=this._observableArray.findIndex((t=>t.path===e));n>-1&&this._observableArray.splice(n,1)}else if(U.hasLength(t,2)){const e=t[0],n=t[1],i=this._observableArray.findIndex((t=>t.path===e&&t.namespace===n));i>-1&&this._observableArray.splice(i,1)}}addObserver(...t){if(1===t.length){const e=t[0],n=t[1];return this.hasObserver(e,e)&&this.removeObserver(e),void this._observableArray.push(new di(e,e,n))}if(3===t.length){const e=t[0],n=t[1],i=t[2];this.hasObserver(e,e)&&this.removeObserver(e,n),this._observableArray.push(new di(e,n,i))}}}var gi,_i;(_i=gi||(gi={}))[_i.REDO=0]="REDO",_i[_i.UNDO=1]="UNDO";class pi extends O{}class mi extends O{}class Ti extends O{}class fi{constructor(t){this._undoManager=t.getUndoManager(),this._actionExtensionManager=new bi}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new pi,this._commandObservers=new Ti,this._commandInjectorObservers=new mi}static getAction(t){return this._actionClass[t]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(t,e){this._actionClass[t]=e}static getCommandInjectorObservers(){return this._commandInjectorObservers}getActionExtensionManager(){return this._actionExtensionManager}undo(){const{_undoManager:t}=this,e=t.undo();e&&e.undo()}redo(){const{_undoManager:t}=this,e=t.redo();e&&e.redo()}invoke(t){const{_undoManager:e}=this,{_actionDataList:n,_unit:i,_actionList:o}=t;this._actionExtensionManager.handle(n),n.forEach((t=>{const e=fi.getAction(t.actionName),n=fi.getActionObservers(),s=new e(t,i,n);o.push(s)})),t.invoke(),e.push(t)}}fi.staticInitialize();class vi extends N{constructor(t,e,n){if(super(t,n),null==e.WorkBookUnit)throw new Error("action workbook domain can not be null!");this._commandUnit=e,this._workbook=e.WorkBookUnit}getWorkSheet(){const{_workbook:t,_doActionData:e}=this,{sheetId:n}=e;return t.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class Ei{constructor(t,...e){this._unit=t,this._actionDataList=e,this._actionList=[]}getDoData(){return this._actionList.map((t=>t.getDoActionData()))}getOldData(){return this._actionList.map((t=>t.getOldActionData()))}getInjector(){const t=this;return new class{injectAction(e){t._actionList.push(e)}getActions(){return t._actionList.concat([])}include(e){for(let n=0;n<t._actionList.length;n++)if(t._actionList[n]instanceof e)return t._actionList[n];return null}}}redo(){this._actionList.forEach((t=>{Ni.hasUndo(t.getDoActionData())&&t.redo()})),fi.getCommandObservers().notifyObservers({type:gi.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach((t=>{Ni.hasUndo(t.getOldActionData())&&t.undo()})),fi.getCommandObservers().notifyObservers({type:gi.UNDO,actions:this._actionList})}invoke(){fi.getCommandInjectorObservers().notifyObservers(this.getInjector()),fi.getCommandObservers().notifyObservers({type:gi.REDO,actions:this._actionList})}}class Ii{constructor(){this._undoStack=[],this._redoStack=[]}push(t){this._redoStack.push(t)}undo(){const t=this._redoStack.pop();if(t)return this._undoStack.push(t),t}redo(){const t=this._undoStack.pop();if(t)return this._redoStack.push(t),t}}class bi{constructor(){this._register=new Si,this._register.initialize()}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.actionExtensionFactoryList;n&&(this._actionExtensionFactoryList=n,0!==t.length&&this._checkExtension(t))}_checkExtension(t){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach((e=>{const n=e.check(t);!1!==n&&n.execute()}))}}class Ai{constructor(){this._data=[]}static create(){return new Ai}add(t){this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}const Ci=Ai.create();class Si{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...t){this._actionExtensionFactoryList.push(...t),this._actionExtensionFactoryList.sort(ri)}delete(t){const e=this._actionExtensionFactoryList.indexOf(t);this._actionExtensionFactoryList.splice(e,1)}_initExtensions(){this._actionExtensionFactoryList.push(...Ci.getData().sort(ri))}}class Ni{constructor(t){this._action=t}static hasObserver(e){return!e.operation||(e.operation&t.OBSERVER_ACTION)===t.OBSERVER_ACTION}static hasUndo(e){return!e.operation||(e.operation&t.UNDO_ACTION)===t.UNDO_ACTION}static hasCollaboration(e){return!e.operation||(e.operation&t.SERVER_ACTION)===t.SERVER_ACTION}static hasExtension(e){return!e.operation||(e.operation&t.EXTENSION_ACTION)===t.EXTENSION_ACTION}static make(e){return e.operation=t.DEFAULT_ACTION,new Ni(e)}removeObserver(){return this._action.operation&&(this._action.operation&=~t.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~t.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~t.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~t.EXTENSION_ACTION),this}getAction(){return this._action}}function Ri(t,e){var n;let i=null==(n=null==t?void 0:t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId);if(i){let t=i.getConfig().mergeData,n=e.rectangles;for(let e=0;e<n.length;e++)t.push(n[e]);return n}return[]}function wi(t,e){var n;const i=null==(n=t.WorkBookUnit)?void 0:n.getConfig().namedRanges;null==i||i.push(e.namedRange)}function Oi(t,e){const n=t.WorkBookUnit,i=null==n?void 0:n.getConfig().namedRanges;return null==i?void 0:i.find(((t,n)=>t.namedRangeId===e.namedRangeId?(i.splice(n,1),t):null))}function yi(t,e){var n,i,o;const s=null==(n=t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId),r=null==s?void 0:s.getCellMatrix(),a={rowCount:null==s?void 0:s.getConfig().rowCount,columnCount:null==s?void 0:s.getConfig().columnCount},{startRow:l,endRow:h,startColumn:c,endColumn:d}=e.rangeData,u=h-l+1,g=d-c+1,_=null!=(i=a.rowCount)?i:0,p=null!=(o=a.columnCount)?o:0,m=new H;if(e.shiftDimension===ie.ROWS)for(let T=l;T<=_;T++)for(let t=c;t<=d;t++){if(T<=h){const e=null==r?void 0:r.getValue(T,t);m.setValue(T,t,e)}const e=null==r?void 0:r.getValue(T+u,t);if(e)null==r||r.setValue(T,t,U.deepClone(e));else{(null==r?void 0:r.getValue(T,t))&&(null==r||r.deleteValue(T,t),t--)}}else if(e.shiftDimension===ie.COLUMNS)for(let T=l;T<=h;T++)for(let t=c;t<=p;t++){if(t<=d){const e=null==r?void 0:r.getValue(T,t);m.setValue(T,t,e)}else for(let n=0;n<=d;n++){const e=null==r?void 0:r.getValue(T,t);m.setValue(T,t+n,e)}const e=null==r?void 0:r.getValue(T,t+g);if(e)null==r||r.setValue(T,t,U.deepClone(e));else{if(null==r?void 0:r.getValue(T,t)){for(let e=0;e<=d;e++)null==r||r.deleteValue(T,t);break}}}return m.getData()}function Mi(t,e){const n=t.getConfig(),i=n.hidden;return n.hidden=e,i}function Di(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager().getColumnData().toJSON();new x(n).inserts(e.columnIndex,new x(e.columnCount))}function Li(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();new H(n).insertColumns(e.columnIndex,new H(e.columnData))}function xi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();new H(n).insertRows(e.rowIndex,new H(e.rowData))}function ki(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=n.getLastRow(),o=n.getLastColumn(),s=n.getCellMatrix(),{startRow:r,endRow:a,startColumn:l,endColumn:h}=e.rangeData,c=a-r+1,d=h-l+1,u=i,g=o;if(e.shiftDimension===ie.ROWS){for(let t=u;t>=r;t--)for(let e=l;e<=h;e++){const n=s.getValue(t,e);s.setValue(t+c,e,n)}for(let t=a;t>=r;t--)for(let n=l;n<=h;n++)s.setValue(t,n,e.cellValue[t-r][n-l])}else if(e.shiftDimension===ie.COLUMNS){for(let t=r;t<=a;t++)for(let e=g;e>=l;e--){const n=s.getValue(t,e);s.setValue(t,e+d,n)}for(let t=r;t<=a;t++)for(let n=h;n>=l;n--)s.setValue(t,n,e.cellValue[t-r][n-l])}}function Hi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getRowManager().getRowData().toJSON();new x(n).inserts(e.rowIndex,new x(e.rowCount))}function Pi(t,e){t.WorkBookUnit.getSheetBySheetId(e.sheetId);const n=e.index,i=e.sheet,o=t.WorkBookUnit.getWorksheets(),s=t.WorkBookUnit.getConfig(),{sheets:r,sheetOrder:a}=s;if(r[i.id])throw new Error(`Insert Sheet fail ${i.id} is already exist`);return r[i.id]=i,a.splice(n,0,i.id),o.set(i.id,new Mn(t.WorkBookUnit.getContext(),i)),i.id}function Bi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager().getColumnData().toJSON(),i=new x(n),o=new x,s=e.columnIndex,r=e.columnIndex+e.columnCount;for(let a=s;a<r;a++){const t=i.splice(e.columnIndex,1);t.getLength()&&o.set(a,t.first())}return o.getLength()}function Fi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();return new H(n).spliceColumns(e.columnIndex,e.columnCount).toJSON()}function Ui(t,e){let n=t.WorkBookUnit.getSheetBySheetId(e.sheetId);if(n){let t=[],i=n.getConfig().mergeData,o=e.rectangles;for(let e=0;e<o.length;e++)for(let n=i.length-1;n>=0;n--){let s=i[n],r=o[e];Jn.intersects(s,r)&&t.push(i.splice(n,1)[0])}return t}return[]}function zi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getRowManager().getRowData().toJSON(),i=new x(n),o=new x,s=e.rowIndex,r=e.rowIndex+e.rowCount;for(let a=s;a<r;a++){const t=i.splice(e.rowIndex,1);t.getLength()&&o.set(a,t.first())}return o.getLength()}function Wi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();return new H(n).spliceRows(e.rowIndex,e.rowCount).toJSON()}function Gi(t,e){let n=t.WorkBookUnit,i=e.sheetId;const o=n.getWorksheets(),s=n.getConfig(),{sheets:r}=s;if(null==r[i])throw new Error(`Remove Sheet fail ${i} is not exist`);const a=r[i],l=s.sheetOrder.findIndex((t=>t===i));return delete r[i],s.sheetOrder.splice(l,1),o.delete(i),{index:l,sheet:a}}function Vi(t,e){const n=t.WorkBookUnit,i=n.getSheetBySheetId(e.sheetId),o=n.getStyles(),s=i.getCellMatrix(),r=new H(e.styles),a=new H;return r.forValue(((t,e,n)=>{const i=s.getValue(t,e);if(i){const s=o.get(i.s);s&&a.setValue(t,e,s),i.s=o.setValue(n)}})),a.toJSON()}function Yi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=e.columnIndex,o=e.columnCount,s=n.getColumnManager();for(let r=i;r<i+o;r++){s.getColumnOrCreate(r).hd=1}}function Xi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager();for(let i=0;i<0;i++){const t=n.getColumn(i);t&&(t.hd=0)}}function ji(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=e.columnIndex,o=e.columnWidth,s=n.getColumnManager(),r=[];for(let a=i;a<i+o.length;a++){const t=s.getColumnOrCreate(a);r[a-i]=t.w,t.w=o[a-i]}return r}function Ki(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=e.hideGridlines,o=n.getConfig(),s=0===o.showGridlines;return o.showGridlines=i?0:1,s}function $i(t=0,e,n){for(let i=t;i<t+e;i++){const t=n.getRowOrCreate(i);t&&(t.hd=1)}}function Zi(t,e){const n=t.WorkBookUnit;n.getSheetBySheetId(e.sheetId);const i=e.namedRange,o=n.getConfig().namedRanges;return o.find(((t,e)=>t.namedRangeId===i.namedRangeId?(o[e]=i,t):null))}function qi(t,e,n,i){const{startRow:o,endRow:s,startColumn:r,endColumn:a}=n,l=new H;for(let h=o;h<=s;h++)for(let n=r;n<=a;n++){const s=t.getValue(h,n)||{},a=i.getStyleByCell(s);null==a&&delete s.s;const c=to(a,e[h-o][n-r]);c&&U.removeNull(c),U.isEmptyObject(c)?delete s.s:s.s=i.setValue(c),s.p&&eo(s.p,e[h-o][n-r]),t.setValue(h,n,s),l.setValue(h-o,n-r,Qi(a,e[h-o][n-r]))}return l.getData()}function Qi(t,e){return function(t,e){if(!e||!Object.keys(e).length)return t;const n=U.deepClone(t)||{};for(const i in e)"bd"===i?n[i]=Ji(n[i]||{},e[i]):i in n||(n[i]=null);return n}(t,e)}function Ji(t,e){if(!e||!Object.keys(e).length)return t;for(const n in e)n in t||(t[n]=null);return t}function to(t,e,n=!1){if(null===e)return e;if(void 0===e)return t;const i=U.deepClone(t)||{};for(const o in e)n&&["bd","tr","td","ht","vt","tb","pd"].includes(o)||(o in i&&"bd"===o?i[o]=Object.assign(i[o],e[o]):(i[o]=e[o],"cl"in i&&["ul","ol","st"].includes(o)&&(i[o].cl=i.cl)));return i}function eo(t,e){var n;null==(n=t.body)||n.blockElements.forEach((t=>{if(0===t.blockType){const n=t.paragraph;null==n||n.elements.forEach((t=>{t.tr||(t.tr={});const n=t.tr;n.ts||(n.ts={});const i=to(n.ts,e,!0);i&&U.removeNull(i),U.isEmptyObject(i)?delete n.ts:n.ts=i}))}}))}function no(t,e){const n=t.WorkBookUnit,i=n.getSheetBySheetId(e.sheetId).getCellMatrix(),o=e.options,s=e.cellValue,r=n.getStyles(),a=new H(s),l=new H;return o?(a.forValue(((t,e,n)=>{const s=i.getValue(t,e),r={};o.contentsOnly&&(r.m=null==s?void 0:s.m,r.v=null==s?void 0:s.v),o.formatOnly&&(r.v=null==s?void 0:s.v,r.m=null==s?void 0:s.m),l.setValue(t,e,r||{}),i.setValue(t,e,n||{})})),l.getData()):(a.forValue(((t,e,n)=>{const o=i.getValue(t,e)||{};if(n){const s=r.getStyleByCell(o),a=Qi(s,null==n?void 0:n.s),h=U.deepClone(o);h.s=a,l.setValue(t,e,h),null==s&&delete o.s;const c=to(s,null==n?void 0:n.s);c&&U.removeNull(c),U.isEmptyObject(c)?delete o.s:o.s=r.setValue(c),null!=n.v&&(o.v=n.v),null!=n.m?o.m=n.m:o.m=String(o.v),null!=n.t&&(o.t=n.t),i.setValue(t,e,o)}else i.setValue(t,e,n),l.setValue(t,e,o)})),l.getData())}function io(t,e,n){const i=new H(e),o=new H;for(let s=n.startRow;s<=n.endRow;s++)for(let e=n.startColumn;e<=n.endColumn;e++){const n=i.getValue(s,e),o=t.getValue(s,e),r=U.deepClone(o||{});r.n=n,t.setValue(s,e,r||{})}return o.getData()}function oo(t,e,n){const i=new H(e),o=new H;for(let s=n.startRow;s<=n.endRow;s++)for(let e=n.startColumn;e<=n.endColumn;e++){const n=i.getValue(s,e),r=t.getValue(s,e);o.setValue(s,e,r&&r.v||"");const a=U.deepClone(r||{});a.v=n,a.m=`${n}`,t.setValue(s,e,a||{})}return o.getData()}function so(t,e){const n=t.getConfig(),i=n.rightToLeft;return n.rightToLeft=e,i}function ro(t=0,e,n){const i=[];for(let o=t;o<t+e.length;o++){const s=n.getRowOrCreate(o);i[o-t]=s.h,s.h=e[o-t]}return i}function ao(t,e,n,i){var o,s,r;const a=t.getSelection(),l=null==(o=a.getActiveRangeList())?void 0:o.getRangeList(),h=null==(s=a.getActiveRange())?void 0:s.getRangeData(),c=null==(r=a.getCurrentCell())?void 0:r.getRangeData();return a.setRanges(e,n,i),{activeRangeList:l,activeRange:h,currentCell:c}}function lo(t,e,n){const i=t.getConfig(),o=i.sheetOrder.findIndex((t=>t===e)),s=i.sheetOrder.filter((t=>t!==e));return s.splice(n,0,e),i.sheetOrder=s,o}function ho(t=0,e,n){for(let i=t;i<t+e;i++){const t=n.getRow(i);t&&(t.hd=0)}}function co(t,e){const n=t.getConfig(),i=n.tabColor;return n.tabColor=e,i}function uo(t,e){const n=t.getContext().getWorkBook().getActiveSheet();let i="";const o=Fe.FALSE;n&&(i=n.getSheetId());const s=t.getContext().getWorkBook().getSheets(),r=t.getSheetId();return s.forEach((t=>{const e=t.getSheetId();t.getConfig().status=e===r?Fe.TRUE:Fe.FALSE})),{oldSheetId:i,status:o}}function go(t,e){const n=t.getConfig(),i=n.name;return n.name=e,i}function _o(t,e){const n=t.getConfig(),i=n.status;return n.status=e,i}function po(t,e,n){const i=t.getSheetBySheetId(e);if(i){const t=i.getConfig().zoomRatio;return i.getConfig().zoomRatio=n,t}return 1}class mo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rectangles:this.do()}),this.validate()}do(){return Ri(this._commandUnit,this._doActionData)}redo(){this.do()}undo(){Ui(this._commandUnit,this._oldActionData)}validate(){return!1}}mo.NAME="AddMergeAction",fi.register(mo.NAME,mo);class To extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData={actionName:vo.NAME,sheetId:t.sheetId,namedRange:this.do()},this.validate()}do(){const t=Oi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:vo.NAME,namedRange:this.do()}}undo(){wi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}To.NAME="DeleteNamedRangeAction",fi.register(To.NAME,To);const fo=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData={actionName:To.NAME,sheetId:t.sheetId,namedRangeId:t.namedRange.namedRangeId},this.validate()}do(){wi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const{sheetId:t}=this._oldActionData;this._doActionData={actionName:fo.NAME,sheetId:t,namedRange:Oi(this._commandUnit,this._oldActionData)},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let vo=fo;var Eo,Io;vo.NAME="AddNamedRangeAction",fi.register(vo.NAME,vo),(Io=Eo||(Eo={})).DEFAULT="default",Io.PASTE="paste";const bo=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=no(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,options:e}=this._doActionData;this._oldActionData={actionName:bo.NAME,sheetId:t,cellValue:this.do(),options:e}}undo(){const{sheetId:t,cellValue:e,options:n}=this._oldActionData,i=this.getWorkSheet();this._workbook.getStyles(),i&&(this._doActionData={actionName:bo.NAME,sheetId:t,cellValue:no(this._commandUnit,this._oldActionData),options:n},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let Ao=bo;Ao.NAME="SetRangeDataAction",fi.register(Ao.NAME,Ao);class Co extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=function(t,e){var n;const i=null==(n=t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId),o=null==i?void 0:i.getCellMatrix(),{startRow:s,endRow:r,startColumn:a,endColumn:l}=e.rangeData,h=new H;for(let c=s;c<=r;c++)for(let t=a;t<=l;t++){const n=null==o?void 0:o.getValue(c,t);h.setValue(c,t,U.deepClone(n)),n&&(e.options.formatOnly&&delete n.s,e.options.contentsOnly&&(n.v="",n.m=""),null==o||o.setValue(c,t,U.deepClone(n)))}return h.getData()}(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={actionName:Ao.NAME,sheetId:t,cellValue:this.do()}}undo(){this.getWorkSheet()&&(no(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Co.NAME="ClearRangeAction",fi.register(Co.NAME,Co);class So extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){this.getWorkSheet()&&(ki(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:t,sheetId:e,shiftDimension:n}=this._oldActionData;this.getWorkSheet()&&(this._doActionData={actionName:Ao.NAME,sheetId:e,cellValue:yi(this._commandUnit,this._oldActionData),rangeData:t,shiftDimension:n},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}So.NAME="InsertRangeAction",fi.register(So.NAME,So);class No extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=yi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:t,actionName:So.NAME,shiftDimension:n,rangeData:e,cellValue:this.do()}}undo(){this.getWorkSheet()&&(ki(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}No.NAME="DeleteRangeAction",fi.register(No.NAME,No);class Ro extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Di(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Bi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ro.NAME="InsertColumnAction",fi.register(Ro.NAME,Ro);class wo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=c(h({},t),{columnCount:x.getMaxLength(t.columnData[0])}),this.validate()}do(){Li(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Fi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}wo.NAME="InsertColumnDataAction",fi.register(wo.NAME,wo);class Oo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Hi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){zi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Oo.NAME="InsertRowAction",fi.register(Oo.NAME,Oo);class yo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=c(h({},t),{rowCount:x.getMaxLength(t.rowData[0])}),this.validate()}do(){xi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Wi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}yo.NAME="InsertRowDataAction",fi.register(yo.NAME,yo);class Mo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{sheetId:this.do()})}do(){const t=Pi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){Gi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}Mo.NAME="InsertSheetAction",fi.register(Mo.NAME,Mo);class Do extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{columnCount:this.do()}),this.validate()}do(){const t=Bi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Di(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Do.NAME="RemoveColumnAction",fi.register(Do.NAME,Do);class Lo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{columnData:this.do()}),this.validate()}do(){const t=Fi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Li(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Lo.NAME="RemoveColumnDataAction",fi.register(Lo.NAME,Lo);class xo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rectangles:this.do()}),this.validate()}do(){const t=Ui(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Ri(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}xo.NAME="RemoveMergeAction",fi.register(xo.NAME,xo);class ko extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rowCount:this.do()}),this.validate()}do(){const t=zi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Hi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ko.NAME="RemoveRowAction",fi.register(ko.NAME,ko);class Ho extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rowData:this.do()}),this.validate()}do(){const t=Wi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){xi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ho.NAME="RemoveRowDataAction",fi.register(Ho.NAME,Ho);class Po extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=h(h({},t),this.do())}do(){return this.redo()}redo(){const t=Gi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}undo(){this.getWorkBook(),Pi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}Po.NAME="RemoveSheetAction",fi.register(Po.NAME,Po);class Bo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{styles:this.do()}),this.validate()}do(){const t=Vi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Vi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Bo.NAME="SetBorderAction",fi.register(Bo.NAME,Bo);class Fo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Yi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Xi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Fo.NAME="SetColumnHideAction",fi.register(Fo.NAME,Fo);class Uo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Xi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Yi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Uo.NAME="SetColumnShowAction",fi.register(Uo.NAME,Uo);class zo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{columnWidth:this.do()}),this.validate()}do(){const t=ji(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const t=ji(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}zo.NAME="SetColumnWidthAction",fi.register(zo.NAME,zo);class Wo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{hideGridlines:this.do()}),this.validate()}do(){const t=Ki(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Ki(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Wo.NAME="SetHiddenGridlinesAction",fi.register(Wo.NAME,Wo);const Go=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData={actionName:Go.NAME,namedRange:this.do(),sheetId:t.sheetId},this.validate()}do(){const t=Zi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={actionName:Go.NAME,sheetId:t,namedRange:this.do()}}undo(){const{sheetId:t}=this._oldActionData;this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:Go.NAME,sheetId:t,namedRange:Zi(this._commandUnit,this._oldActionData)}}validate(){return!1}};let Vo=Go;Vo.NAME="SetNamedRangeAction",fi.register(Vo.NAME,Vo);const Yo=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellNote:this.do()}),this.validate()}do(){const t=io(this.getWorkSheet().getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:Yo.NAME,sheetId:t,cellNote:this.do(),rangeData:e}}undo(){const{rangeData:t,sheetId:e,cellNote:n}=this._oldActionData,i=this.getWorkSheet();i&&(this._doActionData={actionName:Yo.NAME,sheetId:e,cellNote:io(i.getCellMatrix(),n,t),rangeData:t},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let Xo=Yo;Xo.NAME="SetRangeNoteAction",fi.register(Xo.NAME,Xo);const jo=class extends vi{constructor(t,e,n){super(t,e,n),this._oldActionData=c(h({},t),{value:this.do()}),this.validate()}do(){const{value:t,rangeData:e}=this._doActionData,n=this._workbook.getStyles(),i=qi(this.getWorkSheet().getCellMatrix(),t,e,n);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),i}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:jo.NAME,sheetId:t,value:this.do(),rangeData:e}}undo(){const{value:t,rangeData:e,sheetId:n}=this._oldActionData,i=this._workbook.getStyles(),o=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:jo.NAME,sheetId:n,value:qi(o,t,e,i),rangeData:e},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Ko=jo;Ko.NAME="SetRangeStyleAction",fi.register(Ko.NAME,Ko);class $o extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=oo(this.getWorkSheet().getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:Ao.NAME,sheetId:t,cellValue:this.do(),rangeData:e}}undo(){const{rangeData:t,sheetId:e,cellValue:n}=this._oldActionData,i=this.getWorkSheet();i&&(this._doActionData={actionName:Ao.NAME,sheetId:e,cellValue:oo(i.getCellMatrix(),n,t),rangeData:t},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}$o.NAME="SetRangeFormattedValueAction",fi.register($o.NAME,$o);class Zo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rightToLeft:this.do()}),this.validate()}do(){const t=so(this.getWorkSheet(),this._doActionData.rightToLeft);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;so(this.getWorkSheet(),this._oldActionData.rightToLeft),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Zo.NAME="SetRightToLeftAction",fi.register(Zo.NAME,Zo);class qo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rowHeight:this.do()}),this.validate()}do(){const t=this.getWorkSheet(),e=ro(this._doActionData.rowIndex,this._doActionData.rowHeight,t.getRowManager());return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){const t=this.getWorkSheet(),e=ro(this._oldActionData.rowIndex,this._oldActionData.rowHeight,t.getRowManager());return this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this}),e}validate(){return!1}}qo.NAME="SetRowHeightAction",fi.register(qo.NAME,qo);class Qo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){const t=this.getWorkSheet();$i(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet();ho(this._oldActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Qo.NAME="SetRowHideAction",fi.register(Qo.NAME,Qo);class Jo extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){const t=this.getWorkSheet();ho(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet();$i(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Jo.NAME="SetRowShowAction",fi.register(Jo.NAME,Jo);const ts=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t);const{activeRangeList:i,activeRange:o,currentCell:s}=this.do();this._oldActionData=c(h({},t),{activeRangeList:i,activeRange:o,currentCell:s}),this.validate()}do(){const{activeRangeList:t,activeRange:e,currentCell:n}=this._doActionData,i=ao(this.getWorkSheet(),t,e,n);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),i}redo(){const{sheetId:t}=this._doActionData,{activeRangeList:e,activeRange:n,currentCell:i}=this.do();this._oldActionData={actionName:ts.NAME,sheetId:t,activeRangeList:e,activeRange:n,currentCell:i}}undo(){const{activeRangeList:t,activeRange:e,currentCell:n,sheetId:i}=this._oldActionData,o=ao(this.getWorkSheet(),t,e,n);this._doActionData={actionName:ts.NAME,sheetId:i,activeRangeList:o.activeRangeList,activeRange:o.activeRange,currentCell:o.currentCell},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let es=ts;es.NAME="SetSelectionActivateAction",fi.register(es.NAME,es);class ns extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{order:this.do()}),this.validate()}do(){const t=lo(this.getWorkSheet().getContext().getWorkBook(),this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){lo(this.getWorkSheet().getContext().getWorkBook(),this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ns.NAME="SetSheetOrderAction",fi.register(ns.NAME,ns);const is=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{color:this.do()}),this.validate()}do(){const t=co(this.getWorkSheet(),this._doActionData.color);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:is.NAME,color:this.do()}}undo(){const{color:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:is.NAME,sheetId:e,color:co(n,t)},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let os=is;os.NAME="SetTabColorAction",fi.register(os.NAME,os);const ss=class extends vi{constructor(e,n,i){super(e,n,i),this._doActionData=h({},e);const{oldSheetId:o,status:s}=this.do();this._oldActionData=c(h({},e),{sheetId:o,status:s}),this.validate(),this.removeOperation(t.SERVER_ACTION)}do(){const{sheetId:t,status:e}=this._doActionData,n=uo(this._workbook.getSheetBySheetId(t));return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),n}redo(){const{oldSheetId:t,status:e}=this.do();this._oldActionData={actionName:ss.NAME,sheetId:t,status:e}}undo(){const{sheetId:t}=this._oldActionData;this._oldActionData.status;const e=this._workbook.getSheetBySheetId(t);if(e){const{oldSheetId:t,status:n}=uo(e);this._doActionData={actionName:ss.NAME,sheetId:t,status:n},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}};let rs=ss;rs.NAME="SetWorkSheetActivateAction",fi.register(rs.NAME,rs);const as=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{hidden:this.do()}),this.validate()}do(){const t=Mi(this.getWorkSheet(),this._doActionData.hidden);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:as.NAME,hidden:this.do()}}undo(){const{hidden:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:as.NAME,sheetId:e,hidden:Mi(n,t)},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let ls=as;ls.NAME="SetWorkSheetHideAction",fi.register(ls.NAME,ls);const hs=class extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{sheetName:this.do()}),this.validate()}do(){const t=go(this.getWorkSheet(),this._doActionData.sheetName);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:hs.NAME,sheetName:this.do()}}undo(){const{sheetName:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:hs.NAME,sheetId:e,sheetName:go(n,t)},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let cs=hs;cs.NAME="SetWorkSheetNameAction",fi.register(cs.NAME,cs);class ds extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{sheetStatus:this.do()}),this.validate()}do(){const t=_o(this.getWorkSheet(),this._doActionData.sheetStatus);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:Pt.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Pt.SET_WORKSHEET_STATUS_ACTION,sheetId:e,sheetStatus:_o(n,t)},this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ds.NAME="SetWorkSheetStatusAction",fi.register(ds.NAME,ds);class us extends vi{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{zoom:this.do()}),this.validate()}redo(){const t=po(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this}),t}do(){return this.redo()}undo(){po(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:gi.REDO,data:this._oldActionData,action:this})}validate(){return!1}}us.NAME="SetZoomRatioAction",fi.register(us.NAME,us);class gs extends N{constructor(t,e,n){if(super(t,n),null==e.DocumentUnit)throw new Error("action document domain can not be null!");this._document=e.DocumentUnit}getDocument(){return this._document}}function _s(t,e=!1){return e?t-1:t}function ps(t,e,n){return t.slice(0,e)+n+t.slice(e)}function ms(t,e){let n=t.body;if(e){const{headers:i,footers:o}=t;(null==i?void 0:i[e])?n=i[e].body:(null==o?void 0:o[e])&&(n=o[e].body)}return n}function Ts(t,e){return!(!t.ts||!e.ts)&&ci(t.ts,e.ts)}function fs(t,e){if(Ts(t,e))return t.ct+=e.ct||"",t}function vs(t,e,n){const i=t.getSnapshot(),{segmentId:o}=n,s=ms(i,o);if(0===e.length)return;if(null==s)throw new Error("no body has changed");const{blockElements:r}=s;for(let a of r){if(null==a)continue;const{blockType:t}=a;switch(t){case j.PARAGRAPH:a.paragraph&&Es(e,a,a.paragraph,n)}}}function Es(t,e,n,i){const{st:o,ed:s}=e,{cursorStart:r,isStartBack:a,segmentId:l}=i,h=_s(r,a);if(h>s||null==n)return;const{elements:c}=n;for(let d of c){const{et:e}=d;if(e===it.DRAWING)continue;const{st:n,ed:i,tr:o}=d;if(null!=o&&o.tab!==Fe.TRUE&&(!(h<n||h>i)&&(console.log("paragraphApply",h,n,i,d,h<n||h>i),e===it.TEXT_RUN))){let e=h-n+1;e<=0&&(e=0);const i=ps(o.ct||"",e,t);o.ct=i}}}function Is(t,e){const n=t.getSnapshot(),{segmentId:i}=e,o=ms(n,i);if(null==o)throw new Error("no body has changed");const{blockElements:s}=o;for(let r of s){if(null==r)continue;const{blockType:t}=r;switch(t){case j.PARAGRAPH:r.paragraph&&bs(r,r.paragraph,e)}}}function bs(t,e,n){var i,o;const{cursorStart:s,cursorEnd:r,isStartBack:a,isEndBack:l,isCollapse:h}=n,c=_s(s,a),d=_s(r,l),{st:u,ed:g}=t;if(s>g||r<u)return;const{elements:_}=e;let p=0;for(let v of _){const{et:t}=v;if(t===it.DRAWING){p++;continue}const{st:e,ed:n,tr:s}=v;if(null!=s&&s.tab!==Fe.TRUE)if(d<e||c>n)p++;else{if(t===it.TEXT_RUN){let t=c-e+1,i=d-e+1;t<=0&&(t=0),i>=n-e-1&&(t=n-e-1);const o=(m=s.ct||"",(T=t)>(f=i)?m:(T===f&&(T-=1),m.slice(0,T)+m.slice(f)));s.ct=o}if(0===(null==(i=s.ct)?void 0:i.length))_.splice(p,1);else{const t=null==(o=_[p-1])?void 0:o.tr;if(!t){p++;continue}fs(s,t)?_.splice(p,1):p++}}else p++}var m,T,f}var As,Cs;(Cs=As||(As={})).INSERT_TEXT_ACTION_NAME="InsertTextAction",Cs.DELETE_TEXT_ACTION_NAME="DeleteTextAction",Cs.CLEAR_TEXT_STYLE_ACTION_NAME="ClearTextStyleAction",Cs.DELETE_PARAGRAPH_ACTION_NAME="DeleteParagraphAction",Cs.INSERT_PARAGRAPH_ACTION_NAME="InsertParagraphAction",Cs.MERGE_PARAGRAPH_ACTION_NAME="MergeParagraphAction",Cs.MOVE_PARAGRAPH_ACTION_NAME="MoveParagraphAction",Cs.SET_TEXT_STYLE_ACTION_NAME="SetTextStyleAction",Cs.SPLIT_PARAGRAPH_ACTION_NAME="SplitParagraphAction",Cs.UPDATE_DOCUMENT_STYLE_ACTION_NAME="UpdateDocumentAction",Cs.UPDATE_PARAGRAPH_STYLE_ACTION_NAME="UpdateParagraphAction",Cs.UPDATE_SECTION_ACTION_NAME="UpdateSectionAction",Cs.DELETE_BULLET_ACTION_NAME="DeleteBulletAction",Cs.DELETE_PARAGRAPH_BULLET_ACTION_NAME="DeleteParagraphBulletAction",Cs.DELETE_SECTION_ACTION_NAME="DeleteSectionAction",Cs.INSERT_BULLET_ACTION_NAME="InsertBulletAction",Cs.INSERT_PARAGRAPH_BULLET_ACTION_NAME="InsertParagraphBulletAction",Cs.INSERT_SECTION_ACTION_NAME="InsertSectionAction",Cs.UPDATE_BULLET_ACTION_NAME="UpdateBulletAction",Cs.UPDATE_PARAGRAPH_BULLET_ACTION_NAME="UpdateParagraphBulletAction",Cs.TEXT_INDEX_ADJUST_ACTION_NAME="TextIndexAdjustAction";class Ss extends gs{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do();const{cursorStart:i,isStartBack:o,text:s}=t;this._oldActionData=c(h({},t),{actionName:As.DELETE_TEXT_ACTION_NAME,cursorEnd:i+s.length,isEndBack:o,isCollapse:!0})}redo(){this.do()}do(){const t=this.getDoActionData(),e=this.getDocument(),{text:n,cursorStart:i,isStartBack:o,segmentId:s}=t;vs(e,n,{cursorStart:i,isStartBack:o,segmentId:s}),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}undo(){const t=this.getOldActionData();Is(this.getDocument(),h({},t)),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ss.NAME="InsertTextAction",fi.register(Ss.NAME,Ss);class Ns extends gs{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do();const{text:i,cursorStart:o,isStartBack:s,segmentId:r}=t;this._oldActionData={actionName:As.INSERT_TEXT_ACTION_NAME,text:i,cursorStart:o,isStartBack:s,segmentId:r}}redo(){this.do()}do(){const t=this.getDoActionData(),e=this.getDocument(),{cursorStart:n,cursorEnd:i,isStartBack:o,isEndBack:s,isCollapse:r,segmentId:a}=t;Is(e,{cursorStart:n,cursorEnd:i,isStartBack:o,isEndBack:s,isCollapse:r,segmentId:a})}undo(){const t=this.getOldActionData(),e=this.getDocument(),{text:n,cursorStart:i,isStartBack:o,segmentId:s}=t;vs(e,n,{cursorStart:i,isStartBack:o,segmentId:s})}validate(){return!1}}function Rs(t,e){const{segmentId:n}=e;let i=ms(t.getSnapshot(),n);if(null==i)throw new Error("no body has changed");const{blockElements:o}=i;let s=null;for(let r of o){if(null==r)continue;const{blockType:t}=r;switch(t){case j.PARAGRAPH:r.paragraph&&ws(r,r.paragraph,e,s),s=r}}}function ws(t,e,n,i){const{cursorStart:o,cursorEnd:s,isCollapse:r,isEndBack:a,isStartBack:l}=n,{st:h,ed:c}=t;if(o>c)return;const{elements:d}=e,u=i?i.ed:-1;if(s<h){const e=u-h+1;!function(t,e=0){null!=t&&(t.st+=e,t.ed+=e)}(t,e),Os(d,(t=>{!function(t,e=0){null!=t&&(t.st+=e,t.ed+=e)}(t,e)}))}else{let e=u+1,n=e;Os(d,(t=>{const{tr:e}=t,i=(null==e?void 0:e.ct)||"";t.st=n,t.ed=n+i.length-1,n=t.ed+1})),t.st=e,t.ed=n-1}}function Os(t,e){for(let n of t){const{et:t}=n;t!==it.DRAWING&&e(n)}}Ns.Name="DeleteTextAction",fi.register(Ns.Name,Ns);class ys extends gs{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t)}redo(){this.do()}do(){const t=this.getDoActionData();Rs(this.getDocument(),t),this._observers.notifyObservers({type:gi.REDO,data:this._doActionData,action:this})}undo(){const t=this.getOldActionData();Rs(this.getDocument(),t),this._observers.notifyObservers({type:gi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ys.Name="TextIndexAdjustAction",fi.register(ys.Name,ys);class Ms{constructor(t){this._name=t,this._observeNames=[]}onCreate(t){this.context=t}load(t){}save(){return Object()}onMounted(t){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getGlobalContext(){return this.context.getUniver().getGlobalContext()}getLocale(){return this.getGlobalContext().getLocale()}getUniver(){return this.context.getUniver()}getObserver(t){return this.context.getObserverManager().getObserver(t,this._name)}getPluginByName(t){return this.context.getPluginManager().getPluginByName(t)}pushToObserve(...t){const e=this.context.getObserverManager();t.forEach((t=>{this._observeNames.includes(t)||this._observeNames.push(t),e.addObserver(t,this._name,new O)}))}deleteObserve(...t){const e=this.context.getObserverManager();t.forEach((t=>{e.removeObserver(t,this._name)}))}}class Ds{constructor(t,e=[]){this._context=t,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(e),this._initialize()}install(t){const{_plugins:e}=this;e.push(t),t.onCreate(this._context),t.onMounted(this._context)}uninstall(t){const{_plugins:e}=this,n=e.findIndex((e=>e.getPluginName()===t));if(n>-1){const t=e.splice(n,1)[0];t&&t.onDestroy()}}setContext(t){this._context=t}getRequirePluginByName(t){for(let e=0;e<this._plugins.length;e++)if(this._plugins[e].getPluginName()===t)return this._plugins[e];throw new Error(`not found plugin ${t}`)}getPlugins(){return this._plugins}getPluginByName(t){for(let e=0;e<this._plugins.length;e++)if(this._plugins[e].getPluginName()===t)return this._plugins[e];return null}_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach((t=>{t.onCreate(this._context),t.onMounted(this._context)})))}}class Ls{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class xs{constructor(){this._hooksManager=new M,this._pluginManager=new Ds(this),this._environment=new Ls,this._observerManager=new ui,this._initialize()}onUniver(t){const e=t.getGlobalContext();this._univer=t,this._undoManager=e.getUndoManager(),this._commandManager=e.getCommandManager()}getHook(t){return this._hooksManager.getHooks(t)}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}getUniver(){return this._univer}_initialize(){this._undoManager=new Ii,this._commandManager=new fi(this)}}class ks extends xs{constructor(t={}){super(),this._locale=new qn,this._locale.initialize(),null==t.id||0===t.id.length?this._univerId=U.generateRandomId(10):this._univerId=t.id}getLocale(){return this._locale}getUniverId(){return this._univerId}_setObserver(){}}class Hs{constructor(t,e){var n;this._context=e,this._snapshot=h(h({},Qe),t),this._unitId=null!=(n=this._snapshot.id)?n:U.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}insertText(t,e,n){const{_context:i}=this,o=i.getCommandManager(),s=c(h({actionName:As.INSERT_TEXT_ACTION_NAME},e),{text:t,segmentId:n}),r=new Ei({DocumentUnit:this},s,this._addTextIndexAdustAction(e,n));return o.invoke(r),this}deleteText(t,e){const{_context:n}=this,i=n.getCommandManager(),o=this._getDeleteTextAction(t,e),s=new Ei({DocumentUnit:this},...o,this._addTextIndexAdustAction(t,e));return i.invoke(s),this}updateText(t,e,n,i){const{_context:o}=this,s=o.getCommandManager(),r=[];e.length>0&&r.push(...this._getDeleteTextAction({cursorStart:n,isStartBack:!1,isCollapse:!1,cursorEnd:n+e.length,isEndBack:!1},i));const a={actionName:As.INSERT_TEXT_ACTION_NAME,cursorStart:n,isStartBack:!1,text:t,segmentId:i},l=new Ei({DocumentUnit:this},...r,a,this._addTextIndexAdustAction({cursorStart:n,cursorEnd:n+Math.max(e.length,t.length),isCollapse:!1,isEndBack:!1,isStartBack:!1},i));return s.invoke(l),this}_addTextIndexAdustAction(t,e){const{cursorStart:n,cursorEnd:i,isCollapse:o,isEndBack:s,isStartBack:r}=t;return{actionName:As.TEXT_INDEX_ADJUST_ACTION_NAME,cursorStart:n,cursorEnd:i,isCollapse:o,isEndBack:s,isStartBack:r,segmentId:e}}_getDeleteTextAction(t,e){const{cursorStart:n,cursorEnd:i,isCollapse:o,isEndBack:s,isStartBack:r}=t;let a=[];return a=o?this._getDeleteTextActionCollapse(t,e):this._getDeleteTextActionRange(t,e),0===a.length?[]:a}_getDeleteTextActionCollapse(t,e){var n;const i=ms(this._snapshot,e);if(null==i)return[];const{blockElements:o}=i,{cursorStart:s,isCollapse:r,isStartBack:a}=t,l=[];let h=null,c=null,d=null;for(let u of o){if(null==u)continue;const{blockType:t,st:i,ed:o,blockId:r}=u;if(t===j.PARAGRAPH){if(s>o||s<i)continue;s===i&&a?(null==(n=u.paragraph)?void 0:n.bullet)?l.push({actionName:As.DELETE_BULLET_ACTION_NAME,blockId:r,blockElement:u,segmentId:e}):(h=d,c=r):l.push({actionName:As.DELETE_TEXT_ACTION_NAME,cursorStart:s,cursorEnd:s,isCollapse:!0,isEndBack:a,isStartBack:a,segmentId:e})}d=r}return null!=h&&null!=c&&h!==c&&l.push({actionName:As.MERGE_PARAGRAPH_ACTION_NAME,startBlockId:h,endBlockId:c,segmentId:e,cursorStart:s,isStartBack:a}),l}_getDeleteTextActionRange(t,e){const n=ms(this._snapshot,e);if(null==n)return[];const{blockElements:i}=n,{cursorStart:o,cursorEnd:s,isCollapse:r,isEndBack:a,isStartBack:l}=t,h=[];let c=null,d=null;for(let u of i){if(null==u)continue;const{blockType:t,st:n,ed:i,blockId:g}=u;if(t===j.PARAGRAPH){if(o>i||s<n)continue;let t=n,_=i,p=l,m=a;n<=o&&i>=o?(c=g,t=o):p=!0,n<=s&&i>=s?(d=g,_=s):m=!1,(o<n||o===n&&l)&&(s>i||s===i&&!a)&&!r?h.push({actionName:As.DELETE_PARAGRAPH_ACTION_NAME,cursorStart:n,cursorEnd:i,isCollapse:!1,isEndBack:!1,isStartBack:!0,blockId:g,blockElement:u,segmentId:e}):h.push({actionName:As.DELETE_TEXT_ACTION_NAME,cursorStart:t,cursorEnd:_,isCollapse:r,isEndBack:m,isStartBack:p,segmentId:e})}}return null!=c&&null!=d&&c!==d&&h.push({actionName:As.MERGE_PARAGRAPH_ACTION_NAME,startBlockId:c,endBlockId:d,segmentId:e,cursorStart:o,isStartBack:l}),h}}class Ps extends xs{constructor(t={}){super(),this._document=new Hs(t,this)}getDocument(){return this._document}_setObserver(){}}class Bs{constructor(){this._data=[]}static create(){return new Bs}add(t){this._data.indexOf(t)>-1||this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}const Fs="0.0.1";class Us{constructor(t={}){this.univerDocConfig=t,this._context=new Ps(t)}get context(){return this._context}static newInstance(t={}){return Qn.capsule("dev",Fs,"powered by :: UniverDoc :: "),new Us(t)}static get(t){return Vn(c(h({},t),{type:"GET"}))}static post(t){return Vn(c(h({},t),{type:"POST"}))}getUnitId(){return this._context.getDocument().getUnitId()}installPlugin(t){this._context.getPluginManager().install(t)}uninstallPlugin(t){this._context.getPluginManager().uninstall(t)}}const zs=class{static register(t,e){let n=zs.sMap.get(t);n?n.push(e):(n=new Array,n.push(e),zs.sMap.set(t,n))}static getTable(t){var e;let n=new Array,i=t;for(;null!=i;){const t=null!=(e=zs.sMap.get(i))?e:[];n=n.concat(t),i=Object.getPrototypeOf(i)}return n}};let Ws=zs;var Gs,Vs;Ws.sMap=new Map,(Vs=Gs||(Gs={}))[Vs.singleton=0]="singleton",Vs[Vs.prototype=1]="prototype",Vs[Vs.nothing=2]="nothing";class Ys{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(t){this._messages.push(t),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const t=JSON.stringify(this._messages);localStorage.setItem("MessageQueue",t)}load(){const t=localStorage.getItem("MessageQueue");t&&(this._messages=JSON.parse(t))}}var Xs;(Xs||(Xs={})).MESSAGE_RESPONSE="message_response";var js,Ks,$s=Object.defineProperty,Zs=Object.getOwnPropertyDescriptor,qs=(t,e,n,i)=>{for(var o,s=i>1?void 0:i?Zs(e,n):e,r=t.length-1;r>=0;r--)(o=t[r])&&(s=(i?o(e,n,s):o(s))||s);return i&&s&&$s(e,n,s),s};(Ks=js||(js={})).WAIT="wait",Ks.WORK="work";const Qs=class extends class{static isMessageResponseReceive(t){return t.type===Xs.MESSAGE_RESPONSE}packMessage(t){return{changed:t,version:U.generateRandomId(6)}}}{initialize(){this.messageQueue=new Ys,this.status=js.WAIT,this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Kn({url:this.config.socketUrl}),this.socket.on(Yn.MESSAGE,(t=>{this.checkupReceiveMessage(t.data)})),this.socket.on(Yn.ERROR,(()=>{})),this.socket.on(Yn.OPEN,(()=>{})),this.socket.on(Yn.CLOSE,(()=>{})),this.socket.on(Yn.RETRY,(()=>{})),this.socket.on(Yn.DESTROY,(()=>{})),this.socket.link())}pushMessageQueue(t){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(t)),this.sendMessageQueue())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var t;const e=this.getTopMessage();return null!=(t=JSON.stringify(e))?t:""}checkupReceiveMessage(t){Qs.isMessageResponseReceive(t)&&this.getTopMessage().version===t.message.version&&(this.popTopMessage(),this.globalSendResolve())}async sendTopMessage(){const t=this.serializeTopMessage();return this.socket.send(t),new Promise((t=>this.globalSendResolve=t))}async sendMessageQueue(){const{messageQueue:t,status:e}=this;if(e===js.WAIT){for(this.status=js.WORK;t.hasMessage();)await this.sendTopMessage();this.status=js.WAIT}return this.status}};let Js=Qs;qs([(t,e)=>{Ws.register(t,e),Reflect.defineMetadata("AttributeValue",{},t,e)}],Js.prototype,"config",2),qs([(t,e,n)=>{Ws.register(t,e),Reflect.defineMetadata("PostConstruct",n,t,e)}],Js.prototype,"initialize",1);var tr={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","微软雅黑","宋体","黑体","楷体","仿宋","新宋体","华文新魏","华文行楷","华文隶书"],defaultFontSize:14,unit:"pt"}},er={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const nr=[0,0,0],ir=[255,255,255];var or,sr,rr,ar,lr;(or||(or={})).rect="rect",(rr=sr||(sr={})).PointerMove="PointerMove",rr.PointerDown="PointerDown",rr.PointerUp="PointerUp",rr.PointerOut="PointerOut",rr.PointerLeave="PointerLeave",rr.PointerOver="PointerOver",rr.PointerEnter="PointerEnter",rr.wheel="MouseWheel",rr.KeyDown="KeyDown",rr.KeyUp="KeyUp",(lr=ar||(ar={}))[lr.XY=0]="XY",lr[lr.X=1]="X",lr[lr.Y=2]="Y";const hr=14;var cr,dr,ur,gr;(dr=cr||(cr={})).DEFAULT="default",dr.AUTO="auto",dr.CROSSHAIR="crosshair",dr.POINTER="pointer",dr.MOVE="move",dr.EAST_RESIZE="e-resize",dr.NORTH_EAST_RESIZE="ne-resize",dr.NORTH_WEST_RESIZE="nw-resize",dr.NORTH_RESIZE="n-resize",dr.SOUTH_EAST_RESIZE="se-resize",dr.SOUTH_WEST_RESIZE="sw-resize",dr.SOUTH_RESIZE="s-resize",dr.WEST_RESIZE="w-resize",dr.TEXT="text",dr.WAIT="wait",dr.HELP="help",dr.CELL="cell",dr.NONE="none",dr.VERTICAL_TEXT="vertical-text",dr.NO_DROP="no-drop",dr.GRAB="grab",dr.GRABBING="grabbing",dr.ALL_SCROLL="all-scroll",dr.COLUMN_RESIZE="col-resize",dr.ROW_RESIZE="row-resize",dr.PROGRESS="progress",dr.NOT_ALLOWED="not-allowed",dr.ZOOM_IN="zoom-in",dr.ZOOM_OUT="zoom-out",(gr=ur||(ur={}))[gr.noClip=0]="noClip",gr[gr.DOC_SIZE=1]="DOC_SIZE",gr[gr.CONTENT_SIZE_LEFT=2]="CONTENT_SIZE_LEFT",gr[gr.CONTENT_SIZE_CENTER=3]="CONTENT_SIZE_CENTER",gr[gr.CONTENT_SIZE_Right=4]="CONTENT_SIZE_Right";var _r,pr,mr,Tr,fr,vr;(pr=_r||(_r={})).TOP="t",pr.BOTTOM="b",pr.LEFT="l",pr.RIGHT="r",(Tr=mr||(mr={}))[Tr.UP=0]="UP",Tr[Tr.DOWN=1]="DOWN",(vr=fr||(fr={})).ENGINE="Engine",vr.SCENE="Scene",vr.BASE_OBJECT="BaseObject",vr.SCENE_VIEWER="SceneViewer",vr.CANVAS="Canvas",vr.VIEWPORT="Viewport",vr.LAYER="Layer",vr.GROUP="Group";const Er=t=>({sbr:.5,sbo:t,spr:.5,spo:t});class Ir{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(t,e,n){this._globalFontMeasureCache.has(t)||(this._globalFontMeasureCache[t]=new Map),this._globalFontMeasureCache[t][e]=n}static clearFontMeasureCache(t){var e;const n=t.split("/");if(1===n.length){const t=n[0];this._globalFontMeasureCache.delete(t)}else{if(2!==n.length)return!1;{const t=n[0],i=n[1];null==(e=this._globalFontMeasureCache.get(t))||e.delete(i)}}return!0}static getFontMeasureCache(t,e){var n;return null==(n=this._globalFontMeasureCache[t])?void 0:n[e]}static autoCleanFontMeasureCache(t=1e6){let e=0,n=!1;for(let i of this._globalFontMeasureCache){const[,o]=i;if(e+=o.size,e>t){n=!0;break}}if(n){let e=0;for(let n of this._globalFontMeasureCache){const[i,o]=n;if(e+=o.size,e>t/2){const n=e-t/2;this._clearMeasureCache(n,o);break}this._globalFontMeasureCache.delete(i)}return!0}return!1}static getBaselineOffsetInfo(t,e){if(0===this._fontDataMap.size)return Er(e);const n=t.split(",");for(let i of n){i=i.replace(/'/g,"");const t=this._fontDataMap.get(i);if(!t)continue;const{subscriptSizeRatio:n,subscriptOffset:o,superscriptSizeRatio:s,superscriptOffset:r}=t;return{sbr:n,sbo:o*e,spr:s,spo:r*e}}return Er(e)}static getTextSizeByDom(t,e){if(e in this._getTextHeightCache)return this._getTextHeightCache[e];let n=document.getElementById("universheetTextSizeTest");n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;;${e}`,n.innerText=t;const i=n.getBoundingClientRect(),o={width:i.width,height:i.height};return this._getTextHeightCache[e]=o,o}static getTextSize(t,e){const{fontString:n,fontSize:i,fontFamily:o}=e;let s=this._getBoundingBoxByFont(o,i);if(!s){const e=this.getMeasureText(t,n);s=this._calculateBoundingBoxByMeasureText(e,i)}return s}static getMeasureText(t,e){if(!this._context){const t=document.createElement("canvas");this._context=t.getContext("2d")}const n=this._context,i=this.getFontMeasureCache(e,t);if(null!=i)return i;n.font=e;const o=n.measureText(t),{width:s,fontBoundingBoxAscent:r,fontBoundingBoxDescent:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h}=o,c={width:s,fontBoundingBoxAscent:r,fontBoundingBoxDescent:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h};if(null==r||null==a||Number.isNaN(r)||Number.isNaN(a)){let t=this.getTextSizeByDom("0",e)[1];"top"===n.textBaseline?(c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t,c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=0):"middle"===n.textBaseline?(c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=t/2,c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t/2):(c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=0,c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t)}return this.setFontMeasureCache(e,t,c),c}static _clearMeasureCache(t,e){let n=0;for(let i of e){const[o]=i;if(n>t)break;e.delete(o),n++}return!0}static _getBoundingBoxByFont(t,e=28,n=""){const i=this._fontDataMap.get(t);if(!i)return;const{notDefWidth:o,ascender:s,descender:r,typoAscender:a,typoDescender:l,strikeoutPosition:h,subscriptSizeRatio:c,subscriptOffset:d,superscriptSizeRatio:u,superscriptOffset:g,hdmxData:_,glyphHorizonMap:p}=i,m=null==_?void 0:_.indexOf(Math.floor(e)),T=p.get(n.charCodeAt(0));let f=o;if(T){const{width:t,pixelsPerEm:e=[]}=T;f=m?e[m]:t}return{width:f*e,ba:s*e,bd:r*e,aba:a*e,abd:l*e,sp:h*e,sbr:c,sbo:d*e,spr:u,spo:g*e}}static _calculateBoundingBoxByMeasureText(t,e){const{width:n,fontBoundingBoxAscent:i,fontBoundingBoxDescent:o,actualBoundingBoxAscent:s,actualBoundingBoxDescent:r}=t;return{width:n,ba:i,bd:o,aba:s,abd:r,sp:(i+o)/2,sbr:.5,sbo:e,spr:.5,spo:e}}}var br,Ar,Cr,Sr,Nr,Rr,wr,Or,yr,Mr,Dr,Lr,xr,kr,Hr,Pr,Br,Fr;Ir._getTextHeightCache={},Ir._fontDataMap=new Map,Ir._globalFontMeasureCache=new Map,(Ar=br||(br={}))[Ar.SPAN=0]="SPAN",Ar[Ar.DIVIDE=1]="DIVIDE",Ar[Ar.LINE=2]="LINE",Ar[Ar.COLUMN=3]="COLUMN",Ar[Ar.SECTION=4]="SECTION",Ar[Ar.PAGE=5]="PAGE",Ar[Ar.DRAWING=6]="DRAWING",Ar[Ar.BULLET=7]="BULLET",Ar[Ar.HEADER=8]="HEADER",Ar[Ar.FOOTER=9]="FOOTER",Ar[Ar.ALL=10]="ALL",(Sr=Cr||(Cr={}))[Sr.SECTION=0]="SECTION",Sr[Sr.PAGE=1]="PAGE",Sr[Sr.COLUMN=2]="COLUMN",(Rr=Nr||(Nr={}))[Rr.PARAGRAPH=0]="PARAGRAPH",Rr[Rr.BLOCK=1]="BLOCK",(Or=wr||(wr={}))[Or.LETTER=0]="LETTER",Or[Or.WORD=1]="WORD",Or[Or.LIST=2]="LIST",Or[Or.TAB=3]="TAB",Or[Or.IMAGE=4]="IMAGE",Or[Or.AT=5]="AT",Or[Or.MATH=6]="MATH",Or[Or.MULTI_LINE=7]="MULTI_LINE",Or[Or.CUSTOM=8]="CUSTOM",(Mr=yr||(yr={}))[Mr.VERTICAL=0]="VERTICAL",Mr[Mr.HORIZONTAL=1]="HORIZONTAL",Mr[Mr.AUTO=2]="AUTO",(Lr=Dr||(Dr={}))[Lr.PointerMove=0]="PointerMove",Lr[Lr.PointerDown=1]="PointerDown",Lr[Lr.PointerUp=2]="PointerUp",(kr=xr||(xr={}))[kr.Generic=0]="Generic",kr[kr.Keyboard=1]="Keyboard",kr[kr.Mouse=2]="Mouse",kr[kr.Touch=3]="Touch",(Pr=Hr||(Hr={}))[Pr.Horizontal=0]="Horizontal",Pr[Pr.Vertical=1]="Vertical",Pr[Pr.LeftClick=2]="LeftClick",Pr[Pr.MiddleClick=3]="MiddleClick",Pr[Pr.RightClick=4]="RightClick",Pr[Pr.BrowserBack=5]="BrowserBack",Pr[Pr.BrowserForward=6]="BrowserForward",Pr[Pr.MouseWheelX=7]="MouseWheelX",Pr[Pr.MouseWheelY=8]="MouseWheelY",Pr[Pr.MouseWheelZ=9]="MouseWheelZ",Pr[Pr.DeltaHorizontal=10]="DeltaHorizontal",Pr[Pr.DeltaVertical=11]="DeltaVertical",Pr[Pr.FakeMove=12]="FakeMove",(Fr=Br||(Br={}))[Fr.translate=0]="translate",Fr[Fr.resize=1]="resize",Fr[Fr.scale=2]="scale",Fr[Fr.skew=3]="skew",Fr[Fr.flip=4]="flip",Fr[Fr.all=5]="all";class Ur{constructor(t=30){this._enabled=!0,this._rollingFrameTime=new zr(t)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let t=this._rollingFrameTime.history(0);return 0===t?0:1e3/t}get isSaturated(){return this._rollingFrameTime.isSaturated()}get isEnabled(){return this._enabled}sampleFrame(t=this.Now()){if(this._enabled){if(null!=this._lastFrameTimeMs){let e=t-this._lastFrameTimeMs;this._rollingFrameTime.add(e)}this._lastFrameTimeMs=t}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class zr{constructor(t){this._samples=new Array(t),this.reset()}add(t){let e;if(this.isSaturated()){let t=this._samples[this._pos];e=t-this.average,this.average-=e/(this._sampleCount-1),this._m2-=e*(t-this.average)}else this._sampleCount++;e=t-this.average,this.average+=e/this._sampleCount,this._m2+=e*(t-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=t,this._pos++,this._pos%=this._samples.length}history(t){if(t>=this._sampleCount||t>=this._samples.length)return 0;let e=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(e-t)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(t){let e=this._samples.length;return(t%e+e)%e}}const Wr=Math.PI/180,Gr=180/Math.PI,Vr=(t,e)=>t?null!=e?`${"rgba("+t.join(",")},${e})`:"rgb("+t.join(",")+")":"rgb(0,0,0)",Yr=(t,e)=>{if(U.isNumber(t))return t;if(e&&t&&U.isString(t)&&"%"===t.substr(t.length-1,1)){return e*(parseFloat(t)/100)}return 0},Xr=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):window.setTimeout(t,16)),jr=()=>{let t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){console.error(e)}return t},Kr=t=>t*Wr,$r=()=>{let t="pointer";return"undefined"==typeof window||window.PointerEvent||"undefined"==typeof navigator||navigator.pointerEnabled||(t="mouse"),!U.isTablet()||U.isIPhone()||document&&"ontouchend"in document||(t="mouse"),t};function Zr(t){return Object.prototype.toString.apply(t)}function qr(t){return"[object String]"===Zr(t)}function Qr(t,e){return e=10**e,Math.round(t*e)/e}function Jr(t,e){return Math.round(t*e)/e}function ta(t,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:n,defaultFontSize:i}=e;if(!t)return{fontString:`${i}px  ${n[0]}`,fontSize:i,fontFamily:n[0]};let o=It.ITALIC;0!==t.it&&void 0!==t.it||(o=It.NORMAL);let s=It.BOLD;0!==t.bl&&void 0!==t.bl||(s=It.NORMAL);let r=i;t.fs&&(r=Math.ceil(t.fs));let a=n[0];if(t.ff){let e=t.ff;e=e.replace(/"/g,"").replace(/'/g,""),e.indexOf(" ")>-1&&(e=`"${e}"`),null==e&&(e=n[0]),a=e}const{va:l}=t;if(l===Pe.SUBSCRIPT||l===Pe.SUPERSCRIPT){const t=Ir.getBaselineOffsetInfo(a,r),{sbr:e,spr:n}=t;r*=l===Pe.SUBSCRIPT?e:n}return{fontString:`${o} ${s} ${r}px ${a}, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif `,fontSize:r,fontFamily:a}}function ea(t){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(t)}function na(t){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(t)}function ia(t){return!!/[\u0180-\u024F]/gi.exec(t)}function oa(t){return!!/\s+|\t+/g.exec(t)}function sa(t){const{scaleX:e=1,scaleY:n=1}=t;return Math.max(e,n)}function ra(t){return Number(t.replace(/px/gi,""))}class aa{constructor(t=0,e=0){this.x=t,this.y=e}static Zero(){return new aa(0,0)}static One(){return new aa(1,1)}static FromArray(t,e=0){return new aa(t[e],t[e+1])}static FromArrayToRef(t,e,n){n.x=t[e],n.y=t[e+1]}static CatmullRom(t,e,n,i,o){let s=o*o,r=o*s,a=.5*(2*e.x+(-t.x+n.x)*o+(2*t.x-5*e.x+4*n.x-i.x)*s+(-t.x+3*e.x-3*n.x+i.x)*r),l=.5*(2*e.y+(-t.y+n.y)*o+(2*t.y-5*e.y+4*n.y-i.y)*s+(-t.y+3*e.y-3*n.y+i.y)*r);return new aa(a,l)}static Clamp(t,e,n){let i=t.x;i=i>n.x?n.x:i,i=i<e.x?e.x:i;let o=t.y;return o=o>n.y?n.y:o,o=o<e.y?e.y:o,new aa(i,o)}static Hermite(t,e,n,i,o){let s=o*o,r=o*s,a=2*r-3*s+1,l=-2*r+3*s,h=r-2*s+o,c=r-s,d=t.x*a+n.x*l+e.x*h+i.x*c,u=t.y*a+n.y*l+e.y*h+i.y*c;return new aa(d,u)}static Hermite1stDerivative(t,e,n,i,o){let s=aa.Zero();return this.Hermite1stDerivativeToRef(t,e,n,i,o,s),s}static Hermite1stDerivativeToRef(t,e,n,i,o,s){const r=o*o;s.x=6*(r-o)*t.x+(3*r-4*o+1)*e.x+6*(-r+o)*n.x+(3*r-2*o)*i.x,s.y=6*(r-o)*t.y+(3*r-4*o+1)*e.y+6*(-r+o)*n.y+(3*r-2*o)*i.y}static Lerp(t,e,n){let i=t.x+(e.x-t.x)*n,o=t.y+(e.y-t.y)*n;return new aa(i,o)}static Dot(t,e){return t.x*e.x+t.y*e.y}static Normalize(t){let e=aa.Zero();return this.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){let n=t.length();0!==n&&(e.x=t.x/n,e.y=t.y/n)}static Minimize(t,e){let n=t.x<e.x?t.x:e.x,i=t.y<e.y?t.y:e.y;return new aa(n,i)}static Maximize(t,e){let n=t.x>e.x?t.x:e.x,i=t.y>e.y?t.y:e.y;return new aa(n,i)}static Transform(t,e,n=!1){const i=e,o=t;return n?new aa(i[0]*o.x+i[2]*o.y,i[1]*o.x+i[3]*o.y):new aa(i[0]*o.x+i[2]*o.y+i[4],i[1]*o.x+i[3]*o.y+i[5])}static PointInTriangle(t,e,n,i){let o=.5*(-n.y*i.x+e.y*(-n.x+i.x)+e.x*(n.y-i.y)+n.x*i.y),s=o<0?-1:1,r=(e.y*i.x-e.x*i.y+(i.y-e.y)*t.x+(e.x-i.x)*t.y)*s,a=(e.x*n.y-e.y*n.x+(e.y-n.y)*t.x+(n.x-e.x)*t.y)*s;return r>0&&a>0&&r+a<2*o*s}static Distance(t,e){return Math.sqrt(aa.DistanceSquared(t,e))}static DistanceSquared(t,e){let n=t.x-e.x,i=t.y-e.y;return n*n+i*i}static Center(t,e){return aa.CenterToRef(t,e,aa.Zero())}static CenterToRef(t,e,n){return n.copyFromFloats((t.x+e.x)/2,(t.y+e.y)/2)}static DistanceOfPointFromSegment(t,e,n){let i=aa.DistanceSquared(e,n);if(0===i)return aa.Distance(t,e);let o=n.subtract(e),s=Math.max(0,Math.min(1,aa.Dot(t.subtract(e),o)/i)),r=e.add(o.multiplyByFloats(s,s));return aa.Distance(t,r)}static create(t,e){return new aa(t,e)}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let t=0|this.x;return t=397*t^(0|this.y),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,this}fromArray(t,e=0){return aa.FromArrayToRef(t,e,this),this}asArray(){let t=new Array;return this.toArray(t,0),t}copyFrom(t){return this.x=t.x,this.y=t.y,this}copyFromFloats(t,e){return this.x=t,this.y=e,this}set(t,e){return this.copyFromFloats(t,e)}add(t){return new aa(this.x+t.x,this.y+t.y)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this}addByPoint(t,e){return new aa(this.x+t,this.y+e)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return new aa(this.x-t.x,this.y-t.y)}subtractByPoint(t,e){return new aa(this.x-t,this.y-e)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this}multiply(t){return new aa(this.x*t.x,this.y*t.y)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this}multiplyByFloats(t,e){return new aa(this.x*t,this.y*e)}divide(t){return new aa(this.x/t.x,this.y/t.y)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this}divideInPlace(t){return this.divideToRef(t,this)}negate(){return new aa(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(t){return t.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(t){return this.x*=t,this.y*=t,this}scale(t){let e=new aa(0,0);return this.scaleToRef(t,e),e}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y}floor(){return new aa(Math.floor(this.x),Math.floor(this.y))}fract(){return new aa(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,o=n*this.x+e*this.y;return this.x=i,this.y=o,this}rotateToRef(t,e){const n=Math.cos(t),i=Math.sin(t);return e.x=n*this.x-i*this.y,e.y=i*this.x+n*this.y,this}rotateByPoint(t,e=aa.create(0,0)){const n=Math.cos(t),i=Math.sin(t),o=e.x+(this.x-e.x)*n-(this.y-e.y)*i,s=e.y+(this.x-e.x)*i+(this.y-e.y)*n;return this.x=o,this.y=s,this}transformCoordinateOnRotate(t){const e=Math.sqrt(this.x**2+this.y**2),n=-t+Math.atan2(this.y,this.x);return this.x=e*Math.cos(n),this.y=e*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return aa.NormalizeToRef(this,this),this}clone(){return new aa(this.x,this.y)}}const la=[1,0,0,1,0,0];class ha{constructor(t=la){this.dirty=!1,this._m=t&&t.slice()||la}static create(t=la){return new this(t)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new ha(this._m)}copyInto(t){t._m[0]=this._m[0],t._m[1]=this._m[1],t._m[2]=this._m[2],t._m[3]=this._m[3],t._m[4]=this._m[4],t._m[5]=this._m[5]}applyPoint(t,e=!1){const n=this._m;let i=n[0]*t.x+n[2]*t.y,o=n[1]*t.x+n[3]*t.y;return e?new aa(i,o):new aa(i+n[4],o+n[5])}translate(t,e){return this._m[4]+=this._m[0]*t+this._m[2]*e,this._m[5]+=this._m[1]*t+this._m[3]*e,this}scale(t,e){return this._m[0]*=t,this._m[1]*=t,this._m[2]*=e,this._m[3]*=e,this}rotate(t){const e=Kr(t);let n=Math.cos(e),i=Math.sin(e),o=this._m[0]*n+this._m[2]*i,s=this._m[1]*n+this._m[3]*i,r=this._m[0]*-i+this._m[2]*n,a=this._m[1]*-i+this._m[3]*n;return this._m[0]=o,this._m[1]=s,this._m[2]=r,this._m[3]=a,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(t,e){let n=this._m[0]+this._m[2]*e,i=this._m[1]+this._m[3]*e,o=this._m[2]+this._m[0]*t,s=this._m[3]+this._m[1]*t;return this._m[0]=n,this._m[1]=i,this._m[2]=o,this._m[3]=s,this}multiply(t){let e=this._m[0]*t._m[0]+this._m[2]*t._m[1],n=this._m[1]*t._m[0]+this._m[3]*t._m[1],i=this._m[0]*t._m[2]+this._m[2]*t._m[3],o=this._m[1]*t._m[2]+this._m[3]*t._m[3],s=this._m[0]*t._m[4]+this._m[2]*t._m[5]+this._m[4],r=this._m[1]*t._m[4]+this._m[3]*t._m[5]+this._m[5];return this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=o,this._m[4]=s,this._m[5]=r,this}invert(){let t=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),e=this._m[3]*t,n=-this._m[1]*t,i=-this._m[2]*t,o=this._m[0]*t,s=t*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),r=t*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=o,this._m[4]=s,this._m[5]=r,this}getMatrix(){return this._m}getMatrixByAccurate(t=3){return this._m.map((e=>Qr(e,t)))}setAbsolutePosition(t){let e=this._m[0],n=this._m[1],i=this._m[2],o=this._m[3],s=this._m[4],r=this._m[5],a=(e*(t.y-r)-n*(t.x-s))/(e*o-n*i),l=(t.x-s-i*a)/e;return this.translate(l,a)}decompose(){let t=this._m[0],e=this._m[1],n=this._m[2],i=this._m[3],o=t*i-e*n,s={x:this._m[4],y:this._m[5],angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let r=Math.sqrt(t*t+e*e);s.angle=e>0?Math.acos(t/r):-Math.acos(t/r),s.scaleX=r,s.scaleY=o/r,s.skewX=(t*n+e*i)/o,s.skewY=0}else if(0!==n||0!==i){let r=Math.sqrt(n*n+i*i);s.angle=Math.PI/2-(i>0?Math.acos(-n/r):-Math.acos(n/r)),s.scaleX=o/r,s.scaleY=r,s.skewX=0,s.skewY=(t*n+e*i)/o}return s.angle=s.angle*Gr,s}makeBoundingBoxFromPoints(t){if(this)for(let r=0;r<t.length;r++)t[r]=this.applyPoint(t[r]);const e=[t[0].x,t[1].x,t[2].x,t[3].x],n=Math.min(...e),i=Math.max(...e)-n,o=[t[0].y,t[1].y,t[2].y,t[3].y],s=Math.min(...o);return{left:n,top:s,width:i,height:Math.max(...o)-s,points:t}}composeMatrix(t){const e=new ha([1,0,0,1,t.left||0,t.top||0]);return t.angle&&e.rotate(t.angle),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&e.multiply(this._calcDimensionsMatrix(t)),this._m=e.getMatrix(),this}clone(){return new ha([...this._m])}_calcDimensionsMatrix(t){var e,n;const i=null!=(e=t.scaleX)?e:1,o=null!=(n=t.scaleY)?n:1,s=new ha([t.flipX?-i:i,0,0,t.flipY?-o:o,0,0]);return t.skewX&&s.multiply(new ha([1,0,Math.tan(Kr(t.skewX)),1,0,0])),t.skewY&&s.multiply(new ha([1,Math.tan(Kr(t.skewY)),0,1,0,0])),s}}function ca(t,e,n){let i=0,o=0,s=0,r=0;const{startX:a,startY:l,endX:h,endY:c}=n;e===_r.TOP?(i=a,o=l,s=h,r=l):e===_r.BOTTOM?(i=a,o=c,s=h,r=c):e===_r.LEFT?(i=a,o=l,s=a,r=c):e===_r.RIGHT&&(i=h,o=l,s=h,r=c),t.beginPath(),t.moveTo(i,o),t.lineTo(s,r),t.stroke()}function da(t,e){e===Gt.HAIR?t.setLineDash([1,2]):e===Gt.DASH_DOT_DOT||e===Gt.MEDIUM_DASH_DOT_DOT?t.setLineDash([2,2,5,2,2]):e===Gt.DASH_DOT||e===Gt.MEDIUM_DASH_DOT||e===Gt.SLANT_DASH_DOT?t.setLineDash([2,5,2]):e===Gt.DOTTED?t.setLineDash([2]):e===Gt.DASHED||e===Gt.MEDIUM_DASHED?t.setLineDash([3]):t.setLineDash([0])}function ua(t){let e=1;return t===Gt.MEDIUM||t===Gt.MEDIUM_DASH_DOT||t===Gt.MEDIUM_DASHED||t===Gt.MEDIUM_DASH_DOT_DOT?e=2:t===Gt.THICK&&(e=3),e}function ga(t,e,n,i,o=aa.create(0,0)){const s=t.add(e).rotateByPoint(i),r=i-n;return s.subtract(e).rotateByPoint(r,s).add(o).transformCoordinateOnRotate(r)}function _a(t,e,n){const i=[];let o=0,s=0,r=0,a=0,l=0;const h=n>0?mr.DOWN:mr.UP;const c=t.length;n=Math.abs(n);const d=Math.tan(n),u=Math.sin(n),g=Math.cos(n);if(h===mr.UP){let n=0;for(let o=0;o<c;o++){const a=t[o],{lineHeight:h=0}=a;n+=0===o?0:h;const c=(h/d+e)*u;i.push(n/d),c>s&&(s=c),0===o&&(r+=h*u,l+=h*g)}r+=n/u+e*g,l-=s}else{let n=0,l=-1;const h=[];for(let i=c-1;i>=0;i--){const o=t[i],{lineHeight:a=0}=o,_=a/d,p=(e+_)*u;h.unshift(a/d),p>s&&(s=p,n=_,l=i),r+=0===i?a*u:i===c-1?e*g+a/u:a/u}let _=t[l].lineHeight||0,p=0;for(let e=l+1;e<=c-1;e++){const n=t[e],{lineHeight:o=0}=n;_+=o,p+=h[e]||0,i[e]=-p}p=0;for(let e=l-1;e>=0;e--){const n=t[e],{lineHeight:s=0}=n;p+=h[e+1]||0,i[e]=p,o+=s}i[l]=0,1===c&&(r+=e*g),a=_/u-n*g}return{rotateTranslateXList:i,rotatedHeight:s,rotatedWidth:r,fixOffsetX:a,fixOffsetY:l,rotateTranslateY:o}}const pa=[new aa(0,0),new aa(1,1)];class ma{constructor(t=pa){this._lines=t}intersection(t){if(this._lines.length<1||t.length<1)return;const e=[];for(let n=1;n<this._lines.length;n++){const i=this._lines[n-1],o=this._lines[n];for(let s=1;s<t.length;s++){const t=this._lines[n-1],s=this._lines[n],r=this._intersection({from:i,to:o},{from:t,to:s});r&&e.push(r)}}return e}_intersection(t,e){const n=t.from,i=t.to,o=e.from,s=e.to;let r=(n.x-o.x)*(i.y-o.y)-(n.y-o.y)*(i.x-o.x),a=(n.x-s.x)*(i.y-s.y)-(n.y-s.y)*(i.x-s.x);if(r*a>=0)return!1;let l=(o.x-n.x)*(s.y-n.y)-(o.y-n.y)*(s.x-n.x);if(l*(l+r-a)>=0)return!1;let h=l/(a-r),c=h*(i.x-n.x),d=h*(i.y-n.y);return new aa(n.x+c,n.y+d)}}function Ta(t,e,n,i,o,s){if(!s)return[];const r=s.getPluginManager().getPluginByName("documentCustomBlock");return r?r.dealWidthCustomBlock(t,e,n,i,o):[]}const fa=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class va{constructor(t){this.isInGroup=!1,this.onTransformChangeObservable=new O,this.onPointerDownObserver=new O,this.onPointerMoveObserver=new O,this.onPointerUpObserver=new O,this.onDblclickObserver=new O,this.onMouseWheelObserver=new O,this.onPointerOutObserver=new O,this.onPointerLeaveObserver=new O,this.onPointerOverObserver=new O,this.onPointerEnterObserver=new O,this.onIsAddedToParentObserver=new O,this.onDisposeObserver=new O,this._dirty=!0,this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new ha,this._cursor=cr.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this._oKey=t||((t="obj",e=4)=>{let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),i="";for(let o=0;o<e;o++)i+=n[Math.round(Math.random()*(n.length-1))];return`${t}_${i}_${(new Date).getTime()}`})()}get transform(){return this._transform}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return fr.BASE_OBJECT}get top(){return this._top}get left(){return this._left}get width(){return this._width}get height(){return this._height}get strokeWidth(){return this._strokeWidth}get angle(){return this._angle}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){var t;let e=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=(null==(t=this.getParent())?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}get skewY(){return this._skewY}get flipX(){return this._flipX}get flipY(){return this._flipY}get parent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}get evented(){return this._evented}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}get isTransformer(){return this._isTransformer}get cursor(){return this._cursor}set transform(t){this._transform=t}set zIndex(t){this._zIndex=t}set parent(t){this._parent=t}set evented(t){this._evented=t}set debounceParentDirty(t){this._debounceParentDirty=t}set isTransformer(t){this._isTransformer=t}set cursor(t){this.setCursor(t)}set top(t){var e;this._topOrigin=t,this._top=Yr(t,null==(e=this._parent)?void 0:e.height)}set left(t){var e;this._leftOrigin=t,this._left=Yr(t,null==(e=this._parent)?void 0:e.width)}set width(t){var e;this._widthOrigin=t,this._width=Yr(t,null==(e=this._parent)?void 0:e.width)}set height(t){var e;this._heightOrigin=t,this._height=Yr(t,null==(e=this._parent)?void 0:e.height)}set strokeWidth(t){this._strokeWidth=t}set angle(t){this._angle=t}set scaleX(t){this._scaleX=t}set scaleY(t){this._scaleY=t}set skewX(t){this._skewX=t}set flipY(t){this._flipY=t}set flipX(t){this._flipX=t}set skewY(t){this._skewY=t}makeDirty(t=!0){return this._dirty=t,t&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout((()=>{var e;null==(e=this.parent)||e.makeDirty(t)}),0)),this}makeDirtyNoDebounce(t=!0){var e;return this._dirty=t,t&&(null==(e=this.parent)||e.makeDirty(t)),this}isDirty(){return this._dirty}translate(t,e){const n=this.top;void 0!==e&&(this.top=e);const i=this.left;return void 0!==t&&(this.left=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:i}}),this}resize(t,e){const n=this.width;void 0!==t&&(this.width=t);const i=this.height;return void 0!==e&&(this.height=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:i}}),this}scale(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX=t);const i=this.scaleY;return void 0!==e&&(this.scaleY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:i}}),this}skew(t,e){const n=t;void 0!==t&&(this.skewX=t);const i=e;return void 0!==e&&(this.skewY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:i}}),this}flip(t,e){const n=t;void 0!==t&&(this.flipX=t);const i=e;return void 0!==e&&(this.flipY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:i}}),this}transformByState(t){const e=Object.keys(t),n={};if(0!==e.length)return e.forEach((e=>{void 0!==t[e]&&(n[e]=this[e],this[e]=t[e])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.all,value:t,preValue:n}),this}isRender(t){return!this._forceRender&&(t&&!this.isInGroup)}getParent(){return this._parent}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(t,e){}isHit(t){const e=this._getInverseCoord(t);return e.x>=-this.strokeWidth/2&&e.x<=this.width+this.strokeWidth/2&&e.y>=-this.strokeWidth/2&&e.y<=this.height+this.strokeWidth/2}on(t,e){return this[`on${t}Observer`].add(e.bind(this))}off(t,e){this[`on${t}Observer`].remove(e)}clear(t){this[`on${t}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(t){var e,n;return!!(null==(e=this.onPointerMoveObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerMove(t),!1)}triggerPointerDown(t){var e,n;return!!(null==(e=this.onPointerDownObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerDown(t),!1)}triggerPointerUp(t){var e,n;return!!(null==(e=this.onPointerUpObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerUp(t),!1)}triggerDblclick(t){var e,n;return!!(null==(e=this.onDblclickObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerDblclick(t),!1)}triggerMouseWheel(t){var e,n;return!!(null==(e=this.onMouseWheelObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerMouseWheel(t),!1)}triggerPointerOut(t){var e,n;return!!(null==(e=this.onPointerOutObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerOut(t),!1)}triggerPointerLeave(t){var e,n;return!!(null==(e=this.onPointerLeaveObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerLeave(t),!1)}triggerPointerOver(t){var e;return!!this.onPointerOverObserver.notifyObservers(t)||(null==(e=this._parent)||e.triggerPointerOver(t),!1)}triggerPointerEnter(t){var e,n;return!!(null==(e=this.onPointerEnterObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerEnter(t),!1)}dispose(){var t;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),null==(t=this.parent)||t.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const t={};return fa.forEach((e=>{this[e]&&(t[e]=this[e])})),t}getScene(){let t=this.parent;if(null!=t){if(t.classType===fr.SCENE)return t;for(;t;){if(t.classType===fr.SCENE)return t;t=t.getParent()}}}resetCursor(){this.setCursor(cr.DEFAULT)}setCursor(t){var e;this._cursor=t,null==(e=this.getScene())||e.setCursor(t)}getEngine(){let t=this.getParent();for(;null!=t;){if(t===fr.ENGINE)return t;t=t.getParent()}return null}_getInverseCoord(t){return this._transform.clone().invert().applyPoint(t)}_setTransForm(){const t=ha.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=t,this._makeDirtyMix()}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}}function Ea(t){const e=t.getScene(),n=t.getViewportByCoord(e);if(!n)return{scrollX:0,scrollY:0};const i=n.getActualScroll(n.scrollX,n.scrollY);return{scrollX:i.x,scrollY:i.y}}function Ia(t,e){const n=t.transform.clone().invert().applyPoint(e.tl),i=t.transform.clone().invert().applyPoint(e.tr),o=t.transform.clone().invert().applyPoint(e.bl),s=t.transform.clone().invert().applyPoint(e.br),r=[n.x,i.x,o.x,s.x],a=[n.y,i.y,o.y,s.y],l=Math.max(...r),h=Math.min(...r),c=Math.max(...a);return{minX:h,maxX:l,minY:Math.min(...a),maxY:c}}function ba(){let t=1,e=jr().getContext("2d");return t=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),t<1?1:Math.ceil(10*t)/10}class Aa{constructor(t){this.isCache=!1,this._pixelRatio=1,this._width=0,this._height=0,t=t||{},this._canvasEle=jr(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(t.width,t.height,t.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(t,e,n){this._pixelRatio=n||ba(),t&&(this._width=t,this._canvasEle.width=t*this._pixelRatio,this._canvasEle.style.width=`${t}px`),e&&(this._height=e,this._canvasEle.height=e*this._pixelRatio,this._canvasEle.style.height=`${e}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(t){0!==this._width&&0!==this._height&&(t<1&&(t=1),this.setSize(this._width,this._height,t))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(t,e){try{return this._canvasEle.toDataURL(t,e)}catch(n){try{return this._canvasEle.toDataURL()}catch(i){const{message:t}=i;return console.error(`Unable to get data URL. ${t} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class Ca{constructor(t=100,e=100){this.onInputChangedObservable=new O,this.renderEvenInBackground=!0,this.onBeginFrameObservable=new O,this.onEndFrameObservable=new O,this.onTransformChangeObservable=new O,this._canvas=new Aa,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this._usingSafari="safari"===U.getBrowserType(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new Ur,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=-1!==navigator.userAgent.indexOf("Firefox"),this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(t,e),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return fr.ENGINE}get activeScene(){return this._activeScene}get requestNewFrameHandler(){return this._requestNewFrameHandler}get frameId(){return this._frameId}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(t){return this._scenes[t]}hasScene(t){return t in this._scenes}addScene(t){const e=t.sceneKey;return this.hasScene(e)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[e]=t,t}setActiveScene(t){const e=this.getScene(t);return e&&(this._activeScene=e),e}hasActiveScene(){return null!=this._activeScene}setContainer(t){this._container=t,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:t,height:e}=function(t){const e=getComputedStyle(t),{borderTopWidth:n,borderLeftWidth:i,borderRightWidth:o,borderBottomWidth:s,width:r,height:a}=e;return{top:ra(n),left:ra(i),right:ra(o),bottom:ra(s),width:ra(r),height:ra(a)}}(this._container);this.resizeBySize(t,e)}resizeBySize(t,e){const n=this.width,i=this.height;this._canvas.setSize(t,e),this.onTransformChangeObservable.notifyObservers({type:Br.resize,value:{width:t,height:e},preValue:{width:n,height:i}})}dispose(){const t=this.getScenes();Object.keys(t).forEach((e=>{t[e].dispose()}));const e=$r();this._canvasEle.removeEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(t){const e=this.getScenes();if(e[t]){const n=e[t];return delete e[t],n}}runRenderLoop(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Xr(this._renderFunction)))}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_renderFrame(){for(let t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}}_renderLoop(){let t=!0;this.renderEvenInBackground||(t=!1),t&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Xr(this._renderFunction):this._renderingQueueLaunched=!1}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_handleKeyboardAction(){this._canvasEle.addEventListener("keydown",(t=>{let e=t;e.deviceType=xr.Keyboard,e.inputIndex=t.keyCode,e.previousState=0,e.currentState=1,this.onInputChangedObservable.notifyObservers(e)})),this._canvasEle.addEventListener("keyup",(t=>{let e=t;e.deviceType=xr.Keyboard,e.inputIndex=t.keyCode,e.previousState=1,e.currentState=0,this.onInputChangedObservable.notifyObservers(e)}))}_handlePointerAction(){const t=$r();this._pointerMoveEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[Hr.Horizontal],i=this.__pointer[Hr.Vertical],o=this.__pointer[Hr.DeltaHorizontal],s=this.__pointer[Hr.DeltaVertical];this.__pointer[Hr.Horizontal]=t.clientX,this.__pointer[Hr.Vertical]=t.clientY,this.__pointer[Hr.DeltaHorizontal]=t.movementX,this.__pointer[Hr.DeltaVertical]=t.movementY;let r=t;r.deviceType=e,n!==t.clientX&&(r.inputIndex=Hr.Horizontal,r.previousState=n,r.currentState=this.__pointer[Hr.Horizontal],this.onInputChangedObservable.notifyObservers(r)),i!==t.clientY&&(r.inputIndex=Hr.Vertical,r.previousState=i,r.currentState=this.__pointer[Hr.Vertical],this.onInputChangedObservable.notifyObservers(r)),0!==this.__pointer[Hr.DeltaHorizontal]&&(r.inputIndex=Hr.DeltaHorizontal,r.previousState=o,r.currentState=this.__pointer[Hr.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(r)),0!==this.__pointer[Hr.DeltaVertical]&&(r.inputIndex=Hr.DeltaVertical,r.previousState=s,r.currentState=this.__pointer[Hr.DeltaVertical],this.onInputChangedObservable.notifyObservers(r)),this._usingSafari||-1===t.button||(r.inputIndex=t.button+2,r.previousState=this.__pointer[t.button+2],this.__pointer[t.button+2]=this.__pointer[t.button+2]?0:1,r.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(r))},this._pointerDownEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[Hr.Horizontal],i=this.__pointer[Hr.Vertical],o=this.__pointer[t.button+2];e===xr.Mouse?(-1===this.__mouseId&&(void 0===t.pointerId?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=t.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):t.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(t.pointerId),this.__pointer[Hr.Horizontal]=t.clientX,this.__pointer[Hr.Vertical]=t.clientY,this.__pointer[t.button+2]=1;let s=t;s.deviceType=e,n!==t.clientX&&(s.inputIndex=Hr.Horizontal,s.previousState=n,s.currentState=this.__pointer[Hr.Horizontal],this.onInputChangedObservable.notifyObservers(s)),i!==t.clientY&&(s.inputIndex=Hr.Vertical,s.previousState=i,s.currentState=this.__pointer[Hr.Vertical],this.onInputChangedObservable.notifyObservers(s)),s.inputIndex=t.button+2,s.previousState=o,s.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(s)},this._pointerUpEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[Hr.Horizontal],i=this.__pointer[Hr.Vertical],o=this.__pointer[t.button+2];this.__pointer[Hr.Horizontal]=t.clientX,this.__pointer[Hr.Vertical]=t.clientY,this.__pointer[t.button+2]=0;let s=t;s.deviceType=e,n!==t.clientX&&(s.inputIndex=Hr.Horizontal,s.previousState=n,s.currentState=this.__pointer[Hr.Horizontal],this.onInputChangedObservable.notifyObservers(s)),i!==t.clientY&&(s.inputIndex=Hr.Vertical,s.previousState=i,s.currentState=this.__pointer[Hr.Vertical],this.onInputChangedObservable.notifyObservers(s)),s.inputIndex=t.button+2,s.previousState=o,s.currentState=this.__pointer[t.button+2],e===xr.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):t.pointerId&&this._canvasEle.hasPointerCapture(t.pointerId)&&this._canvasEle.releasePointerCapture(t.pointerId),this.onInputChangedObservable.notifyObservers(s),e!==xr.Mouse&&(this.__pointer={})},this._pointerBlurEvent=t=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=t=>{const e=xr.Mouse;let n=this.__pointer[Hr.MouseWheelX],i=this.__pointer[Hr.MouseWheelY],o=this.__pointer[Hr.MouseWheelZ];this.__pointer[Hr.MouseWheelX]=t.deltaX||0,this.__pointer[Hr.MouseWheelY]=t.deltaY||t.wheelDelta||0,this.__pointer[Hr.MouseWheelZ]=t.deltaZ||0;let s=t;s.deviceType=e,0!==this.__pointer[Hr.MouseWheelX]&&(s.inputIndex=Hr.MouseWheelX,s.previousState=n,s.currentState=this.__pointer[Hr.MouseWheelX],this.onInputChangedObservable.notifyObservers(s)),0!==this.__pointer[Hr.MouseWheelY]&&(s.inputIndex=Hr.MouseWheelY,s.previousState=i,s.currentState=this.__pointer[Hr.MouseWheelY],this.onInputChangedObservable.notifyObservers(s)),0!==this.__pointer[Hr.MouseWheelZ]&&(s.inputIndex=Hr.MouseWheelZ,s.previousState=o,s.currentState=this.__pointer[Hr.MouseWheelZ],this.onInputChangedObservable.notifyObservers(s))},this._canvasEle.addEventListener(`${t}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${t}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${t}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,!!this._getPassive()&&{passive:!1})}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}_getPassive(){let t=!1;const e=()=>{};try{const n={passive:{get(){t=!0}}};this._canvasEle.addEventListener("test",e,n),this._canvasEle.removeEventListener("test",e,n)}catch(n){}return t}__getPointerType(t){let e=xr.Mouse;return("touch"===t.pointerType||"pen"===t.pointerType||t.touches)&&(e=xr.Touch),e}}class Sa{constructor(t,e=[],n=1){this._scene=t,this._zIndex=n,this._objects=[],this.addObjects(e)}get scene(){return this._scene}get zIndex(){return this._zIndex}static create(t,e=[],n=1e3){return new this(t,e,n)}getObjectsByOrder(){const t=[];this._objects.sort(ri);for(let e of this._objects)!e.isInGroup&&e.visible&&t.push(e);return t}getObjectsByOrderForPick(){const t=[];this._objects.sort(ri);for(let e of this._objects)e.classType!==fr.GROUP&&e.visible&&t.push(e);return t}getObjects(){return this._objects}addObject(t){if(t.classType===fr.GROUP){const e=t.getObjects();for(let t of e)this.scene.getObject(t.oKey)||(this._objects.push(t),this.scene.setObjectBehavior(t))}return this._objects.push(t),this.scene.setObjectBehavior(t),this.scene.applyTransformer(t),this}removeObject(t){const e=this.getObjects(),n=e.length;if(t instanceof va)for(let i=0;i<n;i++){if(e[i]===t)return void e.splice(i,1)}else for(let i=0;i<n;i++){if(e[i].oKey===t)return void e.splice(i,1)}}addObjects(t){return t.forEach((t=>{this.addObject(t)})),this}removeObjects(t){const e=this.getObjects();for(let n=e.length-1;n>=0;n--){let i=e[n];const o=t.length;if(0===o)break;for(let s=0;s<o;s++){const o=t[s];if(i=o instanceof va?i:i.oKey,i===o){e.splice(n,1);break}}}}clear(){this._objects=[]}dispose(){this.getObjects().forEach((t=>{t.dispose()})),this.clear()}}const Na=class{constructor(t){this._alreadyAttached=!1,this._startingPosition=new aa(1/0,1/0),this._doubleClickOccurred=0,this._scene=t}mouseLeaveEnterHandler(t,e){var n;if(null==t)null==(n=this._currentMouseEnterPicked)||n.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(t!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=t,null==n||n.triggerPointerLeave(e),null==t||t.triggerPointerEnter(e)}}attachControl(t=!0,e=!0,n=!0,i=!0){const o=this._scene.getEngine();o&&(this._onPointerMove=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerMove(t);this.mouseLeaveEnterHandler(e,t),this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(t)},this._onPointerDown=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerDown(t);this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(t)},this._onPointerUp=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerUp(t);this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(t),this._prePointerDoubleClick(t)},this._onMouseWheel=t=>{const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerMouseWheel(t);this._scene.getViewports().forEach((e=>{e.onMouseWheelObserver.hasObservers()&&e.onMouseWheelObserver.notifyObservers(t)})),this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(t)},this._onKeyDown=t=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(t)},this._onKeyUp=t=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(t)},this._onInputObserver=o.onInputChangedObservable.add((o=>{const s=o;o.deviceType===xr.Keyboard&&(1===o.currentState&&this._onKeyDown(s),0===o.currentState&&this._onKeyUp(s)),o.deviceType!==xr.Mouse&&o.deviceType!==xr.Touch||(t&&o.inputIndex>=Hr.LeftClick&&o.inputIndex<=Hr.RightClick&&1===o.currentState&&this._onPointerDown(s),e&&o.inputIndex>=Hr.LeftClick&&o.inputIndex<=Hr.RightClick&&0===o.currentState&&this._onPointerUp(s),!n||o.inputIndex!==Hr.Horizontal&&o.inputIndex!==Hr.Vertical&&o.inputIndex!==Hr.DeltaHorizontal&&o.inputIndex!==Hr.DeltaVertical?!i||o.inputIndex!==Hr.MouseWheelX&&o.inputIndex!==Hr.MouseWheelY&&o.inputIndex!==Hr.MouseWheelZ||this._onMouseWheel(s):this._onPointerMove(s))})),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const t=this._scene.getEngine();t&&(t.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_getCurrentObject(t,e){var n;return null==(n=this._scene)?void 0:n.pick(aa.FromArray([t,e]))}_checkDirectSceneEventTrigger(t,e){let n=!1;null==e&&(n=!0);let i=!0;if(e&&e.classType===fr.BASE_OBJECT){const t=e.getScene();if(t){i=t.getParent().classType!==fr.SCENE_VIEWER}}return!this._scene.evented&&t&&i||n}_isPointerSwiping(t,e){return Math.abs(this._startingPosition.x-t)>Na.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>Na.DragMovementThreshold}_prePointerDoubleClick(t){var e,n;const{clientX:i,clientY:o}=t;if(0===this._doubleClickOccurred&&(this._startingPosition.x=i,this._startingPosition.y=o),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout((()=>{this._resetDoubleClickParam()}),Na.DoubleClickDelay),this._doubleClickOccurred<2)return;this._isPointerSwiping(i,o)?this._resetDoubleClickParam():(null==(n=null==(e=this._scene)?void 0:e.pick(aa.FromArray([t.offsetX,t.offsetY])))||n.triggerDblclick(t),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(t),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",t))}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let Ra=Na;Ra.DragMovementThreshold=10,Ra.LongPressDelay=500,Ra.DoubleClickDelay=300,Ra.ExclusiveDoubleClickMode=!1;class wa extends va{constructor(t,...e){super(t),this._objects=[],this.addObjects(...e)}get classType(){return fr.GROUP}set cursor(t){this.setCursor(t)}addObjects(...t){for(const e of t)this.addObject(e)}addObject(t){let e=t;if(qr(t)){const n=this.getScene();if(e=null==n?void 0:n.getObject(t),!e)return void console.info("No object be added");e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}else t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}removeObject(t){const e=this.getObjects(),n=e.length;if(qr(t))for(let i=0;i<n;i++){const n=e[i];if(n.oKey===t)return e.splice(i,1),void this.parent.removeObject(n)}else for(let i=0;i<n;i++){const n=e[i];if(n===t)return e.splice(i,1),void this.parent.removeObject(n)}}getObjectsByOrder(){const t=[];this._objects.sort(ri);for(let e of this._objects)!e.isInGroup&&e.visible&&t.push(e);return t}getObjects(){return this._objects}render(t,e){t.save();const n=this.transform.getMatrix();t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(ri);for(let i of this._objects)i.render(t,this._transformBounds(e));t.restore()}resize(t,e){return this}scale(t,e){return this}skew(t,e){return this}flip(t,e){return this}isHit(t){return!0}pick(t){}dispose(){this.getObjects().forEach((t=>{t.dispose()})),super.dispose()}_transformBounds(t){return t}}class Oa{constructor(t,e,n=.05,i=.05){this._scene=t,this._padding=e,this._smoothRatioX=n,this._smoothRatioY=i,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:60})}static create(t,e){return new Oa(t,e)}startScroll(t,e){this._offsetX=t,this._offsetY=e,this._moveX=t,this._moveY=e,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(t){const e=(null==t?void 0:t.top)||0,n=e+((null==t?void 0:t.height)||0),i=(null==t?void 0:t.left)||0,o=i+((null==t?void 0:t.width)||0),{t:s=0,b:r=0,r:a=0,l:l=0}=this._padding;let h=0,c=0;this._moveX<i+l&&(h=(this._moveX-i-l)*this._smoothRatioX),this._moveX>o-a&&(h=(this._moveX-o+a)*this._smoothRatioX),this._moveY<e+s&&(c=(this._moveY-e-s)*this._smoothRatioY),this._moveY>n-r&&(c=(this._moveY-n+r)*this._smoothRatioY);const d=null==t?void 0:t.scrollBy({x:h,y:c}),u=null==t?void 0:t.getActualScroll(h,c);if(this._scrollX=(null==u?void 0:u.x)||0,this._scrollY=(null==u?void 0:u.y)||0,d){const e=this._findAncestorScene(null==t?void 0:t.scene),n=this.getViewportByCoord(e);n&&this._scroll(n)}}scrolling(t,e,n){this._moveX=t,this._moveY=e,this._scrollFunction=n}stopScroll(){var t,e;t=this._requestNewFrameNumber,e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(t):e.requestAnimationFrame?e.cancelAnimationFrame(t):e.msRequestAnimationFrame?e.msCancelAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(t):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(t):e.oRequestAnimationFrame?e.oCancelAnimationFrame(t):window.clearTimeout(t)}getViewportByCoord(t){return null==t?void 0:t.getActiveViewportByRelativeCoord(aa.FromArray([this._offsetX,this._offsetY]))}getScene(){return this._scene}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=Xr(this._runRenderLoop.bind(this))}_findAncestorScene(t){let e=null==t?void 0:t.getParent();for(;e;){if(e.classType===fr.SCENE)return e;e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent())}}}const ya=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class Ma extends va{constructor(t,e){super(t),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new Aa,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._initialProps(e)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}static drawWith(t,e){}static _renderPaintInOrder(t,e){"stroke"===e.paintFirst?(this._renderStroke(t,e),this._renderFill(t,e)):(this._renderFill(t,e),this._renderStroke(t,e))}static _renderFill(t,e){e.fill&&(t.save(),this.__setFillStyles(t,e),"evenodd"===e.fillRule?t.fill("evenodd"):t.fill(),t.restore())}static _renderStroke(t,e){let{stroke:n,strokeWidth:i,shadowEnabled:o,shadowForStrokeEnabled:s,strokeScaleEnabled:r,scaleX:a,scaleY:l,parent:h}=e;if(n&&0!==i){if(o&&!s&&this.__removeShadow(t),t.save(),r&&h){let e=this.__getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else r&&(a=null!=a?a:1,l=null!=l?l:1,t.scale(1/a,1/l));this.__setLineDash(t),this.__setStrokeStyles(t,e),t.stroke(),t.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(t){}static __setFillStyles(t,e){t.fillStyle=e.fill}static __setStrokeStyles(t,e){const{strokeWidth:n,strokeLineCap:i,strokeDashOffset:o,strokeLineJoin:s,strokeMiterLimit:r,stroke:a}=e;t.lineWidth=n,t.lineCap=i,t.lineDashOffset=o,t.lineJoin=s,t.miterLimit=r,t.strokeStyle=a}static __setLineDash(t){}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:t,maxX:n,minY:i,maxY:o}=Ia(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<i||o<0)return this}const n=this.transform.getMatrix();if(t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const t=this._cacheCanvas.getContext();this._cacheCanvas.clear(),t.save(),t.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(t),t.restore()}this._applyCache(t)}else this._draw(t);return t.restore(),this.makeDirty(!1),this}setProps(t){if(!t)return;const e=Object.keys(t);return 0!==e.length?(e.forEach((e=>{if(void 0===t[e])return!0;-1===fa.indexOf(e)&&(this[`_${e}`]=t[e])})),this.makeDirty(!0),this):void 0}resizeCacheCanvas(){var t;null==(t=this._cacheCanvas)||t.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var t,e,n;let i=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1,o=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1;null==(n=this._cacheCanvas)||n.setPixelRatio(Math.max(i,o)*ba()),this.makeDirty(!0)}toJson(){const t={};return ya.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}_applyCache(t){if(!t||!this._cacheCanvas)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,i=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,i,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}_draw(t){}_initialProps(t){if(!t)return;const e=Object.keys(t);if(0===e.length)return;const n={};let i=!1;e.forEach((e=>{if(void 0===t[e])return!0;fa.indexOf(e)>-1?(n[e]=t[e],i=!0):this[`_${e}`]=t[e]})),i&&this.transformByState(n),this.makeDirty(!0)}}const Da=["radius"];class La extends Ma{constructor(t,e){super(t,e),(null==e?void 0:e.radius)&&(this._radius=null==e?void 0:e.radius)}get radius(){return this._radius}static drawWith(t,e){let{radius:n,width:i,height:o}=e;if(n=null!=n?n:0,i=null!=i?i:30,o=null!=o?o:30,t.beginPath(),e.strokeDashArray&&t.setLineDash(e.strokeDashArray),n){let e=0,s=0,r=0,a=0;e=s=r=a=Math.min(n,i/2,o/2),t.moveTo(e,0),t.lineTo(i-s,0),t.arc(i-s,s,s,3*Math.PI/2,0,!1),t.lineTo(i,o-a),t.arc(i-a,o-a,a,0,Math.PI/2,!1),t.lineTo(r,o),t.arc(r,o-r,r,Math.PI/2,Math.PI,!1),t.lineTo(0,e),t.arc(e,e,e,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,i,o);t.closePath(),this._renderPaintInOrder(t,e)}toJson(){const t={};return Da.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}_draw(t){La.drawWith(t,this)}}const xa=["pointsGroup"];class ka extends Ma{constructor(t,e){super(t,e),this._pointsGroup=(null==e?void 0:e.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:i}=t;e!==Br.resize&&e!==Br.all||this.resizePolygon(i)}))}get pointsGroup(){return this._pointsGroup}static drawWith(t,e){let{pointsGroup:n}=e;n=null!=n?n:[[]],e.strokeDashArray&&t.setLineDash(e.strokeDashArray),t.beginPath();for(let i of n){t.moveTo(i[0].x,i[0].y);for(let e=1;e<i.length;e++){const n=i[e];t.lineTo(n.x,n.y)}}t.closePath(),this._renderPaintInOrder(t,e)}updatePointGroup(t){this._pointsGroup=t,this._setFixBoundingBox()}resizePolygon(t){const{left:e,top:n,width:i,height:o}=this._getSelfRect(),{width:s,height:r}=t;let a,l;a=s?this.width-s:0,l=r?this.height-r:0;const h=a/i,c=l/o;this.scaleX+=h,this.scaleY+=c,this.left=this.left-e*h,this.top=this.top-n*c,this._setTransForm()}toJson(){const t={};return xa.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}getState(){const{left:t,top:e,width:n,height:i}=this.getRect();return{left:t,top:e,width:n,height:i,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:t,top:e,width:n,height:i}=this._getSelfRect();return{left:t*this.scaleX+this.left,top:e*this.scaleY+this.top,width:n*this.scaleX,height:i*this.scaleY}}_draw(t){ka.drawWith(t,this)}_setFixBoundingBox(){const{width:t,height:e,left:n,top:i}=this._getSelfRect();this.left=this.left+n,this.top=this.top+i,this.width=t,this.height=e;const o=this.pointsGroup;for(let s of o)for(let t of s)t.x-=n,t.y-=i;this._setTransForm()}_getSelfRect(){const t=this.pointsGroup;let e=t[0][0].x,n=t[0][0].x,i=t[0][0].y,o=t[0][0].y;for(let s of t)for(let t of s)e=Math.min(e,t.x),n=Math.max(n,t.x),i=Math.min(i,t.y),o=Math.max(o,t.y);return{left:e,top:i,width:n-e,height:o-i}}}class Ha{constructor(t,e){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=Vr(nr,.2),this._thumbHoverBackgroundColor=Vr(nr,.35),this._thumbActiveBackgroundColor=Vr(nr,.4),this._barSize=14,this._barBackgroundColor=Vr(ir),this._barBorder=1,this._barBorderColor=Vr([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,t||console.warn("Missing viewport"),this._view=t,this.setProps(e),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}get ratioScrollX(){return void 0===this._horizontalThumbWidth||void 0===this._horizontalBarWidth?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return void 0===this._verticalThumbHeight||void 0===this._verticalBarHeight?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}static attachTo(t,e){return new Ha(t,e)}setProps(t){if(!t)return;const e=Object.keys(t);0!==e.length&&e.forEach((e=>{void 0!==t[e]&&(this[`_${e}`]=t[e])}))}render(t,e=0,n=0){let{scrollX:i,scrollY:o}=this._view;t.save();const s=new ha([1,0,0,1,e,n]).getMatrix();t.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._horizonBarRect.render(t),this._horizonThumbRect.translate(i).render(t),this._verticalBarRect.render(t),this._verticalThumbRect.translate(void 0,o).render(t),this._placeholderBarRect.render(t),t.restore()}resize(t=0,e=0,n=0,i=0){var o,s,r,a,l,h,c,d,u,g,_;0===t&&0===t||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=t-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<17&&(this._horizontalMinusMiniThumb=17-this._horizontalThumbWidth,this._horizontalThumbWidth=17),null==(o=this._horizonBarRect)||o.transformByState({left:0,top:e-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=t?null==(s=this._horizonThumbRect)||s.setProps({visible:!1}):((null==(r=this._horizonThumbRect)?void 0:r.visible)||null==(a=this._horizonThumbRect)||a.setProps({visible:!0}),null==(l=this._horizonThumbRect)||l.transformByState({left:this._view.scrollX,top:e-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-2*this._thumbMargin}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=e-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/i*this._thumbLengthRatio,this._verticalThumbHeight<17&&(this._verticalMinusMiniThumb=17-this._verticalThumbHeight,this._verticalThumbHeight=17),null==(h=this._verticalBarRect)||h.transformByState({left:t-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=e?null==(c=this._verticalThumbRect)||c.setProps({visible:!1}):((null==(d=this._verticalThumbRect)?void 0:d.visible)||null==(u=this._verticalThumbRect)||u.setProps({visible:!0}),null==(g=this._verticalThumbRect)||g.transformByState({left:t-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-2*this._thumbMargin,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&(null==(_=this._placeholderBarRect)||_.transformByState({left:t-this._barSize,top:e-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}makeDirty(t){var e,n,i,o,s;null==(e=this._horizonBarRect)||e.makeDirty(t),null==(n=this._horizonThumbRect)||n.makeDirty(t),null==(i=this._verticalBarRect)||i.makeDirty(t),null==(o=this._verticalThumbRect)||o.makeDirty(t),null==(s=this._placeholderBarRect)||s.makeDirty(t),this.makeViewDirty(t)}makeViewDirty(t){this._view.makeDirty(t);const e=this._view.scene.getParent();e.classType===fr.SCENE_VIEWER&&e.makeDirty(!0)}pick(t){var e,n,i,o;return(null==(e=this._horizonThumbRect)?void 0:e.isHit(t))?this._horizonThumbRect:(null==(n=this._verticalThumbRect)?void 0:n.isHit(t))?this._verticalThumbRect:(null==(i=this._horizonBarRect)?void 0:i.isHit(t))?this._horizonBarRect:(null==(o=this._verticalBarRect)?void 0:o.isHit(t))?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new La("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new La("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new La("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new La("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new La("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const t=this._mainScene||this._view.scene,e=(t,e)=>(n,i)=>{if(this._isHorizonMove||this._isVerticalMove)return;e.setProps({fill:t}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(sr.PointerEnter,e(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(sr.PointerLeave,e(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(sr.PointerDown,((t,e)=>{const n=t;this._view.scrollTo({x:n.offsetX-this._view.left-this._horizontalThumbWidth/2}),e.stopPropagation()})),this._horizonThumbRect.on(sr.PointerDown,((e,n)=>{const i=e;this._isHorizonMove=!0,this._lastX=i.offsetX,this._lastY=i.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),t.disableEvent(),n.stopPropagation()})),t.on(sr.PointerMove,((t,e)=>{const n=t;this._isHorizonMove&&(this._view.scrollBy({x:n.offsetX-this._lastX}),this._lastX=n.offsetX)})),t.on(sr.PointerUp,((e,n)=>{const i=this._horizonThumbRect;this._isHorizonMove=!1,t.enableEvent(),i.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))),this._enableVertical&&(this._verticalThumbRect.on(sr.PointerEnter,e(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(sr.PointerLeave,e(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(sr.PointerDown,((t,e)=>{const n=t;this._view.scrollTo({y:n.offsetY-this._view.top-this._verticalThumbHeight/2}),e.stopPropagation()})),this._verticalThumbRect.on(sr.PointerDown,((e,n)=>{const i=e,o=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=i.offsetX,this._lastY=i.offsetY,o.setProps({fill:this._thumbActiveBackgroundColor}),t.disableEvent(),this.makeViewDirty(!0),n.stopPropagation()})),t.on(sr.PointerMove,((t,e)=>{const n=t;this._isVerticalMove&&(this._view.scrollBy({y:n.offsetY-this._lastY}),this._lastY=n.offsetY)})),t.on(sr.PointerUp,((e,n)=>{const i=this._verticalThumbRect;this._isVerticalMove=!1,t.enableEvent(),i.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})))}}class Pa extends Ma{constructor(t,e){super(t,e),this._props=h({autoWidth:!1,autoHeight:!1},e),e.image?(this._native=e.image,this._init()):e.url&&(this._native=document.createElement("img"),this._native.src=e.url,this._native.onload=()=>{var t;null==(t=e.success)||t.call(e),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{e.fail?e.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(t,e){var n;if(null==(n=e._native)?void 0:n.complete){const{width:n,height:o}=e;try{t.drawImage(e._native,0,0,n,o)}catch(i){console.error(i)}}}static create(t,e,n){return new Pa(t,{url:e,success:n})}_draw(t){Pa.drawWith(t,this)}_init(){this._props.autoWidth&&this.resize(this._native.width),this._props.autoHeight&&this.resize(void 0,this._native.height)}}function Ba(t){return null==t?void 0:t[t.length-1]}function Fa(t){var e;return null==(e=null==t?void 0:t.sections)?void 0:e[t.sections.length-1]}function Ua(t){const e=Fa(t);for(let n=0;n<e.columns.length;n++){const t=e.columns[n];if(!t.isFull)return{column:t,isLast:n===e.columns.length-1,index:n}}}function za(t){const e=function(t){var e;const n=null==(e=Ua(t))?void 0:e.column.lines;return null==n?void 0:n[n.length-1]}(t);if(e)for(let n=0;n<e.divides.length;n++){const t=e.divides[n];if(!t.isFull)return{divide:t,isLast:n===e.divides.length-1,index:n}}}function Wa(t){const e=t.lines;if(e.length>1)return!1;return function(t){if(!t)return!0;for(let e=0;e<t.divides.length;e++){const n=t.divides[e].spanGroup.length;if(n>1)return!1;if(1===n){const n=t.divides[e].spanGroup[0],{spanType:i}=n;if(i!==wr.TAB&&i!==wr.LIST)return!1}}return!0}(e[e.length-1])}function Ga(t,e){if(t instanceof Object){const{v:n,u:i}=t;return i===Rt.POINT?n:n*e}return t}function Va(t=0,e,n=$.LINES,i=Fe.TRUE){let o=1;return Ya(n,i)&&(o=t),o*=e,o}function Ya(t=$.LINES,e=Fe.FALSE){return e===Fe.TRUE&&(t===$.LINES_AND_CHARS||t===$.SNAP_TO_CHARS)}function Xa(t,e){const{paragraphStyle:n={}}=e,{linePitch:i=15.6,gridType:o=$.LINES,paragraphLineGapDefault:s=0}=t,{lineSpacing:r=1,spacingRule:a=dt.AUTO,snapToGrid:l=Fe.TRUE}=n;return{paragraphLineGapDefault:s,linePitch:i,gridType:o,lineSpacing:r,spacingRule:a,snapToGrid:l}}function ja(t,e=-1){t[0];let n=e;for(let i of t){const{sections:t}=i;let e=n,o=e,s=-1/0,r=0;for(let n of t){const{columns:t}=n;let e=o,i=e,a=-1/0;for(let n of t){const{lines:t}=n;let e=i,o=e,r=0,l=-1/0,h=null;for(let n of t){const{divides:t,lineHeight:e}=n;let i=o,s=i,a=0,c=0;r+=e;const d=t.length;for(let n=0;n<d;n++){const e=t[n],{spanGroup:i}=e;if(0===i.length)continue;let o=s,r=o;for(let t of i){r+=t.spanType===wr.LIST?0:t.count||1;const i=t.bBox,{ba:o}=i;c=Math.max(c,o),n===d-1&&e.width===1/0&&(a+=t.width)}n===d-1&&(e.width===1/0?e.width=a:a+=e.width,a+=e.left),e.st=0===o?0:o+1,e.ed=r>=e.st?r:e.st,s=e.ed}n.st=0===i?0:i+1,n.ed=s>=n.st?s:n.st,n.width=a,n.asc=c,l=Math.max(l,a),n.top=((null==h?void 0:h.top)||0)+((null==h?void 0:h.lineHeight)||0),h=n,o=n.ed}n.st=0===e?0:e+1,n.ed=o>=n.st?o:n.st,n.height=r,n.width===1/0&&(n.width=l),s=Math.max(s,l),a=Math.max(a,n.height),i=n.ed}n.st=0===e?0:e+1,n.ed=i>=n.st?i:n.st,n.height=a,r+=a,o=n.ed}i.st=0===e?0:e+1,i.ed=o>=i.st?o:i.st,i.height=r,i.width=s,n=i.ed}}function Ka(t){const e=t.spanGroup;let n=0;for(let i of e)n+=i.width;return n}function $a(t=[],e=J.NONE,n=0,i=0,o=1/0,s=1/0){const r=[];let a=0,l=0;if(0===t.length)r.push(qa(i,o,0,J.NONE));else for(let c=0;c<t.length;c++){const{width:n,paddingEnd:s}=t[c];l=s,a=n,r.push(qa(i,a,l,e)),i+=a+l,c===t.length-1&&(a=o!==1/0?o-a:n,l=0,r.push(qa(i,a,l,e)))}const h={columns:r,colCount:(null==t?void 0:t.length)||1,height:s,top:n,st:0,ed:0};return r.forEach((t=>{t.parent=h})),h}function Za(t,e){t.isFull=e}function qa(t,e,n,i){return{lines:[],left:t,width:e,height:0,spaceWidth:n,separator:i,st:0,ed:0,drawingLRIds:[],isFull:!1}}function Qa(t,e,n,i){return n in G?function(t,e,n){if(n===G.DECIMAL)return Ja(t,e);if(n===G.ZERO_DECIMAL)return function(t,e){const n=t+e;if(n<10)return`0${n}`;return n.toString()}(t,e);if(n===G.UPPER_ALPHA)return function(t,e){return oi(t+e-1,!0)}(t,e);if(n===G.ALPHA)return function(t,e){return oi(t+e-1,!1)}(t,e);if(n===G.UPPER_ROMAN)return function(t,e){return tl(t+e,!0)}(t,e);if(n===G.ROMAN)return function(t,e){return tl(t+e,!1)}(t,e);return Ja(t,e)}(t,e,n):function(t,e,n,i){if(!i)return"";const o=i.getPluginManager().getPluginByName("documentCustomBullet");return o?o.dealWidthCustomBulletOrderedSymbol(t,e,n):""}(t,e,n,i)}function Ja(t,e){return(t+e).toString()}function tl(t,e=!1){let n={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1});let i="";for(let o in n)for(;t>=n[o];)i+=o,t-=n[o];return i}function el(t,e,n,i,o){var s,r;if(!t||!e)return;const{listId:a,nestingLevel:l=0,textStyle:c}=t,d=e[a];if(!d||!d.nestingLevel)return nl(a,null==(s=null==n?void 0:n[l])?void 0:s.startIndexItem,i);if(!d.nestingLevel[l])return nl(a,null==(r=null==n?void 0:n[l])?void 0:r.startIndexItem,i);return function(t,e,n,i,o,s,r){var a,l;const c=n[e],{bulletAlignment:d,glyphFormat:u,textStyle:g,startNumber:_,glyphType:p,glyphSymbol:m,indentFirstLine:T,hanging:f,indentStart:v}=c,E=h(h({},o),g),I=ta(E,s);let b;b=m||function(t,e,n,i,o){var s;const r=t.split("%"),a=[r[0]];for(let l=1;l<r.length;l++){const t=r[l],{level:h,suffix:c}=ol(t);let d=(null==(s=null==i?void 0:i[h])?void 0:s.startIndexItem)||1;h!==e&&null!==(null==i?void 0:i[h])&&(d-=1);const u=il(d,n[h],o);a.push(u,c)}return a.join("")}(u,e,n,i,r);const A=Ir.getTextSize(b,I),C=null!=(l=null==(a=null==i?void 0:i[e])?void 0:a.startIndexItem)?l:1;return{listId:t,symbol:b,ts:E,fontStyle:I,startIndexItem:C+1,bBox:A,nestingLevel:c,bulletAlign:d,bulletType:!m&&!!p,indentFirstLine:T,hanging:f,indentStart:v}}(a,l,d.nestingLevel,n,c,i,o)}function nl(t,e=1,n){return{listId:t,symbol:"●",ts:{ff:(null==n?void 0:n.fontList[0])||"Arial",fs:(null==n?void 0:n.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function il(t=1,e,n){const{startNumber:i,glyphType:o,glyphSymbol:s}=e;return s||(o?Qa(t,i,o,n):"●")}function ol(t){if(""===t)return{level:0,suffix:""};const e=t.split("");let n="",i="",o=!1;const s=/[0-9]/g;return e.forEach((t=>{!o&&s.test(`${n}${t}`)?n+=t:(o=!0,i+=t)})),{level:parseInt(n)-1,suffix:i}}function sl(t,e,n){return al(wr.WORD,t,e,n)}function rl(t,e,n){return al(wr.LETTER,t,e,n)}function al(t,e,n,i){const{fontStyle:o,textStyle:s,charSpace:r=1,gridType:a=$.LINES,snapToGrid:l=Fe.FALSE}=n,h=Ir.getTextSize(e,o),{width:c=0}=h;let d=null!=i?i:c,u=0;if(Ya(a,l)){d=Math.ceil(c/r)*r,a===$.LINES_AND_CHARS&&(u=(d-c)/2)}return{content:e,ts:s,fontStyle:o,width:d,bBox:h,paddingLeft:u,left:0,spanType:t}}function ll(t,e,n,i){return na(t)?function(t,e,n,i){const o=[t];let s=e;for(let r=e+1;r<n.length;r++){const t=n[r];if(!na(t))break;o.unshift(t),s=r}return{charIndex:s,spanGroup:[rl(o.join(""),i)]}}(t,e,n,i):ia(t)?function(t,e,n,i){const o=[t];let s=e;for(let r=e+1;r<n.length;r++){const t=n[r];if(!ia(t))break;o.push(t),s=r}return{charIndex:s,spanGroup:[sl(o.join(""),i)]}}(t,e,n,i):ea(t)?void 0:function(t,e,n,i){const{pageWidth:o=1/0}=i,s=rl(t,i),r=[s];let a=s.width,l=e;for(let h=e+1;h<n.length;h++){const t=n[h];if(ea(t)||oa(t))break;{const e=rl(t,i),n=e.width;if(a+n>o)break;r.push(e),a+=n,l=h}}return{charIndex:l,spanGroup:r}}(t,e,n,i)}var hl,cl,dl,ul,gl,_l;function pl(t,e,n,i,o=0,s=0,r=!1,a,l,h){const{lineHeight:c=15.6,lineTop:d=0,contentHeight:u=0,paddingLeft:g=0,paddingRight:_=0,paddingTop:p=0,paddingBottom:m=0,marginTop:T=0,spaceBelowApply:f=0}=n,v=function(t,e){return{blockId:e,type:t,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}(e,t);v.lineIndex=o,v.paragraphStart=bl(s,r),v.contentHeight=u,v.top=d,v.lineHeight=c,v.paddingTop=p,v.paddingBottom=m,v.marginTop=T,v.spaceBelowApply=f,v.divides=function(t,e,n,i,o,s,r,a){const l=[];return l.push({left:0,width:i},{left:n-o,width:o}),null==r||r.forEach(((i,o)=>{const s=Tl(i,t,e,n);s&&l.push(s)})),null==a||a.forEach(((i,o)=>{const s=Tl(i,t,e,n);s&&l.push(s)})),null==s||s.forEach(((i,o)=>{const s=Tl(i,t,e,n);s&&l.push(s)})),function(t,e){e.sort(((t,e)=>t.left>e.left?1:-1));const n=[];let i=0;const o=e.length;for(let s=0;s<o;s++){const r=e[s],{left:a,width:l}=r;if(a>i){let e=a-i;e=e<t?e:t-i;const o=Il(i,e);n.push(o)}if(i=Math.max(a+l,i),s===o-1&&a+l<t){const e=Il(a+l,t-a-l);n.push(e)}}return n}(n,l)}(c,d,i,g,_,a,l,h);for(let E of v.divides)E.parent=v;return v}function ml(t,e,n,i){const{aTop:o,height:s,aLeft:r,width:a,angle:l=0,drawingOrigin:h}=t,{layoutType:c,distT:d=0,distB:u=0}=h;if(c!==at.WRAP_TOP_AND_BOTTOM)return;if(0===l){const t=o-d;if(t+(s+u)<n||t>e+n)return;return t+s}let{top:g=0,height:_=0}=fl(l,r,a,o,s);return g-=d,_+=u,g+_<n||g>e+n?void 0:g+_}function Tl(t,e,n,i){const{aTop:o,height:s,aLeft:r,width:a,angle:l=0,drawingOrigin:h}=t,{layoutType:c}=h;if(c===at.WRAP_NONE||c===at.WRAP_TOP_AND_BOTTOM)return;if(c===at.WRAP_POLYGON){const{start:t=[0,0],lineTo:o}=h;if(!o)return;let s=[];s.push(new aa(t[0],t[1]));for(let e=0;e<o.length;e++){const t=o[e];s.push(new aa(t[0],t[1]))}if(0!==l){const t=(new ha).rotate(l);for(let e=0;e<s.length;e++){const n=s[e];s[e]=t.applyPoint(n)}}return vl(s,n,e,i)}if(0===l)return El(o,s,r,a,n,e,i,h);const d=fl(l,r,a,o,s);if(c===at.WRAP_SQUARE){const{left:t,width:o,top:s,height:r}=d;return El(s,r,t,o,n,e,i,h)}return vl(d.points,n,e,i)}function fl(t,e,n,i,o){const s=(new ha).rotate(t),r=new aa(e,i),a=new aa(e,i+o),l=new aa(e+n,i),h=new aa(e+n,i+o);return s.makeBoundingBoxFromPoints([r,a,l,h])}function vl(t,e,n,i){const o=new ma(t),s=o.intersection([new aa(0,e),new aa(i,e)]),r=o.intersection([new aa(0,e+n),new aa(i,e+n)]);if(!s&&!r)return;const a=function(t,e=0){const n=[];for(let i=0;i<t.length;i++){const o=t[i];0===e?n.push(o.x):n.push(o.y)}return{max:Math.max(...n),min:Math.min(...n)}}([...t,...s||[],...r||[]]);return{left:a.min,width:a.max}}function El(t,e,n,i,o,s,r,a){const{layoutType:l,wrapText:h=st.BOTH_SIDES,distL:c=0,distR:d=0,distT:u=0,distB:g=0}=a,_=t-(l===at.WRAP_SQUARE?u:0);if(_+(e+(l===at.WRAP_SQUARE?g:0))<o||_>s+o)return;let p=n-c,m=i+d,T=function(t,e,n,i){let o=0;t===st.LEFT?o=1:t===st.RIGHT?o=2:t===st.LARGEST&&(o=e>i-e-n?1:2);return o}(h,p,m,r);return 1===T?m=r-p:2===T&&(p=0,m=n+i+d),{left:p,width:m}}function Il(t,e){return{spanGroup:[],width:e,left:t,paddingLeft:0,isFull:!1,st:0,ed:0}}function bl(t,e){return 0===t&&!0===e}function Al(t,e){const n=t.parent;if(null!=n){const t=null==n.divides[0].spanGroup[0],i=e[0],o=i.content||" ";if(t&&" "===o){const t=i.width;i.width=0;for(let n of e)n!==i&&(n.left-=t)}}t.spanGroup.push(...e)}function Cl(t,e,n,i,o=0,s=!1){if(bl(o,s))if(i.bulletSkeleton){const{bulletSkeleton:r,paragraphStyle:a={}}=i,{gridType:l=$.LINES,charSpace:h=0,defaultTabStop:c=1}=n,{snapToGrid:d=Fe.TRUE}=a,u=Va(h,c,l,d);!function(t,e,n){const{hanging:i,indentStart:o}=t,{hanging:s,indentStart:r}=e;void 0===i&&(t.hanging=s);void 0===o&&(t.indentStart=Ga(r||0,n)-Ga(s||0,n))}(a,r,u);Nl([function(t,e,n){const{bBox:i,symbol:o,ts:s,fontStyle:r,bulletAlign:a=Y.START,bulletType:l=!1}=e,h=i.width,c=Math.ceil(h/n);let d=(c<2?2:c)*n,u=0;return l&&(a===Y.CENTER?(u=-h/2,d-=u):a===Y.END&&(u=-h,d-=u)),{content:o,ts:s,fontStyle:r,width:d,paddingLeft:0,bBox:function(t,e){const{ba:n,bd:i}=t.bBox,{ba:o,bd:s}=e.bBox;return n+i>o+s?t.bBox:e.bBox}(t,e),left:u,spanType:wr.LIST}}(t[0],r,u),...t],e,n,i,o,s)}else Nl(t,e,n,i,o,s);else Sl(t,e,n,i,o,s);return[...e]}function Sl(t,e,n,i,o=0,s=!1,r){var a,l;const h=Ba(e),c=za(h);if(c){const d=function(t){const e=t.length;let n=0;for(let i=0;i<e;i++){n+=t[i].width}return n}(t),u=c.divide,g=null==(a=null==u?void 0:u.spanGroup)?void 0:a[u.spanGroup.length-1],_=(null==g?void 0:g.width)||0,p=(null==g?void 0:g.left)||0,m=function(t){const{width:e,marginLeft:n,marginRight:i}=t;return e-n-i}(h);if(_+p+d>u.width){!function(t,e){t.isFull=e}(u,!0);const a=function(t){var e;const n=null==(e=t.parent)?void 0:e.parent;if(n)return n}(u);d>m?function(t){if(t.sections.length>1)return!1;const e=Fa(t),n=e.columns.length;for(let i=0;i<n;i++)if(!Wa(e.columns[i]))return!1;return!0}(h)?(Al(u,t),function(t=[]){for(let e=0;e<t.length;e++){Za(t[e],!0)}}(null==(l=null==a?void 0:a.parent)?void 0:l.columns)):wl(t,e,n,i,o,s,r):a&&d>a.width?(Za(a,!0),Wa(a)?(console.log(t),Al(u,t)):Rl(t,e,n,i,o,s,r)):c.isLast?Nl(t,e,n,i,o,s,r):Sl(t,e,n,i,o,s,r)}else{const r=u.parent,a=function(t){const e=t.length;let n,i=-1/0;for(let o=0;o<e;o++){const e=t[o],{ba:s,bd:r}=e.bBox;i<s+r&&(n={boundingBoxAscent:s,boundingBoxDescent:r}),i=s+r}return n}(t);if(r&&a){const{paragraphLineGapDefault:l,linePitch:h,lineSpacing:c,spacingRule:d,snapToGrid:u,gridType:g}=Xa(n,i),{boundingBoxAscent:_,boundingBoxDescent:p}=a,m=_+p,{contentHeight:T}=Ol(m,l,h,g,c,d,u);if(r.contentHeight<T){const a=function(t){const e=t.divides,n=e.length,i=[];for(let o=0;o<n;o++){const t=e[o];i.push(...t.spanGroup)}return i}(r),l=a.length;let h=[],c=1;a[0].spanType===wr.LIST&&l>2?(h=[a[0],a[1]],c=2):h=[a[0]];const d=r.parent;null==d||d.lines.pop(),Nl(h,e,n,i,o,s,_+p);for(let t=c;t<a.length;t++)Sl([a[t]],e,n,i,o,s);return void Sl(t,e,n,i,o,s)}}!function(t,e=0){const n=t.length;let i;for(let o=0;o<n;o++){const n=t[o];n.left=i?i.left+i.width:e,i=n}}(t,_+p);for(let e of t)e.parent=u;Al(u,t)}}else Nl(t,e,n,i,o,s,r)}function Nl(t,e,n,i,o=0,s=!1,r){var a,l,h,c,d;let u=Ba(e),g=Ua(u);if(g&&g.column||(wl(t,e,n,i,o),u=Ba(e),g=Ua(u)),!g)return;const _=g.column,p=function(t){return t.lines[t.lines.length-1]}(_),{ba:m,bd:T}=t[0].bBox,f=r||m+T,{paragraphStyle:v={},paragraphAffectSkeDrawings:E,skeHeaders:I,skeFooters:b,blockAnchor:A,blockId:C}=i,{namedStyleType:S=ht.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:N=Re.UNSPECIFIED,direction:R,spaceAbove:w=0,spaceBelow:O=0,borderBetween:y,borderTop:M,borderBottom:D,borderLeft:L,borderRight:x,indentFirstLine:k=0,hanging:H=0,indentStart:P=0,indentEnd:B=0,tabStops:F=[],keepLines:U=Fe.FALSE,keepNext:z=Fe.FALSE,wordWrap:W=Fe.FALSE,widowControl:G=Fe.FALSE,shading:V}=v,{paragraphLineGapDefault:Y,linePitch:X,lineSpacing:j,spacingRule:K,snapToGrid:Z,gridType:q}=Xa(n,i),Q=bl(o,s),{paddingTop:J,paddingBottom:tt,contentHeight:et,lineSpacingApply:nt}=Ol(f,Y,X,q,j,K,Z),{marginTop:it,spaceBelowApply:ot}=function(t=0,e=0,n=0,i,o){let s=0,r=0;if(!i)return{marginTop:s,spaceBelowApply:r};if(s=Ga(e,t),r=Ga(n,t),o){const{spaceBelowApply:t}=o;t>s&&(s=0,o.lineHeight+=t,o.marginBottom=t)}return{marginTop:s,spaceBelowApply:r}}(nt,w,O,Q,p),st=it+J+et+tt;let rt=_.parent;rt||(rt=Fa(u));const at=((null==p?void 0:p.lineHeight)||0)+((null==p?void 0:p.top)||0),{width:lt,headerId:ct,footerId:dt}=u,ut=null==(l=null==(a=null==I?void 0:I.get(ct))?void 0:a.get(lt))?void 0:l.skeDrawings,gt=null==(c=null==(h=null==b?void 0:b.get(dt))?void 0:h.get(lt))?void 0:c.skeDrawings;!function(t,e,n,i,o){var s;if(!o)return;const r=null==(s=n.parent)?void 0:s.parent;if(!r)return;const a=new Map,l=function(t){const e=t.parent;if(!e)return!1;const n=null==e?void 0:e.columns;if(!n)return!1;for(let i=n.length-1;i>=0;i--){const t=n[i].lines,e=t.length;if(!(e<=0))for(let n=e-1;n>=0;n--){if(t[n].paragraphStart)return!1}}return!0}(n);o.forEach((o=>{if(!o)return;const{initialState:s,drawingOrigin:h}=o;if(s||!h)return;const{objectProperties:c}=h,{positionH:d,positionV:u,size:g,angle:_}=c,{width:p=0,height:m=0}=g;o.aLeft=function(t,e,n,i,o=!1){const{relativeFrom:s,align:r,posOffset:a,percent:l}=t;if(null!=r)if(r===Ot.INSIDE||r===Ot.OUTSIDE)s===At.MARGIN||At.PAGE;else{if(s===At.COLUMN){const{width:t,left:n}=e;let o=0;return r===Ot.LEFT?o=n:r===Ot.RIGHT?o=n+t-i:r===Ot.CENTER&&(o=n+t/2-i/2),o}if(s===At.LEFT_MARGIN);else if(s===At.MARGIN);else if(s===At.RIGHT_MARGIN);else if(s===At.INSIDE_MARGIN);else if(s===At.OUTSIDE_MARGIN);else if(s===At.PAGE){const{width:t}=n;let e=0;return r===Ot.RIGHT?e=t-i:r===Ot.CENTER&&(e=t/2-i/2),e}}else{if(a){const{width:t,marginLeft:r,marginRight:l}=n,h=t-l;let c=0;return s===At.COLUMN?c=(o?0:(null==e?void 0:e.left)||0)+a:s===At.LEFT_MARGIN||(s===At.MARGIN?c=a+r:s===At.RIGHT_MARGIN||s===At.INSIDE_MARGIN||s===At.OUTSIDE_MARGIN||s===At.PAGE&&(c=a)),c+i>h&&(c=h-i),c}if(l){const{width:t,marginLeft:e,marginRight:i}=n;if(s===At.LEFT_MARGIN);else if(s===At.MARGIN);else if(s===At.RIGHT_MARGIN);else if(s===At.INSIDE_MARGIN);else if(s===At.OUTSIDE_MARGIN);else if(s===At.PAGE)return l*t}}}(d,n,r,p,l)||0,o.aTop=function(t,e,n,i,o,s,r=!1){const{relativeFrom:a,align:l,posOffset:h,percent:c}=t;if(null!=l){if(a===St.LINE){let t=0;return l===Mt.BOTTOM?t=n+i-o:l===Mt.TOP?t=n:l===Mt.CENTER&&(t=n+i/2-o/2),t}if(a===St.TOP_MARGIN);else if(a===St.MARGIN);else if(a===St.BOTTOM_MARGIN);else if(a===St.INSIDE_MARGIN);else if(a===St.OUTSIDE_MARGIN);else if(a===St.PAGE){const{height:t}=e;let n=0;return l===Mt.BOTTOM?n=t-o:l===Mt.CENTER&&(n=t/2-o/2),n}}else{if(h){let t=0;return a===St.LINE?t=n||0+h:a===St.TOP_MARGIN||a===St.MARGIN||a===St.BOTTOM_MARGIN||a===St.INSIDE_MARGIN||a===St.OUTSIDE_MARGIN||(a===St.PAGE?t=h:a===St.PARAGRAPH&&(t=(r?0:null==s?n:s)+h)),t}if(c){const{height:t,marginBottom:n,marginTop:i}=e;if(a===St.TOP_MARGIN);else if(a===St.MARGIN);else if(a===St.BOTTOM_MARGIN);else if(a===St.INSIDE_MARGIN);else if(a===St.OUTSIDE_MARGIN);else if(a===St.PAGE)return c*t}}}(u,r,t,e,m,i,l)||0,o.width=p,o.height=m,o.angle=_,o.initialState=!0,a.set(o.objectId,o)})),r.skeDrawings=new Map([...r.skeDrawings,...a])}(at,st,_,null==(d=null==A?void 0:A.get(C))?void 0:d.top,E);const _t=function(t=15.6,e=0,n=0,i,o,s){let r=e;return null==o||o.forEach((n=>{const i=ml(n,t,e);i&&(r=Math.max(r,i))})),null==s||s.forEach((n=>{const i=ml(n,t,e);i&&(r=Math.max(r,i))})),null==i||i.forEach((n=>{const i=ml(n,t,e);i&&(r=Math.max(r,i))})),r}(st,at,o,u.skeDrawings,ut,gt);if(st+_t>rt.height&&_.lines.length>0&&u.sections.length>0)return Za(_,!0),void Rl(t,e,n,i,o,s,r);const pt=p?p.lineIndex+1:0,{charSpace:mt,defaultTabStop:Tt}=function(t,e){const{paragraphStyle:n={}}=e,{charSpace:i=0,gridType:o=$.LINES,defaultTabStop:s=36,documentTextStyle:r={}}=t,{fs:a=hr}=r,{snapToGrid:l=Fe.TRUE}=n;return{charSpace:i,documentFontSize:a,defaultTabStop:s,gridType:o,snapToGrid:l}}(n,i),ft=Va(mt,Tt,q,Z),{paddingLeft:vt,paddingRight:Et,changeBulletWidth:It}=function(t,e=0,n=0,i=0,o=0,s){const{spanType:r=wr.LETTER,bBox:a}=t;let l=Ga(e,s),h=Ga(n,s),c=Ga(i,s),d=Ga(o,s),u=c,g=d,_={state:!1,hangingNumber:0};if(r===wr.LIST){const{width:t}=a;l>0?u+=l:h>0&&h>t&&(_.state=!0,_.hangingNumber=h)}else u+=h;return{paddingLeft:u,paddingRight:g,changeBulletWidth:_}}(t[0],k,H,P,B,ft);It.state&&(t[0].width=It.hangingNumber);const bt=pl(C,Nr.PARAGRAPH,{lineHeight:st,contentHeight:et,lineTop:_t,paddingLeft:vt,paddingRight:Et,paddingTop:J,paddingBottom:tt,marginTop:it,spaceBelowApply:ot},_.width,pt,o,s,u.skeDrawings,ut,gt);_.lines.push(bt),bt.parent=_,function(t,e,n,i){if(i)if(i.has(t)){const n=i.get(t);null==n||n.elements.push(e)}else i.set(t,{elements:[e],blockId:t,top:n})}(C,bt,at,A),Sl(t,e,n,i,o,s,r)}function Rl(t,e,n,i,o=0,s=!1,r){!0===function(t){const e=Fa(t),n=e.columns.length;for(let i=0;i<n;i++)if(!e.columns[i].isFull)return!1;return!0}(Ba(e))?wl(t,e,n,i,o,s,r):Nl(t,e,n,i,o,s,r)}function wl(t,e,n,i,o=0,s=!1,r){const a=Ba(e),{skeHeaders:l,skeFooters:h}=i;e.push(kl(n,{skeHeaders:l,skeFooters:h},null==a?void 0:a.pageNumber)),Rl(t,e,n,i,o,s,r)}function Ol(t,e,n,i,o,s,r){let a=e,l=e;if(i===$.DEFAULT||r===Fe.FALSE)return s===dt.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:o*t,lineSpacingApply:t}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(o,t),lineSpacingApply:o};let h=0;return h=s===dt.AUTO?o*n:o,t+2*e<h&&(a=l=(h-t)/2),{paddingTop:a,paddingBottom:l,contentHeight:t,lineSpacingApply:h}}function yl(t,e=0,n,i,o,s){const{ct:r="",ts:a={},tab:l=!1}=t,c=ta(a,s),{paragraphStyle:d={}}=o,{gridType:u=$.LINES,charSpace:g=0,documentTextStyle:_={},defaultTabStop:p=10.5,pageSize:m={width:1/0,height:1/0},marginLeft:T=0,marginRight:f=0}=n,{namedStyleType:v=ht.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:E=Re.UNSPECIFIED,lineSpacing:I=1,spacingRule:b=dt.AUTO,snapToGrid:A=Fe.TRUE,direction:C,spaceAbove:S=0,spaceBelow:N=0,borderBetween:R,borderTop:w,borderBottom:O,borderLeft:y,borderRight:M,indentFirstLine:D=0,hanging:L=0,indentStart:x=0,indentEnd:k=0,tabStops:H=[],keepLines:P=Fe.FALSE,keepNext:B=Fe.FALSE,wordWrap:F=Fe.FALSE,widowControl:U=Fe.FALSE,shading:z}=d;let W=[i];const G=m.width||1/0-T-f,V={fontStyle:c,textStyle:h(h({},_),a),charSpace:g,gridType:u,snapToGrid:A,pageWidth:G};if(l){const t=Va(g,p,u,A);return W=Cl([(Y=V,X=t,al(wr.TAB," ",Y,X))],W,n,o,e,!0),W}var Y,X;const j=r.split("");for(let h=0;h<j.length;h++){const t=j[h],i=0===h,s=ll(t,h,j,V);let r=[];if(s){const{charIndex:t,spanGroup:e}=s;h=t,r=e}else{const e=sl(t,V);r.push(e)}W=Cl(r,W,n,o,e,i)}return function(t,e){for(let n of t){const{sections:t}=n;for(let n of t){const{columns:t}=n;for(let n of t){const{lines:t}=n;for(let n of t)e&&"[object Function]"===Zr(e)&&e(n)}}}}(W,(t=>{!function(t,e){if(e===Re.UNSPECIFIED||e===Re.LEFT)return;const{divides:n}=t,i=n.length;for(let o=0;o<i;o++){const t=n[o],{width:i,spanGroup:s}=t,r=Ka(t);i!==1/0&&(e===Re.CENTER?t.paddingLeft=(i-r)/2:e===Re.RIGHT?t.paddingLeft=i-r:Re.JUSTIFIED)}}(t,E)})),W}function Ml(t,e,n,i,o,s){const{pageNumberStart:r,pageSize:a={w:1/0,h:1/0},marginRight:l=0,marginLeft:d=0,columnProperties:u=[],columnSeparatorType:g=J.NONE,contentDirection:_,sectionType:p,sectionTypeNext:m,textDirection:T,lists:f,drawings:v={},fontLocale:E}=i,{elements:I,paragraphStyle:b={},bullet:A}=e,{skeHeaders:C,skeFooters:S,skeListLevel:N,blockAnchor:R}=o,w={blockId:t,paragraphStyle:b,skeHeaders:C,skeFooters:S,blockAnchor:R},O=[n];let y=n;const M=new Map,D=el(A,f,function(t,e){if(!t||!e)return;const{listId:n,nestingLevel:i}=t,o=null==e?void 0:e.get(n);let s=i;s<0&&(s=0);const r=[];for(let a=s;a>=0;a--){const t=null==o?void 0:o[a];r[a]=t||null}return r}(A,N),E,s);return function(t,e,n){if(!t||!e)return;const{listId:i,nestingLevel:o}=t,s=[...(null==n?void 0:n.get(i))||[]];s[o]=e,s.splice(o+1),null==n||n.set(i,s)}(A,D,N),w.bulletSkeleton=D,I.forEach(((t,e)=>{const{eId:n,et:i}=t;if(i===it.DRAWING){const t=v[n];t.layoutType===at.INLINE||M.set(n,function(t){return{objectId:t.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:t}}(t))}})),I.forEach(((t,e)=>{const{eId:n,et:s}=t;let r=[];if(s===it.TEXT_RUN){const{tr:n,st:o,ed:s}=t;if(!n)return!1;r=yl(n,e,i,y,c(h({},w),{paragraphAffectSkeDrawings:M}),E)}else if(s===it.PAGE_BREAK)r=[kl(i,o,Dl(y),Cr.PAGE)],M.clear();else if(s===it.COLUMN_BREAK){const t=Ua(y);t&&!t.isLast?Za(t.column,!0):r=[kl(i,o,Dl(y),Cr.COLUMN)]}y=function(t,e){const n=t.slice(-1)[0],i=e[0];if(n===i){if(1===e.length)return n;e.shift()}return t.push(...e),t.slice(-1)[0]}(O,r)})),O}function Dl(t){return t.pageNumber+1}function Ll(t,e,n,i,o,s){const r=[],a=new Map;for(let l of t){const{paragraph:t,table:h,tableOfContents:c,blockType:d,customBlock:u,blockId:g}=l;if(null==o?void 0:o.get(g))continue;let _=[],p=e;r.length>0&&(p=r[r.length-1]),d===j.PARAGRAPH&&t?_=Ml(l.blockId,t,p,n,i,s):d===j.TABLE&&h||d===j.SECTION_BREAK&&c||d===j.CUSTOM&&(_=Ta(l.blockId,u,p,n,i,s)),0===_.length&&(_=[]),xl(r,_),a.set(g,!0)}return{pages:r,renderedBlockIdMap:a}}function xl(t,e){t[t.length-1]===e[0]&&e.splice(0,1),t.push(...e)}function kl(t,e,n=1,i=Cr.SECTION){var o,s,r,a;const l={sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:kt.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:Cr.SECTION,st:0,ed:0,skeDrawings:new Map},{pageNumberStart:h=1,pageSize:c={width:1/0,height:1/0},pageOrient:d=kt.PORTRAIT,headerIds:u={},footerIds:g={},useFirstPageHeaderFooter:_,useEvenPageHeaderFooter:p,footers:m,headers:T,columnProperties:f=[],columnSeparatorType:v,marginTop:E=0,marginBottom:I=0,marginHeader:b=0,marginFooter:A=0,marginLeft:C=0,marginRight:S=0,renderConfig:N={}}=t,{skeHeaders:R,skeFooters:w}=e,{width:O=1/0,height:y=1/0}=c;l.pageNumber=n,l.pageNumberStart=h,l.renderConfig=N,l.marginLeft=C,l.marginRight=S,l.breakType=i,l.width=l.pageWidth=O,l.height=l.pageHeight=y,l.pageOrient=d;const{defaultHeaderId:M,evenPageHeaderId:D,firstPageHeaderId:L}=u,{defaultFooterId:x,evenPageFooterId:k,firstPageFooterId:H}=g;let P,B,F=null!=M?M:"",U=null!=x?x:"";n===h&&_?(F=null!=L?L:"",U=null!=H?H:""):n%2==0&&p&&(F=null!=D?D:"",U=null!=k?k:""),F&&((null==(o=R.get(F))?void 0:o.has(O))?P=null==(s=R.get(F))?void 0:s.get(O):T&&(P=Hl(T[F],t,e),R.set(F,new Map([[O,P]]))),l.headerId=F),U&&((null==(r=w.get(U))?void 0:r.has(O))?B=null==(a=w.get(U))?void 0:a.get(O):m&&(B=Hl(m[U],t,e),w.set(F,new Map([[O,B]]))),l.footerId=U),l.marginTop=Pl(E,b,P),l.marginBottom=Pl(I,A,B);const z=l.sections,W=z[z.length-1],{marginTop:G,marginBottom:V,marginLeft:Y,marginRight:X}=l,j=O-Y-X,K=y-G-V;let $=0;W&&($=W.top+W.height);const Z=$a(f,v,$,0,j,K-$);return Z.parent=l,z.push(Z),l}function Hl(t,e,n,i=!0){const{body:o}=t,{lists:s,headers:r,footers:a,fontLocale:l,pageSize:d,marginLeft:u=0,marginRight:g=0,drawings:_,marginTop:p=0,marginBottom:m=0,marginHeader:T=0,marginFooter:f=0}=e,v={lists:s,headers:r,footers:a,pageSize:{width:((null==d?void 0:d.width)||1/0)-u-g,height:1/0},fontLocale:l,drawings:_},{blockElements:E}=o,I=[];E.forEach((t=>{I.push(t)}));const b=kl(v,n),A=Ll(I,b,v,n).pages[0];ja([A]);const C=A.sections[0].columns[0],S=C.height||0,{skeDrawings:N,st:R,ed:w}=A,O={lines:C.lines,skeDrawings:N,height:S,st:R,ed:w,marginLeft:u,marginRight:g};return c(h({},O),i?{marginTop:Bl(p,T,S)}:{marginBottom:Fl(m,f,S)})}function Pl(t,e,n){return n&&0!==n.lines.length?Math.max(t,e,(null==n?void 0:n.height)||0):t}function Bl(t,e,n){const i=Math.max(t,e);return n>i?0:i-n}function Fl(t,e,n){const i=Math.max(t,e);return n>i?0:i-n}(cl=hl||(hl={}))[cl.BOTH=0]="BOTH",cl[cl.LEFT=1]="LEFT",cl[cl.RIGHT=2]="RIGHT",(ul=dl||(dl={}))[ul.X=0]="X",ul[ul.Y=1]="Y";(_l=gl||(gl={})).PENDING="pending",_l.CALCULATING="calculating",_l.READY="ready",_l.INVALID="invalid";class Ul extends class{constructor(t){this._dirty=!0,this._context=t,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(t){this._dirty=t}_localeInitial(){if(!this._context)return;const t=this._context.getUniver().getGlobalContext().getLocale(),e=t.getObject("renderFont");e||t.load({en:er,zh:tr}),this._fontLocale=e}}{constructor(t,e){super(e),this.onRecalculateChangeObservable=new O,this._renderedBlockIdMap=new Map,this._documentData=t}static create(t,e){return new Ul(t,e)}updateDrawing(t,e){const n=this._documentData.drawings;if(!n)return;const i=n[t];if(!i)return;const o=i.objectProperties;o.size.width=e.width,o.size.height=e.height,o.positionH.posOffset=e.left,o.positionV.posOffset=e.top}calculate(t){this.dirty&&(this._skeletonData=this._createSkeleton(t),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(t,e){const n=this._documentData.documentStyle;if(!n.pageSize)return t=null!=t?t:1/0,e=null!=e?e:1/0,void(n.pageSize={width:t,height:e});void 0!==t&&(n.pageSize.width=t),void 0!==e&&(n.pageSize.height=e)}__getContentMapArr(){const{body:t}=this._documentData;if(!t)return[];const{blockElements:e}=t;if(0===e.length)return[];const n=[];let i={blockElements:[],sectionBreak:void 0};return e.forEach((t=>{const{sectionBreak:e}=t;e?(i.sectionBreak=e,n.push(i),i={blockElements:[],sectionBreak:void 0}):i.blockElements.push(t)})),i.sectionBreak||(i.sectionBreak={columnProperties:[],columnSeparatorType:J.NONE,sectionType:q.SECTION_TYPE_UNSPECIFIED},i.blockElements.length>0&&n.push(i)),n}_createSkeleton(t){var e;const n=this.__getContentMapArr(),i={width:1/0,height:1/0},{documentStyle:o,footers:s,headers:r,lists:a,drawings:l}=this._documentData,{pageNumberStart:c=1,pageSize:d=i,pageOrient:u=kt.PORTRAIT,defaultHeaderId:g,defaultFooterId:_,evenPageHeaderId:p,evenPageFooterId:m,firstPageHeaderId:T,firstPageFooterId:f,useFirstPageHeaderFooter:v,useEvenPageHeaderFooter:E,marginTop:I=0,marginBottom:b=0,marginRight:A=0,marginLeft:C=0,marginHeader:S=0,marginFooter:N=0,charSpace:R=0,linePitch:w=15.6,gridType:O=$.LINES,paragraphLineGapDefault:y=0,defaultTabStop:M=10.5,textStyle:D={fs:14},renderConfig:L={horizontalAlign:Re.UNSPECIFIED,verticalAlign:Oe.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Me.UNSPECIFIED}}=o,x=this.__getNullSke();if(0===n.length)return x;const k={footers:s,headers:r,lists:a,drawings:l,charSpace:R,linePitch:w,gridType:O,fontLocale:this.getFontLocale(),paragraphLineGapDefault:y,defaultTabStop:M,documentTextStyle:D},{skeHeaders:H,skeFooters:P,skeListLevel:B,blockAnchor:F}=x,U={skeHeaders:H,skeFooters:P,skeListLevel:B,blockAnchor:F},z=[];x.pages=z;for(let W=0;W<n.length;W++){const t=n[W];if(!t.sectionBreak)continue;const{pageNumberStart:i=c,pageSize:o=d,pageOrient:s=u,marginTop:r=I,marginBottom:a=b,marginRight:l=A,marginLeft:R=C,marginHeader:w=S,marginFooter:O=N,defaultHeaderId:y=g,defaultFooterId:M=_,evenPageHeaderId:D=p,evenPageFooterId:x=m,firstPageHeaderId:H=T,firstPageFooterId:P=f,useFirstPageHeaderFooter:B=v,useEvenPageHeaderFooter:F=E,columnProperties:G=[],columnSeparatorType:V=J.NONE,contentDirection:Y,sectionType:X,textDirection:j,renderConfig:K=L}=t.sectionBreak,$=n[W+1],Z=null==(e=null==$?void 0:$.sectionBreak)?void 0:e.sectionType,Q={defaultHeaderId:y,evenPageHeaderId:D,firstPageHeaderId:H},tt={defaultFooterId:M,evenPageFooterId:x,firstPageFooterId:P};null===o.width&&(o.width=1/0),null===o.height&&(o.height=1/0);const et=h({pageNumberStart:i,pageSize:o,pageOrient:s,marginTop:r,marginBottom:a,marginRight:l,marginLeft:R,marginHeader:w,marginFooter:O,headerIds:Q,footerIds:tt,useFirstPageHeaderFooter:B,useEvenPageHeaderFooter:F,columnProperties:G,columnSeparatorType:V,contentDirection:Y,sectionType:X,sectionTypeNext:Z,textDirection:j,renderConfig:K},k);let nt=Ba(z),it=!1;X===q.CONTINUOUS?(ja(z),this.__addNewSectionByContinuous(nt,G,V),it=!0):nt=kl(et,U,null==nt?void 0:nt.pageNumber);const ot=this.getContext(),st=Ll(t.blockElements,nt,et,U,this._renderedBlockIdMap,ot);Z===q.CONTINUOUS&&G.length;const{pages:rt,renderedBlockIdMap:at}=st;it&&rt.splice(0,1),z.push(...rt)}return ja(z),x}__addNewSectionByContinuous(t,e,n){const i=t.sections,o=i[i.length-1],{pageWidth:s,pageHeight:r,marginTop:a,marginBottom:l,marginLeft:h,marginRight:c}=t,d=s-h-c,u=r-a-l,g=((null==o?void 0:o.top)||0)+((null==o?void 0:o.height)||0),_=$a(e,n,g,0,d,u-g);_.parent=t,i.push(_)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}}class zl extends va{constructor(){super(...arguments),this._extensions=new Map}get extensions(){return this._extensions}register(...t){for(let e of t)e.parent=this,this._extensions.set(e.uKey,e)}unRegister(...t){for(let e of t)this._extensions.delete(e)}getExtensionsByOrder(){const t=Array.from(this._extensions.values());return t.sort(ri),t}getExtensionByKey(t){return this._extensions.get(t)}draw(t,e){}}class Wl extends zl{constructor(t,e,n=!1){super(t),this._skeleton=e,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new Aa),this.onIsAddedToParentObserver.add((t=>{var e;null==(e=null==t?void 0:t.getEngine())||e.onTransformChangeObservable.add((t=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas()}))}getSkeleton(){return this._skeleton}setSkeleton(t){this._skeleton=t}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(t,e),t.restore()}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:t=1,scaleY:e=1}=this.parent;return this.parent.classType===fr.SCENE&&(t=this.parent.ancestorScaleX||1,e=this.parent.ancestorScaleY||1),{scaleX:t,scaleY:e}}_getBounding(t){}_draw(t,e){}}class Gl{constructor(){this.translateX=0,this.translateY=0}draw(t,e,n){}clearCache(){}_getScale(t){return sa(t)}}const Vl=Bs.create(),Yl=Bs.create(),Xl=Bs.create(),jl=Bs.create();var Kl,$l;($l=Kl||(Kl={}))[$l.SPAN=0]="SPAN",$l[$l.LINE=1]="LINE";class Zl extends Gl{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}jl.add(new class extends Zl{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(t,e,n){var i;if(!(null==(i=n.parent)?void 0:i.parent))return;const{ts:o,content:s,fontStyle:r,bBox:a}=n;let{spanPointWithFont:l=aa.create(0,0)}=this.extensionOffset;if(!o)return void(null!=s&&t.fillText(s,l.x,l.y));if(null==s)return;this._preFontString!==(null==r?void 0:r.fontString)&&(t.font=this._preFontString=(null==r?void 0:r.fontString)||"");const{cl:h,va:c}=o,d=Ln(h)||"rgb(0,0,0)";if(d&&this._preFontColor!==d&&(t.fillStyle=d),c===Pe.SUBSCRIPT||c===Pe.SUPERSCRIPT){let t=a.spo;c===Pe.SUPERSCRIPT&&(t=-a.sbo),l.y+=t}t.fillText(s,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});jl.add(new class extends Zl{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(t,e,n){var i;const o=null==(i=n.parent)?void 0:i.parent;if(!o)return;const{lineHeight:s=0}=o,{ts:r,width:a,content:l}=n;if(!r)return;const{bg:h}=r;if(!h)return;const c=Ln(h),{spanStartPoint:d=aa.create(0,0)}=this.extensionOffset;c&&(t.fillStyle=c,t.fillRect(d.x-.5,d.y,a+1,s))}clearCache(){this._preBackgroundColor=""}});jl.add(new class extends Zl{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(t,e,n){var i;const o=null==(i=n.parent)?void 0:i.parent;if(!o)return;const{asc:s=0,lineHeight:r=0}=o,{ts:a,left:l,width:h,bBox:c}=n;if(!a)return;const{sp:d}=c,u=sa(e),{ul:g,st:_,ol:p}=a,{originTranslate:m=aa.create(0,0),centerPoint:T=aa.create(0,0),alignOffset:f=aa.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:E=0,vertexAngle:I=0}=v;if(g){const{s:e,cl:n,t:i}=g;if(e===Fe.TRUE){t.beginPath();const e=Ln(n)||"rgb(0,0,0)";t.strokeStyle=e,this._setLineType(t,i||Se.SINGLE);const o=Jr(r+1-.5,u),s=ga(m.addByPoint(l,o),T,E,I,f),a=ga(m.addByPoint(l+h,o),T,E,I,f);t.moveTo(s.x,s.y),t.lineTo(a.x,a.y),t.stroke()}}if(_){const{s:e,cl:n,t:i}=_;if(e===Fe.TRUE){t.beginPath();const e=Ln(n)||"rgb(0,0,0)";t.strokeStyle=e,this._setLineType(t,i||Se.SINGLE);const o=Jr(d-.5,u),s=ga(m.addByPoint(l,o),T,E,I,f),r=ga(m.addByPoint(l+h,o),T,E,I,f);t.moveTo(s.x,s.y),t.lineTo(r.x,r.y),t.stroke()}}if(p){const{s:e,cl:n,t:i}=p;if(e===Fe.TRUE){t.beginPath();const e=Ln(n)||"rgb(0,0,0)";t.strokeStyle=e,this._setLineType(t,i||Se.SINGLE);const o=Jr(-1.5,u),s=ga(m.addByPoint(l,o),T,E,I,f),r=ga(m.addByPoint(l+h,o),T,E,I,f);t.moveTo(s.x,s.y),t.lineTo(r.x,r.y),t.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(t,e){e===Se.DASH_DOT_DOT_HEAVY||e===Se.DOT_DOT_DASH?t.setLineDash([2,2,5,2,2]):e===Se.DASH_DOT_HEAVY||e===Se.DOT_DASH?t.setLineDash([2,5,2]):e===Se.DOTTED||e===Se.DOTTED_HEAVY?t.setLineDash([2]):e===Se.DASH||e===Se.DASHED_HEAVY?t.setLineDash([3]):e===Se.DASH_LONG||e===Se.DASH_LONG_HEAVY?t.setLineDash([6]):t.setLineDash([0])}_getLineWidth(t){let e=1;return t===Se.WAVY_HEAVY||t===Se.DASHED_HEAVY||t===Se.DOTTED_HEAVY||t===Se.DASH_DOT_HEAVY||t===Se.DASH_LONG_HEAVY||t===Se.DASH_DOT_DOT_HEAVY?e=2:t===Se.THICK&&(e=3),e}});jl.add(new class extends Zl{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(t,e,n){var i;const o=null==(i=n.parent)?void 0:i.parent;if(!o)return;const{asc:s=0,lineHeight:r=0}=o,{ts:a,left:l,width:h}=n;if(!a)return;const{bd:c}=a;if(!c)return;const d=this._getScale(e),u=this._createBorderCache(c),{spanStartPoint:g=aa.create(0,0)}=this.extensionOffset;for(let _ of u.keys()){const e=u.get(_);if(!e)continue;const{s:n,cl:i}=e,o=Ln(i)||"rgb(0,0,0)";n!==this._preBorderStyle&&(da(t,n),t.lineWidth=ua(n)/d,this._preBorderStyle=n),o!==this._preBorderColor&&(t.strokeStyle=o||"rgb(0,0,0)",this._preBorderColor=o),ca(t,_,{startX:g.x,startY:g.y,endX:g.x+h,endY:g.y+r})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(t){const{t:e,b:n,l:i,r:o}=t,s=new Map;return e&&s.set(_r.TOP,e),n&&s.set(_r.BOTTOM,n),i&&s.set(_r.LEFT,i),o&&s.set(_r.RIGHT,o),s}});class ql{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(t=0,e=0){this._translateX=t,this._translateY=e}translate(t=0,e=0){this._translateX+=t,this._translateY+=e}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const t=this._translateSaveList.pop();t&&(this._translateX=t.x,this._translateY=t.y)}translatePagePadding(t){const{marginTop:e=0,marginBottom:n=0,marginLeft:i=0,marginRight:o=0}=t;this.translate(i,e)}restorePagePadding(t){const{marginTop:e=0,marginBottom:n=0,marginLeft:i=0,marginRight:o=0}=t;this.translate(-i,-e)}translatePage(t,e=yr.VERTICAL,n=0,i=0,o=0,s=0){const{sections:r,marginTop:a=0,marginBottom:l=0,marginLeft:h=0,marginRight:c=0,pageWidth:d,pageHeight:u,width:g,height:_,pageNumber:p=1,renderConfig:m={}}=t;let T=0,f=0;return e===yr.VERTICAL?T=u+i:e===yr.HORIZONTAL&&(f=d+n),this.translate(f,T),{x:f,y:T}}translateSection(t){const{top:e=0}=t;return this.translate(0,e),{x:0,y:e}}translateColumn(t){const{left:e}=t;return this.translate(e,0),{x:e,y:0}}translateLine(t,e=!1){const{top:n,marginBottom:i=0,marginTop:o=0,paddingTop:s=0,paddingBottom:r=0}=t,a=n+(!0===e?o:0)+s;return this.translate(0,a),{x:0,y:a}}translateDivide(t){const{left:e,paddingLeft:n}=t,i=e+n;return this.translate(i,0),{x:i,y:0}}translateSpan(t){const{left:e}=t;return this.translate(e,0),{x:e,y:0}}}var Ql,Jl,th,eh;(Jl=Ql||(Ql={}))[Jl.NORMAL=0]="NORMAL",Jl[Jl.START=1]="START",Jl[Jl.END=2]="END",(eh=th||(th={}))[eh.page=0]="page",eh[eh.section=1]="section",eh[eh.column=2]="column",eh[eh.line=3]="line",eh[eh.divide=4]="divide",eh[eh.span=5]="span";const nh={page:0,section:1,column:2,line:3,divide:4,span:5};class ih{constructor(t,e,n,i){this._scene=t,this.startNodePosition=e,this.endNodePosition=n,this.segmentId=i,this._current=!1,this._Liquid=new ql,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}getRange(){const t=this._rangeList,e=t[0],n=t[t.length-1];let i=1===t.length&&e.isCollapse;return{cursorStart:e.cursorStart,cursorEnd:n.cursorEnd,isStartBack:e.isStartBack,isEndBack:n.isEndBack,isCollapse:i}}getRangeList(){return this._rangeList}getAnchor(){return this._anchorShape}activeStatic(){var t;null==(t=this._anchorShape)||t.setProps({stroke:Vr(nr,1)})}deactivateStatic(){var t;null==(t=this._anchorShape)||t.setProps({stroke:Vr(nr,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return null==this.startNodePosition&&null==this.endNodePosition}isCollapsed(){return null!=this.startNodePosition&&null==this.endNodePosition||!!this.isSamePosition()}isRange(){const t=this.startNodePosition,e=this.endNodePosition;return null!=t&&null!=e&&!this.isSamePosition()}dispose(){var t,e;null==(t=this._rangeShape)||t.dispose(),this._rangeShape=null,null==(e=this._anchorShape)||e.dispose(),this._anchorShape=null}isIntersection(t){const e=this.getRange(),n=t.getRange(),i=this._getCursorPosition(e.cursorStart,e.isStartBack),o=this._getCursorPosition(e.cursorEnd,e.isEndBack),s=this._getCursorPosition(n.cursorStart,n.isStartBack);return!(i>this._getCursorPosition(n.cursorEnd,n.isEndBack)||o<s)}refresh(t){var e,n;const i=this.startNodePosition,o=this.endNodePosition;if(null==(e=this._anchorShape)||e.hide(),null==(n=this._rangeShape)||n.hide(),this.isEmpty())return;if(this.isCollapsed()){const e=this._getRangePointData(i,i,t),{pointGroup:n,cursorList:o}=e;return this._setRangeList(o),void(n.length>0&&this._createAndUpdateAnchor(n,t.left,t.top))}const s=this._getRangePointData(i,o,t),{pointGroup:r,cursorList:a}=s;this._setRangeList(a),r.length>0&&this._createAndUpdateRange(r,t.left,t.top)}getStart(){if(null==this.startNodePosition)return this.endNodePosition;if(null==this.endNodePosition)return this.startNodePosition;const{start:t}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return t}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(t,e){return!(t.page>e.page)&&(t.page<e.page||!(t.section>e.section)&&(t.section<e.section||!(t.column>e.column)&&(t.column<e.column||!(t.line>e.line)&&(t.line<e.line||!(t.divide>e.divide)&&(t.divide<e.divide||!(t.span>e.span)&&(t.span,e.span,!0))))))}_compareNodePosition(t,e){return this._compareNodePositionLogic(t,e)?{start:t,end:e}:{start:e,end:t}}_setNodePositionState(t=0,e,n,i){this._currentStartState[t]=i===e?1:0,this._currentEndState[t]=i===n?2:0}_checkPreviousNodePositionState(t,e=!0){let n,i=t;for(;i>=0;){const t=th[i];let o;if(o=e?this._currentStartState[t]:this._currentEndState[t],void 0===o)return;if(void 0===n&&(n=o),o!==n)return 0;i--}return n}_getSelectionRuler(t,e,n,i,o){let s=0,r=i;const a=th[t],l=th[t+1];if(null===l||null===a)return{start_next:s,end_next:r};const h=e[a],c=n[a];this._setNodePositionState(a,h,c,o);const d=this._checkPreviousNodePositionState(t),u=this._checkPreviousNodePositionState(t,!1);return 1===d&&(s=e[l]),2===u&&(r=n[l]),{start_next:s,end_next:r}}_pushToPoints(t){const{startX:e,startY:n,endX:i,endY:o}=t,s=[];return s.push({x:e,y:n}),s.push({x:i,y:n}),s.push({x:i,y:o}),s.push({x:e,y:o}),s.push({x:e,y:n}),s}isSamePosition(){const t=this.startNodePosition,e=this.endNodePosition;if(null==t||null==e)return!1;const n=Object.keys(nh);for(let i of n){if(t[i]!==e[i])return!1}return t.isBack===e.isBack}_createAndUpdateRange(t,e,n){if(this._rangeShape)return this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),void this._rangeShape.show();const i=new ka("__TestSelectionRange__"+U.generateRandomId(6),{pointsGroup:t,fill:Vr(nr,.2),left:e,top:n,evented:!1});this._rangeShape=i,this._scene.addObject(i,2)}_getAnchorBounding(t){const e=t[0],n=e[0],i=e[2],{x:o,y:s}=n,{x:r,y:a}=i;return{left:o,top:s,width:r-o,height:a-s}}_createAndUpdateAnchor(t,e,n){const i=this._getAnchorBounding(t),{left:o,top:s,width:r,height:a}=i;if(this._anchorShape)return this._anchorShape.transformByState({left:o+e,top:s+n,height:a}),void this._anchorShape.show();const l=new La("__TestSelectionAnchor__"+U.generateRandomId(6),{left:o+e,top:s+n,height:a,strokeWidth:1,stroke:Vr(nr),evented:!1});this._anchorShape=l,this._scene.addObject(l,2)}_getRangePointData(t,e,n){const i=[],o=[];if(null==t||null==e)return{pointGroup:i,cursorList:o};const{start:s,end:r}=this._compareNodePosition(t,e);return this._selectionIterator(s,r,n,((t,e,n,a,l,h)=>{var c;const{lineHeight:d}=h,{spanGroup:u,st:g}=l,{x:_,y:p}=this._Liquid;let m;const T=u[t],f=u[e],v=(null==T?void 0:T.left)||0,E=(null==T?void 0:T.width)||0,I=(null==f?void 0:f.left)||0,b=(null==f?void 0:f.width)||0;let A=(null==T?void 0:T.spanType)===wr.LIST,C=(null==(c=u[0])?void 0:c.spanType)===wr.LIST,S=t+g,N=e+g;const R=s.span!==t||!n||s.isBack,w=!(r.span!==e||!a)&&r.isBack,O=s===r;if(0===t&&e===u.length-1)N-=C?1:0,m={startX:_+v+(A?E:0),startY:p,endX:_+I+b,endY:p+d};else{S-=C&&!A?1:0,N-=C&&!A?1:0,m={startX:_+v+(R&&!A?0:E),startY:p,endX:_+I+(w?0:b),endY:p+d}}i.push(this._pushToPoints(m)),o.push({isStartBack:R,isEndBack:w,cursorStart:S,cursorEnd:N,isCollapse:O})})),{pointGroup:i,cursorList:o}}_selectionIterator(t,e,n,i){const o=n.getSkeleton();if(!o)return[];this._Liquid.reset();const s=o.getSkeletonData().pages,{page:r}=t,{page:a}=e;this._resetCurrentNodePositionState();for(let l=0;l<=r-1;l++){const t=s[l];this._Liquid.translatePage(t,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}for(let l=r;l<=a;l++){const o=s[l],h=o.sections,{start_next:c,end_next:d}=this._getSelectionRuler(nh.page,t,e,h.length-1,l);this._Liquid.translateSave(),this._Liquid.translatePagePadding(o);for(let n=c;n<=d;n++){const s=h[n],u=s.columns,{start_next:g,end_next:_}=this._getSelectionRuler(nh.section,t,e,u.length-1,n);this._Liquid.translateSection(s);for(let h=g;h<=_;h++){const p=u[h],m=p.lines,{start_next:T,end_next:f}=this._getSelectionRuler(nh.column,t,e,m.length-1,h);this._Liquid.translateColumn(p);for(let u=T;u<=f;u++){const v=m[u],{divides:E,type:I,lineHeight:b=0}=v,{start_next:A,end_next:C}=this._getSelectionRuler(nh.line,t,e,E.length-1,u);this._Liquid.translateSave(),this._Liquid.translateLine(v);for(let m=A;m<=C;m++){const I=E[m];this._Liquid.translateSave(),this._Liquid.translateDivide(I);const b=I.spanGroup,{start_next:S,end_next:N}=this._getSelectionRuler(nh.divide,t,e,b.length-1,m);let R=!1,w=!1;l===r&&n===c&&h===g&&u===T&&m===A&&(R=!0),l===a&&n===d&&h===_&&u===f&&m===C&&(w=!0),i&&i(S,N,R,w,I,v,p,s,o),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}this._Liquid.translateRestore(),this._Liquid.translatePage(o,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}}_setRangeList(t){0!==t.length&&(this._rangeList=t)}_getCursorPosition(t,e){return t-(!0===e?1:0)}}class oh{constructor(t){var e;this._documents=t,this.onKeydownObservable=new O,this.onInputObservable=new O,this.onCompositionstartObservable=new O,this.onCompositionupdateObservable=new O,this.onCompositionendObservable=new O,this._textSelectionList=[],this._viewPortObserverMap=new Map,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=null==(e=this._documents)?void 0:e.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}set activeViewport(t){this._attachScrollEvent(t),this._activeViewport=t}static create(t){return new oh(t)}getActiveTextSelection(){const t=this._textSelectionList;for(let e of t)if(e.isActive())return e}getTextSelectionList(){return this._textSelectionList}add(t){this._addTextSelection(t)}remain(){const t=this.getActiveTextSelection();if(null==t)return;const e=this._textSelectionList.indexOf(t);return this._textSelectionList.splice(e,1)[0]}sync(){this._syncDomToSelection()}active(t,e){this._container.style.left=`${t}px`,this._container.style.top=`${e}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout((()=>{this._input.focus()}),0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(t){var e;this._documents&&this._detachEvent(this._documents),this._documents=t,this._skeletonObserver=null==(e=t.getSkeleton())?void 0:e.onRecalculateChangeObservable.add((t=>{this._deleteAllTextSelection()})),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}_initialDom(){const t=document.createElement("div");t.style.position="absolute",t.style.position="absolute",t.style.left="0px",t.style.top="0px";const e=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div");e.appendChild(n),t.appendChild(e),t.appendChild(i),this._container=t,this._inputParent=e,this._input=n,this._cursor=i,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(t)}_initialInput(){this._inputParent.style.cssText="\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        ",this._input.contentEditable="true",this._input.style.cssText="\n            position: absolute; \n            overflow: hidden; \n            opacity: 1; \n            background: #000; \n            color: transparent; \n            outline: none; \n            z-index: -2; \n            caret-color: transparent; \n            white-space: pre-wrap; \n            user-select: text;\n        "}_initialCursorDom(){if(this._cursor.style.cssText="\n            visibility: visible;\n            position: absolute;\n            background: #000;\n            left: 0;\n            top: 0;\n            width: 1px;\n            height: 20px;\n            opacity: 0;\n            z-index: 0;\n            pointer-events: none;\n            display: none\n        ",!function(t){for(let e=0,n=document.head.childNodes.length;e<n;e++){const n=document.head.childNodes[e];if("STYLE"===n.nodeName&&n.textContent&&n.textContent.indexOf(t)>-1)return!0}return!1}("keyframes univer_cursor_blinkStyle")){!function(t){const e=document.createElement("style");document.head.appendChild(e);const n=e.sheet;for(let i of t)null==n||n.insertRule(i,n.cssRules.length)}(["\n                @-webkit-keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            ","\n                @keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            "])}}_getSkeletonData(){var t,e;return null==(e=null==(t=this._documents)?void 0:t.getSkeleton())?void 0:e.getSkeletonData()}_getNodePosition(t){var e;if(!1===t)return;const{node:n,ratioX:i,ratioY:o}=t,s=null==(e=this._documents)?void 0:e.findPositionBySpan(n);return null!=s?c(h({},s),{isBack:i<.5}):void 0}_interactTextSelection(t){const e=[];let n=!1;this._textSelectionList.forEach((i=>{if(i===t)return!0;t.isIntersection(i)?(n=!0,i.dispose()):e.push(i)})),n&&(e.push(t),this._textSelectionList=e)}_deleteAllTextSelection(){this._textSelectionList.forEach((t=>{t.dispose()})),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach((t=>{t.deactivate()}))}_addTextSelection(t){this._deactivateTextSelection(),t.activate(),this._textSelectionList.push(t)}_updateTextSelection(t){if(!this._documents)return;let e=this._textSelectionList.pop();e||(e=new ih(this._documents.getScene(),t)),this._deleteAllTextSelection(),e.activate(),e.startNodePosition=t,e.endNodePosition=null,this._textSelectionList=[e]}_isEmptyTextSelection(){return 0===this._textSelectionList.length}_getCanvasOffset(){var t,e;const n=null==(t=this._documents)?void 0:t.getEngine(),i=null==(e=null==n?void 0:n.getCanvas())?void 0:e.getCanvasEle();if(!i)return{left:0,top:0};const{top:o,left:s}=function(t){let e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,o=window.pageYOffset||i.scrollTop||n.scrollTop,s=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop,a=i.clientLeft||n.clientLeft;return{top:e.top+o-r,left:e.left+s-a}}(i);return{left:s,top:o}}_syncDomToSelection(){var t;const e=this.getActiveTextSelection(),n=null==e?void 0:e.getAnchor();if(!n||n&&!n.visible)return;const{height:i,left:o,top:s}=n,r=null==(t=this._activeViewport)?void 0:t.getAbsoluteVector(aa.FromArray([o,s]));this._cursor.style.height=`${i}px`;let{left:a,top:l}=this._getCanvasOffset();a+=(null==r?void 0:r.x)||0,l+=(null==r?void 0:r.y)||0,this.active(a,l)}_moving(t,e,n){const{scrollX:i,scrollY:o}=Ea(n);if(!this._documents)return;const s=this._documents.findNodeByCoord(t,e),r=this._getNodePosition(s);if(console.log("endNode",s,r,{moveOffsetX:t,moveOffsetY:e,_viewportScrollY:this._viewportScrollY,scrollX:i}),!r)return;const a=this.getActiveTextSelection();a&&(a.endNodePosition=r,a.refresh(this._documents),this._interactTextSelection(a))}_attachScrollEvent(t){if(!t)return;const e=t.viewPortKey;if(this._viewPortObserverMap.has(e))return;const n=t.onScrollBeforeObserver.add((t=>{if(!t.viewport)return;const e=this.getActiveTextSelection();null==e||e.activeStatic(),this._cursor.style.display="none"})),i=t.onScrollStopObserver.add((t=>{const e=t.viewport;if(!e)return;const n=e.getBounding(),i=this.getActiveTextSelection(),o=null==i?void 0:i.getAnchor();if(o&&(!o||o.visible)){if(n){const{minX:t,maxX:e,minY:i,maxY:s}=Ia(o,n);if(o.strokeWidth<t||e<0||o.strokeWidth<i||s<0)return}this._syncDomToSelection(),null==i||i.deactivateStatic(),this._cursor.style.display="revert"}}));this._viewPortObserverMap.set(e,{scrollBefore:n,scrollStop:i})}_attachInputEvent(){this._input.addEventListener("keydown",(t=>{if(this._isIMEInputApply)return;const e=this.getActiveTextSelection(),n=this.getTextSelectionList();null!=this._documents&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:t,content:"",document:this._documents,activeSelection:e,selectionList:n}))})),this._input.addEventListener("input",(t=>{if(this._isIMEInputApply)return;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onInputObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})})),this._input.addEventListener("compositionstart",(t=>{this._isIMEInputApply=!0;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onCompositionstartObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})})),this._input.addEventListener("compositionend",(t=>{this._isIMEInputApply=!1;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onCompositionendObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})})),this._input.addEventListener("compositionupdate",(t=>{const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onCompositionupdateObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})}))}_attachSelectionEvent(t){this._moveInObserver=t.onPointerEnterObserver.add((()=>{t.cursor=cr.TEXT})),this._moveOutObserver=t.onPointerLeaveObserver.add((()=>{t.cursor=cr.DEFAULT,e.resetCursor()}));const e=t.getScene();this._downObserver=t.onPointerDownObserver.add(((t,n)=>{const{offsetX:i,offsetY:o}=t;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(i,o);const s=this._documents.findNodeByCoord(i,o),r=this._getNodePosition(s);if(console.log("startNode",s,r,i,o),!r)return void this._deleteAllTextSelection();if(t.ctrlKey||this._isEmptyTextSelection()){const t=new ih(this._documents.getScene(),r);this._addTextSelection(t)}else this._updateTextSelection(r);this._activeSelectionRefresh(),this._syncDomToSelection(),e.disableEvent();const a=Oa.create(e);a.startScroll(i,o);const{scrollX:l,scrollY:h}=Ea(a);this._viewportScrollX=l,this._viewportScrollY=h,this._moveObserver=e.onPointerMoveObserver.add((t=>{const{offsetX:n,offsetY:i}=t;this._moving(n,i,a),a.scrolling(n,i,(()=>{this._moving(n,i,a)})),e.setCursor(cr.TEXT)})),this._upObserver=e.onPointerUpObserver.add((t=>{e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),e.enableEvent(),a.stopScroll()}))}))}_detachEvent(t){var e;t.onPointerEnterObserver.remove(this._moveInObserver),t.onPointerLeaveObserver.remove(this._moveOutObserver),t.onPointerDownObserver.remove(this._downObserver),null==(e=t.getSkeleton())||e.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const t=this.getActiveTextSelection();null==t||t.refresh(this._documents)}}class sh extends Wl{constructor(t,e,n){super(t,e,null==n?void 0:n.allowCache),this.isCalculateSkeleton=!0,this.onPageRenderObservable=new O,this.docsLeft=0,this.docsTop=0,this._hasEditor=!1,void 0===(null==n?void 0:n.pageMarginLeft)?this.pageMarginLeft=17:this.pageMarginLeft=null==n?void 0:n.pageMarginLeft,void 0===(null==n?void 0:n.pageMarginTop)?this.pageMarginTop=14:this.pageMarginTop=null==n?void 0:n.pageMarginTop,this.pageLayoutType=(null==n?void 0:n.pageLayoutType)||yr.VERTICAL,this._drawLiquid=new ql,this._findLiquid=new ql,this._hasEditor=(null==n?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(e),this.makeDirty(!0)}get hasEditor(){return this._hasEditor}static create(t,e,n){return new sh(t,e,n)}calculatePagePosition(){const t=this.getScene();let e=null==t?void 0:t.getParent();const{width:n,height:i,pageMarginLeft:o,pageMarginTop:s}=this;if(null==e)return this;const{width:r,height:a}=e;let l=0,h=0,c=0,d=0;return r>n?(l=r/2-n/2,c=r-30):(l=o,c=n+2*o),a>i?(h=a/2-i/2,d=a-30):(h=s,d=i+2*s),this.docsLeft=l,this.docsTop=h,t.resize(c,d+200),this.translate(l,h),this}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(t,e){return this.getScene().getActiveViewportByCoord(aa.FromArray([t,e]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=oh.create(this),this._hasEditor=!0)}disableEditor(){var t;null==(t=this._editor)||t.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:t,onCompositionstartObservable:e,onCompositionupdateObservable:n,onCompositionendObservable:i,onKeydownObservable:o}=this._editor;return{onInputObservable:t,onCompositionstartObservable:e,onCompositionupdateObservable:n,onCompositionendObservable:i,onKeydownObservable:o}}remainActiveSelection(){if(this._hasEditor)return this._editor.remain()}addSelection(t){if(this._hasEditor)return this._editor.add(t)}syncSelection(){if(this._hasEditor)return this._editor.sync()}draw(t,e){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const i=n.getSkeletonData(),{pages:o}=i,s=this.getParentScale(),r=this.getExtensionsByOrder(),a=sa(s);for(let c of r)c.clearCache();let l=0,h=0;for(let c=0,d=o.length;c<d;c++){const e=o[c],{sections:n,marginTop:i=0,marginBottom:d=0,marginLeft:u=0,marginRight:g=0,width:_,height:p,renderConfig:m={}}=e,{verticalAlign:T=Oe.TOP,horizontalAlign:f=Re.LEFT,centerAngle:v=0,vertexAngle:E=0,wrapStrategy:I=Me.UNSPECIFIED,isRotateNonEastAsian:b=Fe.FALSE}=m,A=this._horizontalHandler(_,u,g,f),C=this._verticalHandler(p,i,d,T),S=aa.create(A,C),N=Kr(v),R=Kr(E),w=R-N;this.onPageRenderObservable.notifyObservers({page:e,pageLeft:h,pageTop:l,ctx:t}),this._startRotation(t,w);for(let o of n){const{columns:e}=o;this._drawLiquid.translateSection(o);for(let n of e){const{lines:e,width:o}=n;this._drawLiquid.translateColumn(n);const l=e.length;let h,c=null;if(0!==R){const{rotateTranslateXList:t,rotatedHeight:n,rotatedWidth:s,fixOffsetX:r,fixOffsetY:a,rotateTranslateY:l}=_a(e,o,R);let _=s;n>this.height&&I!==Me.WRAP&&(I===Me.OVERFLOW||R>0)&&(_=this.height/Math.tan(Math.abs(R)));const p=this._horizontalHandler(_,u,g,f);let m=this._verticalHandler(n,i,d,T)-a;n>this.height&&(m=R<0?this.height-(n+a):-a),h=aa.create(p+r,m),this._drawLiquid.translate(0,-l),c=t}else h=S;for(let n=0;n<l;n++){const i=e[n],{divides:o,asc:l=0,type:d,lineHeight:u=0}=i;let g=l;const _=g*Math.sin(N),p=g*Math.cos(N);if(d===Nr.BLOCK)for(let e of r)e.type===Kl.LINE&&(e.extensionOffset={alignOffset:h,renderConfig:m},e.draw(t,s,i));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(i,!0),c&&this._drawLiquid.translate(c[n]);const e=o.length;for(let n=0;n<e;n++){const e=o[n],{spanGroup:i}=e;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(e);for(let n of i){if(!n.content||0===n.content.length)continue;const{width:e,left:i}=n,{x:o,y:l}=this._drawLiquid,c=aa.create(Jr(o,a),Jr(l,a)),d=aa.create(Jr(e/2,a),Jr(u/2,a)),g=ga(c.addByPoint(Jr(i,a),0),d,N,R,h),T=ga(c.addByPoint(Jr(i+_,a),Jr(p,a)),d,N,R,h),f={originTranslate:c,spanStartPoint:g,spanPointWithFont:T,centerPoint:d,alignOffset:h,renderConfig:m};for(let a of r)a.type===Kl.SPAN&&(a.extensionOffset=f,a.draw(t,s,n))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(t,w);const{x:O,y:y}=this._drawLiquid.translatePage(e,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);h+=O,l+=y}}changeSkeleton(t){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(t),this._addSkeletonChangeObserver(t),this}findPositionBySpan(t){var e;const n=t.parent,i=null==n?void 0:n.parent,o=null==i?void 0:i.parent,s=null==o?void 0:o.parent,r=null==s?void 0:s.parent,a=null==(e=this.getSkeleton())?void 0:e.getSkeletonData();if(!(n&&o&&s&&r&&a))return;return{span:n.spanGroup.indexOf(t),divide:i.divides.indexOf(n),line:o.lines.indexOf(i),column:s.columns.indexOf(o),section:r.sections.indexOf(s),page:a.pages.indexOf(r)}}findNodeByCharIndex(t){const e=this.getSkeleton();if(!e)return;const n=e.getSkeletonData().pages;for(let i of n){const{sections:e,st:n,ed:o}=i;if(!(t<n||t>o))for(let i of e){const{columns:e,st:n,ed:o}=i;if(!(t<n||t>o))for(let i of e){const{lines:e,st:n,ed:o}=i;if(!(t<n||t>o))for(let i of e){const{divides:e,lineHeight:n,st:o,ed:s}=i,r=e.length;if(!(t<o||t>s))for(let i=0;i<r;i++){const n=e[i],{spanGroup:o,st:s,ed:r}=n;if(t<s||t>r)continue;const a=o[t-s];if(a)return a}}}}}}findNodeByCoord(t,e){const n=this.getScene().transformToSceneCoord(aa.FromArray([t,e]));if(!n)return!1;const i=this._getInverseCoord(n);let{x:o,y:s}=i;const r=this.getSkeleton();if(!r)return!1;this._findLiquid.reset();const a=r.getSkeletonData().pages;for(let l=0,h=a.length;l<h;l++){const t=a[l],{startX:e,startY:n,endX:i,endY:r}=this._getPageBoundingBox(t);if(!(o>=e&&o<=i&&s>=n&&s<=r)){this._translatePage(t);continue}this._findLiquid.translatePagePadding(t);const h=t.sections;for(let a of h){const{columns:t,height:e}=a;this._findLiquid.translateSection(a);const{y:n}=this._findLiquid;if(s>=n&&s<=n+e)for(let i of t){const{lines:t,width:e}=i;this._findLiquid.translateColumn(i);const{x:n}=this._findLiquid;if(!(o>=n&&o<=n+e))continue;const r=t.length;for(let i=0;i<r;i++){const e=t[i],{divides:n,type:r,lineHeight:a=0}=e;if(r!==Nr.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(e);const{y:t}=this._findLiquid,i=t,r=t+a;if(!(s>=i&&s<=r)){this._findLiquid.translateRestore();continue}const l=n.length;for(let e=0;e<l;e++){const t=n[e],{spanGroup:a,width:l}=t;this._findLiquid.translateSave(),this._findLiquid.translateDivide(t);const{x:h}=this._findLiquid;if(o>=h&&o<=h+l){for(let t of a){if(!t.content||0===t.content.length)continue;const{width:e,left:n}=t,a=h+n,l=h+n+e;if(o>=a&&o<=l)return{node:t,ratioX:o/(a+l),ratioY:s/(i+r)}}this._findLiquid.translateRestore()}else this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(t),this._translatePage(t)}return!1}_draw(t,e){this.draw(t,e)}_horizontalHandler(t,e,n,i){let o=0;return o=i===Re.CENTER?(this.width-t)/2:i===Re.RIGHT?this.width-t-n:e,o}_verticalHandler(t,e,n,i){let o=0;return o=i===Oe.MIDDLE?(this.height-t)/2:i===Oe.BOTTOM?this.height-t-n:e,o}_startRotation(t,e){t.rotate(e||0)}_resetRotation(t,e){t.rotate(-e||0)}_initialDefaultExtension(){jl.getData().forEach((t=>{this.register(t)}))}_addSkeletonChangeObserver(t){t&&(this._skeletonObserver=t.onRecalculateChangeObservable.add((t=>{const e=t.pages;let n=0,i=0;for(let o=0,s=e.length;o<s;o++){const t=e[o],{pageWidth:r,pageHeight:a}=t;this.pageLayoutType===yr.VERTICAL?(i+=a,o!==s-1&&(i+=this.pageMarginTop),n=Math.max(n,r)):this.pageLayoutType===yr.HORIZONTAL&&(n+=r,o!==s-1&&(n+=this.pageMarginLeft),i=Math.max(i,a))}this.resize(n,i),this.calculatePagePosition()})))}_disposeSkeletonChangeObserver(t){t&&t.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(t){const{pageWidth:e,pageHeight:n}=t;let{x:i,y:o}=this._findLiquid,s=-1,r=-1;return this.pageLayoutType===yr.VERTICAL?(s=e,r=o+n):this.pageLayoutType===yr.HORIZONTAL&&(s=i+e,r=n),{startX:i,startY:o,endX:s,endY:r}}_translatePage(t){this._findLiquid.translatePage(t,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}}var rh,ah;(ah=rh||(rh={})).RESIZE_LT="__SpreadsheetTransformerResizeLT__",ah.RESIZE_CT="__SpreadsheetTransformerResizeCT__",ah.RESIZE_RT="__SpreadsheetTransformerResizeRT__",ah.RESIZE_LM="__SpreadsheetTransformerResizeLM__",ah.RESIZE_RM="__SpreadsheetTransformerResizeRM__",ah.RESIZE_LB="__SpreadsheetTransformerResizeLB__",ah.RESIZE_CB="__SpreadsheetTransformerResizeCB__",ah.RESIZE_RB="__SpreadsheetTransformerResizeRB__",ah.OUTLINE="__SpreadsheetTransformerOutline__",ah.ROTATE_LINE="__SpreadsheetTransformerRotateLine__",ah.ROTATE="__SpreadsheetTransformerRotate__",ah.GROUP="__SpreadsheetTransformer__";const lh=[rh.RESIZE_LT,rh.RESIZE_CT,rh.RESIZE_RT,rh.RESIZE_LM,rh.RESIZE_RM,rh.RESIZE_LB,rh.RESIZE_CB,rh.RESIZE_RB];var hh,ch,dh,uh,gh,_h,ph,mh;(ch=hh||(hh={}))[ch.MOVE_START=0]="MOVE_START",ch[ch.MOVING=1]="MOVING",ch[ch.MOVE_END=2]="MOVE_END";class Th{constructor(t,e){this._scene=t,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this.onChangeStartObservable=new O,this.onChangingObservable=new O,this.onChangeEndObservable=new O,this.onClearControlObservable=new O,this.onCreateControlObservable=new O,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this._initialProps(e)}getScene(){return this._scene}attachTo(t){if(t.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&t.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&t.onPointerLeaveObserver.add(this.hoverLeaveFunc)),t.onPointerDownObserver.add(((e,n)=>{const{offsetX:i,offsetY:o}=e;this._startOffsetX=i,this._startOffsetY=o;const s=this._getTopScene();if(!s)return;this._addCancelObserver(s),s.disableEvent();const r=Oa.create(s);r.startScroll(i,o);const{scrollX:a,scrollY:l}=Ea(r);this._viewportScrollX=a,this._viewportScrollY=l,this._updateActiveObjectList(t,e),this._moveObserver=s.onPointerMoveObserver.add((t=>{const{offsetX:e,offsetY:n}=t;this._moving(e,n,r),this._hiddenControl(),r.scrolling(e,n,(()=>{this._moving(e,n,r)}))})),this._upObserver=s.onPointerUpObserver.add((t=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent(),this._updateControl(),r.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})})),n.stopPropagation()})),t}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach((t=>{t.dispose()})),this._selectedObjectMap.forEach((t=>{t.dispose()})),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}_initialProps(t){if(!t)return;const e=Object.keys(t);0!==e.length&&e.forEach((e=>{if(void 0===t[e])return!0;this[e]=t[e]}))}_updateControlChildren(){this._updateControlIterator(((t,e)=>{const{left:n,top:i,width:o,height:s,scaleX:r,scaleY:a}=e.getState();t.getObjects().forEach((t=>{const e=t.oKey,n=this._checkTransformerType(e);if(!n)return!0;if(n===rh.OUTLINE)t.transformByState(this._getOutlinePosition(o,s,r,a));else{const{left:e,top:i}=this._getRotateAnchorPosition(n,s,o,r,a);t.transformByState({left:e,top:i})}})),t.transformByState({left:n,top:i})}))}_anchorMoving(t,e,n,i){const{scrollX:o,scrollY:s}=Ea(i),r=e-this._viewportScrollX+o,a=n-this._viewportScrollY+s,l=r-this._startOffsetX,h=a-this._startOffsetY;this._selectedObjectMap.forEach((e=>{const{left:n,top:i,width:o,height:s}=e,r={};switch(t){case rh.RESIZE_LT:r.left=n+l,r.top=i+h,r.width=o-l,r.height=s-h;break;case rh.RESIZE_CT:r.top=i+h,r.height=s-h;break;case rh.RESIZE_RT:r.top=i+h,r.width=o+l,r.height=s-h;break;case rh.RESIZE_LM:r.left=n+l,r.width=o-l;break;case rh.RESIZE_RM:r.width=l+o;break;case rh.RESIZE_LB:r.left=n+l,r.width=o-l,r.height=s+h;break;case rh.RESIZE_CB:r.height=h+s;break;case rh.RESIZE_RB:r.width=l+o,r.height=h+s}e.transformByState(r)})),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:h,type:1}),this._startOffsetX=r,this._startOffsetY=a}_attachEventToAnchor(t,e=rh.RESIZE_LT){t.onPointerDownObserver.add(((t,n)=>{const{offsetX:i,offsetY:o}=t;this._startOffsetX=i,this._startOffsetY=o;const s=this._getTopScene();if(null==s)return;s.disableEvent();const r=Oa.create(s);r.startScroll(i,o);const{scrollX:a,scrollY:l}=Ea(r);this._viewportScrollX=a,this._viewportScrollY=l;const h=this._getRotateAnchorCursor(e);this._moveObserver=s.onPointerMoveObserver.add((t=>{const{offsetX:n,offsetY:i}=t;this._anchorMoving(e,n,i,r),r.scrolling(n,i,(()=>{this._anchorMoving(e,n,i,r)})),s.setCursor(h)})),this._upObserver=s.onPointerUpObserver.add((t=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent(),s.resetCursor(),r.stopScroll()})),n.stopPropagation()}))}_attachEventToRotate(t){t.onPointerDownObserver.add(((t,e)=>{const{offsetX:n,offsetY:i}=t;this._startOffsetX=n,this._startOffsetY=i;const o=this._getTopScene();null!=o&&(o.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=o.onPointerMoveObserver.add((t=>{})),this._upObserver=o.onPointerUpObserver.add((t=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent()})),e.stopPropagation())}))}_getOutlinePosition(t,e,n,i){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:t+2*this.borderSpacing,height:e+2*this.borderSpacing}}_getRotateAnchorCursor(t){let e=cr.NORTH_WEST_RESIZE;switch(t){case rh.ROTATE:case rh.ROTATE_LINE:e=cr.MOVE;break;case rh.RESIZE_LT:break;case rh.RESIZE_CT:e=cr.NORTH_RESIZE;break;case rh.RESIZE_RT:e=cr.NORTH_EAST_RESIZE;break;case rh.RESIZE_LM:e=cr.WEST_RESIZE;break;case rh.RESIZE_RM:e=cr.EAST_RESIZE;break;case rh.RESIZE_LB:e=cr.SOUTH_WEST_RESIZE;break;case rh.RESIZE_CB:e=cr.SOUTH_RESIZE;break;case rh.RESIZE_RB:e=cr.SOUTH_EAST_RESIZE}return e}_getRotateAnchorPosition(t,e,n,i,o){let s=-this.anchorSize/2,r=-this.anchorSize/2;switch(t){case rh.ROTATE:s=n/2-this.rotateSize/2,r=-this.rotateAnchorOffset-this.borderSpacing-2*this.borderStrokeWidth-this.rotateSize;break;case rh.ROTATE_LINE:s=n/2,r=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case rh.RESIZE_LT:s+=-this.borderSpacing-this.borderStrokeWidth,r+=-this.borderSpacing-this.borderStrokeWidth;break;case rh.RESIZE_CT:s+=n/2,r+=-this.borderSpacing-this.borderStrokeWidth;break;case rh.RESIZE_RT:s+=n+this.borderSpacing-this.borderStrokeWidth,r+=-this.borderSpacing-this.borderStrokeWidth;break;case rh.RESIZE_LM:s+=-this.borderSpacing-this.borderStrokeWidth,r+=e/2;break;case rh.RESIZE_RM:s+=n+this.borderSpacing-this.borderStrokeWidth,r+=e/2;break;case rh.RESIZE_LB:s+=-this.borderSpacing-this.borderStrokeWidth,r+=e+this.borderSpacing-this.borderStrokeWidth;break;case rh.RESIZE_CB:s+=n/2,r+=e+this.borderSpacing-this.borderStrokeWidth;break;case rh.RESIZE_RB:s+=n+this.borderSpacing-this.borderStrokeWidth,r+=e+this.borderSpacing-this.borderStrokeWidth}return{left:s,top:r}}_createResizeAnchor(t,e,n){let{height:i,width:o,scaleX:s,scaleY:r}=e.getState();const{left:a,top:l}=this._getRotateAnchorPosition(t,i,o,s,r),h=this._getRotateAnchorCursor(t),c=new La(`${t}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:a,top:l});return this._attachHover(c,h,cr.DEFAULT),c}_checkTransformerType(t){return t.indexOf(rh.OUTLINE)>-1?rh.OUTLINE:t.indexOf(rh.ROTATE)>-1?rh.ROTATE:t.indexOf(rh.ROTATE_LINE)>-1?rh.ROTATE_LINE:t.indexOf(rh.RESIZE_LT)>-1?rh.RESIZE_LT:t.indexOf(rh.RESIZE_CT)>-1?rh.RESIZE_CT:t.indexOf(rh.RESIZE_RT)>-1?rh.RESIZE_RT:t.indexOf(rh.RESIZE_LM)>-1?rh.RESIZE_LM:t.indexOf(rh.RESIZE_RM)>-1?rh.RESIZE_RM:t.indexOf(rh.RESIZE_LB)>-1?rh.RESIZE_LB:t.indexOf(rh.RESIZE_CB)>-1?rh.RESIZE_CB:t.indexOf(rh.RESIZE_RB)>-1?rh.RESIZE_RB:void 0}_updateControlIterator(t){this._transformerControlMap.forEach(((e,n)=>{const i=this._selectedObjectMap.get(n);if(!i)return!0;t(e,i)}))}_updateControl(){this._updateControlIterator(((t,e)=>{const{left:n,top:i}=e.getState();t.transformByState({left:n,top:i}),t.show(),t.makeDirty(!0)}))}_hiddenControl(){this._transformerControlMap.forEach((t=>{t.hide(),t.makeDirty(!0)}))}_attachHover(t,e,n){t.onPointerEnterObserver.add((()=>{t.cursor=e})),t.onPointerLeaveObserver.add((()=>{t.cursor=n}))}_clearControl(){this._transformerControlMap.forEach((t=>{t.dispose()})),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(t){let{left:e,top:n,height:i,width:o,angle:s,scaleX:r,scaleY:a,skewX:l,skewY:c,flipX:d,flipY:u}=t.getState();const g=t.oKey,_=this._selectedObjectMap.size,p=[];if(this.borderEnabled){const t=new La(`${rh.OUTLINE}_${_}`,h({zIndex:_-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke},this._getOutlinePosition(o,i,r,a)));p.push(t)}if(this.resizeEnabled){const{left:t,top:e}=this._getRotateAnchorPosition(rh.ROTATE_LINE,i,o,r,a),n=new La(`${rh.ROTATE_LINE}_${_}`,{zIndex:_-1,evented:!1,left:t,top:e,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:s,top:l}=this._getRotateAnchorPosition(rh.ROTATE,i,o,r,a),h=this._getRotateAnchorCursor(rh.ROTATE),c=new La(`${rh.ROTATE}_${_}`,{zIndex:_-1,left:s,top:l,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:2*this.borderStrokeWidth,stroke:this.borderStroke});this._attachEventToRotate(c),this._attachHover(c,h,cr.DEFAULT),p.push(n,c)}if(this.resizeEnabled)for(let h=0,f=this.enabledAnchors.length;h<f;h++){if(1!==this.enabledAnchors[h])continue;const e=lh[h],n=this._createResizeAnchor(e,t,_);this._attachEventToAnchor(n,e),p.push(n)}const m=new wa(`${rh.GROUP}_${_}`,...p);m.zIndex=_,m.evented=!1,m.transformByState({left:e,top:n});const T=this.getScene();return T.addObject(m,2),console.log(T,t),this._transformerControlMap.set(g,m),this.onCreateControlObservable.notifyObservers(m),m}_getTopScene(){var t;return null==(t=this.getScene().getEngine())?void 0:t.activeScene}_moving(t,e,n){const{scrollX:i,scrollY:o}=Ea(n),s=t-this._viewportScrollX+i,r=e-this._viewportScrollY+o,a=s-this._startOffsetX,l=r-this._startOffsetY;this._selectedObjectMap.forEach((t=>{t.translate(a+t.left,l+t.top)})),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:a,moveY:l,type:1}),this._startOffsetX=s,this._startOffsetY=r}_updateActiveObjectList(t,e){this._selectedObjectMap.has(t.oKey)||(e.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(t.oKey,t),this._createControl(t))}_addCancelObserver(t){t.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=t.onPointerDownObserver.add((e=>{this._selectedObjectMap.clear(),this._clearControl(),t.onPointerDownObserver.remove(this._cancelFocusObserver)}))}}class fh{constructor(t,e,n){var i;if(this._parent=e,this.onPointerDownObserver=new O,this.onPointerMoveObserver=new O,this.onPointerUpObserver=new O,this.onDblclickObserver=new O,this.onMouseWheelObserver=new O,this.onKeyDownObservable=new O,this.onKeyUpObservable=new O,this.onTransformChangeObservable=new O,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new ha,this._isFirstDirty=!0,this._evented=!0,this._cursor=cr.DEFAULT,this._transformerOpenState=!1,this._sceneKey=t,n&&this.transformByState(n),this._parent.classType===fr.ENGINE){const e=this._parent;e.addScene(this),e.hasActiveScene()||e.setActiveScene(t),this._inputManager=new Ra(this)}else if(this._parent.classType===fr.SCENE_VIEWER){this._parent.addSubScene(this)}null==(i=this._parent)||i.onTransformChangeObservable.add((t=>{this._resetViewportSize(),this._setTransForm()}))}get classType(){return fr.SCENE}get transform(){return this._transform}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const t=this.getParent();let e=1;return t.classType===fr.SCENE_VIEWER&&(e=t.ancestorScaleX),this._scaleX*e}get ancestorScaleY(){const t=this.getParent();let e=1;return t.classType===fr.SCENE_VIEWER&&(e=t.ancestorScaleY),this._scaleY*e}get cursor(){return this._cursor}get sceneKey(){return this._sceneKey}get evented(){return this._evented}set transform(t){this._transform=t}set cursor(t){this.setCursor(t)}set width(t){this._width=t}set height(t){this._height=t}set scaleX(t){this._scaleX=t}set scaleY(t){this._scaleY=t}attachControl(t=!0,e=!0,n=!0,i=!0){var o;if(this._parent.classType===fr.ENGINE)return null==(o=this._inputManager)||o.attachControl(t,e,n,i),this}detachControl(){var t;return null==(t=this._inputManager)||t.detachControl(),this}makeDirty(t=!0){var e;return this._viewports.forEach((e=>{e.makeDirty(t)})),this._parent.classType===fr.SCENE_VIEWER&&(null==(e=this._parent)||e.makeDirty(t)),this}makeDirtyNoParent(t=!0){return this._viewports.forEach((e=>{e.makeDirty(t)})),this}isDirty(){for(let t=0;t<this._viewports.length;t++){if(!0===this._viewports[t].isDirty())return!0}return!1}resetCursor(){this.setCursor(cr.DEFAULT)}setCursor(t){this._cursor=t;const e=this.getEngine();if(!e)return;e.getCanvas().getCanvasEle().style.cursor=t}resize(t,e){const n=this.width;void 0!==t&&(this.width=t);const i=this.height;return void 0!==e&&(this.height=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:i}}),this}scale(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX=t);const i=this.scaleY;return void 0!==e&&(this.scaleY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:i}}),this}scaleBy(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX+=t);const i=this.scaleY;return void 0!==e&&(this.scaleY+=e),this.scaleX=Qr(this.scaleX,1),this.scaleY=Qr(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:i}}),this}transformByState(t){const e=Object.keys(t),n={};0!==e.length&&(e.forEach((e=>{void 0!==t[e]&&(n[e]=this[e],this[e]=t[e])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Br.all,value:t,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===fr.ENGINE)return this._parent;let t=this._parent;for(;t;){if(t.classType===fr.ENGINE)return t;t=null==t?void 0:t.getParent()}return null}getLayers(){return this._layers}getLayer(t=1){for(let e of this._layers)if(e.zIndex===t)return e;return this._createDefaultLayer(t)}getLayerMaxZIndex(){let t=Number.MIN_VALUE;for(let e=0;e<this._layers.length;e++){const n=this._layers[e];n.zIndex>=t&&(t=n.zIndex)}return t}addLayer(...t){this._layers.push(...t)}addObject(t,e=1){var n;return null==(n=this.getLayer(e))||n.addObject(t),this}setObjectBehavior(t){t.parent||(t.parent=this),this.onTransformChangeObservable.add((e=>{t.scaleCacheCanvas()})),t.onIsAddedToParentObserver.notifyObservers(this)}addObjects(t,e=1){var n;return null==(n=this.getLayer(e))||n.addObjects(t),this}removeObject(t){if(null==t)return;const e=this.getLayers();for(let n of e)n.removeObject(t);return this}removeObjects(t){if(null==t)return;const e=this.getLayers();for(let n of e)n.removeObjects(t);return this}getAllObjects(){const t=[];this._layers.sort(ri);for(let e of this._layers)t.push(...e.getObjectsByOrder());return t}getAllObjectsByOrder(t=!1){const e=[],n=t?ai:ri;this._layers.sort(n);for(let i of this._layers)e.push(...i.getObjectsByOrder().sort(n));return e}getAllObjectsByOrderForPick(t=!1){const e=[],n=t?ai:ri;this._layers.sort(n);for(let i of this._layers)e.push(...i.getObjectsByOrderForPick().sort(n));return e}getObject(t){for(let e of this._layers){const n=e.getObjectsByOrder();for(let e of n)if(e.oKey===t)return e}}fuzzyMathObjects(t){for(let e of this._layers){const n=e.getObjectsByOrder();for(let e of n)e.oKey.indexOf(t)>-1&&n.push(e)}return[]}addViewport(...t){return this._viewports.push(...t),this}removeViewport(){}getViewports(){return this._viewports}getViewport(t){for(let e of this._viewports)if(e.viewPortKey===t)return e}changeObjectOrder(){}renderObjects(t,e){return this.getAllObjectsByOrder().forEach((n=>{n.render(t,e)})),this}render(t){var e,n;this.isDirty()&&(!t&&(null==(e=this.getEngine())||e.getCanvas().clear()),null==(n=this.getViewports())||n.forEach((e=>e.render(t))))}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}async requestRender(t){return new Promise(((e,n)=>{this.render(t),Xr(e)}))}openTransformer(t){this._transformer||(this._transformer=new Th(this,t)),this._transformerOpenState=!0}closeTransformer(t=!1){t&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(t){var e;this._transformerOpenState&&(null==(e=this._transformer)||e.attachTo(t))}getTransformer(){return this._transformer}getActiveViewportByRelativeCoord(t){return this._viewports.find((e=>e.isHit(t)))}getActiveViewportByCoord(t){return t=this.getRelativeCoord(t),this.getActiveViewportByRelativeCoord(t)}getRelativeCoord(t){let e=this.getParent();const n=[];for(;e;)e.classType!==fr.SCENE&&e.classType!==fr.SCENE_VIEWER||n.push(e),e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent());n.reverse();for(let i of n)if(i.classType===fr.SCENE){const e=i.getActiveViewportByCoord(t);if(e){const n=e.actualScrollX||0,i=e.actualScrollY||0;t=t.addByPoint(n,i)}}else if(i.classType===fr.SCENE_VIEWER){t=i.transform.clone().invert().applyPoint(t)}return t}transformToSceneCoord(t){const e=this.getActiveViewportByCoord(t);return null==e?void 0:e.getRelativeVector(t)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var t;this.getLayers().forEach((t=>{t.dispose()})),this.getViewports().forEach((t=>{t.dispose()})),this.clearLayer(),this.clearViewports(),this.detachControl(),null==(t=this._transformer)||t.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(t){let e=this.getActiveViewportByCoord(t);if(e||(e=this._viewports[0]),!this._evented||!e)return;const n=e.pickScrollBar(t);if(n)return n;const i=e.getRelativeVector(t);let o=null;const s=this.getAllObjectsByOrderForPick().reverse(),r=s.length;for(let a=0;a<r;a++){const t=s[a];if(!t.visible||!t.evented||t.classType===fr.GROUP)continue;let e=i;if(t.isInGroup&&t.parent.classType===fr.GROUP){const{cumLeft:n,cumTop:i}=this._getGroupCumLeftRight(t);e=e.clone().add(aa.FromArray([-n,-i]))}if(t.isHit(e)){if(t.classType===fr.SCENE_VIEWER){const n=t.pick(e);o=n||t.getActiveSubScene()}else o=t;break}if(t.classType===fr.SCENE_VIEWER&&t.allowSelectedClipElement()){const n=t.pick(e);if(n){o=n;break}}}return o||this._parent.classType!==fr.ENGINE?o:this}on(t,e){return this[`on${t}Observer`].add(e.bind(this))}off(t,e){this[`on${t}Observer`].remove(e)}remove(t){this[`on${t}Observer`].clear()}triggerKeyDown(t){this.onKeyDownObservable.notifyObservers(t)}triggerKeyUp(t){this.onKeyUpObservable.notifyObservers(t)}triggerPointerUp(t){var e,n;return!(!(null==(e=this.onPointerUpObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===fr.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerUp(t),!1)}triggerMouseWheel(t){var e,n;return!(!(null==(e=this.onMouseWheelObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===fr.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerMouseWheel(t),!1)}triggerPointerMove(t){var e,n;return!(!(null==(e=this.onPointerMoveObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===fr.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerMove(t),!1)}triggerDblclick(t){var e,n;return!(!(null==(e=this.onDblclickObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===fr.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerDblclick(t),!1)}triggerPointerDown(t){var e,n;return!(!(null==(e=this.onPointerDownObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===fr.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerDown(t),!1)}triggerPointerOut(t){var e;return this._parent.classType!==fr.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerOut(t),!1)}triggerPointerLeave(t){var e;return this._parent.classType!==fr.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerLeave(t),!1)}triggerPointerOver(t){var e;return this._parent.classType!==fr.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerOver(t),!1)}triggerPointerEnter(t){var e;return this._parent.classType!==fr.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerEnter(t),!1)}_createDefaultLayer(t=1){const e=Sa.create(this,[],t);return this.addLayer(e),e}_resetViewportSize(){this.getViewports().forEach((t=>{t.resetSize()}))}_setTransForm(){const t=ha.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=t,this.getViewports().forEach((t=>{t.resizeScrollBar()})),this.makeDirty(!0)}_getGroupCumLeftRight(t){let e=t.parent,n=0,i=0;for(;e.classType===fr.GROUP;){const{left:t,top:o}=e;n+=t,i+=o,e=e.parent}return{cumLeft:n,cumTop:i}}}(uh=dh||(dh={}))[uh.scrollTo=0]="scrollTo",uh[uh.scrollBy=1]="scrollBy";class vh{constructor(t,e,n){var i;this.scrollX=0,this.scrollY=0,this.onMouseWheelObserver=new O,this.onScrollAfterObserver=new O,this.onScrollBeforeObserver=new O,this.onScrollStopObserver=new O,this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this._viewPortKey=t,this._scene=e,this.top=(null==n?void 0:n.top)||0,this.left=(null==n?void 0:n.left)||0,this.bottom=(null==n?void 0:n.bottom)||0,this.right=(null==n?void 0:n.right)||0,(null==n?void 0:n.width)&&(this.width=null==n?void 0:n.width,this._widthOrigin=this.width),(null==n?void 0:n.height)&&(this.height=null==n?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new Aa),this._isWheelPreventDefaultX=(null==n?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(null==n?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),null==(i=this._scene)||i.getParent().onTransformChangeObservable.add((()=>{this._resizeCacheCanvasAndScrollBar()}))}get scene(){return this._scene}get width(){return this._width}get height(){return this._height}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}set width(t){this._width=t}set height(t){this._height=t}set top(t){var e,n;this._topOrigin=t,this._top=Yr(t,null==(n=null==(e=this._scene)?void 0:e.getParent())?void 0:n.height)}set left(t){var e;this._leftOrigin=t,this._left=Yr(t,null==(e=this.scene.getParent())?void 0:e.width)}set bottom(t){var e;this._bottomOrigin=t,this._bottom=Yr(t,null==(e=this.scene.getParent())?void 0:e.height)}set right(t){var e;this._rightOrigin=t,this._right=Yr(t,null==(e=this.scene.getParent())?void 0:e.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(t){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=t,this._resizeCacheCanvasAndScrollBar()}resize(t){const e=Object.keys(t);0!==e.length&&(this._width=void 0,this._height=void 0,e.forEach((e=>{void 0!==t[e]&&(this[e]=t[e])})),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}makeDirty(t=!0){this._dirty=t}isDirty(){return this._dirty}scrollTo(t){return this._scroll(0,t)}scrollBy(t){return this._scroll(1,t)}getBarScroll(t,e){let n=t,i=e;if(this._scrollBar){n*=this._scrollBar.ratioScrollX,i*=this._scrollBar.ratioScrollY;const{scaleX:t,scaleY:e}=this.scene;n=Math.round(n)*t,i=Math.round(i)*e}else void 0!==this.scrollX&&(n=this.scrollX),void 0!==this.scrollY&&(i=this.scrollY);return{x:n,y:i}}getActualScroll(t,e){let n=t,i=e;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,i/=this._scrollBar.ratioScrollY;const{scaleX:t,scaleY:e}=this.scene;n=Math.round(n)/t,i=Math.round(i)/e}else void 0!==this.actualScrollX&&(n=this.actualScrollX),void 0!==this.actualScrollY&&(i=this.actualScrollY);return{x:n,y:i}}transformScroll(){let t=this.scrollX,e=this.scrollY;return this.getActualScroll(t,e)}getScrollBar(){return this._scrollBar}updateScroll(t){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:e,scrollY:n,actualScrollX:i,actualScrollY:o}=t;return void 0!==e&&(this.scrollX=e),void 0!==n&&(this.scrollY=n),void 0!==i&&(this.actualScrollX=i),void 0!==o&&(this.actualScrollY=o),this}getScrollBarTransForm(t=!1){const e=ha.create();return!t&&this._allowCache||e.multiply(ha.create([1,0,0,1,this._left,this._top])),e}render(t){var e;const n=t||(null==(e=this._scene.getEngine())?void 0:e.getCanvas().getContext());if(!this.isDirty()&&this._allowCache)return void this._applyCache(n);let i=this._scene.transform.clone();i.multiply(ha.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let o=n;if(!o)return;const s=this._getApplyCanvasState();s&&(i.multiply(ha.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),o=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const r=i.getMatrix(),a=this.getScrollBarTransForm().getMatrix();o.save(),!s&&this._renderClipState&&(o.beginPath(),o.rect(this.left,this.top,this.width||0,this.height||0),o.clip()),o.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._scene.renderObjects(o,this._calViewportRelativeBounding()),o.restore(),this._scrollBar&&(o.save(),o.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.drawScrollbar(o),o.restore()),s&&this._applyCache(n),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}getRelativeVector(t){const e=this.scene.transform.clone().invert(),n=this.transformScroll();return e.applyPoint(t).add(aa.FromArray([n.x,n.y]))}getAbsoluteVector(t){const e=this.scene.transform.clone(),n=this.transformScroll();return e.applyPoint(t).subtract(aa.FromArray([n.x,n.y]))}onMouseWheel(t,e){if(!this._scrollBar)return;let n;if(t.inputIndex===Hr.MouseWheelX){const i=Math.abs(t.deltaX),o=this._scene.width;let s=(this.width||1)/o*i;n=t.deltaX>0?this.scrollBy({x:s}):this.scrollBy({x:-s}),this._scene.getParent().classType===fr.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||e.stopPropagation():this._isWheelPreventDefaultX?t.preventDefault():(null==n?void 0:n.isLimitedX)||t.preventDefault()}if(t.inputIndex===Hr.MouseWheelY){const i=Math.abs(t.deltaY),o=this._scene.height;let s=(this.height||1)/o*i;t.shiftKey?(n=t.deltaY>0?this.scrollBy({x:s}):this.scrollBy({x:-s}),this._scene.getParent().classType===fr.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||e.stopPropagation():this._isWheelPreventDefaultX?t.preventDefault():(null==n?void 0:n.isLimitedX)||t.preventDefault()):(n=t.deltaY>0?this.scrollBy({y:s}):this.scrollBy({y:-s}),this._scene.getParent().classType===fr.SCENE_VIEWER?(null==n?void 0:n.isLimitedY)||e.stopPropagation():this._isWheelPreventDefaultY?t.preventDefault():(null==n?void 0:n.isLimitedY)||t.preventDefault())}t.inputIndex,Hr.MouseWheelZ}isHit(t){const{width:e,height:n}=this._getViewPortSize();return t.x>=this.left&&t.x<=this.left+e&&t.y>=this.top&&t.y<=this.top+n}pickScrollBar(t){if(!this._scrollBar)return;const e=this.getScrollBarTransForm(!0).invert().applyPoint(t);return this._scrollBar.pick(e)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var t;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),null==(t=this._scrollBar)||t.dispose()}_resizeCacheCanvasAndScrollBar(t=!1){var e;const{width:n,height:i}=this._getViewPortSize(t);this.width=n,this.height=i;const o=this._scene.width*this._scene.scaleX,s=this._scene.height*this._scene.scaleY;null==(e=this._scrollBar)||e.resize(n,i,o,s),this.makeDirty(!0)}_getViewPortSize(t=!1){var e;const n=null==(e=this._scene)?void 0:e.getParent();let i,o;if(t||void 0===this._widthOrigin){const t=n.width;i=(n.classType===fr.SCENE_VIEWER?t*n.scaleX:t)-(this._left+this._right)}else i=this._widthOrigin;if(t||void 0===this._heightOrigin){const t=n.height;o=(n.classType===fr.SCENE_VIEWER?t*n.scaleY:t)-(this._top+this._bottom)}else o=this._heightOrigin;return{width:i,height:o}}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var t,e;if(!this._scrollBar)return;const n=(null==(t=this._scrollBar)?void 0:t.limitX)||1/0,i=(null==(e=this._scrollBar)?void 0:e.limitY)||1/0;let o=!0,s=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>n?this.scrollX=n:o=!1,this.scrollY<0?this.scrollY=0:this.scrollY>i?this.scrollY=i:s=!1,{isLimitedX:o,isLimitedY:s}}_triggerScrollStop(t,e,n){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout((()=>{var i,o;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:e,y:n,actualScrollX:t.x,actualScrollY:t.y,limitX:null==(i=this._scrollBar)?void 0:i.limitX,limitY:null==(o=this._scrollBar)?void 0:o.limitY})}),0)}_scroll(t,e){var n,i,o,s;const{x:r,y:a}=e;void 0!==r&&(1===t?this.scrollX+=r:this.scrollX=r),void 0!==a&&(1===t?this.scrollY+=a:this.scrollY=a);const l=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:r,y:a,limitX:null==(n=this._scrollBar)?void 0:n.limitX,limitY:null==(i=this._scrollBar)?void 0:i.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const h=this.transformScroll();return this.actualScrollX=h.x,this.actualScrollY=h.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:r,y:a,actualScrollX:h.x,actualScrollY:h.y,limitX:null==(o=this._scrollBar)?void 0:o.limitX,limitY:null==(s=this._scrollBar)?void 0:s.limitY}),this._triggerScrollStop(h,r,a),l}_calViewportRelativeBounding(){var t,e,n,i;let o=null!=(e=null==(t=this._scrollBar)?void 0:t.ratioScrollX)?e:1,s=null!=(i=null==(n=this._scrollBar)?void 0:n.ratioScrollY)?i:1,r=this.left,a=(this.width||0)+this.left,l=this.top,h=(this.height||0)+this.top,c=0,d=0;null!=this._preScrollX&&(c=(this._preScrollX-this.scrollX)/o),null!=this._preScrollY&&(d=(this._preScrollY-this.scrollY)/s);const u={tl:aa.FromArray([r,l]),tr:aa.FromArray([a,l]),bl:aa.FromArray([r,h]),br:aa.FromArray([a,h]),dx:c,dy:d};return u.tl=this.getRelativeVector(u.tl),u.tr=this.getRelativeVector(u.tr),u.bl=this.getRelativeVector(u.bl),u.br=this.getRelativeVector(u.br),u}drawScrollbar(t){if(!this._scrollBar)return;const e=this._scene.getParent();(e.classType===fr.SCENE_VIEWER||e.classType===fr.ENGINE)&&this._scrollBar.render(t)}_applyCache(t){if(!t)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,i=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,i,this.left,this.top,this.width||0,this.height||0)}}(_h=gh||(gh={}))[_h.OFF=0]="OFF",_h[_h.ON=1]="ON",(mh=ph||(ph={}))[mh.GRID=0]="GRID";class Eh extends Gl{constructor(){super(...arguments),this.type=0}getCellIndex(t,e,n,i,o){return function(t,e,n,i,o){let{startY:s,endY:r,startX:a,endX:l}=function(t,e,n,i){const o=e-1;return{startY:n[t-1]||0,endY:n[t],startX:i[o]||0,endX:i[e]}}(t,e,n,i);const{isMerged:d,isMergedMainCell:u,newEndRow:g,newEndColumn:_,mergeRow:p,mergeColumn:m}=function(t,e,n){let i=!1,o=!1,s=-1,r=-1,a=-1,l=-1;return null==n||n.forEach(((n,h)=>{let c=!1;if(null==h||h.forEach(((n,h)=>{const{startRow:d,endRow:u,startColumn:g,endColumn:_}=h;return t===d&&e===g?(s=u,r=_,a=d,l=g,c=!0,o=!0,!1):t>=d&&t<=u&&e>=g&&e<=_?(s=u,r=_,a=d,l=g,c=!0,i=!0,!1):void 0})),c)return!1})),{isMergedMainCell:o,isMerged:i,newEndRow:s,newEndColumn:r,mergeRow:a,mergeColumn:l}}(t,e,o);let T={startRow:p,startColumn:m,endRow:g,endColumn:_,startY:0,endY:0,startX:0,endX:0};if(d&&-1!==p&&-1!==m){let t=n[p-1]||0,e=n[g],o=i[m-1]||0,s=i[_];T=c(h({},T),{startY:t,endY:e,startX:o,endX:s})}else d||-1===g||-1===_||(r=n[g]||0,l=i[_]||0);return{isMerged:d,isMergedMainCell:u,row:t,column:e,startY:s,endY:r,startX:a,endX:l,mergeInfo:T}}(t,e,n,i,o)}}Vl.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(t,e,n){const{rowTitleWidth:i,columnTitleHeight:o,dataMergeCache:s,stylesCache:r}=n,{background:a}=r;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:h,columnWidthAccumulation:c,rowTotalHeight:d}=n;if(!l||!c||void 0===h||void 0===d)return;t.save();const{scaleX:u=1,scaleY:g=1}=e;a&&Object.keys(a).forEach((e=>{const n=a[e];t.fillStyle=e||Vr([255,255,255]),t.beginPath(),n.forEach(((e,n)=>{n.forEach((n=>{let{isMerged:i,startY:o,endY:r,startX:a,endX:h}=this.getCellIndex(e,n,l,c,s);if(i)return!0;o=Jr(o,g),r=Jr(r,g),a=Jr(a,u),h=Jr(h,u),t.moveTo(a,o),t.lineTo(a,r),t.lineTo(h,r),t.lineTo(h,o)}))})),t.closePath(),t.fill()})),t.restore()}});Vl.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:o,columnTitleHeight:s,dataMergeCache:r,stylesCache:a,overflowCache:l}=n,{border:h}=a;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;t.save();const{scaleX:_=1,scaleY:p=1}=e,m=this._getScale(e);let T,f;null==h||h.forEach(((e,n)=>{null==n||n.forEach(((n,i)=>{if(!i)return!0;let{isMerged:o,startY:s,endY:a,startX:h,endX:d}=this.getCellIndex(e,n,c,u,r);if(o)return!0;s=Jr(s,p),a=Jr(a,p),h=Jr(h,_),d=Jr(d,_);for(let r in i){const{type:o,style:c,color:u}=i[r];this._getOverflowExclusion(l,o,e,n)||(c!==T&&(da(t,c),t.lineWidth=ua(c)/m,T=c),u!==f&&(t.strokeStyle=u||"rgb(0,0,0)",f=u),ca(t,o,{startX:h,startY:s,endX:d,endY:a}))}}))})),t.closePath(),t.restore()}_getOverflowExclusion(t,e,n,i){let o=!1;return e===_r.TOP||e===_r.BOTTOM||t&&t.forEach(((t,i)=>{if(t!==n)return!0;i.forEach(((t,n)=>{const{startColumn:i,endColumn:s}=n;return e===_r.LEFT&&t>i&&t<=s||e===_r.RIGHT&&t>=i&&t<s?(o=!0,!1):void 0}))})),o}});Vl.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:o=0,columnTitleHeight:s=0,dataMergeCache:r,overflowCache:a,stylesCache:l,showGridlines:h}=n,{startRow:c,endRow:d,startColumn:u,endColumn:g}=i;if(!n||h===Fe.FALSE)return;const{rowHeightAccumulation:_,columnTotalWidth:p,columnWidthAccumulation:m,rowTotalHeight:T}=n;if(!_||!m||void 0===p||void 0===T)return;t.save();const f=this._getScale(e);t.beginPath(),t.lineWidth=1/f,t.strokeStyle=Vr([217,217,217]);let v=Jr(p,f),E=Jr(T,f);const I=m.length,b=_.length;for(let A=c-1;A<=d;A++){if(A<0||A>b-1)continue;const e=Jr(_[A],f);t.moveTo(0,e),t.lineTo(v,e)}for(let A=u;A<=g;A++){if(A<0||A>I-1)continue;const e=Jr(m[A],f);t.moveTo(e,0),t.lineTo(e,E)}t.stroke(),t.closePath(),this._clearRectangle(t,f,_,m,r),this._clearRectangle(t,f,_,m,a),t.restore()}_clearRectangle(t,e,n,i,o){null==o||o.forEach(((o,s)=>{null==s||s.forEach(((o,s)=>{const{startRow:r,endRow:a,startColumn:l,endColumn:h}=s,c=Jr(n[r-1]||0,e),d=Jr(n[a],e),u=Jr(i[l-1]||0,e),g=Jr(i[h],e);t.clearRect(u,c,g-u,d-c),t.beginPath(),t.moveTo(u,c),t.lineTo(g,c),t.lineTo(g,d),t.lineTo(u,d),t.lineTo(u,c),t.stroke(),t.closePath()}))}))}});Vl.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(t,e,n){this.changeFontColor.setValue(t,e,n)}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:o,columnTitleHeight:s,stylesCache:r,dataMergeCache:a,overflowCache:l}=n,{font:h}=r;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;t.save();const _=this._getScale(e),{scaleX:p=1,scaleY:m=1}=e;h&&Object.keys(h).forEach((e=>{h[e].forEach(((e,n)=>{n.forEach(((n,i)=>{let{isMerged:o,isMergedMainCell:s,startY:r,endY:h,startX:d,endX:g,mergeInfo:T}=this.getCellIndex(e,n,c,u,a);if(o)return!0;r=Jr(r,m),h=Jr(h,m),d=Jr(d,p),g=Jr(g,p);const f=g-d,v=h-r,E=l.getValue(e,n),{horizontalAlign:I}=i;if(t.save(),t.beginPath(),E){const{startColumn:i,startRow:o,endColumn:s,endRow:a}=E;i===s&&i===n?t.rect(d,r,f,v):I===Re.CENTER?this._clipRectangle(t,o,a,i,s,_,c,u):I===Re.RIGHT?this._clipRectangle(t,o,e,i,n,_,c,u):this._clipRectangle(t,e,a,n,s,_,c,u)}else t.rect(d,r,f,v);t.clip(),t.translate(d,r),this._renderDocuments(t,i,d,r,g,h,e,n),t.restore()}))}))})),t.restore()}_renderDocuments(t,e,n,i,o,s,r,a){const l=this.getDocuments(),{documentSkeleton:h,angle:c,verticalAlign:d,horizontalAlign:u,wrapStrategy:g,content:_}=e,p=o-n,m=s-i;g===Me.WRAP&&0===c&&(h.updateDocumentDataPageSize(p),h.calculate()),h.makeDirty(!1),l.resize(p,m),l.changeSkeleton(h).render(t)}_clipRectangle(t,e,n,i,o,s,r,a){const l=Jr(r[e-1]||0,s),h=Jr(r[n],s),c=Jr(a[i-1]||0,s),d=Jr(a[o],s);t.rect(c,l,d-c,h-l)}});Yl.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:o=0,columnTitleHeight:s=0}=n,{startRow:r,endRow:a,startColumn:l,endColumn:h}=i;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;const _=this._getScale(e);t.fillStyle=Vr([248,249,250]),t.fillRect(0,0,o,g),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Vr([0,0,0]),t.beginPath(),t.lineWidth=1/_,t.strokeStyle=Vr([217,217,217]);let p=0;const m=c.length;for(let T=r-1;T<=a;T++){if(T<0||T>m-1)continue;const e=Jr(c[T],_);if(p===e)continue;t.moveTo(0,e),t.lineTo(o,e);const n=p+(e-p)/2;t.fillText(`${T+1}`,o/2,n+1),p=e}t.moveTo(Jr(o,_),0),t.lineTo(Jr(o,_),g),t.stroke()}});var Ih,bh,Ah,Ch,Sh,Nh;Xl.add(new class extends Eh{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:o=0,columnTitleHeight:s=0}=n,{startRow:r,endRow:a,startColumn:l,endColumn:h}=i;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;const _=this._getScale(e);t.fillStyle=Vr([248,249,250]),t.fillRect(0,0,d,s),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Vr([0,0,0]),t.beginPath(),t.lineWidth=1/_,t.strokeStyle=Vr([217,217,217]);let p=0;const m=u.length;for(let f=l-1;f<=h;f++){if(f<0||f>m-1)continue;const e=Jr(u[f],_);if(p===e)continue;t.moveTo(e,0),t.lineTo(e,s);const n=p+(e-p)/2;t.fillText(ii(f),n,s/2+1),p=e}const T=Jr(s,_);t.moveTo(0,T),t.lineTo(d,T),t.stroke()}}),(bh=Ih||(Ih={}))[bh.NORMAL=0]="NORMAL",bh[bh.ROW=1]="ROW",bh[bh.COLUMN=2]="COLUMN",(Ch=Ah||(Ah={})).Selection="__SpreadsheetSelectionShape__",Ch.top="__SpreadsheetSelectionTopControl__",Ch.bottom="__SpreadsheetSelectionBottomControl__",Ch.left="__SpreadsheetSelectionShapeLeftControl__",Ch.right="__SpreadsheetSelectionShapeRightControl__",Ch.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",Ch.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",Ch.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",Ch.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",Ch.fill="__SpreadsheetSelectionFillControl__",Ch.lineMain="__SpreadsheetDragLineMainControl__",Ch.lineContent="__SpreadsheetDragLineContentControl__",Ch.line="__SpreadsheetDragLineControl__",(Nh=Sh||(Sh={})).LEFT="__slideNavigationLeft__",Nh.RIGHT="__slideNavigationRight__";class Rh extends Ms{constructor(){super(nn.BASE_RENDER),this._engine=new Ca}static create(){return new Rh}installTo(t){t.install(this)}getEngine(){return this._engine}}var wh,Oh,yh={spreadsheetLabel:"插件",spreadsheetRightLabel:"更多 Sheets",spreadsheet:{one:"一",two:"二",three:"三"},toolbar:{undo:"撤销",redo:"重做",paintFormat:"格式刷",currencyFormat:"货币格式",percentageFormat:"百分比格式",numberDecrease:"减少小数位数",numberIncrease:"增加小数位数",moreFormats:"更多格式",font:"字体",fontSize:"字号大小",bold:"粗体 (Ctrl+B)",italic:"斜体 (Ctrl+I)",strikethrough:"删除线 (Alt+Shift+5)",underline:"下划线",textColor:{main:"文本颜色",right:"颜色选择"},resetColor:"重置颜色",customColor:"自定义",alternatingColors:"交替颜色",confirmColor:"确定颜色",cancelColor:"取消",collapse:"收起",fillColor:{main:"单元格颜色",right:"颜色选择"},border:{main:"边框",right:"边框类型"},mergeCell:{main:"合并单元格",right:"选择合并类型"},horizontalAlignMode:{main:"水平对齐",right:"对齐方式"},verticalAlignMode:{main:"垂直对齐",right:"对齐方式"},textWrapMode:{main:"文本换行",right:"换行方式"},textRotateMode:{main:"文本旋转",right:"旋转方式"},freezeTopRow:"冻结首行",sortAndFilter:"排序和筛选",findAndReplace:"查找替换",sum:"求和",autoSum:"自动求和",moreFunction:"更多函数",conditionalalFormat:"条件格式",comment:"批注",pivotTable:"数据透视表",chart:"图表",screenshot:"截图",splitColumn:"分列",insertImage:"插入图片",insertLink:"插入链接",dataValidation:"数据验证",protection:"保护工作表内容",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",toolMore:"更多",toolLess:"少于",toolClose:"收起",toolMoreTip:"更多功能",moreOptions:"更多选项",cellFormat:"设置单元格格式",print:"打印",borderMethod:{top:"上框线",bottom:"下框线",left:"左框线",right:"右框线"},more:"更多"},defaultFmt:{Automatic:{text:"自动",value:"General",example:""},Number:{text:"数字",value:"##0.00",example:"1000.12"},Percent:{text:"百分比",value:"#0.00%",example:"12.21%"},PlainText:{text:"纯文本",value:"@",example:""},Scientific:{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"万元",value:"w",example:"1亿2000万2500"},Currency:{text:"货币",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"时间24H",value:"hh:mm",example:"15:00"},DateTime:{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"自定义格式",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"更多货币格式",moreDateTime:"更多日期与时间格式",moreNumber:"更多数字格式",titleCurrency:"货币格式",decimalPlaces:"小数位数",titleDateTime:"日期与时间格式",titleNumber:"数字格式"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"微软雅黑",SimSun:"宋体",SimHei:"黑体",Kaiti:"楷体",FangSong:"仿宋",NSimSun:"新宋体",STXinwei:"华文新魏",STXingkai:"华文行楷",STLiti:"华文隶书",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"常规视图",layoutBtn:"页面布局",pageBtn:"分页预览",menuItemPrint:"打印(Ctrl+P)",menuItemAreas:"打印区域",menuItemRows:"打印标题行",menuItemColumns:"打印标题列"},align:{left:"左对齐",center:"中间对齐",right:"右对齐",top:"顶部对齐",middle:"居中对齐",bottom:"底部对齐"},button:{confirm:"确定",cancel:"取消",close:"关闭",update:"Update",delete:"Delete",insert:"新建",prevPage:"上一页",nextPage:"下一页",total:"总共："},punctuation:{tab:"Tab 键",semicolon:"分号",comma:"逗号",space:"空格"},colorPicker:{collapse:"收起",customColor:"自定义",change:"切换",confirmColor:"确定",cancelColor:"取消"},borderLine:{borderTop:"上框线",borderBottom:"下框线",borderLeft:"左框线",borderRight:"右框线",borderNone:"无",borderAll:"所有",borderOutside:"外侧",borderInside:"内侧",borderHorizontal:"内侧横线",borderVertical:"内侧竖线",borderColor:"边框颜色",borderSize:"边框粗细"},merge:{all:"全部合并",vertical:"垂直合并",horizontal:"水平合并",cancel:"取消合并",overlappingError:"不能合并重叠区域",partiallyError:"无法对部分合并单元格执行此操作"},textWrap:{overflow:"溢出",wrap:"自动换行",clip:"截断"},textRotate:{none:"无旋转",angleUp:"向上倾斜",angleDown:"向下倾斜",vertical:"竖排文字",rotationUp:"向上90°",rotationDown:"向下90°"},sheetConfig:{delete:"删除",copy:"复制",rename:"重命名",changeColor:"更改颜色",hide:"隐藏",unhide:"取消隐藏",moveLeft:"向左移",moveRight:"向右移",resetColor:"重置颜色",cancelText:"取消",chooseText:"确定颜色",tipNameRepeat:"标签页的名称不能重复！请重新修改",noMoreSheet:"工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",confirmDelete:"是否删除",redoDelete:"可以通过Ctrl+Z撤销删除",noHide:"不能隐藏, 至少保留一个sheet标签",chartEditNoOpt:"图表编辑模式下不允许该操作！",sheetNameSpecCharError:"名称不能超过31个字符，首尾不能是' 且名称不能包含:\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"名称不能为空!"},rightClick:{copy:"复制",copyAs:"复制为",paste:"粘贴",insert:"插入",delete:"删除",deleteCell:"删除单元格",deleteSelected:"删除选中",hide:"隐藏",hideSelected:"隐藏选中",showHide:"显示隐藏",to:"向",left:"左",right:"右",top:"上",bottom:"下",moveLeft:"左移",moveUp:"上移",add:"增加",row:"行",column:"列",width:"宽",height:"高",number:"数字",confirm:"确认",orderAZ:"A-Z顺序排列",orderZA:"Z-A降序排列",clearContent:"清除内容",matrix:"矩阵操作选区",sortSelection:"排序选区",filterSelection:"筛选选区",chartGeneration:"图表生成",firstLineTitle:"首行为标题",untitled:"无标题",array1:"一维数组",array2:"二维数组",array3:"多维数组",diagonal:"对角线",antiDiagonal:"反对角线",diagonalOffset:"对角偏移",offset:"偏移量",boolean:"布尔值",flip:"翻转",upAndDown:"上下",leftAndRight:"左右",clockwise:"顺时针",counterclockwise:"逆时针",transpose:"转置",matrixCalculation:"矩阵计算",plus:"加",minus:"减",multiply:"乘",divided:"除",power:"次方",root:"次方根",log:"log",delete0:"删除两端0值",removeDuplicate:"删除重复值",byRow:"按行",byCol:"按列",generateNewMatrix:"生成新矩阵"},info:{detailUpdate:"新打开",detailSave:"已恢复本地缓存",row:"行",column:"列",loading:"渲染中···",copy:"副本",return:"返回",rename:"重命名",tips:"重命名",noName:"无标题的电子表格",wait:"待更新",add:"添加",addLast:"在底部添加",backTop:"回到顶部",pageInfo:"共${total}条，${totalPage}页，当前已显示${currentPage}页",nextPage:"下一页",tipInputNumber:"请输入数字",tipInputNumberLimit:"增加范围限制在1-100",tipRowHeightLimit:"行高必须在0 ~ 545之间",tipColumnWidthLimit:"列宽必须在0 ~ 2038之间",pageInfoFull:"共${total}条，${totalPage}页，已显示全部数据"}},Mh={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1亿2000万2500"},Currency:{text:"Currency",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page break preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}，${totalPage} page，current ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}，${totalPage} page，All data displayed"}};class Dh{constructor(t){this._plugin=t}}class Lh{constructor(t){this._plugin=t,this._previousIMEContent="",this._initialize()}_initialize(){const t=this._plugin.getInputEvent();if(!t)return;const{onInputObservable:e,onCompositionstartObservable:n,onCompositionupdateObservable:i,onCompositionendObservable:o,onKeydownObservable:s}=t,r=this._plugin.context.getDocument();s.add((t=>{const{event:e,document:n,activeSelection:i,selectionList:o}=t;let s=e;const a=null==i?void 0:i.getRange(),l=null==i?void 0:i.segmentId,h=n.getSkeleton();if(!h||!a)return;const{cursorStart:c,cursorEnd:d,isCollapse:u,isEndBack:g,isStartBack:_}=a;if(s.key===ge.backspace){let t=c;!0===_&&(t-=1),!1===u&&(t+=1);const e=n.remainActiveSelection();r.deleteText(a,l),h.calculate();const i=n.findNodeByCharIndex(t-1);this._adjustSelection(n,e,i),this._resetIME()}})),e.add((t=>{const{event:e,content:n="",document:i,activeSelection:o,selectionList:s}=t,a=null==o?void 0:o.getRange(),l=i.getSkeleton(),h=null==o?void 0:o.segmentId;if(!l||!a)return;const{cursorStart:c,cursorEnd:d,isCollapse:u,isEndBack:g,isStartBack:_}=a;if(u){let t=c;!1===_&&(t+=1);const e=i.remainActiveSelection();r.insertText(n,a,h),l.calculate();const o=i.findNodeByCharIndex(t+n.length-1);this._adjustSelection(i,e,o)}})),n.add((t=>{const{activeSelection:e,selectionList:n}=t,i=null==e?void 0:e.getRange();if(!i)return;const{cursorStart:o,cursorEnd:s,isCollapse:r,isEndBack:a,isStartBack:l}=i;let h=o;!1===l&&(h+=1),this._previousIMEStart=h})),i.add((t=>{const{event:e,document:n}=t;let i=this._previousIMEStart-1;const o=n.getSkeleton();if(!o)return;const s=e,a=s.data;if(a===this._previousIMEContent)return;const l=n.remainActiveSelection();r.updateText(a,this._previousIMEContent,i),o.calculate();const h=n.findNodeByCharIndex(i+a.length);this._adjustSelection(n,l,h),console.log("Compositionupdate",a,this._previousIMEContent,s.data,this._previousIMEStart,i,l,h,o.getSkeletonData(),o),this._previousIMEContent=a})),o.add((t=>{this._resetIME()}))}_resetIME(){this._previousIMEContent="",this._previousIMEStart=-1}_getIncreaseText(t,e){const n=e.length;return t.slice(n)}_adjustSelection(t,e,n){if(null==n)return;const i=t.findPositionBySpan(n);if(null==i||null==e)return;this._hasListSpan(n)&&(i.span+=1);const o=c(h({},i),{isBack:!1});t.addSelection(e),e.startNodePosition=o,e.endNodePosition=void 0,e.refresh(t),t.syncSelection()}_hasListSpan(t){var e;const n=null==t?void 0:t.parent;if(null==n)return!1;return(null==(e=n.spanGroup[0])?void 0:e.spanType)===wr.LIST}}class xh{constructor(t,e={}){this._plugin=t,this._config=e,this._initialize()}_initialize(){this._inputController=new Lh(this._plugin)}}class kh{constructor(t){this._plugin=t}}class Hh{constructor(){this.zIndex=0,this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(){}initialize(t,e){return this._scene=t,this._plugin=e,this._initialize(),this}_initialize(){}}(Oh=wh||(wh={})).MAIN_SCENE="mainScene",Oh.DOCS_VIEW="docsView";const Ph=Bs.create();var Bh;(Bh||(Bh={})).MAIN="__DocsRender__";Ph.add(new class extends Hh{constructor(){super(...arguments),this.zIndex=1,this.viewKey=wh.DOCS_VIEW}getDocumentSkeleton(){return this._documentSkeleton}getDocs(){return this._documents}_initialize(){const t=this.getScene(),e=this.getContext().getDocument(),n=this._buildSkeleton(e.getSnapshot()),i=new sh(Bh.MAIN,n);i.zIndex=1e3,this._documentSkeleton=n,this._documents=i,n.calculate(),t.addObjects([i],0);const o=n.getSkeletonData().pages,{pageMarginLeft:s,pageMarginTop:r,docsLeft:a,docsTop:l}=i.calculatePagePosition();for(let h=0;h<o.length;h++)for(let t of o[h].skeDrawings.keys()){const e=this.getScene().getObject(t);null==e||e.translate(e.left+a-s,e.top+l-r)}i.enableEditor()}_buildSkeleton(t){const e=this.getContext();return Ul.create(t,e)}});Ph.add(new class extends Hh{constructor(){super(...arguments),this.zIndex=2,this.viewKey="page_view_background"}_initialize(){var t;const e=this.getScene();this.getContext();const n=e.getObject(Bh.MAIN),i=null==(t=n.getSkeleton())?void 0:t.getPageSize();n.onPageRenderObservable.add((t=>{const{page:e,pageLeft:n,pageTop:o,ctx:s}=t,{width:r,height:a,marginBottom:l,marginLeft:h,marginRight:c,marginTop:d}=e;s.save(),s.translate(n-.5,o-.5),La.drawWith(s,{width:(null==i?void 0:i.width)||r,height:(null==i?void 0:i.height)||a,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),s.restore()}))}});Ph.add(new class extends Hh{constructor(){super(...arguments),this.zIndex=3,this.viewKey="drawings_view_background",this._liquid=new ql}_initialize(){var t;const e=this.getScene();this.getContext();const n=e.getObject(Bh.MAIN),i=n.getSkeleton(),o=null==i?void 0:i.getSkeletonData();if(!o)return;const{left:s,top:r}=n,{pages:a}=o,l=[],h=new Map;for(let c=0,d=a.length;c<d;c++){const t=a[c],{skeDrawings:e,marginLeft:i,marginTop:o,pageWidth:d,pageHeight:u}=t;this._liquid.translatePagePadding(t),e.forEach((t=>{var e;const{aLeft:n,aTop:i,height:o,width:a,drawingOrigin:c}=t,{objectProperties:d}=c,u=new Pa(t.objectId,{url:(null==(e=d.imageProperties)?void 0:e.contentUrl)||"",left:n+s+this._liquid.x,top:i+r+this._liquid.y,width:a,height:o,zIndex:11,isTransformer:!0});h.set(t.objectId,{marginLeft:this._liquid.x,marginTop:this._liquid.y}),l.push(u)})),this._liquid.translatePage(t,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}e.openTransformer(),e.addObjects(l),null==(t=e.getTransformer())||t.onChangingObservable.add((t=>{const{objects:e}=t,{docsLeft:o,docsTop:s}=n;e.forEach((t=>{const{oKey:e,left:n,top:r,height:a,width:l}=t,c=h.get(e),d=(null==c?void 0:c.marginLeft)||0,u=(null==c?void 0:c.marginTop)||0;null==i||i.updateDrawing(e,{left:n-o-d,top:r-s-u,height:a,width:l})})),null==i||i.calculate()})),e.closeTransformer()}});class Fh{constructor(t,e){this._engine=t,this._plugin=e,this._views=[],this._initialize()}getView(t){for(let e of this._views)if(e.viewKey===t)return e}getDocsView(){return this.getView(wh.DOCS_VIEW)}_initialize(){const t=this._engine;this._plugin.getContext();const e=new fh(wh.MAIN_SCENE,t,{width:1200,height:2e3});this._scene=e;const n=new vh(wh.DOCS_VIEW,e,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});e.addViewport(n).attachControl(),e.on(sr.wheel,((t,i)=>{const o=t;if(o.ctrlKey){const t=Math.abs(o.deltaX);let n=t<40?.2:t<80?.4:.2;n*=o.deltaY>0?-1:1,e.scaleX<1&&(n/=2),e.scaleX+n>4?e.scale(4,4):e.scaleX+n<.1?e.scale(.1,.1):(o.deltaY,o.preventDefault())}else n.onMouseWheel(o,i)})),new Ha(n),e.addLayer(Sa.create(e,[],0),Sa.create(e,[],2)),this._viewLoader(e,this._plugin),t.runRenderLoop((()=>{e.render();const n=document.getElementById("app");n&&(n.innerText=`fps:${Math.round(t.getFps()).toString()}`)}))}_viewLoader(t,e){Ph.getData().sort(ri).forEach((n=>{this._views.push(n.initialize(t,e))}))}}const Uh={};class zh extends Ms{constructor(t={}){super(nn.DOCUMENT),this._config=Object.assign(Uh,t)}static create(t){return new zh(t)}installTo(t){t.installPlugin(this)}initialize(t){var e;this.context=t,this.getGlobalContext().getLocale().load({en:Mh,zh:yh}),(e=this).pushToObserve("onAfterChangeFontFamilyObservable"),e.pushToObserve("onAfterChangeFontSizeObservable"),e.pushToObserve("onAfterChangeFontWeightObservable"),e.pushToObserve("onAfterChangeFontItalicObservable"),e.pushToObserve("onAfterChangeFontStrikethroughObservable"),e.pushToObserve("onAfterChangeFontUnderlineObservable"),e.pushToObserve("onAfterChangeFontBackgroundObservable"),e.pushToObserve("onAfterChangeFontColorObservable"),e.pushToObserve("onDragAndDropStartObserver"),e.pushToObserve("onDragAndDroppingObserver"),e.pushToObserve("onDragAndDropEndEndObserver"),e.pushToObserve("onFillStartObserver"),e.pushToObserve("onFillingObserver"),e.pushToObserve("onFillEndObserver"),e.pushToObserve("onChangeCurrentSheetObserver"),e.pushToObserve("onSheetBarDidMountObservable"),e.pushToObserve("onCountBarDidMountObservable"),e.pushToObserve("onInfoBarDidMountObservable"),e.pushToObserve("onRightMenuDidMountObservable"),e.pushToObserve("onSpreadsheetKeyDownObservable"),e.pushToObserve("onSpreadsheetKeyUpObservable"),e.pushToObserve("onSpreadsheetKeyCopyObservable"),e.pushToObserve("onSpreadsheetKeyPasteObservable"),e.pushToObserve("onSpreadsheetKeyCutObservable"),e.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),e.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),e.pushToObserve("onSpreadsheetKeyCompositionEndObservable"),this.listenEventManager()}initializeAfterUI(){this.initCanvasView(),this.initController()}initController(){this._toolbarControl=new Dh(this),this._infoBarControl=new kh(this),this._documentController=new xh(this,this._config)}initCanvasView(){var t;const e=null==(t=this.getContext().getUniver().getGlobalContext().getPluginManager().getPluginByName(nn.BASE_RENDER))?void 0:t.getEngine();this._canvasEngine=e,null==this._canvasView&&(this._canvasView=new Fh(e,this))}listenEventManager(){this._getCoreObserver("onUIDidMountObservable").add((({name:t,value:e})=>{this.initializeAfterUI()}))}getConfig(){return this._config}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(wh.MAIN_SCENE)}getDocsView(){return this.getCanvasView().getDocsView()}getMainComponent(){return this.getDocsView().getDocs()}getInputEvent(){return this.getMainComponent().getEditorInputEvent()}getDocumentController(){return this._documentController}getToolbarControl(){return this._toolbarControl}getInfoBarControl(){return this._infoBarControl}onMounted(t){this.initialize(t)}onDestroy(){}_getCoreObserver(t){return this.getGlobalContext().getObserverManager().requiredObserver(t,"core")}}At.COLUMN,St.PARAGRAPH,at.WRAP_SQUARE,Fe.FALSE,st.BOTH_SIDES,Y.START,Y.START,Y.START,Y.START,G.ROMAN,Y.START,G.ROMAN,Y.START,G.ROMAN,j.PARAGRAPH,it.TEXT_RUN,it.DRAWING,it.TEXT_RUN,Pe.SUPERSCRIPT,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN;const Wh={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:j.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"在“第1题”工作表中完成以下操作",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"twoElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"上标",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Pe.SUPERSCRIPT}}},{eId:"twoElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"日期列单元格数据验证，限制只能输入日期（介于1949年1月1日至2099年1月1日）",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};pe.EN,Fe.FALSE,Gt.MEDIUM_DASHED,Gt.MEDIUM_DASHED,Gt.THICK,Gt.THIN,Re.RIGHT,Oe.TOP,Re.RIGHT,Oe.MIDDLE,Me.WRAP,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Me.WRAP,Ie.GRID,U.deepClone(Wh),Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Ie.GRID,Ie.GRID,Ie.GRID,Ie.GRID,Ie.GRID,pe.EN,Fe.FALSE,Gt.MEDIUM_DASHED,Gt.MEDIUM_DASHED,Gt.THICK,Gt.THIN,Re.RIGHT,Oe.TOP,Me.WRAP,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Ie.GRID,U.deepClone(Wh),Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Ie.GRID;const Gh={unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Y.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"●",hanging:21,indentStart:21},{bulletAlignment:Y.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"■",hanging:21,indentStart:42},{bulletAlignment:Y.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"◆",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Y.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:G.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Y.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:G.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Y.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:G.ROMAN,hanging:21,indentStart:63}]}},Vh={id:"d",lists:Gh,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:j.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:it.TEXT_RUN,tr:{ct:"What’s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:Fe.TRUE,fs:16,cl:{rgb:"rgb(255,255,255)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:it.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:12,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:it.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p4",st:402,ed:429,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:it.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:it.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:12,bl:Fe.TRUE}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:it.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:12,bl:Fe.TRUE}}}]}},{blockId:"p5",st:430,ed:479,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:it.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:it.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:12,cl:{rgb:"rgb(0, 0, 0)"},bl:Fe.TRUE}}}]}},{blockId:"p6",st:480,ed:510,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:it.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};j.PARAGRAPH,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN;pe.EN,Fe.FALSE,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,pe.EN,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,pe.EN,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE;j.PARAGRAPH,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN,it.PAGE_BREAK,it.TEXT_RUN;pe.EN,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE;j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN;pe.EN,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Ie.GRID,Fe.FALSE,Fe.FALSE,Fe.FALSE,Fe.FALSE,pe.EN,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,pe.EN,Fe.FALSE,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THICK,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,Gt.THIN,pe.EN,Fe.FALSE,pe.EN,Fe.FALSE;const Yh={id:"workbook-01",theme:"default",locale:pe.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:Fe.FALSE,extensions:[],sheetOrder:["sheet-0001"],pluginMeta:{},styles:{1:{vt:2,ht:2,bl:1,fs:14,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"}},2:{vt:2,ht:2,bl:1,fs:20,bg:{rgb:"rgb(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"},fs:14,ht:2,bd:{t:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{fs:12,vt:2,pd:{l:5},ht:2,bd:{t:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},5:{ht:2,vt:2,bd:{t:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},6:{ht:1,vt:2,tb:3,bg:{rgb:"rgba(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Gt.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:Ie.GRID,id:"sheet-0001",name:"sheet-0001",tabColor:"blue",hidden:Fe.FALSE,freezeColumn:1,rowCount:12,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,cellData:{1:{1:{v:"Variants",s:"2"},2:{v:"Platform",s:"2"},3:{v:"UGC Buzz volume",s:"2"},9:{p:Vh,s:"6"}},2:{3:{v:"Jul'21",s:"1"},4:{v:"Aug'21",s:"1"},5:{v:"Sep'21",s:"1"},6:{v:"Oct'21",s:"1"},7:{v:"Nov'21",s:"1"},8:{v:"Dec'21",s:"1"}},3:{1:{v:"Eleva",s:"3"},2:{v:"Amazon",s:"4"},3:{v:"4",s:"5"},4:{v:"145",s:"5"},5:{v:"44",s:"5"},6:{v:"20",s:"5"},7:{v:"7",s:"5"},8:{v:"12",s:"5"}},4:{2:{v:"Google",s:"4"},3:{v:"2",s:"5"},4:{v:"6",s:"5"},5:{v:"5",s:"5"},6:{v:"6",s:"5"},7:{v:"12",s:"5"},8:{v:"3113",s:"5"}},5:{2:{v:"Amazon",s:"4"},3:{v:"14",s:"5"},4:{v:"13",s:"5"},5:{v:"6",s:"5"},6:{v:"6",s:"5"},7:{v:"11",s:"5"},8:{v:"2",s:"5"}},6:{1:{v:"Similac",s:"3"},2:{v:"SaleForce",s:"4"},3:{v:"451",s:"5"},4:{v:"255",s:"5"},5:{v:"72",s:"5"},6:{v:"23",s:"5"},7:{v:"163",s:"5"},8:{v:"22",s:"5"}},7:{2:{v:"Oracle",s:"4"},3:{v:"0",s:"5"},4:{v:"1",s:"5"},5:{v:"1136",s:"5"},6:{v:"11",s:"5"},7:{v:"2",s:"5"},8:{v:"1",s:"5"}},8:{2:{v:"Apple",s:"4"},3:{v:"7",s:"5"},4:{v:"2",s:"5"},5:{v:"10",s:"5"},6:{v:"5",s:"5"},7:{v:"6",s:"5"},8:{v:"3",s:"5"}},9:{1:{v:"TC",s:"3"},2:{v:"IBM",s:"4"},3:{v:"1",s:"5"},4:{v:"12",s:"5"},5:{v:"2",s:"5"},6:{v:"1",s:"5"},7:{v:"1",s:"5"},8:{v:"1",s:"5"}},10:{2:{v:"Google",s:"4"},3:{v:"26",s:"5"},4:{v:"33",s:"5"},5:{v:"33",s:"5"},6:{v:"6",s:"5"},7:{v:"22",s:"5"},8:{v:"8",s:"5"}}},mergeData:[{startRow:1,endRow:2,startColumn:1,endColumn:1},{startRow:1,endRow:2,startColumn:2,endColumn:2},{startRow:1,endRow:1,startColumn:3,endColumn:8},{startRow:3,endRow:5,startColumn:1,endColumn:1},{startRow:6,endRow:8,startColumn:1,endColumn:1},{startRow:9,endRow:10,startColumn:1,endColumn:1},{startRow:1,endRow:10,startColumn:9,endColumn:10}],rowData:{0:{h:20}},columnData:{0:{w:20},2:{w:120},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:Fe.FALSE},columnTitle:{height:20,hidden:Fe.FALSE},selections:["A2"],rightToLeft:Fe.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]};At.COLUMN,St.PARAGRAPH,at.WRAP_SQUARE,Fe.FALSE,st.BOTH_SIDES,j.PARAGRAPH,it.TEXT_RUN,it.DRAWING,it.TEXT_RUN,Pe.SUPERSCRIPT,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.PARAGRAPH,it.TEXT_RUN,it.TEXT_RUN,j.SECTION_BREAK,J.NONE,q.SECTION_TYPE_UNSPECIFIED;const Xh={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:222.6,height:129.6},positionH:{relativeFrom:At.COLUMN,posOffset:130},positionV:{relativeFrom:St.PAGE,posOffset:510},angle:0,imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/gartner-tech-2022.png"}},layoutType:at.WRAP_SQUARE,behindDoc:Fe.FALSE,wrapText:st.BOTH_SIDES},shapeTest2:{objectId:"shapeTest2",objectProperties:{title:"test shape",description:"test shape",size:{width:254.8,height:234.3},positionH:{relativeFrom:At.COLUMN,posOffset:130},positionV:{relativeFrom:St.PAGE,posOffset:200},angle:0,imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/hype-cycle-for-emerging-tech-2022.png"}},layoutType:at.WRAP_SQUARE,behindDoc:Fe.FALSE,wrapText:st.BOTH_SIDES}},lists:Gh,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:j.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:it.TEXT_RUN,tr:{ct:"What’s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:Fe.TRUE,fs:24,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:it.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:18,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:it.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:16}}}]}},{blockId:"p4",st:402,ed:429,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:it.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:16}}}]}},{blockId:"p5",st:430,ed:479,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:it.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:16}}}]}},{blockId:"p6",st:480,ed:510,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:it.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:16}}}]}},{blockId:"p7",st:511,ed:705,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:511,ed:672,et:it.TEXT_RUN,tr:{ct:"These technologies are expected to greatly impact business and society over the next two to 10 years, but will especially enable CIOs and IT leaders to deliver on",ts:{fs:16}}},{eId:"e2",st:673,ed:705,et:it.TEXT_RUN,tr:{ct:"digital business transformation. ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:Fe.TRUE}}}]}},{blockId:"p8",st:706,ed:762,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20},elements:[{eId:"e1",st:706,ed:762,et:it.TEXT_RUN,tr:{ct:"Three Hype Cycle themes to think about in 2022 and beyond",ts:{fs:24,cl:{rgb:"rgb(255,255,255)"},bg:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p9",st:763,ed:1233,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:763,ed:1233,et:it.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle features emerging technologies and distills insights from more than 2,000 technologies into a succinct high-potential set. Most technologies have multiple use cases but enterprise architecture and technology innovation leaders should prioritize those with the greatest potential benefit for their organization. (They will also need to launch a proof-of-concept project to demonstrate the feasibility of a technology for their target use case.)",ts:{fs:16}}},{eId:"shapeTest1",st:0,ed:0,et:it.DRAWING}]}},{blockId:"oneSectionBreak",st:0,ed:0,blockType:j.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:J.NONE,sectionType:q.SECTION_TYPE_UNSPECIFIED}},{blockId:"p10",st:1234,ed:1576,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1234,ed:1576,et:it.TEXT_RUN,tr:{ct:"The benefit of these technologies is that they provide individuals with more control over their identities and data, and expand their range of experiences into virtual venues and ecosystems that can be integrated with digital currencies. These technologies also provide new ways to reach customers to strengthen or open up new revenue streams.",ts:{fs:16}}}]}},{blockId:"p11",st:1577,ed:1972,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1577,ed:1972,et:it.TEXT_RUN,tr:{ct:"Digital twin of the customer (DToC) is a dynamic virtual representation of a customer that simulates and learns to emulate and anticipate behavior. It can be used to modify and enhance the customer experience (CX) and support new digitalization efforts, products, services and opportunities. DToC will take five to 10 years until mainstream adoption but will be transformational to organizations.",ts:{fs:16}}}]}},{blockId:"p12",st:1973,ed:2047,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1973,ed:2047,et:it.TEXT_RUN,tr:{ct:"Other critical technologies in immersive experiences include the following:",ts:{fs:16}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:it.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:Fe.TRUE}}},{eId:"e2",st:2071,ed:2278,et:it.TEXT_RUN,tr:{ct:"(DCI) allows an entity (typically a human user) to control their own digital identity by leveraging technologies such as blockchain or other distributed ledger technologies (DLTs), along with digital wallets.",ts:{fs:16}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:it.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:Fe.TRUE}}},{eId:"e2",st:2294,ed:2421,et:it.TEXT_RUN,tr:{ct:"are interactive, AI-driven representations that have some of the characteristics, personality, knowledge and mindset of a human.",ts:{fs:16}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:j.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:it.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 0)"},bl:Fe.TRUE}}},{eId:"e2",st:2451,ed:2610,et:it.TEXT_RUN,tr:{ct:"match internal employees and, in some cases, a pool of contingent workers, to time-boxed projects and various work opportunities, with no recruiter involvement.",ts:{fs:16}}}]}},{blockId:"twoSectionBreak",st:0,ed:0,blockType:j.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:5}],columnSeparatorType:J.NONE,sectionType:q.SECTION_TYPE_UNSPECIFIED}}]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}};rn.SLIDE,ln.IMAGE,ln.SHAPE,je.RECTANGLE,ln.TEXT,ln.SHAPE,je.RECTANGLE,ln.TEXT,ln.TEXT;const jh={id:"catalog_1",pageType:rn.SLIDE,zIndex:2,title:"catalog",description:"this is second page, catalog",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:3,left:180,top:240,width:200,height:40,title:"Catalog",description:"",type:ln.TEXT,richText:{text:"Catalog",fs:42,cl:{rgb:"rgb(255,255,255)"}}},centerRect1:{id:"centerRect1",zIndex:2,left:140,top:168,width:203,height:203,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},firstRect1:{id:"firstRect1",zIndex:2,left:547,top:115,width:44,height:44,title:"index1",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},secondRect1:{id:"secondRect1",zIndex:2,left:547,top:210,width:44,height:44,title:"index2",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},thirdRect1:{id:"thirdRect1",zIndex:2,left:547,top:304,width:44,height:44,title:"index2",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},forth1:{id:"forth1",zIndex:2,left:547,top:397,width:44,height:44,title:"index2",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},first_index1:{id:"first_index1",zIndex:3,left:557,top:120,width:44,height:44,title:"mask",description:"",type:ln.TEXT,richText:{text:"01",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},first_title1:{id:"first_title1",zIndex:3,left:610,top:115,width:248,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"Strategic technology trends",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},first_detail1:{id:"first_detail1",zIndex:3,left:610,top:140,width:300,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"How they impact business goals.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},second_index1:{id:"second_index1",zIndex:3,left:557,top:215,width:44,height:44,title:"mask",description:"",type:ln.TEXT,richText:{text:"02",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},second_title1:{id:"second_title1",zIndex:3,left:610,top:210,width:248,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"Technical profile",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},second_detail1:{id:"second_detail1",zIndex:3,left:610,top:235,width:300,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"What the technologies are and do.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},third_index1:{id:"third_index1",zIndex:3,left:557,top:310,width:44,height:44,title:"mask",description:"",type:ln.TEXT,richText:{text:"03",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},third_title1:{id:"third_title1",zIndex:3,left:610,top:305,width:248,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"Opportunities",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},third_detail1:{id:"third_detail1",zIndex:3,left:610,top:330,width:300,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"What benefits and outcomes they drive.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},forth_index1:{id:"forth_index1",zIndex:3,left:557,top:405,width:44,height:44,title:"mask",description:"",type:ln.TEXT,richText:{text:"04",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},forth_title1:{id:"forth_title1",zIndex:3,left:610,top:400,width:248,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"Implementation steps",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},forth_detail1:{id:"forth_detail1",zIndex:3,left:610,top:425,width:300,height:39,title:"mask",description:"",type:ln.TEXT,richText:{text:"Action plans for implementation.",fs:14,cl:{rgb:"rgb(255,255,255)"}}}}},Kh={id:"detailContent1",zIndex:3,left:53,top:363,width:273,height:54,title:"detailContent1",description:"",type:ln.TEXT,richText:{rich:{id:"d",lists:Gh,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"Digital Immune System",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"Applied Observability",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},$h={id:"detailContent2",zIndex:3,left:334,top:363,width:273,height:120,title:"detailContent2",description:"",type:ln.TEXT,richText:{rich:{id:"d",lists:Gh,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"combine SaaS, PaaS and IaaS with tailored",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"provides a curated set of tools, capabilities and processes that are packaged for easy consumption by developers and end users",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},Zh={id:"detailContent3",zIndex:3,left:652,top:363,width:273,height:130,title:"detailContent3",description:"",type:ln.TEXT,richText:{rich:{id:"d",lists:Gh,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"SuperApps are more than composite applications that aggregate services.",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:j.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:it.TEXT_RUN,tr:{ct:"Adaptive AI allows for model behavior change post-deployment by using real-time feedback",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},qh={id:"strategic_1",pageType:rn.SLIDE,zIndex:1,title:"cover",description:"this is third page, strategic",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:ln.TEXT,richText:{text:"Strategic technology trends",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:ln.TEXT,richText:{text:"We expect the 2023 trends to impact enterprise strategies in the coming three years by enabling organizations to address four key priorities:",fs:18,cl:{rgb:"rgb(127,127,127)"}}},chart1:{id:"chart1",zIndex:2,left:53,top:214,width:125,height:58,title:"chart1",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(105,126,146)"}}}},chartTitle1:{id:"chartTitle1",zIndex:3,left:53,top:186,width:84,height:28,title:"chartTitle1",description:"",type:ln.TEXT,richText:{text:"Optimize",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber1:{id:"chartNumber1",zIndex:3,left:63,top:230,width:61,height:36,title:"chartNumber1",description:"",type:ln.TEXT,richText:{text:"20%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart2:{id:"chart2",zIndex:2,left:178,top:214,width:428,height:58,title:"chart2",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(57,74,87)"}}}},chartTitle2:{id:"chartTitle2",zIndex:3,left:178,top:186,width:59,height:28,title:"chartTitle2",description:"",type:ln.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber2:{id:"chartNumber2",zIndex:3,left:188,top:230,width:61,height:36,title:"chartNumber2",description:"",type:ln.TEXT,richText:{text:"50%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart3:{id:"chart3",zIndex:2,left:605,top:214,width:302,height:58,title:"chart3",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},chartTitle3:{id:"chartTitle3",zIndex:3,left:605,top:186,width:74,height:28,title:"chartTitle3",description:"",type:ln.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber3:{id:"chartNumber3",zIndex:3,left:615,top:230,width:61,height:36,title:"chartNumber3",description:"",type:ln.TEXT,richText:{text:"30%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:53,top:326,width:152,height:28,title:"detailTitle1",description:"",type:ln.TEXT,richText:{text:"Theme 1: Optimize",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:Kh,detailTitle2:{id:"detailTitle2",zIndex:3,left:334,top:326,width:129,height:28,title:"detailTitle2",description:"",type:ln.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent2:$h,detailTitle3:{id:"detailTitle3",zIndex:3,left:652,top:326,width:143,height:28,title:"detailTitle3",description:"",type:ln.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent3:Zh}},Qh=Yh.sheets[Yh.sheetOrder[0]],Jh=Yh.styles,tc={id:"business_1",pageType:rn.SLIDE,zIndex:2,title:"business",description:"this is second page, business",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:ln.TEXT,richText:{text:"The Business Objectives",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:ln.TEXT,richText:{text:"What we hope to achieve in the short and long run",fs:18,cl:{rgb:"rgb(127,127,127)"}}},spreadSheet1:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:ln.SPREADSHEET,spreadsheet:{worksheet:Qh,styles:Jh}}}},ec={id:"technology_1",pageType:rn.SLIDE,zIndex:2,title:"technology",description:"this is second page, technology",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:ln.TEXT,richText:{text:"Sustainable Technology",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:ln.TEXT,richText:{text:"Delivering technology alone will not be enough in 2023",fs:18,cl:{rgb:"rgb(127,127,127)"}}},picture1:{id:"picture1",zIndex:2,left:53,top:151,width:258,height:156,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/P1.png"}}},picture2:{id:"picture2",zIndex:2,left:315,top:151,width:241,height:156,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/P2.png"}}},picture3:{id:"picture3",zIndex:2,left:53,top:310,width:258,height:156,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/P3.png"}}},picture4:{id:"picture4",zIndex:2,left:310,top:315,width:241,height:156,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/P4.jpg"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"detailTitle1",description:"",type:ln.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:{id:"detailContent1",zIndex:3,left:580,top:167,width:373,height:81,title:"detailContent1",description:"",type:ln.TEXT,richText:{text:"Investments in sustainable technology also have the potential to create greater operational resiliency and financial performance, while providing new avenues for growth.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitle1:{id:"listTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"listTitle1",description:"",type:ln.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},listTitlePicture1:{id:"listTitlePicture1",zIndex:2,left:572,top:261,width:53,height:53,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon1.png"}}},listContent1:{id:"listContent1",zIndex:3,left:637,top:265,width:309,height:61,title:"listContent1",description:"",type:ln.TEXT,richText:{text:"Gartner’s Top 10 Strategic Technology Trends will help fulfill your business needs to optimize, scale or pioneer.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture2:{id:"listTitlePicture2",zIndex:2,left:572,top:341,width:53,height:53,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon2.png"}}},listContent2:{id:"listContent2",zIndex:3,left:637,top:345,width:309,height:61,title:"listContent2",description:"",type:ln.TEXT,richText:{text:"The trends allow you to align your technology innovation with the future strategic objectives of your enterprise.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture3:{id:"listTitlePicture3",zIndex:2,left:572,top:421,width:53,height:53,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon3.png"}}},listContent3:{id:"listContent3",zIndex:3,left:637,top:425,width:309,height:61,title:"listContent3",description:"",type:ln.TEXT,richText:{text:"Investments in sustainable technology provide operational and financial benefits, and can create growth opportunities.",fs:12,cl:{rgb:"rgb(127,127,127)"}}}}},nc={id:"richText_1",pageType:rn.SLIDE,zIndex:2,title:"business",description:"this is fix page, rich text",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:ln.TEXT,richText:{text:"The Work-like Editor",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:ln.TEXT,richText:{text:"Open source WYSIWYG editor built for the modern web",fs:18,cl:{rgb:"rgb(127,127,127)"}}},document:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:ln.DOCUMENT,document:Xh}}};function ic(t=1,e){const n={id:"slide_unlimited",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{unlimited_1:{id:"unlimited_1",pageType:rn.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:ln.IMAGE,image:{imageProperties:{contentUrl:"https://cdn.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:ln.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:ln.SHAPE,shape:{shapeType:je.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:ln.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:ln.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},catalog_1:jh,strategic_1:qh,technology_1:ec,richText_1:nc,business_1:tc},pageOrder:["unlimited_1","catalog_1","strategic_1","technology_1","richText_1","business_1"]}};return e&&(n.body.pages.unlimited_1.pageElements.slide={id:"slide",zIndex:3,left:960*(1-t)/2,top:540*(1-t)/2,width:960,height:540,scaleX:t,scaleY:t,title:"slide",description:"",type:ln.SLIDE,slide:e}),n}rn.SLIDE,ln.IMAGE,ln.SHAPE,je.RECTANGLE,ln.TEXT,ln.SHAPE,je.RECTANGLE,ln.TEXT,ln.TEXT,ln.SLIDE,ic(.9,ic(.9,ic(.9,ic(.9,ic(.9,ic(.9,ic(.9,ic(.9,ic(.9)))))))));const oc=_({});class sc{constructor(t){this._plugin=t,this._observerManager=this._plugin.getGlobalContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onUIChangeObservable","core",new O),this._observerManager.addObserver("onUIDidMountObservable","core",new O),this._observerManager.addObserver("onAfterChangeUISkinObservable","core",new O),this._observerManager.addObserver("onAfterChangeUILocaleObservable","core",new O),this._observerManager.addObserver("onViewComponentFocusChange","core",new O),this._observerManager.addObserver("onAddSheet","core",new O),this._observerManager.addObserver("onDeleteSheet","core",new O),this._observerManager.addObserver("onHideSheet","core",new O),this._observerManager.addObserver("onUnHideSheet","core",new O),this._observerManager.addObserver("onToLeftSheet","core",new O),this._observerManager.addObserver("onToRightSheet","core",new O),this._observerManager.addObserver("onCopySheet","core",new O),this._observerManager.addObserver("onRemoveSheet","core",new O),this._observerManager.addObserver("onSheetColor","core",new O)}}class rc extends p{constructor(t){super(t),this.initialize(t)}getContext(){return this.context.context}getLocale(t){if(t)return this.getContext().getLocale().get(t)}initialize(t){}}rc.contextType=oc;(class extends m{constructor(t){super(t),this.initialize(t)}getContext(){return this.context.context}getLocale(t){return this.getContext().getLocale().get(t)}initialize(t){}}).contextType=oc;var ac={};class lc extends rc{constructor(){super(...arguments),this.canvasRef=T()}componentDidMount(){this.drawLine()}drawLine(){const t=this.canvasRef;this.props.drawLine(t)}setLineDash(t,e,n,i,o,s,r){try{"Hair"===e?t.setLineDash([1,2]):e.indexOf("DashDotDot")>-1?t.setLineDash([2,2,5,2,2]):e.indexOf("DashDot")>-1?t.setLineDash([2,5,2]):e.indexOf("Dotted")>-1?t.setLineDash([2]):e.indexOf("Dashed")>-1?t.setLineDash([3]):t.setLineDash([0])}catch(a){console.log(a)}t.beginPath(),e.indexOf("Medium")>-1?("h"===n?(t.moveTo(i,o-.5),t.lineTo(s,r-.5)):(t.moveTo(i-.5,o),t.lineTo(s-.5,r)),t.lineWidth=2):"Thick"===e?(t.moveTo(i,o),t.lineTo(s,r),t.lineWidth=3):(t.moveTo(i,o),t.lineTo(s,r),t.lineWidth=1)}render(){return f("canvas",{ref:this.canvasRef,className:ac.canvas,width:this.props.width,height:this.props.height})}}class hc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Thin","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class cc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Hair","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class dc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Dotted","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class uc extends p{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Dashed","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class gc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"DashDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class _c extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"DashDotDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class pc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Medium","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class mc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashed","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class Tc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class fc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashDotDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class vc extends rc{constructor(){super(...arguments),this.ref=T()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Thick","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return f(lc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}const Ec="object"==typeof HTMLElement?t=>t instanceof HTMLElement:t=>t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName;function Ic(...t){if(!t.length)return;let e="";return t.forEach((t=>{if(t instanceof Object)for(let n in t)t[n]&&(e+=` ${n}`);else e+=t?` ${t}`:""})),e}function bc(t,e){let n=null;return(...i)=>{clearTimeout(n),n=setTimeout((()=>{t(...i)}),e)}}function Ac(t,e){for(let n in t)if(n.endsWith("Locale")&&"string"==typeof t[n]){const i=n.indexOf("Locale");t[n.slice(0,i)]=e(t[n])}return t}var Cc="univer-icon";const Sc=t=>{const{spin:e,rotate:n,children:i,name:o,style:s,className:r}=t;let a;s?(a=s,a.transform=n?`rotate(${n}deg)`:""):a=n?{transform:`rotate(${n}deg)`}:{};const l=Ic(Cc,{[`${Cc}-${o}`]:o,[`${Cc}-spin`]:e||"loading"===o},r);return f("span",{role:"img",className:l,style:h({},a)},i)},Nc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"loading",style:t.style},f("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}))),Rc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),wc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),f("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),f("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),Oc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),f("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),f("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),yc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),f("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),f("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),f("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),Mc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"}))),Dc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),f("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),Lc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),f("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),xc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),f("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),kc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),f("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),f("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),f("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),f("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),f("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),f("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),Hc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),f("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),f("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),f("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),f("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),f("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),Pc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),f("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),f("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),f("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),f("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),f("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),f("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),Bc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),f("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),f("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),Fc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),f("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),f("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),f("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),Uc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),f("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),zc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),Wc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),f("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),Gc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),f("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"}))),Vc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),Yc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),Xc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),jc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),Kc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),$c=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),Zc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),qc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),Qc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),Jc=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),td=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),ed=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),nd=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),f("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),f("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),id=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),f("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),od=t=>f(Sc,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),f("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"}))),sd=t=>f(Sc,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),rd=t=>f(Sc,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),ad=t=>f(Sc,{spin:t.spin,rotate:t.rotate,className:t.className,name:"nextIcon",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),ld=t=>f(Sc,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},f("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},f("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),f("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"})));var hd,cd,dd,ud,gd,_d,pd,md=ad;class Td{constructor(){this._componentList=new Map;const t={ForwardIcon:rd,BackIcon:sd,BoldIcon:Rc,ItalicIcon:wc,DeleteLineIcon:Oc,UnderLineIcon:yc,TextColorIcon:Mc,FillColorIcon:Dc,MergeIcon:Gc,TopBorderIcon:xc,BottomBorderIcon:kc,LeftBorderIcon:Hc,RightBorderIcon:Pc,NoneBorderIcon:Bc,FullBorderIcon:Lc,OuterBorderIcon:Fc,InnerBorderIcon:Uc,StripingBorderIcon:zc,VerticalBorderIcon:Wc,LeftAlignIcon:Vc,CenterAlignIcon:Yc,RightAlignIcon:Xc,TopVerticalIcon:jc,CenterVerticalIcon:Kc,BottomVerticalIcon:$c,OverflowIcon:id,BrIcon:nd,CutIcon:od,TextRotateIcon:Zc,TextRotateAngleUpIcon:qc,TextRotateAngleDownIcon:Qc,TextRotateVerticalIcon:Jc,TextRotateRotationUpIcon:td,TextRotateRotationDownIcon:ed,BorderThin:hc,BorderHair:cc,BorderDotted:dc,BorderDashed:uc,BorderDashDot:gc,BorderDashDotDot:_c,BorderMedium:pc,BorderMediumDashed:mc,BorderMediumDashDot:Tc,BorderMediumDashDotDot:fc,BorderThick:vc};for(let e in t)this.register(e,t[e])}register(t,e){this._componentList.set(t,e)}get(t){return this._componentList.get(t)}delete(t){this._componentList.delete(t)}}(cd=hd||(hd={}))[cd.Button=0]="Button",cd[cd.SingleButton=1]="SingleButton",cd[cd.Select=2]="Select",cd[cd.Container=3]="Container",cd[cd.CellRangeModal=4]="CellRangeModal",cd[cd.Modal=5]="Modal",cd[cd.SiderModal=6]="SiderModal",cd[cd.Layout=7]="Layout",cd[cd.Header=8]="Header",cd[cd.Footer=9]="Footer",cd[cd.Content=10]="Content",cd[cd.Sider=11]="Sider",cd[cd.Demo=12]="Demo",cd[cd.Checkbox=13]="Checkbox",cd[cd.CheckboxGroup=14]="CheckboxGroup",cd[cd.ColorPicker=15]="ColorPicker",cd[cd.ColorPickerCircleButton=16]="ColorPickerCircleButton",cd[cd.Input=17]="Input",cd[cd.Radio=18]="Radio",cd[cd.RadioGroup=19]="RadioGroup",cd[cd.Tab=20]="Tab",cd[cd.TabPane=21]="TabPane",cd[cd.Avatar=22]="Avatar",cd[cd.Tooltip=23]="Tooltip",cd[cd.Ul=24]="Ul",cd[cd.Collapse=25]="Collapse",cd[cd.Panel=26]="Panel",cd[cd.FormatModal=27]="FormatModal",cd[cd.RichText=28]="RichText",cd[cd.NextIcon=29]="NextIcon",cd[cd.RightIcon=30]="RightIcon",cd[cd.OrderIcon=31]="OrderIcon",cd[cd.CommentIcon=32]="CommentIcon",cd[cd.ConditionalFormatIcon=33]="ConditionalFormatIcon",cd[cd.ScreenshotIcon=34]="ScreenshotIcon",cd[cd.CheckIcon=35]="CheckIcon",cd[cd.SearchIcon=36]="SearchIcon",cd[cd.ReplaceIcon=37]="ReplaceIcon",cd[cd.FreezeIcon=38]="FreezeIcon",cd[cd.PivotableIcon=39]="PivotableIcon",cd[cd.FillColorIcon=40]="FillColorIcon",cd[cd.BoldIcon=41]="BoldIcon",cd[cd.FullBorderIcon=42]="FullBorderIcon",cd[cd.TopBorderIcon=43]="TopBorderIcon",cd[cd.BottomBorderIcon=44]="BottomBorderIcon",cd[cd.LeftBorderIcon=45]="LeftBorderIcon",cd[cd.RightBorderIcon=46]="RightBorderIcon",cd[cd.NoneBorderIcon=47]="NoneBorderIcon",cd[cd.OuterBorderIcon=48]="OuterBorderIcon",cd[cd.InnerBorderIcon=49]="InnerBorderIcon",cd[cd.StripingBorderIcon=50]="StripingBorderIcon",cd[cd.VerticalBorderIcon=51]="VerticalBorderIcon",cd[cd.MergeIcon=52]="MergeIcon",cd[cd.SumIcon=53]="SumIcon",cd[cd.OrderDESCIcon=54]="OrderDESCIcon",cd[cd.OrderASCIcon=55]="OrderASCIcon",cd[cd.FilterIcon=56]="FilterIcon",cd[cd.FilterRankIcon=57]="FilterRankIcon",cd[cd.CleanIcon=58]="CleanIcon",cd[cd.DeleteIcon=59]="DeleteIcon",cd[cd.DeleteLineIcon=60]="DeleteLineIcon",cd[cd.UnderLineIcon=61]="UnderLineIcon",cd[cd.ItalicIcon=62]="ItalicIcon",cd[cd.TextColorIcon=63]="TextColorIcon",cd[cd.BackIcon=64]="BackIcon",cd[cd.ForwardIcon=65]="ForwardIcon",cd[cd.FormatIcon=66]="FormatIcon",cd[cd.CorrectIcon=67]="CorrectIcon",cd[cd.LtIcon=68]="LtIcon",cd[cd.CloseIcon=69]="CloseIcon",cd[cd.DropDownIcon=70]="DropDownIcon",cd[cd.MenuIcon=71]="MenuIcon",cd[cd.HideIcon=72]="HideIcon",cd[cd.PhotoIcon=73]="PhotoIcon",cd[cd.LinkIcon=74]="LinkIcon",cd[cd.ChartIcon=75]="ChartIcon",cd[cd.LoadingIcon=76]="LoadingIcon",cd[cd.LogoIcon=77]="LogoIcon",cd[cd.AddNumIcon=78]="AddNumIcon",cd[cd.ReduceNumIcon=79]="ReduceNumIcon",cd[cd.PercentIcon=80]="PercentIcon",cd[cd.MoneyIcon=81]="MoneyIcon",cd[cd.FxIcon=82]="FxIcon",cd[cd.AddIcon=83]="AddIcon",cd[cd.ReduceIcon=84]="ReduceIcon",cd[cd.DivideIcon=85]="DivideIcon",cd[cd.LockIcon=86]="LockIcon",cd[cd.LocationIcon=87]="LocationIcon",cd[cd.PageIcon=88]="PageIcon",cd[cd.RegularIcon=89]="RegularIcon",cd[cd.LayoutIcon=90]="LayoutIcon",cd[cd.TableIcon=91]="TableIcon",cd[cd.ImageIcon=92]="ImageIcon",cd[cd.LeftAlignIcon=93]="LeftAlignIcon",cd[cd.CenterAlignIcon=94]="CenterAlignIcon",cd[cd.RightAlignIcon=95]="RightAlignIcon",cd[cd.TopVerticalIcon=96]="TopVerticalIcon",cd[cd.CenterVerticalIcon=97]="CenterVerticalIcon",cd[cd.BottomVerticalIcon=98]="BottomVerticalIcon",cd[cd.TextRotateIcon=99]="TextRotateIcon",cd[cd.TextRotateAngleUpIcon=100]="TextRotateAngleUpIcon",cd[cd.TextRotateAngleDownIcon=101]="TextRotateAngleDownIcon",cd[cd.TextRotateVerticalIcon=102]="TextRotateVerticalIcon",cd[cd.TextRotateRotationUpIcon=103]="TextRotateRotationUpIcon",cd[cd.TextRotateRotationDownIcon=104]="TextRotateRotationDownIcon",cd[cd.BrIcon=105]="BrIcon",cd[cd.OverflowIcon=106]="OverflowIcon",cd[cd.CutIcon=107]="CutIcon",cd[cd.PrintIcon=108]="PrintIcon",cd[cd.PrintAreaIcon=109]="PrintAreaIcon",cd[cd.PrintTitleIcon=110]="PrintTitleIcon",cd[cd.BorderDashDot=111]="BorderDashDot",cd[cd.BorderDashDotDot=112]="BorderDashDotDot",cd[cd.BorderDashed=113]="BorderDashed",cd[cd.BorderDotted=114]="BorderDotted",cd[cd.BorderHair=115]="BorderHair",cd[cd.BorderMedium=116]="BorderMedium",cd[cd.BorderMediumDashDot=117]="BorderMediumDashDot",cd[cd.BorderMediumDashDotDot=118]="BorderMediumDashDotDot",cd[cd.BorderMediumDashed=119]="BorderMediumDashed",cd[cd.BorderThick=120]="BorderThick",cd[cd.BorderThin=121]="BorderThin",(ud=dd||(dd={})).BUTTON="Button",ud.CONTAINER="Container",ud.CELL_RANGE_MODAL="CellRangeModal",ud.LAYOUT="Layout",ud.HEADER="Header",ud.FOOTER="Footer",ud.CONTENT="Content",ud.SIDER="Sider",ud.DEMO="Demo",ud.SHEET_CONTAINER="SheetContainer",(_d=gd||(gd={})).INPUT="input",_d.COLOR="color",_d.DOUBLE="double",_d.JSX="jsx",_d.INPUT_NUMBER="inputNumber",function(t){t.EN="en",t.ZH="zh"}(pd||(pd={}));var fd="univer-btn";class vd extends rc{constructor(t){var e;super(),this.handleClick=t=>{const{disabled:e,onClick:n,unActive:i=!0}=this.props;e?t.preventDefault():i?null==n||n(t):this.setState({isActive:!this.state.isActive},(()=>{n&&n.call(null,t,this.state.isActive)}))},this.state={isActive:null!=(e=t.active)&&e}}getSizeCls(){const{size:t}=this.props;let e="";switch(t){case"large":e="lg";break;case"small":e="sm"}return e}getClass(){const{isActive:t}=this.state,{type:e,shape:n,danger:i,block:o,loading:s,size:r,className:a}=this.props;return Ic(fd,{[`${fd}-${e}`]:e,[`${fd}-${n}`]:n,[`${fd}-${this.getSizeCls()}`]:r,[`${fd}-danger`]:!!i,[`${fd}-block`]:o,[`${fd}-loading`]:s,[`${fd}-active`]:t},a)}componentWillReceiveProps(t){this.setState({isActive:t.active})}render(){const{htmlType:t,disabled:e,style:n,loading:i,children:o}=this.props;return f("button",{type:t,onClick:this.handleClick,className:this.getClass(),disabled:e,style:n},i?f(Nc,null):"",o)}}var Ed="univer-input";class Id extends rc{constructor(){super(...arguments),this.ref=T(),this.setValue=(t,e)=>{this.setState((e=>({value:t})),e)},this.handleChange=t=>{const{onChange:e}=this.props;if(!e)return;const n=t.target;this.setValue(n.value),e(t)},this.handlePressEnter=t=>{const{onPressEnter:e}=this.props;"Enter"===t.key&&(null==e||e(t),this.ref.current.blur())},this.onFocus=t=>{const{onFocus:e}=this.props;null==e||e(t)},this.onClick=t=>{const{onClick:e}=this.props;null==e||e(t)},this.onBlur=t=>{const{onBlur:e}=this.props;null==e||e(t)},this.getValue=()=>this.ref.current.value}initialize(t){this.state={value:t.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(t){t.value&&t.value!==this.state.value&&this.setValue(t.value)}render(t,e){const{id:n,disabled:i,type:o,placeholder:s,bordered:r=!0,className:a="",readonly:l}=t,{value:h}=e,c=Ic(Ed,{[`${Ed}-disable`]:i,[`${Ed}-borderless`]:!r},a);return f("input",{type:o,onBlur:this.onBlur,onFocus:this.onFocus,className:c,placeholder:s,disabled:i,ref:this.ref,onChange:this.handleChange,value:h,onClick:this.onClick,readonly:l,id:n,onKeyUp:this.handlePressEnter})}}const bd=t=>{let e,{color:n}=t;if(!n)return null;if(n.indexOf("#")>-1){if(n=gn.hexToRgbString(n),!n)return null;e=n.replace("rgba(","").replace(")","").split(",")}else n.indexOf("rgba")>-1?e=n.replace("rgba(","").replace(")","").split(","):(e=n.replace("rgb(","").replace(")","").split(","),e.push("1"));let i=v(null);return f(Id,{ref:i,type:"text",value:`rgba(${e})`,onChange:()=>{t.onChange(i.current.base.value)}})};var Ad={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class Cd extends rc{initialize(t){this.state={color:t.color||"#000"}}setColor(t){this.setState({color:t}),this.props.onChange(t)}render(){return f("div",{className:Ad.colorPickerPanel,onClick:t=>t.stopPropagation()},f(I,{className:Ad.colorPicker,color:this.state.color,onChange:bc(this.setColor.bind(this),500)}),f("div",{className:Ad.colorPickerPanelSetting},f("div",{className:Ad.panelInput},this.props.rgb?f(bd,{color:this.state.color,onChange:bc(this.setColor.bind(this),500)}):f(E,{color:this.state.color,onChange:bc(this.setColor.bind(this),500)})),f("div",{className:Ad.panelColor},f("div",{style:{background:this.state.color}}),f("div",{style:{background:this.props.color}}))))}}var Sd="univer-color-picker-outer",Nd="univer-color-picker",Rd="univer-picker",wd="univer-picker-swatches",Od="univer-picker-swatches-item",yd="univer-picker-swatch",Md="univer-picker-swatch-btn",Dd="univer-colorful-warp";let Ld=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class xd extends rc{constructor(){super(...arguments),this.ulRef=T(),this.onChange=t=>{this.props.onChange&&this.props.onChange(t),this.setState({afterColor:t})},this.onClick=(t,e)=>{this.props.onClick&&this.props.onClick(t,e)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=t=>{t&&this.ulRef.current.contains(t.target)||(this.setState((t=>({styles:{display:"none"}}))),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=t=>{this.setState((t=>({styles:{display:"block"}}))),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(t,e)=>{const n=t.getBoundingClientRect(),i=this.ulRef.current.getBoundingClientRect(),o=document.documentElement.clientWidth||document.body.clientWidth,s=document.documentElement.clientHeight||document.body.clientHeight;let r=0,a=0;return a=n.top+i.height>s?n.top-i.height:n.top+n.height,r=n.left+i.width>o?o-i.width:n.left,{left:r,top:a}},this.onSwitch=t=>{t.stopImmediatePropagation(),new Promise(((t,e)=>{this.setState({setting:!this.state.setting}),t("end")})).then((()=>{if(this.state.root){const{top:t,left:e}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${e}px`,this.ulRef.current.style.top=`${t}px`}}))}}initialize(t){this.state={presetColors:Ld,defaultColor:t.color||"#000",afterColor:t.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}render(){const t=Object.assign(this.state.styles||{},this.props.style);return f("div",{className:`${Sd} ${this.props.className}`,ref:this.ulRef,style:h({},t)},f("div",{className:Nd,onClick:t=>{}},f("div",{className:Rd},f("div",{className:wd},this.state.presetColors.map((t=>f("div",{className:Od},t.map((t=>f("span",{className:yd,style:{background:t}},f(iu,{title:t,placement:"top"},f("button",{key:t,className:Md,style:{background:t},onClick:e=>{this.props.onClick&&this.props.onClick(t,e)}}))))))))),f("div",{onClick:t=>t.stopImmediatePropagation()},f(vd,{onClick:this.onSwitch},this.state.setting?this.getLocale("colorPicker.collapse"):this.getLocale("colorPicker.customColor")))),this.state.setting?f("div",{className:Dd},f(Cd,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),f("div",null,f(vd,{type:"primary",onClick:t=>{var e;null==(e=this.onClick)||e.call(this,this.state.afterColor,t)}},this.getLocale("colorPicker.confirmColor")),f(vd,{danger:!0,onClick:t=>{this.onCancel()}},this.getLocale("colorPicker.cancelColor")),f(vd,{onClick:t=>{t.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.getLocale("colorPicker.change")))):null))}}const kd=b(((t,e)=>{const{children:n,style:i,className:o,onClick:s,onContextMenu:r}=t;return f("div",{onContextMenu:r,ref:e,style:i,className:o,onClick:s},n)}));var Hd="univer-layout-wrapper",Pd="univer-layout-wrapper-has-sider",Bd="univer-header-wrapper",Fd="univer-footer-wrapper",Ud="univer-content-wrapper",zd="univer-sider-wrapper";class Wd extends rc{constructor(){super(...arguments),this.ref=T(),this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let t=function(t){let e=[],n=t.getElementsByTagName("*");for(let i=0,o=n.length;i<o;++i){if(1!==n[i].nodeType)continue;let o=n[i].parentNode;o&&1===o.nodeType?o===t&&(e[e.length]=n[i]):o&&o.parentNode===t&&(e[e.length]=n[i])}return e}(this.ref.current);const e=t instanceof Array?t:[t];for(const n of e)"ASIDE"===n.tagName&&this.setState({isAside:!0})}}render(t,e){const{children:n,style:i,className:o=""}=t,{isAside:s}=e;return f("section",{style:i,ref:this.ref,className:s?`${Hd} ${Pd} ${o}`:`${Hd} ${o}`},n)}}const Gd=t=>{const{children:e,style:n,className:i=""}=t;return f("header",{style:n,className:`${Bd} ${i}`},e)},Vd=t=>{const{children:e,style:n,className:i=""}=t;return f("footer",{style:n,className:`${Fd} ${i}`},e)},Yd=b(((t,e)=>{const{children:n,style:i,className:o=""}=t;return f("main",{ref:e,style:i,className:`${Ud} ${o}`},n)})),Xd=t=>{const{children:e,style:n,className:i=""}=t;return f("aside",{style:n,className:`${zd} ${i}`},e)};var jd="univer-cols-menu",Kd="univer-cols-menuitem",$d="univer-cols-menuitem-line",Zd="univer-cols-menuitem-disabled";class qd extends rc{constructor(){super(...arguments),this._MenuRef=T(),this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(t,e,n)=>{var i,o;const{deep:s=0}=this.props;null==(i=e.onClick)||i.call(null,t,e.value,n,s),null==(o=this.props.onClick)||o.call(null,t,e.value,n,s),this.showMenu(!1)},this.showMenu=t=>{this.setState((e=>({show:t})),(()=>{this.getStyle()}))},this.mouseEnter=(t,e)=>{const{menu:n=[]}=this.props;n[e].children&&this._refs[e].showMenu(!0)},this.mouseLeave=(t,e)=>{const{menu:n=[]}=this.props;n[e].children&&this._refs[e].showMenu(!1)},this.getStyle=()=>{var t;const e=this._MenuRef.current;if(!e)return;let n={};const i=e.getBoundingClientRect();let o;const{dom:s,parent:r}=this.props;if(o=s?s.getBoundingClientRect():{left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},r){e.style.position="fixed";let s=null==(t=e.parentElement)?void 0:t.getBoundingClientRect();if(!s)return;s.right+i.width>o.right?(n.left=s.left-i.width+"px",n.top=`${s.top}px`):(n.left=`${s.right}px`,n.top=`${s.top}px`),i.bottom>o.bottom&&(n.top="auto",n.bottom="5px"),this.setState({posStyle:n})}}}render(){const{className:t="",style:e="",menu:n,deep:i=0}=this.props,{show:o,posStyle:s}=this.state;return f("ul",{className:Ic(jd,t),style:c(h(h({},e),s),{display:o?"block":"none"}),ref:this._MenuRef},null==n?void 0:n.map(((t,e)=>{var n,o;if(!1!==t.show)return f(A,null,f("li",{className:Ic(Kd,null!=(n=t.className)?n:"",t.disabled?Zd:""),style:null!=(o=t.style)?o:"",onClick:n=>this.handleClick(n,t,e),onMouseEnter:t=>{this.mouseEnter(t,e)},onMouseLeave:t=>{this.mouseLeave(t,e)}},t.label,t.children?f(qd,{ref:t=>this._refs[e]=t,menu:t.children,onClick:t.onClick,className:t.className,style:t.style,parent:this,deep:i+1}):f(A,null)),t.border?f("div",{className:$d}):"")})))}initialize(){this.state={show:!1,posStyle:{}}}}var Qd="univer-tooltip-Group",Jd="univer-tooltip-title",tu="univer-tooltip-body",eu="univer-tooltip-triangle";const nu={top:"univer-top",bottom:"univer-bottom",left:"univer-left",right:"univer-right"};class iu extends rc{constructor(){super(...arguments),this.tooltip=T()}initialize(t){this.state={placement:t.placement||"top",placementClassName:Ic(Jd,nu[t.placement||"top"]),top:"",left:"",show:!1}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let t=this.tooltip.current.getBoundingClientRect(),e=t.height,n=t.width;"bottom"===this.state.placement?this.setState({top:e+10,left:n/2,show:!0}):"left"===this.state.placement?this.setState({top:e/2,left:n+5,show:!0}):"right"===this.state.placement?this.setState({top:e/2,left:-n-10,show:!0}):this.setState({top:-e-20,left:n/2,show:!0})}}handleMouseLeave(){this.setState({show:!1})}render(){return f("div",{ref:this.tooltip,className:Qd,style:this.props.styles},f("div",{className:tu,onMouseEnter:this.handleMouseOver.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},this.props.children),this.props.title?f("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`,display:""+(this.state.show?"block":"none")}},this.props.title,f("span",{className:eu})):null)}}var ou="univer-dropdown",su="univer-drop-content",ru="univer-drop-icon";class au extends rc{constructor(){super(...arguments),this.MenuRef=T(),this.DropRef=T(),this.IconRef=T(),this.handleClick=t=>{var e,n,i,o,s;null==(n=(e=this.props).onClick)||n.call(e),null==(o=(i=this.props).onMainClick)||o.call(i);const{icon:r}=this.props;r||null==(s=this.MenuRef.current)||s.showMenu(!0)},this.handleSubClick=()=>{var t;null==(t=this.MenuRef.current)||t.showMenu(!0)},this.hideMenu=()=>{var t;null==(t=this.MenuRef.current)||t.showMenu(!1)},this.hideMenuClick=t=>{var e;this.DropRef.current&&(null==(e=this.DropRef.current)?void 0:e.contains(t.target))||this.hideMenu()}}componentDidMount(){const{placement:t}=this.props;let e={position:"absolute"};t&&"Bottom"!==t?"Top"===t?(e.left=0,e.top="-100%"):"Left"===t?(e.left="-100%",e.top=0):(e.left="100%",e.top=0):(e.left=0,e.top="100%"),this.setState({menuStyle:e}),window.addEventListener("click",this.hideMenuClick,!0)}componentWillUnmount(){window.removeEventListener("click",this.hideMenuClick,!0)}render(){const{children:t,menu:e,showArrow:n,icon:i,tooltip:o}=this.props,{menuStyle:s}=this.state;return f("div",{className:ou,ref:this.DropRef},f(iu,{title:o,placement:"bottom"},f("div",{className:su,onClick:this.handleClick},t,n?f(md,null):"")),i?f("div",{ref:this.IconRef,className:ru,onClick:this.handleSubClick},i):"",f(qd,{onClick:e.onClick,ref:this.MenuRef,menu:e.menu,className:e.className,style:h(h({},e.style),s)}))}initialize(){this.state={menuStyle:{}}}}var lu="univer-select-item",hu="univer-select-item-selected",cu="univer-select-item-content",du="univer-select-item-suffix",uu="univer-select-disabled-item";class gu extends rc{render(){const{selected:t,label:e,suffix:n,disabled:i}=this.props;return f("div",{className:Ic(lu,i?uu:"")},t?f("span",{className:hu},f(ld,null)):"",f("span",{className:cu},e),n?f("span",{className:du},n):"")}}var _u,pu,mu,Tu,fu="univer-select-component",vu="univer-select-single",Eu="univer-select-input",Iu="univer-select-double",bu="univer-select-label";(pu=_u||(_u={}))[pu.SINGLE=0]="SINGLE",pu[pu.INPUT=1]="INPUT",pu[pu.COLOR=2]="COLOR",pu[pu.DOUBLE=3]="DOUBLE",pu[pu.FIX=4]="FIX",pu[pu.DOUBLEFIX=5]="DOUBLEFIX",(Tu=mu||(mu={}))[Tu.LABEL=0]="LABEL",Tu[Tu.SUFFIX=1]="SUFFIX";class Au extends m{constructor(){super(...arguments),this.handleSelected=t=>{const{children:e=[],hideSelectedIcon:n}=this.props;e.length&&(e.forEach((t=>{t.selected=!1})),null!==t&&(e[t].selected=!0));return this.resetMenu(e,n)},this.getSingle=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:i,onMainClick:o}=this.props;return f("div",{className:`${vu} ${n}`},f(au,{onMainClick:o,tooltip:i,menu:{menu:e,onClick:this.onClick},showArrow:!0},f("div",null,t)))},this.handlePressEnter=(t,e)=>{var n;this.onPressEnter(t),null==(n=e.current)||n.hideMenu()},this.getInput=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:i,onMainClick:o}=this.props,s=T();return f("div",{className:`${Eu} ${n}`},f(au,{onMainClick:o,ref:s,tooltip:i,menu:{menu:e,onClick:this.onClick},showArrow:!0},f(Id,{onPressEnter:t=>this.handlePressEnter(t,s),onBlur:this.onPressEnter,type:"number",value:t})))},this.getDouble=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:i,onClick:o}=this.props;return f("div",{className:`${Iu} ${n}`},f(au,{onClick:o,tooltip:i,menu:{menu:e,onClick:this.onClick},icon:f(ad,null)},f("div",{className:bu},t)))},this.getFix=()=>{const{label:t,className:e="",tooltip:n}=this.props,{menu:i}=this.state;return f("div",{className:`${Iu} ${e}`},f(au,{tooltip:n,menu:{menu:i,onClick:this.onClick},showArrow:!0},f("div",{className:bu},t)))},this.getDoubleFix=()=>{const{label:t,className:e="",tooltip:n,onClick:i}=this.props,{menu:o}=this.state;return f("div",{className:`${Iu} ${e}`},f(au,{tooltip:n,onClick:i,menu:{menu:o,onClick:this.onClick},icon:f(ad,null)},f("div",{className:bu},t)))}}initialize(){var t;const{children:e=[],hideSelectedIcon:n}=this.props,i=this.resetMenu(e,n);this.state={menu:i,color:null!=(t=this.props.defaultColor)?t:"#000",content:"",value:""}}getType(t){switch(t){case 0:return this.getSingle();case 1:return this.getInput();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:t,display:e,children:n=[],label:i}=this.props;if(0===t||3===t){if(!n.length)return;let t=n.findIndex((t=>t.selected));t<0&&(t=0);const i=this.handleSelected(t),o=n[t];1===e?this.setState({content:o.suffix,menu:i}):this.setState({content:o.label,menu:i}),this.onClick=(...t)=>{var i,o;const s=n[t[2]];if(null==(o=(i=this.props).onClick)||o.call(i,t[1],t[2],t[3]),s.unSelectable)return;const r=this.handleSelected(t[2]);1===e?this.setState({content:n[t[2]].suffix,menu:r}):this.setState({content:n[t[2]].label,menu:r})}}else if(1===t){if(!n.length)return;const t=t=>{if(null!==t){if(""===t)return;let e=n.findIndex((e=>t===e.label)),i=this.handleSelected(e<0?null:e);this.setState({content:t,menu:i})}else{let t=n.findIndex((t=>t.selected));t<0&&(t=0);let e=this.handleSelected(t);const i=n[t];this.setState({content:i.label,menu:e})}};t(i),this.onClick=(...t)=>{var e,i;null==(i=(e=this.props).onClick)||i.call(e,t[1],t[2],t[3]);const o=this.handleSelected(t[2]);this.setState({content:n[t[2]].label,menu:o})},this.onPressEnter=e=>{var n,i;const o=e.currentTarget.value;null==(i=(n=this.props).onPressEnter)||i.call(n,o),t(o)}}else if(2===t){const t=this.handleSelected(null);this.setState({menu:t}),this.onClick=()=>{var t,e;const{color:n}=this.state;null==(e=(t=this.props).onClick)||e.call(t,n)}}else if(4===t||5===t){if(!n.length)return;let t=n.findIndex((t=>t.selected));t<0&&(t=0);const e=n[t],i=this.handleSelected(t);this.setState({menu:i,value:e.value}),this.onClick=(...t)=>{var e,i,o,s;if(t.length){null==(i=(e=this.props).onClick)||i.call(e,t[1],t[2],t[3]);const o=this.handleSelected(t[2]);this.setState({menu:o,value:n[t[2]].value})}else null==(s=(o=this.props).onClick)||s.call(o,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(t){}resetMenu(t,e){var n;const i=[];for(let o=0;o<t.length;o++){let s=!1;e||(s=null!=(n=t[o].selected)&&n),i[o]={label:""},i[o].label=f(gu,{disabled:t[o].disabled,border:t[o].border,selected:s,label:t[o].label,suffix:t[o].suffix}),i[o].disabled=t[o].disabled,i[o].style=t[o].style,i[o].value=t[o].value,i[o].className=t[o].className,i[o].onClick=t[o].onClick,i[o].border=t[o].border,t[o].children&&(i[o].children=this.resetMenu(t[o].children))}return i}render(){const{type:t=0}=this.props;return f("div",{className:fu},this.getType(t))}}const Cu={};class Su extends Ms{constructor(t={}){super(nn.BASE_UI),this._config=Object.assign(Cu,t)}static create(t){return new Su(t)}installTo(t){t.install(this)}initialize(t){this.context=t,this.initEventManager()}getConfig(){return this._config}onMounted(t){this.initialize(t)}initEventManager(){this._eventManager=new sc(this)}getEventManager(){return this._eventManager}}var Nu={spreadsheetLabel:"插件",spreadsheetRightLabel:"更多 Sheets",spreadsheet:{one:"一",two:"二",three:"三"},toolbar:{undo:"撤销",redo:"重做",paintFormat:"格式刷",currencyFormat:"货币格式",percentageFormat:"百分比格式",numberDecrease:"减少小数位数",numberIncrease:"增加小数位数",moreFormats:"更多格式",font:"字体",fontSize:"字号大小",bold:"粗体 (Ctrl+B)",italic:"斜体 (Ctrl+I)",strikethrough:"删除线 (Alt+Shift+5)",underline:"下划线",textColor:{main:"文本颜色",right:"颜色选择"},resetColor:"重置颜色",customColor:"自定义",alternatingColors:"交替颜色",confirmColor:"确定颜色",cancelColor:"取消",collapse:"收起",fillColor:{main:"单元格颜色",right:"颜色选择"},border:{main:"边框",right:"边框类型"},mergeCell:{main:"合并单元格",right:"选择合并类型"},horizontalAlignMode:{main:"水平对齐",right:"对齐方式"},verticalAlignMode:{main:"垂直对齐",right:"对齐方式"},textWrapMode:{main:"文本换行",right:"换行方式"},textRotateMode:{main:"文本旋转",right:"旋转方式"},freezeTopRow:"冻结首行",sortAndFilter:"排序和筛选",findAndReplace:"查找替换",sum:"求和",autoSum:"自动求和",moreFunction:"更多函数",conditionalalFormat:"条件格式",comment:"批注",pivotTable:"数据透视表",chart:"图表",screenshot:"截图",splitColumn:"分列",insertImage:"插入图片",insertLink:"插入链接",dataValidation:"数据验证",protection:"保护工作表内容",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",toolMore:"更多",toolLess:"少于",toolClose:"收起",toolMoreTip:"更多功能",moreOptions:"更多选项",cellFormat:"设置单元格格式",print:"打印",borderMethod:{top:"上框线",bottom:"下框线",left:"左框线",right:"右框线"},more:"更多"},defaultFmt:{Automatic:{text:"自动",value:"General",example:""},Number:{text:"数字",value:"##0.00",example:"1000.12"},Percent:{text:"百分比",value:"#0.00%",example:"12.21%"},PlainText:{text:"纯文本",value:"@",example:""},Scientific:{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"万元",value:"w",example:"1亿2000万2500"},Currency:{text:"货币",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"时间24H",value:"hh:mm",example:"15:00"},DateTime:{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"自定义格式",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"更多货币格式",moreDateTime:"更多日期与时间格式",moreNumber:"更多数字格式",titleCurrency:"货币格式",decimalPlaces:"小数位数",titleDateTime:"日期与时间格式",titleNumber:"数字格式"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"微软雅黑",SimSun:"宋体",SimHei:"黑体",Kaiti:"楷体",FangSong:"仿宋",NSimSun:"新宋体",STXinwei:"华文新魏",STXingkai:"华文行楷",STLiti:"华文隶书",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"常规视图",layoutBtn:"页面布局",pageBtn:"分页预览",menuItemPrint:"打印(Ctrl+P)",menuItemAreas:"打印区域",menuItemRows:"打印标题行",menuItemColumns:"打印标题列"},align:{left:"左对齐",center:"中间对齐",right:"右对齐",top:"顶部对齐",middle:"居中对齐",bottom:"底部对齐"},button:{confirm:"确定",cancel:"取消",close:"关闭",update:"Update",delete:"Delete",insert:"新建",prevPage:"上一页",nextPage:"下一页",total:"总共："},punctuation:{tab:"Tab 键",semicolon:"分号",comma:"逗号",space:"空格"},colorPicker:{collapse:"收起",customColor:"自定义",change:"切换",confirmColor:"确定",cancelColor:"取消"},borderLine:{borderTop:"上框线",borderBottom:"下框线",borderLeft:"左框线",borderRight:"右框线",borderNone:"无",borderAll:"所有",borderOutside:"外侧",borderInside:"内侧",borderHorizontal:"内侧横线",borderVertical:"内侧竖线",borderColor:"边框颜色",borderSize:"边框粗细"},merge:{all:"全部合并",vertical:"垂直合并",horizontal:"水平合并",cancel:"取消合并",overlappingError:"不能合并重叠区域",partiallyError:"无法对部分合并单元格执行此操作"},textWrap:{overflow:"溢出",wrap:"自动换行",clip:"截断"},textRotate:{none:"无旋转",angleUp:"向上倾斜",angleDown:"向下倾斜",vertical:"竖排文字",rotationUp:"向上90°",rotationDown:"向下90°"},sheetConfig:{delete:"删除",copy:"复制",rename:"重命名",changeColor:"更改颜色",hide:"隐藏",unhide:"取消隐藏",moveLeft:"向左移",moveRight:"向右移",resetColor:"重置颜色",cancelText:"取消",chooseText:"确定颜色",tipNameRepeat:"标签页的名称不能重复！请重新修改",noMoreSheet:"工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",confirmDelete:"是否删除",redoDelete:"可以通过Ctrl+Z撤销删除",noHide:"不能隐藏, 至少保留一个sheet标签",chartEditNoOpt:"图表编辑模式下不允许该操作！",sheetNameSpecCharError:"名称不能超过31个字符，首尾不能是' 且名称不能包含:\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"名称不能为空!"},rightClick:{copy:"复制",copyAs:"复制为",cut:"剪切",paste:"粘贴",insert:"插入",delete:"删除",insertRow:"插入行",insertColumn:"插入列",deleteCell:"删除单元格",deleteSelected:"删除选中",hide:"隐藏",hideSelected:"隐藏选中",showHide:"显示隐藏",toTopAdd:"向上增加",toBottomAdd:"向下增加",toLeftAdd:"向左增加",toRightAdd:"向右增加",deleteSelectedRow:"删除选中行",deleteSelectedColumn:"删除选中列",hideSelectedRow:"隐藏选中行",showHideRow:"显示隐藏行",rowHeight:"行高",hideSelectedColumn:"隐藏选中列",showHideColumn:"显示隐藏列",columnWidth:"列宽",to:"向",left:"左",right:"右",top:"上",bottom:"下",moveLeft:"左移",moveUp:"上移",add:"增加",row:"行",column:"列",width:"宽",height:"高",number:"数字",confirm:"确认",orderAZ:"A-Z顺序排列",orderZA:"Z-A降序排列",clearContent:"清除内容",matrix:"矩阵操作选区",sortSelection:"排序选区",filterSelection:"筛选选区",chartGeneration:"图表生成",firstLineTitle:"首行为标题",untitled:"无标题",array1:"一维数组",array2:"二维数组",array3:"多维数组",diagonal:"对角线",antiDiagonal:"反对角线",diagonalOffset:"对角偏移",offset:"偏移量",boolean:"布尔值",flip:"翻转",upAndDown:"上下",leftAndRight:"左右",clockwise:"顺时针",counterclockwise:"逆时针",transpose:"转置",matrixCalculation:"矩阵计算",plus:"加",minus:"减",multiply:"乘",divided:"除",power:"次方",root:"次方根",log:"log",delete0:"删除两端0值",removeDuplicate:"删除重复值",byRow:"按行",byCol:"按列",generateNewMatrix:"生成新矩阵"},info:{detailUpdate:"新打开",detailSave:"已恢复本地缓存",row:"行",column:"列",loading:"渲染中···",copy:"副本",return:"返回",rename:"重命名",tips:"重命名",noName:"无标题的电子表格",wait:"待更新",add:"添加",addLast:"在底部添加",backTop:"回到顶部",pageInfo:"共${total}条，${totalPage}页，当前已显示${currentPage}页",nextPage:"下一页",tipInputNumber:"请输入数字",tipInputNumberLimit:"增加范围限制在1-100",tipRowHeightLimit:"行高必须在0 ~ 545之间",tipColumnWidthLimit:"列宽必须在0 ~ 2038之间",pageInfoFull:"共${total}条，${totalPage}页，已显示全部数据"}},Ru={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1亿2000万2500"},Currency:{text:"Currency",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page break preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",insertRow:"InsertRow",insertColumn:"InsertColumn",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",toTopAdd:"Towards Top Add",toBottomAdd:"Towards Bottom Add",toLeftAdd:"Towards Left Add",toRightAdd:"Towards Right Add",deleteSelectedRow:"Delete selected row",deleteSelectedColumn:"Delete selected column",hideSelectedRow:"Hide selected row",showHideRow:"Show selected row",rowHeight:"Row height",hideSelectedColumn:"Hide selected column",showHideColumn:"Show hide column",columnWidth:"Column width",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}，${totalPage} page，current ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}，${totalPage} page，All data displayed"}};const wu={undo:!0,redo:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},Ou={layout:{docContainerConfig:{outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},toolbarConfig:wu}};var yu={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",bgHover:"#efefef",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};var Mu="univer-layout-container",Du="univer-content-container-horizontal",Lu="univer-content-inner-left-container",xu="univer-hover-cursor",ku="univer-content-inner-right-container",Hu="univer-content-container-vertical",Pu="univer-main-content",Bu="univer-outer-right-container";var Fu="univer-toolbar-warp",Uu="univer-toolbar",zu="univer-select-label-string",Wu="univer-select-double-string",Gu="univer-select-color-picker-parent",Vu="univer-select-color-picker",Yu="univer-text-button",Xu="univer-more-button",ju="univer-more-tool",Ku="univer-tooltip-title",$u="univer-bottom";class Zu extends rc{constructor(){super(...arguments),this.toolbarRef=T(),this.moreBtnRef=T(),this.moreToolRef=T(),this.SelectRef=T(),this.clientWidth=0,this.debounceSetToolbarListWidth=bc((()=>{this.setToolbarListWidth()}),50),this.showMore=()=>{let t=this.state.showMore;this.setState({showMore:!t}),t||document.addEventListener("click",this.hide,!0)},this.hide=t=>{this.moreToolRef.current.contains(t.target)||(t.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const t=this.toolbarRef.current.querySelectorAll(`.${Fu} > div`),e=this.moreBtnRef.current.clientWidth;let n=60+e,i=null;const o=document.documentElement.clientWidth;if(o<=this.clientWidth){this.clientWidth=o;for(let e=0;e<t.length;e++)if(n+=t[e].clientWidth+6,n>o){i=e;break}null!==i&&this.setState({defaultToolList:this.state.toolList.slice(0,i),moreToolList:i?this.state.toolList.slice(i):[]},(()=>{this.resetUl(),this.forceUpdate()}))}else if(this.clientWidth=o,this.state.moreToolList.length){let n=30+e;for(let e=0;e<t.length;e++)n+=t[e].clientWidth+6;const i=this.moreToolRef.current.querySelectorAll(`.${ju} > div`);let s=null,r=!1;for(let t=0;t<i.length;t++){if(n+=i[t].clientWidth+6,n>o){s=t;break}t===i.length-1&&(s=t,r=!0)}null!==s&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,r?s+1:s)),moreToolList:r?[]:this.state.moreToolList.slice(s)},(()=>{this.resetUl(),this.forceUpdate()}))}},this.resetLabel=t=>{var e,n,i;const o=null==(e=this.getContext().getPluginManager().getPluginByName("DocUI"))?void 0:e.getComponentManager();for(let s=0;s<t.length;s++){const e=Ac(t[s],this.getLocale.bind(this));if(e.customLabel){const t=null==o?void 0:o.get(e.customLabel.name);if(t){const i=null!=(n=e.customLabel.props)?n:{};e.label=f(t,h({},i))}}if(e.customSuffix){const t=null==o?void 0:o.get(e.customSuffix.name);if(t){const n=null!=(i=e.customSuffix.props)?i:{};e.suffix=f(t,h({},n))}}e.children&&(e.children=this.resetLabel(e.children))}return t},this.setToolbar=t=>{this.setState({toolList:t,defaultToolList:t},(()=>{this.setToolbarListWidth()}))},this.resetUl=()=>{var t;const e=`${(null==(t=this.getContext().getPluginManager().getPluginByName("DocUI"))?void 0:t.getAppUIController().getDocContainerController().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let i=0;i<n.length;i++)n[i].style.maxHeight=e}}initialize(){this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[]}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolbarList(t){return(t=this.resetLabel(t)).map((t=>{if(t.toolbarType){if(t.show)return f(iu,{title:this.getLocale(t.tooltip),placement:"bottom"},f(vd,{unActive:t.unActive,className:Yu,type:"text",active:t.active,onClick:t.onClick},t.label))}else if(t.show)return f(Au,{tooltip:this.getLocale(t.tooltip),type:t.type,display:t.display,children:t.children,customLabel:t.customLabel,customSuffix:t.customSuffix,label:t.label,onClick:t.onClick,onPressEnter:t.onPressEnter,onMainClick:t.onMainClick,defaultColor:t.defaultColor,hideSelectedIcon:t.hideSelectedIcon,className:t.className});return null}))}render(){const{defaultToolList:t,moreToolList:e,showMore:n}=this.state;return f(kd,{style:{position:"relative"}},f("div",{className:`${Fu} ${Uu}`,ref:this.toolbarRef},this.getToolbarList(t),f("div",{ref:this.moreBtnRef,className:Xu,style:{visibility:e.length?"visible":"hidden"}},f(iu,{title:this.getLocale("toolbar.toolMoreTip"),placement:"bottom"},f(vd,{type:"text",onClick:this.showMore},f("div",{style:{fontSize:"14px"}},this.getLocale("toolbar.toolMore")))))),e.length?f("div",{style:{visibility:n?"visible":"hidden"},className:`${ju} ${Uu}`,ref:this.moreToolRef},this.getToolbarList(e)):"")}}Zu.contextType=oc;var qu="univer-info-detail",Qu="univer-sheet-name",Ju="univer-info-detail-update",tg="univer-info-detail-save";class eg extends rc{initialize(){this.state={infoList:null}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}setInfoList(t){this.setState({infoList:t})}render(){const{renameSheet:t}=this.props;if(!this.state.infoList)return;const{back:e,sheet:n,update:i,save:o,rename:s}=this.state.infoList;return f(kd,{className:qu},f("div",{className:Qu},f(iu,{title:s.label,placement:"bottom"},f(Id,{bordered:!1,value:n.label,onBlur:t}))),f("div",{className:Ju},i.label),f("div",{className:tg},o.label))}}class ng extends rc{constructor(t){super(),this.splitLeftRef=T(),this.contentRef=T(),this.handleSplitBarMouseDown=t=>{var e,n,i,o,s;this.leftContentLeft=null==(e=this.splitLeftRef.current)?void 0:e.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const r=null==(i=this.splitLeftRef.current)?void 0:i.parentElement;this.rightBorderX=null==(o=null==r?void 0:r.getBoundingClientRect())?void 0:o.width,this.rightBorderY=null==(s=null==r?void 0:r.getBoundingClientRect())?void 0:s.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=t=>{var e;const n=null==(e=this.props.config.layout)?void 0:e.docContainerConfig;let i=(t=t||window.event).clientX-this.leftContentLeft,o=t.clientY-this.leftContentTop;i=i>=this.rightBorderX?this.rightBorderX:i,o=o>=this.rightBorderY?this.rightBorderY:o,"vertical"===n.contentSplit?this.splitLeftRef.current.style.height=`${o}px`:this.splitLeftRef.current.style.width=`${i}px`},this.handleSplitBarMouseUp=t=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.changeSkin(t.config.container,"default")}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}changeSkin(t,e){let n=document.documentElement;const i="string"==typeof t?t:t.id;let o={default:yu}[e];if(o=Object.fromEntries(Object.keys(o).map((t=>[`--${t.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,o[t]]))),U.isIEBrowser())C({rootElement:n,variables:o});else{(function(t){const e="universheet-skin-style";for(let o=0;o<document.styleSheets.length;o++)if(document.styleSheets[o].title===e)return s(document.styleSheets[o],t),document.styleSheets[o];const n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");return i.title=e,n.appendChild(i),document.styleSheets[document.styleSheets.length-1]})(i).insertRule(`#${i} ${JSON.stringify(o).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function s(t,e){let n=0;for(let i=0;i<t.cssRules.length;i++){const o=t.cssRules[i];if(o instanceof CSSStyleRule&&o.selectorText===`#${e}`){n=i,t.deleteRule(n);break}}}}render(){const{methods:t}=this.props,{layout:e}=this.props.config,n=null==e?void 0:e.docContainerConfig;return f(kd,{className:Mu},f(Wd,null,f(Xd,{style:{display:n.outerLeft?"block":"none"}}),f(Wd,{className:Pu,style:{position:"relative"}},f(Gd,{style:{display:n.header?"block":"none"}},n.infoBar&&f(eg,h({},t.infoBar)),n.toolbar&&f(Zu,h({},t.toolbar))),f(Wd,null,f(Xd,{style:{display:n.innerLeft?"block":"none"}}),f(Yd,{className:"vertical"===n.contentSplit?Hu:Du},!!n.contentSplit&&f(kd,{ref:this.splitLeftRef,className:Lu},f("div",{className:xu,onMouseDown:this.handleSplitBarMouseDown})),f(kd,{onContextMenu:t=>t.preventDefault(),ref:this.contentRef,className:ku})),f(Xd,{style:{display:n.innerRight?"block":"none"}})),f(Vd,{style:{display:n.footer?"block":"none"}})),f(Xd,{style:{display:n.outerRight?"block":"none"},className:Bu})))}}class ig extends rc{constructor(t){super(t),this.state={locale:this.props.locale}}setLocale(t){const e=t.target.value;this.props.changeLocale(e),this.setState({locale:e})}render(){const{context:t,UIConfig:e}=this.props,{locale:n}=this.state;return f(oc.Provider,{value:{context:t,locale:n}},f("div",{style:{position:"fixed",right:"250px",top:"14px",fontSize:"14px",zIndex:100},className:"univer-dev-operation"},f("span",{style:{display:"inline-block",width:70,margin:"5px 0 0 5px"}},"Language"),f("select",{value:n,onChange:this.setLocale.bind(this),style:{width:70}},f("option",{value:"en"},"English"),f("option",{value:"zh"},"中文"))),f(ng,h({},e)))}}class og{constructor(t){this._initialize(t)}static create(t){return new og(t)}_initialize(t){let e;const n=t.container;if("string"==typeof n){const t=document.getElementById(n);null==t?(e=document.createElement("div"),e.id=n):e=t}else(i=n)instanceof Element||i instanceof HTMLDocument?e=n:(e=document.createElement("div"),e.id="univer");var i;S(f(ig,h({},t)),e)}}class sg{constructor(t){this._name=t}get name(){return this._name}setName(t){this._name=t}}class rg{constructor(t){this.getComponent=t=>{this._infoBar=t,this._refreshComponent(),this.resetInfoList(this._infoList)},this._plugin=t}resetInfoList(t){const e=this._plugin.getContext().getLocale();for(let n in t)t[n].locale&&(t[n].label=e.get(t[n].locale));this._infoBar.setInfoList(t)}setSheetName(t){const e=t.target.value;this._infoBarModel.setName(e)}_refreshComponent(){const t="UniverDoc";this._infoBarModel=new sg(t),this._infoList={back:{locale:"info.return"},rename:{locale:"info.tips"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},sheet:{label:t,onBlur:t=>{this.setSheetName(t)}}}}}var ag="univer-color-select",lg="univer-color-select-line";class hg extends rc{componentDidMount(){var t,e,n;const i=null==(t=this.getContext().getPluginManager().getPluginByName("DocUI"))?void 0:t.getComponentManager();let o=this.props.label;if(this.props.customLabel){const t=null==i?void 0:i.get(this.props.customLabel.name);o=f(t,h({},this.props.customLabel.props))}this.setState({label:o,color:this.props.color}),null==(n=(e=this.props).getComponent)||n.call(e,this)}componentWillReceiveProps(t){this.setState({color:t.color})}setColor(t){this.setState({color:t})}render(){return f("div",{className:ag},f("div",null,this.state.label),f("div",{className:lg,style:{background:this.state.color}}))}}const cg=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],dg=[{labelLocale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{labelLocale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{labelLocale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{labelLocale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{labelLocale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"微软雅黑"},value:"微软雅黑"},{labelLocale:"fontFamily.SimSun",style:{"font-family":"宋体"},value:"宋体"},{labelLocale:"fontFamily.SimHei",style:{"font-family":"黑体"},value:"黑体"},{labelLocale:"fontFamily.Kaiti",style:{"font-family":"楷体"},value:"楷体"},{labelLocale:"fontFamily.FangSong",style:{"font-family":"仿宋"},value:"仿宋"},{labelLocale:"fontFamily.NSimSun",style:{"font-family":"新宋体"},value:"新宋体"},{labelLocale:"fontFamily.STXinwei",style:{"font-family":"华文新魏"},value:"华文新魏"},{labelLocale:"fontFamily.STXingkai",style:{"font-family":"华文行楷"},value:"华文行楷"},{labelLocale:"fontFamily.STLiti",style:{"font-family":"华文隶书"},value:"华文隶书"},{labelLocale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{labelLocale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{labelLocale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];Gt.NONE,Gt.THIN,Gt.HAIR,Gt.DOTTED,Gt.DASHED,Gt.DOTTED,Gt.DASH_DOT_DOT,Gt.MEDIUM,Gt.MEDIUM_DASHED,Gt.MEDIUM_DASH_DOT,Gt.MEDIUM_DASH_DOT_DOT,Gt.THICK;const ug=[{labelLocale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{labelLocale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{labelLocale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],gg=[{labelLocale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{labelLocale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{labelLocale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],_g=[{labelLocale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{labelLocale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{labelLocale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],pg=[{labelLocale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{labelLocale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{labelLocale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{labelLocale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{labelLocale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{labelLocale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];var mg,Tg;(Tg=mg||(mg={}))[Tg.SELECT=0]="SELECT",Tg[Tg.BUTTON=1]="BUTTON";class fg{constructor(t,e){this._textColor="#000",this._background="#fff",this.getComponent=t=>{this._toolbar=t,this.setToolbar()},this._plugin=t,this._config=U.deepMerge({},wu,e),this._toolList=[{toolbarType:1,tooltip:"toolbar.undo",name:"undo",customLabel:{name:"ForwardIcon"},show:this._config.undo,onClick:()=>{this.setUndo(),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.redo",customLabel:{name:"BackIcon"},name:"redo",show:this._config.redo,onClick:()=>{this.setRedo(),this.hideTooltip()}},{type:0,tooltip:"toolbar.font",className:zu,name:"font",show:this._config.font,border:!0,onMainClick:()=>{this.hideTooltip()},onClick:t=>{this.setFontFamily(t)},children:dg},{type:1,tooltip:"toolbar.fontSize",label:String(qe.fs),name:"fontSize",show:this._config.fontSize,onClick:t=>{this.setFontSize(t)},onMainClick:()=>{this.hideTooltip()},onPressEnter:t=>{this.setFontSize(t),this.hideTooltip()},children:cg},{toolbarType:1,tooltip:"toolbar.bold",customLabel:{name:"BoldIcon"},unActive:!1,name:"bold",show:this._config.bold,onClick:(t,e)=>{this.setFontWeight(e),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.italic",customLabel:{name:"ItalicIcon"},unActive:!1,name:"italic",show:this._config.italic,onClick:(t,e)=>{this.setFontStyle(e),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},unActive:!1,name:"strikethrough",show:this._config.strikethrough,onClick:(t,e)=>{this.hideTooltip();const n=this._toolList.find((t=>"strikethrough"===t.name));n&&(n.active=e,this.setStrikeThrough(e))}},{toolbarType:1,tooltip:"toolbar.underline",customLabel:{name:"UnderLineIcon"},unActive:!1,name:"underline",show:this._config.underline,onClick:(t,e)=>{this.hideTooltip();const n=this._toolList.find((t=>"underline"===t.name));n&&(n.active=e,this.setUnderline(e))}},{type:5,tooltip:"toolbar.textColor.main",customLabel:{name:"DocUI"+hg.name,props:{getComponent:t=>{this._colorSelect1=t},color:"#000",customLabel:{name:"TextColorIcon"}}},onClick:()=>{this.hideTooltip();const t=this._toolList.find((t=>"textColor"===t.name));t&&t.customLabel&&t.customLabel.props&&(t.customLabel.props.color=this._textColor,this.changeColor(this._textColor))},hideSelectedIcon:!0,className:Gu,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:"DocUI"+xd.name,props:{onClick:(t,e)=>{this._colorSelect1.setColor(t),this._textColor=t}}},className:Vu}],name:"textColor",show:this._config.textColor},{type:5,tooltip:"toolbar.fillColor.main",customLabel:{name:"DocUI"+hg.name,props:{getComponent:t=>{this._colorSelect2=t},color:"#fff",customLabel:{name:"FillColorIcon"}}},onClick:()=>{this.hideTooltip();const t=this._toolList.find((t=>"fillColor"===t.name));t&&t.customLabel&&t.customLabel.props&&(t.customLabel.props.color=this._background,this.setBackground(this._background))},hideSelectedIcon:!0,className:Gu,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:"DocUI"+xd.name,props:{onClick:(t,e)=>{this._colorSelect2.setColor(t),this._background=t}}},className:Vu}],name:"fillColor",show:this._config.fillColor},{type:3,tooltip:"toolbar.horizontalAlignMode.main",className:Wu,display:1,name:"horizontalAlignMode",show:this._config.horizontalAlignMode,onClick:t=>{this.setHorizontalAlignment(t),this.hideTooltip()},children:ug},{type:3,tooltip:"toolbar.verticalAlignMode.main",className:Wu,display:1,name:"verticalAlignMode",show:this._config.verticalAlignMode,onClick:t=>{this.setVerticalAlignment(t),this.hideTooltip()},children:gg},{type:3,className:Wu,tooltip:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:this._config.textWrapMode,onClick:t=>{this.setWrapStrategy(t),this.hideTooltip()},children:_g},{type:3,className:Wu,name:"textRotateMode",tooltip:"toolbar.textRotateMode.main",display:1,show:this._config.textRotateMode,onClick:t=>{this.setTextRotation(t),this.hideTooltip()},children:pg}],this._initialize()}addToolbarConfig(t){this._toolList.findIndex((e=>e.name===t.name))>-1||this._toolList.push(t)}deleteToolbarConfig(t){const e=this._toolList.findIndex((e=>e.name===t));e>-1&&this._toolList.splice(e,1)}setToolbar(){var t;null==(t=this._toolbar)||t.setToolbar(this._toolList)}setUIObserve(t){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(t)}changeColor(t){var e,n;const i=this._toolList.find((t=>"strikethrough"===t.name)),o=this._toolList.find((t=>"underline"===t.name));this.setFontColor(t),o&&this.setUnderline(null!=(e=o.active)&&e),i&&this.setStrikeThrough(null!=(n=i.active)&&n)}setUndo(){this.setUIObserve({name:"undo"})}setRedo(){this.setUIObserve({name:"redo"})}setFontFamily(t){const e={name:"fontFamily",value:t};this.setUIObserve(e)}setFontSize(t){const e={name:"fontSize",value:t};this.setUIObserve(e)}setFontWeight(t){const e={name:"fontWeight",value:t};this.setUIObserve(e)}setFontStyle(t){const e={name:"fontStyle",value:t};this.setUIObserve(e)}setStrikeThrough(t){const e={name:"strikeThrough",value:t};this.setUIObserve(e)}setUnderline(t){const e={name:"underLine",value:t};this.setUIObserve(e)}setFontColor(t){const e={name:"fontColor",value:t};this.setUIObserve(e)}setBackground(t){const e={name:"background",value:t};this.setUIObserve(e)}setTextRotation(t){const e={name:"textRotation",value:t};this.setUIObserve(e)}setWrapStrategy(t){const e={name:"wrapStrategy",value:t};this.setUIObserve(e)}setVerticalAlignment(t){const e={name:"verticalAlignment",value:t};this.setUIObserve(e)}setHorizontalAlignment(t){const e={name:"horizontalAlignment",value:t};this.setUIObserve(e)}hideTooltip(){this._toolbar.base.querySelectorAll(`.${Ku}.${$u}`).forEach((t=>{t.style.display="none"}))}_changeToolbarState(t){var e,n,i,o,s,r,a,l;if(this._plugin.getContext().getUniver().getCurrentUniverSheetInstance().getWorkBook().getActiveSheet()){const h=t.getFontWeight(),c=t.getFontStyle(),d=t.getStrikeThrough(),u=t.getFontSize(),g=t.getFontWeight(),_=t.getFontFamily(),p=t.getFontStyle(),m=t.getUnderline(),T=null!=(e=t.getHorizontalAlignment())?e:Re.LEFT,f=null!=(n=t.getVerticalAlignment())?n:Oe.BOTTOM,v=t.getTextRotation(),E=null!=(i=t.getWrapStrategy())?i:Me.CLIP,I=this._toolList.find((t=>"bold"===t.name)),b=this._toolList.find((t=>"italic"===t.name)),A=this._toolList.find((t=>"textRotateMode"===t.name)),C=this._toolList.find((t=>"fontSize"===t.name)),S=this._toolList.find((t=>"font"===t.name)),N=this._toolList.find((t=>"bold"===t.name)),R=this._toolList.find((t=>"italic"===t.name)),w=this._toolList.find((t=>"strikethrough"===t.name)),O=this._toolList.find((t=>"underline"===t.name)),y=this._toolList.find((t=>"horizontalAlignMode"===t.name)),M=this._toolList.find((t=>"verticalAlignMode"===t.name)),D=this._toolList.find((t=>"textWrapMode"===t.name));I&&(I.active=h===ke.BOLD),b&&(b.active=c===Le.ITALIC),w&&(w.active=!(!d||!d.s)),S&&(null==(o=S.children)||o.forEach((t=>{t.selected=_===t.value}))),C&&(C.label=u.toString()),N&&(N.active=!!g),R&&(R.active=!!p),O&&(O.active=!(!m||!m.s)),y&&(null==(s=y.children)||s.forEach((t=>{t.selected=T===t.value}))),A&&(null==(r=A.children)||r.forEach((t=>{v.v?t.selected="v"===t.value:t.selected=v.a===t.value}))),M&&(null==(a=M.children)||a.forEach((t=>{t.selected=f===t.value}))),D&&(null==(l=D.children)||l.forEach((t=>{t.selected=E===t.value}))),this.setToolbar()}}_initialize(){this._plugin.getComponentManager().register("DocUI"+hg.name,hg),this._plugin.getComponentManager().register("DocUI"+xd.name,xd)}}class vg{constructor(t){var e;this.getComponent=t=>{var e;this._docContainer=t;let n=function(t){if(Ec(t.current))return t.current;let e=t.current;return e?null==e?void 0:e.base:t.base}(t.getContentRef());this._plugin.initRender(n),null==(e=this._plugin.getObserver("onUIDidMount"))||e.notifyObservers(this._docContainer),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onUIDidMountObservable","core").notifyObservers(!0),this._initDocContainer()},this.changeLocale=t=>{this._plugin.getContext().getLocale().change(t),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=t,this._config=this._plugin.getConfig(),this._initialize(),this._toolbarController=new fg(this._plugin,null==(e=this._config.layout)?void 0:e.toolbarConfig),this._infoBarController=new rg(this._plugin)}getUIConfig(){return{context:this._plugin.getContext(),config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent,methods:{toolbar:{getComponent:this._toolbarController.getComponent},infoBar:{getComponent:this._infoBarController.getComponent}}}}getContentRef(){return this._docContainer.getContentRef()}getToolbarController(){return this._toolbarController}UIDidMount(t){var e;if(this._docContainer)return t(this._docContainer);null==(e=this._plugin.getObserver("onUIDidMount"))||e.add((()=>t(this._docContainer)))}getDocContainer(){return this._docContainer}_initialize(){}_initDocContainer(){}}class Eg{constructor(t){this.changeLocale=t=>{this._plugin.getGlobalContext().getLocale().change(t),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=t,this._docContainerController=new vg(this._plugin);const e=this._docContainerController.getUIConfig();og.create({context:this._plugin.getGlobalContext(),locale:this._plugin.getGlobalContext().getLocale().getCurrentLocale(),changeLocale:this.changeLocale,UIConfig:e,container:this._plugin.getConfig().container})}getDocContainerController(){return this._docContainerController}}class Ig extends Ms{constructor(t){super("DocUI"),this._config=U.deepMerge({},Ou,t)}static create(t){return new Ig(t)}installTo(t){t.install(this)}initialize(t){this.getLocale().load({en:Ru,zh:Nu}),this._componentManager=new Td,this._appUIController=new Eg(this)}getConfig(){return this._config}initRender(t){var e;const n=null==(e=this.getPluginByName(nn.BASE_RENDER))?void 0:e.getEngine();n.setContainer(t),window.addEventListener("resize",(()=>{n.resize()})),setTimeout((()=>{n.resize()}),0)}getAppUIController(){return this._appUIController}getComponentManager(){return this._componentManager}getRegisterManager(){return this._registerManager}UIDidMount(t){this._appUIController.getDocContainerController().UIDidMount(t)}onMounted(t){this.initialize(t)}onDestroy(){}}const bg=new class{constructor(t={}){this._univerSheets=[],this._univerDocs=[],this._univerSlides=[],this._context=new ks(t),this._context.onUniver(this)}addUniverSheet(t){t.context.onUniver(this),this._univerSheets.push(t)}addUniverDoc(t){t.context.onUniver(this),this._univerDocs.push(t)}addUniverSlide(t){t.context.onUniver(this),this._univerSlides.push(t)}getUniverSheetInstance(t){return this._univerSheets.find((e=>e.getUnitId()===t))}getUniverDocInstance(t){return this._univerDocs.find((e=>e.getUnitId()===t))}getUniverSlideInstance(t){return null}getAllUniverSheetsInstance(){return this._univerSheets}getAllUniverDocsInstance(){return this._univerDocs}getAllUniverSlidesInstance(){return this._univerSlides}getCurrentUniverSheetInstance(){return this._univerSheets[0]}getCurrentUniverDocInstance(){return this._univerDocs[0]}getCurrentUniverSlideInstance(){return this._univerSlides[0]}getGlobalContext(){return this._context}install(t){this._context.getPluginManager().install(t)}uninstall(t){this._context.getPluginManager().uninstall(t)}};bg.install(new Rh);const Ag=Us.newInstance(Xh);bg.addUniverDoc(Ag),bg.install(new Su),Ag.installPlugin(new zh),bg.install(new Ig({container:"univerdoc",layout:{docContainerConfig:{innerLeft:!1}}}));
