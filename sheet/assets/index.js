const S6=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function t(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerpolicy&&(i.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?i.credentials="include":s.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=t(s);fetch(s.href,i)}};S6();var Fi,We,Gh,di,ju,Xh,Oo={},$h=[],A6=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function nr(r,e){for(var t in e)r[t]=e[t];return r}function Yh(r){var e=r.parentNode;e&&e.removeChild(r)}function b(r,e,t){var n,s,i,o={};for(i in e)i=="key"?n=e[i]:i=="ref"?s=e[i]:o[i]=e[i];if(arguments.length>2&&(o.children=arguments.length>3?Fi.call(arguments,2):t),typeof r=="function"&&r.defaultProps!=null)for(i in r.defaultProps)o[i]===void 0&&(o[i]=r.defaultProps[i]);return fi(r,o,n,s,null)}function fi(r,e,t,n,s){var i={type:r,props:e,key:t,ref:n,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:s==null?++Gh:s};return s==null&&We.vnode!=null&&We.vnode(i),i}function Ve(){return{current:null}}function yt(r){return r.children}function At(r,e){this.props=r,this.context=e}function vi(r,e){if(e==null)return r.__?vi(r.__,r.__.__k.indexOf(r)+1):null;for(var t;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null)return t.__e;return typeof r.type=="function"?vi(r):null}function jh(r){var e,t;if((r=r.__)!=null&&r.__c!=null){for(r.__e=r.__c.base=null,e=0;e<r.__k.length;e++)if((t=r.__k[e])!=null&&t.__e!=null){r.__e=r.__c.base=t.__e;break}return jh(r)}}function Ja(r){(!r.__d&&(r.__d=!0)&&di.push(r)&&!ko.__r++||ju!==We.debounceRendering)&&((ju=We.debounceRendering)||setTimeout)(ko)}function ko(){for(var r;ko.__r=di.length;)r=di.sort(function(e,t){return e.__v.__b-t.__v.__b}),di=[],r.some(function(e){var t,n,s,i,o,a;e.__d&&(o=(i=(t=e).__v).__e,(a=t.__P)&&(n=[],(s=nr({},i)).__v=i.__v+1,xl(a,i,s,t.__n,a.ownerSVGElement!==void 0,i.__h!=null?[o]:null,n,o==null?vi(i):o,i.__h),Jh(n,i),i.__e!=o&&jh(i)))})}function Kh(r,e,t,n,s,i,o,a,l,u){var c,h,f,d,m,g,p,_=n&&n.__k||$h,v=_.length;for(t.__k=[],c=0;c<e.length;c++)if((d=t.__k[c]=(d=e[c])==null||typeof d=="boolean"?null:typeof d=="string"||typeof d=="number"||typeof d=="bigint"?fi(null,d,null,null,d):Array.isArray(d)?fi(yt,{children:d},null,null,null):d.__b>0?fi(d.type,d.props,d.key,d.ref?d.ref:null,d.__v):d)!=null){if(d.__=t,d.__b=t.__b+1,(f=_[c])===null||f&&d.key==f.key&&d.type===f.type)_[c]=void 0;else for(h=0;h<v;h++){if((f=_[h])&&d.key==f.key&&d.type===f.type){_[h]=void 0;break}f=null}xl(r,d,f=f||Oo,s,i,o,a,l,u),m=d.__e,(h=d.ref)&&f.ref!=h&&(p||(p=[]),f.ref&&p.push(f.ref,null,d),p.push(h,d.__c||m,d)),m!=null?(g==null&&(g=m),typeof d.type=="function"&&d.__k===f.__k?d.__d=l=Zh(d,l,r):l=qh(r,d,f,_,m,l),typeof t.type=="function"&&(t.__d=l)):l&&f.__e==l&&l.parentNode!=r&&(l=vi(f))}for(t.__e=g,c=v;c--;)_[c]!=null&&ed(_[c],_[c]);if(p)for(c=0;c<p.length;c++)Qh(p[c],p[++c],p[++c])}function Zh(r,e,t){for(var n,s=r.__k,i=0;s&&i<s.length;i++)(n=s[i])&&(n.__=r,e=typeof n.type=="function"?Zh(n,e,t):qh(t,n,n,s,n.__e,e));return e}function zn(r,e){return e=e||[],r==null||typeof r=="boolean"||(Array.isArray(r)?r.some(function(t){zn(t,e)}):e.push(r)),e}function qh(r,e,t,n,s,i){var o,a,l;if(e.__d!==void 0)o=e.__d,e.__d=void 0;else if(t==null||s!=i||s.parentNode==null)e:if(i==null||i.parentNode!==r)r.appendChild(s),o=null;else{for(a=i,l=0;(a=a.nextSibling)&&l<n.length;l+=1)if(a==s)break e;r.insertBefore(s,i),o=i}return o!==void 0?o:s.nextSibling}function R6(r,e,t,n,s){var i;for(i in t)i==="children"||i==="key"||i in e||No(r,i,null,t[i],n);for(i in e)s&&typeof e[i]!="function"||i==="children"||i==="key"||i==="value"||i==="checked"||t[i]===e[i]||No(r,i,e[i],t[i],n)}function Ku(r,e,t){e[0]==="-"?r.setProperty(e,t):r[e]=t==null?"":typeof t!="number"||A6.test(e)?t:t+"px"}function No(r,e,t,n,s){var i;e:if(e==="style")if(typeof t=="string")r.style.cssText=t;else{if(typeof n=="string"&&(r.style.cssText=n=""),n)for(e in n)t&&e in t||Ku(r.style,e,"");if(t)for(e in t)n&&t[e]===n[e]||Ku(r.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")i=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in r?e.toLowerCase().slice(2):e.slice(2),r.l||(r.l={}),r.l[e+i]=t,t?n||r.addEventListener(e,i?qu:Zu,i):r.removeEventListener(e,i?qu:Zu,i);else if(e!=="dangerouslySetInnerHTML"){if(s)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in r)try{r[e]=t==null?"":t;break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?r.removeAttribute(e):r.setAttribute(e,t))}}function Zu(r){this.l[r.type+!1](We.event?We.event(r):r)}function qu(r){this.l[r.type+!0](We.event?We.event(r):r)}function xl(r,e,t,n,s,i,o,a,l){var u,c,h,f,d,m,g,p,_,v,w,y,A,I,R,x=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(l=t.__h,a=e.__e=t.__e,e.__h=null,i=[a]),(u=We.__b)&&u(e);try{e:if(typeof x=="function"){if(p=e.props,_=(u=x.contextType)&&n[u.__c],v=u?_?_.props.value:u.__:n,t.__c?g=(c=e.__c=t.__c).__=c.__E:("prototype"in x&&x.prototype.render?e.__c=c=new x(p,v):(e.__c=c=new At(p,v),c.constructor=x,c.render=x6),_&&_.sub(c),c.props=p,c.state||(c.state={}),c.context=v,c.__n=n,h=c.__d=!0,c.__h=[],c._sb=[]),c.__s==null&&(c.__s=c.state),x.getDerivedStateFromProps!=null&&(c.__s==c.state&&(c.__s=nr({},c.__s)),nr(c.__s,x.getDerivedStateFromProps(p,c.__s))),f=c.props,d=c.state,h)x.getDerivedStateFromProps==null&&c.componentWillMount!=null&&c.componentWillMount(),c.componentDidMount!=null&&c.__h.push(c.componentDidMount);else{if(x.getDerivedStateFromProps==null&&p!==f&&c.componentWillReceiveProps!=null&&c.componentWillReceiveProps(p,v),!c.__e&&c.shouldComponentUpdate!=null&&c.shouldComponentUpdate(p,c.__s,v)===!1||e.__v===t.__v){for(c.props=p,c.state=c.__s,e.__v!==t.__v&&(c.__d=!1),c.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(S){S&&(S.__=e)}),w=0;w<c._sb.length;w++)c.__h.push(c._sb[w]);c._sb=[],c.__h.length&&o.push(c);break e}c.componentWillUpdate!=null&&c.componentWillUpdate(p,c.__s,v),c.componentDidUpdate!=null&&c.__h.push(function(){c.componentDidUpdate(f,d,m)})}if(c.context=v,c.props=p,c.__v=e,c.__P=r,y=We.__r,A=0,"prototype"in x&&x.prototype.render){for(c.state=c.__s,c.__d=!1,y&&y(e),u=c.render(c.props,c.state,c.context),I=0;I<c._sb.length;I++)c.__h.push(c._sb[I]);c._sb=[]}else do c.__d=!1,y&&y(e),u=c.render(c.props,c.state,c.context),c.state=c.__s;while(c.__d&&++A<25);c.state=c.__s,c.getChildContext!=null&&(n=nr(nr({},n),c.getChildContext())),h||c.getSnapshotBeforeUpdate==null||(m=c.getSnapshotBeforeUpdate(f,d)),R=u!=null&&u.type===yt&&u.key==null?u.props.children:u,Kh(r,Array.isArray(R)?R:[R],e,t,n,s,i,o,a,l),c.base=e.__e,e.__h=null,c.__h.length&&o.push(c),g&&(c.__E=c.__=null),c.__e=!1}else i==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=D6(t.__e,e,t,n,s,i,o,l);(u=We.diffed)&&u(e)}catch(S){e.__v=null,(l||i!=null)&&(e.__e=a,e.__h=!!l,i[i.indexOf(a)]=null),We.__e(S,e,t)}}function Jh(r,e){We.__c&&We.__c(e,r),r.some(function(t){try{r=t.__h,t.__h=[],r.some(function(n){n.call(t)})}catch(n){We.__e(n,t.__v)}})}function D6(r,e,t,n,s,i,o,a){var l,u,c,h=t.props,f=e.props,d=e.type,m=0;if(d==="svg"&&(s=!0),i!=null){for(;m<i.length;m++)if((l=i[m])&&"setAttribute"in l==!!d&&(d?l.localName===d:l.nodeType===3)){r=l,i[m]=null;break}}if(r==null){if(d===null)return document.createTextNode(f);r=s?document.createElementNS("http://www.w3.org/2000/svg",d):document.createElement(d,f.is&&f),i=null,a=!1}if(d===null)h===f||a&&r.data===f||(r.data=f);else{if(i=i&&Fi.call(r.childNodes),u=(h=t.props||Oo).dangerouslySetInnerHTML,c=f.dangerouslySetInnerHTML,!a){if(i!=null)for(h={},m=0;m<r.attributes.length;m++)h[r.attributes[m].name]=r.attributes[m].value;(c||u)&&(c&&(u&&c.__html==u.__html||c.__html===r.innerHTML)||(r.innerHTML=c&&c.__html||""))}if(R6(r,f,h,s,a),c)e.__k=[];else if(m=e.props.children,Kh(r,Array.isArray(m)?m:[m],e,t,n,s&&d!=="foreignObject",i,o,i?i[0]:t.__k&&vi(t,0),a),i!=null)for(m=i.length;m--;)i[m]!=null&&Yh(i[m]);a||("value"in f&&(m=f.value)!==void 0&&(m!==r.value||d==="progress"&&!m||d==="option"&&m!==h.value)&&No(r,"value",m,h.value,!1),"checked"in f&&(m=f.checked)!==void 0&&m!==r.checked&&No(r,"checked",m,h.checked,!1))}return r}function Qh(r,e,t){try{typeof r=="function"?r(e):r.current=e}catch(n){We.__e(n,t)}}function ed(r,e,t){var n,s;if(We.unmount&&We.unmount(r),(n=r.ref)&&(n.current&&n.current!==r.__e||Qh(n,null,e)),(n=r.__c)!=null){if(n.componentWillUnmount)try{n.componentWillUnmount()}catch(i){We.__e(i,e)}n.base=n.__P=null,r.__c=void 0}if(n=r.__k)for(s=0;s<n.length;s++)n[s]&&ed(n[s],e,t||typeof r.type!="function");t||r.__e==null||Yh(r.__e),r.__=r.__e=r.__d=void 0}function x6(r,e,t){return this.constructor(r,t)}function Is(r,e,t){var n,s,i;We.__&&We.__(r,e),s=(n=typeof t=="function")?null:t&&t.__k||e.__k,i=[],xl(e,r=(!n&&t||e).__k=b(yt,null,[r]),s||Oo,Oo,e.ownerSVGElement!==void 0,!n&&t?[t]:s?null:e.firstChild?Fi.call(e.childNodes):null,i,!n&&t?t:s?s.__e:e.firstChild,n),Jh(i,r)}function td(r,e){Is(r,e,td)}function nd(r,e,t){var n,s,i,o=nr({},r.props);for(i in e)i=="key"?n=e[i]:i=="ref"?s=e[i]:o[i]=e[i];return arguments.length>2&&(o.children=arguments.length>3?Fi.call(arguments,2):t),fi(r.type,o,n||r.key,s||r.ref,null)}function rd(r,e){var t={__c:e="__cC"+Xh++,__:r,Consumer:function(n,s){return n.children(s)},Provider:function(n){var s,i;return this.getChildContext||(s=[],(i={})[e]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(o){this.props.value!==o.value&&s.some(Ja)},this.sub=function(o){s.push(o);var a=o.componentWillUnmount;o.componentWillUnmount=function(){s.splice(s.indexOf(o),1),a&&a.call(o)}}),n.children}};return t.Provider.__=t.Consumer.contextType=t}Fi=$h.slice,We={__e:function(r,e,t,n){for(var s,i,o;e=e.__;)if((s=e.__c)&&!s.__)try{if((i=s.constructor)&&i.getDerivedStateFromError!=null&&(s.setState(i.getDerivedStateFromError(r)),o=s.__d),s.componentDidCatch!=null&&(s.componentDidCatch(r,n||{}),o=s.__d),o)return s.__E=s}catch(a){r=a}throw r}},Gh=0,At.prototype.setState=function(r,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=nr({},this.state),typeof r=="function"&&(r=r(nr({},t),this.props)),r&&nr(t,r),r!=null&&this.__v&&(e&&this._sb.push(e),Ja(this))},At.prototype.forceUpdate=function(r){this.__v&&(this.__e=!0,r&&this.__h.push(r),Ja(this))},At.prototype.render=yt,di=[],ko.__r=0,Xh=0;var $t=(r=>(r[r.OBSERVER_ACTION=1]="OBSERVER_ACTION",r[r.SERVER_ACTION=2]="SERVER_ACTION",r[r.UNDO_ACTION=3]="UNDO_ACTION",r[r.EXTENSION_ACTION=4]="EXTENSION_ACTION",r[r.DEFAULT_ACTION=7]="DEFAULT_ACTION",r))($t||{});class sd{constructor(e,t){this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionDaa(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class Qe extends sd{constructor(e,t,n){if(super(e,n),t.WorkBookUnit==null)throw new Error("action workbook domain can not be null!");this._workbook=t.WorkBookUnit}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:n}=t;return e.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class I6{constructor(e=!1){this.isStopPropagation=!1,this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class O6{constructor(e){this.callback=e,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class Ae{constructor(e){this._observers=new Array,this._eventState=new I6,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,n=!1){if(!e)return null;const s=new O6(e);return s.unregisterOnNextCall=n,t?this._observers.unshift(s):this._observers.push(s),this._onObserverAdded&&this._onObserverAdded(s),s}addOnce(e){return this.add(e,void 0,!0)}remove(e){return e&&this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1}removeCallback(e){for(let t=0;t<this._observers.length;t++){const n=this._observers[t];if(!n._willBeUnregistered&&n.callback===e)return this._deferUnregister(n),!0}return!1}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return t!==-1?(this._observers.splice(t,1),!0):!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let n=!1;for(let s=0;s<this._observers.length;s++){const i=this._observers[s];if(!i._willBeUnregistered&&(t.lastReturnValue=i.callback(e,t),i.unregisterOnNextCall&&this._deferUnregister(i),t.isStopPropagation&&(n=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}return{lastReturnValue:t.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const n=this._eventState;n.skipNextObservers=!1;for(let s=0;s<this._observers.length;s++){const i=this._observers[s];n.skipNextObservers||i._willBeUnregistered||(t=t.then(()=>i.callback(e,n)),i.unregisterOnNextCall&&this._deferUnregister(i))}return t.then(()=>e)}notifyObserver(e,t){if(e._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,e.callback(t,n),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new Ae;return e._observers=this._observers.slice(0),e}}class k6{constructor(e,t){this.name=e,this.observableHooks=t}}class N6{constructor(){this._observableHooksArray=new Array}addHooks(e,t){this._observableHooksArray.push(new k6(e,t))}getHooks(e){const t=this._observableHooksArray.find(n=>n.name===e);return t?t.observableHooks:null}}function M6(r,e){let t=0,n=r.length-1;for(;t<=n;){let s=Math.floor((n+t)/2);if(e<r[s]&&(s===0||e>=r[s-1]))return s;if(e>=r[s])t=s+1;else if(e<r[s])n=s-1;else return-1}return-1}function F6(r,e){let t=0,n=0,s=0,i=-1,o=r.length-1;for(;t<r.length&&o>=0&&o>=t;){if(n=r[o],o===0?s=0:s=r[o-1],e>=s&&e<n){i=o;break}if(n=r[t],t===0?s=0:s=r[t-1],e>=s&&e<n){i=t;break}t++,o--}return i}function Un(r,e){let t=r.length-1;return r.length<40||e<=r[20]||e>=r[t-20]?t=F6(r,e):t=M6(r,e),t}const Mn=r=>r!=null;class tt{static objectKeys(e){if(e){const t=Object.keys(e),n=t.indexOf("length");return n>-1&&t.splice(n,1),t}return[]}static getMaxLength(e){if(e){if(e.length)return e.length;const t=tt.objectKeys(e);if(t.length)return Math.max(...t)+1}return 0}constructor(...e){if(G.hasLength(e,1)){if(G.isObject(e[0])){this._array=e[0],this._length=tt.getMaxLength(this._array);return}if(G.isNumber(e[0])){this._array={},this._length=e[0];return}}if(G.hasLength(e,2)){const t=e[0],n=e[1];this._array=t,this._length=n;return}G.hasLength(e,0)&&(this._array={},this._length=0)}obtain(e,t){var n;return(n=this._array[e])!=null?n:t}getKeys(){return tt.objectKeys(this._array)}get(e){return this._array[e]}set(e,t){if(Mn(t)){const n=this._length;this._array[e]=t,e>=n&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const n=e-1,s=t[n];return n>0&&(delete t[n],this._length--),s}return null}push(e){if(Mn(e)){let t=this._length;const n=this._array;n[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],n=e-1;let s;for(let i=0;i<n;i++)s=this._array[i+1],Mn(s)&&(this._array[i]=s);return this._length--,delete this._array[n],t}return null}unshift(e){if(Mn(e)){const t=this._length,n=this._array,s=t+1;let i=n[0];for(let o=1;o<s;o++){const a=this._array[o];Mn(i)&&(n[o]=i),i=a}n[0]=e,this._length=s}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return{...this._array,length:this._length}}toArray(){const e=new Array,t=this._array,n=Object.keys(t),s=n.length;for(let i=0;i<s;i++){const o=+n[i];e[o]=t[o]}return e}forEach(e){const t=this._array,n=Object.keys(t),s=n.length;for(let i=0;i<s;i++){const o=+n[i];if(e(o,t[o])===!1)return this}return this}clone(e){const t=new tt;return e?this.forEach((n,s)=>{t.set(n,e(s))}):this.forEach((n,s)=>{t.set(n,s)}),t}isEmpty(){const e=this._array;return Object.keys(e).length===0}delete(e){this.splice(e,1)}includes(e){const t=this._array,n=Object.keys(t),s=n.length;for(let i=0;i<s;i++){const o=+n[i];if(t[o]===e)return!0}return!1}slice(e,t){const n=this._array;if(this._length>0){const i={};let o=0;for(let a=e;a<t;a++){const l=n[a];Mn(l)&&(i[o]=n[a],o++)}return new tt(i,o)}return new tt}concat(e){const t=this._array,n=Object.keys(t),s=n.length,i=e._array,o=Object.keys(i),a=o.length,l=new tt(s+a),u=l._array;let c=0;for(let h=0;h<s;h++,c++){const f=n[h];u[c]=t[f]}for(let h=0;h<a;h++,c++){const f=o[h];u[c]=i[f]}return l}find(e){const t=this._array,n=Object.keys(t),s=n.length;for(let i=0;i<s;i++){const o=+n[i],a=t[o];if(e(o,a)===!0)return a}return null}splice(e,t){const n=this._length;if(n>0){const s=e+t,i=this._array;let o=0;const a={};for(let c=e;c<s;c++){const h=i[c];Mn(h)&&(delete i[c],a[o]=h,o++)}const l=s-e,u=n;if(this._length-=l,this._length<=0)this._array={},this._length=0;else for(let c=s;c<u;c++){const h=i[c];Mn(h)&&(i[c-l]=i[c],delete i[c])}return new tt(a,o)}return new tt}findIndex(e){const t=this._array,n=Object.keys(t),s=n.length;for(let i=0;i<s;i++){const o=+n[i];if(e(o,t[o])===!0)return i}return-1}map(e){const t=this._array,n=Object.keys(t),s=n.length,i={};for(let o=0;o<s;o++){const a=+n[o],l=t[a];i[o]=e(l)}return new tt(i)}filter(e){const t=this._array,n=Object.keys(t),s=n.length,i={};let o=0;for(let a=0;a<s;a++){const l=+n[a],u=t[l];e(l,u)&&(i[o]=u,o++)}return new tt(i,o)}insert(e,t){const n=this._length,s=this._array;for(let i=n-1;i>=e;i--)s[i+1]=s[i];return s[e]=t,this._length=n+1,this}inserts(e,t){const n=t._array,s=t._length,i=this._array,a=this._length-1;for(let l=a;l>=e;l--){const u=i[l];Mn(u)&&(delete i[l],i[l+s]=u)}for(let l=0;l<s;l++){const u=n[l];Mn(u)&&(i[l+e]=n[l])}return this._length+=s,this}[Symbol.iterator](){return new Il(this)}}class Il{constructor(e){this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,n=this._cursor;if(n<t.length){const s=t[n],i=e.get(+s);return this._cursor++,{value:i,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new Il(this._array)}}class pe{constructor(e={}){if(G.isAssignableFrom(e,pe)){this._matrix=e._matrix;return}if(G.isAssignableFrom(e,tt)){this._matrix=e;return}G.isPlainObject(e)&&(this._matrix=new tt(e))}getMatrix(){return this._matrix}forEach(e){const n=this._matrix.getKeys(),s=n.length;for(let i=0;i<s;i++){const o=+n[i],a=this.getRow(o);if(e(o,a)===!1)return this}return this}forValue(e){const n=this._matrix.getKeys(),s=n.length;for(let i=0;i<s;i++){const o=+n[i],a=this.getRow(o),l=a.getKeys(),u=l.length;for(let c=0;c<u;c++){const h=+l[c],f=a.get(h);if(e(o,h,f)===!1)return this}}return this}swapRow(e,t){const n=this._matrix.get(e),s=this._matrix.get(t);this._matrix.set(t,n),this._matrix.set(e,s)}getRow(e){const{_matrix:t}=this;let n=t.get(e);if(G.isAssignableFrom(n,tt))return n;if(G.isPlainObject(n))return n=new tt(n),t.set(e,n),n}getRowOrCreate(e){const t=this.getRow(e);if(t)return t;const n=new tt;return this._matrix.set(e,n),n}reset(){this._matrix=new tt({})}hasValue(){const e=this._matrix;for(const t of e)if(!t.isEmpty())return!0;return!1}getValue(e,t){const n=this.getRow(e);return n?n.get(t):null}setValue(e,t,n){this.getRowOrCreate(e).set(t,n)}deleteValue(e,t){const n=this.getRow(e);n&&n.delete(t)}spliceRows(e,t){const n=this._matrix.splice(e,t);return new pe(n)}pushRow(e){this._matrix.push(e)}insertRow(e,t){this._matrix.insert(e,t)}insertRows(e,t){this._matrix.inserts(e,t._matrix)}spliceColumns(e,t){const n=new pe;return this._matrix.forEach((s,i)=>{var o;for(let a=e;a<e+t;a++)n.setValue(s,a-e,this.getValue(s,a));(o=this._matrix.get(s))==null||o.splice(e,t)}),n}insertColumns(e,t){const n=t.getRow(0).getLength();this.forEach((s,i)=>{var o,a;for(let l=e;l<e+n;l++)(o=t.getRow(s))==null||o.get(l-e),i.insert(l,(a=t.getRow(s))==null?void 0:a.get(l-e))})}getFragments(e,t,n,s){const i=new pe;for(let o=e;o<=t;o++){const a=new tt;for(let l=n;l<=s;l++){const u=this.getValue(o,l);a.push(u)}i.pushRow(a)}return i}getSizeOf(){return this._matrix.getSizeOf()}getLength(){return this._matrix.getLength()}getRange(){const n=this.getSizeOf();let s=0;const i=this.getLength();for(let o=0;o<i;o++){const a=this.getRow(o);if(a){const l=a.getSizeOf();a.getSizeOf()>s&&(s=l-1)}}return{startRow:0,startColumn:0,endRow:n,endColumn:s}}toArray(){return this._matrix.toArray().map(e=>e.toArray())}toJSON(){const{_matrix:e}=this;return e.toJSON()}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,n=!1,s=!1;const i=new pe;return this.forEach((o,a)=>{n||(n=!0,e=o),a.forEach((l,u)=>{s?l<t&&(t=l):(s=!0,t=l);const c=this.getValue(o,l);i.setValue(o-e,l-t,c)})}),i.getData()}getDataRange(){let e=0,t=0,n=0,s=!1,i=!1;this.forEach((a,l)=>{s||(s=!0,e=a);const u=l.getLength()-1;u>n&&(n=u),l.forEach((c,h)=>{i?c<t&&(t=c):(i=!0,t=c)})});const o=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:o,endColumn:n}}}const B6=/^-ms-/,L6=/-([a-z])/g,lr=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class G{static stringAt(e){let t="",n=e;for(;n>=lr.length;)n/=lr.length,n-=1,t+=lr[n%lr.length];const s=e%lr.length;return t+=lr[s],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let n=0;n<e.length-1;n+=1){const s=e.charCodeAt(n)-65,i=e.length-1-n;t+=lr.length**i+lr.length*s}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return G.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t=navigator.platform==="Win32"||navigator.platform==="Windows",n=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(n)return"Mac";if(navigator.platform==="X11"&&!t&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,n=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,s=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,i=e.indexOf("Edge")>-1,o=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,l=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const c=parseFloat(RegExp.$1);return c===7?"IE7":c===8?"IE8":c===9?"IE9":c===10?"IE10":"0"}return o?"FF":t?"Opera":a?"Safari":l?"Chrome":i?"Edge":s?"IE11":"Unknown browser"}static generateRandomId(){function e(){return((1+Math.random())*65536|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){t.forEach(o=>o&&i(o));function n(o,a){o.forEach((l,u)=>{var c,h;if(G.isArray(l)){const f=(c=a[u])!=null?c:[];a[u]=f,n(l,f);return}if(G.isObject(l)){const f=(h=a[u])!=null?h:{};a[u]=f,s(l,f);return}a[u]=l})}function s(o,a){Object.keys(o).forEach(l=>{var c,h;const u=o[l];if(G.isObject(u)){const f=(c=a[l])!=null?c:{};a[l]=f,s(u,f);return}if(G.isArray(u)){const f=(h=a[l])!=null?h:[];a[l]=f,n(u,f);return}a[l]=u})}function i(o){Object.keys(o).forEach(a=>{var u,c;const l=o[a];if(G.isArray(l)){const h=(u=e[a])!=null?u:[];e[a]=h,n(l,h);return}if(G.isObject(l)){const h=(c=e[a])!=null?c:{};e[a]=h,s(l,h);return}e[a]=l})}return e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function n(o,a){const l=G.getValueType(o),u=G.getValueType(a);return l!==u?!1:G.isArray(o)?s(o,a):G.isObject(o)?i(o,a):G.isDate(o)?o.getTime()===a.getTime():G.isRegExp(o)?o.toString()===a.toString():o===a}function s(o,a){if(e.length!==t.length)return!1;for(let l=0,u=o.length;l<u;l++){const c=o[l],h=a[l];if(!n(c,h))return!1}return!0}function i(o,a){const l=Object.keys(o),u=Object.keys(a);if(l.length!==u.length)return!1;for(const c of l){if(!u.includes(c))return!1;const h=o[c],f=a[c];if(!n(h,f))return!1}return!0}return n(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach((n,s)=>{t[s]=G.deepClone(n)}),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach(n=>{const s=e[n];t[n]=G.deepClone(s)}),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return this.getValueType(e)==="[object Boolean]"}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isFunction(e){return this.getValueType(e)==="[object Function]"}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return String(e.match(/MicroMessenger/i))==="micromessenger"}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let n=0;n<e;n++)t&&t()}}static hasLength(e,t){return G.isDefine(e)?G.isDefine(t)?e.length===t:e.length>0:!1}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(B6,"ms-").replace(L6,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach(n=>{const s=e[n];s==null?delete e[n]:G.removeNull(s)}),t}return e}static fillTwoDimensionalArray(e,t,n){return new Array(e).fill(n).map(s=>new Array(t).fill(n))}static fillObjectMatrix(e,t,n){const s=new pe;for(let i=0;i<e;i++)for(let o=0;o<t;o++)s.setValue(i,o,n);return s.getData()}static numToWord(e){let t="";for(;e>0;){let n=e%26;n=n===0?n=26:n,t=String.fromCharCode(96+n)+t,e=(e-n)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return NaN;const t=e.toLowerCase().split(""),n=t.length;let s=0,i=0;for(let o=0;o<n;o++)i=t[o].charCodeAt(0)-96,s+=i*26**(n-o-1);return s===0?NaN:s-1}static chatAtABC(e){const t="a".charCodeAt(0),s="z".charCodeAt(0)-t+1;let i="";for(;e>=0;)i=String.fromCharCode(e%s+t)+i,e=Math.floor(e/s)-1;return i.toUpperCase()}static randSort(e){for(let t=0,n=e.length;t<n;t++){const s=parseInt((Math.random()*n).toString()),i=e[s];e[s]=e[t],e[t]=i}return e}static commonExtend(e,t){let n={};for(let s in e)n[s]=e[s];for(let s in t)t[s]!=null&&(n[s]=t[s]);return n}static commonExtend1(e,t){for(let n in e)t[n]==null&&(t[n]=e[n]);return t}static arrayToObject(e){const t={};return e.forEach((n,s)=>{t[s]={},n.forEach((i,o)=>{t[s][o]=i})}),t}}var Qa=(r=>(r[r.DEFAULT_SERIES=0]="DEFAULT_SERIES",r[r.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",r))(Qa||{}),C=(r=>(r[r.NONE=0]="NONE",r[r.THIN=1]="THIN",r[r.HAIR=2]="HAIR",r[r.DOTTED=3]="DOTTED",r[r.DASHED=4]="DASHED",r[r.DASH_DOT=5]="DASH_DOT",r[r.DASH_DOT_DOT=6]="DASH_DOT_DOT",r[r.DOUBLE=7]="DOUBLE",r[r.MEDIUM=8]="MEDIUM",r[r.MEDIUM_DASHED=9]="MEDIUM_DASHED",r[r.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",r[r.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",r[r.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",r[r.THICK=13]="THICK",r))(C||{}),En=(r=>(r.TOP="top",r.BOTTOM="bottom",r.LEFT="left",r.RIGHT="right",r.NONE="none",r.ALL="all",r.OUTSIDE="outside",r.INSIDE="inside",r.HORIZONTAL="horizontal",r.VERTICAL="vertical",r))(En||{}),Dn=(r=>(r[r.UNSUPPORTED=0]="UNSUPPORTED",r[r.RGB=1]="RGB",r[r.HEX=2]="HEX",r[r.THEME=3]="THEME",r))(Dn||{}),ti=(r=>(r[r.PASTE_NORMAL=0]="PASTE_NORMAL",r[r.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",r[r.PASTE_FORMAT=2]="PASTE_FORMAT",r[r.PASTE_FORMULA=3]="PASTE_FORMULA",r[r.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",r[r.PASTE_VALUES=5]="PASTE_VALUES",r[r.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",r[r.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",r))(ti||{}),jr=(r=>(r[r.COLUMNS=0]="COLUMNS",r[r.ROWS=1]="ROWS",r))(jr||{}),Q=(r=>(r[r.LEFT=0]="LEFT",r[r.RIGHT=1]="RIGHT",r[r.TOP=2]="TOP",r[r.BOTTOM=3]="BOTTOM",r))(Q||{}),el=(r=>(r[r.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",r[r.TEXT=1]="TEXT",r[r.NUMBER=2]="NUMBER",r[r.PERCENT=3]="PERCENT",r[r.CURRENCY=4]="CURRENCY",r[r.DATE=5]="DATE",r[r.TIME=6]="TIME",r[r.DATE_TIME=7]="DATE_TIME",r[r.SCIENTIFIC=8]="SCIENTIFIC",r))(el||{}),fr=(r=>(r[r.BACKSPACE=8]="BACKSPACE",r[r.TAB=9]="TAB",r[r.ENTER=13]="ENTER",r[r.SHIFT=16]="SHIFT",r[r.CTRL=17]="CTRL",r[r.PAUSE=19]="PAUSE",r[r.CAPS_LOCK=20]="CAPS_LOCK",r[r.ESC=27]="ESC",r[r.SPACE=33]="SPACE",r[r.PAGE_UP=33]="PAGE_UP",r[r.PAGE_DOWN=34]="PAGE_DOWN",r[r.END=35]="END",r[r.HOME=36]="HOME",r[r.LEFT=37]="LEFT",r[r.UP=38]="UP",r[r.RIGHT=39]="RIGHT",r[r.DOWN=40]="DOWN",r[r.INSERT=45]="INSERT",r[r.DELETE=46]="DELETE",r[r.WIN=91]="WIN",r[r.WIN_R=92]="WIN_R",r[r.MENU=93]="MENU",r[r.F1=112]="F1",r[r.F2=113]="F2",r[r.F3=114]="F3",r[r.F4=115]="F4",r[r.F5=116]="F5",r[r.F6=117]="F6",r[r.F7=118]="F7",r[r.F8=119]="F8",r[r.F9=120]="F9",r[r.F10=121]="F10",r[r.F11=122]="F11",r[r.F12=123]="F12",r[r.NUM_LOCK=144]="NUM_LOCK",r[r.SCROLL_LOCK=145]="SCROLL_LOCK",r))(fr||{}),pn=(r=>(r.EN="en",r.ZH="zh",r))(pn||{}),Dt=(r=>(r[r.GRID=0]="GRID",r[r.KANBAN=1]="KANBAN",r[r.GANTT=2]="GANTT",r))(Dt||{}),Ci=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",r[r.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",r))(Ci||{}),Et=(r=>(r[r.DASH=0]="DASH",r[r.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",r[r.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",r[r.DASHED_HEAVY=3]="DASHED_HEAVY",r[r.DASH_LONG=4]="DASH_LONG",r[r.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",r[r.DOT_DASH=6]="DOT_DASH",r[r.DOT_DOT_DASH=7]="DOT_DOT_DASH",r[r.DOTTED=8]="DOTTED",r[r.DOTTED_HEAVY=9]="DOTTED_HEAVY",r[r.DOUBLE=10]="DOUBLE",r[r.NONE=11]="NONE",r[r.SINGLE=12]="SINGLE",r[r.THICK=13]="THICK",r[r.WAVE=14]="WAVE",r[r.WAVY_DOUBLE=15]="WAVY_DOUBLE",r[r.WAVY_HEAVY=16]="WAVY_HEAVY",r[r.WORDS=17]="WORDS",r))(Et||{}),ct=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.LEFT=1]="LEFT",r[r.CENTER=2]="CENTER",r[r.RIGHT=3]="RIGHT",r[r.JUSTIFIED=4]="JUSTIFIED",r))(ct||{}),rn=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.TOP=1]="TOP",r[r.MIDDLE=2]="MIDDLE",r[r.BOTTOM=3]="BOTTOM",r))(rn||{}),Mt=(r=>(r[r.UNSPECIFIED=0]="UNSPECIFIED",r[r.OVERFLOW=1]="OVERFLOW",r[r.CLIP=2]="CLIP",r[r.WRAP=3]="WRAP",r))(Mt||{}),un=(r=>(r[r.NORMAL=0]="NORMAL",r[r.SUBSCRIPT=1]="SUBSCRIPT",r[r.SUPERSCRIPT=2]="SUPERSCRIPT",r))(un||{}),te=(r=>(r[r.FALSE=0]="FALSE",r[r.TRUE=1]="TRUE",r))(te||{}),On=(r=>(r[r.STRING=0]="STRING",r[r.NUMBER=1]="NUMBER",r[r.BOOLEAN=2]="BOOLEAN",r[r.FORCE_STRING=3]="FORCE_STRING",r))(On||{}),on=(r=>(r[r.DARK1=0]="DARK1",r[r.LIGHT1=1]="LIGHT1",r[r.DARK2=2]="DARK2",r[r.LIGHT2=3]="LIGHT2",r[r.ACCENT1=4]="ACCENT1",r[r.ACCENT2=5]="ACCENT2",r[r.ACCENT3=6]="ACCENT3",r[r.ACCENT4=7]="ACCENT4",r[r.ACCENT5=8]="ACCENT5",r[r.ACCENT6=9]="ACCENT6",r[r.HYPERLINK=10]="HYPERLINK",r[r.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",r))(on||{}),Ol=(r=>(r.OFFICE="Office",r.OFFICE_2007_2010="Office 2007-2010",r.GRAYSCALE="Grayscale",r.BLUE_WARM="Blue Warm",r.BLUE="Blue",r.BLUE_II="Blue II",r.BLUE_GREEN="Blue Green",r.GREEN="Green",r.GREEN_YELLOW="Green Yellow",r.YELLOW="Yellow",r.YELLOW_ORANGE="Yellow Orange",r.ORANGE="Orange",r.ORANGE_RED="Orange Red",r.RED_ORANGE="Red Orange",r.RED="Red",r.RED_VIOLET="Red Violet",r.VIOLET="Violet",r.VIOLET_II="Violet II",r.MEDIAN="Median",r.PAPER="Paper",r.MARQUEE="Marquee",r.SLIPSTREAM="Slipstream",r.Aspect="Aspect",r))(Ol||{}),Wt=(r=>(r[r.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",r[r.TEXT_BOX=1]="TEXT_BOX",r[r.RECTANGLE=2]="RECTANGLE",r[r.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",r[r.ELLIPSE=4]="ELLIPSE",r[r.ARC=5]="ARC",r[r.BENT_ARROW=6]="BENT_ARROW",r[r.BENT_UP_ARROW=7]="BENT_UP_ARROW",r[r.BEVEL=8]="BEVEL",r[r.BLOCK_ARC=9]="BLOCK_ARC",r[r.BRACE_PAIR=10]="BRACE_PAIR",r[r.BRACKET_PAIR=11]="BRACKET_PAIR",r[r.CAN=12]="CAN",r[r.CHEVRON=13]="CHEVRON",r[r.CHORD=14]="CHORD",r[r.CLOUD=15]="CLOUD",r[r.CORNER=16]="CORNER",r[r.CUBE=17]="CUBE",r[r.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",r[r.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",r[r.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",r[r.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",r[r.DECAGON=22]="DECAGON",r[r.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",r[r.DIAMOND=24]="DIAMOND",r[r.DODECAGON=25]="DODECAGON",r[r.DONUT=26]="DONUT",r[r.DOUBLE_WAVE=27]="DOUBLE_WAVE",r[r.DOWN_ARROW=28]="DOWN_ARROW",r[r.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",r[r.FOLDED_CORNER=30]="FOLDED_CORNER",r[r.FRAME=31]="FRAME",r[r.HALF_FRAME=32]="HALF_FRAME",r[r.HEART=33]="HEART",r[r.HEPTAGON=34]="HEPTAGON",r[r.HEXAGON=35]="HEXAGON",r[r.HOME_PLATE=36]="HOME_PLATE",r[r.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",r[r.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",r[r.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",r[r.LEFT_ARROW=40]="LEFT_ARROW",r[r.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",r[r.LEFT_BRACE=42]="LEFT_BRACE",r[r.LEFT_BRACKET=43]="LEFT_BRACKET",r[r.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",r[r.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",r[r.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",r[r.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",r[r.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",r[r.MATH_DIVIDE=49]="MATH_DIVIDE",r[r.MATH_EQUAL=50]="MATH_EQUAL",r[r.MATH_MINUS=51]="MATH_MINUS",r[r.MATH_MULTIPLY=52]="MATH_MULTIPLY",r[r.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",r[r.MATH_PLUS=54]="MATH_PLUS",r[r.MOON=55]="MOON",r[r.NO_SMOKING=56]="NO_SMOKING",r[r.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",r[r.OCTAGON=58]="OCTAGON",r[r.PARALLELOGRAM=59]="PARALLELOGRAM",r[r.PENTAGON=60]="PENTAGON",r[r.PIE=61]="PIE",r[r.PLAQUE=62]="PLAQUE",r[r.PLUS=63]="PLUS",r[r.QUAD_ARROW=64]="QUAD_ARROW",r[r.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",r[r.RIBBON=66]="RIBBON",r[r.RIBBON_2=67]="RIBBON_2",r[r.RIGHT_ARROW=68]="RIGHT_ARROW",r[r.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",r[r.RIGHT_BRACE=70]="RIGHT_BRACE",r[r.RIGHT_BRACKET=71]="RIGHT_BRACKET",r[r.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",r[r.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",r[r.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",r[r.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",r[r.SMILEY_FACE=76]="SMILEY_FACE",r[r.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",r[r.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",r[r.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",r[r.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",r[r.STAR_10=81]="STAR_10",r[r.STAR_12=82]="STAR_12",r[r.STAR_16=83]="STAR_16",r[r.STAR_24=84]="STAR_24",r[r.STAR_32=85]="STAR_32",r[r.STAR_4=86]="STAR_4",r[r.STAR_5=87]="STAR_5",r[r.STAR_6=88]="STAR_6",r[r.STAR_7=89]="STAR_7",r[r.STAR_8=90]="STAR_8",r[r.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",r[r.SUN=92]="SUN",r[r.TRAPEZOID=93]="TRAPEZOID",r[r.TRIANGLE=94]="TRIANGLE",r[r.UP_ARROW=95]="UP_ARROW",r[r.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",r[r.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",r[r.UTURN_ARROW=98]="UTURN_ARROW",r[r.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",r[r.WAVE=100]="WAVE",r[r.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",r[r.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",r[r.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",r[r.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",r[r.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",r[r.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",r[r.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",r[r.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",r[r.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",r[r.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",r[r.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",r[r.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",r[r.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",r[r.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",r[r.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",r[r.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",r[r.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",r[r.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",r[r.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",r[r.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",r[r.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",r[r.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",r[r.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",r[r.FLOW_CHART_OR=124]="FLOW_CHART_OR",r[r.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",r[r.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",r[r.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",r[r.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",r[r.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",r[r.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",r[r.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",r[r.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",r[r.ARROW_EAST=133]="ARROW_EAST",r[r.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",r[r.ARROW_NORTH=135]="ARROW_NORTH",r[r.SPEECH=136]="SPEECH",r[r.STARBURST=137]="STARBURST",r[r.TEARDROP=138]="TEARDROP",r[r.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",r[r.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",r[r.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",r[r.CUSTOM=142]="CUSTOM",r))(Wt||{});class jo{constructor(){this._colorType=Dn.UNSUPPORTED,this._themeColors=Ol.OFFICE,this._themeTint=0}asRgbColor(){return new Ko(this._rgbValue,this)}asThemeColor(){return new id(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Dn.THEME:return this.asThemeColor();case Dn.RGB:return this.asRgbColor();case Dn.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=Dn.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=Dn.THEME,this._themeColors=e}setThemeTint(e){this._colorType=Dn.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=Dn.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}const P6={[Ol.OFFICE]:{[on.ACCENT1]:"#4472C4",[on.ACCENT2]:"#ED7D31",[on.ACCENT3]:"#A5A5A5",[on.ACCENT4]:"#70AD47",[on.ACCENT5]:"#5B9BD5",[on.ACCENT6]:"#70AD47",[on.DARK1]:"#000000",[on.DARK2]:"#44546A",[on.LIGHT1]:"#FFFFFF",[on.LIGHT2]:"#E7E6E6",[on.HYPERLINK]:"#0563C1",[on.FOLLOWED_HYPERLINK]:"#954F72"}};class sr{static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,n=+`0x${e[2]}${e[3]}`,s=+`0x${e[4]}${e[5]}`;return new jo().setRgbColor(`rgb(${t},${n},${s})`).asRgbColor()}static hexToRgbString(e){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(i,o,a,l)=>o+o+a+a+l+l);const n=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let s=null;if(n){const i=parseInt(n[1],16),o=parseInt(n[2],16),a=parseInt(n[3],16);s=`rgba(${i},${o},${a})`}return s}constructor(e){this._builder=e}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new sr(this._builder)}equals(e){return!1}}class H6{constructor(e){const t=e.getRed()/255,n=e.getGreen()/255,s=e.getBlue()/255,i=e.getAlpha()/255,o=Math.min(t,Math.min(n,s)),a=Math.max(t,Math.max(n,s)),l=a-o;if(a===o){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(o+a)/2,this._lightness<.5?this._saturation=l/(a+o):this._saturation=l/(2-a-o),t===a&&(this._hue=(n-s)/l),n===a&&(this._hue=2+(s-t)/l),s===a&&(this._hue=4+(t-n)/l),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=i}asRgbColor(){const e=new jo;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let t;this._lightness<.5?t=this._lightness*(1+this._saturation):t=this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-t,s=this._hue/360,i=s+1/3,o=this.setColor(t,n,i),a=this.setColor(t,n,s),l=s-1/3,u=this.setColor(t,n,l);return e.setRgbColor(`rgba(${Math.round(o*255)},${Math.round(a*255)},${Math.round(u*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,n){n<0&&(n+=1),n>1&&(n-=1);let s;return 6*n<1?s=t+(e-t)*6*n:2*n<1?s=e:3*n<2?s=t+(e-t)*(2/3-n)*6:s=t,s}setLightness(e){this._lightness=e}}const gr=class extends sr{constructor(r,e){super(e);let t=r.match(gr.RGBA_EXTRACT);if(t){const n=+t[1],s=+t[2],i=+t[3],o=+t[4];this._cssString=r,this._red=n,this._green=s,this._blue=i,this._alpha=o;return}if(t=r.match(gr.RGB_EXTRACT),t){const n=+t[1],s=+t[2],i=+t[3];this._cssString=r,this._red=n,this._green=s,this._blue=i,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return sr.rgbColorToHexValue(this)}getRed(){let r=this._red+gr.RGB_COLOR_AMT;return r>255?r=255:r<0&&(r=0),r}getGreen(){let r=this._green+gr.RGB_COLOR_AMT;return r>255?r=255:r<0&&(r=0),r}getBlue(){let r=this._blue+gr.RGB_COLOR_AMT;return r>255?r=255:r<0&&(r=0),r}getAlpha(){return this._alpha}getColorType(){return Dn.RGB}clone(){return new gr(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(r){return r instanceof gr?r._red===this._red&&r._blue===this._blue&&r._green===this._green&&r._alpha===this._alpha:!1}getCssString(){return this._cssString}};let Ko=gr;Ko.RGB_COLOR_AMT=0;Ko.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*");Ko.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const fs=class extends sr{constructor(r,e,t,n){super(n),this._themeColorType=r,this._themeTint=e,this._themeColors=t}lumValue(r,e){if(r==null)return e;let t;return r<0?t=e*(1+r):t=e*(1-r)+(255-255*(1-r)),t}asRgbColor(){const r=P6[this._themeColors];if(r==null)throw new Error("not find themeColors type");const e=r.get(this._themeColorType);if(e==null)throw new Error("not find themeColors value");let t;if(fs._cacheThemeColor.has(this._themeColors)){if(t=fs._cacheThemeColor.get(this._themeColors),t.has(this._themeColorType))return t.get(this._themeColorType)}else t=new Map,fs._cacheThemeColor.set(this._themeColors,t);const n=new H6(sr.hexValueToRgbColor(e));n.setLightness(this.lumValue(this._themeTint,n.getLightness()*255)/255);const s=n.asRgbColor();return t.set(this._themeColorType,s),s}clone(){return new fs(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(r){return r instanceof fs?r._themeColorType===this._themeColorType:!1}getColorType(){return Dn.THEME}getThemeColorType(){return this._themeColorType}};let id=fs;id._cacheThemeColor=new Map;var W=(r=>(r.INSERT_ROW_DATA_ACTION="InsertRowDataAction",r.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",r.INSERT_ROW_ACTION="InsertRowAction",r.REMOVE_ROW_ACTION="RemoveRowAction",r.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",r.SET_RANGE_FORMULA_ACTION="SetRangeFormulaAction",r.SET_RANGE_FORMAT_ACTION="SetRangeFormatAction",r.SET_SELECTION_ACTION="SetSelectionActivateAction",r.SET_RANGE_DATA_ACTION="SetRangeDataAction",r.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",r.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",r.DELETE_RANGE_ACTION="DeleteRangeAction",r.INSERT_SHEET_ACTION="InsertSheetAction",r.REMOVE_SHEET_ACTION="RemoveSheetAction",r.CLEAR_RANGE_ACTION="ClearRangeAction",r.INSERT_RANGE_ACTION="InsertRangeAction",r.SET_TAB_COLOR_ACTION="SetTabColorAction",r.HIDE_SHEET_ACTION="SetWorkSheetHideAction",r.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",r.INSERT_COLUMN_ACTION="InsertColumnAction",r.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",r.REMOVE_COLUMN_ACTION="RemoveColumnAction",r.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",r.SET_HIDE_ROW_ACTION="SetRowHideAction",r.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",r.SET_SHOW_ROW_ACTION="SetRowShowAction",r.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",r.ADD_MERGE_ACTION="AddMergeAction",r.REMOVE_MERGE_ACTION="RemoveMergeAction",r.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",r.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",r.SET_BORDER_ACTION="SetBorderAction",r.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",r.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",r.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",r.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",r.DELETE_BANDING_ACTION="DeleteBandingAction",r.SET_BANDING_ACTION="SetBandingAction",r.ADD_BANDING_ACTION="AddBandingAction",r.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",r.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",r.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",r.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",r.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",r.SET_FROZEN_COLUMNS_ACTION="",r.SET_FROZEN_ROWS_ACTION="",r))(W||{});const $i={sheetId:"",rangeData:{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1}},U6={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1},z6={extensions:[],id:"",sheetOrder:[],socketEnable:te.FALSE,socketUrl:"",name:"",timeZone:"",appVersion:"",theme:"",skin:"",locale:pn.EN,creator:"",styles:{},sheets:{},lastModifiedBy:"",createdTime:"",modifiedTime:"",pluginMeta:{},namedRanges:[]},Vr={type:Dt.GRID,name:"",id:"sheet-01",tabColor:"",hidden:te.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:te.FALSE,showGridlines:te.TRUE,rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A1"],rightToLeft:te.FALSE,pluginMeta:{}},bo={ff:"Times New Roman",fs:14,it:te.FALSE,bl:te.FALSE,ul:{s:te.FALSE},st:{s:te.FALSE},ol:{s:te.FALSE},tr:{a:0,v:te.FALSE},td:Ci.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:ct.UNSPECIFIED,vt:rn.UNSPECIFIED,tb:Mt.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Ju={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var Je=(r=>(r.BASE_COMPONENT="baseComponent",r.BASE_RENDER="renderEngine",r.SPREADSHEET="spreadsheet",r.DOCUMENT="document",r.SLIDE="slide",r))(Je||{});class W6{constructor(e,t){this._workSheet=e,this._columnData=new tt(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const n=new tt;for(let s=e;s<e+t;s++){const i=this.getColumnOrCreate(s);n.push(i)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:n}=this,s=t.getConfig();let i=0;if(e.length===1)i=n.obtain(e[0],{hd:te.FALSE,w:s.defaultColumnWidth}).w;else if(e.length===2)for(let o=e[0];o<e[0]+e[1];o++)i+=n.obtain(o,{hd:te.FALSE,w:s.defaultColumnWidth}).w;return i}setColumnWidth(e,t){const n=this._workSheet.getContext(),s=this._workSheet.getCommandManager(),i={sheetId:this._workSheet.getSheetId(),actionName:W.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},o=new fe({WorkBookUnit:n.getWorkBook()},i);s.invoke(o)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:n}=this,s=t.getConfig(),i=n.get(e);if(i)return i;const o={w:s.defaultColumnWidth,hd:te.FALSE};return this._columnData.set(e,o),o}}function od(r,e){let t=[];for(let n=0;n<e.length;n++)r.add(e[n]);return t}function ad(r,e){let t=[];for(let n=0;n<e.length;n++)t=t.concat(r.remove(e[n]));return t}class V6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rectangles:this.do()},this.validate()}do(){const e=this.getWorkSheet();return od(e.getMerges(),this._doActionData.rectangles)}redo(){this.do()}undo(){const e=this.getWorkSheet();ad(e.getMerges(),this._doActionData.rectangles)}validate(){return!1}}function ld(r,e){r.push(e)}function ud(r,e){return r.find((t,n)=>t.namedRangeId===e?(r.splice(n,1),t):null)}class G6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={actionName:W.DELETE_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),ld(t,e)}redo(){this.do()}undo(){const{namedRangeId:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:W.ADD_NAMED_RANGE_ACTION,sheetId:t,namedRange:ud(n,e)}}validate(){return!1}}function X6(r,e,t){const{startRow:n,endRow:s,startColumn:i,endColumn:o}=t,a=new pe;for(let l=n;l<=s;l++)for(let u=i;u<=o;u++){const c=r.getValue(l,u);a.setValue(l,u,G.deepClone(c)),c&&(e.formatOnly&&delete c.s,e.contentsOnly&&(c.v="",c.m=""),r.setValue(l,u,G.deepClone(c)))}return a.getData()}function cd(r,e,t,n){const{startRow:s,endRow:i,startColumn:o,endColumn:a}=n,l=i-s+1,u=a-o+1,c=r.rowCount,h=r.columnCount,f=new pe;if(t===jr.ROWS)for(let d=s;d<=c;d++)for(let m=o;m<=a;m++){if(d<=i){const p=e.getValue(d,m);f.setValue(d,m,p)}const g=e.getValue(d+l,m);g?e.setValue(d,m,G.deepClone(g)):e.getValue(d,m)&&(e.deleteValue(d,m),m--)}else if(t===jr.COLUMNS)for(let d=s;d<=i;d++)for(let m=o;m<=h;m++){if(m<=a){const p=e.getValue(d,m);f.setValue(d,m,p)}else for(let p=0;p<=a;p++){const _=e.getValue(d,m);f.setValue(d,m+p,_)}const g=e.getValue(d,m+u);if(g)e.setValue(d,m,G.deepClone(g));else if(e.getValue(d,m)){for(let _=0;_<=a;_++)e.deleteValue(d,m);break}}return f.getData()}function Qu(r,e){const t=r.getConfig(),n=t.hidden;return t.hidden=e,n}function hd(r=0,e=1,t){new tt(t).inserts(r,new tt(e))}function dd(r,e,t){new pe(t).insertColumns(r,new pe(e))}function fd(r,e,t){new pe(t).insertRows(r,new pe(e))}function gd(r,e,t,n,s){const{startRow:i,endRow:o,startColumn:a,endColumn:l}=n,u=o-i+1,c=l-a+1,h=r.rowCount,f=r.columnCount;if(t===jr.ROWS){for(let d=h;d>=i;d--)for(let m=a;m<=l;m++){const g=e.getValue(d,m);e.setValue(d+u,m,g)}for(let d=o;d>=i;d--)for(let m=a;m<=l;m++)e.setValue(d,m,s[d-i][m-a])}else if(t===jr.COLUMNS){for(let d=i;d<=o;d++)for(let m=f;m>=a;m--){const g=e.getValue(d,m);e.setValue(d,m+c,g)}for(let d=i;d<=o;d++)for(let m=l;m>=a;m--)e.setValue(d,m,s[d-i][m-a])}}function md(r=0,e=1,t){new tt(t).inserts(r,new tt(e))}function pd(r,e,t){const n=r.getWorksheets(),s=r.getConfig(),{sheets:i,sheetOrder:o}=s;if(i[t.id])throw new Error(`Insert Sheet fail ${t.id} is already exist`);return i[t.id]=t,o.splice(e,0,t.id),n.set(t.id,new fn(r.getContext(),t)),t.id}function _d(r,e,t){const n=new tt(t),s=new tt,i=r,o=r+e;for(let a=i;a<o;a++){const l=n.splice(r,1);l.getLength()&&s.set(a,l.first())}return s.getLength()}function bd(r,e,t){return new pe(t).spliceColumns(r,e).toJSON()}function vd(r,e,t){const n=new tt(t),s=new tt,i=r,o=r+e;for(let a=i;a<o;a++){const l=n.splice(r,1);l.getLength()&&s.set(a,l.first())}return s.getLength()}function Cd(r,e,t){return new pe(t).spliceRows(r,e).toJSON()}function Ed(r,e){const t=r.getWorksheets(),n=r.getConfig(),{sheets:s}=n;if(s[e]==null)throw new Error(`Remove Sheet fail ${e} is not exist`);const i=s[e],o=n.sheetOrder.findIndex(a=>a===e);return delete s[e],o!==n.sheetOrder.length-1?s[n.sheetOrder[o+1]].status=1:s[n.sheetOrder[o-1]].status=1,n.sheetOrder.splice(o,1),t.delete(e),{index:o,sheet:i}}function ec(r,e,t){const n=new pe(t),s=new pe;return n.forValue((i,o,a)=>{const l=r.getValue(i,o);if(l){const u=e.get(l.s);u&&s.setValue(i,o,u),l.s=e.setValue(a)}}),s.toJSON()}function wd(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getColumnOrCreate(n);s.hd=1}}function Td(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getColumn(n);s&&(s.hd=0)}}function tc(r=0,e,t){const n=[];for(let s=r;s<r+e.length;s++){const i=t.getColumnOrCreate(s);n[s-r]=i.w,i.w=e[s-r]}return n}function nc(r,e){const t=r.getConfig(),n=t.showGridlines===0;return e?t.showGridlines=0:t.showGridlines=1,n}function yd(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getRowOrCreate(n);s&&(s.hd=1)}}function rc(r,e){return r.find((t,n)=>t.namedRangeId===e.namedRangeId?(r[n]=e,t):null)}function sc(r,e,t,n){const{startRow:s,endRow:i,startColumn:o,endColumn:a}=t,l=new pe;for(let u=s;u<=i;u++)for(let c=o;c<=a;c++){const h=r.getValue(u,c)||{},f=n.getStyleByCell(h);f==null&&delete h.s;const d=kl(f,e[u-s][c-o]);d&&G.removeNull(d),G.isEmptyObject(d)?delete h.s:h.s=n.setValue(d),h.p&&j6(h.p,e[u-s][c-o]),r.setValue(u,c,h),l.setValue(u-s,c-o,Sd(f,e[u-s][c-o]))}return l.getData()}function Sd(r,e){return $6(r,e)}function $6(r,e){if(!e||!Object.keys(e).length)return r;const t=G.deepClone(r)||{};for(const n in e)n==="bd"?t[n]=Y6(t[n]||{},e[n]):n in t||(t[n]=null);return t}function Y6(r,e){if(!e||!Object.keys(e).length)return r;for(const t in e)t in r||(r[t]=null);return r}function kl(r,e,t=!1){if(e===null)return e;if(e===void 0)return r;const n=G.deepClone(r)||{};for(const s in e)t&&["bd","tr","td","ht","vt","tb","pd"].includes(s)||(s in n&&s==="bd"?n[s]=Object.assign(n[s],e[s]):(n[s]=e[s],"cl"in n&&["ul","ol","st"].includes(s)&&(n[s].cl=n.cl)));return n}function j6(r,e){var t;(t=r.body)==null||t.blockElementOrder.forEach(n=>{var s,i;if(((s=r.body)==null?void 0:s.blockElements[n].blockType)===0){const o=(i=r.body)==null?void 0:i.blockElements[n].paragraph;o==null||o.elementOrder.forEach(({elementId:a,paragraphElementType:l})=>{o.elements[a].tr||(o.elements[a].tr={});const u=o.elements[a].tr;u.ts||(u.ts={});const c=u.ts,h=kl(c,e,!0);h&&G.removeNull(h),G.isEmptyObject(h)?delete u.ts:u.ts=h})}})}function tl(r,e,t,n){let s=new pe(e);const i=new pe;return n?(s.forValue((o,a,l)=>{const u=r.getValue(o,a),c={};n.contentsOnly&&(c.m=u==null?void 0:u.m,c.v=u==null?void 0:u.v),n.formatOnly&&(c.v=u==null?void 0:u.v,c.m=u==null?void 0:u.m),i.setValue(o,a,c||{}),r.setValue(o,a,l||{})}),i.getData()):(s.forValue((o,a,l)=>{const u=r.getValue(o,a)||{};if(!l)r.setValue(o,a,l),i.setValue(o,a,u);else{const c=t.getStyleByCell(u),h=Sd(c,l==null?void 0:l.s),f=G.deepClone(u);f.s=h,i.setValue(o,a,f),c==null&&delete u.s;const d=kl(c,l==null?void 0:l.s);d&&G.removeNull(d),G.isEmptyObject(d)?delete u.s:u.s=t.setValue(d),l.v!=null&&(u.v=l.v),l.m!=null?u.m=l.m:u.m=String(u.v),l.t!=null&&(u.t=l.t),r.setValue(o,a,u)}}),i.getData())}function ic(r,e,t){const n=new pe(e),s=new pe;for(let i=t.startRow;i<=t.endRow;i++)for(let o=t.startColumn;o<=t.endColumn;o++){const a=n.getValue(i,o);if(a){JSON.parse(a);const l=r.getValue(i,o),u=G.deepClone(l||{});r.setValue(i,o,u||{})}else{const l=r.getValue(i,o),u=G.deepClone(l||{});r.setValue(i,o,u||{})}}return s.getData()}function oc(r,e,t){const n=new pe(e),s=new pe;for(let i=t.startRow;i<=t.endRow;i++)for(let o=t.startColumn;o<=t.endColumn;o++){const a=n.getValue(i,o),l=r.getValue(i,o),u=G.deepClone(l||{});u.f=a,r.setValue(i,o,u||{})}return s.getData()}function ac(r,e,t){const n=new pe(e),s=new pe;for(let i=t.startRow;i<=t.endRow;i++)for(let o=t.startColumn;o<=t.endColumn;o++){const a=n.getValue(i,o),l=r.getValue(i,o),u=G.deepClone(l||{});u.n=a,r.setValue(i,o,u||{})}return s.getData()}function lc(r,e,t){const n=new pe(e),s=new pe;for(let i=t.startRow;i<=t.endRow;i++)for(let o=t.startColumn;o<=t.endColumn;o++){const a=n.getValue(i,o),l=r.getValue(i,o);s.setValue(i,o,l&&l.v||"");const u=G.deepClone(l||{});u.v=a,u.m=`${a}`,r.setValue(i,o,u||{})}return s.getData()}function uc(r,e){const t=r.getConfig(),n=t.rightToLeft;return t.rightToLeft=e,n}function cc(r=0,e,t){const n=[];for(let s=r;s<r+e.length;s++){const i=t.getRowOrCreate(s);n[s-r]=i.h,i.h=e[s-r]}return n}function hc(r,e,t,n){var l,u,c;const s=r.getSelection(),i=(l=s.getActiveRangeList())==null?void 0:l.getRangeList(),o=(u=s.getActiveRange())==null?void 0:u.getRangeData(),a=(c=s.getCurrentCell())==null?void 0:c.getRangeData();return s.setRanges(e,t,n),{activeRangeList:i,activeRange:o,currentCell:a}}function dc(r,e,t){const n=r.getConfig(),s=n.sheetOrder.findIndex(o=>o===e),i=n.sheetOrder.filter(o=>o!==e);return i.splice(t,0,e),n.sheetOrder=i,s}function Ad(r=0,e,t){for(let n=r;n<r+e;n++){const s=t.getRow(n);s&&(s.hd=0)}}function fc(r,e){const t=r.getConfig(),n=t.tabColor;return t.tabColor=e,n}function gc(r,e){const t=r.getContext().getWorkBook().getActiveSheet();let n="";const s=te.FALSE;t&&(n=t.getSheetId());const i=r.getContext().getWorkBook().getSheets(),o=r.getSheetId();return i.forEach(a=>{a.getSheetId()===o?a.getConfig().status=te.TRUE:a.getConfig().status=te.FALSE}),{oldSheetId:n,status:s}}function mc(r,e){const t=r.getConfig(),n=t.name;return t.name=e,n}function pc(r,e){const t=r.getConfig(),n=t.status;return t.status=e,n}function _c(r,e,t){const n=r.getSheetBySheetId(e);if(n){const s=n.getConfig().zoomRatio;return n.getConfig().zoomRatio=t,s}return 1}class K6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=X6(e.getCellMatrix(),this._doActionData.options,this._doActionData.rangeData);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do()}}undo(){const e=this.getWorkSheet(),{cellValue:t}=this._oldActionData,n=this._workbook.getStyles();e&&(tl(e.getCellMatrix(),t,n),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Z6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={actionName:W.ADD_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRangeId:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),ud(t,e)}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:W.ADD_BANDING_ACTION,namedRange:this.do()}}undo(){const{namedRange:e}=this._oldActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),ld(t,e)}validate(){return!1}}class Rd extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=cd({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:e,actionName:W.INSERT_RANGE_ACTION,shiftDimension:n,rangeData:t,cellValue:this.do()}}undo(){const e=this.getWorkSheet(),{shiftDimension:t,rangeData:n,cellValue:s}=this._oldActionData;e&&(gd({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),t,n,s),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Dd extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const t=this.getWorkSheet().getColumnManager();hd(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),_d(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON())}validate(){return!1}}class q6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e,columnCount:tt.getMaxLength(e.columnData[0])},this.validate()}do(){const e=this.getWorkSheet();dd(this._doActionData.columnIndex,this._doActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();bd(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class J6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();e&&(gd({rowCount:e.getLastRow(),columnCount:e.getLastColumn()},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData,this._doActionData.cellValue),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:W.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:cd({rowCount:s.getLastRow(),columnCount:s.getLastColumn()},s.getCellMatrix(),n,e),rangeData:e,shiftDimension:n},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class xd extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const t=this.getWorkSheet().getRowManager();md(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),vd(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON())}validate(){return!1}}class Q6 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e,rowCount:tt.getMaxLength(e.rowData[0])},this.validate()}do(){const e=this.getWorkSheet();fd(this._doActionData.rowIndex,this._doActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Cd(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class e0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,sheetId:this.do()}}do(){const e=this.getWorkBook(),t=pd(e,this._doActionData.index,this._doActionData.sheet);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){const e=this.getWorkBook();Ed(e,this._oldActionData.sheetId),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}class Id extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,columnCount:this.do()},this.validate()}do(){const t=this.getWorkSheet().getColumnManager(),n=_d(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON());return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),n}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();hd(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class t0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,columnData:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=bd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();dd(this._oldActionData.columnIndex,this._oldActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class n0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rectangles:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ad(e.getMerges(),this._doActionData.rectangles);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();od(e.getMerges(),this._doActionData.rectangles),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Od extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rowCount:this.do()},this.validate()}do(){const t=this.getWorkSheet().getRowManager(),n=vd(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON());return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),n}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();md(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class r0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rowData:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Cd(this._doActionData.rowIndex,this._doActionData.rowCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();fd(this._oldActionData.rowIndex,this._oldActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class s0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,...this.do()}}do(){return this.redo()}redo(){const e=this.getWorkBook(),t=Ed(e,this._doActionData.sheetId);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}undo(){const e=this.getWorkBook();this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),pd(e,this._oldActionData.index,this._oldActionData.sheet)}validate(){throw new Error("Method not implemented.")}}class i0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,styles:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=e.getCellMatrix(),i=e.getContext().getWorkBook().getStyles(),o=ec(t,i,this._doActionData.styles);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),o}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=e.getCellMatrix(),i=e.getContext().getWorkBook().getStyles();ec(t,i,this._oldActionData.styles),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class o0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();wd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Td(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class a0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();Td(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();wd(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class l0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,columnWidth:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=tc(this._doActionData.columnIndex,this._doActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=tc(this._oldActionData.columnIndex,this._oldActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class u0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,hideGridlines:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=nc(e,this._doActionData.hideGridlines);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();nc(e,this._oldActionData.hideGridlines),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class c0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={actionName:W.SET_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),rc(t,e)}redo(){const{sheetId:e,namedRange:t}=this._doActionData;this._oldActionData={actionName:W.SET_NAMED_RANGE_ACTION,sheetId:e,namedRange:this.do()}}undo(){const{namedRange:e,sheetId:t}=this._oldActionData,n=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:W.SET_NAMED_RANGE_ACTION,sheetId:t,namedRange:rc(n,e)}}validate(){return!1}}class h0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=this._workbook.getStyles(),n=tl(e.getCellMatrix(),this._doActionData.cellValue,t,this._doActionData.options);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e,options:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),options:t}}undo(){const{sheetId:e,cellValue:t,options:n}=this._oldActionData,s=this.getWorkSheet(),i=this._workbook.getStyles();s&&(this._doActionData={actionName:W.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:tl(s.getCellMatrix(),t,i),options:n},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class d0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellFormat:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ic(e.getCellMatrix(),this._doActionData.cellFormat,this._doActionData.rangeData);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_FORMAT_ACTION,sheetId:e,cellFormat:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormat:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:W.SET_RANGE_FORMAT_ACTION,sheetId:t,cellFormat:ic(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class f0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellFormula:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=oc(e.getCellMatrix(),this._doActionData.cellFormula,this._doActionData.rangeData);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_FORMULA_ACTION,sheetId:e,cellFormula:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormula:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:W.SET_RANGE_FORMULA_ACTION,sheetId:t,cellFormula:oc(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class g0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellNote:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ac(e.getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_NOTE_ACTION,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:W.SET_RANGE_NOTE_ACTION,sheetId:t,cellNote:ac(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class m0 extends Qe{constructor(e,t,n){super(e,t,n),this._oldActionData={...e,value:this.do()},this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,n=this._workbook.getStyles(),s=this.getWorkSheet().getCellMatrix(),i=sc(s,e,t,n);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),i}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_STYLE_ACTION,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:n}=this._oldActionData,s=this._workbook.getStyles(),i=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:W.SET_RANGE_STYLE_ACTION,sheetId:n,value:sc(i,e,t,s),rangeData:t},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class p0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=lc(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:W.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:n}=this._oldActionData,s=this.getWorkSheet();s&&(this._doActionData={actionName:W.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:lc(s.getCellMatrix(),n,e),rangeData:e},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class _0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rightToLeft:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=uc(e,this._doActionData.rightToLeft);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();uc(e,this._oldActionData.rightToLeft),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class b0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,rowHeight:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=cc(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=cc(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class v0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();yd(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ad(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class C0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();Ad(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();yd(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class E0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e};const{activeRangeList:s,activeRange:i,currentCell:o}=this.do();this._oldActionData={...e,activeRangeList:s,activeRange:i,currentCell:o},this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:n}=this._doActionData,s=this.getWorkSheet(),i=hc(s,e,t,n);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),i}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:n,currentCell:s}=this.do();this._oldActionData={actionName:W.SET_SELECTION_ACTION,sheetId:e,activeRangeList:t,activeRange:n,currentCell:s}}undo(){const{activeRangeList:e,activeRange:t,currentCell:n,sheetId:s}=this._oldActionData,i=this.getWorkSheet(),o=hc(i,e,t,n);this._doActionData={actionName:W.SET_SELECTION_ACTION,sheetId:s,activeRangeList:o.activeRangeList,activeRange:o.activeRange,currentCell:o.currentCell},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class kd extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,order:this.do()},this.validate()}do(){const n=this.getWorkSheet().getContext().getWorkBook(),s=dc(n,this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),s}redo(){this.do()}undo(){const n=this.getWorkSheet().getContext().getWorkBook();dc(n,this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class w0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,color:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=fc(e,this._doActionData.color);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:W.SET_TAB_COLOR_ACTION,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:W.SET_TAB_COLOR_ACTION,sheetId:t,color:fc(n,e)},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class T0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e};const{oldSheetId:s,status:i}=this.do();this._oldActionData={...e,sheetId:s,status:i},this.validate(),this.removeOperation($t.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,n=this._workbook.getSheetBySheetId(e),s=gc(n);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),s}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:W.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:n,status:s}=gc(t);this._doActionData={actionName:W.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:n,status:s},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}}class y0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,hidden:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Qu(e,this._doActionData.hidden);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:W.HIDE_SHEET_ACTION,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:W.HIDE_SHEET_ACTION,sheetId:t,hidden:Qu(n,e)},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class S0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,sheetName:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=mc(e,this._doActionData.sheetName);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:W.SET_WORKSHEET_NAME_ACTION,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:W.SET_WORKSHEET_NAME_ACTION,sheetId:t,sheetName:mc(n,e)},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class A0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,sheetStatus:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=pc(e,this._doActionData.sheetStatus);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:W.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:W.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:pc(n,e)},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class R0 extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,zoom:this.do()},this.validate()}redo(){const e=_c(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){_c(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:we.REDO,data:this._oldActionData,action:this})}validate(){return!1}}class Yt{constructor(...e){if(G.hasLength(e,0)){this.startRow=0,this.startColumn=0,this.endRow=0,this.endColumn=0;return}if(G.hasLength(e,1)){const t=e[0];this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,this.endColumn=t.endColumn;return}if(G.hasLength(e,4)){const t=e[0],n=e[1],s=e[2],i=e[3];this.startRow=t,this.startColumn=n,this.endRow=s,this.endColumn=i}}intersects(e){const t=this.startRow,n=this.endRow,s=this.startColumn,i=this.endColumn,o=e.startRow,a=e.endRow,l=e.startColumn,u=e.endColumn,c=Math.abs(s+i-l-u),h=Math.abs(s-i)+Math.abs(l-u),f=Math.abs(t+n-o-a),d=Math.abs(t-n)+Math.abs(o-a);return c<=h&&f<=d}union(e){const{startRow:t,startColumn:n,endRow:s,endColumn:i}=this;return new Yt(e.startRow<this.startRow?e.startRow:t,e.startColumn<n?e.startColumn:n,e.endRow>s?e.endRow:s,e.endColumn>i?e.endColumn:i)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return this.endRow===e.endRow&&this.endColumn===e.endColumn&&this.startRow===e.startRow&&this.startColumn===e.startColumn}}const gs=class{static checkup(r,...e){if(r.length!==e.length)return!1;const t=r.length;for(let n=0;n<t;n++){const s=r[n],i=e[n];switch(i){case gs.BOOLEAN_TYPE:{if(!G.isBoolean(s))return!1;break}case gs.NUMBER_TYPE:{if(!G.isNumber(s))return!1;break}case gs.STRING_TYPE:{if(!G.isString(s))return!1;break}case gs.FUNCTION_TYPE:{if(!G.isFunction(s))return!1;break}case gs.OBJECT_TYPE:{if(!G.isPlainObject(s))return!1;break}default:{if(!G.isAssignableFrom(s,i))return!1;break}}}return!0}};let it=gs;it.STRING_TYPE=1;it.NUMBER_TYPE=2;it.BOOLEAN_TYPE=3;it.FUNCTION_TYPE=4;it.OBJECT_TYPE=5;class D0{constructor(e,t){this._worksheet=e,this._rectangleList=t,Be.getCommandInjectorObservers().add(n=>{let s=n.include(xd),i=n.include(Dd),o=n.include(Od),a=n.include(Id),l=n.include(Rd);if(s){const u=s.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()){const c=G.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const f=c[h],d=u.rowCount;u.rowIndex>f.endRow||(u.rowIndex>=f.startRow&&u.rowIndex<=f.endRow||(f.startRow+=d),f.endRow+=d)}this.modifyMerge(this._rectangleList,c)}}if(i){const u=i.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()){const c=G.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const f=c[h],d=u.columnCount;u.columnIndex>f.endColumn||(u.columnIndex>=f.startColumn&&u.columnIndex<=f.endColumn||(f.startColumn+=d),f.endColumn+=d)}this.modifyMerge(this._rectangleList,c)}}if(o){const u=o.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()&&u.sheetId===this._worksheet.getSheetId()){const c=G.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const f=c[h],d=u.rowCount;u.rowIndex>f.endRow||(u.rowIndex>=f.startRow&&u.rowIndex<=f.endRow||(f.startRow-=d),f.endRow-=d)}this.modifyMerge(this._rectangleList,c)}}if(a){const u=a.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()&&u.sheetId===this._worksheet.getSheetId()){const c=G.deepClone(this._rectangleList);for(let h=0;h<c.length;h++){const f=c[h],d=u.columnCount;u.columnIndex>f.endColumn||(u.columnIndex>=f.startColumn&&u.columnIndex<=f.endColumn||(f.startColumn-=d),f.endColumn-=d)}this.modifyMerge(this._rectangleList,c)}}if(l){const u=l.getDoActionData();if(u.sheetId===this._worksheet.getSheetId()){const c=G.deepClone(this._rectangleList),h=this.getByRowColumn(u.rangeData.startRow,u.rangeData.endRow,u.rangeData.startColumn,u.rangeData.endColumn);if(h&&h.forEach(f=>{const d=new Yt(f);for(let m=0;m<c.length;m++){const g=c[m];d.intersects(new Yt(g))&&c.splice(m,1)}}),u.shiftDimension)for(let f=0;f<c.length;f++){const d=c[f];if(d.endRow>=u.rangeData.startRow){if(d.endColumn<u.rangeData.startColumn)continue;if(d.startColumn>u.rangeData.endColumn)continue;if(d.startColumn>=u.rangeData.startColumn&&d.endColumn<=u.rangeData.endColumn){const m=u.rangeData.endRow-u.rangeData.startRow;d.startRow-=m,d.endRow-=m}else return}}else for(let f=0;f<c.length;f++){const d=c[f];if(d.startColumn>u.rangeData.endColumn){if(d.endRow<u.rangeData.startRow)continue;if(d.startRow>u.rangeData.endRow)continue;if(d.startRow>=u.rangeData.startRow&&d.endRow<=u.rangeData.endRow){const m=u.rangeData.endColumn-u.rangeData.startColumn;d.startColumn-=m,d.endColumn-=m}else return}}this.modifyMerge(this._rectangleList,c)}}})}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let n;it.checkup(e,it.NUMBER_TYPE,it.NUMBER_TYPE,it.NUMBER_TYPE,it.NUMBER_TYPE)?n=new Yt(e[0],e[2],e[1],e[3]):it.checkup(e,it.NUMBER_TYPE,it.NUMBER_TYPE)&&(n=new Yt(e[0],e[1],e[0],e[1]));const s=[];for(let i=0;i<t.length;i++){const o=t[i];n.intersects(new Yt(o))&&s.push(o)}return s.length?s:null}remove(e){const{_rectangleList:t}=this,n=new Yt(e);let s=t.findIndex(i=>!!n.intersects(new Yt(i)));return s!==-1&&t.splice(s,1),this}size(){return this._rectangleList.length}add(e){const{_rectangleList:t}=this,n=new Yt(e);return t.findIndex(i=>!!n.intersects(new Yt(i)))===-1&&this._rectangleList.push(e),this}union(e){const{_rectangleList:t}=this,{length:n}=t;let s=new Yt(e);for(let i=0;i<n;i++){const o=t[i];s=s.union(new Yt(o))}return s.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:n}=t,s=[];for(let i=0;i<n;i++){const o=t[i];new Yt(e).intersects(new Yt(o))&&s.push(o)}return s}modifyMerge(e,t){const n=this._worksheet.getCommandManager(),s=this._worksheet.getContext(),i={actionName:W.REMOVE_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:e},o={actionName:W.ADD_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:t},a=new fe({WorkBookUnit:s.getWorkBook()},i,o);n.invoke(a)}}var vr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{};function Yi(r){throw new Error('Could not dynamically require "'+r+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var Nd={exports:{}};(function(r,e){(function(t,n){r.exports=n()})(vr,function(){var t=1e3,n=6e4,s=36e5,i="millisecond",o="second",a="minute",l="hour",u="day",c="week",h="month",f="quarter",d="year",m="date",g="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,_=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,v={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(D){var E=["th","st","nd","rd"],F=D%100;return"["+D+(E[(F-20)%10]||E[F]||E[0])+"]"}},w=function(D,E,F){var j=String(D);return!j||j.length>=E?D:""+Array(E+1-j.length).join(F)+D},y={s:w,z:function(D){var E=-D.utcOffset(),F=Math.abs(E),j=Math.floor(F/60),L=F%60;return(E<=0?"+":"-")+w(j,2,"0")+":"+w(L,2,"0")},m:function D(E,F){if(E.date()<F.date())return-D(F,E);var j=12*(F.year()-E.year())+(F.month()-E.month()),L=E.clone().add(j,h),re=F-L<0,Y=E.clone().add(j+(re?-1:1),h);return+(-(j+(F-L)/(re?L-Y:Y-L))||0)},a:function(D){return D<0?Math.ceil(D)||0:Math.floor(D)},p:function(D){return{M:h,y:d,w:c,d:u,D:m,h:l,m:a,s:o,ms:i,Q:f}[D]||String(D||"").toLowerCase().replace(/s$/,"")},u:function(D){return D===void 0}},A="en",I={};I[A]=v;var R=function(D){return D instanceof N},x=function D(E,F,j){var L;if(!E)return A;if(typeof E=="string"){var re=E.toLowerCase();I[re]&&(L=re),F&&(I[re]=F,L=re);var Y=E.split("-");if(!L&&Y.length>1)return D(Y[0])}else{var ee=E.name;I[ee]=E,L=ee}return!j&&L&&(A=L),L||!j&&A},S=function(D,E){if(R(D))return D.clone();var F=typeof E=="object"?E:{};return F.date=D,F.args=arguments,new N(F)},k=y;k.l=x,k.i=R,k.w=function(D,E){return S(D,{locale:E.$L,utc:E.$u,x:E.$x,$offset:E.$offset})};var N=function(){function D(F){this.$L=x(F.locale,null,!0),this.parse(F)}var E=D.prototype;return E.parse=function(F){this.$d=function(j){var L=j.date,re=j.utc;if(L===null)return new Date(NaN);if(k.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var Y=L.match(p);if(Y){var ee=Y[2]-1||0,U=(Y[7]||"0").substring(0,3);return re?new Date(Date.UTC(Y[1],ee,Y[3]||1,Y[4]||0,Y[5]||0,Y[6]||0,U)):new Date(Y[1],ee,Y[3]||1,Y[4]||0,Y[5]||0,Y[6]||0,U)}}return new Date(L)}(F),this.$x=F.x||{},this.init()},E.init=function(){var F=this.$d;this.$y=F.getFullYear(),this.$M=F.getMonth(),this.$D=F.getDate(),this.$W=F.getDay(),this.$H=F.getHours(),this.$m=F.getMinutes(),this.$s=F.getSeconds(),this.$ms=F.getMilliseconds()},E.$utils=function(){return k},E.isValid=function(){return this.$d.toString()!==g},E.isSame=function(F,j){var L=S(F);return this.startOf(j)<=L&&L<=this.endOf(j)},E.isAfter=function(F,j){return S(F)<this.startOf(j)},E.isBefore=function(F,j){return this.endOf(j)<S(F)},E.$g=function(F,j,L){return k.u(F)?this[j]:this.set(L,F)},E.unix=function(){return Math.floor(this.valueOf()/1e3)},E.valueOf=function(){return this.$d.getTime()},E.startOf=function(F,j){var L=this,re=!!k.u(j)||j,Y=k.p(F),ee=function(Ce,ge){var ye=k.w(L.$u?Date.UTC(L.$y,ge,Ce):new Date(L.$y,ge,Ce),L);return re?ye:ye.endOf(u)},U=function(Ce,ge){return k.w(L.toDate()[Ce].apply(L.toDate("s"),(re?[0,0,0,0]:[23,59,59,999]).slice(ge)),L)},V=this.$W,_e=this.$M,ie=this.$D,Z="set"+(this.$u?"UTC":"");switch(Y){case d:return re?ee(1,0):ee(31,11);case h:return re?ee(1,_e):ee(0,_e+1);case c:var le=this.$locale().weekStart||0,ve=(V<le?V+7:V)-le;return ee(re?ie-ve:ie+(6-ve),_e);case u:case m:return U(Z+"Hours",0);case l:return U(Z+"Minutes",1);case a:return U(Z+"Seconds",2);case o:return U(Z+"Milliseconds",3);default:return this.clone()}},E.endOf=function(F){return this.startOf(F,!1)},E.$set=function(F,j){var L,re=k.p(F),Y="set"+(this.$u?"UTC":""),ee=(L={},L[u]=Y+"Date",L[m]=Y+"Date",L[h]=Y+"Month",L[d]=Y+"FullYear",L[l]=Y+"Hours",L[a]=Y+"Minutes",L[o]=Y+"Seconds",L[i]=Y+"Milliseconds",L)[re],U=re===u?this.$D+(j-this.$W):j;if(re===h||re===d){var V=this.clone().set(m,1);V.$d[ee](U),V.init(),this.$d=V.set(m,Math.min(this.$D,V.daysInMonth())).$d}else ee&&this.$d[ee](U);return this.init(),this},E.set=function(F,j){return this.clone().$set(F,j)},E.get=function(F){return this[k.p(F)]()},E.add=function(F,j){var L,re=this;F=Number(F);var Y=k.p(j),ee=function(_e){var ie=S(re);return k.w(ie.date(ie.date()+Math.round(_e*F)),re)};if(Y===h)return this.set(h,this.$M+F);if(Y===d)return this.set(d,this.$y+F);if(Y===u)return ee(1);if(Y===c)return ee(7);var U=(L={},L[a]=n,L[l]=s,L[o]=t,L)[Y]||1,V=this.$d.getTime()+F*U;return k.w(V,this)},E.subtract=function(F,j){return this.add(-1*F,j)},E.format=function(F){var j=this,L=this.$locale();if(!this.isValid())return L.invalidDate||g;var re=F||"YYYY-MM-DDTHH:mm:ssZ",Y=k.z(this),ee=this.$H,U=this.$m,V=this.$M,_e=L.weekdays,ie=L.months,Z=function(ge,ye,Me,Ze){return ge&&(ge[ye]||ge(j,re))||Me[ye].slice(0,Ze)},le=function(ge){return k.s(ee%12||12,ge,"0")},ve=L.meridiem||function(ge,ye,Me){var Ze=ge<12?"AM":"PM";return Me?Ze.toLowerCase():Ze},Ce={YY:String(this.$y).slice(-2),YYYY:this.$y,M:V+1,MM:k.s(V+1,2,"0"),MMM:Z(L.monthsShort,V,ie,3),MMMM:Z(ie,V),D:this.$D,DD:k.s(this.$D,2,"0"),d:String(this.$W),dd:Z(L.weekdaysMin,this.$W,_e,2),ddd:Z(L.weekdaysShort,this.$W,_e,3),dddd:_e[this.$W],H:String(ee),HH:k.s(ee,2,"0"),h:le(1),hh:le(2),a:ve(ee,U,!0),A:ve(ee,U,!1),m:String(U),mm:k.s(U,2,"0"),s:String(this.$s),ss:k.s(this.$s,2,"0"),SSS:k.s(this.$ms,3,"0"),Z:Y};return re.replace(_,function(ge,ye){return ye||Ce[ge]||Y.replace(":","")})},E.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},E.diff=function(F,j,L){var re,Y=k.p(j),ee=S(F),U=(ee.utcOffset()-this.utcOffset())*n,V=this-ee,_e=k.m(this,ee);return _e=(re={},re[d]=_e/12,re[h]=_e,re[f]=_e/3,re[c]=(V-U)/6048e5,re[u]=(V-U)/864e5,re[l]=V/s,re[a]=V/n,re[o]=V/t,re)[Y]||V,L?_e:k.a(_e)},E.daysInMonth=function(){return this.endOf(h).$D},E.$locale=function(){return I[this.$L]},E.locale=function(F,j){if(!F)return this.$L;var L=this.clone(),re=x(F,j,!0);return re&&(L.$L=re),L},E.clone=function(){return k.w(this.$d,this)},E.toDate=function(){return new Date(this.valueOf())},E.toJSON=function(){return this.isValid()?this.toISOString():null},E.toISOString=function(){return this.$d.toISOString()},E.toString=function(){return this.$d.toUTCString()},D}(),O=N.prototype;return S.prototype=O,[["$ms",i],["$s",o],["$m",a],["$H",l],["$W",u],["$M",h],["$y",d],["$D",m]].forEach(function(D){O[D[1]]=function(E){return this.$g(E,D[0],D[1])}}),S.extend=function(D,E){return D.$i||(D(E,N,S),D.$i=!0),S},S.locale=x,S.isDayjs=R,S.unix=function(D){return S(1e3*D)},S.en=I[A],S.Ls=I,S.p={},S})})(Nd);var me=Nd.exports,Md={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(r){(function(e,t){r.exports?r.exports=t():e.numeral=t()})(vr,function(){var e,t,n="2.0.6",s={},i={},o={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},a={currentLocale:o.currentLocale,zeroFormat:o.zeroFormat,nullFormat:o.nullFormat,defaultFormat:o.defaultFormat,scalePercentBy100:o.scalePercentBy100};function l(u,c){this._input=u,this._value=c}return e=function(u){var c,h,f,d;if(e.isNumeral(u))c=u.value();else if(u===0||typeof u=="undefined")c=0;else if(u===null||t.isNaN(u))c=null;else if(typeof u=="string")if(a.zeroFormat&&u===a.zeroFormat)c=0;else if(a.nullFormat&&u===a.nullFormat||!u.replace(/[^0-9]+/g,"").length)c=null;else{for(h in s)if(d=typeof s[h].regexps.unformat=="function"?s[h].regexps.unformat():s[h].regexps.unformat,d&&u.match(d)){f=s[h].unformat;break}f=f||e._.stringToNumber,c=f(u)}else c=Number(u)||null;return new l(u,c)},e.version=n,e.isNumeral=function(u){return u instanceof l},e._=t={numberToFormat:function(u,c,h){var f=i[e.options.currentLocale],d=!1,m=!1,g=0,p="",_=1e12,v=1e9,w=1e6,y=1e3,A="",I=!1,R,x,S,k,N,O,D;if(u=u||0,x=Math.abs(u),e._.includes(c,"(")?(d=!0,c=c.replace(/[\(|\)]/g,"")):(e._.includes(c,"+")||e._.includes(c,"-"))&&(N=e._.includes(c,"+")?c.indexOf("+"):u<0?c.indexOf("-"):-1,c=c.replace(/[\+|\-]/g,"")),e._.includes(c,"a")&&(R=c.match(/a(k|m|b|t)?/),R=R?R[1]:!1,e._.includes(c," a")&&(p=" "),c=c.replace(new RegExp(p+"a[kmbt]?"),""),x>=_&&!R||R==="t"?(p+=f.abbreviations.trillion,u=u/_):x<_&&x>=v&&!R||R==="b"?(p+=f.abbreviations.billion,u=u/v):x<v&&x>=w&&!R||R==="m"?(p+=f.abbreviations.million,u=u/w):(x<w&&x>=y&&!R||R==="k")&&(p+=f.abbreviations.thousand,u=u/y)),e._.includes(c,"[.]")&&(m=!0,c=c.replace("[.]",".")),S=u.toString().split(".")[0],k=c.split(".")[1],O=c.indexOf(","),g=(c.split(".")[0].split(",")[0].match(/0/g)||[]).length,k?(e._.includes(k,"[")?(k=k.replace("]",""),k=k.split("["),A=e._.toFixed(u,k[0].length+k[1].length,h,k[1].length)):A=e._.toFixed(u,k.length,h),S=A.split(".")[0],e._.includes(A,".")?A=f.delimiters.decimal+A.split(".")[1]:A="",m&&Number(A.slice(1))===0&&(A="")):S=e._.toFixed(u,0,h),p&&!R&&Number(S)>=1e3&&p!==f.abbreviations.trillion)switch(S=String(Number(S)/1e3),p){case f.abbreviations.thousand:p=f.abbreviations.million;break;case f.abbreviations.million:p=f.abbreviations.billion;break;case f.abbreviations.billion:p=f.abbreviations.trillion;break}if(e._.includes(S,"-")&&(S=S.slice(1),I=!0),S.length<g)for(var E=g-S.length;E>0;E--)S="0"+S;return O>-1&&(S=S.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+f.delimiters.thousands)),c.indexOf(".")===0&&(S=""),D=S+A+(p||""),d?D=(d&&I?"(":"")+D+(d&&I?")":""):N>=0?D=N===0?(I?"-":"+")+D:D+(I?"-":"+"):I&&(D="-"+D),D},stringToNumber:function(u){var c=i[a.currentLocale],h=u,f={thousand:3,million:6,billion:9,trillion:12},d,m,g;if(a.zeroFormat&&u===a.zeroFormat)m=0;else if(a.nullFormat&&u===a.nullFormat||!u.replace(/[^0-9]+/g,"").length)m=null;else{m=1,c.delimiters.decimal!=="."&&(u=u.replace(/\./g,"").replace(c.delimiters.decimal,"."));for(d in f)if(g=new RegExp("[^a-zA-Z]"+c.abbreviations[d]+"(?:\\)|(\\"+c.currency.symbol+")?(?:\\))?)?$"),h.match(g)){m*=Math.pow(10,f[d]);break}m*=(u.split("-").length+Math.min(u.split("(").length-1,u.split(")").length-1))%2?1:-1,u=u.replace(/[^0-9\.]+/g,""),m*=Number(u)}return m},isNaN:function(u){return typeof u=="number"&&isNaN(u)},includes:function(u,c){return u.indexOf(c)!==-1},insert:function(u,c,h){return u.slice(0,h)+c+u.slice(h)},reduce:function(u,c){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof c!="function")throw new TypeError(c+" is not a function");var h=Object(u),f=h.length>>>0,d=0,m;if(arguments.length===3)m=arguments[2];else{for(;d<f&&!(d in h);)d++;if(d>=f)throw new TypeError("Reduce of empty array with no initial value");m=h[d++]}for(;d<f;d++)d in h&&(m=c(m,h[d],d,h));return m},multiplier:function(u){var c=u.toString().split(".");return c.length<2?1:Math.pow(10,c[1].length)},correctionFactor:function(){var u=Array.prototype.slice.call(arguments);return u.reduce(function(c,h){var f=t.multiplier(h);return c>f?c:f},1)},toFixed:function(u,c,h,f){var d=u.toString().split("."),m=c-(f||0),g,p,_,v;return d.length===2?g=Math.min(Math.max(d[1].length,m),c):g=m,_=Math.pow(10,g),v=(h(u+"e+"+g)/_).toFixed(g),f>c-g&&(p=new RegExp("\\.?0{1,"+(f-(c-g))+"}$"),v=v.replace(p,"")),v}},e.options=a,e.formats=s,e.locales=i,e.locale=function(u){return u&&(a.currentLocale=u.toLowerCase()),a.currentLocale},e.localeData=function(u){if(!u)return i[a.currentLocale];if(u=u.toLowerCase(),!i[u])throw new Error("Unknown locale : "+u);return i[u]},e.reset=function(){for(var u in o)a[u]=o[u]},e.zeroFormat=function(u){a.zeroFormat=typeof u=="string"?u:null},e.nullFormat=function(u){a.nullFormat=typeof u=="string"?u:null},e.defaultFormat=function(u){a.defaultFormat=typeof u=="string"?u:"0.0"},e.register=function(u,c,h){if(c=c.toLowerCase(),this[u+"s"][c])throw new TypeError(c+" "+u+" already registered.");return this[u+"s"][c]=h,h},e.validate=function(u,c){var h,f,d,m,g,p,_,v;if(typeof u!="string"&&(u+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",u)),u=u.trim(),u.match(/^\d+$/))return!0;if(u==="")return!1;try{_=e.localeData(c)}catch{_=e.localeData(e.locale())}return d=_.currency.symbol,g=_.abbreviations,h=_.delimiters.decimal,_.delimiters.thousands==="."?f="\\.":f=_.delimiters.thousands,v=u.match(/^[^\d]+/),v!==null&&(u=u.substr(1),v[0]!==d)||(v=u.match(/[^\d]+$/),v!==null&&(u=u.slice(0,-1),v[0]!==g.thousand&&v[0]!==g.million&&v[0]!==g.billion&&v[0]!==g.trillion))?!1:(p=new RegExp(f+"{2}"),u.match(/[^\d.,]/g)?!1:(m=u.split(h),m.length>2?!1:m.length<2?!!m[0].match(/^\d+.*\d$/)&&!m[0].match(p):m[0].length===1?!!m[0].match(/^\d+$/)&&!m[0].match(p)&&!!m[1].match(/^\d+$/):!!m[0].match(/^\d+.*\d$/)&&!m[0].match(p)&&!!m[1].match(/^\d+$/)))},e.fn=l.prototype={clone:function(){return e(this)},format:function(u,c){var h=this._value,f=u||a.defaultFormat,d,m,g;if(c=c||Math.round,h===0&&a.zeroFormat!==null)m=a.zeroFormat;else if(h===null&&a.nullFormat!==null)m=a.nullFormat;else{for(d in s)if(f.match(s[d].regexps.format)){g=s[d].format;break}g=g||e._.numberToFormat,m=g(h,f,c)}return m},value:function(){return this._value},input:function(){return this._input},set:function(u){return this._value=Number(u),this},add:function(u){var c=t.correctionFactor.call(null,this._value,u);function h(f,d,m,g){return f+Math.round(c*d)}return this._value=t.reduce([this._value,u],h,0)/c,this},subtract:function(u){var c=t.correctionFactor.call(null,this._value,u);function h(f,d,m,g){return f-Math.round(c*d)}return this._value=t.reduce([u],h,Math.round(this._value*c))/c,this},multiply:function(u){function c(h,f,d,m){var g=t.correctionFactor(h,f);return Math.round(h*g)*Math.round(f*g)/Math.round(g*g)}return this._value=t.reduce([this._value,u],c,1),this},divide:function(u){function c(h,f,d,m){var g=t.correctionFactor(h,f);return Math.round(h*g)/Math.round(f*g)}return this._value=t.reduce([this._value,u],c),this},difference:function(u){return Math.abs(e(this._value).subtract(u).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(u){var c=u%10;return~~(u%100/10)===1?"th":c===1?"st":c===2?"nd":c===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(u,c,h){var f=e._.includes(c," BPS")?" ":"",d;return u=u*1e4,c=c.replace(/\s?BPS/,""),d=e._.numberToFormat(u,c,h),e._.includes(d,")")?(d=d.split(""),d.splice(-1,0,f+"BPS"),d=d.join("")):d=d+f+"BPS",d},unformat:function(u){return+(e._.stringToNumber(u)*1e-4).toFixed(15)}})}(),function(){var u={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},c={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},h=u.suffixes.concat(c.suffixes.filter(function(d){return u.suffixes.indexOf(d)<0})),f=h.join("|");f="("+f.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(f)},format:function(d,m,g){var p,_=e._.includes(m,"ib")?c:u,v=e._.includes(m," b")||e._.includes(m," ib")?" ":"",w,y,A;for(m=m.replace(/\s?i?b/,""),w=0;w<=_.suffixes.length;w++)if(y=Math.pow(_.base,w),A=Math.pow(_.base,w+1),d===null||d===0||d>=y&&d<A){v+=_.suffixes[w],y>0&&(d=d/y);break}return p=e._.numberToFormat(d,m,g),p+v},unformat:function(d){var m=e._.stringToNumber(d),g,p;if(m){for(g=u.suffixes.length-1;g>=0;g--){if(e._.includes(d,u.suffixes[g])){p=Math.pow(u.base,g);break}if(e._.includes(d,c.suffixes[g])){p=Math.pow(c.base,g);break}}m*=p||1}return m}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(u,c,h){var f=e.locales[e.options.currentLocale],d={before:c.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:c.match(/([\+|\-|\)|\s|\$]*)$/)[0]},m,g,p;for(c=c.replace(/\s?\$\s?/,""),m=e._.numberToFormat(u,c,h),u>=0?(d.before=d.before.replace(/[\-\(]/,""),d.after=d.after.replace(/[\-\)]/,"")):u<0&&!e._.includes(d.before,"-")&&!e._.includes(d.before,"(")&&(d.before="-"+d.before),p=0;p<d.before.length;p++)switch(g=d.before[p],g){case"$":m=e._.insert(m,f.currency.symbol,p);break;case" ":m=e._.insert(m," ",p+f.currency.symbol.length-1);break}for(p=d.after.length-1;p>=0;p--)switch(g=d.after[p],g){case"$":m=p===d.after.length-1?m+f.currency.symbol:e._.insert(m,f.currency.symbol,-(d.after.length-(1+p)));break;case" ":m=p===d.after.length-1?m+" ":e._.insert(m," ",-(d.after.length-(1+p)+f.currency.symbol.length-1));break}return m}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(u,c,h){var f,d=typeof u=="number"&&!e._.isNaN(u)?u.toExponential():"0e+0",m=d.split("e");return c=c.replace(/e[\+|\-]{1}0/,""),f=e._.numberToFormat(Number(m[0]),c,h),f+"e"+m[1]},unformat:function(u){var c=e._.includes(u,"e+")?u.split("e+"):u.split("e-"),h=Number(c[0]),f=Number(c[1]);f=e._.includes(u,"e-")?f*=-1:f;function d(m,g,p,_){var v=e._.correctionFactor(m,g),w=m*v*(g*v)/(v*v);return w}return e._.reduce([h,Math.pow(10,f)],d,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(u,c,h){var f=e.locales[e.options.currentLocale],d,m=e._.includes(c," o")?" ":"";return c=c.replace(/\s?o/,""),m+=f.ordinal(u),d=e._.numberToFormat(u,c,h),d+m}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(u,c,h){var f=e._.includes(c," %")?" ":"",d;return e.options.scalePercentBy100&&(u=u*100),c=c.replace(/\s?\%/,""),d=e._.numberToFormat(u,c,h),e._.includes(d,")")?(d=d.split(""),d.splice(-1,0,f+"%"),d=d.join("")):d=d+f+"%",d},unformat:function(u){var c=e._.stringToNumber(u);return e.options.scalePercentBy100?c*.01:c}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(u,c,h){var f=Math.floor(u/60/60),d=Math.floor((u-f*60*60)/60),m=Math.round(u-f*60*60-d*60);return f+":"+(d<10?"0"+d:d)+":"+(m<10?"0"+m:m)},unformat:function(u){var c=u.split(":"),h=0;return c.length===3?(h=h+Number(c[0])*60*60,h=h+Number(c[1])*60,h=h+Number(c[2])):c.length===2&&(h=h+Number(c[0])*60,h=h+Number(c[1])),Number(h)}})}(),e})})(Md);var Fr=Md.exports;const bc={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function x0(r){let e=!1;for(const t in bc)if(r===bc[t]){e=!0;break}return e}function rs(r){return r===null||r.toString().replace(/\s/g,"")===""||typeof r=="boolean"?!1:!Number.isNaN(r)}function I0(r){if(r===null||r.toString().length<5)return!1;if(e(r))return!0;return!1;function e(t){const n=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,s=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!n.test(t)&&!s.test(t))return!1;const i=RegExp.$1,o=RegExp.$2,a=RegExp.$3;return!(i<1900||o>12||a>31||o===2&&(new Date(i,1,29).getDate()===29&&a>29||new Date(i,1,29).getDate()!==29&&a>28))}}let Mo=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(Mo.getFullYear())&&(Mo=new Date("2/19/17"));const O0=Mo.getFullYear()===2017;function k0(r,e){const t=new Date(r);if(O0)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(r instanceof Date)return r;if(Mo.getFullYear()===1917&&!Number.isNaN(t.getFullYear())){const i=t.getFullYear();return r.indexOf(`${i}`)>-1||t.setFullYear(t.getFullYear()+100),t}const n=r.match(/\d+/g)||["2017","2","19","0","0","0"];let s=new Date(+n[0],+n[1]-1,+n[2],+n[3]||0,+n[4]||0,+n[5]||0);return r.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}const N0=new Date(1900,2,1,0,0,0);function M0(r,e){let t=Date.UTC(r.getFullYear(),r.getMonth(),r.getDate(),r.getHours(),r.getMinutes(),r.getSeconds());const n=Date.UTC(1899,11,31,0,0,0);return e?t-=1461*24*60*60*1e3:r>=N0&&(t+=24*60*60*1e3),(t-n)/(24*60*60*1e3)}function qt(r){let e=null,t={},n=r;if(r===null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(r)){e=r,n=Number(r.split(".")[0].replace(",",""));let s="#,##0";if(r.split(".")[1]){s="#,##0.";for(let i=0;i<r.split(".")[1].length;i++)s+=0}t={fa:s,t:"n"}}else if(r.toString().substr(0,1)==="'")e=r.toString().substr(1),t={fa:"@",t:"s"};else if(r.toString().toUpperCase()==="TRUE")e="TRUE",t={fa:"General",t:"b"},n=!0;else if(r.toString().toUpperCase()==="FALSE")e="FALSE",t={fa:"General",t:"b"},n=!1;else if(x0(r))e=r.toString(),t={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(r))e=r.toString(),t={fa:"@",t:"s"};else if(rs(r)&&Math.abs(parseFloat(r))>0&&(Math.abs(parseFloat(r))>=1e11||Math.abs(parseFloat(r))<1e-9)){n=Fr(r).value();const s=n.toExponential();if(s.indexOf(".")>-1){let i=s.split(".")[1].split("e")[0].length;i>5&&(i=5),t={fa:`#0.${new Array(i+1).join("0")}E+00`,t:"n"}}else t={fa:"#0.E+00",t:"n"};e=ur.format(t.fa,n)}else if(r.toString().indexOf("%")>-1){const s=r.toString().indexOf("%");let i=r.toString().substr(0,s);const o=i.replace(/,/g,"");if(s===r.toString().length-1&&rs(o))if(i.indexOf(".")>-1)if(i.indexOf(".")===i.lastIndexOf(".")){const a=i.split(".")[0];let u=i.split(".")[1].length;if(u>9&&(u=9),a.indexOf(",")>-1){let c=!0,h=a.split(",");for(let f=1;f<h.length;f++)if(h[f].length<3){c=!1;break}c?(t={fa:`#,##0.${new Array(u+1).join("0")}%`,t:"n"},n=Fr(r).value(),e=ur.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else t={fa:`0.${new Array(u+1).join("0")}%`,t:"n"},n=Fr(r).value(),e=ur.format(t.fa,n)}else e=r.toString(),t={fa:"@",t:"s"};else if(i.indexOf(",")>-1){let a=!0,l=i.split(",");for(let u=1;u<l.length;u++)if(l[u].length<3){a=!1;break}a?(t={fa:"#,##0%",t:"n"},n=Fr(r).value(),e=ur.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else t={fa:"0%",t:"n"},n=Fr(r).value(),e=ur.format(t.fa,n);else e=r.toString(),t={fa:"@",t:"s"}}else if(r.toString().indexOf(".")>-1)if(r.toString().indexOf(".")===r.toString().lastIndexOf(".")){const s=r.toString().split(".")[0];let i=r.toString().split(".")[1],o=i.length;if(o>9&&(o=9),s.indexOf(",")>-1){let a=!0,l=s.split(",");for(let u=1;u<l.length;u++)if(!rs(l[u])||l[u].length<3){a=!1;break}a?(t={fa:`#,##0.${new Array(o+1).join("0")}`,t:"n"},n=Fr(r).value(),e=ur.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else rs(s)&&rs(i)?(t={fa:`0.${new Array(o+1).join("0")}`,t:"n"},n=Fr(r).value(),e=ur.format(t.fa,n)):(e=r.toString(),t={fa:"@",t:"s"})}else e=r.toString(),t={fa:"@",t:"s"};else rs(r)?(e=r.toString(),t={fa:"General",t:"n"},n=parseFloat(r)):I0(r)&&(r.toString().indexOf(".")>-1||r.toString().indexOf(":")>-1||r.toString().length<16)?(n=M0(k0(r.toString().replace(/-/g,"/"))),n.toString().indexOf(".")>-1?r.toString().length>18?t.fa="yyyy-MM-dd hh:mm:ss":r.toString().length>11?t.fa="yyyy-MM-dd hh:mm":t.fa="yyyy-MM-dd":t.fa="yyyy-MM-dd",t.t="d",e=ur.format(t.fa,n)):(e=r,t.fa="General",t.t="g");return[e,t,n]}const ur={format(r,e){}},ss=(r,e)=>{};class ji{static getApplyData(e,t,n,s,i){const o=this,a=[];o.applyType=s,o.direction=i;const l=Math.floor(n/t),u=n%t,c=e.number,h=[];if(c)for(let x=0;x<c.length;x++){const S=o.getLenS(c[x].index,u),k=c[x].index.length*l+S;let N;s===1?N=o.getDataByType(c[x].data,k,i,s,"number"):s==="2"?N=o.getDataByType(c[x].data,k,i,s):N=o.getDataByType(c[x].data,k,i,"0");const O=o.getDataIndex(t,n,c[x].index);h.push({data:N,index:O})}const f=e.extendNumber,d=[];if(f)for(let x=0;x<f.length;x++){const S=o.getLenS(f[x].index,u),k=f[x].index.length*l+S;let N;s==="1"||s==="3"?N=o.getDataByType(f[x].data,k,i,s,"extendNumber"):s==="2"?N=o.getDataByType(f[x].data,k,i,s):N=o.getDataByType(f[x].data,k,i,"0");const O=o.getDataIndex(t,n,f[x].index);d.push({data:N,index:O})}const m=e.date,g=[];if(m)for(let x=0;x<m.length;x++){const S=o.getLenS(m[x].index,u),k=m[x].index.length*l+S;let N;s==="1"||s==="3"?N=o.getDataByType(m[x].data,k,i,s,"date"):s==="8"?N=o.getDataByType(m[x].data,k,i,"0"):N=o.getDataByType(m[x].data,k,i,s);const O=o.getDataIndex(t,n,m[x].index);g.push({data:N,index:O})}const p=e.chnNumber,_=[];if(p)for(let x=0;x<p.length;x++){const S=o.getLenS(p[x].index,u),k=p[x].index.length*l+S;let N;s==="1"||s==="3"?N=o.getDataByType(p[x].data,k,i,s,"chnNumber"):s==="2"||s==="8"?N=o.getDataByType(p[x].data,k,i,s):N=o.getDataByType(p[x].data,k,i,"0");const O=o.getDataIndex(t,n,p[x].index);_.push({data:N,index:O})}const v=e.chnWeek2,w=[];if(v)for(let x=0;x<v.length;x++){const S=o.getLenS(v[x].index,u),k=v[x].index.length*l+S;let N;s==="1"||s==="3"?N=o.getDataByType(v[x].data,k,i,s,"chnWeek2"):s==="2"?N=o.getDataByType(v[x].data,k,i,s):N=o.getDataByType(v[x].data,k,i,"0");const O=o.getDataIndex(t,n,v[x].index);w.push({data:N,index:O})}const y=e.chnWeek3,A=[];if(y)for(let x=0;x<y.length;x++){const S=o.getLenS(y[x].index,u),k=y[x].index.length*l+S;let N;s==="1"||s==="3"?N=o.getDataByType(y[x].data,k,i,s,"chnWeek3"):s==="2"?N=o.getDataByType(y[x].data,k,i,s):N=o.getDataByType(y[x].data,k,i,"0");const O=o.getDataIndex(t,n,y[x].index);A.push({data:N,index:O})}const I=e.other,R=[];if(I)for(let x=0;x<I.length;x++){const S=o.getLenS(I[x].index,u),k=I[x].index.length*l+S;let N;s==="2"||s==="3"?N=o.getDataByType(I[x].data,k,i,s):N=o.getDataByType(I[x].data,k,i,"0");const O=o.getDataIndex(t,n,I[x].index);R.push({data:N,index:O})}for(let x=1;x<=n;x++){if(h.length>0)for(let S=0;S<h.length;S++)x in h[S].index&&a.push(h[S].data[h[S].index[x]]);if(d.length>0)for(let S=0;S<d.length;S++)x in d[S].index&&a.push(d[S].data[d[S].index[x]]);if(g.length>0)for(let S=0;S<g.length;S++)x in g[S].index&&a.push(g[S].data[g[S].index[x]]);if(_.length>0)for(let S=0;S<_.length;S++)x in _[S].index&&a.push(_[S].data[_[S].index[x]]);if(w.length>0)for(let S=0;S<w.length;S++)x in w[S].index&&a.push(w[S].data[w[S].index[x]]);if(A.length>0)for(let S=0;S<A.length;S++)x in A[S].index&&a.push(A[S].data[A[S].index[x]]);if(R.length>0)for(let S=0;S<R.length;S++)x in R[S].index&&a.push(R[S].data[R[S].index[x]])}return a}static getCopyData(e,t,n,s,i,o){const a=this,l=[];let u=0,c=0,h=0,f=0;o===Q.BOTTOM||o===Q.TOP?(u=s,c=i,h=t,f=n):(o===Q.RIGHT||o===Q.LEFT)&&(u=t,c=n,h=s,f=i);for(let d=u;d<=c;d++){const m={};let g=[],p=[],_="",v=null,w=null,y=!0;for(let A=h,I=0;A<=f;A++,I++){const R=e[I];let x;if(!!R&&!!R.v&&!R.f)if(!!R.fm&&R.fm.t===el.NUMBER)x="number",v=null,w=null;else if(!!R.fm&&R.fm.t===el.DATE)x="date",v=null,w=null;else if(a.isExtendNumber(R.m)[0]){x="extendNumber";const S=a.isExtendNumber(R.m);v===null||w===null?(y=!0,v=S[2],w=S[3]):S[2]!==v||S[3]!==w?(y=!1,v=S[2],w=S[3]):y=!0}else a.isChnNumber(R.m)?(x="chnNumber",v=null,w=null):a.isChnWeek2(R.m)?(x="chnWeek2",v=null,w=null):a.isChnWeek3(R.m)?(x="chnWeek3",v=null,w=null):(x="other",v=null,w=null);else x="other",v=null,w=null;x==="extendNumber"?A===h?h===f?(_=x,g.push(R),p.push(A-h+1),m[_]=[],m[_].push({data:g,index:p})):(_=x,g.push(R),p.push(A-h+1)):A===f?_===x&&y?(g.push(R),p.push(A-h+1),_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p}))):(_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p})),_=x,g=[],g.push(R),p=[],p.push(A-h+1),_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p}))):_===x&&y?(g.push(R),p.push(A-h+1)):(_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p})),_=x,g=[],g.push(R),p=[],p.push(A-h+1)):A===h?h===f?(_=x,g.push(R),p.push(A-h+1),m[_]=[],m[_].push({data:g,index:p})):(_=x,g.push(R),p.push(A-h+1)):A===f?_===x?(g.push(R),p.push(A-h+1),_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p}))):(_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p})),_=x,g=[],g.push(R),p=[],p.push(A-h+1),_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p}))):_===x?(g.push(R),p.push(A-h+1)):(_ in m?m[_].push({data:g,index:p}):(m[_]=[],m[_].push({data:g,index:p})),_=x,g=[],g.push(R),p=[],p.push(A-h+1))}l.push(m)}return l}static ChineseToNumber(e){const t=this;let n=0,s=0,i=0,o=!1;const a=e.split("");for(let l=0;l<a.length;l++){const u=t.chnNumChar[a[l]];if(typeof u!="undefined")i=u,l===a.length-1&&(s+=i);else{const c=t.chnNameValue[a[l]].value;o=t.chnNameValue[a[l]].secUnit,o?(s=(s+i)*c,n+=s,s=0):s+=i*c,i=0}}return n+s}static NumberToChinese(e){const t=this;let n=0,s="",i="",o=!1;if(e===0)return t.chnNumChar2[0];for(;e>0;){const a=e%1e4;o&&(i=t.chnNumChar2[0]+i),s=t.SectionToChinese(a),s+=a!==0?t.chnUnitSection[n]:t.chnUnitSection[0],i=s+i,o=a<1e3&&a>0,e=Math.floor(e/1e4),n++}return i}static SectionToChinese(e){const t=this;let n="",s="",i=0,o=!0;for(;e>0;){const a=e%10;a===0?o||(o=!0,s=t.chnNumChar2[a]+s):(o=!1,n=t.chnNumChar2[a],n+=t.chnUnitChar[i],s=n+s),i++,e=Math.floor(e/10)}return s}static getLenS(e,t){let n=0;for(let s=0;s<e.length&&e[s]<=t;s++)n++;return n}static getDataByType(e,t,n,s,i){const o=this;let a=[];if(s===Qa.ALTERNATE_SERIES)(n===Q.TOP||n===Q.LEFT)&&e.reverse(),a=o.FillCopy(e,t);else if(s===Qa.DEFAULT_SERIES)if(i==="number")a=o.FillSeries(e,t,n);else if(i==="extendNumber")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillExtendNumber(e,t,l)}else{const l=[];for(let u=0;u<e.length;u++){const c=e[u].m;l.push(Number(o.isExtendNumber(c)[1]))}if((n===Q.TOP||n===Q.LEFT)&&(e.reverse(),l.reverse()),o.isEqualDiff(l)){const u=l[1]-l[0];a=o.FillExtendNumber(e,t,u)}else a=o.FillCopy(e,t)}else if(i==="date")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillDays(e,t,l)}else{(n===Q.TOP||n===Q.LEFT)&&e.reverse();const l=o.judgeDate(e);if(l[0]&&l[3]){const u=me(e[1].m).diff(me(e[0].m),"months");a=o.FillMonths(e,t,u)}else if(!l[0]&&l[2]){const u=me(e[1].m).diff(me(e[0].m),"days");a=o.FillDays(e,t,u)}else a=o.FillCopy(e,t)}else if(i==="chnNumber")if(e.length===1)if(e[0].m==="\u65E5"||o.ChineseToNumber(e[0].m)<7){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillChnWeek(e,t,l)}else{let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillChnNumber(e,t,l)}else{let l=!1;for(let h=0;h<e.length;h++)if(e[h].m==="\u65E5"){l=!0;break}const u=[];let c=0;for(let h=0;h<e.length;h++)e[h].m==="\u65E5"?h===0?u.push(0):(c++,u.push(c*7)):l&&o.ChineseToNumber(e[h].m)>0&&o.ChineseToNumber(e[h].m)<7?u.push(o.ChineseToNumber(e[h].m)+c*7):u.push(o.ChineseToNumber(e[h].m));if((n===Q.TOP||n===Q.LEFT)&&(e.reverse(),u.reverse()),o.isEqualDiff(u))if(l||u[u.length-1]<6&&u[0]>0||u[0]<6&&u[u.length-1]>0){const h=u[1]-u[0];a=o.FillChnWeek(e,t,h)}else{const h=u[1]-u[0];a=o.FillChnNumber(e,t,h)}else a=o.FillCopy(e,t)}else if(i==="chnWeek2")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillChnWeek2(e,t,l)}else{const l=[];let u=0;for(let c=0;c<e.length;c++){const h=e[c].m.substr(e[c].m.length-1,1);e[c].m==="\u5468\u65E5"?c===0?l.push(0):(u++,l.push(u*7)):l.push(o.ChineseToNumber(h)+u*7)}if((n===Q.TOP||n===Q.LEFT)&&(e.reverse(),l.reverse()),o.isEqualDiff(l)){const c=l[1]-l[0];a=o.FillChnWeek2(e,t,c)}else a=o.FillCopy(e,t)}else if(i==="chnWeek3")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillChnWeek3(e,t,l)}else{const l=[];let u=0;for(let c=0;c<e.length;c++){const h=e[c].m.substr(e[c].m.length-1,1);e[c].m==="\u661F\u671F\u65E5"?c===0?l.push(0):(u++,l.push(u*7)):l.push(o.ChineseToNumber(h)+u*7)}if((n===Q.TOP||n===Q.LEFT)&&(e.reverse(),l.reverse()),o.isEqualDiff(l)){const c=l[1]-l[0];a=o.FillChnWeek3(e,t,c)}else a=o.FillCopy(e,t)}else(n===Q.TOP||n===Q.LEFT)&&e.reverse(),a=o.FillCopy(e,t);else if(s==="2")(n===Q.TOP||n===Q.LEFT)&&e.reverse(),a=o.FillOnlyFormat(e,t);else if(s==="3"){const l=o.getDataByType(e,t,n,"1",i);a=o.FillWithoutFormat(l)}else if(s==="4")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillDays(e,t,l)}else if(e.length===2){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"days");a=o.FillDays(e,t,l)}else{(n===Q.TOP||n===Q.LEFT)&&e.reverse();const l=o.judgeDate(e);if(l[0]&&l[3]){const u=me(e[1].m).diff(me(e[0].m),"months");a=o.FillMonths(e,t,u)}else if(!l[0]&&l[2]){const u=me(e[1].m).diff(me(e[0].m),"days");a=o.FillDays(e,t,u)}else a=o.FillCopy(e,t)}else if(s==="5")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1);const u=Math.round(t*1.5);for(let c=1;c<=u;c++){const h={...e[c]},f=me(h.m).add(c,"days").day();if(f===0||f===6)continue;const d=me(h.m).add(l*c,"days").format("YYYY-MM-DD");if(h.m=d,h.v=qt(d)[2],a.push(h),a.length===t)break}}else if(e.length===2)if(me(e[1].m).date()===me(e[0].m).date()&&me(e[1].m).diff(me(e[0].m),"months")!==0){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"months");for(let u=1;u<=t;u++){const c=(u-1)%e.length,h={...e[c]},f=me(e[e.length-1]).add(l*u,"months").day();let d;f===0?d=me(e[e.length-1]).add(l*u,"months").subtract(2,"days").format("YYYY-MM-DD"):f===6?d=me(e[e.length-1]).add(l*u,"months").subtract(1,"days").format("YYYY-MM-DD"):d=me(e[e.length-1]).add(l*u,"months").format("YYYY-MM-DD"),h.m=d,h.v=qt(d)[2],a.push(h)}}else if(Math.abs(me(e[1].m).diff(me(e[0].m)))>7){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,f={...e[h]},d=Math.ceil(c/e.length);h===0&&(u=me(f.m).add(l*d,"months").diff(me(f.m),"days"));const m=me(f.m).add(u,"days").day();let g;m===0?g=me(f.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):m===6?g=me(f.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):g=me(f.m).add(u,"days").format("YYYY-MM-DD"),f.m=g,f.v=qt(g)[2],a.push(f)}}else{let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=7:(n===Q.TOP||n===Q.LEFT)&&(l=-7,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,f={...e[h]},d=Math.ceil(c/e.length);h===0&&(u=me(f.m).add(l*d,"days").diff(me(f.m),"days"));const m=me(f.m).add(u,"days").day();let g;m===0?g=me(f.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):m===6?g=me(f.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):g=me(f.m).add(u,"days").format("YYYY-MM-DD"),f.m=g,f.v=qt(g)[2],a.push(f)}}else{const l=o.judgeDate(e);if(l[0]&&l[3]){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const u=me(e[1].m).diff(me(e[0].m),"months");for(let c=1;c<=t;c++){const h=(c-1)%e.length,f={...e[h]},d=me(e[e.length-1].m).add(u*c,"months").day();let m;d===0?m=me(e[e.length-1].m).add(u*c,"months").subtract(2,"days").format("YYYY-MM-DD"):d===6?m=me(e[e.length-1].m).add(u*c,"months").subtract(1,"days").format("YYYY-MM-DD"):m=me(e[e.length-1].m).add(u*c,"months").format("YYYY-MM-DD"),f.m=m,f.v=qt(m)[2],a.push(f)}}else if(!l[0]&&l[2])if(Math.abs(me(e[1].m).diff(me(e[0].m)))>7){let u=0;n===Q.BOTTOM||n===Q.RIGHT?u=1:(n===Q.TOP||n===Q.LEFT)&&(u=-1,e.reverse());let c=0;for(let h=1;h<=t;h++){const f=(h-1)%e.length,d={...e[f]},m=Math.ceil(h/e.length);f===0&&(c=me(d.m).add(u*m,"months").diff(me(d.m),"days"));const g=me(d.m).add(c,"days").day();let p;g===0?p=me(d.m).add(c,"days").subtract(2,"days").format("YYYY-MM-DD"):g===6?p=me(d.m).add(c,"days").subtract(1,"days").format("YYYY-MM-DD"):p=me(d.m).add(c,"days").format("YYYY-MM-DD"),d.m=p,d.v=qt(p)[2],a.push(d)}}else{let u=0;n===Q.BOTTOM||n===Q.RIGHT?u=7:(n===Q.TOP||n===Q.LEFT)&&(u=-7,e.reverse());let c=0;for(let h=1;h<=t;h++){const f=(h-1)%e.length,d={...e[f]},m=Math.ceil(h/e.length);f===0&&(c=me(d.m).add(u*m,"days").diff(me(d.m),"days"));const g=me(d.m).add(c,"days").day();let p;g===0?p=me(d.m).add(c,"days").subtract(2,"days").format("YYYY-MM-DD"):g===6?p=me(d.m).add(c,"days").subtract(1,"days").format("YYYY-MM-DD"):p=me(d.m).add(c,"days").format("YYYY-MM-DD"),d.m=p,d.v=qt(p)[2],a.push(d)}}else(n===Q.TOP||n===Q.LEFT)&&e.reverse(),a=o.FillCopy(e,t)}else if(s==="6")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillMonths(e,t,l)}else if(e.length===2)if(me(e[1].m).date()===me(e[0].m).date()&&me(e[1].m).diff(me(e[0].m),"months")!==0){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"months");a=o.FillMonths(e,t,l)}else{let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,f={...e[h]},d=Math.ceil(c/e.length);h===0&&(u=me(f.m).add(l*d,"months").diff(me(f.m),"days"));const m=me(f.m).add(u,"days").format("YYYY-MM-DD");f.m=m,f.v=qt(m)[2],a.push(f)}}else{const l=o.judgeDate(e);if(l[0]&&l[3]){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const u=me(e[1].m).diff(me(e[0].m),"months");a=o.FillMonths(e,t,u)}else if(!l[0]&&l[2]){let u=0;n===Q.BOTTOM||n===Q.RIGHT?u=1:(n===Q.TOP||n===Q.LEFT)&&(u=-1,e.reverse());let c=0;for(let h=1;h<=t;h++){const f=(h-1)%e.length,d={...e[f]},m=Math.ceil(h/e.length);f===0&&(c=me(d.m).add(u*m,"months").diff(me(d.m),"days"));const g=me(d.m).add(c,"days").format("YYYY-MM-DD");d.m=g,d.v=qt(g)[2],a.push(d)}}else(n===Q.TOP||n===Q.LEFT)&&e.reverse(),a=o.FillCopy(e,t)}else if(s==="7")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillYears(e,t,l)}else if(e.length===2)if(me(e[1].m).date()===me(e[0].m).date()&&me(e[1].m).month()===me(e[0].m).month()&&me(e[1].m).diff(me(e[0].m),"years")!==0){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const l=me(e[1].m).diff(me(e[0].m),"years");a=o.FillYears(e,t,l)}else{let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1,e.reverse());let u=0;for(let c=1;c<=t;c++){const h=(c-1)%e.length,f={...e[h]},d=Math.ceil(c/e.length);h===0&&(u=me(f.m).add(l*d,"years").diff(me(f.m),"days"));const m=me(f.m).add(u,"days").format("YYYY-MM-DD");f.m=m,f.v=qt(m)[2],a.push(f)}}else{const l=o.judgeDate(e);if(l[0]&&l[1]&&l[4]){(n===Q.TOP||n===Q.LEFT)&&e.reverse();const u=me(e[1].m).diff(me(e[0].m),"years");a=o.FillYears(e,t,u)}else if(l[0]&&l[3]||l[2]){let u=0;n===Q.BOTTOM||n===Q.RIGHT?u=1:(n===Q.TOP||n===Q.LEFT)&&(u=-1,e.reverse());let c=0;for(let h=1;h<=t;h++){const f=(h-1)%e.length,d={...e[f]},m=Math.ceil(h/e.length);f===0&&(c=me(d.m).add(u*m,"years").diff(me(d.m),"days"));const g=me(d.m).add(c,"days").format("YYYY-MM-DD");d.m=g,d.v=qt(g)[2],a.push(d)}}else(n===Q.TOP||n===Q.LEFT)&&e.reverse(),a=o.FillCopy(e,t)}else if(s==="8")if(e.length===1){let l=0;n===Q.BOTTOM||n===Q.RIGHT?l=1:(n===Q.TOP||n===Q.LEFT)&&(l=-1),a=o.FillChnNumber(e,t,l)}else{const l=[];for(let u=0;u<e.length;u++)l.push(o.ChineseToNumber(e[u].m));if((n===Q.TOP||n===Q.LEFT)&&(e.reverse(),l.reverse()),o.isEqualDiff(l)){const u=l[1]-l[0];a=o.FillChnNumber(e,t,u)}else a=o.FillCopy(e,t)}return a}static getDataIndex(e,t,n){const s={},i=Math.floor(t/e),o=t%e;let a=0;if(i>0){for(let l=1;l<=i;l++)for(let u=0;u<n.length;u++)s[n[u]+(l-1)*e]=a,a++;for(let l=0;l<n.length&&n[l]<=o;l++)s[n[l]+e*i]=a,a++}else for(let l=0;l<n.length&&n[l]<=o;l++)s[n[l]]=a,a++;return s}static FillCopy(e,t){const n=[];for(let s=1;s<=t;s++){const i=(s-1)%e.length,o={...e[i]};n.push(o)}return n}static FillSeries(e,t,n){const s=this,i=[],o=[];for(let a=0;a<e.length;a++)o.push(Number(e[a].v));if(e.length>2&&s.isEqualRatio(o))for(let a=1;a<=t;a++){const l=(a-1)%e.length,u={...e[l]};let c;n===Q.BOTTOM||n===Q.RIGHT?c=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**a:(n===Q.TOP||n===Q.LEFT)&&(c=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**a),u.v=c,u.m=c,i.push(u)}else{const a=s.getXArr(e.length);for(let l=1;l<=t;l++){const u=(l-1)%e.length,c={...e[u]};let h;n===Q.BOTTOM||n===Q.RIGHT?h=s.forecast(e.length+l,o,a):(n===Q.TOP||n===Q.LEFT)&&(h=s.forecast(1-l,o,a)),c.v=h,c.m=h,i.push(c)}}return i}static FillExtendNumber(e,t,n){const s=[],i=/0|([1-9]+[0-9]*)/g;for(let o=1;o<=t;o++){const a=(o-1)%e.length,l={...e[a]},u=e[e.length-1].m,c=u.match(i),h=c[c.length-1],f=Math.abs(Number(h)+n*o),d=u.lastIndexOf(h),m=u.substr(0,d)+f.toString()+u.substr(d+h.length);l.v=m,l.m=m,s.push(l)}return s}static FillOnlyFormat(e,t){const n=[];for(let s=1;s<=t;s++){const i=(s-1)%e.length,o={...e[i]};delete o.f,delete o.m,delete o.v,n.push(o)}return n}static FillWithoutFormat(e){const t=[];for(let n=0;n<e.length;n++){const s={...e[n]};let i;s.f===null?i={m:s.v.toString(),v:s.v}:i={f:s.f,m:s.v.toString(),v:s.v},t.push(i)}return t}static FillDays(e,t,n){const s=[];for(let i=1;i<=t;i++){const o=(i-1)%e.length,a={...e[o]};let l=ss("yyyy-MM-dd",a.v);l=me(l).add(n*i,"days").format("YYYY-MM-DD"),a.v=qt(l)[2],a.m=ss(a.fm.f,a.v),s.push(a)}return s}static FillMonths(e,t,n){const s=[];for(let i=1;i<=t;i++){const o=(i-1)%e.length,a={...e[o]};let l=ss("yyyy-MM-dd",a.v);l=me(l).add(n*i,"months").format("YYYY-MM-DD"),a.v=qt(l)[2],a.m=ss(a.fm.f,a.v),s.push(a)}return s}static FillYears(e,t,n){const s=[];for(let i=1;i<=t;i++){const o=(i-1)%e.length,a={...e[o]};let l=ss("yyyy-MM-dd",a.v);l=me(l).add(n*i,"years").format("YYYY-MM-DD"),a.v=qt(l)[2],a.m=ss(a.fm.t,a.v),s.push(a)}return s}static FillChnWeek(e,t,n){const s=this,i=[];for(let o=1;o<=t;o++){const a=(o-1)%e.length,l={...e[a]};let u;e[e.length-1].m==="\u65E5"?u=7+n*o:u=s.ChineseToNumber(e[e.length-1].m)+n*o,u<0&&(u=Math.ceil(Math.abs(u)/7)*7+u);const c=u%7;c===0?(l.m="\u65E5",l.v="\u65E5"):c===1?(l.m="\u4E00",l.v="\u4E00"):c===2?(l.m="\u4E8C",l.v="\u4E8C"):c===3?(l.m="\u4E09",l.v="\u4E09"):c===4?(l.m="\u56DB",l.v="\u56DB"):c===5?(l.m="\u4E94",l.v="\u4E94"):c===6&&(l.m="\u516D",l.v="\u516D"),i.push(l)}return i}static FillChnWeek2(e,t,n){const s=this,i=[];for(let o=1;o<=t;o++){const a=(o-1)%e.length,l={...e[a]};let u;if(e[e.length-1].m==="\u5468\u65E5")u=7+n*o;else{const h=e[e.length-1].m,f=h.substr(h.length-1,1);u=s.ChineseToNumber(f)+n*o}u<0&&(u=Math.ceil(Math.abs(u)/7)*7+u);const c=u%7;c===0?(l.m="\u5468\u65E5",l.v="\u5468\u65E5"):c===1?(l.m="\u5468\u4E00",l.v="\u5468\u4E00"):c===2?(l.m="\u5468\u4E8C",l.v="\u5468\u4E8C"):c===3?(l.m="\u5468\u4E09",l.v="\u5468\u4E09"):c===4?(l.m="\u5468\u56DB",l.v="\u5468\u56DB"):c===5?(l.m="\u5468\u4E94",l.v="\u5468\u4E94"):c===6&&(l.m="\u5468\u516D",l.v="\u5468\u516D"),i.push(l)}return i}static FillChnWeek3(e,t,n){const s=this,i=[];for(let o=1;o<=t;o++){const a=(o-1)%e.length,l={...e[a]};let u;if(e[e.length-1].m==="\u661F\u671F\u65E5")u=7+n*o;else{const h=e[e.length-1].m,f=h.substr(h.length-1,1);u=s.ChineseToNumber(f)+n*o}u<0&&(u=Math.ceil(Math.abs(u)/7)*7+u);const c=u%7;c===0?(l.m="\u661F\u671F\u65E5",l.v="\u661F\u671F\u65E5"):c===1?(l.m="\u661F\u671F\u4E00",l.v="\u661F\u671F\u4E00"):c===2?(l.m="\u661F\u671F\u4E8C",l.v="\u661F\u671F\u4E8C"):c===3?(l.m="\u661F\u671F\u4E09",l.v="\u661F\u671F\u4E09"):c===4?(l.m="\u661F\u671F\u56DB",l.v="\u661F\u671F\u56DB"):c===5?(l.m="\u661F\u671F\u4E94",l.v="\u661F\u671F\u4E94"):c===6&&(l.m="\u661F\u671F\u516D",l.v="\u661F\u671F\u516D"),i.push(l)}return i}static FillChnNumber(e,t,n){const s=this,i=[];for(let o=1;o<=t;o++){const a=(o-1)%e.length,l={...e[a]},u=s.ChineseToNumber(e[e.length-1].m)+n*o;let c;u<=0?c="\u96F6":c=s.NumberToChinese(u),l.v=c,l.m=c.toString(),i.push(l)}return i}static isEqualDiff(e){let t=!0;const n=e[1]-e[0];for(let s=1;s<e.length;s++)if(e[s]-e[s-1]!==n){t=!1;break}return t}static isChnNumber(e){const t=this;let n=!0;if(e.length===1)e==="\u65E5"||e in t.chnNumChar?n=!0:n=!1;else{const s=e.split("");for(let i=0;i<s.length;i++)if(!(s[i]in t.chnNumChar||s[i]in t.chnNameValue)){n=!1;break}}return n}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,n=t.test(e);if(n){const s=e.match(t),i=s[s.length-1],o=e.lastIndexOf(i),a=e.substr(0,o),l=e.substr(o+i.length);return[n,Number(i),a,l]}return[n]}static isChnWeek1(e){const t=this;let n;return e.length===1&&(e==="\u65E5"||t.ChineseToNumber(e)<7)?n=!0:n=!1,n}static isChnWeek2(e){let t;return e.length===2&&(e==="\u5468\u4E00"||e==="\u5468\u4E8C"||e==="\u5468\u4E09"||e==="\u5468\u56DB"||e==="\u5468\u4E94"||e==="\u5468\u516D"||e==="\u5468\u65E5")?t=!0:t=!1,t}static isChnWeek3(e){let t;return e.length===3&&(e==="\u661F\u671F\u4E00"||e==="\u661F\u671F\u4E8C"||e==="\u661F\u671F\u4E09"||e==="\u661F\u671F\u56DB"||e==="\u661F\u671F\u4E94"||e==="\u661F\u671F\u516D"||e==="\u661F\u671F\u65E5")?t=!0:t=!1,t}static isEqualRatio(e){let t=!0;const n=e[1]/e[0];for(let s=1;s<e.length;s++)if(e[s]/e[s-1]!==n){t=!1;break}return t}static getXArr(e){const t=[];for(let n=1;n<=e;n++)t.push(n);return t}static forecast(e,t,n){function s(h){let f=0;for(let d=0;d<h.length;d++)f+=h[d];return f/h.length}const i=s(n),o=s(t);let a=0,l=0;for(let h=0;h<n.length;h++)a+=(n[h]-i)*(t[h]-o),l+=(n[h]-i)*(n[h]-i);let u;l===0?u=1:u=a/l;const c=o-u*i;return Math.round((c+u*e)*1e5)/1e5}static judgeDate(e){let t=!0,n=!0,s=!0,i=!0,o=!0;const a=me(e[0].m).date(),l=me(e[0].m).month(),u=me(e[1].m).diff(me(e[0].m),"days"),c=me(e[1].m).diff(me(e[0].m),"months"),h=me(e[1].m).diff(me(e[0].m),"years");for(let f=1;f<e.length;f++)me(e[f].m).date()!==a&&(t=!1),me(e[f].m).month()!==l&&(n=!1),me(e[f].m).diff(me(e[f-1].m),"days")!==u&&(s=!1),me(e[f].m).diff(me(e[f-1].m),"months")!==c&&(i=!1),me(e[f].m).diff(me(e[f-1].m),"years")!==h&&(o=!1);return u===0&&(s=!1),c===0&&(i=!1),h===0&&(o=!1),[t,n,s,i,o]}}let Rt=(r=21)=>crypto.getRandomValues(new Uint8Array(r)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");class F0{constructor(e,t){this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach(n=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(n).rangeData)}),this._rangeList[0].startRow===-1&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return this._rangeList[0].startRow===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:i}=this;const o=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:f}=l,d=new pe;for(let g=u;g<=h;g++)for(let p=c;p<=f;p++)d.setValue(u,c,{m:`${e}`,v:e});return{sheetId:i.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:d.getData()}});let a=new fe({WorkBookUnit:n.getWorkBook()},...o);return s.invoke(a),this}clear(...e){const{_context:t,_worksheet:n,_commandManager:s,_rangeList:i}=this;let o={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0};it.checkup(e,it.OBJECT_TYPE)&&(o=e[0]);const a=i.map(u=>({sheetId:n.getSheetId(),actionName:W.CLEAR_RANGE_ACTION,options:o,rangeData:u}));let l=new fe({WorkBookUnit:t.getWorkBook()},...a);return s.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}_setStyle(e,t){let{_rangeList:n,_context:s,_commandManager:i,_worksheet:o}=this;const a=n.map(u=>{let{startRow:c,startColumn:h,endRow:f,endColumn:d}=u;const m={[t]:e},g=G.fillObjectMatrix(f-c+1,d-h+1,m);return{sheetId:o.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:g,rangeData:u}});let l=new fe({WorkBookUnit:s.getWorkBook()},...a);return i.invoke(l),this}setBackground(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:i}=this;const o=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:f}=l;const d={bg:{rgb:e}},m=G.fillObjectMatrix(h-u+1,f-c+1,d);return{sheetId:i.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new fe({WorkBookUnit:n.getWorkBook()},...o);return s.invoke(a),this}setBackgroundRGB(e,t,n){const s=`RGB(${e},${t},${n})`;let{_rangeList:i,_context:o,_commandManager:a,_worksheet:l}=this;const u=i.map(h=>{let{startRow:f,startColumn:d,endRow:m,endColumn:g}=h;const p={bg:{rgb:s}},_=G.fillObjectMatrix(m-f+1,g-d+1,p);return{sheetId:l.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:_,rangeData:h}});let c=new fe({WorkBookUnit:o.getWorkBook()},...u);return a.invoke(c),this}setFontColor(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:i}=this;const o=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:f}=l;const d={cl:{rgb:e}},m=G.fillObjectMatrix(h-u+1,f-c+1,d);return{sheetId:i.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new fe({WorkBookUnit:n.getWorkBook()},...o);return s.invoke(a),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?te.TRUE:te.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?te.TRUE:te.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?te.TRUE:te.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?te.TRUE:te.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?te.TRUE:te.FALSE;return this._setStyle(t,"bl")}setFormula(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:i}=this;const o=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:f}=l,d=new pe;for(let g=u;g<=h;g++)for(let p=c;p<=f;p++)d.setValue(g,p,e);return{sheetId:i.getSheetId(),actionName:W.SET_RANGE_FORMULA_ACTION,cellFormula:d.getData(),rangeData:l}});let a=new fe({WorkBookUnit:n.getWorkBook()},...o);return s.invoke(a),this}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:i}=this;const o=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:f}=l;const d={tr:{v:0,a:Number(e)}},m=G.fillObjectMatrix(h-u+1,f-c+1,d);return{sheetId:i.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new fe({WorkBookUnit:n.getWorkBook()},...o);return s.invoke(a),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:n,_commandManager:s,_worksheet:i}=this;const o=t.map(l=>{let{startRow:u,startColumn:c,endRow:h,endColumn:f}=l;const d={tr:{v:e,a:0}},m=G.fillObjectMatrix(h-u+1,f-c+1,d);return{sheetId:i.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:m,rangeData:l}});let a=new fe({WorkBookUnit:n.getWorkBook()},...o);return s.invoke(a),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:n,_worksheet:s}=this;const i=e.map(a=>{let{startRow:l,startColumn:u,endRow:c,endColumn:h}=a;const f=this._worksheet.getCellMatrix(),d=/\s+/g;let m=new pe;for(let p=l;p<c+1;p++)for(let _=u;_<h+1;_++){const w=f.getValue(p,_).m.replace(d,"");m.setValue(p,_,w||"")}return{sheetId:s.getSheetId(),actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:m.getData(),rangeData:a}});let o=new fe({WorkBookUnit:t.getWorkBook()},...i);return n.invoke(o),this}}class B0{constructor(e,t){this._workSheet=e,this._rowData=new tt(t)}getRowData(){return this._rowData}getRowDatas(e,t){const n=new tt;for(let s=e;s<e+t;s++){const i=this.getRowOrCreate(s);n.push(i)}return n}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:n}=this,s=t.getConfig();let i=0;if(e.length===1)i=n.obtain(e[0],{hd:te.FALSE,h:s.defaultRowHeight}).h;else if(e.length===2)for(let o=e[0];o<e[0]+e[1];o++)i+=n.obtain(o,{hd:te.FALSE,h:s.defaultRowHeight}).h;return i}setRowHeight(e,t){const n=this._workSheet.getContext(),s=this._workSheet.getCommandManager(),i={sheetId:this._workSheet.getSheetId(),actionName:W.SET_ROW_HEIGHT_ACTION,rowIndex:e,rowHeight:t},o=new fe({WorkBookUnit:n.getWorkBook()},i);s.invoke(o)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:n}=this,s=n.get(e);if(s)return s;const i=t.getConfig(),o={hd:te.FALSE,h:i.defaultRowHeight};return n.set(e,o),o}}class fn{_initialize(){this._merges=new D0(this,this._config.mergeData)}constructor(...e){var t;if(G.hasLength(e,1)){const n=e[0],s=G.commonExtend({},Vr);e=[n,s]}if(G.hasLength(e,2)){this._context=e[0],this._config=G.commonExtend1(Vr,e[1]);const{columnData:n,rowData:s,cellData:i}=this._config;this._sheetId=(t=this._config.id)!=null?t:Rt(6),this._initialized=!1,this._cellData=new pe(i),this._commandManager=this._context.getCommandManager(),this._rowManager=new B0(this,s),this._columnManager=new W6(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===te.TRUE)return this;const{_context:e,_commandManager:t}=this,n=e.getContextObserver("onBeforeChangeActiveSheetObservable"),s=e.getContextObserver("onAfterChangeActiveSheetObservable"),i={sheetId:this._sheetId,actionName:W.SET_WORKSHEET_ACTIVATE_ACTION,status:te.TRUE},o=new fe({WorkBookUnit:e.getWorkBook()},i);return n.notifyObservers({sheet:this}),t.invoke(o),s.notifyObservers({sheet:this}),this}setConfig(e){return this._config=G.commonExtend(Vr,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_commandManager:n,_sheetId:s}=this,i=t.getContextObserver("onBeforeChangeSheetNameObservable"),o=t.getContextObserver("onAfterChangeSheetNameObservable"),a={actionName:W.SET_WORKSHEET_NAME_ACTION,sheetName:e,sheetId:s},u=t.getWorkBook().getSheets();for(let h=0;h<u.length;h++){const f=u[h];if(f!==this&&f.getName()===e)return console.warn("Duplicate name"),this}i.notifyObservers();const c=new fe({WorkBookUnit:t.getWorkBook()},a);return n.invoke(c),o.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,n=G.deepClone(e);return new fn(t,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._commandManager}getSheetData(){return[]}getRange(...e){if(G.hasLength(e,1))return new ut(this,e[0]);if(G.hasLength(e,2))return new ut(this,{row:[e[0],e[0]],column:[e[1],e[1]]});if(G.hasLength(e,3))return new ut(this,{row:[e[0],e[2]],column:[e[1],e[1]]});if(G.hasLength(e,4))return new ut(this,{row:[e[0],e[2]],column:[e[1],e[3]]})}getRangeList(e){return new F0(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_commandManager:n,_sheetId:s}=this,i={actionName:W.SET_WORKSHEET_STATUS_ACTION,sheetId:s,sheetStatus:e},o=new fe({WorkBookUnit:t.getWorkBook()},i);return n.invoke(o),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:n,_commandManager:s}=this,i={actionName:W.SET_ZOOM_RATIO_ACTION,sheetId:n,zoom:e},o=new fe({WorkBookUnit:t.getWorkBook()},i);s.invoke(o),t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:n}=this,s=G.deepClone(t);return s.name=e,s.status=te.FALSE,s.id=Rt(),new fn(n,s)}getConfig(){return this._config}insertRows(...e){let t=0,n=1;G.hasLength(e,1)&&(t=e[0]),G.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.INSERT_ROW_DATA_ACTION,sheetId:o,rowIndex:t,rowData:new pe(new tt(n)).toJSON()},l={actionName:W.INSERT_ROW_ACTION,sheetId:o,rowIndex:t,rowCount:n},u=new fe({WorkBookUnit:s.getWorkBook()},a,l);return i.invoke(u),this}insertRowAfter(...e){let t=0,n=1;G.hasLength(e,1)&&(t=e[0]+1),G.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.INSERT_ROW_DATA_ACTION,sheetId:o,rowIndex:t,rowData:new pe(new tt(n)).toJSON()},l={actionName:W.INSERT_ROW_ACTION,sheetId:o,rowIndex:t,rowCount:n},u=new fe({WorkBookUnit:s.getWorkBook()},a,l);return i.invoke(u),this}insertRowBefore(...e){let t=0,n=1;G.hasLength(e,1)&&(t=e[0]-1),G.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.INSERT_ROW_DATA_ACTION,sheetId:o,rowIndex:t,rowData:new pe(new tt(n)).toJSON()},l={actionName:W.INSERT_ROW_ACTION,sheetId:o,rowIndex:t,rowCount:n},u=new fe({WorkBookUnit:s.getWorkBook()},a,l);return i.invoke(u),this}insertColumns(...e){let t=0,n=1;G.hasLength(e,1)&&(t=e[0]),G.hasLength(e,2)&&(t=e[0],n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a=new pe;this._cellData.forEach(h=>{for(let f=t;f<t+n;f++)a.setValue(h,f-t,{})});const l={actionName:W.INSERT_COLUMN_DATA_ACTION,sheetId:o,columnIndex:t,columnData:a.toJSON()},u={actionName:W.INSERT_COLUMN_ACTION,sheetId:o,columnIndex:t,columnCount:n},c=new fe({WorkBookUnit:s.getWorkBook()},u,l);return i.invoke(c),this}insertColumnBefore(...e){let t=0,n=1;G.hasLength(e,1)&&(t=e[0]-1),G.hasLength(e,2)&&(t=e[0]-1,n=e[1]),t<0&&(t=0);const{_context:s,_commandManager:i,_sheetId:o}=this,a=new pe;this._cellData.forEach(h=>{for(let f=t;f<t+n;f++)a.setValue(h,f-t,{})});const l={actionName:W.INSERT_COLUMN_DATA_ACTION,sheetId:o,columnIndex:t,columnData:a.toJSON()},u={actionName:W.INSERT_COLUMN_ACTION,sheetId:o,columnIndex:t,columnCount:n},c=new fe({WorkBookUnit:s.getWorkBook()},u,l);return i.invoke(c),this}insertColumnAfter(...e){let t=0,n=1;G.hasLength(e,1)&&(t=e[0]+1),G.hasLength(e,2)&&(t=e[0]+1,n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a=new pe;this._cellData.forEach(h=>{for(let f=t;f<t+n;f++)a.setValue(h,f-t,{})});const l={actionName:W.INSERT_COLUMN_DATA_ACTION,sheetId:o,columnIndex:t,columnData:a.toJSON()},u={actionName:W.INSERT_COLUMN_ACTION,sheetId:o,columnIndex:t,columnCount:n},c=new fe({WorkBookUnit:s.getWorkBook()},l,u);return i.invoke(c),this}clear(...e){const{_context:t,_commandManager:n}=this,s={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let i={formatOnly:!0,contentsOnly:!0};it.checkup(e,it.OBJECT_TYPE)&&(i=e[0]);const o={sheetId:this._sheetId,actionName:W.CLEAR_RANGE_ACTION,options:i,rangeData:s},a=new fe({WorkBookUnit:t.getWorkBook()},o);return n.invoke(a),this}setTabColor(e){const{_context:t,_commandManager:n}=this,s=t.getContextObserver("onSheetTabColorChangeObservable"),i={sheetId:this._sheetId,actionName:W.SET_TAB_COLOR_ACTION,color:e},o=new fe({WorkBookUnit:t.getWorkBook()},i);return n.invoke(o),s.notifyObservers(),this}hideSheet(){const{_context:e,_commandManager:t}=this,n=e.getWorkBook();if(!this._config.hidden){const s=e.getContextObserver("onHideSheetObservable"),i={sheetId:this._sheetId,actionName:W.HIDE_SHEET_ACTION,hidden:te.TRUE},o=new fe({WorkBookUnit:e.getWorkBook()},i);if(t.invoke(o),this.getStatus()===te.TRUE){const l=n.getSheetIndex(this),u=n.nextSheet(l);u&&u.activate()}s.notifyObservers({sheet:this})}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e,_commandManager:t}=this,n={sheetId:this._sheetId,actionName:W.HIDE_SHEET_ACTION,hidden:te.FALSE},s=new fe({WorkBookUnit:e.getWorkBook()},n);return t.invoke(s),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setCommandManager(e){return this._commandManager=e,this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:n}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_commandManager:n,_sheetId:s}=this,i={actionName:W.REMOVE_COLUMN_DATA_ACTION,sheetId:s,columnCount:1,columnIndex:e},o={actionName:W.REMOVE_COLUMN_ACTION,sheetId:s,columnCount:1,columnIndex:e},a=new fe({WorkBookUnit:t.getWorkBook()},i,o);return n.invoke(a),this}deleteColumns(e,t){const{_context:n,_commandManager:s,_sheetId:i}=this,o={actionName:W.REMOVE_COLUMN_DATA_ACTION,sheetId:i,columnCount:t,columnIndex:e},a={actionName:W.REMOVE_COLUMN_ACTION,sheetId:i,columnCount:t,columnIndex:e},l=new fe({WorkBookUnit:n.getWorkBook()},o,a);return s.invoke(l),this}deleteRow(e){const{_context:t,_commandManager:n,_sheetId:s}=this,i={actionName:W.REMOVE_ROW_DATA_ACTION,sheetId:s,rowCount:1,rowIndex:e},o={actionName:W.REMOVE_ROW_ACTION,sheetId:s,rowCount:1,rowIndex:e},a=new fe({WorkBookUnit:t.getWorkBook()},i,o);return n.invoke(a),this}deleteRows(e,t){const{_context:n,_commandManager:s,_sheetId:i}=this,o={actionName:W.REMOVE_ROW_DATA_ACTION,sheetId:i,rowCount:t,rowIndex:e},a={actionName:W.REMOVE_ROW_ACTION,sheetId:i,rowCount:t,rowIndex:e},l=new fe({WorkBookUnit:n.getWorkBook()},o,a);return s.invoke(l),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,n){const{_commandManager:s,_sheetId:i}=this,o=this.getContext(),a=this.getCellMatrix(),l=o.getWorkBook(),u=l.getStyles(),c=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),h=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),f=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),d=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),m=this.getRange(e),g=new pe,p=new pe,_=new pe,v=new pe,w=new pe;c.forEach((R,x)=>{const S=a.getValue(R,x);if(S){const k=u.getStyleByCell(S);if(k){const N=G.deepClone(k);N.bd&&delete N.bd.b,g.setValue(R,x,N)}}}),f.forEach((R,x)=>{const S=a.getValue(R,x);if(S){const k=u.getStyleByCell(S);if(k){const N=G.deepClone(k);N.bd&&delete N.bd.t,_.setValue(R,x,N)}}}),h.forEach((R,x)=>{const S=a.getValue(R,x);if(S){const k=u.getStyleByCell(S);if(k){const N=G.deepClone(k);N.bd&&delete N.bd.r,p.setValue(R,x,N)}}}),d.forEach((R,x)=>{const S=a.getValue(R,x);if(S){const k=u.getStyleByCell(S);if(k){const N=G.deepClone(k);N.bd&&delete N.bd.l,v.setValue(R,x,N)}}}),m.forEach((R,x)=>{w.setValue(R,x,t)});const y=[];if(n.includes(Q.TOP)){const R={sheetId:i,actionName:W.SET_BORDER_ACTION,styles:_.toJSON()};y.push(R)}if(n.includes(Q.BOTTOM)){const R={sheetId:i,actionName:W.SET_BORDER_ACTION,styles:g.toJSON()};y.push(R)}if(n.includes(Q.LEFT)){const R={sheetId:i,actionName:W.SET_BORDER_ACTION,styles:v.toJSON()};y.push(R)}if(n.includes(Q.RIGHT)){const R={sheetId:i,actionName:W.SET_BORDER_ACTION,styles:p.toJSON()};y.push(R)}const A={sheetId:i,actionName:W.SET_BORDER_ACTION,styles:w.toJSON()};y.push(A);const I=new fe({WorkBookUnit:l},...y);return s.invoke(I),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex(n=>n&&n.getSheetId()===this._sheetId);return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),n=t.startRow,s=t.endRow-t.startRow+1,{_context:i,_commandManager:o,_sheetId:a}=this,l={actionName:W.SET_HIDE_ROW_ACTION,sheetId:a,rowCount:s,rowIndex:n},u=new fe({WorkBookUnit:i.getWorkBook()},l);return o.invoke(u),this}hideRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.SET_HIDE_ROW_ACTION,sheetId:o,rowCount:n,rowIndex:t},l=new fe({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}hideColumn(e){const t=e.getRangeData(),n=t.startColumn,s=t.endColumn-t.startColumn+1,{_context:i,_commandManager:o,_sheetId:a}=this,l={actionName:W.SET_HIDE_COLUMN_ACTION,sheetId:a,columnCount:s,columnIndex:n},u=new fe({WorkBookUnit:i.getWorkBook()},l);return o.invoke(u),this}hideColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.SET_HIDE_COLUMN_ACTION,sheetId:o,columnCount:n,columnIndex:t},l=new fe({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}unhideRow(e){const t=e.getRangeData(),n=t.startRow,s=t.endRow-t.startRow+1,{_context:i,_commandManager:o,_sheetId:a}=this,l={actionName:W.SET_SHOW_ROW_ACTION,sheetId:a,rowCount:s,rowIndex:n},u=new fe({WorkBookUnit:i.getWorkBook()},l);return o.invoke(u),this}unhideColumn(e){const t=e.getRangeData(),n=t.startColumn,s=t.endColumn-t.startColumn+1,{_context:i,_commandManager:o,_sheetId:a}=this,l={actionName:W.SET_SHOW_COLUMN_ACTION,sheetId:a,columnCount:s,columnIndex:n},u=new fe({WorkBookUnit:i.getWorkBook()},l);return o.invoke(u),this}showColumns(...e){const t=e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.SET_SHOW_COLUMN_ACTION,sheetId:o,columnCount:n,columnIndex:t},l=new fe({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}showRows(...e){const t=--e[0];let n=1;e[1]&&(n=e[1]);const{_context:s,_commandManager:i,_sheetId:o}=this,a={actionName:W.SET_SHOW_ROW_ACTION,sheetId:o,rowCount:n,rowIndex:t},l=new fe({WorkBookUnit:s.getWorkBook()},a);return i.invoke(l),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return t===0}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,n=[];if(G.hasLength(e,2)&&(t=e[0],n=[e[1]]),G.hasLength(e,3)){t=e[0];for(let s=0;s<e[1];s++)n.push(e[2])}return this.getColumnManager().setColumnWidth(t,n),this}setRowHeights(e,t,n){const s=[];for(let i=0;i<t;i++)s.push(n);return this.getRowManager().setRowHeight(e,s),this}setRowHeight(e,t){const n=[t];return this.getRowManager().setRowHeight(e,n),this}setHiddenGridlines(e){const{_context:t,_commandManager:n,_sheetId:s}=this,i={actionName:W.SET_HIDDEN_GRIDLINES_ACTION,hideGridlines:e,sheetId:s},o=new fe({WorkBookUnit:t.getWorkBook()},i);return n.invoke(o),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_commandManager:n,_sheetId:s}=this,i={actionName:W.SET_RIGHT_TO_LEFT_ACTION,rightToLeft:e,sheetId:s},o=new fe({WorkBookUnit:t.getWorkBook()},i);return n.invoke(o),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const n=G.deepClone(this._config);return n.sheetId=t.getConfig().id,t.setConfig(n),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,n,s){return new ut(this,{startRow:e,startColumn:t,endRow:e+n-1,endColumn:t+s-1}).getValues()}getDataRange(){return new ut(this,this._cellData.getRange())}moveRows(e,t){const{startRow:n}=e.getRangeData(),{endRow:s}=e.getRangeData(),i=this._cellData.spliceRows(n,s-n+1);return this._cellData.insertRows(t,i),this}moveColumns(e,t){const n=e.getRangeData().startColumn,s=e.getRangeData().endColumn,i=this._cellData.spliceColumns(n,s-n+1);return this._cellData.insertColumns(t,i),this}}class ut{static foreach(e,t){const{startRow:n,startColumn:s,endRow:i,endColumn:o}=e;for(let a=n;a<=i;a++)for(let l=s;l<=o;l++)t(a,l)}constructor(e,t){this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,i=[];for(let o=e;o<=t;o++){const a=[];for(let l=n;l<=s;l++)a.push(this.getMatrix().getValue(o,l)||null);i.push(a)}return i}getMatrix(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,i=this._worksheet.getCellMatrix(),o=new pe;for(let a=e;a<=t;a++)for(let l=n;l<=s;l++)o.setValue(a,l,i.getValue(a,l)||null);return o}getMatrixObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData,i=this._worksheet.getCellMatrix(),o=new pe;for(let a=e;a<=t;a++)for(let l=n;l<=s;l++)o.setValue(a-e,l-n,i.getValue(a,l)||{});return o}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map(e=>e.map(t=>t&&t.p?t.p:t&&t.m?t.m:""))}getA1Notation(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;let i,o;return n<s?(i=G.numToWord(n+1)+(e+1),o=G.numToWord(s+1)+(t+1)):(i=G.numToWord(s+1)+(t+1),o=G.numToWord(n+1)+(e+1)),i===o?`${i}`:`${i}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map(e=>e.map(t=>{var i,o,a;const n=this._context.getWorkBook().getStyles();let s=(i=bo.bg)==null?void 0:i.rgb;return s=(a=(o=n.getStyleByCell(t))==null?void 0:o.bg)==null?void 0:a.rgb,s}))}getCell(e,t){const{startRow:n,endRow:s,startColumn:i,endColumn:o}=this._rangeData,a={startRow:n+e,endRow:n+e,startColumn:i+t,endColumn:i+t};return new ut(this._worksheet,a)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:n,startColumn:s,endColumn:i}=this._rangeData,o=this._worksheet.getCellMatrix().getFragments(t,n,s,i).getData();if(e.isIncludeStyle){const a=this._context.getWorkBook().getStyles();for(let l=0;l<=n-t;l++)for(let u=0;u<=i-s;u++){if(!o[l][u])continue;const c=o[l][u].s;c&&(o[l][u].s=a.get(c))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map(e=>e.map(t=>{var i,o;const s=this._context.getWorkBook().getStyles().getStyleByCell(t);return((i=s==null?void 0:s.cl)==null?void 0:i.rgb)||((o=bo.cl)==null?void 0:o.rgb)}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}_getStyles(e){return this.getValues().map(t=>t.map(n=>{const s=this._context.getWorkBook().getStyles(),i=s&&s.getStyleByCell(n);return i&&i[e]||bo[e]}))}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:n,endRow:s}=e;let i=0;for(let o=0;o<=s-n;o++)i+=t.getRowHeight(o);return i}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:n,endColumn:s}).map(i=>new ut(this._worksheet,i))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:n,endRow:s,startColumn:i,endColumn:o}=this._rangeData,a=t.getMaxRows(),l=t.getMaxColumns();if(e===Q.BOTTOM){for(let u=0;u<a-i;u++)this._worksheet.getCellMatrix().getValue(n+u,i)&&t.getRange(n+u,i,n+u,i);return t.getRange(a,i,a,i)}if(e===Q.TOP){for(let u=0;u<n;u++)this._worksheet.getCellMatrix().getValue(n-u,i)&&t.getRange(n-u,i,n-u,n);return t.getRange(0,i,0,i)}if(e===Q.RIGHT){for(let u=0;u<l-i;u++)this._worksheet.getCellMatrix().getValue(n,i+u)&&t.getRange(n,i+u,n,i+u);return t.getRange(n,l,n,l)}if(e===Q.LEFT){for(let u=0;u<a-i;u++)this._worksheet.getCellMatrix().getValue(n,i-u)&&t.getRange(n,i-u,n,i-u);return t.getRange(n,0,n,0)}return t.getRange(U6)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(t=>(t==null?void 0:t.p)||""))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map(e=>e.map(t=>this._context.getWorkBook().getStyles().getStyleByCell(t)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:n,endColumn:s}=e;let i=0;for(let o=0;o<=s-n;o++)i+=t.getColumnWidth(o);return i}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some(t=>t.some(n=>(n==null?void 0:n.m)===""))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,n,s)}_setStyle(e,t){const{_context:n,_worksheet:s,_commandManager:i}=this,{startRow:o,endRow:a,startColumn:l,endColumn:u}=this._rangeData,c={[t]:e},h=G.fillObjectMatrix(a-o+1,u-l+1,c),f={sheetId:s.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new fe({WorkBookUnit:n.getWorkBook()},f);return i.invoke(d),this}_setStyles(e,t){const{_context:n,_worksheet:s,_commandManager:i}=this,{startRow:o,endRow:a,startColumn:l,endColumn:u}=this._rangeData,c=new pe;for(let d=0;d<a-o+1;d++)for(let m=0;m<u-l+1;m++)c.setValue(d,m,{[t]:e[d][m]});const h={sheetId:s.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c.getData(),rangeData:this._rangeData},f=new fe({WorkBookUnit:n.getWorkBook()},h);return i.invoke(f),this}setBackground(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={bg:{rgb:e}},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setBackgrounds(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u=new pe;for(let f=0;f<o-i+1;f++)for(let d=0;d<l-a+1;d++)u.setValue(f,d,{bg:{rgb:e[f][d]}});const c={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new fe({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setBackgroundRGB(e,t,n){const{_context:s,_worksheet:i,_commandManager:o}=this,{startRow:a,endRow:l,startColumn:u,endColumn:c}=this._rangeData,f={bg:{rgb:`RGB(${e},${t},${n})`}},d=G.fillObjectMatrix(l-a+1,c-u+1,f),m={sheetId:i.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:d,rangeData:this._rangeData},g=new fe({WorkBookUnit:s.getWorkBook()},m);return o.invoke(g),this}setFontColors(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u=new pe;for(let f=0;f<o-i+1;f++)for(let d=0;d<l-a+1;d++)u.setValue(f,d,{cl:{rgb:e[f][d]}});const c={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new fe({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setFormula(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,{startRow:o,startColumn:a,endRow:l,endColumn:u}=t,c=new pe;for(let d=o;d<=l;d++)for(let m=a;m<=u;m++)c.setValue(d,m,e);const h={sheetId:i.getSheetId(),actionName:W.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},f=new fe({WorkBookUnit:n.getWorkBook()},h);return s.invoke(f),this}setFormulas(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,{startRow:o,startColumn:a,endRow:l,endColumn:u}=t,c=new pe;for(let d=0;d<=l-o;d++)for(let m=0;m<=u-a;m++)c.setValue(d+o,m+a,e[d][m]);const h={sheetId:i.getSheetId(),actionName:W.SET_RANGE_FORMULA_ACTION,cellFormula:c.getData(),rangeData:this._rangeData},f=new fe({WorkBookUnit:n.getWorkBook()},h);return s.invoke(f),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={tr:{v:0,a:Number(e)}},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setTextRotations(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u=new pe;for(let f=0;f<o-i+1;f++)for(let d=0;d<l-a+1;d++)u.setValue(f,d,{tr:{v:0,a:e[f][d]}});u.getData();const c={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new fe({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setTextStyle(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={...e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setTextStyles(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u=new pe;for(let f=0;f<o-i+1;f++)for(let d=0;d<l-a+1;d++)u.setValue(f,d,{...e[f][d]});const c={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},h=new fe({WorkBookUnit:t.getWorkBook()},c);return s.invoke(h),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={tr:{v:e,a:90}},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:n,_context:s,_commandManager:i}=this,{startRow:o,endRow:a,startColumn:l,endColumn:u}=this._rangeData,{startRow:c,endRow:h,startColumn:f,endColumn:d}=e._rangeData;let m=Q.BOTTOM,g=0,p=0;const _=o,v=a,w=l,y=u,A=c,I=h,R=f,x=d,S=new pe;if(R===w&&x===y?I>v?m=Q.BOTTOM:m=Q.TOP:x>y?m=Q.RIGHT:m=Q.LEFT,m===Q.BOTTOM||m===Q.TOP){g=v-_+1,p=I-A+1;for(let O=0;O<=u-l;O++){const D=this.getColumnMatrix(O).toArray();ji.getCopyData(D,_,v,w,y,m).forEach(F=>{ji.getApplyData(F,g,p,t,m).forEach((L,re)=>{S.setValue(re,O,L)})})}}else if(m===Q.RIGHT||m===Q.LEFT){p=x-R,g=y-w;for(let O=0;O<=a-o;O++){const D=this.getRowMatrix(O).toArray();ji.getCopyData(D,_,v,w,y,m).forEach(F=>{ji.getApplyData(F,g,p,t,m)})}}const k={sheetId:n.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:S.getData()},N=new fe({WorkBookUnit:s.getWorkBook()},k);return i.invoke(N),this}getDataRegion(...e){const{startRow:t,endRow:n,startColumn:s,endColumn:i}=this._rangeData;let o,a;const l=this._worksheet.getCellMatrix();if(G.isNumber(e[0])){const u=e[0];if(u===jr.COLUMNS){let c=t,h=t;const f=this._worksheet.getRowCount();for(let m=1;m<t;m++)if(!l.getValue(t-m,s)){c=t-m+1;break}const d=0;for(;d<f-t;)if(!l.getValue(t+d,s)){h=t-d-1;break}return a=c-h,o=0,this._worksheet.getRange(t,c,o,a)}if(u===jr.ROWS){let c=t,h=t;const f=this._worksheet.getColumnCount();for(let m=1;m<t;m++)if(!l.getValue(t,s-m)){c=t-m+1;break}const d=0;for(;d<f-s;)if(!l.getValue(t,s+d)){h=t-d-1;break}return a=0,o=c-h,this._worksheet.getRange(c,s,o,a)}}else{let u=t,c=t;const h=this._worksheet.getRowCount();for(let _=1;_<t;_++)if(!l.getValue(t-_,s)){u=t-_+1;break}const f=0;for(;f<h-t;)if(!l.getValue(t+f,s)){c=t-f-1;break}let d=t,m=t;const g=this._worksheet.getColumnCount();for(let _=1;_<t;_++)if(!l.getValue(t,s-_)){d=t-_+1;break}const p=0;for(;p<g-s;)if(!l.getValue(t,s+p)){m=t-p-1;break}return a=d-m,a=u-c,o=t,this._worksheet.getRange(u,d,o,a)}return this}trimWhitespace(){var d;const{_context:e,_worksheet:t,_commandManager:n}=this,{startRow:s,endRow:i,startColumn:o,endColumn:a}=this._rangeData,l=this._worksheet.getCellMatrix(),u=/\s+/g,c=new pe;for(let m=0;m<=i-s;m++)for(let g=0;g<=a-o;g++){const p=(d=l.getValue(m,g).m)==null?void 0:d.replace(u,"");c.setValue(m+s,g+o,p||"")}const h={sheetId:t.getSheetId(),actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},f=new fe({WorkBookUnit:e.getWorkBook()},h);return n.invoke(f),this}activate(){var e;return((e=this._rangeData)==null?void 0:e.startRow)===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,n=this._rangeData.endRow,s=this._rangeData.startColumn,i=this._rangeData.endColumn,o=e.getRangeData().startRow,a=e.getRangeData().endRow,l=e.getRangeData().startColumn,u=e.getRangeData().endColumn,c=Math.abs(s+i-l-u),h=Math.abs(s-i)+Math.abs(l-u),f=Math.abs(t+n-o-a),d=Math.abs(t-n)+Math.abs(o-a);return c<=h&&f<=d}setFontColor(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={cl:{rgb:e}},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}copyTo(...e){const{_context:t,_worksheet:n,_commandManager:s}=this,i=e[0],[o,a]=this._handleCopyRange(this,i),{startRow:l,startColumn:u,endRow:c,endColumn:h}=a;if(it.checkup(e,ut,it.BOOLEAN_TYPE)){const f=e[1];if(e[2],f===ti.PASTE_NORMAL){const d=new pe;o.forEach((p,_)=>p.forEach((v,w)=>{v=v,d.setValue(_+l,w+u,v||{})}));const m={sheetId:n.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:d.getData()},g=new fe({WorkBookUnit:t.getWorkBook()},m);s.invoke(g)}else if(f===ti.PASTE_FORMAT){const d=t.getWorkBook().getStyles(),m=new pe;o.map((_,v)=>_.forEach((w,y)=>{w=w,m.setValue(v,y,d.getStyleByCell(w)||{})}));const g={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:m.getData(),rangeData:a},p=new fe({WorkBookUnit:t.getWorkBook()},g);s.invoke(p)}else if(f===ti.PASTE_VALUES){const d=new pe;o.forEach((p,_)=>p.forEach((v,w)=>{v=v,d.setValue(_+l,w+u,(v==null?void 0:v.v)||"")}));const m={sheetId:n.getSheetId(),actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:d.getData(),rangeData:a},g=new fe({WorkBookUnit:t.getWorkBook()},m);s.invoke(g)}else if(f===ti.PASTE_COLUMN_WIDTHS){const d=this._rangeData.startColumn;for(let m=0;m<h-d;m++){const g=n.getColumnWidth(d+m);n.setColumnWidth(d+m,g)}}}else if(it.checkup(e,ut,it.OBJECT_TYPE)){const f=e[1],d=new pe;o.forEach((p,_)=>p.forEach((v,w)=>{v=v,d.setValue(_+l,w+u,v||{})}));const m={sheetId:n.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:d.getData(),options:f},g=new fe({WorkBookUnit:t.getWorkBook()},m);s.invoke(g)}else if(it.checkup(e,ut)){const f=new pe;o.forEach((g,p)=>g.forEach((_,v)=>{_=_,f.setValue(p+l,v+u,_||{})}));const d={sheetId:n.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:f.getData()},m=new fe({WorkBookUnit:t.getWorkBook()},d);s.invoke(m)}}copyFormatToRange(...e){const{_context:t,_commandManager:n}=this,s=e[1],i=e[2],o=e[3],a=e[4],l=G.isAssignableFrom(e[0],fn)?e[0].getSheetId():e[0],[u,c]=this._handleCopyRange(this,{startRow:s,endRow:i,startColumn:o,endColumn:a}),h=t.getWorkBook().getStyles(),f=new pe;u.map((g,p)=>g.map((_,v)=>(_=_,f.setValue(p,v,h.getStyleByCell(_)||{}),h.getStyleByCell(_)||{})));const d={sheetId:l,actionName:W.SET_RANGE_STYLE_ACTION,value:f.getData(),rangeData:c},m=new fe({WorkBookUnit:t.getWorkBook()},d);n.invoke(m)}copyValuesToRange(...e){const{_context:t,_commandManager:n}=this,s=e[1],i=e[2],o=e[3],a=e[4],l=G.isAssignableFrom(e[0],fn)?e[0].getSheetId():e[0],[u,c]=this._handleCopyRange(this,{startRow:s,endRow:i,startColumn:o,endColumn:a}),h=new pe;u.forEach((m,g)=>m.forEach((p,_)=>{p=p,h.setValue(g+c.startRow,_+c.startColumn,(p==null?void 0:p.v)||"")}));const f={sheetId:l,actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:c},d=new fe({WorkBookUnit:t.getWorkBook()},f);n.invoke(d)}moveTo(e){const{_context:t,_worksheet:n,_commandManager:s,_rangeData:i}=this,o={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},a={sheetId:n.getSheetId(),actionName:W.CLEAR_RANGE_ACTION,options:o,rangeData:i},l=this.getMatrix(),{startRow:u,endRow:c,startColumn:h,endColumn:f}=this._rangeData,{startRow:d,startColumn:m}=e.getRangeData(),g=new pe;for(let v=u;v<=c;v++)for(let w=h;w<=f;w++)g.setValue(d+(v-u),m+(w-h),l.getValue(v,w)||{});const p={sheetId:n.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:g.getData()},_=new fe({WorkBookUnit:t.getWorkBook()},a,p);s.invoke(_)}offset(...e){const{startRow:t,endRow:n,startColumn:s,endColumn:i}=this._rangeData,o=e[0],a=e[1],l=e[2],u=e[3],c={startRow:t+o,endRow:n+o,startColumn:s+a,endColumn:i+a};return G.isNumber(l)&&(c.endRow=c.startRow+l-1),G.isNumber(u)&&(c.endColumn=c.endColumn+u-1),new ut(this._worksheet,c)}setBorder(...e){const t=e[0],n=e[1],s=e[2],i=e[3],o=e[4],a=e[5],l=e[6]?e[6]:"black",u=e[7]?e[7]:C.DASH_DOT,{_context:c,_worksheet:h,_commandManager:f}=this,d=c.getWorkBook(),m=this._rangeData,g=h.getSheetId(),p={startRow:m.startRow-1,startColumn:m.startColumn,endRow:m.startRow-1,endColumn:m.endColumn},_={startRow:m.startRow,startColumn:m.startColumn-1,endRow:m.endRow,endColumn:m.startColumn-1},v={startRow:m.endRow+1,startColumn:m.startColumn,endRow:m.endRow+1,endColumn:m.endColumn},w={startRow:m.startRow,startColumn:m.endColumn+1,endRow:m.endRow,endColumn:m.endColumn+1},y={startRow:m.startRow,startColumn:m.startColumn,endRow:m.startRow,endColumn:m.endColumn},A={startRow:m.startRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.startColumn},I={startRow:m.endRow,startColumn:m.startColumn,endRow:m.endRow,endColumn:m.endColumn},R={startRow:m.startRow,startColumn:m.endColumn,endRow:m.endRow,endColumn:m.endColumn},x=new ut(h,p),S=new ut(h,_),k=new ut(h,v),N=new ut(h,w),O=new ut(h,y),D=new ut(h,A),E=new ut(h,I),F=new ut(h,R),j=new pe,L=new pe,re=new pe,Y=new pe,ee=new pe,U=[],V={s:u,cl:{rgb:l}};if(t===!0||t===!1){if(x.isValid()){x.forEach((le,ve)=>{j.setValue(le,ve,{bd:{b:null}})});const Z={sheetId:g,actionName:W.SET_RANGE_STYLE_ACTION,value:j.getArrayData(),rangeData:p};U.push(Z)}O.forEach((Z,le)=>{if(t===!0){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{t:G.deepClone(V)}});ee.setValue(Z,le,ve)}else if(t===!1){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{t:null}});ee.setValue(Z,le,ve)}})}if(s===!0||s===!1){if(k.isValid()){k.forEach((le,ve)=>{re.setValue(le,ve,{bd:{t:null}})});const Z={sheetId:g,actionName:W.SET_RANGE_STYLE_ACTION,value:re.getArrayData(),rangeData:v};U.push(Z)}E.forEach((Z,le)=>{if(s===!0){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{b:G.deepClone(V)}});ee.setValue(Z,le,ve)}else if(s===!1){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{b:null}});ee.setValue(Z,le,ve)}})}if(n===!0||n===!1){if(S.isValid()){S.forEach((le,ve)=>{L.setValue(le,ve,{bd:{r:null}})});const Z={sheetId:g,actionName:W.SET_RANGE_STYLE_ACTION,value:L.getArrayData(),rangeData:_};U.push(Z)}D.forEach((Z,le)=>{if(n===!0){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{l:G.deepClone(V)}});ee.setValue(Z,le,ve)}else if(n===!1){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{l:null}});ee.setValue(Z,le,ve)}})}if(i===!0||i===!1){if(N.isValid()){N.forEach((le,ve)=>{Y.setValue(le,ve,{bd:{l:null}})});const Z={sheetId:g,actionName:W.SET_RANGE_STYLE_ACTION,value:Y.getArrayData(),rangeData:w};U.push(Z)}F.forEach((Z,le)=>{if(i===!0){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{r:G.deepClone(V)}});ee.setValue(Z,le,ve)}else if(i===!1){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{r:null}});ee.setValue(Z,le,ve)}})}(o===!0||o===!1)&&this.forEach((Z,le)=>{if(le!==m.endColumn){if(o===!0){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{r:G.deepClone(V)}});ee.setValue(Z,le,ve)}else if(o===!1){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{r:null}});ee.setValue(Z,le,ve)}}if(le!==m.startColumn){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{l:null}});ee.setValue(Z,le,ve)}}),(a===!0||a===!1)&&this.forEach((Z,le)=>{if(Z!==m.endRow){if(a===!0){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{b:G.deepClone(V)}});ee.setValue(Z,le,ve)}else if(a===!1){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{b:null}});ee.setValue(Z,le,ve)}}if(Z!==m.startRow){const ve=G.deepMerge(ee.getValue(Z,le)||{},{bd:{t:null}});ee.setValue(Z,le,ve)}});const _e={sheetId:g,actionName:W.SET_RANGE_STYLE_ACTION,value:ee.getArrayData(),rangeData:ee.getDataRange()};U.push(_e);const ie=new fe({WorkBookUnit:d},...U);return f.invoke(ie),this}setBorderByType(e,t,n){let s=null,i=null,o=null,a=null,l=null,u=null;switch(e){case En.TOP:s=!0;break;case En.BOTTOM:o=!0;break;case En.LEFT:i=!0;break;case En.RIGHT:a=!0;break;case En.NONE:s=!1,i=!1,o=!1,a=!1,l=!1,u=!1;break;case En.ALL:s=!0,i=!0,o=!0,a=!0,l=!0,u=!0;break;case En.OUTSIDE:s=!0,i=!0,o=!0,a=!0;break;case En.INSIDE:l=!0,u=!0;break;case En.HORIZONTAL:u=!0;break;case En.VERTICAL:l=!0;break}this.setBorder(s,i,o,a,l,u,t,n)}setFontFamily(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={ff:e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setFontSize(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={fs:e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setHorizontalAlignment(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={ht:e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setVerticalAlignment(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={vt:e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setTextDirection(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={td:e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setWrapStrategy(e){const{_context:t,_worksheet:n,_commandManager:s}=this,{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u={tb:e},c=G.fillObjectMatrix(o-i+1,l-a+1,u),h={sheetId:n.getSheetId(),actionName:W.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},f=new fe({WorkBookUnit:t.getWorkBook()},h);return s.invoke(f),this}setValue(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,{startRow:o,startColumn:a,endRow:l,endColumn:u}=t,c=new pe;for(let d=o;d<=l;d++)for(let m=a;m<=u;m++)c.setValue(d,m,e);const h={sheetId:i.getSheetId(),actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},f=new fe({WorkBookUnit:n.getWorkBook()},h);return s.invoke(f),this}setValues(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,o=e[0];if(it.checkup(e,Array)){const{startRow:a,startColumn:l,endRow:u,endColumn:c}=t,h=new pe;for(let m=0;m<=u-a;m++)for(let g=0;g<=c-l;g++)h.setValue(m+a,g+l,o[m][g]);const f={sheetId:i.getSheetId(),actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new fe({WorkBookUnit:n.getWorkBook()},f);s.invoke(d)}else if(it.checkup(e,pe)){const a={sheetId:i.getSheetId(),actionName:W.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:o,rangeData:this._rangeData},l=new fe({WorkBookUnit:n.getWorkBook()},a);s.invoke(l)}return this}setRangeData(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,{startRow:o,startColumn:a}=t,l={sheetId:i.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:{[o]:{[a]:e}}},u=new fe({WorkBookUnit:n.getWorkBook()},l);return s.invoke(u),this}setRangeDatas(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,o=e[0];if(it.checkup(e,Array)){const{startRow:a,startColumn:l,endRow:u,endColumn:c}=t,h=new pe;for(let m=0;m<=u-a;m++)for(let g=0;g<=c-l;g++)h.setValue(m+a,g+l,o[m][g]);const f={sheetId:i.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:h.getData()},d=new fe({WorkBookUnit:n.getWorkBook()},f);s.invoke(d)}else if(it.checkup(e,pe)){const a={sheetId:i.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:o},l=new fe({WorkBookUnit:n.getWorkBook()},a);s.invoke(l)}return this}clear(...e){const{_context:t,_worksheet:n,_commandManager:s,_rangeData:i}=this;let o={formatOnly:!0,contentsOnly:!0};it.checkup(e,it.OBJECT_TYPE)&&(o=e[0]);const a={sheetId:n.getSheetId(),actionName:W.CLEAR_RANGE_ACTION,options:o,rangeData:i},l=new fe({WorkBookUnit:t.getWorkBook()},a);return s.invoke(l),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this,o={sheetId:i.getSheetId(),actionName:W.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},a=new fe({WorkBookUnit:n.getWorkBook()},o);s.invoke(a)}insertCells(...e){const t=e[0],n=e[1],{_rangeData:s,_context:i,_commandManager:o,_worksheet:a}=this,{startRow:l,endRow:u,startColumn:c,endColumn:h}=this._rangeData;let f=this._rangeData,d=new pe;if(n){d=n.getMatrixObject();const p=n.getRangeData();f={startRow:l,endRow:l+p.endRow-p.startRow,startColumn:c,endColumn:l+p.endColumn-p.startColumn}}else for(let p=l;p<=u;p++)for(let _=c;_<=h;_++)d.setValue(p,_,{m:"",v:""});const m={sheetId:a.getSheetId(),actionName:W.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:f,cellValue:d.getData()},g=new fe({WorkBookUnit:i.getWorkBook()},m);return o.invoke(g),this}merge(){const{_worksheet:e}=this,t=e.getContext(),n=e.getSheetId(),s=e.getCommandManager(),i={actionName:W.ADD_MERGE_ACTION,sheetId:n,rectangles:[this._rangeData]},o=new fe({WorkBookUnit:t.getWorkBook()},i);return s.invoke(o),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u=[];for(let f=i;f<=o;f++){const d={startRow:f,endRow:f,startColumn:a,endColumn:l};u.push(d)}const c={actionName:W.ADD_MERGE_ACTION,sheetId:s,rectangles:u},h=new fe({WorkBookUnit:n.getWorkBook()},c);return t.invoke(h),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),{startRow:i,endRow:o,startColumn:a,endColumn:l}=this._rangeData,u=[];for(let f=a;f<=l;f++){const d={startRow:i,endRow:o,startColumn:f,endColumn:f};u.push(d)}const c={actionName:W.ADD_MERGE_ACTION,sheetId:s,rectangles:u},h=new fe({WorkBookUnit:n.getWorkBook()},c);return t.invoke(h),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),n=e.getContext(),s=e.getSheetId(),i=this._worksheet.getMerges().getMergedRanges(this._rangeData),o={actionName:W.REMOVE_MERGE_ACTION,sheetId:s,rectangles:i},a=new fe({WorkBookUnit:n.getWorkBook()},o);return t.invoke(a),this}removeDuplicates(...e){const{_rangeData:t,_context:n,_commandManager:s,_worksheet:i}=this;Array.isArray(e[0])&&e[0];const o=this.getMatrix().getData(),a=[];for(let f=0;f<=t.endColumn-t.startColumn;f++){const d=[],m={},g=this.getColumnMatrix(f).getData();for(const p in g){const _=g[p][f].m;m.hasOwnProperty(_)||(m[_]=1,d.push(f))}a.push(d)}const l=Array.from(new Set(a.flat())),u={};l.forEach((f,d)=>{u[d]=o[f]});const c=[{sheetId:i.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:u}],h=new fe({WorkBookUnit:n.getWorkBook()},...c);return s.invoke(h),this}getRowMatrix(e){const{startColumn:t,endColumn:n}=this._rangeData,s=this._worksheet.getCellMatrix(),i=new pe;for(let o=e;o<=e;o++)for(let a=t;a<=n;a++)i.setValue(o,a,s.getValue(o,a)||{});return i}getColumnMatrix(e){const{startRow:t,endRow:n}=this._rangeData,s=this._worksheet.getCellMatrix(),i=new pe;for(let o=t;o<=n;o++)for(let a=e;a<=e;a++)i.setValue(o,a,s.getValue(o,a)||{});return i}_handleCopyRange(...e){const t=e[0];let n=e[1];n=it.checkup(e,ut,ut)?n.getRangeData():n;const s=t._worksheet.getCellMatrix(),{startRow:i,endRow:o,startColumn:a,endColumn:l}=t.getRangeData();let{startRow:u,endRow:c,startColumn:h,endColumn:f}=n;const d=o-i+1,m=l-a+1,g=c-u+1,p=f-h+1;let _=[],v;if(g%d===0&&p%m===0){for(let w=0;w<g;w++){const y=[];for(let A=0;A<p;A++){const I=s.getValue((w+i)%d,(A+a)%m)||{};y.push(I)}_.push(y)}v=n}else _=s.getFragments(i,o,a,l).getData(),c+=d-g,f+=m-p,v={startRow:u,endRow:c,startColumn:h,endColumn:f};return[_,v]}forEach(e){ut.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:n,_rangeData:s}=this,{startRow:i,startColumn:o}=s,a=new pe;G.randSort(this.getMatrix().toArray()).forEach((h,f)=>h.forEach((d,m)=>{d=d,a.setValue(f+i,m+o,d||{})}));const u={sheetId:t.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:a.getData()},c=new fe({WorkBookUnit:e.getWorkBook()},u);n.invoke(c)}isValid(){return!Object.values(this._rangeData).includes(-1)}}class L0{constructor(e={}){this._styles=e}each(e){return Object.entries(this._styles).forEach(e),this}search(e){const{_styles:t}=this;for(const n in t)if(G.diffValue(t[n],e))return n;return"-1"}get(e){return e=String(e),typeof e!="string"?e:this._styles[e]}add(e){const t=Rt(6);return this._styles[t]=e,t}setValue(e){if(e==null)return;const t=this.search(e);return t!=="-1"?t:this.add(e)}toJSON(){return this._styles}getStyleByCell(e){let t;return e&&G.isObject(e.s)?t=e.s:t=(e==null?void 0:e.s)&&this.get(e.s),t}}class P0{constructor(e){this._workbook=e,this._commandManager=this._workbook.getCommandManager(),this._context=this._workbook.getContext()}addNamedRange(e){const{_workbook:t,_context:n,_commandManager:s}=this,i={actionName:W.ADD_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},o=new fe({WorkBookUnit:t},i);s.invoke(o)}setNamedRange(e){const{_workbook:t,_commandManager:n}=this,s={actionName:W.SET_NAMED_RANGE_ACTION,namedRange:e,sheetId:e.range.sheetId},i=new fe({WorkBookUnit:t},s);n.invoke(i)}remove(e){const{_context:t,_workbook:n,_commandManager:s}=this,i={actionName:W.DELETE_NAMED_RANGE_ACTION,namedRangeId:e,sheetId:n.getActiveSheet().getSheetId()},o=new fe({WorkBookUnit:n},i);s.invoke(o)}}class vc{constructor(e={},t){var s;this._config=G.commonExtend(z6,e),this._context=t;const{styles:n}=this._config;this._unitId=(s=this._config.id)!=null?s:Rt(6),this._styles=new L0(n),this._worksheets=new Map,this._commandManager=t.getCommandManager(),this._getDefaultWorkSheet(),this._namedRange=new P0(this)}_getDefaultWorkSheet(){const{_context:e,_config:t,_worksheets:n}=this,{sheets:s,sheetOrder:i}=t;G.isEmptyObject(s)&&(s[Vr.id]=Object.assign(Vr,{status:te.TRUE}));let o=null;for(let a in s){let l=s[a];l.name=Sr.getSheetName(l.name);const u=new fn(e,l);n.set(a,u),i.includes(a)||i.push(a),o==null&&(o=u)}o&&o.activate()}_setDefaultActiveSheet(){this._worksheets.size>0&&(this._worksheets.forEach(e=>{e.setStatus(te.FALSE)}),this._worksheets[0].setStatus(te.TRUE))}_getCellRange(e){var u,c,h,f,d;let t="",n="";if(e.indexOf("!")>-1){const m=e.split("!");t=m[0],n=m[1],t=t.replace(/\\'/g,"'").replace(/''/g,"'"),t.substring(0,1)==="'"&&t.substring(t.length-1,1)==="'"&&(t=t.substring(1,t.length-1))}else n=e;if(n.indexOf(":")===-1){const m=parseInt(n.replace(/[^0-9]/g,""),10)-1,g=G.ABCatNum(n.replace(/[^A-Za-z]/g,""));return!Number.isNaN(m)&&!Number.isNaN(g)?{sheetId:t,rangeData:{startRow:m,endRow:m,startColumn:g,endColumn:g}}:$i}n=n.split(":");const s=[0,0],i=[0,0],o=((u=this.getSheetBySheetName(t))==null?void 0:u.getMaxRows())||((c=this.getActiveSheet())==null?void 0:c.getMaxRows()),a=((h=this.getSheetBySheetName(t))==null?void 0:h.getMaxColumns())||((f=this.getActiveSheet())==null?void 0:f.getMaxColumns());return s[0]=parseInt(n[0].replace(/[^0-9]/g,""),10)-1,s[1]=parseInt(n[1].replace(/[^0-9]/g,""),10)-1,Number.isNaN(s[0])&&(s[0]=0),Number.isNaN(s[1])&&(s[1]=o),s[0]>s[1]||(i[0]=G.ABCatNum(n[0].replace(/[^A-Za-z]/g,"")),i[1]=G.ABCatNum(n[1].replace(/[^A-Za-z]/g,"")),Number.isNaN(i[0])&&(i[0]=0),Number.isNaN(i[1])&&(i[1]=a),i[0]>i[1])?$i:{sheetId:((d=this.getSheetBySheetName(t))==null?void 0:d.getSheetId())||"",rangeData:{startRow:s[0],endRow:s[1],startColumn:i[0],endColumn:i[1]}}}getUnitId(){return this._unitId}getWorksheets(){return this._worksheets}getNamedRang(){return this._namedRange}nextSheet(e){if(e>=0){const{sheetOrder:t}=this._config;for(let n=e;n<t.length;n++){const s=this._worksheets.get(t[n]);if(s&&!s.isSheetHidden())return s}if(e<t.length)for(let n=e-1;n>=0;n--){const s=this._worksheets.get(t[n]);if(s&&!s.isSheetHidden())return s}return this._worksheets.get(t[t.length-1])}}setContext(e){this._context=e}setCommandManager(e){this._commandManager=e}insertSheet(...e){const{_context:t,_commandManager:n}=this,s=t.getContextObserver("onBeforeInsertSheetObservable"),i=t.getContextObserver("onAfterInsertSheetObservable");if(G.hasLength(e,0)){const o={name:Sr.getSheetName(),status:0,id:Rt(6)},a=this.getSheetSize();return s.notifyObservers({index:a,sheetId:o.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:o.id,index:a,sheet:o})),i.notifyObservers({index:a,sheetId:o.id}),o.id}if(G.hasLength(e,1)){if(G.isAssignableFrom(e[0],fn)){const o=e[0],a=this.getSheetSize(),l=o.getConfig();return l.id=Rt(6),s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),i.notifyObservers({index:a,sheetId:l.id}),l.id}if(G.isNumber(e[0])){const o=e[0],a={name:Sr.getSheetName(),status:0,id:Rt(6)};return s.notifyObservers({index:o,sheetId:a.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:a.id,index:o,sheet:a})),i.notifyObservers({index:o,sheetId:a.id}),a.id}if(G.isString(e[0])){const o=e[0],a=this.getSheetSize(),l={status:0,name:o,id:Rt(6)};return s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),i.notifyObservers({index:a,sheetId:l.id}),l.id}if(G.isPlainObject(e[0])){const o=e[0],a=this.getSheetSize();return s.notifyObservers({index:a,sheetId:o.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:o.id,index:a,sheet:o})),i.notifyObservers({index:a,sheetId:o.id}),o.id}}if(G.hasLength(e,2)){if(G.isString(e[0])){const o=e[0],a=e[1],l={status:0,name:o,id:Rt(6)};return s.notifyObservers({index:a,sheetId:l.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:l.id,index:a,sheet:l})),i.notifyObservers({index:a,sheetId:l.id}),l.id}if(G.isNumber(e[0])){if(G.isAssignableFrom(e[1],fn)){const o=e[0],l=e[1].getConfig();return l.id=Rt(6),s.notifyObservers({index:o,sheetId:l.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:l.id,index:o,sheet:l})),i.notifyObservers({index:o,sheetId:l.id}),l.id}if(G.isPlainObject(e[1])){const o=e[0],a=e[1];return s.notifyObservers({index:o,sheetId:a.id}),n.invoke(new fe({WorkBookUnit:t.getWorkBook()},{actionName:W.INSERT_SHEET_ACTION,sheetId:a.id,index:o,sheet:a})),i.notifyObservers({index:o,sheetId:a.id}),a.id}}}}getActiveSpreadsheet(){return this}getStyles(){return this._styles}getContext(){return this._context}getConfig(){return this._config}create(...e){if(G.hasLength(e,1)){const{_context:t}=this,n=e[0],s={...Vr,name:n},i=new fn(t,s);return this.insertSheet(i),i}if(G.hasLength(e,3)){const{_context:t}=this,n=e[0],s=e[1],i=e[2],o={...Vr,name:n,rowCount:s,columnCount:i},a=new fn(t,o);return this.insertSheet(a),a}}setDefaultActiveSheet(){this._setDefaultActiveSheet()}getIndexBySheetId(e){const{sheetOrder:t}=this._config;return t.findIndex(n=>n===e)}getActiveSheet(){const{sheetOrder:e}=this._config,t=e.find(n=>this._worksheets.get(n).getStatus()===te.TRUE);return t?this._worksheets.get(t):(console.warn("No active sheet, get first sheet"),this._worksheets[0])}getActiveSheetIndex(){const{sheetOrder:e}=this._config;return e.findIndex(t=>this._worksheets.get(t).getStatus()===1)}getActiveRange(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRange():null}setActiveRange(e){const t=this.getActiveSheet();return t?t.setActiveSelection(e):null}setActiveRangeList(e){const t=this.getActiveSheet();if(t){const n=t.getRangeList(e);return n.activate(),n.getRangeList()}return null}getActiveRangeList(){const e=this.getActiveSheet();return e?e.getSelection().getActiveRangeList():null}getSelection(){const e=this.getActiveSheet();if(e)return e.getSelection()}getCurrentCell(){const e=this.getSelection();if(e)return e.getCurrentCell()}getSheetSize(){return this._config.sheetOrder.length}setCurrentCell(e){return e.activateAsCurrentCell()}flush(){}setSheetOrder(e,t){const{_context:n,_commandManager:s}=this,i=n.getContextObserver("onSheetOrderObservable"),o={actionName:W.SET_SHEET_ORDER_ACTION,sheetId:e,order:t},a=new fe({WorkBookUnit:n.getWorkBook()},o);s.invoke(a),i.notifyObservers()}getSheets(){const{sheetOrder:e}=this._config;return e.map(t=>this._worksheets.get(t))}getSheetIndex(e){const{sheetOrder:t}=this._config;return t.findIndex(n=>e.getSheetId()===n)}removeSheetBySheetId(e){const{_commandManager:t,_config:n}=this,{sheetOrder:s}=n,i=this.getSheetBySheetId(e);if(s.length>1&&i!=null){const o=this.getSheetIndex(i),a=this.getContext().getContextObserver("onBeforeRemoveSheetObservable"),l=this.getContext().getContextObserver("onAfterRemoveSheetObservable");if(a.notifyObservers({index:o}),t.invoke(new fe({WorkBookUnit:this},{actionName:W.REMOVE_SHEET_ACTION,sheetId:e})),i.getStatus()===te.TRUE){const c=this.nextSheet(o);c&&c.activate()}l.notifyObservers({index:o,sheetId:e})}}getSheetBySheetName(e){const{sheetOrder:t}=this._config,n=t.find(s=>this._worksheets.get(s).getName()===e);return this._worksheets.get(n)}getSheetBySheetId(e){return this._worksheets.get(e)}setActiveSheet(...e){let t=!1;const n=e[0];return it.checkup(e,fn,it.BOOLEAN_TYPE)&&(t=e[1]),n.activate(),t&&n.setActiveSelection(),n}getCommandManager(){return this._commandManager}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){return this._config.pluginMeta||(this._config.pluginMeta={}),this._config.pluginMeta[e]=t}static isIRangeType(e){return typeof e=="string"||"startRow"in e||"row"in e}transformRangeType(e){return typeof e=="string"?this._getCellRange(e):typeof e!="string"&&"row"in e?{sheetId:"",rangeData:{startRow:e.row[0],startColumn:e.column[0],endRow:e.row[1],endColumn:e.column[1]}}:typeof e!="string"&&"startRow"in e?{sheetId:"",rangeData:e}:$i}static rangeDataToRangeStringData(e){const{startRow:t,endRow:n,startColumn:s,endColumn:i}=e;return`${G.chatAtABC(s)+(t+1)}:${G.chatAtABC(i)}${n+1}`}load(e){this._config=e}save(){return this._config}}function Ei(r){if(!r)return;let{row:e,column:t,startY:n,endY:s,startX:i,endX:o,isMerged:a,mergeInfo:l}=r,u=e,c=t,h=e,f=t;if(a&&l){const{startRow:d,startColumn:m,endRow:g,endColumn:p,startY:_,endY:v,startX:w,endX:y}=l;u=d,c=m,h=g,f=p,n=_,s=v,i=w,o=y}return{startRow:u,startColumn:c,endRow:h,endColumn:f,startY:n,endY:s,startX:i,endX:o}}function Cc(r){return!r||((r==null?void 0:r.m)||"").length===0&&!r.p}function zt(r){if(r){if(r.rgb)return r.rgb;if(r.th)return new jo().setThemeColor(r.th).asThemeColor().asRgbColor().getCssString()}return null}function H0(r){return G.isString(r)&&r.indexOf("=")===0&&r.length>1}function U0(r,...e){for(const t of e)if(t)for(const n in t)t.hasOwnProperty(n)&&z0(t[n])&&(r[n]=t[n]);return r}function z0(r){return r!=null}function W0(r){return Object.prototype.toString.apply(r)==="[object String]"}function V0(r){return r?Object.getPrototypeOf(r)===Object.getPrototypeOf({}):!1}function G0(r){return Object.prototype.toString.apply(r)==="[object Array]"}function Ec(r){return r instanceof FormData}const Aa=()=>{},wc=r=>r,X0={type:"POST",url:"",async:!0,header:{},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:Aa,beforeSend:wc,dataFilter:wc,success:Aa,complete:Aa};function Tc(r){return new Promise((e,t)=>{const n=U0({},X0,r),s=new XMLHttpRequest;switch(n.beforeSend(n),s.responseType=n.dataType,s.timeout=n.timeout,s.addEventListener("readystatechange",i=>{if(s.readyState===4)if(s.status===200){const o=n.dataFilter(s.response);n.success(o),n.complete(),e(o)}else n.error(i),t(i)}),s.addEventListener("timeout",i=>{n.error(i)}),s.open(n.type,n.url,n.async,n.username,n.password),Object.keys(n.header).forEach(i=>{const o=n.header[i];s.setRequestHeader(i,o)}),Ec(n.data)?s.setRequestHeader("Content-Type","multipart/form-data"):n.contentType&&s.setRequestHeader("Content-Type",n.contentType),n.type){case"DELETE":case"GET":{s.send();break}case"POST":case"PUT":{if(V0(n.data)){s.send(JSON.stringify(n.data));return}if(W0(n.data)){s.send(n.data);return}if(G0(n.data)){s.send(JSON.stringify(n.data));return}Ec(n.data)&&s.send(n.data);break}}})}function $0(r){return r==null}function Y0(r){return $0(r)||r.toString()===""}var Ur=(r=>(r.MESSAGE="message",r.OPEN="open",r.CLOSE="close",r.ERROR="error",r.RETRY="retry",r.DESTROY="destroy",r))(Ur||{});const j0={url:"",heartbeatTime:1e3*30},K0="heart_beat_message";class Z0{constructor(e){const t=Object.assign(j0,e);if(Y0(t.url))throw new Error("url must be input");this._listens=new Map,this._timer=-1,this._config=t}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener("message",this._message.bind(this)),this._socket.addEventListener("open",this._open.bind(this)),this._socket.addEventListener("close",this._close.bind(this)),this._socket.addEventListener("error",this._error.bind(this))}_message(e){const t=this._listens.get("message");t&&t(e)}_open(e){const t=this._listens.get("open");t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get("error");t&&(t(e),this._retry())}_close(e){const t=this._listens.get("close");t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener("message",this._message.bind(this)),this._socket.removeEventListener("open",this._open.bind(this)),this._socket.removeEventListener("close",this._close.bind(this)),this._socket.removeEventListener("error",this._error.bind(this))}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:n}=t;function s(){e.send(K0)}this._timer=setInterval(s,n)}_retry(){const e=this._listens.get("retry");e&&e(),this._clear(),this._create(),this._bind()}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get("destroy");e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens.set(e,t)}}const q0=Object.keys(Ju).reduce((r,e)=>[...r,...Ju[e]],[]);function J0(r){return q0.indexOf(r)===-1}const Q0={},e3={};class Fo{initialize(e){this.options={currentLocale:e||["zh","zh-CN"].includes(G.getLanguage())?pn.ZH:pn.EN,locales:{zh:Q0,en:e3}}}get(e){if(e){const{locales:t,currentLocale:n}=this.options;return Fo.getValue(t[n],e)||""}return String()}getObject(e){const{locales:t,currentLocale:n}=this.options;return Fo.getValue(t[n],e)}load(e){G.deepMerge(this.options.locales,e)}change(e){this.options.currentLocale=e}static getValue(e,t){try{return e[t]?e[t]:t.split(".").reduce((n,s)=>n[s],e)}catch{console.error("Key %s not found",t)}}}class Nl{static log(...e){console&&console.log(...e)}static info(...e){console&&console.info(...e)}static error(...e){console&&console.error(...e)}static warn(...e){console&&console.warn(...e)}static br(){Nl.info(`
`)}static capsule(e,t,n="",s=""){console&&console.log(`%c${n}%c${e}%c${t}%c${s}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class Ki{static hasLength(e,t){return e.length===t}static getValueType(e){return Object.prototype.toString.apply(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isIterable(e){return e[Symbol.iterator]!=null}static isNumber(e){return this.getValueType(e)==="[object Number]"}}const at=Symbol("newer"),Ot=Symbol("older");class t3{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[at],{done:!1,value:e.key}):{done:!0,value:void 0}}}class n3{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[at],{done:!1,value:e.value}):{done:!0,value:void 0}}}class r3{constructor(e){this.entry=e}[Symbol.iterator](){return this}next(){let e=this.entry;return e?(this.entry=e[at],{done:!1,value:[e.key,e.value]}):{done:!0,value:void 0}}}class yc{constructor(e,t){this.key=e,this.value=t,this[at]=void 0,this[Ot]=void 0}toJSON(){return{key:this.key,value:this.value}}}class s3{_initialize(e,t){this.oldest=void 0,this.newest=void 0,this.size=0,this.limit=e,this._keymap=new Map,t&&(this.assign(t),e<1&&(this.limit=this.size))}_markEntryAsUsed(e){e!==this.newest&&(e[at]&&(e===this.oldest&&(this.oldest=e[at]),e[at][Ot]=e[Ot]),e[Ot]&&(e[Ot][at]=e[at]),e[at]=void 0,e[Ot]=this.newest,this.newest&&(this.newest[at]=e),this.newest=e)}constructor(...e){if(Ki.hasLength(e,1)){if(Ki.isNumber(e[0])){const t=e[0];this._initialize(t,void 0);return}if(Ki.isIterable(e[0])){const t=e[0];this._initialize(0,t);return}return}if(Ki.hasLength(e,2)){const t=e[0],n=e[1];this._initialize(t,n)}}assign(e){let t,n=this.limit||Number.MAX_VALUE;this._keymap.clear();let s=e[Symbol.iterator]();for(let i=s.next();!i.done;i=s.next()){let o=new yc(i.value[0],i.value[1]);if(this._keymap.set(o.key,o),t?(t[at]=o,o[Ot]=t):this.oldest=o,t=o,n--===0)throw new Error("overflow")}this.newest=t,this.size=this._keymap.size}set(e,t){let n=this._keymap.get(e);return n?(n.value=t,this._markEntryAsUsed(n),this):(this._keymap.set(e,n=new yc(e,t)),this.newest?(this.newest[at]=n,n[Ot]=this.newest):this.oldest=n,this.newest=n,++this.size,this.size>this.limit&&this.shift(),this)}shift(){let e=this.oldest;if(e)return this.oldest&&this.oldest[at]?(this.oldest=this.oldest[at],this.oldest[Ot]=void 0):(this.oldest=void 0,this.newest=void 0),e[at]=e[Ot]=void 0,this._keymap.delete(e.key),--this.size,[e.key,e.value]}get(e){const t=this._keymap.get(e);if(!!t)return this._markEntryAsUsed(t),t.value}has(e){return this._keymap.has(e)}find(e){let t=this._keymap.get(e);return t?t.value:void 0}delete(e){let t=this._keymap.get(e);if(!!t)return this._keymap.delete(t.key),t[at]&&t[Ot]?(t[Ot][at]=t[at],t[at][Ot]=t[Ot]):t[at]?(t[at][Ot]=void 0,this.oldest=t[at]):t[Ot]?(t[Ot][at]=void 0,this.newest=t[Ot]):this.oldest=this.newest=void 0,this.size--,t.value}clear(){this.oldest=void 0,this.newest=void 0,this.size=0,this._keymap.clear()}keys(){return new t3(this.oldest)}values(){return new n3(this.oldest)}entries(){return this[Symbol.iterator]()}[Symbol.iterator](){return new r3(this.oldest)}forEach(e,t){typeof t!="object"&&(t=this);let n=this.oldest;for(;n;)e.call(t,n.value,n.key,this),n=n[at]}toJSON(){let e=new Array(this.size),t=0,n=this.oldest;for(;n;)e[t++]={key:n.key,value:n.value},n=n[at];return e}toString(){let e=String(),t=this.oldest;for(;t;)e+=`${String(t.key)}:${t.value}`,t=t[at],t&&(e+=" < ");return e}}function i3(r,e){var t,n,s,i,o,a,l,u,c,h,f,d,m,g,p,_,v,w,y,A,I,R,x,S,k,N,O,D,E,F,j,L,re,Y,ee,U,V,_e,ie,Z,le,ve,Ce,ge,ye,Me,Ze,ke,T,se,ne,B,M,X,ae,oe,$,he,P,z,J,ue,de,Fe,xe,Oe;r.cellData={};for(let ce of e.config.borderInfo)if(ce.rangeType==="cell"){const Te=ce.value.row_index,be=ce.value.col_index;r.cellData[String(Te)]||(r.cellData[String(Te)]={}),r.cellData[String(Te)][String(be)]||(r.cellData[String(Te)][String(be)]={}),r.cellData[String(Te)][String(be)].s||(r.cellData[String(Te)][String(be)].s={});const Ue={};ce.value.l&&(Ue.l={s:ce.value.l.style,cl:{rgb:ce.value.l.color}},r.cellData[String(Te)]&&((s=(n=(t=r.cellData[String(Te)][String(be-1)])==null?void 0:t.s)==null?void 0:n.bd)==null?void 0:s.r)&&delete r.cellData[String(Te)][String(be-1)].s.bd.r),ce.value.r&&(Ue.r={s:ce.value.r.style,cl:{rgb:ce.value.r.color}},r.cellData[String(Te)]&&((a=(o=(i=r.cellData[String(Te)][String(Number(be)+1)])==null?void 0:i.s)==null?void 0:o.bd)==null?void 0:a.l)&&delete r.cellData[String(Te)][String(be-1)].s.bd.l),ce.value.t&&(Ue.t={s:ce.value.t.style,cl:{rgb:ce.value.t.color}},r.cellData[String(Te-1)]&&((c=(u=(l=r.cellData[String(Te)][String(be)])==null?void 0:l.s)==null?void 0:u.bd)==null?void 0:c.b)&&delete r.cellData[String(Te)][String(be-1)].s.bd.b),ce.value.b&&(Ue.b={s:ce.value.b.style,cl:{rgb:ce.value.b.color}},r.cellData[String(Number(Te)+1)]&&((d=(f=(h=r.cellData[String(Te)][String(be)])==null?void 0:h.s)==null?void 0:f.bd)==null?void 0:d.t)&&delete r.cellData[String(Te)][String(be-1)].s.bd.t),r.cellData[String(Te)][String(be)].s.bd=Object.assign(r.cellData[String(Te)][String(be)].s.bd||{},Ue)}else if(ce.rangeType==="range")for(const Te of ce.range){const be=Te.row[0],Ue=Te.row[1],Pe=Te.column[0],Ke=Te.column[1];switch(ce.borderType){case"border-left":for(let H=be;H<=Ue;H++)for(let K=Pe;K<Pe+1;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.l={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=be;H<=Ue;H++)for(let K=Pe-1;K<Pe;K++)r.cellData[String(H)]&&((p=(g=(m=r.cellData[String(H)][String(K)])==null?void 0:m.s)==null?void 0:g.bd)==null?void 0:p.r)&&delete r.cellData[String(H)][String(K)].s.bd.r;break;case"border-right":for(let H=be;H<=Ue;H++)for(let K=Ke;K<Ke+1;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.r={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=be;H<=Ue;H++)for(let K=Ke+1;K<Ke+2;K++)r.cellData[String(H)]&&((w=(v=(_=r.cellData[String(H)][String(K)])==null?void 0:_.s)==null?void 0:v.bd)==null?void 0:w.l)&&delete r.cellData[String(H)][String(K)].s.bd.l;break;case"border-top":for(let H=be;H<be+1;H++)for(let K=Pe;K<=Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.t={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=be-1;H<be;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((I=(A=(y=r.cellData[String(H)][String(K)])==null?void 0:y.s)==null?void 0:A.bd)==null?void 0:I.b)&&delete r.cellData[String(H)][String(K)].s.bd.b;break;case"border-bottom":for(let H=Ue;H<Ue+1;H++)for(let K=Pe;K<=Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.b={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=Ue+1;H<Ue+2;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((S=(x=(R=r.cellData[String(H)][String(K)])==null?void 0:R.s)==null?void 0:x.bd)==null?void 0:S.t)&&delete r.cellData[String(H)][String(K)].s.bd.t;break;case"border-all":for(let H=be;H<=Ue;H++)for(let K=Pe;K<=Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.l={s:ce.style,cl:{rgb:ce.color}},qe.t={s:ce.style,cl:{rgb:ce.color}},K===Ke&&(qe.r={s:ce.style,cl:{rgb:ce.color}}),H===Ue&&(qe.b={s:ce.style,cl:{rgb:ce.color}}),r.cellData[String(H)][String(K)].s.bd=qe}for(let H=be;H<=Ue;H++)for(let K=Pe-1;K<Pe;K++)r.cellData[String(H)]&&((O=(N=(k=r.cellData[String(H)][String(K)])==null?void 0:k.s)==null?void 0:N.bd)==null?void 0:O.r)&&delete r.cellData[String(H)][String(K)].s.bd.r;for(let H=be;H<=Ue;H++)for(let K=Ke+1;K<Ke+2;K++)r.cellData[String(H)]&&((F=(E=(D=r.cellData[String(H)][String(K)])==null?void 0:D.s)==null?void 0:E.bd)==null?void 0:F.l)&&delete r.cellData[String(H)][String(K)].s.bd.l;for(let H=be-1;H<be;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((re=(L=(j=r.cellData[String(H)][String(K)])==null?void 0:j.s)==null?void 0:L.bd)==null?void 0:re.b)&&delete r.cellData[String(H)][String(K)].s.bd.b;for(let H=Ue+1;H<Ue+2;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((U=(ee=(Y=r.cellData[String(H)][String(K)])==null?void 0:Y.s)==null?void 0:ee.bd)==null?void 0:U.t)&&delete r.cellData[String(H)][String(K)].s.bd.t;break;case"border-outside":for(let H=be;H<=Ue;H++)for(let K=Pe;K<=Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};H===be&&(qe.t={s:ce.style,cl:{rgb:ce.color}}),H===Ue&&(qe.b={s:ce.style,cl:{rgb:ce.color}}),K===Pe&&(qe.l={s:ce.style,cl:{rgb:ce.color}}),K===Ke&&(qe.r={s:ce.style,cl:{rgb:ce.color}}),r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=be;H<=Ue;H++)for(let K=Pe-1;K<Pe;K++)r.cellData[String(H)]&&((ie=(_e=(V=r.cellData[String(H)][String(K)])==null?void 0:V.s)==null?void 0:_e.bd)==null?void 0:ie.r)&&delete r.cellData[String(H)][String(K)].s.bd.r;for(let H=be;H<=Ue;H++)for(let K=Ke+1;K<Ke+2;K++)r.cellData[String(H)]&&((ve=(le=(Z=r.cellData[String(H)][String(K)])==null?void 0:Z.s)==null?void 0:le.bd)==null?void 0:ve.l)&&delete r.cellData[String(H)][String(K)].s.bd.l;for(let H=be-1;H<be;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((ye=(ge=(Ce=r.cellData[String(H)][String(K)])==null?void 0:Ce.s)==null?void 0:ge.bd)==null?void 0:ye.b)&&delete r.cellData[String(H)][String(K)].s.bd.b;for(let H=Ue+1;H<Ue+2;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((ke=(Ze=(Me=r.cellData[String(H)][String(K)])==null?void 0:Me.s)==null?void 0:Ze.bd)==null?void 0:ke.t)&&delete r.cellData[String(H)][String(K)].s.bd.t;break;case"border-inside":for(let H=be;H<=Ue;H++)for(let K=Pe;K<=Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};H===be&&K===Pe||(H===be?qe.l={s:ce.style,cl:{rgb:ce.color}}:K===Pe?qe.t={s:ce.style,cl:{rgb:ce.color}}:(qe.l={s:ce.style,cl:{rgb:ce.color}},qe.t={s:ce.style,cl:{rgb:ce.color}}),r.cellData[String(H)][String(K)].s.bd=qe)}break;case"border-horizontal":for(let H=be;H<Ue;H++)for(let K=Pe;K<=Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.b={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=be+1;H<=Ue;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((ne=(se=(T=r.cellData[String(H)][String(K)])==null?void 0:T.s)==null?void 0:se.bd)==null?void 0:ne.t)&&delete r.cellData[String(H)][String(K)].s.bd.t;break;case"border-vertical":for(let H=be;H<=Ue;H++)for(let K=Pe;K<Ke;K++){r.cellData[String(H)]||(r.cellData[String(H)]={}),r.cellData[String(H)][String(K)]||(r.cellData[String(H)][String(K)]={}),r.cellData[String(H)][String(K)].s||(r.cellData[String(H)][String(K)].s={});const qe={};qe.r={s:ce.style,cl:{rgb:ce.color}},r.cellData[String(H)][String(K)].s.bd=Object.assign(r.cellData[String(H)][String(K)].s.bd||{},qe)}for(let H=be;H<=Ue;H++)for(let K=Pe+1;K<=Ke;K++)r.cellData[String(H)]&&((X=(M=(B=r.cellData[String(H)][String(K)])==null?void 0:B.s)==null?void 0:M.bd)==null?void 0:X.l)&&delete r.cellData[String(H)][String(K)].s.bd.l;break;case"border-none":for(let H=be;H<=Ue;H++)for(let K=Pe;K<=Ke;K++){if(!r.cellData[String(H)]||!r.cellData[String(H)][String(K)]||!r.cellData[String(H)][String(K)].s)continue;const qe={};r.cellData[String(H)][String(K)].s.bd=qe}for(let H=be;H<=Ue;H++)for(let K=Pe-1;K<Pe;K++)r.cellData[String(H)]&&(($=(oe=(ae=r.cellData[String(H)][String(K)])==null?void 0:ae.s)==null?void 0:oe.bd)==null?void 0:$.r)&&delete r.cellData[String(H)][String(K)].s.bd.r;for(let H=be;H<=Ue;H++)for(let K=Ke+1;K<Ke+2;K++)r.cellData[String(H)]&&((z=(P=(he=r.cellData[String(H)][String(K)])==null?void 0:he.s)==null?void 0:P.bd)==null?void 0:z.l)&&delete r.cellData[String(H)][String(K)].s.bd.l;for(let H=be-1;H<be;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((de=(ue=(J=r.cellData[String(H)][String(K)])==null?void 0:J.s)==null?void 0:ue.bd)==null?void 0:de.b)&&delete r.cellData[String(H)][String(K)].s.bd.b;for(let H=Ue+1;H<Ue+2;H++)for(let K=Pe;K<=Ke;K++)r.cellData[String(H)]&&((Oe=(xe=(Fe=r.cellData[String(H)][String(K)])==null?void 0:Fe.s)==null?void 0:xe.bd)==null?void 0:Oe.t)&&delete r.cellData[String(H)][String(K)].s.bd.t;break}}}function o3(r){var t;const e={};if(e.styles={},r.hasOwnProperty("lang")&&(e.locale=r.lang),r.hasOwnProperty("data")){e.sheets={};for(let n of r.data){const s={};if(s.id=Rt(6),n.hasOwnProperty("zoomRatio")&&(s.zoomRatio=n.zoomRatio),n.hasOwnProperty("row")&&(s.rowCount=n.row),n.hasOwnProperty("column")&&(s.columnCount=n.column),n.hasOwnProperty("status")&&(s.status=parseInt(n.status)),n.hasOwnProperty("name")&&(s.name=n.name),n.hasOwnProperty("universheet_select_save")&&(s.selections=[],n.universheet_select_save.forEach(i=>{var o;(o=s.selections)==null||o.push({startRow:i.row[0],endRow:i.row[1],startColumn:i.column[0],endColumn:i.column[1]})})),n.hasOwnProperty("scrollLeft")&&(s.scrollLeft=n.scrollLeft),n.hasOwnProperty("scrollTop")&&(s.scrollTop=n.scrollTop),n.hasOwnProperty("config")){if(n.config.merge){s.mergeData=[];for(const i of Object.keys(n.config.merge)){const o=n.config.merge[i],a={startRow:o.r,endRow:o.r+o.rs-1,startColumn:o.c,endColumn:o.c+o.cs-1};s.mergeData.push(a)}}if(n.config.borderInfo&&i3(s,n),n.config.rowlen){s.rowData={};for(const[i,o]of Object.entries(n.config.rowlen))s.rowData[String(i)]={h:o,hd:0}}if(n.config.columnlen){s.columnData={};for(const[i,o]of Object.entries(n.config.columnlen))s.columnData[String(i)]={w:o,hd:0}}if(n.config.rowhidden){s.rowData||(s.rowData={});for(const[i,o]of Object.entries(n.config.rowhidden))s.rowData[String(i)]||(s.rowData[String(i)]={}),s.rowData[String(i)].hd=o}if(n.config.colhidden){s.columnData||(s.columnData={});for(const[i,o]of Object.entries(n.config.colhidden))s.columnData[String(i)]||(s.columnData[String(i)]={}),s.columnData[String(i)].hd=o}}if(n.hasOwnProperty("celldata")){s.cellData||(s.cellData={});for(const i of n.celldata){s.cellData[i.r]||(s.cellData[i.r]={}),s.cellData[i.r][i.c]||(s.cellData[i.r][i.c]={});const o=i.v,a=s.cellData[i.r][i.c];if(((t=o==null?void 0:o.ct)==null?void 0:t.t)==="inlineStr"){const l={},u=[];o.ct.s.forEach(c=>{const h={};c.hasOwnProperty("bg")&&(h.bg={rgb:c.fc}),c.hasOwnProperty("ff")&&(h.ff=c.ff),c.hasOwnProperty("fc")&&(h.cl={rgb:c.fc}),c.hasOwnProperty("fs")&&(h.fs=c.fs),c.hasOwnProperty("bl")&&(h.bl=c.bl),c.hasOwnProperty("it")&&(h.it=c.it),c.hasOwnProperty("cl")&&(h.st={s:1}),c.hasOwnProperty("un")&&(h.ul={s:c.un});const f=Rt(6);l[f]={eId:f,st:0,ed:c.v.length-1,et:0,tr:{ct:c.v,ts:h}},u.push({elementId:f,paragraphElementType:0})}),a.p={documentId:Rt(6),body:{blockElements:{p1:{blockId:"p1",st:0,ed:o.ct.s.length-1,blockType:0,paragraph:{elements:l,elementOrder:u}}},blockElementOrder:["p1"]},documentStyle:{}}}else{o.hasOwnProperty("v")&&(a.v=o.v),o.hasOwnProperty("m")?a.m=o.m:a.m=String(o.v||"");const l={};o.hasOwnProperty("bg")&&(l.bg={rgb:o.bg}),o.hasOwnProperty("ff")&&(l.ff=o.ff),o.hasOwnProperty("fc")&&(l.cl={rgb:o.fc}),o.hasOwnProperty("fs")&&(l.fs=o.fs),o.hasOwnProperty("bl")&&(l.bl=o.bl),o.hasOwnProperty("it")&&(l.it=o.it),o.hasOwnProperty("cl")&&(l.st={s:o.cl}),o.hasOwnProperty("un")&&(l.ul={s:o.un});const u={0:2,1:1,2:3};if(o.hasOwnProperty("vt")&&(l.vt=u[String(o.vt)]),o.hasOwnProperty("ht")&&(l.ht=u[String(o.ht)]),o.hasOwnProperty("tr"))switch(o.tr){case"0":l.tr={a:0,v:0};break;case"1":l.tr={a:45,v:0};break;case"2":l.tr={a:-45,v:0};break;case"3":l.tr={a:0,v:1};break;case"4":l.tr={a:90,v:0};break;case"5":l.tr={a:-90,v:0};break}o.hasOwnProperty("rt")&&(l.tr={a:o.tr,v:0}),o.hasOwnProperty("tb")&&(l.tb=u[String(o.tb)]),a.s=Object.assign(a.s||{},l)}}}e.sheets[s.id]=s}}return e}const Sc=[];let a3=0;class Sr{static _generateName(){return`sheet${++a3}`}static _checkedName(e){const t=Sc.includes(e);return t||Sc.push(e),t}static getSheetName(e){for(e===void 0&&(e=Sr._generateName());Sr._checkedName(e);)e=Sr._generateName();return e}}const l3=":",u3=/[^0-9]/g,c3=/[^A-Za-z]/g;function Ra(r){let e=parseInt(r.replace(u3,""))-1,t=G.ABCatNum(r.replace(c3,""));return{row:e,column:t}}function Ml(r){const e=r.indexOf("!");let t="",n="";e>-1?(t=r.substring(0,e),n=r.substring(e)):n=r;let s=n.indexOf(l3);if(s===-1){const m=Ra(n),g=m.row,p=m.column;return{sheetName:t,rangeData:{startRow:g,startColumn:p,endRow:g,endColumn:p}}}const i=n.substring(0,s),o=n.substring(s+1),a=Ra(i),l=Ra(o),u=a.row,c=a.column,h=l.row,f=l.column;return{sheetName:t,rangeData:{startRow:u,startColumn:c,endRow:h,endColumn:f}}}const Bo="A".charCodeAt(0),Fd="Z".charCodeAt(0),h3="a".charCodeAt(0);function d3(r){const e=Fd-Bo+1;let t="";for(;r>=0;)t=String.fromCharCode(r%e+Bo)+t,r=Math.floor(r/e)-1;return t}function f3(r,e){let t="";for(;e>0;)t+=r,e--;return t}function Bd(r,e=!1){const t=Fd-Bo+1;let n=h3;e&&(n=Bo);const s=String.fromCharCode(r%t+n);let i=Math.floor(r/t)+1;return f3(s,i)}class wi{static fromSequence(e){if(G.isObject(e)&&wi.requiredNewInstance(this))return this.newInstance(e);if(G.isArray(e)&&wi.requiredNewInstance(this)){const t=this;return e.map(n=>t.newInstance(n))}return[]}toSequence(){return{className:G.getClassName(this)}}}(r=>{function e(t){if(G.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")}r.requiredNewInstance=e})(wi||(wi={}));function Ft(r,e){return r.zIndex>e.zIndex?1:r.zIndex===e.zIndex?0:-1}function Ac(r,e){return r.zIndex>e.zIndex?-1:r.zIndex===e.zIndex?0:1}function g3(r){let e=0;for(let t=0;t<r.length;t++)e=r.charCodeAt(t)+(e<<6)+(e<<16)-e;return e>>>0}class Rc{constructor(e,t,n){this.path=e,this.namespace=t,this.observable=n}}class m3{constructor(){this._observableArray=[]}hasObserver(e,t){return this.getObserver(e,t)!=null}getObserver(...e){if(e.length===1){const t=e[0],n=this._observableArray.find(s=>s.path===t);return n?n.observable:null}if(e.length===2){const t=e[0],n=e[1],s=this._observableArray.find(i=>i.path===t&&i.namespace===n);return s?s.observable:null}}requiredObserver(...e){if(G.hasLength(e,1)){const t=e[0],n=this.getObserver(t);if(n==null)throw new Error(`not found observable ${t}`);return n}if(G.hasLength(e,2)){const t=e[0],n=e[1],s=this.getObserver(t,n);if(s==null)throw new Error(`not found observable ${t}`);return s}throw new Error("requiredObserver arguments error")}removeObserver(...e){if(G.hasLength(e,1)){const t=e[0],n=this._observableArray.findIndex(s=>s.path===t);n>-1&&this._observableArray.splice(n,1);return}if(G.hasLength(e,2)){const t=e[0],n=e[1],s=this._observableArray.findIndex(i=>i.path===t&&i.namespace===n);s>-1&&this._observableArray.splice(s,1)}}addObserver(...e){if(e.length===1){const t=e[0],n=e[1];this.hasObserver(t,t)&&this.removeObserver(t),this._observableArray.push(new Rc(t,t,n));return}if(e.length===3){const t=e[0],n=e[1],s=e[2];this.hasObserver(t,t)&&this.removeObserver(t,n),this._observableArray.push(new Rc(t,n,s))}}}var we=(r=>(r[r.REDO=0]="REDO",r[r.UNDO=1]="UNDO",r))(we||{});class p3 extends Ae{}class Fl{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new Fl}}const _3=Fl.create();class b3{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(Ft)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(..._3.getData().sort(Ft))}}class v3{getRegister(){return this._register}constructor(){this._register=new b3,this._register.initialize()}handle(e){var n;const t=(n=this._register)==null?void 0:n.actionExtensionFactoryList;!t||(this._actionExtensionFactoryList=t,e.length!==0&&this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach(t=>{const n=t.check(e);n!==!1&&n.execute()})}}class C3 extends Ae{}class E3 extends Ae{}class Be{getActionExtensionManager(){return this._actionExtensionManager}constructor(e){this._undoManager=e.getUndoManager(),this._actionExtensionManager=new v3}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new p3,this._commandObservers=new C3,this._commandInjectorObservers=new E3}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this,{_actionDataList:n,_unit:s,_actionList:i}=e;this._actionExtensionManager.handle(n),n.forEach(o=>{const a=Be.getAction(o.actionName),l=Be.getActionObservers(),u=new a(o,s,l);i.push(u)}),e.invoke(),t.push(e)}}Be.staticInitialize();class fe{constructor(e,...t){this._unit=e,this._actionDataList=t,this._actionList=[]}getDoData(){return this._actionList.map(e=>e.getDoActionData())}getOldData(){return this._actionList.map(e=>e.getOldActionDaa())}getInjector(){const e=this;return new class{injectAction(t){e._actionList.push(t)}getActions(){return e._actionList.concat([])}include(t){for(let n=0;n<e._actionList.length;n++)if(e._actionList[n]instanceof t)return e._actionList[n];return null}}}redo(){this._actionList.forEach(e=>e.redo()),Be.getCommandObservers().notifyObservers({type:we.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach(e=>e.undo()),Be.getCommandObservers().notifyObservers({type:we.UNDO,actions:this._actionList})}invoke(){Be.getCommandInjectorObservers().notifyObservers(this.getInjector()),Be.getCommandObservers().notifyObservers({type:we.REDO,actions:this._actionList})}}class w3{constructor(){this._undoStack=[],this._redoStack=[]}push(e){this._redoStack.push(e)}undo(){const e=this._redoStack.pop();if(e)return this._undoStack.push(e),e}redo(){const e=this._undoStack.pop();if(e)return this._redoStack.push(e),e}}class Zo{constructor(e,t){this.actionDataList=e,this._plugin=t}getActionDataList(){return this.actionDataList}push(e){this.actionDataList.push(e)}setValue(){}execute(){}}class Bl{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new Zo(e,this._plugin)}check(e){return this.create(e)}}class Dr{static hasObserver(e){return e.operation?(e.operation&$t.OBSERVER_ACTION)===$t.OBSERVER_ACTION:!1}static hasUndo(e){return e.operation?(e.operation&$t.UNDO_ACTION)===$t.UNDO_ACTION:!1}static hasCollaboration(e){return e.operation?(e.operation&$t.SERVER_ACTION)===$t.SERVER_ACTION:!1}static hasExtension(e){return e.operation?(e.operation&$t.EXTENSION_ACTION)===$t.EXTENSION_ACTION:!1}static make(e){return e.operation=$t.DEFAULT_ACTION,new Dr(e)}constructor(e){this._action=e}removeObserver(){return this._action.operation&&(this._action.operation&=~$t.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~$t.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~$t.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~$t.EXTENSION_ACTION),this}getAction(){return this._action}}var Ll=(r=>(r.INSERT_TEXT_ACTION_NAME="InsertTextAction",r.DELETE_TEXT_ACTION_NAME="DeleteTextAction",r))(Ll||{});class Ld extends sd{constructor(e,t,n){if(super(e,n),t.DocumentUnit==null)throw new Error("action document domain can not be null!");this._document=t.DocumentUnit}getDocument(){return this._document}}var Lt=(r=>(r[r.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",r[r.NONE=1]="NONE",r[r.DECIMAL=2]="DECIMAL",r[r.ZERO_DECIMAL=3]="ZERO_DECIMAL",r[r.UPPER_ALPHA=4]="UPPER_ALPHA",r[r.ALPHA=5]="ALPHA",r[r.UPPER_ROMAN=6]="UPPER_ROMAN",r[r.ROMAN=7]="ROMAN",r))(Lt||{}),Ct=(r=>(r[r.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",r[r.START=1]="START",r[r.CENTER=2]="CENTER",r[r.END=3]="END",r))(Ct||{}),ze=(r=>(r[r.PARAGRAPH=0]="PARAGRAPH",r[r.TABLE=1]="TABLE",r[r.SECTION_BREAK=2]="SECTION_BREAK",r[r.CUSTOM=3]="CUSTOM",r))(ze||{}),cn=(r=>(r[r.DEFAULT=0]="DEFAULT",r[r.LINES=1]="LINES",r[r.LINES_AND_CHARS=2]="LINES_AND_CHARS",r[r.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",r))(cn||{}),Gr=(r=>(r[r.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",r[r.CONTINUOUS=1]="CONTINUOUS",r[r.NEXT_PAGE=2]="NEXT_PAGE",r[r.EVEN_PAGE=3]="EVEN_PAGE",r[r.ODD_PAGE=4]="ODD_PAGE",r))(Gr||{}),ir=(r=>(r[r.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",r[r.NONE=1]="NONE",r[r.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",r))(ir||{}),nl=(r=>(r[r.NORMAL=0]="NORMAL",r[r.TBRL=1]="TBRL",r[r.LRTBV=2]="LRTBV",r))(nl||{}),q=(r=>(r[r.TEXT_RUN=0]="TEXT_RUN",r[r.AUTO_TEXT=1]="AUTO_TEXT",r[r.PAGE_BREAK=2]="PAGE_BREAK",r[r.COLUMN_BREAK=3]="COLUMN_BREAK",r[r.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",r[r.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",r[r.EQUATION=6]="EQUATION",r[r.DRAWING=7]="DRAWING",r[r.PERSON=8]="PERSON",r[r.RICH_LINK=9]="RICH_LINK",r))(q||{}),Wn=(r=>(r[r.BOTH_SIDES=0]="BOTH_SIDES",r[r.LEFT=1]="LEFT",r[r.RIGHT=2]="RIGHT",r[r.LARGEST=3]="LARGEST",r))(Wn||{}),tn=(r=>(r[r.INLINE=0]="INLINE",r[r.WRAP_NONE=1]="WRAP_NONE",r[r.WRAP_POLYGON=2]="WRAP_POLYGON",r[r.WRAP_SQUARE=3]="WRAP_SQUARE",r[r.WRAP_THROUGH=4]="WRAP_THROUGH",r[r.WRAP_TIGHT=5]="WRAP_TIGHT",r[r.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",r))(tn||{}),Pl=(r=>(r[r.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",r[r.NORMAL_TEXT=1]="NORMAL_TEXT",r[r.TITLE=2]="TITLE",r[r.SUBTITLE=3]="SUBTITLE",r[r.HEADING_1=4]="HEADING_1",r[r.HEADING_2=5]="HEADING_2",r[r.HEADING_3=6]="HEADING_3",r[r.HEADING_4=7]="HEADING_4",r[r.HEADING_5=8]="HEADING_5",r[r.HEADING_6=9]="HEADING_6",r))(Pl||{}),Ti=(r=>(r[r.AUTO=0]="AUTO",r[r.AT_LEAST=1]="AT_LEAST",r[r.EXACT=2]="EXACT",r))(Ti||{}),ni=(r=>(r.NORMAL="normal",r.BOLD="bold",r.ITALIC="italic",r))(ni||{}),ot=(r=>(r[r.CHARACTER=0]="CHARACTER",r[r.COLUMN=1]="COLUMN",r[r.INSIDE_MARGIN=2]="INSIDE_MARGIN",r[r.LEFT_MARGIN=3]="LEFT_MARGIN",r[r.MARGIN=4]="MARGIN",r[r.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",r[r.PAGE=6]="PAGE",r[r.RIGHT_MARGIN=7]="RIGHT_MARGIN",r))(ot||{}),lt=(r=>(r[r.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",r[r.INSIDE_MARGIN=1]="INSIDE_MARGIN",r[r.LINE=2]="LINE",r[r.MARGIN=3]="MARGIN",r[r.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",r[r.PAGE=5]="PAGE",r[r.PARAGRAPH=6]="PARAGRAPH",r[r.TOP_MARGIN=7]="TOP_MARGIN",r))(lt||{}),Pd=(r=>(r[r.POINT=0]="POINT",r[r.LINE=1]="LINE",r[r.CHARACTER=2]="CHARACTER",r))(Pd||{}),mr=(r=>(r[r.CENTER=0]="CENTER",r[r.INSIDE=1]="INSIDE",r[r.LEFT=2]="LEFT",r[r.OUTSIDE=3]="OUTSIDE",r[r.RIGHT=4]="RIGHT",r))(mr||{}),ms=(r=>(r[r.BOTTOM=0]="BOTTOM",r[r.CENTER=1]="CENTER",r[r.INSIDE=2]="INSIDE",r[r.OUTSIDE=3]="OUTSIDE",r[r.TOP=4]="TOP",r))(ms||{}),qo=(r=>(r[r.PORTRAIT=0]="PORTRAIT",r[r.LANDSCAPE=1]="LANDSCAPE",r))(qo||{});function Hd(r){let e=r-1;return e=e<0?0:e,e}function T3(r,e,t){return r.slice(0,e)+t+r.slice(e)}function y3(r,e,t){const n=e-t<0?0:e-t;return r.slice(0,n)+r.slice(e)}function Ud(r,e=0){r!=null&&(r.st+=e,r.ed+=e)}function zd(r,e=0){r!=null&&(r.st+=e,r.ed+=e)}function Wd(r,e){const t=r.getSnapshot(),{text:n,start:s,length:i,segmentId:o}=e,a=Hd(s);let l=t.body;if(i===0)return;if(o){const{headers:f,footers:d}=t;f!=null&&f[o]?l=f[o].body:d!=null&&d[o]&&(l=d[o].body)}if(l==null)throw new Error("no body has changed");const{blockElements:u,blockElementOrder:c}=l;let h=!1;for(let f of c){const d=u[f];if(d==null)continue;const{blockType:m}=d;switch(m){case ze.PARAGRAPH:h=S3(n,s,a,i,d,d.paragraph,h)}}}function S3(r,e,t,n,s,i,o=!1){o&&zd(s,n);const{st:a,ed:l}=s;let u=!1;if(t>l||i==null)return u;const{elements:c,elementOrder:h}=i;for(let f of h){const{elementId:d,paragraphElementType:m}=f,g=c[d];if(m===q.DRAWING)continue;const{st:p,ed:_,tr:v}=g;if((u||o)&&t>_&&Ud(g,n),v!=null&&!(t<p||t>_||o)&&(console.log("paragraphApply",t,p,_,o,g,t<p||t>_||o),m===q.TEXT_RUN)){let w=t-p+1;if(e===0&&(w=0),u=!0,v.tab===te.TRUE)continue;const y=T3(v.ct||"",w,r);v.ct=y,g.ed+=n}}return u===!0&&o===!1&&(s.ed+=n),o?!0:u}function Vd(r,e){const t=r.getSnapshot(),{start:n,length:s,segmentId:i}=e,o=Hd(n);let a=t.body;if(s===0)return;if(i){const{headers:h,footers:f}=t;h!=null&&h[i]?a=h[i].body:f!=null&&f[i]&&(a=f[i].body)}if(a==null)throw new Error("no body has changed");const{blockElements:l,blockElementOrder:u}=a;let c=!1;for(let h of u){const f=l[h];if(f==null)continue;const{blockType:d}=f;switch(d){case ze.PARAGRAPH:c=A3(n,o,s,f,f.paragraph,c)}}}function A3(r,e,t,n,s,i=!1){i&&zd(n,-t);const{st:o,ed:a}=n;let l=!1;if(e>a||s==null)return l;const{elements:u,elementOrder:c}=s;for(let h of c){const{elementId:f,paragraphElementType:d}=h,m=u[f];if(d===q.DRAWING)continue;const{st:g,ed:p,tr:_}=m;if((l||i)&&e>p&&Ud(m,-t),_!=null&&!(e<g||e>p||i)&&d===q.TEXT_RUN){let v=e-g+1;if(r===0&&(v=0),l=!0,_.tab===te.TRUE)continue;const w=y3(_.ct||"",v,t);_.ct=w,m.ed-=t}}return l===!0&&i===!1&&(n.ed-=t),i?!0:l}class R3 extends Ld{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do();const{length:s,start:i}=e;this._oldActionData={...e,start:i+s}}redo(){this.do()}do(){const e=this.getDoActionData(),t=this.getDocument(),{text:n,start:s,length:i,segmentId:o}=e;Wd(t,{text:n,start:s,length:i,segmentId:o}),this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this})}undo(){const e=this.getOldActionDaa(),t=this.getDocument(),{length:n,start:s,segmentId:i}=e;Vd(t,{length:n,start:s,segmentId:i}),this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class D3 extends Ld{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this.do();const{length:s,start:i}=e;this._oldActionData={...e,start:i-s}}redo(){this.do()}do(){const e=this.getDoActionData(),t=this.getDocument(),{length:n,start:s}=e;Vd(t,{length:n,start:s})}undo(){const e=this.getOldActionDaa(),t=this.getDocument(),{text:n,start:s,length:i}=e;Wd(t,{text:n,start:s,length:i})}validate(){return!1}}Be.register(W.INSERT_ROW_DATA_ACTION,Q6);Be.register(W.INSERT_ROW_ACTION,xd);Be.register(W.REMOVE_ROW_DATA_ACTION,r0);Be.register(W.REMOVE_ROW_ACTION,Od);Be.register(W.SET_RANGE_STYLE_ACTION,m0);Be.register(W.SET_WORKSHEET_STATUS_ACTION,A0);Be.register(W.SET_SELECTION_ACTION,E0);Be.register(W.SET_RANGE_DATA_ACTION,h0);Be.register(W.SET_RANGE_FORMATTED_VALUE_ACTION,p0);Be.register(W.DELETE_RANGE_ACTION,Rd);Be.register(W.CLEAR_RANGE_ACTION,K6);Be.register(W.INSERT_RANGE_ACTION,J6);Be.register(W.SET_TAB_COLOR_ACTION,w0);Be.register(W.HIDE_SHEET_ACTION,y0);Be.register(W.SET_WORKSHEET_ACTIVATE_ACTION,T0);Be.register(W.SET_HIDE_ROW_ACTION,v0);Be.register(W.SET_SHOW_ROW_ACTION,C0);Be.register(W.SET_HIDE_COLUMN_ACTION,o0);Be.register(W.SET_SHOW_COLUMN_ACTION,a0);Be.register(W.ADD_MERGE_ACTION,V6);Be.register(W.REMOVE_MERGE_ACTION,n0);Be.register(W.SET_WORKSHEET_NAME_ACTION,S0);Be.register(W.SET_HIDDEN_GRIDLINES_ACTION,u0);Be.register(W.SET_COLUMN_WIDTH_ACTION,l0);Be.register(W.SET_ROW_HEIGHT_ACTION,b0);Be.register(W.SET_BORDER_ACTION,i0);Be.register(W.SET_RIGHT_TO_LEFT_ACTION,_0);Be.register(W.INSERT_COLUMN_DATA_ACTION,q6);Be.register(W.REMOVE_COLUMN_DATA_ACTION,t0);Be.register(W.INSERT_COLUMN_ACTION,Dd);Be.register(W.REMOVE_COLUMN_ACTION,Id);Be.register(W.DELETE_NAMED_RANGE_ACTION,Z6);Be.register(W.SET_NAMED_RANGE_ACTION,c0);Be.register(W.ADD_NAMED_RANGE_ACTION,G6);Be.register(W.SET_RANGE_FORMAT_ACTION,d0);Be.register(W.SET_RANGE_FORMULA_ACTION,f0);Be.register(W.SET_RANGE_NOTE_ACTION,g0);Be.register(W.INSERT_SHEET_ACTION,e0);Be.register(W.REMOVE_SHEET_ACTION,s0);Be.register(W.SET_SHEET_ORDER_ACTION,kd);Be.register(W.SET_SHEET_ORDER_ACTION,kd);Be.register(W.SET_ZOOM_RATIO_ACTION,R0);Be.register(Ll.INSERT_TEXT_ACTION_NAME,R3);Be.register(Ll.DELETE_TEXT_ACTION_NAME,D3);class or{constructor(e){this._name=e,this._observeNames=[]}onCreate(e){this.context=e}load(e){}save(){return Object()}onMounted(e){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getObserver(e){return this.context.getObserverManager().getObserver(e,this._name)}getPluginByName(e){return this.context.getPluginManager().getPluginByName(e)}pushToObserve(...e){const t=this.context.getObserverManager();e.forEach(n=>{this._observeNames.includes(n)||this._observeNames.push(n),t.addObserver(n,this._name,new Ae)})}deleteObserve(...e){const t=this.context.getObserverManager();e.forEach(n=>{t.removeObserver(n,this._name)})}}class x3{_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach(e=>{e.onCreate(this._context),e.onMounted(this._context)}))}constructor(e,t=[]){this._context=e,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(t),this._initialize()}install(e){const{_plugins:t}=this;t.push(e),e.onCreate(this._context),e.onMounted(this._context)}uninstall(e){const{_plugins:t}=this,n=t.findIndex(s=>s.getPluginName()===e);if(n>-1){const s=t.splice(n,1)[0];s&&s.onDestroy()}}setContext(e){this._context=e}getRequirePluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];throw new Error(`not found plugin ${e}`)}getPlugins(){return this._plugins}getPluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];return null}}class I3{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class O3{constructor(){this._undoManager=new w3,this._commandManager=new Be(this),this._environment=new I3,this._hooksManager=new N6,this._locale=new Fo,this._pluginManager=new x3(this),this._observerManager=new m3}onUniver(e){this._univer=e}getHook(e){return this._hooksManager.getHooks(e)}getLocale(){return this._locale}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}}class xr{constructor(){this._data=[]}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new xr}}class Hl{constructor(){this._data=new Map}add(e,t){this._data.has(e)||this._data.set(e,t)}delete(e){this._data.delete(e)}getData(){return this._data}static create(){return new Hl}}class k3{install(e){e.addObserver("onAfterSetSelectionObservable","core",new Ae),e.addObserver("onBeforeChangeNameObservable","core",new Ae),e.addObserver("onAfterChangeNameObservable","core",new Ae),e.addObserver("onBeforeChangeActiveSheetObservable","core",new Ae),e.addObserver("onAfterChangeActiveSheetObservable","core",new Ae),e.addObserver("onBeforeChangeSheetNameObservable","core",new Ae),e.addObserver("onAfterChangeSheetNameObservable","core",new Ae),e.addObserver("onBeforeInsertSheetObservable","core",new Ae),e.addObserver("onAfterInsertSheetObservable","core",new Ae),e.addObserver("onBeforeRemoveSheetObservable","core",new Ae),e.addObserver("onAfterRemoveSheetObservable","core",new Ae),e.addObserver("onBeforeChangeSheetColorObservable","core",new Ae),e.addObserver("onAfterChangeSheetColorObservable","core",new Ae),e.addObserver("onBeforeChangeSheetDataObservable","core",new Ae),e.addObserver("onAfterChangeSheetDataObservable","core",new Ae),e.addObserver("onSheetBarDidMountObservable","core",new Ae),e.addObserver("onInfoBarDidMountObservable","core",new Ae),e.addObserver("onRightMenuDidMountObservable","core",new Ae),e.addObserver("onAfterChangeSheetScrollObservable","core",new Ae),e.addObserver("onAfterChangeUILocaleObservable","core",new Ae),e.addObserver("onSheetRenderDidMountObservable","core",new Ae),e.addObserver("onAfterChangeUISkinObservable","core",new Ae),e.addObserver("onHideSheetObservable","core",new Ae),e.addObserver("onShowSheetObservable","core",new Ae),e.addObserver("onSheetTabColorChangeObservable","core",new Ae),e.addObserver("onSheetOrderObservable","core",new Ae),e.addObserver("onZoomRatioSheetObservable","core",new Ae)}}class N3 extends O3{constructor(e={}){super(),this._locale.initialize(e.locale),this._setObserver(),this._workbook=new vc(e,this)}_setObserver(){const e=this.getObserverManager();new k3().install(e)}getWorkBook(){return this._workbook}getContextObserver(e){return this.getObserverManager().requiredObserver(e,"core")}refreshWorkbook(e={}){this._workbook=new vc(e,this)}}var Jr=(r=>(r[r.SLIDE=0]="SLIDE",r[r.MASTER=1]="MASTER",r[r.LAYOUT=2]="LAYOUT",r[r.HANDOUT_MASTER=3]="HANDOUT_MASTER",r[r.NOTES_MASTER=4]="NOTES_MASTER",r))(Jr||{}),De=(r=>(r[r.SHAPE=0]="SHAPE",r[r.IMAGE=1]="IMAGE",r[r.TEXT=2]="TEXT",r[r.SPREADSHEET=3]="SPREADSHEET",r[r.DOCUMENT=4]="DOCUMENT",r))(De||{});const M3="@univer/core",F3="0.0.1",B3="",L3="",P3="./src/index.ts",H3="./src/index.ts",U3="./src/Types/index.d.ts",z3={main:"./lib/univer-core.js",module:"./lib/univer-core.mjs",types:"./lib/index.d.ts"},W3={".":"./src/index.ts","./*":"./src/*"},V3=["lib"],G3={lib:"lib"},X3={test:"cross-env NODE_ENV=--experimental-vm-modules jest --config=jest.config.js",dev:"vite",build:"tsc && vite build",watch:"vite build",link:"pnpm link ./",api:"node ./api.js",tsc:"tsc",serve:"node test/Server/server.js"},$3="MIT",Y3={dayjs:"^1.11.5","es6-proxy-polyfill":"^2.1.1",nanoid:"4.0.0",numeral:"^2.0.6","reflect-metadata":"^0.1.13"},j3={"@types/jest":"^28.1.8","@types/node":"^18.7.12","@typescript-eslint/eslint-plugin":"^5.34.0","@typescript-eslint/parser":"^5.34.0",debug:"^4.3.4",jest:"29.0.0","jest-dev-server":"^6.1.1","jest-environment-jsdom":"^29.0.3",less:"^4.1.3","ts-jest":"29.0.1","ts-node":"^10.9.1",typescript:"^4.7.4",vite:"^3.0.9","vite-plugin-external":"1.2.3"};var K3={name:M3,version:F3,description:B3,author:L3,main:P3,module:H3,types:U3,publishConfig:z3,exports:W3,files:V3,directories:G3,scripts:X3,license:$3,dependencies:Y3,devDependencies:j3};const Z3="dev",q3=K3.version;class Ul{constructor(e={}){this.univerSheetConfig=e,this._context=new N3(e)}static newInstance(e={}){return Nl.capsule(Z3,q3,"powered by :: universheet :: "),new Ul(e)}static get(e){return Tc({...e,type:"GET"})}static post(e){return Tc({...e,type:"POST"})}static load(e,t){e.getWorkBook().load(t.workbookConfig),e.context.getPluginManager().getPlugins().forEach(n=>{n.load(t[`${n.getPluginName()}Config`])})}static newColor(){return new jo}get context(){return this._context}getUnitId(){return this.getWorkBook().getUnitId()}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}getWorkBook(){return this._context.getWorkBook()}static toJson(e){const t=e.getWorkBook().save(),n={};return e.context.getPluginManager().getPlugins().forEach(s=>{n[`${s.getPluginName()}Config`]=s.save()}),{workbookConfig:t,...n}}refreshWorkbook(e={}){this._context.refreshWorkbook(e)}}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var Dc;(function(r){(function(e){var t=typeof vr=="object"?vr:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),n=s(r);typeof t.Reflect=="undefined"?t.Reflect=r:n=s(t.Reflect,n),e(n);function s(i,o){return function(a,l){typeof i[a]!="function"&&Object.defineProperty(i,a,{configurable:!0,writable:!0,value:l}),o&&o(a,l)}}})(function(e){var t=Object.prototype.hasOwnProperty,n=typeof Symbol=="function",s=n&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",i=n&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",o=typeof Object.create=="function",a={__proto__:[]}instanceof Array,l=!o&&!a,u={create:o?function(){return he(Object.create(null))}:a?function(){return he({__proto__:null})}:function(){return he({})},has:l?function(P,z){return t.call(P,z)}:function(P,z){return z in P},get:l?function(P,z){return t.call(P,z)?P[z]:void 0}:function(P,z){return P[z]}},c=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",f=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:ae(),d=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:oe(),m=!h&&typeof WeakMap=="function"?WeakMap:$(),g=new m;function p(P,z,J,ue){if(U(J)){if(!ye(P))throw new TypeError;if(!Ze(z))throw new TypeError;return k(P,z)}else{if(!ye(P))throw new TypeError;if(!ie(z))throw new TypeError;if(!ie(ue)&&!U(ue)&&!V(ue))throw new TypeError;return V(ue)&&(ue=void 0),J=ge(J),N(P,z,J,ue)}}e("decorate",p);function _(P,z){function J(ue,de){if(!ie(ue))throw new TypeError;if(!U(de)&&!ke(de))throw new TypeError;L(P,z,ue,de)}return J}e("metadata",_);function v(P,z,J,ue){if(!ie(J))throw new TypeError;return U(ue)||(ue=ge(ue)),L(P,z,J,ue)}e("defineMetadata",v);function w(P,z,J){if(!ie(z))throw new TypeError;return U(J)||(J=ge(J)),D(P,z,J)}e("hasMetadata",w);function y(P,z,J){if(!ie(z))throw new TypeError;return U(J)||(J=ge(J)),E(P,z,J)}e("hasOwnMetadata",y);function A(P,z,J){if(!ie(z))throw new TypeError;return U(J)||(J=ge(J)),F(P,z,J)}e("getMetadata",A);function I(P,z,J){if(!ie(z))throw new TypeError;return U(J)||(J=ge(J)),j(P,z,J)}e("getOwnMetadata",I);function R(P,z){if(!ie(P))throw new TypeError;return U(z)||(z=ge(z)),re(P,z)}e("getMetadataKeys",R);function x(P,z){if(!ie(P))throw new TypeError;return U(z)||(z=ge(z)),Y(P,z)}e("getOwnMetadataKeys",x);function S(P,z,J){if(!ie(z))throw new TypeError;U(J)||(J=ge(J));var ue=O(z,J,!1);if(U(ue)||!ue.delete(P))return!1;if(ue.size>0)return!0;var de=g.get(z);return de.delete(J),de.size>0||g.delete(z),!0}e("deleteMetadata",S);function k(P,z){for(var J=P.length-1;J>=0;--J){var ue=P[J],de=ue(z);if(!U(de)&&!V(de)){if(!Ze(de))throw new TypeError;z=de}}return z}function N(P,z,J,ue){for(var de=P.length-1;de>=0;--de){var Fe=P[de],xe=Fe(z,J,ue);if(!U(xe)&&!V(xe)){if(!ie(xe))throw new TypeError;ue=xe}}return ue}function O(P,z,J){var ue=g.get(P);if(U(ue)){if(!J)return;ue=new f,g.set(P,ue)}var de=ue.get(z);if(U(de)){if(!J)return;de=new f,ue.set(z,de)}return de}function D(P,z,J){var ue=E(P,z,J);if(ue)return!0;var de=X(z);return V(de)?!1:D(P,de,J)}function E(P,z,J){var ue=O(z,J,!1);return U(ue)?!1:ve(ue.has(P))}function F(P,z,J){var ue=E(P,z,J);if(ue)return j(P,z,J);var de=X(z);if(!V(de))return F(P,de,J)}function j(P,z,J){var ue=O(z,J,!1);if(!U(ue))return ue.get(P)}function L(P,z,J,ue){var de=O(J,ue,!0);de.set(P,z)}function re(P,z){var J=Y(P,z),ue=X(P);if(ue===null)return J;var de=re(ue,z);if(de.length<=0)return J;if(J.length<=0)return de;for(var Fe=new d,xe=[],Oe=0,ce=J;Oe<ce.length;Oe++){var Te=ce[Oe],be=Fe.has(Te);be||(Fe.add(Te),xe.push(Te))}for(var Ue=0,Pe=de;Ue<Pe.length;Ue++){var Te=Pe[Ue],be=Fe.has(Te);be||(Fe.add(Te),xe.push(Te))}return xe}function Y(P,z){var J=[],ue=O(P,z,!1);if(U(ue))return J;for(var de=ue.keys(),Fe=se(de),xe=0;;){var Oe=B(Fe);if(!Oe)return J.length=xe,J;var ce=ne(Oe);try{J[xe]=ce}catch(Te){try{M(Fe)}finally{throw Te}}xe++}}function ee(P){if(P===null)return 1;switch(typeof P){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return P===null?1:6;default:return 6}}function U(P){return P===void 0}function V(P){return P===null}function _e(P){return typeof P=="symbol"}function ie(P){return typeof P=="object"?P!==null:typeof P=="function"}function Z(P,z){switch(ee(P)){case 0:return P;case 1:return P;case 2:return P;case 3:return P;case 4:return P;case 5:return P}var J=z===3?"string":z===5?"number":"default",ue=T(P,s);if(ue!==void 0){var de=ue.call(P,J);if(ie(de))throw new TypeError;return de}return le(P,J==="default"?"number":J)}function le(P,z){if(z==="string"){var J=P.toString;if(Me(J)){var ue=J.call(P);if(!ie(ue))return ue}var de=P.valueOf;if(Me(de)){var ue=de.call(P);if(!ie(ue))return ue}}else{var de=P.valueOf;if(Me(de)){var ue=de.call(P);if(!ie(ue))return ue}var Fe=P.toString;if(Me(Fe)){var ue=Fe.call(P);if(!ie(ue))return ue}}throw new TypeError}function ve(P){return!!P}function Ce(P){return""+P}function ge(P){var z=Z(P,3);return _e(z)?z:Ce(z)}function ye(P){return Array.isArray?Array.isArray(P):P instanceof Object?P instanceof Array:Object.prototype.toString.call(P)==="[object Array]"}function Me(P){return typeof P=="function"}function Ze(P){return typeof P=="function"}function ke(P){switch(ee(P)){case 3:return!0;case 4:return!0;default:return!1}}function T(P,z){var J=P[z];if(J!=null){if(!Me(J))throw new TypeError;return J}}function se(P){var z=T(P,i);if(!Me(z))throw new TypeError;var J=z.call(P);if(!ie(J))throw new TypeError;return J}function ne(P){return P.value}function B(P){var z=P.next();return z.done?!1:z}function M(P){var z=P.return;z&&z.call(P)}function X(P){var z=Object.getPrototypeOf(P);if(typeof P!="function"||P===c||z!==c)return z;var J=P.prototype,ue=J&&Object.getPrototypeOf(J);if(ue==null||ue===Object.prototype)return z;var de=ue.constructor;return typeof de!="function"||de===P?z:de}function ae(){var P={},z=[],J=function(){function xe(Oe,ce,Te){this._index=0,this._keys=Oe,this._values=ce,this._selector=Te}return xe.prototype["@@iterator"]=function(){return this},xe.prototype[i]=function(){return this},xe.prototype.next=function(){var Oe=this._index;if(Oe>=0&&Oe<this._keys.length){var ce=this._selector(this._keys[Oe],this._values[Oe]);return Oe+1>=this._keys.length?(this._index=-1,this._keys=z,this._values=z):this._index++,{value:ce,done:!1}}return{value:void 0,done:!0}},xe.prototype.throw=function(Oe){throw this._index>=0&&(this._index=-1,this._keys=z,this._values=z),Oe},xe.prototype.return=function(Oe){return this._index>=0&&(this._index=-1,this._keys=z,this._values=z),{value:Oe,done:!0}},xe}();return function(){function xe(){this._keys=[],this._values=[],this._cacheKey=P,this._cacheIndex=-2}return Object.defineProperty(xe.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),xe.prototype.has=function(Oe){return this._find(Oe,!1)>=0},xe.prototype.get=function(Oe){var ce=this._find(Oe,!1);return ce>=0?this._values[ce]:void 0},xe.prototype.set=function(Oe,ce){var Te=this._find(Oe,!0);return this._values[Te]=ce,this},xe.prototype.delete=function(Oe){var ce=this._find(Oe,!1);if(ce>=0){for(var Te=this._keys.length,be=ce+1;be<Te;be++)this._keys[be-1]=this._keys[be],this._values[be-1]=this._values[be];return this._keys.length--,this._values.length--,Oe===this._cacheKey&&(this._cacheKey=P,this._cacheIndex=-2),!0}return!1},xe.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=P,this._cacheIndex=-2},xe.prototype.keys=function(){return new J(this._keys,this._values,ue)},xe.prototype.values=function(){return new J(this._keys,this._values,de)},xe.prototype.entries=function(){return new J(this._keys,this._values,Fe)},xe.prototype["@@iterator"]=function(){return this.entries()},xe.prototype[i]=function(){return this.entries()},xe.prototype._find=function(Oe,ce){return this._cacheKey!==Oe&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=Oe)),this._cacheIndex<0&&ce&&(this._cacheIndex=this._keys.length,this._keys.push(Oe),this._values.push(void 0)),this._cacheIndex},xe}();function ue(xe,Oe){return xe}function de(xe,Oe){return Oe}function Fe(xe,Oe){return[xe,Oe]}}function oe(){return function(){function P(){this._map=new f}return Object.defineProperty(P.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),P.prototype.has=function(z){return this._map.has(z)},P.prototype.add=function(z){return this._map.set(z,z),this},P.prototype.delete=function(z){return this._map.delete(z)},P.prototype.clear=function(){this._map.clear()},P.prototype.keys=function(){return this._map.keys()},P.prototype.values=function(){return this._map.values()},P.prototype.entries=function(){return this._map.entries()},P.prototype["@@iterator"]=function(){return this.keys()},P.prototype[i]=function(){return this.keys()},P}()}function $(){var P=16,z=u.create(),J=ue();return function(){function ce(){this._key=ue()}return ce.prototype.has=function(Te){var be=de(Te,!1);return be!==void 0?u.has(be,this._key):!1},ce.prototype.get=function(Te){var be=de(Te,!1);return be!==void 0?u.get(be,this._key):void 0},ce.prototype.set=function(Te,be){var Ue=de(Te,!0);return Ue[this._key]=be,this},ce.prototype.delete=function(Te){var be=de(Te,!1);return be!==void 0?delete be[this._key]:!1},ce.prototype.clear=function(){this._key=ue()},ce}();function ue(){var ce;do ce="@@WeakMap@@"+Oe();while(u.has(z,ce));return z[ce]=!0,ce}function de(ce,Te){if(!t.call(ce,J)){if(!Te)return;Object.defineProperty(ce,J,{value:u.create()})}return ce[J]}function Fe(ce,Te){for(var be=0;be<Te;++be)ce[be]=Math.random()*255|0;return ce}function xe(ce){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(ce)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(ce)):Fe(new Uint8Array(ce),ce):Fe(new Array(ce),ce)}function Oe(){var ce=xe(P);ce[6]=ce[6]&79|64,ce[8]=ce[8]&191|128;for(var Te="",be=0;be<P;++be){var Ue=ce[be];(be===4||be===6||be===8)&&(Te+="-"),Ue<16&&(Te+="0"),Te+=Ue.toString(16).toLowerCase()}return Te}}function he(P){return P.__=void 0,delete P.__,P}})})(Dc||(Dc={}));const vo=class{static register(r,e){let t=vo.sMap.get(r);t?t.push(e):(t=new Array,t.push(e),vo.sMap.set(r,t))}static getTable(r){var n;let e=new Array,t=r;for(;t!=null;){const s=(n=vo.sMap.get(t))!=null?n:[];e=e.concat(s),t=Object.getPrototypeOf(t)}return e}};let zl=vo;zl.sMap=new Map;function J3(){return(r,e,t)=>{zl.register(r,e),Reflect.defineMetadata("PostConstruct",t,r,e)}}function Q3(){return(r,e)=>{zl.register(r,e),Reflect.defineMetadata("AttributeValue",{},r,e)}}const xc="MessageQueue";class em{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(xc,e)}load(){const e=localStorage.getItem(xc);e&&(this._messages=JSON.parse(e))}}class tm{static isMessageResponseReceive(e){return e.type==="message_response"}packMessage(e){return{changed:e,version:G.generateRandomId()}}}var nm=Object.defineProperty,rm=Object.getOwnPropertyDescriptor,Gd=(r,e,t,n)=>{for(var s=n>1?void 0:n?rm(e,t):e,i=r.length-1,o;i>=0;i--)(o=r[i])&&(s=(n?o(e,t,s):o(s))||s);return n&&s&&nm(e,t,s),s};const Xd=class extends tm{initialize(){this.messageQueue=new em,this.status="wait",this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Z0({url:this.config.socketUrl}),this.socket.on(Ur.MESSAGE,r=>{this.checkupReceiveMessage(r.data)}),this.socket.on(Ur.ERROR,()=>{}),this.socket.on(Ur.OPEN,()=>{}),this.socket.on(Ur.CLOSE,()=>{}),this.socket.on(Ur.RETRY,()=>{}),this.socket.on(Ur.DESTROY,()=>{}),this.socket.link())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const r=this.getTopMessage();return(e=JSON.stringify(r))!=null?e:""}checkupReceiveMessage(r){Xd.isMessageResponseReceive(r)&&this.getTopMessage().version===r.message.version&&(this.popTopMessage(),this.globalSendResolve())}pushMessageQueue(r){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(r)),this.sendMessageQueue())}async sendTopMessage(){const r=this.serializeTopMessage();return this.socket.send(r),new Promise(e=>this.globalSendResolve=e)}async sendMessageQueue(){const{messageQueue:r,status:e}=this;if(e==="wait"){for(this.status="work";r.hasMessage();)await this.sendTopMessage();this.status="wait"}return this.status}};let $d=Xd;Gd([Q3()],$d.prototype,"config",2);Gd([J3()],$d.prototype,"initialize",1);var sm={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],defaultFontSize:14,unit:"pt"}},im={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const Cr={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};var Jt=(r=>(r.PointerMove="PointerMove",r.PointerDown="PointerDown",r.PointerUp="PointerUp",r.PointerOut="PointerOut",r.PointerLeave="PointerLeave",r.PointerOver="PointerOver",r.PointerEnter="PointerEnter",r.wheel="MouseWheel",r.KeyDown="KeyDown",r.KeyUp="KeyUp",r))(Jt||{});const Yd=1,om='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',am="0",Ic=1,lm=14;var gt=(r=>(r.DEFAULT="default",r.AUTO="auto",r.CROSSHAIR="crosshair",r.POINTER="pointer",r.MOVE="move",r.EAST_RESIZE="e-resize",r.NORTH_EAST_RESIZE="ne-resize",r.NORTH_WEST_RESIZE="nw-resize",r.NORTH_RESIZE="n-resize",r.SOUTH_EAST_RESIZE="se-resize",r.SOUTH_WEST_RESIZE="sw-resize",r.SOUTH_RESIZE="s-resize",r.WEST_RESIZE="w-resize",r.TEXT="text",r.WAIT="wait",r.HELP="help",r.CELL="cell",r.NONE="none",r.VERTICAL_TEXT="vertical-text",r.NO_DROP="no-drop",r.GRAB="grab",r.GRABBING="grabbing",r.ALL_SCROLL="all-scroll",r.COLUMN_RESIZE="col-resize",r.ROW_RESIZE="row-resize",r.PROGRESS="progress",r.NOT_ALLOWED="not-allowed",r.ZOOM_IN="zoom-in",r.ZOOM_OUT="zoom-out",r))(gt||{});const Ar="rgb(0,0,0)";var Ht=(r=>(r.TOP="t",r.BOTTOM="b",r.LEFT="l",r.RIGHT="r",r))(Ht||{}),Os=(r=>(r[r.UP=0]="UP",r[r.DOWN=1]="DOWN",r))(Os||{}),Ge=(r=>(r.ENGINE="Engine",r.SCENE="Scene",r.BASE_OBJECT="BaseObject",r.SCENE_VIEWER="SceneViewer",r.CANVAS="Canvas",r.VIEWPORT="Viewport",r.LAYER="Layer",r.GROUP="Group",r))(Ge||{});const Oc=r=>({sbr:.5,sbo:r,spr:.5,spo:r});class Hs{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,t,n){this._globalFontMeasureCache.has(e)||(this._globalFontMeasureCache[e]=new Map),this._globalFontMeasureCache[e][t]=n}static clearFontMeasureCache(e){var n;const t=e.split("/");if(t.length===1){const s=t[0];this._globalFontMeasureCache.delete(s)}else if(t.length===2){const s=t[0],i=t[1];(n=this._globalFontMeasureCache.get(s))==null||n.delete(i)}else return!1;return!0}static getFontMeasureCache(e,t){var n;return(n=this._globalFontMeasureCache[e])==null?void 0:n[t]}static autoCleanFontMeasureCache(e=1e6){let t=0,n=!1;for(let s of this._globalFontMeasureCache){const[,i]=s;if(t+=i.size,t>e){n=!0;break}}if(n){let s=0;for(let i of this._globalFontMeasureCache){const[o,a]=i;if(s+=a.size,s>e/2){const l=s-e/2;this._clearMeasureCache(l,a);break}this._globalFontMeasureCache.delete(o)}return!0}return!1}static getBaselineOffsetInfo(e,t){if(this._fontDataMap.size===0)return Oc(t);const n=e.split(",");for(let s of n){s=s.replace(/'/g,"");const i=this._fontDataMap.get(s);if(!i)continue;const{subscriptSizeRatio:o,subscriptOffset:a,superscriptSizeRatio:l,superscriptOffset:u}=i;return{sbr:o,sbo:a*t,spr:l,spo:u*t}}return Oc(t)}static _clearMeasureCache(e,t){let n=0;for(let s of t){const[i]=s;if(n>e)break;t.delete(i),n++}return!0}static getTextSizeByDom(e,t){if(t in this._getTextHeightCache)return this._getTextHeightCache[t];let n=document.getElementById("universheetTextSizeTest");const s="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;";n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`${s};${t}`,n.innerText=e;const i=n.getBoundingClientRect(),o={width:i.width,height:i.height};return this._getTextHeightCache[t]=o,o}static _getBoundingBoxByFont(e,t=28,n=""){const s=this._fontDataMap.get(e);if(!s)return;const{notDefWidth:i,ascender:o,descender:a,typoAscender:l,typoDescender:u,strikeoutPosition:c,subscriptSizeRatio:h,subscriptOffset:f,superscriptSizeRatio:d,superscriptOffset:m,hdmxData:g,glyphHorizonMap:p}=s,_=g==null?void 0:g.indexOf(Math.floor(t)),v=p.get(n.charCodeAt(0));let w=i;if(v){const{width:y,pixelsPerEm:A=[]}=v;_?w=A[_]:w=y}return{width:w*t,ba:o*t,bd:a*t,aba:l*t,abd:u*t,sp:c*t,sbr:h,sbo:f*t,spr:d,spo:m*t}}static _calculateBoundingBoxByMeasureText(e,t){const{width:n,fontBoundingBoxAscent:s,fontBoundingBoxDescent:i,actualBoundingBoxAscent:o,actualBoundingBoxDescent:a}=e;return{width:n,ba:s,bd:i,aba:o,abd:a,sp:(s+i)/2,sbr:.5,sbo:t,spr:.5,spo:t}}static getTextSize(e,t){const{fontString:n,fontSize:s,fontFamily:i}=t;let o=this._getBoundingBoxByFont(i,s);if(!o){const a=this.getMeasureText(e,n);o=this._calculateBoundingBoxByMeasureText(a,s)}return o}static getMeasureText(e,t){if(!this._context){const f=document.createElement("canvas");this._context=f.getContext("2d")}const n=this._context,s=this.getFontMeasureCache(t,e);if(s!=null)return s;n.font=t;const i=n.measureText(e),{width:o,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:u,actualBoundingBoxDescent:c}=i,h={width:o,fontBoundingBoxAscent:a,fontBoundingBoxDescent:l,actualBoundingBoxAscent:u,actualBoundingBoxDescent:c};if(a==null||l==null||Number.isNaN(a)||Number.isNaN(l)){let f=this.getTextSizeByDom(am,t)[1];n.textBaseline==="top"?(h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=f,h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0):n.textBaseline==="middle"?(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=f/2,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=f/2):(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=f)}return this.setFontMeasureCache(t,e,h),h}}Hs._globalFontMeasureCache=new Map;Hs._getTextHeightCache={};Hs._fontDataMap=new Map;var yi=(r=>(r[r.SECTION=0]="SECTION",r[r.PAGE=1]="PAGE",r[r.COLUMN=2]="COLUMN",r))(yi||{}),Lo=(r=>(r[r.PARAGRAPH=0]="PARAGRAPH",r[r.BLOCK=1]="BLOCK",r))(Lo||{}),hn=(r=>(r[r.LETTER=0]="LETTER",r[r.WORD=1]="WORD",r[r.LIST=2]="LIST",r[r.TAB=3]="TAB",r[r.IMAGE=4]="IMAGE",r[r.AT=5]="AT",r[r.MATH=6]="MATH",r[r.MULTI_LINE=7]="MULTI_LINE",r[r.CUSTOM=8]="CUSTOM",r))(hn||{}),Jn=(r=>(r[r.VERTICAL=0]="VERTICAL",r[r.HORIZONTAL=1]="HORIZONTAL",r[r.AUTO=2]="AUTO",r))(Jn||{}),dn=(r=>(r[r.Generic=0]="Generic",r[r.Keyboard=1]="Keyboard",r[r.Mouse=2]="Mouse",r[r.Touch=3]="Touch",r))(dn||{}),Ne=(r=>(r[r.Horizontal=0]="Horizontal",r[r.Vertical=1]="Vertical",r[r.LeftClick=2]="LeftClick",r[r.MiddleClick=3]="MiddleClick",r[r.RightClick=4]="RightClick",r[r.BrowserBack=5]="BrowserBack",r[r.BrowserForward=6]="BrowserForward",r[r.MouseWheelX=7]="MouseWheelX",r[r.MouseWheelY=8]="MouseWheelY",r[r.MouseWheelZ=9]="MouseWheelZ",r[r.DeltaHorizontal=10]="DeltaHorizontal",r[r.DeltaVertical=11]="DeltaVertical",r[r.FakeMove=12]="FakeMove",r))(Ne||{}),en=(r=>(r[r.translate=0]="translate",r[r.resize=1]="resize",r[r.scale=2]="scale",r[r.skew=3]="skew",r[r.flip=4]="flip",r[r.all=5]="all",r))(en||{});class um{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new cm(e)}sampleFrame(e=this.Now()){if(!!this._enabled){if(this._lastFrameTimeMs!=null){let t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class cm{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){let n=this._samples[this._pos];t=n-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(n-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;let t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){let t=this._samples.length;return(e%t+t)%t}}const hm=Math.PI/180,dm=180/Math.PI,kc="rgb(",fm="rgba(",xt=(r,e)=>r?e!=null?`${fm+r.join(",")},${e})`:`${kc+r.join(",")})`:`${kc}0,0,0)`,Er=(r,e)=>{if(G.isNumber(r))return r;if(e&&r&&G.isString(r)&&r.substr(r.length-1,1)==="%"){const t=parseFloat(r)/100;return e*t}return 0},Po=(r,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(r):e.requestAnimationFrame?e.requestAnimationFrame(r):e.msRequestAnimationFrame?e.msRequestAnimationFrame(r):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(r):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(r):e.oRequestAnimationFrame?e.oRequestAnimationFrame(r):window.setTimeout(r,16)),gm=(r,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(r):e.requestAnimationFrame?e.cancelAnimationFrame(r):e.msRequestAnimationFrame?e.msCancelAnimationFrame(r):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(r):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(r):e.oRequestAnimationFrame?e.oCancelAnimationFrame(r):window.clearTimeout(r)),jd=()=>{let r=document.createElement("canvas");try{r.style=r.style||{}}catch(e){console.error(e)}return r},mm=r=>r*dm,gi=r=>r*hm,Nc=()=>{let r="pointer";return typeof window!="undefined"&&!window.PointerEvent&&typeof navigator!="undefined"&&!navigator.pointerEnabled&&(r="mouse"),G.isTablet()&&!G.isIPhone()&&!(document&&"ontouchend"in document)&&(r="mouse"),r},pm=()=>G.getBrowserType()==="safari",_m=(r="obj",e=4)=>{let t=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),n="";for(let i=0;i<e;i++)n+=t[Math.round(Math.random()*(t.length-1))];let s=new Date().getTime();return`${r}_${n}_${s}`};function Kd(r){return Object.prototype.toString.apply(r)}function Zd(r){return Kd(r)==="[object Function]"}function Mc(r){return Kd(r)==="[object String]"}function rl(r,e){return e=10**e,Math.round(r*e)/e}function Le(r,e){return Math.round(r*e)/e}function Wl(r,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:t,defaultFontSize:n}=e;if(!r)return{fontString:`${n}px  ${t[0]}`,fontSize:n,fontFamily:t[0]};let s=ni.ITALIC;(r.it===0||r.it===void 0)&&(s=ni.NORMAL);let i=ni.BOLD;(r.bl===0||r.bl===void 0)&&(i=ni.NORMAL);let o=n;r.fs&&(o=Math.ceil(r.fs));let a=t[0];if(r.ff){let c=r.ff;c=c.replace(/"/g,"").replace(/'/g,""),c.indexOf(" ")>-1&&(c=`"${c}"`),c==null&&(c=t[0]),a=c}const{va:l}=r;if(l===un.SUBSCRIPT||l===un.SUPERSCRIPT){const c=Hs.getBaselineOffsetInfo(a,o),{sbr:h,spr:f}=c;o*=l===un.SUBSCRIPT?h:f}return{fontString:`${s} ${i} ${o}px ${a}, ${om} `,fontSize:o,fontFamily:a}}function qd(r){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(r)}function Jd(r){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(r)}function Qd(r){return!!/[\u0180-\u024F]/gi.exec(r)}function bm(r){return!!/\s+|\t+/g.exec(r)}let Zi;function vm(){if(Zi)return Zi;let r=56;for(;r<2e3;r++)if(matchMedia(`(max-resolution: ${r}dpi)`).matches===!0)return r;return Zi=r,setTimeout(()=>{Zi=null},1e3),r}const Cm=72;function Em(r){return r*(Cm/vm())}function Us(r){const{scaleX:e=1,scaleY:t=1}=r;return Math.max(e,t)}function Ho(r,e,t,n){const s=r-1,i=e-1;let o=t[s]||0,a=t[r],l=n[i]||0,u=n[e];return{startY:o,endY:a,startX:l,endX:u}}function ri(r,e,t,n,s){let{startY:i,endY:o,startX:a,endX:l}=Ho(r,e,t,n);const{isMerged:u,isMergedMainCell:c,newEndRow:h,newEndColumn:f,mergeRow:d,mergeColumn:m}=wm(r,e,s);let g={startRow:d,startColumn:m,endRow:h,endColumn:f,startY:0,endY:0,startX:0,endX:0};if(u&&d!==-1&&m!==-1){let p=t[d-1]||0,_=t[h],v=n[m-1]||0,w=n[f];g={...g,startY:p,endY:_,startX:v,endX:w}}else!u&&h!==-1&&f!==-1&&(o=t[h]||0,l=n[f]||0);return{isMerged:u,isMergedMainCell:c,row:r,column:e,startY:i,endY:o,startX:a,endX:l,mergeInfo:g}}function wm(r,e,t){let n=!1,s=!1,i=-1,o=-1,a=-1,l=-1;return t==null||t.forEach((u,c)=>{let h=!1;if(c==null||c.forEach((f,d)=>{const{startRow:m,endRow:g,startColumn:p,endColumn:_}=d;if(r===m&&e===p)return i=g,o=_,a=m,l=p,h=!0,s=!0,!1;if(r>=m&&r<=g&&e>=p&&e<=_)return i=g,o=_,a=m,l=p,h=!0,n=!0,!1}),h)return!1}),{isMergedMainCell:s,isMerged:n,newEndRow:i,newEndColumn:o,mergeRow:a,mergeColumn:l}}function Fc(r,e,t,n,s){const{startY:i,endY:o,startX:a,endX:l}=r;return r.startY=Le(i+t,s),r.endY=Le(o+t,s),r.startX=Le(a+e,n),r.endX=Le(l+e,n),{...r}}function Tm(r,e){return!(r.left>e.right||r.top>e.bottom||e.left>r.right||e.top>r.bottom)}function ym(r){const e=document.createElement("style");document.head.appendChild(e);const t=e.sheet;for(let n of r)t==null||t.insertRule(n,t.cssRules.length)}function Sm(r){for(let e=0,t=document.head.childNodes.length;e<t;e++){const n=document.head.childNodes[e];if(n.nodeName==="STYLE"&&n.textContent&&n.textContent.indexOf(r)>-1)return!0}return!1}function is(r){return Number(r.replace(/px/gi,""))}function Am(r){const e=getComputedStyle(r),{borderTopWidth:t,borderLeftWidth:n,borderRightWidth:s,borderBottomWidth:i,width:o,height:a}=e;return{top:is(t),left:is(n),right:is(s),bottom:is(i),width:is(o),height:is(a)}}class Re{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=this.x|0;return e=e*397^(this.y|0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return Re.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new Re(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new Re(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new Re(this.x-e.x,this.y-e.y)}subtractByPoint(e,t){return new Re(this.x-e,this.y-t)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new Re(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new Re(this.x*e,this.y*t)}divide(e){return new Re(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new Re(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new Re(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new Re(Math.floor(this.x),Math.floor(this.y))}fract(){return new Re(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),n=Math.sin(e),s=t*this.x-n*this.y,i=n*this.x+t*this.y;return this.x=s,this.y=i,this}rotateToRef(e,t){const n=Math.cos(e),s=Math.sin(e);return t.x=n*this.x-s*this.y,t.y=s*this.x+n*this.y,this}rotateByPoint(e,t=Re.create(0,0)){const n=Math.cos(e),s=Math.sin(e),i=t.x+(this.x-t.x)*n-(this.y-t.y)*s,o=t.y+(this.x-t.x)*s+(this.y-t.y)*n;return this.x=i,this.y=o,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),n=Math.atan2(this.y,this.x),s=-e+n;return this.x=t*Math.cos(s),this.y=t*Math.sin(s),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Re.NormalizeToRef(this,this),this}clone(){return new Re(this.x,this.y)}static Zero(){return new Re(0,0)}static One(){return new Re(1,1)}static FromArray(e,t=0){return new Re(e[t],e[t+1])}static FromArrayToRef(e,t,n){n.x=e[t],n.y=e[t+1]}static CatmullRom(e,t,n,s,i){let o=i*i,a=i*o,l=.5*(2*t.x+(-e.x+n.x)*i+(2*e.x-5*t.x+4*n.x-s.x)*o+(-e.x+3*t.x-3*n.x+s.x)*a),u=.5*(2*t.y+(-e.y+n.y)*i+(2*e.y-5*t.y+4*n.y-s.y)*o+(-e.y+3*t.y-3*n.y+s.y)*a);return new Re(l,u)}static Clamp(e,t,n){let s=e.x;s=s>n.x?n.x:s,s=s<t.x?t.x:s;let i=e.y;return i=i>n.y?n.y:i,i=i<t.y?t.y:i,new Re(s,i)}static Hermite(e,t,n,s,i){let o=i*i,a=i*o,l=2*a-3*o+1,u=-2*a+3*o,c=a-2*o+i,h=a-o,f=e.x*l+n.x*u+t.x*c+s.x*h,d=e.y*l+n.y*u+t.y*c+s.y*h;return new Re(f,d)}static Hermite1stDerivative(e,t,n,s,i){let o=Re.Zero();return this.Hermite1stDerivativeToRef(e,t,n,s,i,o),o}static Hermite1stDerivativeToRef(e,t,n,s,i,o){const a=i*i;o.x=(a-i)*6*e.x+(3*a-4*i+1)*t.x+(-a+i)*6*n.x+(3*a-2*i)*s.x,o.y=(a-i)*6*e.y+(3*a-4*i+1)*t.y+(-a+i)*6*n.y+(3*a-2*i)*s.y}static Lerp(e,t,n){let s=e.x+(t.x-e.x)*n,i=e.y+(t.y-e.y)*n;return new Re(s,i)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=Re.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let n=e.length();n!==0&&(t.x=e.x/n,t.y=e.y/n)}static Minimize(e,t){let n=e.x<t.x?e.x:t.x,s=e.y<t.y?e.y:t.y;return new Re(n,s)}static Maximize(e,t){let n=e.x>t.x?e.x:t.x,s=e.y>t.y?e.y:t.y;return new Re(n,s)}static Transform(e,t,n=!1){const s=t,i=e;return n?new Re(s[0]*i.x+s[2]*i.y,s[1]*i.x+s[3]*i.y):new Re(s[0]*i.x+s[2]*i.y+s[4],s[1]*i.x+s[3]*i.y+s[5])}static PointInTriangle(e,t,n,s){let i=.5*(-n.y*s.x+t.y*(-n.x+s.x)+t.x*(n.y-s.y)+n.x*s.y),o=i<0?-1:1,a=(t.y*s.x-t.x*s.y+(s.y-t.y)*e.x+(t.x-s.x)*e.y)*o,l=(t.x*n.y-t.y*n.x+(t.y-n.y)*e.x+(n.x-t.x)*e.y)*o;return a>0&&l>0&&a+l<2*i*o}static Distance(e,t){return Math.sqrt(Re.DistanceSquared(e,t))}static DistanceSquared(e,t){let n=e.x-t.x,s=e.y-t.y;return n*n+s*s}static Center(e,t){return Re.CenterToRef(e,t,Re.Zero())}static CenterToRef(e,t,n){return n.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,n){let s=Re.DistanceSquared(t,n);if(s===0)return Re.Distance(e,t);let i=n.subtract(t),o=Math.max(0,Math.min(1,Re.Dot(e.subtract(t),i)/s)),a=t.add(i.multiplyByFloats(o,o));return Re.Distance(e,a)}static create(e,t){return new Re(e,t)}}const Da=[1,0,0,1,0,0];class kt{constructor(e=Da){this.dirty=!1,this._m=e&&e.slice()||Da}static create(e=Da){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new kt(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,t=!1){const n=this._m;let s=n[0]*e.x+n[2]*e.y,i=n[1]*e.x+n[3]*e.y;return t?new Re(s,i):new Re(s+n[4],i+n[5])}translate(e,t){return this._m[4]+=this._m[0]*e+this._m[2]*t,this._m[5]+=this._m[1]*e+this._m[3]*t,this}scale(e,t){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=t,this._m[3]*=t,this}rotate(e){const t=gi(e);let n=Math.cos(t),s=Math.sin(t),i=this._m[0]*n+this._m[2]*s,o=this._m[1]*n+this._m[3]*s,a=this._m[0]*-s+this._m[2]*n,l=this._m[1]*-s+this._m[3]*n;return this._m[0]=i,this._m[1]=o,this._m[2]=a,this._m[3]=l,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,t){let n=this._m[0]+this._m[2]*t,s=this._m[1]+this._m[3]*t,i=this._m[2]+this._m[0]*e,o=this._m[3]+this._m[1]*e;return this._m[0]=n,this._m[1]=s,this._m[2]=i,this._m[3]=o,this}multiply(e){let t=this._m[0]*e._m[0]+this._m[2]*e._m[1],n=this._m[1]*e._m[0]+this._m[3]*e._m[1],s=this._m[0]*e._m[2]+this._m[2]*e._m[3],i=this._m[1]*e._m[2]+this._m[3]*e._m[3],o=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],a=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=t,this._m[1]=n,this._m[2]=s,this._m[3]=i,this._m[4]=o,this._m[5]=a,this}invert(){let e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),t=this._m[3]*e,n=-this._m[1]*e,s=-this._m[2]*e,i=this._m[0]*e,o=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),a=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=t,this._m[1]=n,this._m[2]=s,this._m[3]=i,this._m[4]=o,this._m[5]=a,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map(t=>rl(t,e))}setAbsolutePosition(e){let t=this._m[0],n=this._m[1],s=this._m[2],i=this._m[3],o=this._m[4],a=this._m[5],l=(t*(e.y-a)-n*(e.x-o))/(t*i-n*s),u=(e.x-o-s*l)/t;return this.translate(u,l)}decompose(){let e=this._m[0],t=this._m[1],n=this._m[2],s=this._m[3],i=this._m[4],o=this._m[5],a=e*s-t*n,l={x:i,y:o,angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||t!==0){let u=Math.sqrt(e*e+t*t);l.angle=t>0?Math.acos(e/u):-Math.acos(e/u),l.scaleX=u,l.scaleY=a/u,l.skewX=(e*n+t*s)/a,l.skewY=0}else if(n!==0||s!==0){let u=Math.sqrt(n*n+s*s);l.angle=Math.PI/2-(s>0?Math.acos(-n/u):-Math.acos(n/u)),l.scaleX=a/u,l.scaleY=u,l.skewX=0,l.skewY=(e*n+t*s)/a}return l.angle=mm(l.angle),l}makeBoundingBoxFromPoints(e){if(this)for(let c=0;c<e.length;c++)e[c]=this.applyPoint(e[c]);const t=[e[0].x,e[1].x,e[2].x,e[3].x],n=Math.min(...t),i=Math.max(...t)-n,o=[e[0].y,e[1].y,e[2].y,e[3].y],a=Math.min(...o),u=Math.max(...o)-a;return{left:n,top:a,width:i,height:u,points:e}}composeMatrix(e){const t=new kt([1,0,0,1,e.left||0,e.top||0]);return e.angle&&t.rotate(e.angle),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&t.multiply(this._calcDimensionsMatrix(e)),this._m=t.getMatrix(),this}_calcDimensionsMatrix(e){var i,o;const t=(i=e.scaleX)!=null?i:1,n=(o=e.scaleY)!=null?o:1,s=new kt([e.flipX?-t:t,0,0,e.flipY?-n:n,0,0]);return e.skewX&&s.multiply(new kt([1,0,Math.tan(gi(e.skewX)),1,0,0])),e.skewY&&s.multiply(new kt([1,Math.tan(gi(e.skewY)),0,1,0,0])),s}clone(){return new kt([...this._m])}}function ef(r,e,t){let n=0,s=0,i=0,o=0;const{startX:a,startY:l,endX:u,endY:c}=t;e===Ht.TOP?(n=a,s=l,i=u,o=l):e===Ht.BOTTOM?(n=a,s=c,i=u,o=c):e===Ht.LEFT?(n=a,s=l,i=a,o=c):e===Ht.RIGHT&&(n=u,s=l,i=u,o=c),r.beginPath(),r.moveTo(n,s),r.lineTo(i,o),r.stroke()}function tf(r,e){e===C.HAIR?r.setLineDash([1,2]):e===C.DASH_DOT_DOT||e===C.MEDIUM_DASH_DOT_DOT?r.setLineDash([2,2,5,2,2]):e===C.DASH_DOT||e===C.MEDIUM_DASH_DOT||e===C.SLANT_DASH_DOT?r.setLineDash([2,5,2]):e===C.DOTTED?r.setLineDash([2]):e===C.DASHED||e===C.MEDIUM_DASHED?r.setLineDash([3]):r.setLineDash([0])}function nf(r){let e=1;return r===C.MEDIUM||r===C.MEDIUM_DASH_DOT||r===C.MEDIUM_DASHED||r===C.MEDIUM_DASH_DOT_DOT?e=2:r===C.THICK&&(e=3),e}function pr(r,e,t,n,s=Re.create(0,0)){const i=r.add(e).rotateByPoint(n),o=i.subtract(e),a=n-t;return o.rotateByPoint(a,i).add(s).transformCoordinateOnRotate(a)}function rf(r){return r>0?Os.DOWN:Os.UP}function sf(r,e,t){const n=[];let s=0,i=0,o=0,a=0,l=0;const u=rf(t),c=r.length;t=Math.abs(t);const h=Math.tan(t),f=Math.sin(t),d=Math.cos(t);if(u===Os.UP){let m=0;for(let g=0;g<c;g++){const p=r[g],{lineHeight:_=0}=p;m+=g===0?0:_;const v=(_/h+e)*f;n.push(m/h),v>i&&(i=v),g===0&&(o+=_*f,l+=_*d)}o+=m/f+e*d,l-=i}else{let m=0,g=-1;const p=[];for(let w=c-1;w>=0;w--){const y=r[w],{lineHeight:A=0}=y,I=A/h,R=(e+I)*f;p.unshift(A/h),R>i&&(i=R,m=I,g=w),w===0?o+=A*f:w===c-1?o+=e*d+A/f:o+=A/f}let _=r[g].lineHeight||0,v=0;for(let w=g+1;w<=c-1;w++){const y=r[w],{lineHeight:A=0}=y;_+=A,v+=p[w]||0,n[w]=-v}v=0;for(let w=g-1;w>=0;w--){const y=r[w],{lineHeight:A=0}=y;v+=p[w+1]||0,n[w]=v,s+=A}n[g]=0,c===1&&(o+=e*d),a=_/f-m*d}return{rotateTranslateXList:n,rotatedHeight:i,rotatedWidth:o,fixOffsetX:a,fixOffsetY:l,rotateTranslateY:s}}const Rm=[new Re(0,0),new Re(1,1)];class Dm{constructor(e=Rm){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const t=[];for(let n=1;n<this._lines.length;n++){const s=this._lines[n-1],i=this._lines[n];for(let o=1;o<e.length;o++){const a=this._lines[n-1],l=this._lines[n],u=this._intersection({from:s,to:i},{from:a,to:l});u&&t.push(u)}}return t}_intersection(e,t){const n=e.from,s=e.to,i=t.from,o=t.to;let a=(n.x-i.x)*(s.y-i.y)-(n.y-i.y)*(s.x-i.x),l=(n.x-o.x)*(s.y-o.y)-(n.y-o.y)*(s.x-o.x);if(a*l>=0)return!1;let u=(i.x-n.x)*(o.y-n.y)-(i.y-n.y)*(o.x-n.x),c=u+a-l;if(u*c>=0)return!1;let h=u/(l-a),f=h*(s.x-n.x),d=h*(s.y-n.y);return new Re(n.x+f,n.y+d)}}const xm="documentCustomBlock",Im="documentCustomBullet";function Om(r,e,t,n,s,i){if(!i)return[];const o=i.getPluginManager().getPluginByName(xm);return o?o.dealWidthCustomBlock(r,e,t,n,s):[]}function km(r,e,t,n){if(!n)return"";const s=n.getPluginManager().getPluginByName(Im);return s?s.dealWidthCustomBulletOrderedSymbol(r,e,t):""}const sl=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class Jo{constructor(e){this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new kt,this._dirty=!0,this._cursor=gt.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this.isInGroup=!1,this.onTransformChangeObservable=new Ae,this.onPointerDownObserver=new Ae,this.onPointerMoveObserver=new Ae,this.onPointerUpObserver=new Ae,this.onDblclickObserver=new Ae,this.onMouseWheelObserver=new Ae,this.onPointerOutObserver=new Ae,this.onPointerLeaveObserver=new Ae,this.onPointerOverObserver=new Ae,this.onPointerEnterObserver=new Ae,this.onIsAddedToParentObserver=new Ae,this.onDisposeObserver=new Ae,e?this._oKey=e:this._oKey=_m()}makeDirty(e=!0){return this._dirty=e,e&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout(()=>{var t;(t=this.parent)==null||t.makeDirty(e)},0)),this}makeDirtyNoDebounce(e=!0){var t;return this._dirty=e,e&&((t=this.parent)==null||t.makeDirty(e)),this}isDirty(){return this._dirty}get transform(){return this._transform}set transform(e){this._transform=e}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return Ge.BASE_OBJECT}translate(e,t){const n=this.top;t!==void 0&&(this.top=t);const s=this.left;return e!==void 0&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:s}}),this}resize(e,t){const n=this.width;e!==void 0&&(this.width=e);const s=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:s}}),this}scale(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX=e);const s=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:s}}),this}skew(e,t){const n=e;e!==void 0&&(this.skewX=e);const s=t;return t!==void 0&&(this.skewY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:s}}),this}flip(e,t){const n=e;e!==void 0&&(this.flipX=e);const s=t;return t!==void 0&&(this.flipY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:s}}),this}transformByState(e){const t=Object.keys(e),n={};if(t.length!==0)return t.forEach(s=>{e[s]!==void 0&&(n[s]=this[s],this[s]=e[s])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.all,value:e,preValue:n}),this}isRender(e){return this._forceRender?!1:e&&!this.isInGroup}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}_setTransForm(){const e=kt.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this._makeDirtyMix()}get top(){return this._top}set top(e){var t;this._topOrigin=e,this._top=Er(e,(t=this._parent)==null?void 0:t.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Er(e,(t=this._parent)==null?void 0:t.width)}get width(){return this._width}set width(e){var t;this._widthOrigin=e,this._width=Er(e,(t=this._parent)==null?void 0:t.width)}get height(){return this._height}set height(e){var t;this._heightOrigin=e,this._height=Er(e,(t=this._parent)==null?void 0:t.height)}get strokeWidth(){return this._strokeWidth}set strokeWidth(e){this._strokeWidth=e}get angle(){return this._angle}set angle(e){this._angle=e}get scaleX(){return this._scaleX}set scaleX(e){this._scaleX=e}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY=e}get ancestorScaleX(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}set skewX(e){this._skewX=e}get skewY(){return this._skewY}set skewY(e){this._skewY=e}get flipX(){return this._flipX}set flipX(e){this._flipX=e}get flipY(){return this._flipY}set flipY(e){this._flipY=e}get parent(){return this._parent}set parent(e){this._parent=e}getParent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e}get evented(){return this._evented}set evented(e){this._evented=e}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}set debounceParentDirty(e){this._debounceParentDirty=e}get isTransformer(){return this._isTransformer}set isTransformer(e){this._isTransformer=e}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(e,t){}isHit(e){const t=this._getInverseCoord(e);return t.x>=-this.strokeWidth/2&&t.x<=this.width+this.strokeWidth/2&&t.y>=-this.strokeWidth/2&&t.y<=this.height+this.strokeWidth/2}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}clear(e){this[`on${e}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(e){var t,n;return(t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerMove(e),!1)}triggerPointerDown(e){var t,n;return(t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerDown(e),!1)}triggerPointerUp(e){var t,n;return(t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerUp(e),!1)}triggerDblclick(e){var t,n;return(t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerDblclick(e),!1)}triggerMouseWheel(e){var t,n;return(t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerMouseWheel(e),!1)}triggerPointerOut(e){var t,n;return(t=this.onPointerOutObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerOut(e),!1)}triggerPointerLeave(e){var t,n;return(t=this.onPointerLeaveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerLeave(e),!1)}triggerPointerOver(e){var t;return this.onPointerOverObserver.notifyObservers(e)?!0:((t=this._parent)==null||t.triggerPointerOver(e),!1)}triggerPointerEnter(e){var t,n;return(t=this.onPointerEnterObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((n=this._parent)==null||n.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),(e=this.parent)==null||e.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const e={};return sl.forEach(t=>{this[t]&&(e[t]=this[t])}),e}getScene(){let e=this.parent;if(e!=null){if(e.classType===Ge.SCENE)return e;for(;e;){if(e.classType===Ge.SCENE)return e;e=e.getParent()}}}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(gt.DEFAULT)}setCursor(e){var t;this._cursor=e,(t=this.getScene())==null||t.setCursor(e)}getEngine(){let e=this.getParent();for(;e!=null;){if(e===Ge.ENGINE)return e;e=e.getParent()}return null}}function vs(r){const e=r.getScene(),t=r.getViewportByCoord(e);let n=0,s=0;if(!t)return{scrollX:n,scrollY:s};const i=t.getActualScroll(t.scrollX,t.scrollY);return{scrollX:i.x,scrollY:i.y}}function Nm(r){let e=r.getBoundingClientRect(),t=document.body,n=document.documentElement,s=window.pageYOffset||n.scrollTop||t.scrollTop,i=window.pageXOffset||n.scrollLeft||t.scrollLeft,o=n.clientTop||t.clientTop,a=n.clientLeft||t.clientLeft,l=e.top+s-o,u=e.left+i-a;return{top:l,left:u}}function of(r,e){const t=r.transform.clone().invert().applyPoint(e.tl),n=r.transform.clone().invert().applyPoint(e.tr),s=r.transform.clone().invert().applyPoint(e.bl),i=r.transform.clone().invert().applyPoint(e.br),o=[t.x,n.x,s.x,i.x],a=[t.y,n.y,s.y,i.y],l=Math.max(...o),u=Math.min(...o),c=Math.max(...a),h=Math.min(...a);return{minX:u,maxX:l,minY:h,maxY:c}}function af(){let r=1,t=jd().getContext("2d");return r=(()=>{let n=window.devicePixelRatio||1,s=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return n/s})(),r<1?1:Math.ceil(r*10)/10}class Bi{constructor(e){this._pixelRatio=1,this._width=0,this._height=0,this.isCache=!1,e=e||{},this._canvasEle=jd(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,t,n){this._pixelRatio=n||af(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),t&&(this._height=t,this._canvasEle.height=t*this._pixelRatio,this._canvasEle.style.height=`${t}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){this._width===0||this._height===0||(e<1&&(e=1),this.setSize(this._width,this._height,e))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,t){try{return this._canvasEle.toDataURL(e,t)}catch{try{return this._canvasEle.toDataURL()}catch(s){const{message:i}=s;return console.error(`Unable to get data URL. ${i} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class Mm{constructor(e=100,t=100){this._canvas=new Bi,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onInputChangedObservable=new Ae,this.renderEvenInBackground=!0,this._usingSafari=pm(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new um,this.onBeginFrameObservable=new Ae,this.onEndFrameObservable=new Ae,this.onTransformChangeObservable=new Ae,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=navigator.userAgent.indexOf("Firefox")!==-1,this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,t),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return Ge.ENGINE}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const t=e.sceneKey;return this.hasScene(t)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[t]=e,e}setActiveScene(e){const t=this.getScene(e);return t&&(this._activeScene=t),t}hasActiveScene(){return this._activeScene!=null}get activeScene(){return this._activeScene}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:e,height:t}=Am(this._container);this.resizeBySize(e,t)}resizeBySize(e,t){const n=this.width,s=this.height;this._canvas.setSize(e,t),this.onTransformChangeObservable.notifyObservers({type:en.resize,value:{width:e,height:t},preValue:{width:n,height:s}})}dispose(){const e=this.getScenes();Object.keys(e).forEach(s=>{e[s].dispose()});const n=Nc();this._canvasEle.removeEventListener(`${n}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${n}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${n}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(e){const t=this.getScenes();if(t[e]){const n=t[e];return delete t[e],n}}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Po(this._renderFunction)))}get requestNewFrameHandler(){return this._requestNewFrameHandler}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Po(this._renderFunction):this._renderingQueueLaunched=!1}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}get frameId(){return this._frameId}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){let t=this._activeRenderLoops[e];t()}}_handleKeyboardAction(){const e=n=>{let s=n;s.deviceType=dn.Keyboard,s.inputIndex=n.keyCode,s.previousState=0,s.currentState=1,this.onInputChangedObservable.notifyObservers(s)},t=n=>{let s=n;s.deviceType=dn.Keyboard,s.inputIndex=n.keyCode,s.previousState=1,s.currentState=0,this.onInputChangedObservable.notifyObservers(s)};this._canvasEle.addEventListener("keydown",e),this._canvasEle.addEventListener("keyup",t)}_handlePointerAction(){const e=Nc();this._pointerMoveEvent=t=>{const n=this.__getPointerType(t),s=this.__pointer[Ne.Horizontal],i=this.__pointer[Ne.Vertical],o=this.__pointer[Ne.DeltaHorizontal],a=this.__pointer[Ne.DeltaVertical];this.__pointer[Ne.Horizontal]=t.clientX,this.__pointer[Ne.Vertical]=t.clientY,this.__pointer[Ne.DeltaHorizontal]=t.movementX,this.__pointer[Ne.DeltaVertical]=t.movementY;let l=t;l.deviceType=n,s!==t.clientX&&(l.inputIndex=Ne.Horizontal,l.previousState=s,l.currentState=this.__pointer[Ne.Horizontal],this.onInputChangedObservable.notifyObservers(l)),i!==t.clientY&&(l.inputIndex=Ne.Vertical,l.previousState=i,l.currentState=this.__pointer[Ne.Vertical],this.onInputChangedObservable.notifyObservers(l)),this.__pointer[Ne.DeltaHorizontal]!==0&&(l.inputIndex=Ne.DeltaHorizontal,l.previousState=o,l.currentState=this.__pointer[Ne.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(l)),this.__pointer[Ne.DeltaVertical]!==0&&(l.inputIndex=Ne.DeltaVertical,l.previousState=a,l.currentState=this.__pointer[Ne.DeltaVertical],this.onInputChangedObservable.notifyObservers(l)),!this._usingSafari&&t.button!==-1&&(l.inputIndex=t.button+2,l.previousState=this.__pointer[t.button+2],this.__pointer[t.button+2]=this.__pointer[t.button+2]?0:1,l.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(l))},this._pointerDownEvent=t=>{const n=this.__getPointerType(t),s=this.__pointer[Ne.Horizontal],i=this.__pointer[Ne.Vertical],o=this.__pointer[t.button+2];n===dn.Mouse?(this.__mouseId===-1&&(t.pointerId===void 0?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=t.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):t.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(t.pointerId),this.__pointer[Ne.Horizontal]=t.clientX,this.__pointer[Ne.Vertical]=t.clientY,this.__pointer[t.button+2]=1;let a=t;a.deviceType=n,s!==t.clientX&&(a.inputIndex=Ne.Horizontal,a.previousState=s,a.currentState=this.__pointer[Ne.Horizontal],this.onInputChangedObservable.notifyObservers(a)),i!==t.clientY&&(a.inputIndex=Ne.Vertical,a.previousState=i,a.currentState=this.__pointer[Ne.Vertical],this.onInputChangedObservable.notifyObservers(a)),a.inputIndex=t.button+2,a.previousState=o,a.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(a)},this._pointerUpEvent=t=>{const n=this.__getPointerType(t),s=this.__pointer[Ne.Horizontal],i=this.__pointer[Ne.Vertical],o=this.__pointer[t.button+2];this.__pointer[Ne.Horizontal]=t.clientX,this.__pointer[Ne.Vertical]=t.clientY,this.__pointer[t.button+2]=0;let a=t;a.deviceType=n,s!==t.clientX&&(a.inputIndex=Ne.Horizontal,a.previousState=s,a.currentState=this.__pointer[Ne.Horizontal],this.onInputChangedObservable.notifyObservers(a)),i!==t.clientY&&(a.inputIndex=Ne.Vertical,a.previousState=i,a.currentState=this.__pointer[Ne.Vertical],this.onInputChangedObservable.notifyObservers(a)),a.inputIndex=t.button+2,a.previousState=o,a.currentState=this.__pointer[t.button+2],n===dn.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):t.pointerId&&this._canvasEle.hasPointerCapture(t.pointerId)&&this._canvasEle.releasePointerCapture(t.pointerId),this.onInputChangedObservable.notifyObservers(a),n!==dn.Mouse&&(this.__pointer={})},this._pointerBlurEvent=t=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=t=>{const n=dn.Mouse;let s=this.__pointer[Ne.MouseWheelX],i=this.__pointer[Ne.MouseWheelY],o=this.__pointer[Ne.MouseWheelZ];this.__pointer[Ne.MouseWheelX]=t.deltaX||0,this.__pointer[Ne.MouseWheelY]=t.deltaY||t.wheelDelta||0,this.__pointer[Ne.MouseWheelZ]=t.deltaZ||0;let a=t;a.deviceType=n,this.__pointer[Ne.MouseWheelX]!==0&&(a.inputIndex=Ne.MouseWheelX,a.previousState=s,a.currentState=this.__pointer[Ne.MouseWheelX],this.onInputChangedObservable.notifyObservers(a)),this.__pointer[Ne.MouseWheelY]!==0&&(a.inputIndex=Ne.MouseWheelY,a.previousState=i,a.currentState=this.__pointer[Ne.MouseWheelY],this.onInputChangedObservable.notifyObservers(a)),this.__pointer[Ne.MouseWheelZ]!==0&&(a.inputIndex=Ne.MouseWheelZ,a.previousState=o,a.currentState=this.__pointer[Ne.MouseWheelZ],this.onInputChangedObservable.notifyObservers(a))},this._canvasEle.addEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,this._getPassive()?{passive:!1}:!1)}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const t=()=>{};try{const n={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",t,n),this._canvasEle.removeEventListener("test",t,n)}catch{}return e}__getPointerType(e){let t=dn.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(t=dn.Touch),t}}class il{constructor(e,t=[],n=1){this._scene=e,this._zIndex=n,this._objects=[],this.addObjects(t)}static create(e,t=[],n=1e3){return new this(e,t,n)}get scene(){return this._scene}get zIndex(){return this._zIndex}getObjectsByOrder(){const e=[];this._objects.sort(Ft);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(Ft);for(let t of this._objects)t.classType!==Ge.GROUP&&t.visible&&e.push(t);return e}getObjects(){return this._objects}addObject(e){if(e.classType===Ge.GROUP){const t=e.getObjects();for(let n of t)this.scene.getObject(n.oKey)||(this._objects.push(n),this.scene.setObjectBehavior(n))}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),this}removeObject(e){const t=this.getObjects(),n=t.length;if(e instanceof Jo){for(let s=0;s<n;s++)if(t[s]===e){t.splice(s,1);return}}else for(let s=0;s<n;s++)if(t[s].oKey===e){t.splice(s,1);return}}addObjects(e){return e.forEach(t=>{this.addObject(t)}),this}clear(){this._objects=[]}dispose(){this.getObjects().forEach(e=>{e.dispose()}),this.clear()}}const Co=class{constructor(r){this._alreadyAttached=!1,this._startingPosition=new Re(1/0,1/0),this._doubleClickOccurred=0,this._scene=r}_getCurrentObject(r,e){var t;return(t=this._scene)==null?void 0:t.pick(Re.FromArray([r,e]))}_checkDirectSceneEventTrigger(r,e){let t=!1;e==null&&(t=!0);let n=!0;if(e&&e.classType===Ge.BASE_OBJECT){const s=e.getScene();s&&(n=s.getParent().classType!==Ge.SCENE_VIEWER)}return!this._scene.evented&&r&&n||t}mouseLeaveEnterHandler(r,e){var t;if(r==null)(t=this._currentMouseEnterPicked)==null||t.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(r!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=r,n==null||n.triggerPointerLeave(e),r==null||r.triggerPointerEnter(e)}}attachControl(r=!0,e=!0,t=!0,n=!0){const s=this._scene.getEngine();!s||(this._onPointerMove=i=>{i.pointerId===void 0&&(i.pointerId=0);const o=this._getCurrentObject(i.offsetX,i.offsetY),a=o==null?void 0:o.triggerPointerMove(i);this.mouseLeaveEnterHandler(o,i),this._checkDirectSceneEventTrigger(!a,o)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(i)},this._onPointerDown=i=>{i.pointerId===void 0&&(i.pointerId=0);const o=this._getCurrentObject(i.offsetX,i.offsetY),a=o==null?void 0:o.triggerPointerDown(i);this._checkDirectSceneEventTrigger(!a,o)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(i)},this._onPointerUp=i=>{i.pointerId===void 0&&(i.pointerId=0);const o=this._getCurrentObject(i.offsetX,i.offsetY),a=o==null?void 0:o.triggerPointerUp(i);this._checkDirectSceneEventTrigger(!a,o)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(i),this._prePointerDoubleClick(i)},this._onMouseWheel=i=>{const o=this._getCurrentObject(i.offsetX,i.offsetY),a=o==null?void 0:o.triggerMouseWheel(i);this._scene.getViewports().forEach(l=>{l.onMouseWheelObserver.hasObservers()&&l.onMouseWheelObserver.notifyObservers(i)}),this._checkDirectSceneEventTrigger(!a,o)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(i)},this._onKeyDown=i=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(i)},this._onKeyUp=i=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(i)},this._onInputObserver=s.onInputChangedObservable.add(i=>{const o=i;i.deviceType===dn.Keyboard&&(i.currentState===1&&this._onKeyDown(o),i.currentState===0&&this._onKeyUp(o)),(i.deviceType===dn.Mouse||i.deviceType===dn.Touch)&&(r&&i.inputIndex>=Ne.LeftClick&&i.inputIndex<=Ne.RightClick&&i.currentState===1&&this._onPointerDown(o),e&&i.inputIndex>=Ne.LeftClick&&i.inputIndex<=Ne.RightClick&&i.currentState===0&&this._onPointerUp(o),t&&(i.inputIndex===Ne.Horizontal||i.inputIndex===Ne.Vertical||i.inputIndex===Ne.DeltaHorizontal||i.inputIndex===Ne.DeltaVertical)?this._onPointerMove(o):n&&(i.inputIndex===Ne.MouseWheelX||i.inputIndex===Ne.MouseWheelY||i.inputIndex===Ne.MouseWheelZ)&&this._onMouseWheel(o))}),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const r=this._scene.getEngine();!r||(r.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_isPointerSwiping(r,e){return Math.abs(this._startingPosition.x-r)>Co.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>Co.DragMovementThreshold}_prePointerDoubleClick(r){var s,i;const{clientX:e,clientY:t}=r;if(this._doubleClickOccurred===0&&(this._startingPosition.x=e,this._startingPosition.y=t),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout(()=>{this._resetDoubleClickParam()},Co.DoubleClickDelay),this._doubleClickOccurred<2)return;if(this._isPointerSwiping(e,t)){this._resetDoubleClickParam();return}(i=(s=this._scene)==null?void 0:s.pick(Re.FromArray([r.offsetX,r.offsetY])))==null||i.triggerDblclick(r),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(r),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",r)}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let Li=Co;Li.DragMovementThreshold=10;Li.LongPressDelay=500;Li.DoubleClickDelay=300;Li.ExclusiveDoubleClickMode=!1;class Qo extends Jo{constructor(e,...t){super(e),this._objects=[],this.addObjects(...t)}set cursor(e){this.setCursor(e)}get classType(){return Ge.GROUP}addObjects(...e){for(const t of e)this.addObject(t)}addObject(e){let t=e;if(Mc(e)){const n=this.getScene();if(t=n==null?void 0:n.getObject(e),!t){console.info("No object be added");return}t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const t=this.getObjects(),n=t.length;if(Mc(e))for(let s=0;s<n;s++){const i=t[s];if(i.oKey===e){t.splice(s,1),this.parent.removeObject(i);return}}else for(let s=0;s<n;s++){const i=t[s];if(i===e){t.splice(s,1),this.parent.removeObject(i);return}}}getObjectsByOrder(){const e=[];this._objects.sort(Ft);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjects(){return this._objects}render(e,t){e.save();const n=this.transform.getMatrix();e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(Ft);for(let s of this._objects)s.render(e,this._transformBounds(t));e.restore()}resize(e,t){return this}scale(e,t){return this}skew(e,t){return this}flip(e,t){return this}_transformBounds(e){return e}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach(e=>{e.dispose()}),super.dispose()}}class Kr{constructor(e,t,n=.05,s=.05){this._scene=e,this._padding=t,this._smoothRatioX=n,this._smoothRatioY=s,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:20})}startScroll(e,t){this._offsetX=e,this._offsetY=t,this._moveX=e,this._moveY=t,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const t=(e==null?void 0:e.top)||0,n=t+((e==null?void 0:e.height)||0),s=(e==null?void 0:e.left)||0,i=s+((e==null?void 0:e.width)||0),{t:o=0,b:a=0,r:l=0,l:u=0}=this._padding;let c=0,h=0;this._moveX<s+u&&(c=(this._moveX-s-u)*this._smoothRatioX),this._moveX>i-l&&(c=(this._moveX-i+l)*this._smoothRatioX),this._moveY<t+o&&(h=(this._moveY-t-o)*this._smoothRatioY),this._moveY>n-a&&(h=(this._moveY-n+a)*this._smoothRatioY);const f=e==null?void 0:e.scrollBy({x:c,y:h}),d=e==null?void 0:e.getActualScroll(c,h);if(this._scrollX=(d==null?void 0:d.x)||0,this._scrollY=(d==null?void 0:d.y)||0,f){const m=this._findAncestorScene(e==null?void 0:e.scene),g=this.getViewportByCoord(m);g&&this._scroll(g)}}scrolling(e,t,n){this._moveX=e,this._moveY=t,this._scrollFunction=n}stopScroll(){gm(this._requestNewFrameNumber)}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=Po(this._runRenderLoop.bind(this))}_findAncestorScene(e){let t=e==null?void 0:e.getParent();for(;t;){if(t.classType===Ge.SCENE)return t;t=(t==null?void 0:t.getParent)&&(t==null?void 0:t.getParent())}}getViewportByCoord(e){const t=e==null?void 0:e.getViewports();return t==null?void 0:t.find(n=>n.isHit(Re.FromArray([this._offsetX,this._offsetY])))}getScene(){return this._scene}static create(e,t){return new Kr(e,t)}}const Fm=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class lf extends Jo{constructor(e,t){super(e),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new Bi,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._initialProps(t)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:s,maxX:i,minY:o,maxY:a}=of(this,t);if(this.width+this.strokeWidth<s||i<0||this.height+this.strokeWidth<o||a<0)return this}const n=this.transform.getMatrix();if(e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const s=this._cacheCanvas.getContext();this._cacheCanvas.clear(),s.save(),s.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(s),s.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_draw(e){}_initialProps(e){if(!e)return;const t=Object.keys(e);if(t.length===0)return;const n={};let s=!1;t.forEach(i=>{if(e[i]===void 0)return!0;sl.indexOf(i)>-1?(n[i]=e[i],s=!0):this[`_${i}`]=e[i]}),s&&this.transformByState(n),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(n=>{if(e[n]===void 0)return!0;sl.indexOf(n)===-1&&(this[`_${n}`]=e[n])}),this.makeDirty(!0),this}resizeCacheCanvas(){var e;(e=this._cacheCanvas)==null||e.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var n,s,i;let e=((n=this.getParent())==null?void 0:n.ancestorScaleX)||1,t=((s=this.getParent())==null?void 0:s.ancestorScaleX)||1;(i=this._cacheCanvas)==null||i.setPixelRatio(Math.max(e,t)*af()),this.makeDirty(!0)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}static _renderPaintInOrder(e,t){t.paintFirst==="stroke"?(this._renderStroke(e,t),this._renderFill(e,t)):(this._renderFill(e,t),this._renderStroke(e,t))}static _renderFill(e,t){!t.fill||(e.save(),this.__setFillStyles(e,t),t.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,t){let{stroke:n,strokeWidth:s,shadowEnabled:i,shadowForStrokeEnabled:o,strokeScaleEnabled:a,scaleX:l,scaleY:u,parent:c}=t;if(!(!n||s===0)){if(i&&!o&&this.__removeShadow(e),e.save(),a&&c){let h=this.__getObjectScaling();e.scale(1/h.scaleX,1/h.scaleY)}else a&&(l=l!=null?l:1,u=u!=null?u:1,e.scale(1/l,1/u));this.__setLineDash(e),this.__setStrokeStyles(e,t),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,t){e.fillStyle=t.fill}static __setStrokeStyles(e,t){const{strokeWidth:n,strokeLineCap:s,strokeDashOffset:i,strokeLineJoin:o,strokeMiterLimit:a,stroke:l}=t;e.lineWidth=n,e.lineCap=s,e.lineDashOffset=i,e.lineJoin=o,e.miterLimit=a,e.strokeStyle=l}static __setLineDash(e){}static drawWith(e,t){}toJson(){const e={};return Fm.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const Bm=["radius"];class rt extends lf{constructor(e,t){super(e,t),t!=null&&t.radius&&(this._radius=t==null?void 0:t.radius)}get radius(){return this._radius}_draw(e){rt.drawWith(e,this)}static drawWith(e,t){let{radius:n,width:s,height:i}=t;if(n=n!=null?n:0,s=s!=null?s:30,i=i!=null?i:30,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),!n)e.rect(0,0,s,i);else{let o=0,a=0,l=0,u=0;o=a=l=u=Math.min(n,s/2,i/2),e.moveTo(o,0),e.lineTo(s-a,0),e.arc(s-a,a,a,Math.PI*3/2,0,!1),e.lineTo(s,i-u),e.arc(s-u,i-u,u,0,Math.PI/2,!1),e.lineTo(l,i),e.arc(l,i-l,l,Math.PI/2,Math.PI,!1),e.lineTo(0,o),e.arc(o,o,o,Math.PI,Math.PI*3/2,!1)}e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return Bm.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const Lm=["pointsGroup"];class Vl extends lf{constructor(e,t){super(e,t),this._pointsGroup=(t==null?void 0:t.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add(n=>{const{type:s,value:i,preValue:o}=n;(s===en.resize||s===en.all)&&this.resizePolygon(o)})}get pointsGroup(){return this._pointsGroup}_draw(e){Vl.drawWith(e,this)}static drawWith(e,t){let{pointsGroup:n}=t;n=n!=null?n:[[]],t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath();for(let s of n){e.moveTo(s[0].x,s[0].y);for(let i=1;i<s.length;i++){const o=s[i];e.lineTo(o.x,o.y)}}e.closePath(),this._renderPaintInOrder(e,t)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:t,top:n,width:s,height:i}=this._getSelfRect(),{width:o,height:a}=e;let l,u;o?l=this.width-o:l=0,a?u=this.height-a:u=0;const c=l/s,h=u/i;this.scaleX+=c,this.scaleY+=h,this.left=this.left-t*c,this.top=this.top-n*h,this._setTransForm()}toJson(){const e={};return Lm.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}getState(){const{left:e,top:t,width:n,height:s}=this.getRect();return{left:e,top:t,width:n,height:s,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:n,height:s}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:n*this.scaleX,height:s*this.scaleY}}_setFixBoundingBox(){const{width:e,height:t,left:n,top:s}=this._getSelfRect();this.left=this.left+n,this.top=this.top+s,this.width=e,this.height=t;const i=this.pointsGroup;for(let o of i)for(let a of o)a.x-=n,a.y-=s;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let t=e[0][0].x,n=e[0][0].x,s=e[0][0].y,i=e[0][0].y;for(let o of e)for(let a of o)t=Math.min(t,a.x),n=Math.max(n,a.x),s=Math.min(s,a.y),i=Math.max(i,a.y);return{left:t,top:s,width:n-t,height:i-s}}}const os=17;class Gl{constructor(e,t){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=xt(Cr.black,.2),this._thumbHoverBackgroundColor=xt(Cr.black,.35),this._thumbActiveBackgroundColor=xt(Cr.black,.4),this._barSize=14,this._barBackgroundColor=xt(Cr.white),this._barBorder=1,this._barBorderColor=xt([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,e||console.warn("Missing viewport"),this._view=e,this.setProps(t),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}setProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(n=>{e[n]!==void 0&&(this[`_${n}`]=e[n])})}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new rt("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new rt("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new rt("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new rt("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new rt("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const e=this._mainScene||this._view.scene,t=(n,s)=>(i,o)=>{if(this._isHorizonMove||this._isVerticalMove)return;s.setProps({fill:n}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(Jt.PointerEnter,t(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(Jt.PointerLeave,t(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(Jt.PointerDown,(n,s)=>{const i=n;this._view.scrollTo({x:i.offsetX-this._view.left-this._horizontalThumbWidth/2}),s.stopPropagation()}),this._horizonThumbRect.on(Jt.PointerDown,(n,s)=>{const i=n;this._isHorizonMove=!0,this._lastX=i.offsetX,this._lastY=i.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),e.disableEvent(),s.stopPropagation()}),e.on(Jt.PointerMove,(n,s)=>{const i=n;!this._isHorizonMove||(this._view.scrollBy({x:i.offsetX-this._lastX}),this._lastX=i.offsetX)}),e.on(Jt.PointerUp,(n,s)=>{const i=this._horizonThumbRect;this._isHorizonMove=!1,e.enableEvent(),i.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})),this._enableVertical&&(this._verticalThumbRect.on(Jt.PointerEnter,t(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(Jt.PointerLeave,t(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(Jt.PointerDown,(n,s)=>{const i=n;this._view.scrollTo({y:i.offsetY-this._view.top-this._verticalThumbHeight/2}),s.stopPropagation()}),this._verticalThumbRect.on(Jt.PointerDown,(n,s)=>{const i=n,o=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=i.offsetX,this._lastY=i.offsetY,o.setProps({fill:this._thumbActiveBackgroundColor}),e.disableEvent(),this.makeViewDirty(!0),s.stopPropagation()}),e.on(Jt.PointerMove,(n,s)=>{const i=n;!this._isVerticalMove||(this._view.scrollBy({y:i.offsetY-this._lastY}),this._lastY=i.offsetY)}),e.on(Jt.PointerUp,(n,s)=>{const i=this._verticalThumbRect;this._isVerticalMove=!1,e.enableEvent(),i.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))}render(e,t=0,n=0){let{scrollX:s,scrollY:i}=this._view;e.save();const a=new kt([1,0,0,1,t,n]).getMatrix();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this._horizonBarRect.render(e),this._horizonThumbRect.translate(s).render(e),this._verticalBarRect.render(e),this._verticalThumbRect.translate(void 0,i).render(e),this._placeholderBarRect.render(e),e.restore()}resize(e=0,t=0,n=0,s=0){var i,o,a,l,u,c,h,f,d,m,g;e===0&&e===0||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=e-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<os&&(this._horizontalMinusMiniThumb=os-this._horizontalThumbWidth,this._horizontalThumbWidth=os),(i=this._horizonBarRect)==null||i.transformByState({left:0,top:t-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=e?(o=this._horizonThumbRect)==null||o.setProps({visible:!1}):((a=this._horizonThumbRect)!=null&&a.visible||(l=this._horizonThumbRect)==null||l.setProps({visible:!0}),(u=this._horizonThumbRect)==null||u.transformByState({left:this._view.scrollX,top:t-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-this._thumbMargin*2}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=t-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/s*this._thumbLengthRatio,this._verticalThumbHeight<os&&(this._verticalMinusMiniThumb=os-this._verticalThumbHeight,this._verticalThumbHeight=os),(c=this._verticalBarRect)==null||c.transformByState({left:e-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=t?(h=this._verticalThumbRect)==null||h.setProps({visible:!1}):((f=this._verticalThumbRect)!=null&&f.visible||(d=this._verticalThumbRect)==null||d.setProps({visible:!0}),(m=this._verticalThumbRect)==null||m.transformByState({left:e-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-this._thumbMargin*2,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&((g=this._placeholderBarRect)==null||g.transformByState({left:e-this._barSize,top:t-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}get ratioScrollX(){return this._horizontalThumbWidth===void 0||this._horizontalBarWidth===void 0?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return this._verticalThumbHeight===void 0||this._verticalBarHeight===void 0?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}makeDirty(e){var t,n,s,i,o;(t=this._horizonBarRect)==null||t.makeDirty(e),(n=this._horizonThumbRect)==null||n.makeDirty(e),(s=this._verticalBarRect)==null||s.makeDirty(e),(i=this._verticalThumbRect)==null||i.makeDirty(e),(o=this._placeholderBarRect)==null||o.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){this._view.makeDirty(e);const t=this._view.scene.getParent();t.classType===Ge.SCENE_VIEWER&&t.makeDirty(!0)}pick(e){var t,n,s,i;return(t=this._horizonThumbRect)!=null&&t.isHit(e)?this._horizonThumbRect:(n=this._verticalThumbRect)!=null&&n.isHit(e)?this._verticalThumbRect:(s=this._horizonBarRect)!=null&&s.isHit(e)?this._horizonBarRect:(i=this._verticalBarRect)!=null&&i.isHit(e)?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}static attachTo(e,t){return new Gl(e,t)}}class uf{constructor(e){this._dirty=!0,this._context=e,this._localeInitial()}get dirty(){return this._dirty}_localeInitial(){if(!this._context)return;const e=this._context.getLocale(),t=e.getObject("renderFont");t||e.load({en:im,zh:sm}),this._fontLocale=t}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(e){this._dirty=e}}class cf{constructor(){this.translateX=0,this.translateY=0}draw(e,t,n){}clearCache(){}_getScale(e){return Us(e)}}const Pi=xr.create(),hf=xr.create(),df=xr.create(),Hi=xr.create();class ff extends Jo{constructor(){super(...arguments),this._extensions=new Map}register(...e){for(let t of e)t.parent=this,this._extensions.set(t.uKey,t)}unRegister(...e){for(let t of e)this._extensions.delete(t)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(Ft),e}getExtensionByKey(e){return this._extensions.get(e)}get extensions(){return this._extensions}draw(e,t){}}function Pm(r,e,t,n,s=0,i=0,o=!1,a,l,u){const{lineHeight:c=15.6,lineTop:h=0,contentHeight:f=0,paddingLeft:d=0,paddingRight:m=0,paddingTop:g=0,paddingBottom:p=0,marginTop:_=0,spaceBelowApply:v=0}=t,w=Xm(e,r);w.lineIndex=s,w.paragraphStart=Xl(i,o),w.contentHeight=f,w.top=h,w.lineHeight=c,w.paddingTop=g,w.paddingBottom=p,w.marginTop=_,w.spaceBelowApply=v,w.divides=Um(c,h,n,d,m,a,l,u);for(let y of w.divides)y.parent=w;return w}function Hm(r=15.6,e=0,t=0,n,s,i){let o=e;return s==null||s.forEach(a=>{const l=xa(a,r,e);l&&(o=Math.max(o,l))}),i==null||i.forEach(a=>{const l=xa(a,r,e);l&&(o=Math.max(o,l))}),n==null||n.forEach(a=>{const l=xa(a,r,e);l&&(o=Math.max(o,l))}),o}function xa(r,e,t,n){const{aTop:s,height:i,aLeft:o,width:a,angle:l=0,drawingOrigin:u}=r,{layoutType:c,distT:h=0,distB:f=0}=u;if(c!==tn.WRAP_TOP_AND_BOTTOM)return;if(l===0){const g=s-h,p=i+f;return g+p<t||g>e+t?void 0:g+i}let{top:d=0,height:m=0}=gf(l,o,a,s,i);if(d-=h,m+=f,!(d+m<t||d>e+t))return d+m}function Um(r,e,t,n,s,i,o,a){const l=[];return l.push({left:0,width:n},{left:t-s,width:s}),o==null||o.forEach((u,c)=>{const h=Ia(u,r,e,t);h&&l.push(h)}),a==null||a.forEach((u,c)=>{const h=Ia(u,r,e,t);h&&l.push(h)}),i==null||i.forEach((u,c)=>{const h=Ia(u,r,e,t);h&&l.push(h)}),Gm(t,l)}function zm(r,e){r.isFull=e}function Ia(r,e,t,n){const{aTop:s,height:i,aLeft:o,width:a,angle:l=0,drawingOrigin:u}=r,{layoutType:c}=u;if(c===tn.WRAP_NONE||c===tn.WRAP_TOP_AND_BOTTOM)return;if(c===tn.WRAP_POLYGON){const{start:f=[0,0],lineTo:d}=u;if(!d)return;let m=[];m.push(new Re(f[0],f[1]));for(let g=0;g<d.length;g++){const p=d[g];m.push(new Re(p[0],p[1]))}if(l!==0){const g=new kt().rotate(l);for(let p=0;p<m.length;p++){const _=m[p];m[p]=g.applyPoint(_)}}return Bc(m,t,e,n)}if(l===0)return Lc(s,i,o,a,t,e,n,u);const h=gf(l,o,a,s,i);if(c===tn.WRAP_SQUARE){const{left:f,width:d,top:m,height:g}=h;return Lc(m,g,f,d,t,e,n,u)}return Bc(h.points,t,e,n)}function gf(r,e,t,n,s){const i=new kt().rotate(r),o=new Re(e,n),a=new Re(e,n+s),l=new Re(e+t,n),u=new Re(e+t,n+s);return i.makeBoundingBoxFromPoints([o,a,l,u])}function Bc(r,e,t,n){const s=new Dm(r),i=s.intersection([new Re(0,e),new Re(n,e)]),o=s.intersection([new Re(0,e+t),new Re(n,e+t)]);if(!i&&!o)return;const a=Wm([...r,...i||[],...o||[]]);return{left:a.min,width:a.max}}function Wm(r,e=0){const t=[];for(let n=0;n<r.length;n++){const s=r[n];e===0?t.push(s.x):t.push(s.y)}return{max:Math.max(...t),min:Math.min(...t)}}function Lc(r,e,t,n,s,i,o,a){const{layoutType:l,wrapText:u=Wn.BOTH_SIDES,distL:c=0,distR:h=0,distT:f=0,distB:d=0}=a,m=r-(l===tn.WRAP_SQUARE?f:0),g=e+(l===tn.WRAP_SQUARE?d:0);if(m+g<s||m>i+s)return;let p=t-c,_=n+h,v=Vm(u,p,_,o);return v===1?_=o-p:v===2&&(p=0,_=t+n+h),{left:p,width:_}}function Vm(r,e,t,n){let s=0;return r===Wn.LEFT?s=1:r===Wn.RIGHT?s=2:r===Wn.LARGEST&&(e>n-e-t?s=1:s=2),s}function Gm(r,e){e.sort((i,o)=>i.left>o.left?1:-1);const t=[];let n=0;const s=e.length;for(let i=0;i<s;i++){const o=e[i],{left:a,width:l}=o;if(a>n){let u=a-n;u=u<r?u:r-n;const c=Pc(n,u);t.push(c)}if(n=Math.max(a+l,n),i===s-1&&a+l<r){const u=Pc(a+l,r-a-l);t.push(u)}}return t}function Pc(r,e){return{spanGroup:[],width:e,left:r,paddingLeft:0,isFull:!1,st:0,ed:0}}function Xm(r,e){return{blockId:e,type:r,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}function Xl(r,e){return r===0&&e===!0}function $m(r,e,t,n){if(!!n)if(n.has(r)){const s=n.get(r);s==null||s.elements.push(e)}else n.set(r,{elements:[e],blockId:r,top:t})}function Oa(r,e){const t=r.parent;if(t!=null){const n=t.divides[0].spanGroup[0]==null,s=e[0],i=s.content||" ";if(n&&i===" "){const o=s.width;s.width=0;for(let a of e)a!==s&&(a.left-=o)}}r.spanGroup.push(...e)}function mf(r=[],e=ir.NONE,t=0,n=0,s=1/0,i=1/0){const o=[];let a=0,l=0;if(r.length===0)o.push(ka(n,s,0,ir.NONE));else for(let c=0;c<r.length;c++){const{width:h,paddingEnd:f}=r[c];l=f,a=h,o.push(ka(n,a,l,e)),n+=a+l,c===r.length-1&&(a=s!==1/0?s-a:h,l=0,o.push(ka(n,a,l,e)))}const u={columns:o,colCount:(r==null?void 0:r.length)||1,height:i,top:t,st:0,ed:0};return o.forEach(c=>{c.parent=u}),u}function ea(r,e){r.isFull=e}function ka(r,e,t,n){return{lines:[],left:r,width:e,height:0,spaceWidth:t,separator:n,st:0,ed:0,drawingLRIds:[],isFull:!1}}function Ym(r,e,t,n){return t in Lt?jm(r,e,t):km(r,e,t,n)}function jm(r,e,t){return t===Lt.DECIMAL?Hc(r,e):t===Lt.ZERO_DECIMAL?Km(r,e):t===Lt.UPPER_ALPHA?Zm(r,e):t===Lt.ALPHA?qm(r,e):t===Lt.UPPER_ROMAN?Jm(r,e):t===Lt.ROMAN?Qm(r,e):Hc(r,e)}function Hc(r,e){return(r+e).toString()}function Km(r,e){const t=r+e;return t<10?`0${t}`:t.toString()}function Zm(r,e){return Bd(r+e-1,!0)}function qm(r,e){return Bd(r+e-1,!1)}function Jm(r,e){return pf(r+e,!0)}function Qm(r,e){return pf(r+e,!1)}function pf(r,e=!1){const t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let s={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(s=t);let i="";for(let o in s)for(;r>=s[o];)i+=o,r-=s[o];return i}function e1(r,e,t,n,s){var h,f;if(!r||!e)return;const{listId:i,nestingLevel:o=0,textStyle:a}=r,l=e[i];return!l||!l.nestingLevel?Uc(i,(h=t==null?void 0:t[o])==null?void 0:h.startIndexItem,n):l.nestingLevel[o]?t1(i,o,l.nestingLevel,t,a,n,s):Uc(i,(f=t==null?void 0:t[o])==null?void 0:f.startIndexItem,n)}function Uc(r,e=1,t){return{listId:r,symbol:"\u25CF",ts:{ff:(t==null?void 0:t.fontList[0])||"Arial",fs:(t==null?void 0:t.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function t1(r,e,t,n,s,i,o){var I,R;const a=t[e],{bulletAlignment:l,glyphFormat:u,textStyle:c,startNumber:h,glyphType:f,glyphSymbol:d,indentFirstLine:m,hanging:g,indentStart:p}=a,_={...s,...c},v=Wl(_,i);let w;d?w=d:w=n1(u,e,t,n,o);const y=Hs.getTextSize(w,v),A=(R=(I=n==null?void 0:n[e])==null?void 0:I.startIndexItem)!=null?R:1;return{listId:r,symbol:w,ts:_,fontStyle:v,startIndexItem:A+1,bBox:y,nestingLevel:a,bulletAlign:l,bulletType:d?!1:!!f,indentFirstLine:m,hanging:g,indentStart:p}}function n1(r,e,t,n,s){var l;const i=r.split("%"),a=[i[0]];for(let u=1;u<i.length;u++){const c=i[u],{level:h,suffix:f}=s1(c);let d=((l=n==null?void 0:n[h])==null?void 0:l.startIndexItem)||1;h!==e&&(n==null?void 0:n[h])!==null&&(d-=1);const m=r1(d,t[h],s);a.push(m,f)}return a.join("")}function r1(r=1,e,t){const{startNumber:n,glyphType:s,glyphSymbol:i}=e;return i||(s?Ym(r,n,s,t):"\u25CF")}function s1(r){if(r==="")return{level:0,suffix:""};const e=r.split("");let t="",n="",s=!1;const i=/[0-9]/g;return e.forEach(o=>{!s&&i.test(`${t}${o}`)?t+=o:(s=!0,n+=o)}),{level:parseInt(t)-1,suffix:n}}function _f(r,e,t){return $l(hn.WORD,r,e,t)}function ol(r,e,t){return $l(hn.LETTER,r,e,t)}function i1(r,e){return $l(hn.TAB," ",r,e)}function $l(r,e,t,n){const{fontStyle:s,textStyle:i,charSpace:o=1,gridType:a=cn.LINES,snapToGrid:l=te.FALSE}=t,u=Hs.getTextSize(e,s),{width:c=0}=u;let h=n!=null?n:c,f=0;return vf(a,l)&&(h=Math.ceil(c/o)*o,a===cn.LINES_AND_CHARS&&(f=(h-c)/2)),{content:e,ts:i,fontStyle:s,width:h,bBox:u,paddingLeft:f,left:0,spanType:r}}function o1(r,e,t){const{bBox:n,symbol:s,ts:i,fontStyle:o,bulletAlign:a=Ct.START,bulletType:l=!1}=e,u=n.width,c=Math.ceil(u/t);let h=(c<2?2:c)*t,f=0;l&&(a===Ct.CENTER?(f=-u/2,h-=f):a===Ct.END&&(f=-u,h-=f));const d=l1(r,e);return{content:s,ts:i,fontStyle:o,width:h,paddingLeft:0,bBox:d,left:f,spanType:hn.LIST}}function a1(r,e=0){const t=r.length;let n;for(let s=0;s<t;s++){const i=r[s];i.left=n?n.left+n.width:e,n=i}}function l1(r,e){const{ba:t,bd:n}=r.bBox,{ba:s,bd:i}=e.bBox;return t+n>s+i?r.bBox:e.bBox}function u1(r,e,t,n){if(Jd(r))return h1(r,e,t,n);if(Qd(r))return d1(r,e,t,n);if(!qd(r))return c1(r,e,t,n)}function c1(r,e,t,n){const{pageWidth:s=1/0}=n,i=ol(r,n),o=[i];let a=i.width,l=e;for(let u=e+1;u<t.length;u++){const c=t[u];if(!qd(c)&&!bm(c)){const h=ol(c,n),f=h.width;if(a+f>s)break;o.push(h),a+=f,l=u}else break}return{charIndex:l,spanGroup:o}}function h1(r,e,t,n){const s=[r];let i=e;for(let o=e+1;o<t.length;o++){const a=t[o];if(Jd(a))s.unshift(a),i=o;else break}return{charIndex:i,spanGroup:[ol(s.join(""),n)]}}function d1(r,e,t,n){const s=[r];let i=e;for(let o=e+1;o<t.length;o++){const a=t[o];if(Qd(a))s.push(a),i=o;else break}return{charIndex:i,spanGroup:[_f(s.join(""),n)]}}function ks(r){return r==null?void 0:r[r.length-1]}function ta(r){var e;return(e=r==null?void 0:r.sections)==null?void 0:e[r.sections.length-1]}function f1(r){var t;const e=(t=Uo(r))==null?void 0:t.column.lines;return e==null?void 0:e[e.length-1]}function g1(r){return r.lines[r.lines.length-1]}function m1(r){const{width:e,marginLeft:t,marginRight:n}=r;return e-t-n}function p1(r){var t;const e=(t=r.parent)==null?void 0:t.parent;if(e)return e}function Uo(r){const e=ta(r);for(let t=0;t<e.columns.length;t++){const n=e.columns[t];if(!n.isFull)return{column:n,isLast:t===e.columns.length-1,index:t}}}function _1(r){const e=f1(r);if(!!e)for(let t=0;t<e.divides.length;t++){const n=e.divides[t];if(!n.isFull)return{divide:n,isLast:t===e.divides.length-1,index:t}}}function b1(r){const e=ta(r),t=e.columns.length;for(let n=0;n<t;n++)if(!e.columns[n].isFull)return!1;return!0}function v1(r){if(r.sections.length>1)return!1;const e=ta(r),t=e.columns.length;for(let n=0;n<t;n++){const s=e.columns[n];if(!bf(s))return!1}return!0}function bf(r){const e=r.lines;if(e.length>1)return!1;const t=e[e.length-1];return C1(t)}function C1(r){if(!r)return!0;for(let e=0;e<r.divides.length;e++){const t=r.divides[e].spanGroup.length;if(t>1)return!1;if(t===1){const n=r.divides[e].spanGroup[0],{spanType:s}=n;if(s!==hn.TAB&&s!==hn.LIST)return!1}}return!0}function wr(r,e){if(r instanceof Object){const{v:t,u:n}=r;return n===Pd.POINT?t:t*e}return r}function Yl(r=0,e,t=cn.LINES,n=te.TRUE){let s=1;return vf(t,n)&&(s=r),s*=e,s}function vf(r=cn.LINES,e=te.FALSE){return e===te.TRUE&&(r===cn.LINES_AND_CHARS||r===cn.SNAP_TO_CHARS)}function Cf(r,e){const{paragraphStyle:t={}}=e,{linePitch:n=15.6,gridType:s=cn.LINES,paragraphLineGapDefault:i=0}=r,{lineSpacing:o=1,spacingRule:a=Ti.AUTO,snapToGrid:l=te.TRUE}=t;return{paragraphLineGapDefault:i,linePitch:n,gridType:s,lineSpacing:o,spacingRule:a,snapToGrid:l}}function E1(r,e){const{paragraphStyle:t={}}=e,{charSpace:n=0,gridType:s=cn.LINES,defaultTabStop:i=36,documentTextStyle:o={}}=r,{fs:a=lm}=o,{snapToGrid:l=te.TRUE}=t;return{charSpace:n,documentFontSize:a,defaultTabStop:i,gridType:s,snapToGrid:l}}function al(r,e=-1){r[0];let t=e;for(let n of r){const{sections:s}=n;let i=t,o=i,a=-1/0,l=0;for(let u of s){const{columns:c}=u;let h=o,f=h,d=-1/0;for(let m of c){const{lines:g}=m;let p=f,_=p,v=0,w=-1/0,y=null;for(let A of g){const{divides:I,lineHeight:R}=A;let x=_,S=x,k=0,N=0;v+=R;const O=I.length;for(let D=0;D<O;D++){const E=I[D],{spanGroup:F}=E;if(F.length===0)continue;let j=S,L=j;for(let re of F){L+=re.spanType===hn.LIST?0:re.count||1;const ee=re.bBox,{ba:U}=ee;N=Math.max(N,U),D===O-1&&E.width===1/0&&(k+=re.width)}D===O-1&&(E.width===1/0?E.width=k:k+=E.width,k+=E.left),E.st=j===0?0:j+1,E.ed=L>=E.st?L:E.st,S=E.ed}A.st=x===0?0:x+1,A.ed=S>=A.st?S:A.st,A.width=k,A.asc=N,w=Math.max(w,k),A.top=((y==null?void 0:y.top)||0)+((y==null?void 0:y.lineHeight)||0),y=A,_=A.ed}m.st=p===0?0:p+1,m.ed=_>=m.st?_:m.st,m.height=v,m.width===1/0&&(m.width=w),a=Math.max(a,w),d=Math.max(d,m.height),f=m.ed}u.st=h===0?0:h+1,u.ed=f>=u.st?f:u.st,u.height=d,l+=d,o=u.ed}n.st=i===0?0:i+1,n.ed=o>=n.st?o:n.st,n.height=l,n.width=a,t=n.ed}}function w1(r,e){for(let t of r){const{sections:n}=t;for(let s of n){const{columns:i}=s;for(let o of i){const{lines:a}=o;for(let l of a)e&&Zd(e)&&e(l)}}}}function T1(r,e){for(let t of r){const{sections:n}=t;for(let s of n){const{columns:i}=s;for(let o of i)e&&Zd(e)&&e(o)}}}function y1(r,e,t,n,s=!1){const{relativeFrom:i,align:o,posOffset:a,percent:l}=r;if(o!=null)if(o===mr.INSIDE||o===mr.OUTSIDE)i===ot.MARGIN||ot.PAGE;else{if(i===ot.COLUMN){const{width:u,left:c}=e;let h=0;return o===mr.LEFT?h=c:o===mr.RIGHT?h=c+u-n:o===mr.CENTER&&(h=c+u/2-n/2),h}if(i!==ot.LEFT_MARGIN){if(i!==ot.MARGIN){if(i!==ot.RIGHT_MARGIN){if(i!==ot.INSIDE_MARGIN){if(i!==ot.OUTSIDE_MARGIN){if(i===ot.PAGE){const{width:u}=t;let c=0;return o===mr.RIGHT?c=u-n:o===mr.CENTER&&(c=u/2-n/2),c}}}}}}}else if(a){const{width:u,marginLeft:c,marginRight:h}=t,f=u-h;let d=0;return i===ot.COLUMN?d=(s?0:(e==null?void 0:e.left)||0)+a:i===ot.LEFT_MARGIN||(i===ot.MARGIN?d=a+c:i===ot.RIGHT_MARGIN||i===ot.INSIDE_MARGIN||i===ot.OUTSIDE_MARGIN||i===ot.PAGE&&(d=a)),d+n>f&&(d=f-n),d}else if(l){const{width:u,marginLeft:c,marginRight:h}=t;if(i!==ot.LEFT_MARGIN){if(i!==ot.MARGIN){if(i!==ot.RIGHT_MARGIN){if(i!==ot.INSIDE_MARGIN){if(i!==ot.OUTSIDE_MARGIN){if(i===ot.PAGE)return l*u}}}}}}}function S1(r,e,t,n,s,i,o=!1){const{relativeFrom:a,align:l,posOffset:u,percent:c}=r;if(l!=null){if(a===lt.LINE){let h=0;return l===ms.BOTTOM?h=t+n-s:l===ms.TOP?h=t:l===ms.CENTER&&(h=t+n/2-s/2),h}if(a!==lt.TOP_MARGIN){if(a!==lt.MARGIN){if(a!==lt.BOTTOM_MARGIN){if(a!==lt.INSIDE_MARGIN){if(a!==lt.OUTSIDE_MARGIN){if(a===lt.PAGE){const{height:h}=e;let f=0;return l===ms.BOTTOM?f=h-s:l===ms.CENTER&&(f=h/2-s/2),f}}}}}}}else if(u){let h=0;return a===lt.LINE?h=t||0+u:a===lt.TOP_MARGIN||a===lt.MARGIN||a===lt.BOTTOM_MARGIN||a===lt.INSIDE_MARGIN||a===lt.OUTSIDE_MARGIN||(a===lt.PAGE?h=u:a===lt.PARAGRAPH&&(h=(o?0:i==null?t:i)+u)),h}else if(c){const{height:h,marginBottom:f,marginTop:d}=e;if(a!==lt.TOP_MARGIN){if(a!==lt.MARGIN){if(a!==lt.BOTTOM_MARGIN){if(a!==lt.INSIDE_MARGIN){if(a!==lt.OUTSIDE_MARGIN){if(a===lt.PAGE)return c*h}}}}}}}function A1(r){const e=r.spanGroup;let t=0;for(let n of e)t+=n.width;return t}function zc(r,e,t,n,s=0,i=!1){if(Xl(s,i))if(n.bulletSkeleton){const{bulletSkeleton:o,paragraphStyle:a={}}=n,{gridType:l=cn.LINES,charSpace:u=0,defaultTabStop:c=1}=t,{snapToGrid:h=te.TRUE}=a,f=Yl(u,c,l,h);F1(a,o,f);const d=o1(r[0],o,f);As([d,...r],e,t,n,s,i)}else As(r,e,t,n,s,i);else mi(r,e,t,n,s,i);return[...e]}function mi(r,e,t,n,s=0,i=!1,o){var u,c;const a=ks(e),l=_1(a);if(l){const h=k1(r),f=l.divide,d=(u=f==null?void 0:f.spanGroup)==null?void 0:u[f.spanGroup.length-1],m=(d==null?void 0:d.width)||0,g=(d==null?void 0:d.left)||0,p=m1(a);if(m+g+h>f.width){zm(f,!0);const _=p1(f);h>p?v1(a)?(Oa(f,r),x1((c=_==null?void 0:_.parent)==null?void 0:c.columns)):Kl(r,e,t,n,s,i,o):_&&h>_.width?(ea(_,!0),bf(_)?(console.log(r),Oa(f,r)):jl(r,e,t,n,s,i,o)):l.isLast?As(r,e,t,n,s,i,o):mi(r,e,t,n,s,i,o)}else{const _=f.parent,v=N1(r);if(_&&v){const{paragraphLineGapDefault:w,linePitch:y,lineSpacing:A,spacingRule:I,snapToGrid:R,gridType:x}=Cf(t,n),{boundingBoxAscent:S,boundingBoxDescent:k}=v,N=S+k,{contentHeight:O}=Ef(N,w,y,x,A,I,R);if(_.contentHeight<O){const D=M1(_),E=D.length;let F=[],j=1;D[0].spanType===hn.LIST&&E>2?(F=[D[0],D[1]],j=2):F=[D[0]];const L=_.parent;L==null||L.lines.pop(),As(F,e,t,n,s,i,S+k);for(let re=j;re<D.length;re++)mi([D[re]],e,t,n,s,i);mi(r,e,t,n,s,i);return}}a1(r,m+g);for(let w of r)w.parent=f;Oa(f,r)}}else As(r,e,t,n,s,i,o)}function As(r,e,t,n,s=0,i=!1,o){var Pe,Ke,H,K,qe;let a=ks(e),l=Uo(a);if((!l||!l.column)&&(Kl(r,e,t,n,s),a=ks(e),l=Uo(a)),!l)return;const u=l.column,c=g1(u),{ba:h,bd:f}=r[0].bBox,d=o||h+f,{paragraphStyle:m={},paragraphAffectSkeDrawings:g,skeHeaders:p,skeFooters:_,blockAnchor:v,blockId:w}=n,{namedStyleType:y=Pl.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:A=ct.UNSPECIFIED,direction:I,spaceAbove:R=0,spaceBelow:x=0,borderBetween:S,borderTop:k,borderBottom:N,borderLeft:O,borderRight:D,indentFirstLine:E=0,hanging:F=0,indentStart:j=0,indentEnd:L=0,tabStops:re=[],keepLines:Y=te.FALSE,keepNext:ee=te.FALSE,wordWrap:U=te.FALSE,widowControl:V=te.FALSE,shading:_e}=m,{paragraphLineGapDefault:ie,linePitch:Z,lineSpacing:le,spacingRule:ve,snapToGrid:Ce,gridType:ge}=Cf(t,n),ye=Xl(s,i),{paddingTop:Me,paddingBottom:Ze,contentHeight:ke,lineSpacingApply:T}=Ef(d,ie,Z,ge,le,ve,Ce),{marginTop:se,spaceBelowApply:ne}=D1(T,R,x,ye,c),B=se+Me+ke+Ze;let M=u.parent;M||(M=ta(a));const X=(c==null?void 0:c.lineHeight)||0,ae=(c==null?void 0:c.top)||0,oe=X+ae,{width:$,headerId:he,footerId:P}=a,z=(Ke=(Pe=p==null?void 0:p.get(he))==null?void 0:Pe.get($))==null?void 0:Ke.skeDrawings,J=(K=(H=_==null?void 0:_.get(P))==null?void 0:H.get($))==null?void 0:K.skeDrawings;I1(oe,B,u,(qe=v==null?void 0:v.get(w))==null?void 0:qe.top,g);const ue=Hm(B,oe,s,a.skeDrawings,z,J);if(B+ue>M.height&&u.lines.length>0&&a.sections.length>0){ea(u,!0),jl(r,e,t,n,s,i,o);return}const de=c?c.lineIndex+1:0,{charSpace:Fe,defaultTabStop:xe}=E1(t,n),Oe=Yl(Fe,xe,ge,Ce),{paddingLeft:ce,paddingRight:Te,changeBulletWidth:be}=R1(r[0],E,F,j,L,Oe);be.state&&(r[0].width=be.hangingNumber);const Ue=Pm(w,Lo.PARAGRAPH,{lineHeight:B,contentHeight:ke,lineTop:ue,paddingLeft:ce,paddingRight:Te,paddingTop:Me,paddingBottom:Ze,marginTop:se,spaceBelowApply:ne},u.width,de,s,i,a.skeDrawings,z,J);u.lines.push(Ue),Ue.parent=u,$m(w,Ue,oe,v),mi(r,e,t,n,s,i,o)}function jl(r,e,t,n,s=0,i=!1,o){const a=ks(e);b1(a)===!0?Kl(r,e,t,n,s,i,o):As(r,e,t,n,s,i,o)}function Kl(r,e,t,n,s=0,i=!1,o){const a=ks(e),{skeHeaders:l,skeFooters:u}=n;e.push(Si(t,{skeHeaders:l,skeFooters:u},a==null?void 0:a.pageNumber)),jl(r,e,t,n,s,i,o)}function R1(r,e=0,t=0,n=0,s=0,i){const{spanType:o=hn.LETTER,bBox:a}=r;let l=wr(e,i),u=wr(t,i),c=wr(n,i),h=wr(s,i),f=c,d=h,m={state:!1,hangingNumber:0};if(o===hn.LIST){const{width:g}=a;l>0?f+=l:u>0&&u>g&&(m.state=!0,m.hangingNumber=u)}else f+=u;return{paddingLeft:f,paddingRight:d,changeBulletWidth:m}}function D1(r=0,e=0,t=0,n,s){let i=0,o=0;if(!n)return{marginTop:i,spaceBelowApply:o};if(i=wr(e,r),o=wr(t,r),s){const{spaceBelowApply:a}=s;a>i&&(i=0,s.lineHeight+=a,s.marginBottom=a)}return{marginTop:i,spaceBelowApply:o}}function x1(r=[]){for(let e=0;e<r.length;e++){const t=r[e];ea(t,!0)}}function Ef(r,e,t,n,s,i,o){let a=e,l=e;if(n===cn.DEFAULT||o===te.FALSE)return i===Ti.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:s*r,lineSpacingApply:r}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(s,r),lineSpacingApply:s};let u=0;return i===Ti.AUTO?u=s*t:u=s,r+e*2<u&&(a=l=(u-r)/2),{paddingTop:a,paddingBottom:l,contentHeight:r,lineSpacingApply:u}}function I1(r,e,t,n,s){var l;if(!s)return;const i=(l=t.parent)==null?void 0:l.parent;if(!i)return;const o=new Map,a=O1(t);s.forEach(u=>{if(!u)return;const{initialState:c,drawingOrigin:h}=u;if(c||!h)return;const{objectProperties:f}=h,{positionH:d,positionV:m,size:g,angle:p}=f,{width:_=0,height:v=0}=g;u.aLeft=y1(d,t,i,_,a)||0,u.aTop=S1(m,i,r,e,v,n,a)||0,u.width=_,u.height=v,u.angle=p,u.initialState=!0,o.set(u.objectId,u)}),i.skeDrawings=new Map([...i.skeDrawings,...o])}function O1(r){const e=r.parent;if(!e)return!1;const t=e==null?void 0:e.columns;if(!t)return!1;const n=t.length;for(let s=n-1;s>=0;s--){const o=t[s].lines,a=o.length;if(!(a<=0)){for(let l=a-1;l>=0;l--)if(o[l].paragraphStart)return!1}}return!0}function k1(r){const e=r.length;let t=0;for(let n=0;n<e;n++)t+=r[n].width;return t}function N1(r){const e=r.length;let t=-1/0,n;for(let s=0;s<e;s++){const i=r[s],{ba:o,bd:a}=i.bBox;t<o+a&&(n={boundingBoxAscent:o,boundingBoxDescent:a}),t=o+a}return n}function M1(r){const e=r.divides,t=e.length,n=[];for(let s=0;s<t;s++){const i=e[s];n.push(...i.spanGroup)}return n}function F1(r,e,t){const{hanging:n,indentStart:s}=r,{hanging:i,indentStart:o}=e;n===void 0&&(r.hanging=i),s===void 0&&(r.indentStart=wr(o||0,t)-wr(i||0,t))}function B1(r,e,t,n,s,i){const{pageNumberStart:o,pageSize:a={w:1/0,h:1/0},marginRight:l=0,marginLeft:u=0,columnProperties:c=[],columnSeparatorType:h=ir.NONE,contentDirection:f,sectionType:d,sectionTypeNext:m,textDirection:g,lists:p,drawings:_={},fontLocale:v}=n,{elements:w,elementOrder:y,paragraphStyle:A={},bullet:I}=e,{skeHeaders:R,skeFooters:x,skeListLevel:S,blockAnchor:k}=s,N={blockId:r,paragraphStyle:A,skeHeaders:R,skeFooters:x,blockAnchor:k},O=[t];let D=t;const E=new Map,F=L1(I,S),j=e1(I,p,F,v,i);return P1(I,j,S),N.bulletSkeleton=j,y.forEach((L,re)=>{const{elementId:Y,paragraphElementType:ee}=L;if(ee===q.DRAWING){const U=_[Y];U.layoutType===tn.INLINE||E.set(Y,H1(U))}}),y.forEach((L,re)=>{const{elementId:Y,paragraphElementType:ee}=L;let U=[];if(ee===q.TEXT_RUN){const V=w[Y],{tr:_e,st:ie,ed:Z}=V;if(!_e)return!1;U=z1(_e,re,n,D,{...N,paragraphAffectSkeDrawings:E},v)}else if(ee===q.PAGE_BREAK)U=[Si(n,s,Wc(D),yi.PAGE)],E.clear();else if(ee===q.COLUMN_BREAK){const V=Uo(D);V&&!V.isLast?ea(V.column,!0):U=[Si(n,s,Wc(D),yi.COLUMN)]}D=U1(O,U)}),O}function L1(r,e){if(!r||!e)return;const{listId:t,nestingLevel:n}=r,s=e==null?void 0:e.get(t);let i=n;i<0&&(i=0);const o=[];for(let a=i;a>=0;a--){const l=s==null?void 0:s[a];o[a]=l||null}return o}function P1(r,e,t){if(!r||!e)return;const{listId:n,nestingLevel:s}=r,i=[...(t==null?void 0:t.get(n))||[]];i[s]=e,i.splice(s+1),t==null||t.set(n,i)}function H1(r){return{objectId:r.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:r}}function U1(r,e){const t=r.slice(-1)[0],n=e[0];if(t===n){if(e.length===1)return t;e.shift()}return r.push(...e),r.slice(-1)[0]}function Wc(r){return r.pageNumber+1}function z1(r,e=0,t,n,s,i){const{ct:o="",ts:a={},tab:l=!1}=r,u=Wl(a,i),{paragraphStyle:c={}}=s,{gridType:h=cn.LINES,charSpace:f=0,documentTextStyle:d={},defaultTabStop:m=10.5,pageSize:g={width:1/0,height:1/0},marginLeft:p=0,marginRight:_=0}=t,{namedStyleType:v=Pl.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:w=ct.UNSPECIFIED,lineSpacing:y=1,spacingRule:A=Ti.AUTO,snapToGrid:I=te.TRUE,direction:R,spaceAbove:x=0,spaceBelow:S=0,borderBetween:k,borderTop:N,borderBottom:O,borderLeft:D,borderRight:E,indentFirstLine:F=0,hanging:j=0,indentStart:L=0,indentEnd:re=0,tabStops:Y=[],keepLines:ee=te.FALSE,keepNext:U=te.FALSE,wordWrap:V=te.FALSE,widowControl:_e=te.FALSE,shading:ie}=c;let Z=[n];const le=g.width||1/0-p-_,ve={...d,...a},Ce={fontStyle:u,textStyle:ve,charSpace:f,gridType:h,snapToGrid:I,pageWidth:le};if(l){const ye=Yl(f,m,h,I),Me=i1(Ce,ye);return Z=zc([Me],Z,t,s,e,!0),Z}const ge=o.split("");for(let ye=0;ye<ge.length;ye++){const Me=ge[ye],Ze=ye===0,ke=u1(Me,ye,ge,Ce);let T=[];if(ke){const{charIndex:se,spanGroup:ne}=ke;ye=se,T=ne}else{const se=_f(Me,Ce);T.push(se)}Z=zc(T,Z,t,s,e,Ze)}return w1(Z,ye=>{W1(ye,w)}),Z}function W1(r,e){if(e===ct.UNSPECIFIED||e===ct.LEFT)return;const{divides:t}=r,n=t.length;for(let s=0;s<n;s++){const i=t[s],{width:o,spanGroup:a}=i,l=A1(i);o!==1/0&&(e===ct.CENTER?i.paddingLeft=(o-l)/2:e===ct.RIGHT?i.paddingLeft=o-l:ct.JUSTIFIED)}}function V1(){return[]}function wf(r,e,t,n,s,i){const o=[],a=new Map;for(let l of r){const{paragraph:u,table:c,tableOfContents:h,blockType:f,customBlock:d,blockId:m}=l;if(s!=null&&s.get(m))continue;let g=[],p=e;o.length>0&&(p=o[o.length-1]),f===ze.PARAGRAPH&&u?g=B1(l.blockId,u,p,t,n,i):f===ze.TABLE&&c||f===ze.SECTION_BREAK&&h||f===ze.CUSTOM&&(g=Om(l.blockId,d,p,t,n,i)),g.length===0&&(g=V1()),G1(o,g),a.set(m,!0)}return{pages:o,renderedBlockIdMap:a}}function G1(r,e){const t=r.length-1,n=r[t],s=e[0];n===s&&e.splice(0,1),r.push(...e)}function Si(r,e,t=1,n=yi.SECTION){var Me,Ze,ke,T;const s=X1(),{pageNumberStart:i=1,pageSize:o={width:1/0,height:1/0},pageOrient:a=qo.PORTRAIT,headerIds:l={},footerIds:u={},useFirstPageHeaderFooter:c,useEvenPageHeaderFooter:h,footers:f,headers:d,columnProperties:m=[],columnSeparatorType:g,marginTop:p=0,marginBottom:_=0,marginHeader:v=0,marginFooter:w=0,marginLeft:y=0,marginRight:A=0,renderConfig:I={}}=r,{skeHeaders:R,skeFooters:x}=e,{width:S=1/0,height:k=1/0}=o;s.pageNumber=t,s.pageNumberStart=i,s.renderConfig=I,s.marginLeft=y,s.marginRight=A,s.breakType=n,s.width=s.pageWidth=S,s.height=s.pageHeight=k,s.pageOrient=a;const{defaultHeaderId:N,evenPageHeaderId:O,firstPageHeaderId:D}=l,{defaultFooterId:E,evenPageFooterId:F,firstPageFooterId:j}=u;let L=N!=null?N:"",re=E!=null?E:"";t===i&&c?(L=D!=null?D:"",re=j!=null?j:""):t%2===0&&h&&(L=O!=null?O:"",re=F!=null?F:"");let Y,ee;L&&((Me=R.get(L))!=null&&Me.has(S)?Y=(Ze=R.get(L))==null?void 0:Ze.get(S):d&&(Y=Vc(d[L],r,e),R.set(L,new Map([[S,Y]]))),s.headerId=L),re&&((ke=x.get(re))!=null&&ke.has(S)?ee=(T=x.get(re))==null?void 0:T.get(S):f&&(ee=Vc(f[re],r,e),x.set(L,new Map([[S,ee]]))),s.footerId=re),s.marginTop=Gc(p,v,Y),s.marginBottom=Gc(_,w,ee);const U=s.sections,V=U[U.length-1],{marginTop:_e,marginBottom:ie,marginLeft:Z,marginRight:le}=s,ve=S-Z-le,Ce=k-_e-ie;let ge=0;V&&(ge=V.top+V.height);const ye=mf(m,g,ge,0,ve,Ce-ge);return ye.parent=s,U.push(ye),s}function X1(){return{sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:qo.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:yi.SECTION,st:0,ed:0,skeDrawings:new Map}}function Vc(r,e,t,n=!0){const{body:s}=r,{lists:i,headers:o,footers:a,fontLocale:l,pageSize:u,marginLeft:c=0,marginRight:h=0,drawings:f,marginTop:d=0,marginBottom:m=0,marginHeader:g=0,marginFooter:p=0}=e,_=(u==null?void 0:u.width)||1/0,v={lists:i,headers:o,footers:a,pageSize:{width:_-c-h,height:1/0},fontLocale:l,drawings:f},{blockElements:w,blockElementOrder:y}=s,A=[];y.forEach(E=>{const F=w[E];A.push(F)});const I=Si(v,t),R=wf(A,I,v,t).pages[0];al([R]);const x=R.sections[0].columns[0],S=x.height||0,{skeDrawings:k,st:N,ed:O}=R,D={lines:x.lines,skeDrawings:k,height:S,st:N,ed:O,marginLeft:c,marginRight:h};return n?{...D,marginTop:$1(d,g,S)}:{...D,marginBottom:Y1(m,p,S)}}function Gc(r,e,t){return!t||t.lines.length===0?r:Math.max(r,e,(t==null?void 0:t.height)||0)}function $1(r,e,t){const n=Math.max(r,e);return t>n?0:n-t}function Y1(r,e,t){const n=Math.max(r,e);return t>n?0:n-t}class ll{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,t=0){this._translateX=e,this._translateY=t}translate(e=0,t=0){this._translateX+=e,this._translateY+=t}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:s=0,marginRight:i=0}=e;this.translate(s,t)}restorePagePadding(e){const{marginTop:t=0,marginBottom:n=0,marginLeft:s=0,marginRight:i=0}=e;this.translate(-s,-t)}translatePage(e,t=Jn.VERTICAL,n=0,s=0,i=0,o=0){const{sections:a,marginTop:l=0,marginBottom:u=0,marginLeft:c=0,marginRight:h=0,pageWidth:f,pageHeight:d,width:m,height:g,pageNumber:p=1,renderConfig:_={}}=e;let v=0,w=0;return t===Jn.VERTICAL?v=d+s:t===Jn.HORIZONTAL&&(w=f+n),this.translate(w,v),{x:w,y:v}}translateSection(e){const{top:t=0}=e;return this.translate(0,t),{x:0,y:t}}translateColumn(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}translateLine(e,t=!1){const{top:n,marginBottom:s=0,marginTop:i=0,paddingTop:o=0,paddingBottom:a=0}=e,l=n+(t===!0?i:0)+o;return this.translate(0,l),{x:0,y:l}}translateDivide(e){const{left:t,paddingLeft:n}=e,s=t+n;return this.translate(s,0),{x:s,y:0}}translateSpan(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}}class Zl extends uf{constructor(e,t){super(t),this._renderedBlockIdMap=new Map,this.onRecalculateChangeObservable=new Ae,this._documentData=e}updateDrawing(e,t){const n=this._documentData.drawings;if(!n)return;const s=n[e];if(!s)return;const i=s.objectProperties;i.size.width=t.width,i.size.height=t.height,i.positionH.posOffset=t.left,i.positionV.posOffset=t.top}calculate(e){!this.dirty||(this._skeletonData=this._createSkeleton(e),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(e,t){const n=this._documentData.documentStyle;if(!n.pageSize){e=e!=null?e:1/0,t=t!=null?t:1/0,n.pageSize={width:e,height:t};return}e!==void 0&&(n.pageSize.width=e),t!==void 0&&(n.pageSize.height=t)}__getContentMapArr(){const{body:e}=this._documentData;if(!e)return[];const{blockElements:t,blockElementOrder:n}=e;if(!t||n.length===0)return[];const s=[];let i={blockElements:[],sectionBreak:void 0};return n.forEach(o=>{const a=t[o],{sectionBreak:l}=a;l?(i.sectionBreak=l,s.push(i),i={blockElements:[],sectionBreak:void 0}):i.blockElements.push(a)}),i.sectionBreak||(i.sectionBreak={columnProperties:[],columnSeparatorType:ir.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED},i.blockElements.length>0&&s.push(i)),s}_createSkeleton(e){var le;const t=this.__getContentMapArr(),n={width:1/0,height:1/0},{documentStyle:s,footers:i,headers:o,lists:a,drawings:l}=this._documentData,{pageNumberStart:u=1,pageSize:c=n,pageOrient:h=qo.PORTRAIT,defaultHeaderId:f,defaultFooterId:d,evenPageHeaderId:m,evenPageFooterId:g,firstPageHeaderId:p,firstPageFooterId:_,useFirstPageHeaderFooter:v,useEvenPageHeaderFooter:w,marginTop:y=0,marginBottom:A=0,marginRight:I=0,marginLeft:R=0,marginHeader:x=0,marginFooter:S=0,charSpace:k=0,linePitch:N=15.6,gridType:O=cn.LINES,paragraphLineGapDefault:D=0,defaultTabStop:E=10.5,textStyle:F={fs:14},renderConfig:j={horizontalAlign:ct.UNSPECIFIED,verticalAlign:rn.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Mt.UNSPECIFIED}}=s,L=this.__getNullSke();if(t.length===0)return L;const re=this.getFontLocale(),Y={footers:i,headers:o,lists:a,drawings:l,charSpace:k,linePitch:N,gridType:O,fontLocale:re,paragraphLineGapDefault:D,defaultTabStop:E,documentTextStyle:F},{skeHeaders:ee,skeFooters:U,skeListLevel:V,blockAnchor:_e}=L,ie={skeHeaders:ee,skeFooters:U,skeListLevel:V,blockAnchor:_e},Z=[];L.pages=Z;for(let ve=0;ve<t.length;ve++){const Ce=t[ve];if(!Ce.sectionBreak)continue;const{pageNumberStart:ge=u,pageSize:ye=c,pageOrient:Me=h,marginTop:Ze=y,marginBottom:ke=A,marginRight:T=I,marginLeft:se=R,marginHeader:ne=x,marginFooter:B=S,defaultHeaderId:M=f,defaultFooterId:X=d,evenPageHeaderId:ae=m,evenPageFooterId:oe=g,firstPageHeaderId:$=p,firstPageFooterId:he=_,useFirstPageHeaderFooter:P=v,useEvenPageHeaderFooter:z=w,columnProperties:J=[],columnSeparatorType:ue=ir.NONE,contentDirection:de,sectionType:Fe,textDirection:xe,renderConfig:Oe=j}=Ce.sectionBreak,ce=t[ve+1],Te=(le=ce==null?void 0:ce.sectionBreak)==null?void 0:le.sectionType,be={defaultHeaderId:M,evenPageHeaderId:ae,firstPageHeaderId:$},Ue={defaultFooterId:X,evenPageFooterId:oe,firstPageFooterId:he};ye.width===null&&(ye.width=1/0),ye.height===null&&(ye.height=1/0);const Pe={pageNumberStart:ge,pageSize:ye,pageOrient:Me,marginTop:Ze,marginBottom:ke,marginRight:T,marginLeft:se,marginHeader:ne,marginFooter:B,headerIds:be,footerIds:Ue,useFirstPageHeaderFooter:P,useEvenPageHeaderFooter:z,columnProperties:J,columnSeparatorType:ue,contentDirection:de,sectionType:Fe,sectionTypeNext:Te,textDirection:xe,renderConfig:Oe,...Y};let Ke=ks(Z),H=!1;Fe===Gr.CONTINUOUS?(al(Z),this.__addNewSectionByContinuous(Ke,J,ue),H=!0):Ke=Si(Pe,ie,Ke==null?void 0:Ke.pageNumber);const K=this.getContext(),qe=wf(Ce.blockElements,Ke,Pe,ie,this._renderedBlockIdMap,K);Te===Gr.CONTINUOUS&&J.length>0;const{pages:Or,renderedBlockIdMap:ar}=qe;H&&Or.splice(0,1),Z.push(...Or)}return al(Z),L}__addNewSectionByContinuous(e,t,n){const s=e.sections,i=s[s.length-1],{pageWidth:o,pageHeight:a,marginTop:l,marginBottom:u,marginLeft:c,marginRight:h}=e,f=o-c-h,d=a-l-u,m=((i==null?void 0:i.top)||0)+((i==null?void 0:i.height)||0),g=mf(t,n,m,0,f,d-m);g.parent=e,s.push(g)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}static create(e,t){return new Zl(e,t)}}class j1 extends ff{constructor(e,t,n=!1){super(e),this._skeleton=t,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new Bi),this.onIsAddedToParentObserver.add(s=>{var i;(i=s==null?void 0:s.getEngine())==null||i.onTransformChangeObservable.add(o=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas()})}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();e.save(),e.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(e,t),e.restore()}_getBounding(e){}_draw(e,t){}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===Ge.SCENE&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}}var ul=(r=>(r[r.SPAN=0]="SPAN",r[r.LINE=1]="LINE",r))(ul||{});class na extends cf{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}const K1="DefaultDocsFontAndBaseLineExtension";class Z1 extends na{constructor(){super(...arguments),this.uKey=K1,this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,n){var d;if(!((d=n.parent)==null?void 0:d.parent))return;const{ts:i,content:o,fontStyle:a,bBox:l}=n;let{spanPointWithFont:u=Re.create(0,0)}=this.extensionOffset;if(!i){o!=null&&e.fillText(o,u.x,u.y);return}if(o==null)return;this._preFontString!==(a==null?void 0:a.fontString)&&(e.font=this._preFontString=(a==null?void 0:a.fontString)||"");const{cl:c,va:h}=i,f=zt(c)||Ar;if(f&&this._preFontColor!==f&&(e.fillStyle=f),h===un.SUBSCRIPT||h===un.SUPERSCRIPT){let m=l.spo;h===un.SUPERSCRIPT&&(m=-l.sbo),u.y+=m}e.fillText(o,u.x,u.y)}clearCache(){this._preFontString="",this._preFontColor=""}}Hi.add(new Z1);const q1="DefaultDocsBackgroundExtension";class J1 extends na{constructor(){super(...arguments),this.uKey=q1,this.zIndex=10,this._preBackgroundColor=""}draw(e,t,n){var f;const s=(f=n.parent)==null?void 0:f.parent;if(!s)return;const{lineHeight:i=0}=s,{ts:o,width:a,content:l}=n;if(!o)return;const{bg:u}=o;if(!u)return;const c=zt(u),{spanStartPoint:h=Re.create(0,0)}=this.extensionOffset;c&&(e.fillStyle=c,e.fillRect(h.x-.5,h.y,a+1,i))}clearCache(){this._preBackgroundColor=""}}Hi.add(new J1);const Q1="DefaultDocsLineExtension";class ep extends na{constructor(){super(...arguments),this.uKey=Q1,this.zIndex=40,this._preBackgroundColor=""}draw(e,t,n){var I;const s=(I=n.parent)==null?void 0:I.parent;if(!s)return;const{asc:i=0,lineHeight:o=0}=s,{ts:a,left:l,width:u,bBox:c}=n;if(!a)return;const{sp:h}=c,f=Us(t),{ul:d,st:m,ol:g}=a,{originTranslate:p=Re.create(0,0),centerPoint:_=Re.create(0,0),alignOffset:v=Re.create(0,0),renderConfig:w={}}=this.extensionOffset,{centerAngle:y=0,vertexAngle:A=0}=w;if(d){const{s:R,cl:x,t:S}=d;if(R===te.TRUE){e.beginPath();const k=zt(x)||Ar;e.strokeStyle=k,this._setLineType(e,S||Et.SINGLE);const N=Le(o+Ic-.5,f),O=pr(p.addByPoint(l,N),_,y,A,v),D=pr(p.addByPoint(l+u,N),_,y,A,v);e.moveTo(O.x,O.y),e.lineTo(D.x,D.y),e.stroke()}}if(m){const{s:R,cl:x,t:S}=m;if(R===te.TRUE){e.beginPath();const k=zt(x)||Ar;e.strokeStyle=k,this._setLineType(e,S||Et.SINGLE);const N=Le(h-.5,f),O=pr(p.addByPoint(l,N),_,y,A,v),D=pr(p.addByPoint(l+u,N),_,y,A,v);e.moveTo(O.x,O.y),e.lineTo(D.x,D.y),e.stroke()}}if(g){const{s:R,cl:x,t:S}=g;if(R===te.TRUE){e.beginPath();const k=zt(x)||Ar;e.strokeStyle=k,this._setLineType(e,S||Et.SINGLE);const N=Le(-Ic-.5,f),O=pr(p.addByPoint(l,N),_,y,A,v),D=pr(p.addByPoint(l+u,N),_,y,A,v);e.moveTo(O.x,O.y),e.lineTo(D.x,D.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===Et.DASH_DOT_DOT_HEAVY||t===Et.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===Et.DASH_DOT_HEAVY||t===Et.DOT_DASH?e.setLineDash([2,5,2]):t===Et.DOTTED||t===Et.DOTTED_HEAVY?e.setLineDash([2]):t===Et.DASH||t===Et.DASHED_HEAVY?e.setLineDash([3]):t===Et.DASH_LONG||t===Et.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===Et.WAVY_HEAVY||e===Et.DASHED_HEAVY||e===Et.DOTTED_HEAVY||e===Et.DASH_DOT_HEAVY||e===Et.DASH_LONG_HEAVY||e===Et.DASH_DOT_DOT_HEAVY?t=2:e===Et.THICK&&(t=3),t}}Hi.add(new ep);const tp="DefaultDocsBorderExtension";class np extends na{constructor(){super(...arguments),this.uKey=tp,this.zIndex=30,this._preBorderColor=""}draw(e,t,n){var m;const s=(m=n.parent)==null?void 0:m.parent;if(!s)return;const{asc:i=0,lineHeight:o=0}=s,{ts:a,left:l,width:u}=n;if(!a)return;const{bd:c}=a;if(!c)return;const h=this._getScale(t),f=this._createBorderCache(c),{spanStartPoint:d=Re.create(0,0)}=this.extensionOffset;for(let g of f.keys()){const p=f.get(g);if(!p)continue;const{s:_,cl:v}=p,w=zt(v)||Ar;_!==this._preBorderStyle&&(tf(e,_),e.lineWidth=nf(_)/h,this._preBorderStyle=_),w!==this._preBorderColor&&(e.strokeStyle=w||Ar,this._preBorderColor=w),ef(e,g,{startX:d.x,startY:d.y,endX:d.x+u,endY:d.y+o})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:n,l:s,r:i}=e,o=new Map;return t&&o.set(Ht.TOP,t),n&&o.set(Ht.BOTTOM,n),s&&o.set(Ht.LEFT,s),i&&o.set(Ht.RIGHT,i),o}}Hi.add(new np);var Eo=(r=>(r[r.page=0]="page",r[r.section=1]="section",r[r.column=2]="column",r[r.line=3]="line",r[r.divide=4]="divide",r[r.span=5]="span",r))(Eo||{});const as={page:0,section:1,column:2,line:3,divide:4,span:5},rp="__TestSelectionRange__",sp="__TestSelectionAnchor__";class Xc{constructor(e,t,n){this._scene=e,this.startNodePosition=t,this.endNodePosition=n,this._current=!1,this._Liquid=new ll,this._cursor=0,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(e,t){return e.page>t.page?!1:e.page<t.page?!0:e.section>t.section?!1:e.section<t.section?!0:e.column>t.column?!1:e.column<t.column?!0:e.line>t.line?!1:e.line<t.line?!0:e.divide>t.divide?!1:e.divide<t.divide?!0:e.span>t.span?!1:(e.span<t.span,!0)}_compareNodePosition(e,t){return this._compareNodePositionLogic(e,t)?{start:e,end:t}:{start:t,end:e}}_setNodePositionState(e=0,t,n,s){s===t?this._currentStartState[e]=1:this._currentStartState[e]=0,s===n?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,t=!0){let n=e,s;for(;n>=0;){const i=Eo[n];let o;if(t?o=this._currentStartState[i]:o=this._currentEndState[i],o===void 0)return;if(s===void 0&&(s=o),o!==s)return 0;n--}return s}_getSelectionRuler(e,t,n,s,i){let o=0,a=s;const l=Eo[e],u=Eo[e+1];if(u===null||l===null)return{start_nest:o,end_nest:a};const c=t[l],h=n[l];this._setNodePositionState(l,c,h,i);const f=this._checkPreviousNodePositionState(e),d=this._checkPreviousNodePositionState(e,!1);return f===1&&(o=t[u]),d===2&&(a=n[u]),{start_nest:o,end_nest:a}}_pushToPoints(e){const{startX:t,startY:n,endX:s,endY:i}=e,o=[];return o.push({x:t,y:n}),o.push({x:s,y:n}),o.push({x:s,y:i}),o.push({x:t,y:i}),o.push({x:t,y:n}),o}isSamePosition(){const e=this.startNodePosition,t=this.endNodePosition;if(e==null||t==null)return!1;const n=Object.keys(as);for(let s of n){const i=e[s],o=t[s];if(i!==o)return!1}return!0}_createAndUpdateRange(e,t,n){if(this._rangeShape){this._rangeShape.translate(t,n),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}const s=new Vl(rp+Rt(6),{pointsGroup:e,fill:xt(Cr.black,.2),left:t,top:n,evented:!1});this._rangeShape=s,this._scene.addObject(s,2)}_getAnchorBounding(e){const t=e[0],n=t[0],s=t[2],{x:i,y:o}=n,{x:a,y:l}=s;return{left:i,top:o,width:a-i,height:l-o}}_createAndUpdateAnchor(e,t,n){const s=this._getAnchorBounding(e),{left:i,top:o,width:a,height:l}=s;if(this._anchorShape){this._anchorShape.transformByState({left:i+t,top:o+n,height:l}),this._anchorShape.show();return}const u=new rt(sp+Rt(6),{left:i+t,top:o+n,height:l,strokeWidth:1,stroke:xt(Cr.black),evented:!1});this._anchorShape=u,this._scene.addObject(u,2)}_getRangePointData(e,t,n){const s=[],i=[];if(e==null||t==null)return{pointGroup:s,cursorList:i};const{start:o,end:a}=this._compareNodePosition(e,t),l=o.isBack,u=a.isBack;return this._selectionIterator(o,a,n,(c,h,f,d)=>{var F;const{lineHeight:m}=d,{spanGroup:g,st:p}=f,{x:_,y:v}=this._Liquid;let w;const y=g[c],A=g[h],I=(y==null?void 0:y.left)||0,R=(y==null?void 0:y.width)||0,x=(A==null?void 0:A.left)||0,S=(A==null?void 0:A.width)||0;let k=(y==null?void 0:y.spanType)===hn.LIST,N=((F=g[0])==null?void 0:F.spanType)===hn.LIST,O=c+p,D=h+p;const E=o===a;if(c===0&&h===g.length-1)w={startX:_+I+(k?R:0),startY:v,endX:_+x+S,endY:v+m};else{const j=(l||c===0&&!E)&&!k,L=u&&h!==g.length-1;O+=j?0:1,O-=N?1:0,D+=L?0:1,D-=N?1:0,console.log("span",{hasList:N,isStartBackFin:j,isEndBackFin:L,firstSpan:y,lastSpan:A,start_sp:c,end_sp:h,isStartBack:l,isEndBack:u,cursorStart:O,cursorEnd:D,isCurrentList:k}),w={startX:_+I+(j?0:R),startY:v,endX:_+x+(L?0:S),endY:v+m}}s.push(this._pushToPoints(w)),i.push({cursorStart:O,cursorEnd:D,isCollapse:E})}),{pointGroup:s,cursorList:i}}_selectionIterator(e,t,n,s){const i=n.getSkeleton();if(!i)return[];this._Liquid.reset();const a=i.getSkeletonData().pages,{page:l}=e,{page:u}=t;this._resetCurrentNodePositionState();for(let c=0;c<=l-1;c++){const h=a[c];this._Liquid.translatePage(h,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}for(let c=l;c<=u;c++){const h=a[c],f=h.sections,{start_nest:d,end_nest:m}=this._getSelectionRuler(as.page,e,t,f.length-1,c);this._Liquid.translatePagePadding(h);for(let g=d;g<=m;g++){const p=f[g],_=p.columns,{start_nest:v,end_nest:w}=this._getSelectionRuler(as.section,e,t,_.length-1,g);this._Liquid.translateSection(p);for(let y=v;y<=w;y++){const A=_[y],I=A.lines,{start_nest:R,end_nest:x}=this._getSelectionRuler(as.column,e,t,I.length-1,y);this._Liquid.translateColumn(A);for(let S=R;S<=x;S++){const k=I[S],{divides:N,type:O,lineHeight:D=0}=k,{start_nest:E,end_nest:F}=this._getSelectionRuler(as.line,e,t,N.length-1,S);this._Liquid.translateSave(),this._Liquid.translateLine(k);for(let j=E;j<=F;j++){const L=N[j];this._Liquid.translateSave(),this._Liquid.translateDivide(L);const re=L.spanGroup,{start_nest:Y,end_nest:ee}=this._getSelectionRuler(as.divide,e,t,re.length-1,j);s&&s(Y,ee,L,k,A,p,h),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}}}_setCursor(e){if(e.length===0)return;const t=e[0];this._cursor=t.cursorStart,console.log("_setCursor",t.cursorStart,t)}getCursor(){return this._cursor}getAnchor(){return this._anchorShape}activeStatic(){var e;(e=this._anchorShape)==null||e.setProps({stroke:xt(Cr.black,1)})}deactivateStatic(){var e;(e=this._anchorShape)==null||e.setProps({stroke:xt(Cr.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return this.startNodePosition==null&&this.endNodePosition==null}isCollapsed(){return!!(this.startNodePosition!=null&&this.endNodePosition==null||this.isSamePosition())}isRange(){const e=this.startNodePosition,t=this.endNodePosition;return!(e==null||t==null||this.isSamePosition())}dispose(){var e,t;(e=this._rangeShape)==null||e.dispose(),this._rangeShape=null,(t=this._anchorShape)==null||t.dispose(),this._anchorShape=null}isIntersection(e){return!1}refresh(e){var a,l;const t=this.startNodePosition,n=this.endNodePosition;if((a=this._anchorShape)==null||a.hide(),(l=this._rangeShape)==null||l.hide(),this.isEmpty())return;if(this.isCollapsed()){const u=this._getRangePointData(t,t,e),{pointGroup:c,cursorList:h}=u;this._setCursor(h),c.length>0&&this._createAndUpdateAnchor(c,e.left,e.top);return}const s=this._getRangePointData(t,n,e),{pointGroup:i,cursorList:o}=s;this._setCursor(o),i.length>0&&this._createAndUpdateRange(i,e.left,e.top)}getStart(){if(this.startNodePosition==null)return this.endNodePosition;if(this.endNodePosition==null)return this.startNodePosition;const{start:e}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return e}}class ql{constructor(e){var t;this._documents=e,this._textSelectionList=[],this._viewPortObserverMap=new Map,this.onKeydownObservable=new Ae,this.onInputObservable=new Ae,this.onCompositionstartObservable=new Ae,this.onCompositionupdateObservable=new Ae,this.onCompositionendObservable=new Ae,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=(t=this._documents)==null?void 0:t.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}_initialDom(){const e=document.createElement("div");e.style.position="absolute",e.style.position="absolute",e.style.left="0px",e.style.top="0px";const t=document.createElement("div"),n=document.createElement("div"),s=document.createElement("div");t.appendChild(n),e.appendChild(t),e.appendChild(s),this._container=e,this._inputParent=t,this._input=n,this._cursor=s,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(e)}_initialInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.style.cssText=`
            position: absolute; 
            overflow: hidden; 
            opacity: 1; 
            background: #000; 
            color: transparent; 
            outline: none; 
            z-index: -2; 
            caret-color: transparent; 
            white-space: pre-wrap; 
            user-select: text;
        `}_initialCursorDom(){this._cursor.style.cssText=`
            visibility: visible;
            position: absolute;
            background: #000;
            left: 0;
            top: 0;
            width: 1px;
            height: 20px;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            display: none
        `,Sm("keyframes univer_cursor_blinkStyle")||ym([`
                @-webkit-keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }
                
                    100% {
                        opacity: 1;
                    }
                }
            `,`
                @keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }
                
                    100% {
                        opacity: 1;
                    }
                }
            `])}_getSkeletonData(){var e,t;return(t=(e=this._documents)==null?void 0:e.getSkeleton())==null?void 0:t.getSkeletonData()}_getNodePosition(e){var o;if(e===!1)return;const{node:t,ratioX:n,ratioY:s}=e,i=(o=this._documents)==null?void 0:o.findPositionBySpan(t);if(i!=null)return{...i,isBack:n<.5}}_interactTextSelection(e){const t=[];let n=!1;this._textSelectionList.forEach(s=>{e.isIntersection(s)?(n=!0,s.dispose()):t.push(s)}),n&&(t.push(e),this._textSelectionList=t)}_deleteAllTextSelection(){this._textSelectionList.forEach(e=>{e.dispose()}),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach(e=>{e.deactivate()})}_addTextSelection(e){this._deactivateTextSelection(),e.activate(),this._textSelectionList.push(e)}_updateTextSelection(e){if(!this._documents)return;let t=this._textSelectionList.pop();t||(t=new Xc(this._documents.getScene(),e)),this._deleteAllTextSelection(),t.activate(),t.startNodePosition=e,t.endNodePosition=null,this._textSelectionList=[t]}_getActiveTextSelection(){const e=this._textSelectionList;for(let t of e)if(t.isActive())return t}_isEmptyTextSelection(){return this._textSelectionList.length===0}_getCanvasOffset(){var i,o;const e=(i=this._documents)==null?void 0:i.getEngine(),t=(o=e==null?void 0:e.getCanvas())==null?void 0:o.getCanvasEle();if(!t)return{left:0,top:0};const{top:n,left:s}=Nm(t);return{left:s,top:n}}_syncDomToSelection(){var u;const e=this._getActiveTextSelection(),t=e==null?void 0:e.getAnchor();if(!t||t&&!t.visible)return;const{height:n,left:s,top:i}=t,o=(u=this._activeViewport)==null?void 0:u.getAbsoluteVector(Re.FromArray([s,i]));this._cursor.style.height=`${n}px`;let{left:a,top:l}=this._getCanvasOffset();a+=(o==null?void 0:o.x)||0,l+=(o==null?void 0:o.y)||0,this.active(a,l)}_moving(e,t,n){if(vs(n),!this._documents)return;const s=this._documents.findNodeByCoord(e,t),i=this._getNodePosition(s);if(!i)return;const o=this._getActiveTextSelection();!o||(o.endNodePosition=i,o.refresh(this._documents),this._interactTextSelection(o))}_attachScrollEvent(e){if(!e)return;const t=e.viewPortKey;if(this._viewPortObserverMap.has(t))return;const n=e.onScrollBeforeObserver.add(i=>{if(!i.viewport)return;const a=this._getActiveTextSelection();a==null||a.activeStatic(),this._cursor.style.display="none"}),s=e.onScrollStopObserver.add(i=>{const o=i.viewport;if(!o)return;const a=o.getBounding(),l=this._getActiveTextSelection(),u=l==null?void 0:l.getAnchor();if(!(!u||u&&!u.visible)){if(a){const{minX:c,maxX:h,minY:f,maxY:d}=of(u,a);if(u.strokeWidth<c||h<0||u.strokeWidth<f||d<0)return}this._syncDomToSelection(),l==null||l.deactivateStatic(),this._cursor.style.display="revert"}});this._viewPortObserverMap.set(t,{scrollBefore:n,scrollStop:s})}_attachInputEvent(){this._input.addEventListener("keydown",e=>{if(this._isIMEInputApply)return;const t=this._getActiveTextSelection();this._documents!=null&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:e,content:"",document:this._documents,selection:t}))}),this._input.addEventListener("input",e=>{if(this._isIMEInputApply)return;const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onInputObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})}),this._input.addEventListener("compositionstart",e=>{this._isIMEInputApply=!0;const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onCompositionstartObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})}),this._input.addEventListener("compositionend",e=>{this._isIMEInputApply=!1;const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onCompositionendObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})}),this._input.addEventListener("compositionupdate",e=>{const t=this._input.textContent||"";this._input.innerHTML="";const n=this._getActiveTextSelection();this._documents!=null&&this.onCompositionupdateObservable.notifyObservers({event:e,content:t,document:this._documents,selection:n})})}_attachSelectionEvent(e){this._moveInObserver=e.onPointerEnterObserver.add(()=>{e.cursor=gt.TEXT}),this._moveOutObserver=e.onPointerLeaveObserver.add(()=>{e.cursor=gt.DEFAULT,t.resetCursor()});const t=e.getScene();this._downObserver=e.onPointerDownObserver.add((n,s)=>{const{offsetX:i,offsetY:o}=n;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(i,o);const a=this._documents.findNodeByCoord(i,o),l=this._getNodePosition(a);if(console.log(a,i,o),!l){this._deleteAllTextSelection();return}if(n.ctrlKey||this._isEmptyTextSelection()){const f=new Xc(this._documents.getScene(),l);this._addTextSelection(f)}else this._updateTextSelection(l);this._activeSelectionRefresh(),this._syncDomToSelection(),t.disableEvent();const u=Kr.create(t);u.startScroll(i,o);const{scrollX:c,scrollY:h}=vs(u);this._viewportScrollX=c,this._viewportScrollY=h,this._moveObserver=t.onPointerMoveObserver.add(f=>{const{offsetX:d,offsetY:m}=f;this._moving(d,m,u),u.scrolling(d,m,()=>{this._moving(d,m,u)}),t.setCursor(gt.TEXT)}),this._upObserver=t.onPointerUpObserver.add(f=>{t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent(),u.stopScroll()})})}_detachEvent(e){var t;e.onPointerEnterObserver.remove(this._moveInObserver),e.onPointerLeaveObserver.remove(this._moveOutObserver),e.onPointerDownObserver.remove(this._downObserver),(t=e.getSkeleton())==null||t.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const e=this._getActiveTextSelection();e==null||e.refresh(this._documents)}add(e){this._addTextSelection(e)}remain(){const e=this._getActiveTextSelection();if(e==null)return;const t=this._textSelectionList.indexOf(e);return this._textSelectionList.splice(t,1)[0]}sync(){this._syncDomToSelection()}active(e,t){this._container.style.left=`${e}px`,this._container.style.top=`${t}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout(()=>{this._input.focus()},0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(e){var t;this._documents&&this._detachEvent(this._documents),this._documents=e,this._skeletonObserver=(t=e.getSkeleton())==null?void 0:t.onRecalculateChangeObservable.add(n=>{this._deleteAllTextSelection()}),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}set activeViewport(e){this._attachScrollEvent(e),this._activeViewport=e}static create(e){return new ql(e)}}class Jl extends j1{constructor(e,t,n){super(e,t,n==null?void 0:n.allowCache),this._hasEditor=!1,this.isCalculateSkeleton=!0,this.onPageRenderObservable=new Ae,(n==null?void 0:n.pageMarginLeft)===void 0?this.pageMarginLeft=17:this.pageMarginLeft=n==null?void 0:n.pageMarginLeft,(n==null?void 0:n.pageMarginTop)===void 0?this.pageMarginTop=14:this.pageMarginTop=n==null?void 0:n.pageMarginTop,this.pageLayoutType=(n==null?void 0:n.pageLayoutType)||Jn.VERTICAL,this._drawLiquid=new ll,this._findLiquid=new ll,this._hasEditor=(n==null?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(t),this.makeDirty(!0)}_draw(e,t){this.draw(e,t)}_horizontalHandler(e,t,n,s){let i=0;return s===ct.CENTER?i=(this.width-e)/2:s===ct.RIGHT?i=this.width-e-n:i=t,i}_verticalHandler(e,t,n,s){let i=0;return s===rn.MIDDLE?i=(this.height-e)/2:s===rn.BOTTOM?i=this.height-e-n:i=t,i}_startRotation(e,t){e.rotate(t||0)}_resetRotation(e,t){e.rotate(-t||0)}_initialDefaultExtension(){Hi.getData().forEach(e=>{this.register(e)})}_addSkeletonChangeObserver(e){!e||(this._skeletonObserver=e.onRecalculateChangeObservable.add(t=>{const n=t.pages;let s=0,i=0;for(let o=0,a=n.length;o<a;o++){const l=n[o],{pageWidth:u,pageHeight:c}=l;this.pageLayoutType===Jn.VERTICAL?(i+=c,o!==a-1&&(i+=this.pageMarginTop),s=Math.max(s,u)):this.pageLayoutType===Jn.HORIZONTAL&&(s+=u,o!==a-1&&(s+=this.pageMarginLeft),i=Math.max(i,c))}this.resize(s,i),this.calculatePagePosition()}))}_disposeSkeletonChangeObserver(e){!e||e.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(e){const{pageWidth:t,pageHeight:n}=e;let{x:s,y:i}=this._findLiquid,o=-1,a=-1;return this.pageLayoutType===Jn.VERTICAL?(o=t,a=i+n):this.pageLayoutType===Jn.HORIZONTAL&&(o=s+t,a=n),{startX:s,startY:i,endX:o,endY:a}}calculatePagePosition(e){const t=this.getScene();e==null&&(e=t==null?void 0:t.getEngine());const{width:n,height:s,pageMarginLeft:i,pageMarginTop:o}=this;if(e==null)return;const{width:a,height:l}=e;let u=0,c=0,h=0,f=0;a>n?(u=a/2-n/2,h=a-30):(u=i,h=n+i*2),l>s?(c=l/2-s/2,f=l-30):(c=o,f=s+o*2),t.resize(h,f+200),this.translate(u,c)}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(e,t){return this.getScene().getActiveViewportByCoord(Re.FromArray([e,t]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=ql.create(this),this._hasEditor=!0)}disableEditor(){var e;(e=this._editor)==null||e.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:n,onCompositionendObservable:s,onKeydownObservable:i}=this._editor;return{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:n,onCompositionendObservable:s,onKeydownObservable:i}}remainActiveSelection(){if(!!this._hasEditor)return this._editor.remain()}addSelection(e){if(!!this._hasEditor)return this._editor.add(e)}syncSelection(){if(!!this._hasEditor)return this._editor.sync()}get hasEditor(){return this._hasEditor}draw(e,t){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const s=n.getSkeletonData(),{pages:i}=s,o=this.getParentScale(),a=this.getExtensionsByOrder(),l=Us(o);for(let h of a)h.clearCache();let u=0,c=0;for(let h=0,f=i.length;h<f;h++){const d=i[h],{sections:m,marginTop:g=0,marginBottom:p=0,marginLeft:_=0,marginRight:v=0,width:w,height:y,renderConfig:A={}}=d,{verticalAlign:I=rn.TOP,horizontalAlign:R=ct.LEFT,centerAngle:x=0,vertexAngle:S=0,wrapStrategy:k=Mt.UNSPECIFIED,isRotateNonEastAsian:N=te.FALSE}=A,O=this._horizontalHandler(w,_,v,R),D=this._verticalHandler(y,g,p,I),E=Re.create(O,D),F=gi(x),j=gi(S),L=j-F;this.onPageRenderObservable.notifyObservers({page:d,pageLeft:c,pageTop:u,ctx:e}),this._startRotation(e,L);for(let ee of m){const{columns:U}=ee;this._drawLiquid.translateSection(ee);for(let V of U){const{lines:_e,width:ie}=V;this._drawLiquid.translateColumn(V);const Z=_e.length;let le,ve=null;if(j!==0){const{rotateTranslateXList:Ce,rotatedHeight:ge,rotatedWidth:ye,fixOffsetX:Me,fixOffsetY:Ze,rotateTranslateY:ke}=sf(_e,ie,j);let T=ye;ge>this.height&&k!==Mt.WRAP&&(k===Mt.OVERFLOW||j>0)&&(T=this.height/Math.tan(Math.abs(j)));const se=this._horizontalHandler(T,_,v,R);let B=this._verticalHandler(ge,g,p,I)-Ze;ge>this.height&&(j<0?B=this.height-(ge+Ze):B=-Ze),le=Re.create(se+Me,B),this._drawLiquid.translate(0,-ke),ve=Ce}else le=E;for(let Ce=0;Ce<Z;Ce++){const ge=_e[Ce],{divides:ye,asc:Me=0,type:Ze,lineHeight:ke=0}=ge;let T=Me;const se=T*Math.sin(F),ne=T*Math.cos(F);if(Ze===Lo.BLOCK)for(let B of a)B.type===ul.LINE&&(B.extensionOffset={alignOffset:le,renderConfig:A},B.draw(e,o,ge));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(ge,!0),ve&&this._drawLiquid.translate(ve[Ce]);const B=ye.length;for(let M=0;M<B;M++){const X=ye[M],{spanGroup:ae}=X;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(X);for(let oe of ae){if(!oe.content||oe.content.length===0)continue;const{width:$,left:he}=oe,{x:P,y:z}=this._drawLiquid,J=Re.create(Le(P,l),Le(z,l)),ue=Re.create(Le($/2,l),Le(ke/2,l)),de=pr(J.addByPoint(Le(he,l),0),ue,F,j,le),Fe=pr(J.addByPoint(Le(he+se,l),Le(ne,l)),ue,F,j,le),xe={originTranslate:J,spanStartPoint:de,spanPointWithFont:Fe,centerPoint:ue,alignOffset:le,renderConfig:A};for(let Oe of a)Oe.type===ul.SPAN&&(Oe.extensionOffset=xe,Oe.draw(e,o,oe))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,L);const{x:re,y:Y}=this._drawLiquid.translatePage(d,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);c+=re,u+=Y}}changeSkeleton(e){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(e),this._addSkeletonChangeObserver(e),this}findPositionBySpan(e){var m;const t=e.parent,n=t==null?void 0:t.parent,s=n==null?void 0:n.parent,i=s==null?void 0:s.parent,o=i==null?void 0:i.parent,a=(m=this.getSkeleton())==null?void 0:m.getSkeletonData();if(!t||!s||!i||!o||!a)return;let l=t.spanGroup.indexOf(e);const u=n.divides.indexOf(t),c=s.lines.indexOf(n),h=i.columns.indexOf(s),f=o.sections.indexOf(i),d=a.pages.indexOf(o);return{span:l,divide:u,line:c,column:h,section:f,page:d}}findNodeByCharIndex(e){const t=this.getSkeleton();if(!t)return;const s=t.getSkeletonData().pages;for(let i of s){const{sections:o,st:a,ed:l}=i;if(!(e<a||e>l))for(let u of o){const{columns:c,st:h,ed:f}=u;if(!(e<h||e>f))for(let d of c){const{lines:m,st:g,ed:p}=d;if(!(e<g||e>p))for(let _ of m){const{divides:v,lineHeight:w,st:y,ed:A}=_,I=v.length;if(!(e<y||e>A))for(let R=0;R<I;R++){const x=v[R],{spanGroup:S,st:k,ed:N}=x;if(e<k||e>N)continue;const O=S[e-k];if(O)return O}}}}}}findNodeByCoord(e,t){const s=this.getScene().transformToSceneCoord(Re.FromArray([e,t]));if(!s)return!1;const i=this._getInverseCoord(s);let{x:o,y:a}=i;const l=this.getSkeleton();if(!l)return!1;this._findLiquid.reset();const c=l.getSkeletonData().pages;for(let h=0,f=c.length;h<f;h++){const d=c[h],{startX:m,startY:g,endX:p,endY:_}=this._getPageBoundingBox(d);if(!(o>=m&&o<=p&&a>=g&&a<=_)){this._translatePage(d);continue}this._findLiquid.translatePagePadding(d);const v=d.sections;for(let w of v){const{columns:y,height:A}=w;this._findLiquid.translateSection(w);const{y:I}=this._findLiquid;if(a>=I&&a<=I+A)for(let R of y){const{lines:x,width:S}=R;this._findLiquid.translateColumn(R);const{x:k}=this._findLiquid;if(!(o>=k&&o<=k+S))continue;const N=x.length;for(let O=0;O<N;O++){const D=x[O],{divides:E,type:F,lineHeight:j=0}=D;if(F!==Lo.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(D);const{y:L}=this._findLiquid,re=L,Y=L+j;if(!(a>=re&&a<=Y)){this._findLiquid.translateRestore();continue}const ee=E.length;for(let U=0;U<ee;U++){const V=E[U],{spanGroup:_e,width:ie}=V;this._findLiquid.translateSave(),this._findLiquid.translateDivide(V);const{x:Z}=this._findLiquid;if(!(o>=Z&&o<=Z+ie)){this._findLiquid.translateRestore();continue}for(let le of _e){if(!le.content||le.content.length===0)continue;const{width:ve,left:Ce}=le,ge=Z+Ce,ye=Z+Ce+ve;if(o>=ge&&o<=ye)return{node:le,ratioX:o/(ge+ye),ratioY:a/(re+Y)}}this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(d),this._translatePage(d)}return!1}_translatePage(e){this._findLiquid.translatePage(e,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}static create(e,t,n){return new Jl(e,t,n)}}class Tf extends ff{constructor(e,t){super(e),this._skeleton=t}getSkeleton(){return this._skeleton}updateSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;e.save(),this._draw(e,t),e.restore()}getParentScale(){let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===Ge.SCENE_VIEWER&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}_getBounding(e,t,n){const s=e.length,i=t.length;if(!n)return{startRow:0,endRow:s-1,startColumn:0,endColumn:i-1};let o=-1,a=-1,l=-1,u=-1;return o=Un(e,n.tl.y),a=Un(e,n.bl.y),o===-1&&(o=0),a===-1&&(a=s-1),a>=s&&(a=s-1),l=Un(t,n.tl.x),u=Un(t,n.tr.x),l===-1&&(l=0),u===-1&&(u=i-1),u>=i&&(u=i-1),{startRow:o-1,endRow:a+1,startColumn:l-1,endColumn:u+1}}_draw(e,t){}}class yf extends Tf{_draw(e,t){this.draw(e,t)}}class zs extends cf{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,n,s,i){return ri(e,t,n,s,i)}}const ip="DefaultBackgroundExtension";class op extends zs{constructor(){super(...arguments),this.uKey=ip,this.zIndex=20}draw(e,t,n){const{rowTitleWidth:s,columnTitleHeight:i,dataMergeCache:o,stylesCache:a}=n,{background:l}=a;if(!n)return;const{rowHeightAccumulation:u,columnTotalWidth:c,columnWidthAccumulation:h,rowTotalHeight:f}=n;if(!u||!h||c===void 0||f===void 0)return;e.save();const{scaleX:d=1,scaleY:m=1}=t;l&&Object.keys(l).forEach(g=>{const p=l[g];e.fillStyle=g||xt([255,255,255]),e.beginPath(),p.forEach((_,v)=>{v.forEach(w=>{let{isMerged:y,startY:A,endY:I,startX:R,endX:x}=this.getCellIndex(_,w,u,h,o);if(y)return!0;A=Le(A,m),I=Le(I,m),R=Le(R,d),x=Le(x,d),e.moveTo(R,A),e.lineTo(R,I),e.lineTo(x,I),e.lineTo(x,A)})}),e.closePath(),e.fill()}),e.restore()}}Pi.add(new op);const ap="DefaultBorderExtension";class lp extends zs{constructor(){super(...arguments),this.uKey=ap,this.zIndex=30}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:i,columnTitleHeight:o,dataMergeCache:a,stylesCache:l,overflowCache:u}=n,{border:c}=l;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:f,columnWidthAccumulation:d,rowTotalHeight:m}=n;if(!h||!d||f===void 0||m===void 0)return;e.save();const{scaleX:g=1,scaleY:p=1}=t,_=this._getScale(t);let v,w;c==null||c.forEach((y,A)=>{A==null||A.forEach((I,R)=>{if(!R)return!0;let{isMerged:x,startY:S,endY:k,startX:N,endX:O}=this.getCellIndex(y,I,h,d,a);if(x)return!0;S=Le(S,p),k=Le(k,p),N=Le(N,g),O=Le(O,g);for(let D in R){const{type:E,style:F,color:j}=R[D];this._getOverflowExclusion(u,E,y,I)||(F!==v&&(tf(e,F),e.lineWidth=nf(F)/_,v=F),j!==w&&(e.strokeStyle=j||Ar,w=j),ef(e,E,{startX:N,startY:S,endX:O,endY:k}))}})}),e.closePath(),e.restore()}_getOverflowExclusion(e,t,n,s){let i=!1;return t===Ht.TOP||t===Ht.BOTTOM||e&&e.forEach((o,a)=>{if(o!==n)return!0;a.forEach((l,u)=>{const{startColumn:c,endColumn:h}=u;if(t===Ht.LEFT&&l>c&&l<=h||t===Ht.RIGHT&&l>=c&&l<h)return i=!0,!1})}),i}}Pi.add(new lp);const up="DefaultBorderAuxiliaryExtension";class cp extends zs{constructor(){super(...arguments),this.uKey=up,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:i=0,columnTitleHeight:o=0,dataMergeCache:a,overflowCache:l,stylesCache:u,showGridlines:c}=n,{startRow:h,endRow:f,startColumn:d,endColumn:m}=s;if(!n||c===te.FALSE)return;const{rowHeightAccumulation:g,columnTotalWidth:p,columnWidthAccumulation:_,rowTotalHeight:v}=n;if(!g||!_||p===void 0||v===void 0)return;e.save();const w=this._getScale(t);e.beginPath(),e.lineWidth=1/w,e.strokeStyle=xt([217,217,217]);let y=Le(p,w),A=Le(v,w);const I=_.length,R=g.length;for(let x=h-1;x<=f;x++){if(x<0||x>R-1)continue;const S=Le(g[x],w);e.moveTo(0,S),e.lineTo(y,S)}for(let x=d;x<=m;x++){if(x<0||x>I-1)continue;const S=Le(_[x],w);e.moveTo(S,0),e.lineTo(S,A)}e.stroke(),e.closePath(),this._clearRectangle(e,w,g,_,a),this._clearRectangle(e,w,g,_,l),e.restore()}_clearRectangle(e,t,n,s,i){i==null||i.forEach((o,a)=>{a==null||a.forEach((l,u)=>{const{startRow:c,endRow:h,startColumn:f,endColumn:d}=u,m=Le(n[c-1]||0,t),g=Le(n[h],t),p=Le(s[f-1]||0,t),_=Le(s[d],t);e.clearRect(p,m,_-p,g-m),e.beginPath(),e.moveTo(p,m),e.lineTo(_,m),e.lineTo(_,g),e.lineTo(p,g),e.lineTo(p,m),e.stroke(),e.closePath()})})}}Pi.add(new cp);const hp="DefaultFontExtension";class dp extends zs{constructor(){super(...arguments),this.uKey=hp,this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,n){this.changeFontColor.setValue(e,t,n)}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:i,columnTitleHeight:o,stylesCache:a,dataMergeCache:l,overflowCache:u}=n,{font:c}=a;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:f,columnWidthAccumulation:d,rowTotalHeight:m}=n;if(!h||!d||f===void 0||m===void 0)return;e.save();const g=this._getScale(t),{scaleX:p=1,scaleY:_=1}=t;c&&Object.keys(c).forEach(v=>{c[v].forEach((y,A)=>{A.forEach((I,R)=>{let{isMerged:x,isMergedMainCell:S,startY:k,endY:N,startX:O,endX:D,mergeInfo:E}=this.getCellIndex(y,I,h,d,l);if(x)return!0;k=Le(k,_),N=Le(N,_),O=Le(O,p),D=Le(D,p);const F=D-O,j=N-k,L=u.getValue(y,I),{horizontalAlign:re}=R;if(e.save(),e.beginPath(),L){const{startColumn:Y,startRow:ee,endColumn:U,endRow:V}=L;Y===U&&Y===I?e.rect(O,k,F,j):re===ct.CENTER?this._clipRectangle(e,ee,V,Y,U,g,h,d):re===ct.RIGHT?this._clipRectangle(e,ee,y,Y,I,g,h,d):this._clipRectangle(e,y,V,I,U,g,h,d)}else e.rect(O,k,F,j);e.clip(),e.translate(O,k),this._renderDocuments(e,R,O,k,D,N,y,I),e.restore()})})}),e.restore()}_renderDocuments(e,t,n,s,i,o,a,l){const u=this.getDocuments(),{documentSkeleton:c,angle:h,verticalAlign:f,horizontalAlign:d,wrapStrategy:m,content:g}=t,p=i-n,_=o-s;m===Mt.WRAP&&h===0&&(c.updateDocumentDataPageSize(p),c.calculate()),c.makeDirty(!1),u.resize(p,_),u.changeSkeleton(c).render(e)}_clipRectangle(e,t,n,s,i,o,a,l){const u=Le(a[t-1]||0,o),c=Le(a[n],o),h=Le(l[s-1]||0,o),f=Le(l[i],o);e.rect(h,u,f-h,c-u)}}Pi.add(new dp);const fp="DefaultRowTitleLayoutExtension";class gp extends zs{constructor(){super(...arguments),this.uKey=fp,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:i=0,columnTitleHeight:o=0}=n,{startRow:a,endRow:l,startColumn:u,endColumn:c}=s;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:f,columnWidthAccumulation:d,rowTotalHeight:m}=n;if(!h||!d||f===void 0||m===void 0)return;const g=this._getScale(t);e.fillStyle=xt([248,249,250]),e.fillRect(0,0,i,m),e.textAlign="center",e.textBaseline="middle",e.fillStyle=xt([0,0,0]),e.beginPath(),e.lineWidth=1/g,e.strokeStyle=xt([217,217,217]);let p=0;const _=h.length;for(let v=a-1;v<=l;v++){if(v<0||v>_-1)continue;const w=Le(h[v],g);if(p===w)continue;e.moveTo(0,w),e.lineTo(i,w);const y=p+(w-p)/2;e.fillText(`${v+1}`,i/2,y+Yd),p=w}e.moveTo(Le(i,g),0),e.lineTo(Le(i,g),m),e.stroke()}}hf.add(new gp);const mp="DefaultColumnTitleLayoutExtension";class pp extends zs{constructor(){super(...arguments),this.uKey=mp,this.zIndex=10}draw(e,t,n){const{rowColumnSegment:s,rowTitleWidth:i=0,columnTitleHeight:o=0}=n,{startRow:a,endRow:l,startColumn:u,endColumn:c}=s;if(!n)return;const{rowHeightAccumulation:h,columnTotalWidth:f,columnWidthAccumulation:d,rowTotalHeight:m}=n;if(!h||!d||f===void 0||m===void 0)return;const g=this._getScale(t);e.fillStyle=xt([248,249,250]),e.fillRect(0,0,f,o),e.textAlign="center",e.textBaseline="middle",e.fillStyle=xt([0,0,0]),e.beginPath(),e.lineWidth=1/g,e.strokeStyle=xt([217,217,217]);let p=0;const _=d.length;for(let w=u-1;w<=c;w++){if(w<0||w>_-1)continue;const y=Le(d[w],g);if(p===y)continue;e.moveTo(y,0),e.lineTo(y,o);const A=p+(y-p)/2;e.fillText(d3(w),A,o/2+Yd),p=y}const v=Le(o,g);e.moveTo(0,v),e.lineTo(f,v),e.stroke()}}df.add(new pp);const _p="__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__";class bp extends Tf{constructor(e,t,n=!0){super(e,t),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._documents=new Jl(_p,void 0,{pageMarginLeft:0,pageMarginTop:0}),this._allowCache&&(this._cacheCanvas=new Bi),this.onIsAddedToParentObserver.add(s=>{var i;(i=s==null?void 0:s.getEngine())==null||i.onTransformChangeObservable.add(o=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()}),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}_draw(e,t){this.draw(e,t)}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const i=Us(s),{rowTitleWidth:o,columnTitleHeight:a}=n;e.translate(Le(o,i)-.5/i,Le(a,i)-.5/i),this._calculateOverflow();const l=this.getExtensionsByOrder();for(let u of l)u.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:i}=n;return t.x>s&&t.y>i}getNoMergeCellPositionByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:s,columnWidthAccumulation:i,rowTitleWidth:o,columnTitleHeight:a}=n,{scaleX:l=1,scaleY:u=1}=this.getParentScale();let{startY:c,endY:h,startX:f,endX:d}=Ho(e,t,s,i);return c=Le(c+a,u),h=Le(h+a,u),f=Le(f+o,l),d=Le(d+o,l),{startY:c,endY:h,startX:f,endX:d}}calculateCellIndexByPosition(e,t,n){const s=this.getSkeleton();if(!s)return;const{x:i,y:o}=n,{rowHeightAccumulation:a,columnWidthAccumulation:l,rowTitleWidth:u,columnTitleHeight:c,dataMergeCacheAll:h}=s;e+=i-u,t+=o-c;let f=Un(a,t),d=Un(l,e);if(f===-1){const R=a.length-1;a[R]<=t?f=a.length-1:f=0}if(d===-1){const R=l.length-1;l[R]<=e?d=l.length-1:d=0}const{scaleX:m=1,scaleY:g=1}=this.getParentScale();let{isMerged:p,startY:_,endY:v,startX:w,endX:y,mergeInfo:A,isMergedMainCell:I}=ri(f,d,a,l,h);return _=Le(_+c,g),v=Le(v+c,g),w=Le(w+u,m),y=Le(y+u,m),A=Fc(A,u,c,m,g),{row:f,column:d,startY:_,endY:v,startX:w,endX:y,isMerged:p,isMergedMainCell:I,mergeInfo:A}}getCellByIndex(e,t){const n=this.getSkeleton();if(!n)return;const{scaleX:s=1,scaleY:i=1}=this.getParentScale(),{rowHeightAccumulation:o,columnWidthAccumulation:a,rowTitleWidth:l,columnTitleHeight:u,dataMergeCacheAll:c}=n;let{isMerged:h,startY:f,endY:d,startX:m,endX:g,mergeInfo:p,isMergedMainCell:_}=ri(e,t,o,a,c);return f=Le(f+u,i),d=Le(d+u,i),m=Le(m+l,s),g=Le(g+l,s),p=Fc(p,l,u,s,i),{row:e,column:t,startY:f,endY:d,startX:m,endX:g,isMerged:h,isMergedMainCell:_,mergeInfo:p}}getAncestorScrollXY(e,t){let n=this.getParent(),s=0,i=0;for(;n;){if(n.classType===Ge.SCENE){const a=n.getViewports().find(l=>l.isHit(Re.FromArray([e,t])));if(a){const l=a.actualScrollX||0,u=a.actualScrollY||0;s+=l,i+=u}}n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}return{x:s,y:i}}getSelectionBounding(e,t,n,s){var i;return(i=this.getSkeleton())==null?void 0:i.getMergeBounding(e,t,n,s)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=t;const s=this._cacheCanvas.getContext();if(n){const{dx:i=0,dy:o=0}=n;this._cacheOffsetX=i,this._cacheOffsetY=o}this._cacheCanvas.clear(),s.save(),s.setTransform(e.getTransform()),this._draw(s,n),s.restore(),this._boundsCache=t}this._applyCache(e)}else e.save(),this._draw(e,t),e.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const e=this._getAncestorSize();if(!e||this._cacheCanvas==null)return;const{width:t,height:n}=e,s=this.getSkeleton();s&&(s.rowTitleWidth,s.columnTitleHeight),this._cacheCanvas.setSize(t,n),this.makeDirty(!0)}_getAncestorSize(){const e=this._getAncestorParent();if(!!e){if(e.classType===Ge.ENGINE){const t=e.getCanvas();return{width:t.getWidth(),height:t.getHeight()}}if(e.classType===Ge.SCENE_VIEWER)return{width:e.width,height:e.height}}}_getAncestorParent(){let e=this.parent;for(;e;){if(e.classType===Ge.ENGINE||e.classType===Ge.SCENE_VIEWER)return e;e=(e==null?void 0:e.getParent)&&(e==null?void 0:e.getParent())}}_applyCache(e){!e||(e.save(),e.setTransform(1,0,0,1,0,0),e.drawImage(this._cacheCanvas.getCanvasEle(),0,0),e.restore())}_initialDefaultExtension(){Pi.getData().sort(Ft).forEach(e=>{this.register(e)}),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,e=>{e.onScrollBeforeObserver.add(()=>{this.makeDirty(!0)})})}_hasScrollViewportOperator(e,t){let n=e.getParent();for(;n;){if(n.classType===Ge.SCENE){const s=n.getViewports();this._getHasScrollViewports(s);for(let i of s)i&&t(i)}n=(n==null?void 0:n.getParent)&&(n==null?void 0:n.getParent())}}_getHasScrollViewports(e){const t=[];for(let n of e)n.getScrollBar()&&t.push(n);return t}getDocsSkeletonPageSize(e,t=0){const n=e==null?void 0:e.getSkeletonData();if(!n)return;const{pages:s}=n,i=s[s.length-1];if(t===0){const{width:d,height:m}=i;return{width:d,height:m}}let o=0,a=0;const l=rf(t),u=[];T1([i],d=>{const{lines:m,width:g,spaceWidth:p}=d,{rotatedHeight:_,rotatedWidth:v}=sf(m,g,t);a+=_,u.push({rotatedWidth:v,spaceWidth:p})});const c=Math.tan(t),h=Math.sin(t),f=u.length;for(let d=0;d<f;d++){const{rotatedWidth:m,spaceWidth:g}=u[d];d===0&&(o+=m),(l===Os.UP&&d===0||l===Os.DOWN&&d===f-1)&&(o+=(m+g/h)/c)}return{width:o,height:a}}_calculateOverflow(){const e=new pe,t=this.getSkeleton();if(!t)return;const n=t.getColumnCount(),{stylesCache:s,rowHeightAccumulation:i,columnWidthAccumulation:o,dataMergeCache:a}=t,{font:l}=s;l&&Object.keys(l).forEach(u=>{l[u].forEach((h,f)=>{f.forEach((d,m)=>{let{documentSkeleton:g,angle:p=0,verticalAlign:_,horizontalAlign:v,wrapStrategy:w}=m;const y=t.getCellData().getValue(h,d),A=this.getSkeleton();if(!A)return!0;const{t:I=On.STRING}=y||{};if(w===Mt.OVERFLOW&&I!==On.NUMBER&&I!==On.BOOLEAN&&v!==ct.JUSTIFIED){let R=this.getDocsSkeletonPageSize(g,p);if(!R)return!0;if(p!==0){let{startY:N,endY:O,startX:D,endX:E}=ri(h,d,i,o,a);const F=E-D,j=O-N;R.height>j&&(R={width:j/Math.tan(Math.abs(p))+F,height:j})}const x=t.getOverflowPosition(R,v,h,d,n),{startColumn:S,endColumn:k}=x;e.setValue(h,d,{startRow:h,endRow:h,startColumn:S,endColumn:k})}else if(w===Mt.WRAP&&p!==0){let{startY:R,endY:x}=ri(h,d,i,o,a);const S=x-R;g.updateDocumentDataPageSize(S),g.calculate();const k=this.getDocsSkeletonPageSize(g,p);if(!k)return!0;const{startColumn:N,endColumn:O}=A.getOverflowPosition(k,v,h,d,A.getColumnCount());e.setValue(h,d,{startRow:h,endRow:h,startColumn:N,endColumn:O})}})})}),t.setOverflowCache(e)}_differentBounds(e){if(!this._boundsCache)return e;const{tl:t,tr:n,bl:s,br:i,dx:o,dy:a}=e,{tl:l,tr:u,bl:c,br:h,dx:f,dy:d}=this._boundsCache,m={tl:t,tr:n,bl:s,br:i,dx:0,dy:0};return t.x===l.x?(t.y>l.y?(m.tl=c,m.tr=h):(m.bl=l,m.br=u),m.dy=l.y-t.y):t.y===l.y&&(t.x>l.x?(m.tl=u,m.bl=h):(m.tr=l,m.br=c),m.dx=l.x-t.x),m}_checkSheetDifferentBounds(e,t){const{tl:n,tr:s,bl:i,br:o}=e,{tl:a,tr:l,bl:u,br:c}=t;return n.x===a.x&&s.x===l.x&&i.x===u.x&&o.x===c.x?n.y>=a.y&&n.y<=u.y||i.y>=a.y&&i.y<=u.y:n.y===a.y&&s.y===l.y&&i.y===u.y&&o.y===c.y?(n.x>=a.x&&n.x<=l.x||s.x>=a.x&&s.x<=l.x,!0):!1}}class vp extends yf{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const i=Us(s),{columnTitleHeight:o}=n;e.translate(-.5/i,Le(o,i)-.5/i);const a=this.getExtensionsByOrder();for(let l of a)l.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:i}=n;return t.x>=0&&t.x<=s&&t.y>i}_initialDefaultExtension(){hf.getData().forEach(e=>{this.register(e)}),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class Cp extends yf{constructor(e,t){super(e,t),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}_initialDefaultExtension(){df.getData().forEach(e=>{this.register(e)}),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}draw(e,t){const n=this.getSkeleton();if(!n)return;const s=this.getParentScale();n.calculate(t);const i=Us(s),{rowTitleWidth:o}=n;e.translate(Le(o,i)-.5/i,-.5/i);const a=this.getExtensionsByOrder();for(let l of a)l.draw(e,s,n)}isHit(e){const t=this._getInverseCoord(e),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:s,columnTitleHeight:i}=n;return t.x>s&&t.y>=0&&t.y<=i}}class Ql extends uf{constructor(e,t,n,s){super(s),this._config=e,this._cellData=t,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateLayout(),this.updateDataMerge()}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}setOverflowCache(e){this._overflowCache=e}calculate(e){if(!this._config||(this.updateLayout(),!this._rowHeightAccumulation||!this._columnWidthAccumulation))return;const{mergeData:t}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(e),this._dataMergeCache=t&&this._getMergeCells(t,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateLayout(){if(!this.dirty)return;const{rowData:e,columnData:t,defaultRowHeight:n,defaultColumnWidth:s,rowCount:i,columnCount:o,rowTitle:a,columnTitle:l,showGridlines:u}=this._config,{rowTotalHeight:c,rowHeightAccumulation:h}=this._generateRowMatrixCache(i,e,n),{columnTotalWidth:f,columnWidthAccumulation:d}=this._generateColumnMatrixCache(o,t,s);return this._rowTitleWidth=a.hidden!==te.TRUE?a.width:0,this._columnTitleHeight=l.hidden!==te.TRUE?l.height:0,this._rowTotalHeight=c,this._rowHeightAccumulation=h,this._columnTotalWidth=f,this._columnWidthAccumulation=d,this._showGridlines=u,this.makeDirty(!0),this}updateDataMerge(){const{mergeData:e}=this._config;this._dataMergeCacheAll=e&&this._getMergeCells(e)}getRowColumnSegment(e){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,e)}getMergeBounding(e,t,n,s){const i=this._dataMergeCacheAll;if(!i)return{startRow:e,startColumn:t,endRow:n,endColumn:s};let o=!0,a=new pe;for(;o;)o=!1,i.forEach((l,u)=>{u.forEach((c,h)=>{if(!h||a.getValue(l,c))return!0;const{startRow:f,startColumn:d,endRow:m,endColumn:g}=h;Tm({left:t,top:e,right:s,bottom:n},{left:d,top:f,right:g,bottom:m})&&(e=Math.min(e,f),t=Math.min(t,d),n=Math.max(n,m),s=Math.max(s,g),a.setValue(l,c,!0),o=!0)})});return{startRow:e,startColumn:t,endRow:n,endColumn:s}}appendToOverflowCache(e,t,n,s){this._overflowCache.setValue(e,t,{startRow:e,endRow:e,startColumn:n,endColumn:s})}getColumnCount(){return this._columnWidthAccumulation.length}get dataMergeCacheAll(){return this._dataMergeCacheAll}_generateRowMatrixCache(e,t,n){let s=0;const i=[],o=new tt(t);for(let a=0;a<e;a++){let l=n;if(o.get(a)!=null){const u=o.get(a);if(!u)continue;u.h!=null?l=u.h:u.ah!=null&&(l=u.ah),u.hd===te.TRUE&&(l=0)}s+=l,i.push(s)}return{rowTotalHeight:s,rowHeightAccumulation:i}}_generateColumnMatrixCache(e,t,n){let s=0;const i=[],o=new tt(t);for(let a=0;a<e;a++){let l=n;if(o.get(a)!=null){const u=o.get(a);if(!u)continue;u.w!=null&&(l=u.w),u.hd===te.TRUE&&(l=0)}s+=l,i.push(s)}return{columnTotalWidth:s,columnWidthAccumulation:i}}_getBounding(e,t,n){const s=e.length,i=t.length;if(!n)return{startRow:0,endRow:s-1,startColumn:0,endColumn:i-1};let o=-1,a=-1,l=-1,u=-1;return o=Un(e,n.tl.y-this.columnTitleHeight),a=Un(e,n.bl.y-this.columnTitleHeight),o===-1&&(o=0),a===-1&&(a=s-1),a>=s&&(a=s-1),l=Un(t,n.tl.x-this.rowTitleWidth),u=Un(t,n.tr.x-this.rowTitleWidth),l===-1&&(l=0),u===-1&&(u=i-1),u>=i&&(u=i-1),{startRow:o-1,endRow:a+1,startColumn:l-1,endColumn:u+1}}getOverflowPosition(e,t,n,s,i){const{width:o,height:a}=e;let l=s,u=s;return t===ct.CENTER?(l=this._getOverflowBound(n,s,0,o/2),u=this._getOverflowBound(n,s,i-1,o/2)):t===ct.RIGHT?l=this._getOverflowBound(n,s,0,o):u=this._getOverflowBound(n,s,i-1,o),{startColumn:l,endColumn:u}}_getOverflowBound(e,t,n,s){let i=0;if(t>n){const o=this._columnWidthAccumulation.length-1;for(let a=t;a>=n;a--){const l=a,u=this._cellData.getValue(e,l);if(!Cc(u)&&l!==t||this._intersectMergeRange(e,l))return l===t?l:l+1>o?o:l+1;const{startX:c,endX:h}=Ho(e,l,this.rowHeightAccumulation,this.columnWidthAccumulation);if(i+=h-c,s<i)return l}return t}for(let o=t;o<=n;o++){const a=o,l=this._cellData.getValue(e,a);if(!Cc(l)&&a!==t||this._intersectMergeRange(e,a))return a===t?a:a-1<0?0:a-1;const{startX:u,endX:c}=Ho(e,a,this.rowHeightAccumulation,this.columnWidthAccumulation);if(i+=c-u,s<i)return a}return n}_intersectMergeRange(e,t){const n=this.dataMergeCache;let s=!1;return n==null||n.forEach((i,o)=>{o==null||o.forEach((a,l)=>{const{startRow:u,endRow:c,startColumn:h,endColumn:f}=l;if(e>=u&&e<=c&&t>=h&&t<=f)return s=!0,!1})}),s}_calculateStylesCache(){const e={background:{},font:{},border:new pe},t=this.getFontLocale(),n=this._dataMergeCache,s=this._rowColumnSegment,i=this.columnWidthAccumulation,o=this._styles,a=this._cellData,{startRow:l,endRow:u,startColumn:c,endColumn:h}=s;for(let f=l;f<=u;f++){for(let d=c;d<=h;d++)this.__setCellCache(f,d,{cache:e,styles:o,cellData:a,skipBackgroundAndBorder:!1},t);for(let d=0;d<c;d++)this.__setCellCache(f,d,{cache:e,styles:o,cellData:a,skipBackgroundAndBorder:!0},t);for(let d=h+1;d<i.length;d++)this.__setCellCache(f,d,{cache:e,styles:o,cellData:a,skipBackgroundAndBorder:!0},t)}return n&&n.forEach((f,d)=>{d.forEach((m,g)=>{if(!g)return!0;this.__setCellCache(f,m,{cache:e,styles:o,cellData:a,skipBackgroundAndBorder:!1},t)})}),e}__setCellCache(e,t,n,s){const{cache:i,skipBackgroundAndBorder:o=!1,styles:a,cellData:l}=n;if(!l)return!0;const u=l.getValue(e,t);if(!u)return!0;const c=a&&a.getStyleByCell(u);if(!o&&c&&c.bg&&c.bg.rgb){const I=c.bg.rgb;i.background[I]||(i.background[I]=new pe),i.background[I].setValue(e,t,I)}!o&&c&&c.bd&&(this.___setBorderProps(e,t,Ht.TOP,c,i),this.___setBorderProps(e,t,Ht.BOTTOM,c,i),this.___setBorderProps(e,t,Ht.LEFT,c,i),this.___setBorderProps(e,t,Ht.RIGHT,c,i));const h=u.m||u.v;let f,d="document";const m=this._getOtherStyle(c),g=m.textRotation||{a:0,v:te.FALSE},p=m.horizontalAlign||ct.UNSPECIFIED,_=m.verticalAlign||rn.UNSPECIFIED,v=m.wrapStrategy||Mt.UNSPECIFIED;if(u.p){i.font[d]||(i.font[d]=new pe);let{a:I=0,v:R=te.FALSE}=g,x=0,S=I;R===te.TRUE&&(x=90,S=90),f=this._updateRenderConfigAndHorizon(u.p,p,{horizontalAlign:p,verticalAlign:_,centerAngle:x,vertexAngle:S,wrapStrategy:v})}else if(h){const I=this._getFontFormat(c);d=Wl(I,s).fontString,i.font[d]||(i.font[d]=new pe),f=this._getDocumentDataByStyle(h.toString(),I,m)}const w=i.font[d];let{a:y,v:A=te.FALSE}=g;if(A===te.TRUE&&(y=90),f){const I=Zl.create(f,this.getContext());(y===0||v!==Mt.WRAP)&&I.calculate(),w.setValue(e,t,{documentSkeleton:I,angle:y,verticalAlign:_,horizontalAlign:p,wrapStrategy:v,content:h==null?void 0:h.toString()})}}_updateRenderConfigAndHorizon(e,t,n){var o;if(!n||!((o=e.body)!=null&&o.blockElements))return;e.documentStyle||(e.documentStyle={}),e.documentStyle.renderConfig=n;const s=e.body.blockElements,i=Object.keys(e.body.blockElements);for(let a of i){const l=s[a];if(l.blockType===ze.PARAGRAPH){if(!l.paragraph)continue;l.paragraph.paragraphStyle||(l.paragraph.paragraphStyle={}),l.paragraph.paragraphStyle.horizontalAlign=t}}return e}_getDocumentDataByStyle(e,t,n){const s=e.length-1,{textRotation:i={a:0,v:te.FALSE},textDirection:o=Ci.UNSPECIFIED,paddingData:a={t:0,r:2,b:0,l:2},horizontalAlign:l=ct.UNSPECIFIED,verticalAlign:u=rn.UNSPECIFIED,wrapStrategy:c=Mt.UNSPECIFIED}=n,{a:h=0,v:f=te.FALSE}=i,{t:d,r:m,b:g,l:p}=a;nl.NORMAL;let _=0,v=h;return f===te.TRUE&&(_=90,v=90,nl.TBRL),{id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:s,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:l},elements:{oneElement:{eId:"oneElement",st:0,ed:s,et:q.TEXT_RUN,tr:{ct:e,ts:t}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:d,marginBottom:g,marginRight:m,marginLeft:p,renderConfig:{horizontalAlign:l,verticalAlign:u,centerAngle:_,vertexAngle:v,wrapStrategy:c}}}}___setBorderProps(e,t,n,s,i){var u;const o=(u=s.bd)==null?void 0:u[n];if(!o||!i.border)return!0;const a=zt(o.cl)||Ar,l=i.border;l.getValue(e,t)||l.setValue(e,t,{[n]:{}}),l.getValue(e,t)[n]={type:n,style:o.s,color:a}}_getFontFormat(e){if(!e)return{};const{ff:t,fs:n,it:s,bl:i,ul:o,st:a,ol:l,cl:u,bg:c,bd:h}=e;return{ff:t,fs:n,it:s,bl:i,ul:o,st:a,ol:l,cl:u}}_getOtherStyle(e){if(!e)return{};const{tr:t,td:n,ht:s,vt:i,tb:o,pd:a}=e;return{textRotation:t,textDirection:n,horizontalAlign:s,verticalAlign:i,wrapStrategy:o,paddingData:a}}_getMergeCells(e,t){const n=this.columnWidthAccumulation.length-1;if(t)t={startRow:t.startRow,endRow:t.endRow,endColumn:n,startColumn:0};else{const u=this.rowHeightAccumulation.length-1;t={startRow:0,startColumn:0,endRow:u,endColumn:n}}const{startRow:s,startColumn:i,endRow:o,endColumn:a}=t,l=new pe;for(let u=0;u<e.length;u++){const{startRow:c,endRow:h,startColumn:f,endColumn:d}=e[u];for(let m=s;m<=o;m++){let g=!1;for(let p=i;p<=a;p++)if(m>=c&&m<=h&&p>=f&&p<=d){l.setValue(c,f,{startRow:c,endRow:h,startColumn:f,endColumn:d}),g=!0;break}if(g)break}}return l}static create(e,t,n,s){return new Ql(e,t,n,s)}}const Ep=["__SpreadsheetTransformerResizeLT__","__SpreadsheetTransformerResizeCT__","__SpreadsheetTransformerResizeRT__","__SpreadsheetTransformerResizeLM__","__SpreadsheetTransformerResizeRM__","__SpreadsheetTransformerResizeLB__","__SpreadsheetTransformerResizeCB__","__SpreadsheetTransformerResizeRB__"];class wp{constructor(e,t){this._scene=e,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this.onChangeStartObservable=new Ae,this.onChangingObservable=new Ae,this.onChangeEndObservable=new Ae,this.onClearControlObservable=new Ae,this.onCreateControlObservable=new Ae,this._initialProps(t)}_initialProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(n=>{if(e[n]===void 0)return!0;this[n]=e[n]})}_updateControlChildren(){this._updateControlIterator((e,t)=>{const{left:n,top:s,width:i,height:o,scaleX:a,scaleY:l}=t.getState();e.getObjects().forEach(c=>{const h=c.oKey,f=this._checkTransformerType(h);if(!f)return!0;if(f==="__SpreadsheetTransformerOutline__")c.transformByState(this._getOutlinePosition(i,o,a,l));else{const{left:d,top:m}=this._getRotateAnchorPosition(f,o,i,a,l);c.transformByState({left:d,top:m})}}),e.transformByState({left:n,top:s})})}_anchorMoving(e,t,n,s){const{scrollX:i,scrollY:o}=vs(s),a=t-this._viewportScrollX+i,l=n-this._viewportScrollY+o,u=a-this._startOffsetX,c=l-this._startOffsetY;this._selectedObjectMap.forEach(h=>{const{left:f,top:d,width:m,height:g}=h,p={};switch(e){case"__SpreadsheetTransformerResizeLT__":p.left=f+u,p.top=d+c,p.width=m-u,p.height=g-c;break;case"__SpreadsheetTransformerResizeCT__":p.top=d+c,p.height=g-c;break;case"__SpreadsheetTransformerResizeRT__":p.top=d+c,p.width=m+u,p.height=g-c;break;case"__SpreadsheetTransformerResizeLM__":p.left=f+u,p.width=m-u;break;case"__SpreadsheetTransformerResizeRM__":p.width=u+m;break;case"__SpreadsheetTransformerResizeLB__":p.left=f+u,p.width=m-u,p.height=g+c;break;case"__SpreadsheetTransformerResizeCB__":p.height=c+g;break;case"__SpreadsheetTransformerResizeRB__":p.width=u+m,p.height=c+g;break}h.transformByState(p)}),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:u,moveY:c,type:1}),this._startOffsetX=a,this._startOffsetY=l}_attachEventToAnchor(e,t="__SpreadsheetTransformerResizeLT__"){e.onPointerDownObserver.add((n,s)=>{const{offsetX:i,offsetY:o}=n;this._startOffsetX=i,this._startOffsetY=o;const a=this._getTopScene();if(a==null)return;a.disableEvent();const l=Kr.create(a);l.startScroll(i,o);const{scrollX:u,scrollY:c}=vs(l);this._viewportScrollX=u,this._viewportScrollY=c;const h=this._getRotateAnchorCursor(t);this._moveObserver=a.onPointerMoveObserver.add(f=>{const{offsetX:d,offsetY:m}=f;this._anchorMoving(t,d,m,l),l.scrolling(d,m,()=>{this._anchorMoving(t,d,m,l)}),a.setCursor(h)}),this._upObserver=a.onPointerUpObserver.add(f=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent(),a.resetCursor(),l.stopScroll()}),s.stopPropagation()})}_attachEventToRotate(e){e.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:i}=t;this._startOffsetX=s,this._startOffsetY=i;const o=this._getTopScene();o!=null&&(o.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=o.onPointerMoveObserver.add(a=>{}),this._upObserver=o.onPointerUpObserver.add(a=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent()}),n.stopPropagation())})}_getOutlinePosition(e,t,n,s){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+this.borderSpacing*2,height:t+this.borderSpacing*2}}_getRotateAnchorCursor(e){let t=gt.NORTH_WEST_RESIZE;switch(e){case"__SpreadsheetTransformerRotate__":t=gt.MOVE;break;case"__SpreadsheetTransformerRotateLine__":t=gt.MOVE;break;case"__SpreadsheetTransformerResizeLT__":break;case"__SpreadsheetTransformerResizeCT__":t=gt.NORTH_RESIZE;break;case"__SpreadsheetTransformerResizeRT__":t=gt.NORTH_EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLM__":t=gt.WEST_RESIZE;break;case"__SpreadsheetTransformerResizeRM__":t=gt.EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLB__":t=gt.SOUTH_WEST_RESIZE;break;case"__SpreadsheetTransformerResizeCB__":t=gt.SOUTH_RESIZE;break;case"__SpreadsheetTransformerResizeRB__":t=gt.SOUTH_EAST_RESIZE;break}return t}_getRotateAnchorPosition(e,t,n,s,i){let o=-this.anchorSize/2,a=-this.anchorSize/2;switch(e){case"__SpreadsheetTransformerRotate__":o=n/2-this.rotateSize/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth*2-this.rotateSize;break;case"__SpreadsheetTransformerRotateLine__":o=n/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLT__":o+=-this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCT__":o+=n/2,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRT__":o+=n+this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLM__":o+=-this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeRM__":o+=n+this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeLB__":o+=-this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCB__":o+=n/2,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRB__":o+=n+this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break}return{left:o,top:a}}_createResizeAnchor(e,t,n){let{height:s,width:i,scaleX:o,scaleY:a}=t.getState();const{left:l,top:u}=this._getRotateAnchorPosition(e,s,i,o,a),c=this._getRotateAnchorCursor(e),h=new rt(`${e}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:l,top:u});return this._attachHover(h,c,gt.DEFAULT),h}_checkTransformerType(e){if(e.indexOf("__SpreadsheetTransformerOutline__")>-1)return"__SpreadsheetTransformerOutline__";if(e.indexOf("__SpreadsheetTransformerRotate__")>-1)return"__SpreadsheetTransformerRotate__";if(e.indexOf("__SpreadsheetTransformerRotateLine__")>-1)return"__SpreadsheetTransformerRotateLine__";if(e.indexOf("__SpreadsheetTransformerResizeLT__")>-1)return"__SpreadsheetTransformerResizeLT__";if(e.indexOf("__SpreadsheetTransformerResizeCT__")>-1)return"__SpreadsheetTransformerResizeCT__";if(e.indexOf("__SpreadsheetTransformerResizeRT__")>-1)return"__SpreadsheetTransformerResizeRT__";if(e.indexOf("__SpreadsheetTransformerResizeLM__")>-1)return"__SpreadsheetTransformerResizeLM__";if(e.indexOf("__SpreadsheetTransformerResizeRM__")>-1)return"__SpreadsheetTransformerResizeRM__";if(e.indexOf("__SpreadsheetTransformerResizeLB__")>-1)return"__SpreadsheetTransformerResizeLB__";if(e.indexOf("__SpreadsheetTransformerResizeCB__")>-1)return"__SpreadsheetTransformerResizeCB__";if(e.indexOf("__SpreadsheetTransformerResizeRB__")>-1)return"__SpreadsheetTransformerResizeRB__"}_updateControlIterator(e){this._transformerControlMap.forEach((t,n)=>{const s=this._selectedObjectMap.get(n);if(!s)return!0;e(t,s)})}_updateControl(){this._updateControlIterator((e,t)=>{const{left:n,top:s}=t.getState();e.transformByState({left:n,top:s}),e.show(),e.makeDirty(!0)})}_hiddenControl(){this._transformerControlMap.forEach(e=>{e.hide(),e.makeDirty(!0)})}_attachHover(e,t,n){e.onPointerEnterObserver.add(()=>{e.cursor=t}),e.onPointerLeaveObserver.add(()=>{e.cursor=n})}_clearControl(){this._transformerControlMap.forEach(e=>{e.dispose()}),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(e){let{left:t,top:n,height:s,width:i,angle:o,scaleX:a,scaleY:l,skewX:u,skewY:c,flipX:h,flipY:f}=e.getState();const d=e.oKey,m=this._selectedObjectMap.size,g=[];if(this.borderEnabled){const v=new rt(`__SpreadsheetTransformerOutline___${m}`,{zIndex:m-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke,...this._getOutlinePosition(i,s,a,l)});g.push(v)}if(this.resizeEnabled){const{left:v,top:w}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotateLine__",s,i,a,l),y=new rt(`__SpreadsheetTransformerRotateLine___${m}`,{zIndex:m-1,evented:!1,left:v,top:w,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:A,top:I}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotate__",s,i,a,l),R=this._getRotateAnchorCursor("__SpreadsheetTransformerRotate__"),x=new rt(`__SpreadsheetTransformerRotate___${m}`,{zIndex:m-1,left:A,top:I,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:this.borderStrokeWidth*2,stroke:this.borderStroke});this._attachEventToRotate(x),this._attachHover(x,R,gt.DEFAULT),g.push(y,x)}if(this.resizeEnabled)for(let v=0,w=this.enabledAnchors.length;v<w;v++){if(this.enabledAnchors[v]!==1)continue;const A=Ep[v],I=this._createResizeAnchor(A,e,m);this._attachEventToAnchor(I,A),g.push(I)}const p=new Qo(`__SpreadsheetTransformer___${m}`,...g);p.zIndex=m,p.evented=!1,p.transformByState({left:t,top:n});const _=this.getScene();return _.addObject(p,2),console.log(_,e),this._transformerControlMap.set(d,p),this.onCreateControlObservable.notifyObservers(p),p}getScene(){return this._scene}_getTopScene(){var t;return(t=this.getScene().getEngine())==null?void 0:t.activeScene}_moving(e,t,n){const{scrollX:s,scrollY:i}=vs(n),o=e-this._viewportScrollX+s,a=t-this._viewportScrollY+i,l=o-this._startOffsetX,u=a-this._startOffsetY;this._selectedObjectMap.forEach(c=>{c.translate(l+c.left,u+c.top)}),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:u,type:1}),this._startOffsetX=o,this._startOffsetY=a}_updateActiveObjectList(e,t){this._selectedObjectMap.has(e.oKey)||(t.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}_addCancelObserver(e){e.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=e.onPointerDownObserver.add(t=>{this._selectedObjectMap.clear(),this._clearControl(),e.onPointerDownObserver.remove(this._cancelFocusObserver)})}attachTo(e){if(!!e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add((t,n)=>{const{offsetX:s,offsetY:i}=t;this._startOffsetX=s,this._startOffsetY=i;const o=this._getTopScene();if(!o)return;this._addCancelObserver(o),o.disableEvent();const a=Kr.create(o);a.startScroll(s,i);const{scrollX:l,scrollY:u}=vs(a);this._viewportScrollX=l,this._viewportScrollY=u,this._updateActiveObjectList(e,t),this._moveObserver=o.onPointerMoveObserver.add(c=>{const{offsetX:h,offsetY:f}=c;this._moving(h,f,a),this._hiddenControl(),a.scrolling(h,f,()=>{this._moving(h,f,a)})}),this._upObserver=o.onPointerUpObserver.add(c=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),this._updateControl(),a.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),n.stopPropagation()}),e}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach(e=>{e.dispose()}),this._selectedObjectMap.forEach(e=>{e.dispose()}),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}}class Tp{constructor(e,t,n){var s;if(this._parent=t,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new kt,this._isFirstDirty=!0,this._evented=!0,this._cursor=gt.DEFAULT,this._transformerOpenState=!1,this.onPointerDownObserver=new Ae,this.onPointerMoveObserver=new Ae,this.onPointerUpObserver=new Ae,this.onDblclickObserver=new Ae,this.onMouseWheelObserver=new Ae,this.onKeyDownObservable=new Ae,this.onKeyUpObservable=new Ae,this.onTransformChangeObservable=new Ae,this._sceneKey=e,n&&this.transformByState(n),this._parent.classType===Ge.ENGINE){const i=this._parent;i.addScene(this),i.hasActiveScene()||i.setActiveScene(e),this._inputManager=new Li(this)}else this._parent.classType===Ge.SCENE_VIEWER&&this._parent.addSubScene(this);(s=this._parent)==null||s.onTransformChangeObservable.add(i=>{this._resetViewportSize(),this._setTransForm()})}attachControl(e=!0,t=!0,n=!0,s=!0){var i;if(this._parent.classType===Ge.ENGINE)return(i=this._inputManager)==null||i.attachControl(e,t,n,s),this}detachControl(){var e;return(e=this._inputManager)==null||e.detachControl(),this}makeDirty(e=!0){var t;return this._viewports.forEach(n=>{n.makeDirty(e)}),this._parent.classType===Ge.SCENE_VIEWER&&((t=this._parent)==null||t.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach(t=>{t.makeDirty(e)}),this}isDirty(){for(let e=0;e<this._viewports.length;e++)if(this._viewports[e].isDirty()===!0)return!0;return!1}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(gt.DEFAULT)}setCursor(e){this._cursor=e;const t=this.getEngine();if(!t)return;const n=t.getCanvas().getCanvasEle();n.style.cursor=e}get classType(){return Ge.SCENE}get transform(){return this._transform}set transform(e){this._transform=e}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const e=this.getParent();let t=1;return e.classType===Ge.SCENE_VIEWER&&(t=e.ancestorScaleX),this._scaleX*t}get ancestorScaleY(){const e=this.getParent();let t=1;return e.classType===Ge.SCENE_VIEWER&&(t=e.ancestorScaleY),this._scaleY*t}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}resize(e,t){const n=this.width;e!==void 0&&(this.width=e);const s=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:s}}),this}scale(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX=e);const s=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:s}}),this}scaleBy(e,t){const n=this.scaleX;e!==void 0&&(this.scaleX+=e);const s=this.scaleY;return t!==void 0&&(this.scaleY+=t),this.scaleX=rl(this.scaleX,1),this.scaleY=rl(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:s}}),this}transformByState(e){const t=Object.keys(e),n={};t.length!==0&&(t.forEach(s=>{e[s]!==void 0&&(n[s]=this[s],this[s]=e[s])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:en.all,value:e,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===Ge.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e.classType===Ge.ENGINE)return e;e=e==null?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(let t of this._layers)if(t.zIndex===e)return t;return this._createDefaultLayer(e)}_createDefaultLayer(e=1){const t=il.create(this,[],e);return this.addLayer(t),t}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let t=0;t<this._layers.length;t++){const n=this._layers[t];n.zIndex>=e&&(e=n.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,t=1){var n;return(n=this.getLayer(t))==null||n.addObject(e),this}setObjectBehavior(e){e.parent||(e.parent=this),this.onTransformChangeObservable.add(t=>{e.scaleCacheCanvas()}),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,t=1){var n;return(n=this.getLayer(t))==null||n.addObjects(e),this}removeObject(e){if(e==null)return;const t=this.getLayers();for(let n of t)n.removeObject(e);return this}getAllObjects(){const e=[];this._layers.sort(Ft);for(let t of this._layers)e.push(...t.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const t=[],n=e?Ac:Ft;this._layers.sort(n);for(let s of this._layers)t.push(...s.getObjectsByOrder().sort(n));return t}getAllObjectsByOrderForPick(e=!1){const t=[],n=e?Ac:Ft;this._layers.sort(n);for(let s of this._layers)t.push(...s.getObjectsByOrderForPick().sort(n));return t}getObject(e){for(let t of this._layers){const n=t.getObjectsByOrder();for(let s of n)if(s.oKey===e)return s}}fuzzyMathObjects(e){const t=[];for(let n of this._layers){const s=n.getObjectsByOrder();for(let i of s)i.oKey.indexOf(e)>-1&&s.push(i)}return t}addViewport(...e){return this._viewports.push(...e),this}removeViewport(){}getViewports(){return this._viewports}getViewport(e){for(let t of this._viewports)if(t.viewPortKey===e)return t}changeObjectOrder(){}get sceneKey(){return this._sceneKey}async requestRender(e){return new Promise((t,n)=>{this.render(e),Po(t)})}renderObjects(e,t){return this.getAllObjectsByOrder().forEach(n=>{n.render(e,t)}),this}render(e){var t,n;!this.isDirty()||(!e&&((t=this.getEngine())==null||t.getCanvas().clear()),(n=this.getViewports())==null||n.forEach(s=>s.render(e)))}_resetViewportSize(){this.getViewports().forEach(e=>{e.resetSize()})}_setTransForm(){const e=kt.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach(t=>{t.resizeScrollBar()}),this.makeDirty(!0)}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}get evented(){return this._evented}openTransformer(e){this._transformer||(this._transformer=new wp(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var t;!this._transformerOpenState||(t=this._transformer)==null||t.attachTo(e)}getTransformer(){return this._transformer}getActiveViewportByCoord(e){return this._viewports.find(t=>t.isHit(e))}transformToSceneCoord(e){const t=this.getActiveViewportByCoord(e);return t==null?void 0:t.getRelativeVector(e)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var e;this.getLayers().forEach(t=>{t.dispose()}),this.getViewports().forEach(t=>{t.dispose()}),this.clearLayer(),this.clearViewports(),this.detachControl(),(e=this._transformer)==null||e.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(e){let t=this.getActiveViewportByCoord(e);if(t||(t=this._viewports[0]),!this._evented||!t)return;const n=t.pickScrollBar(e);if(n)return n;const s=t.getRelativeVector(e);let i=null;const o=this.getAllObjectsByOrderForPick().reverse(),a=o.length;for(let l=0;l<a;l++){const u=o[l];if(!u.visible||!u.evented||u.classType===Ge.GROUP)continue;let c=s;if(u.isInGroup&&u.parent.classType===Ge.GROUP){const{cumLeft:h,cumTop:f}=this._getGroupCumLeftRight(u);c=c.clone().add(Re.FromArray([-h,-f]))}if(u.isHit(c)){if(u.classType===Ge.SCENE_VIEWER){const h=u.pick(c);h?i=h:i=u.getActiveSubScene()}else i=u;break}else if(u.classType===Ge.SCENE_VIEWER&&u.allowSelectedClipElement()){const h=u.pick(c);if(h){i=h;break}}}return!i&&this._parent.classType===Ge.ENGINE?this:i}_getGroupCumLeftRight(e){let t=e.parent,n=0,s=0;for(;t.classType===Ge.GROUP;){const{left:i,top:o}=t;n+=i,s+=o,t=t.parent}return{cumLeft:n,cumTop:s}}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var t,n;return!((t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Ge.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerUp(e),!1):!0}triggerMouseWheel(e){var t,n;return!((t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Ge.SCENE_VIEWER?((n=this._parent)==null||n.triggerMouseWheel(e),!1):!0}triggerPointerMove(e){var t,n;return!((t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Ge.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerMove(e),!1):!0}triggerDblclick(e){var t,n;return!((t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Ge.SCENE_VIEWER?((n=this._parent)==null||n.triggerDblclick(e),!1):!0}triggerPointerDown(e){var t,n;return!((t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===Ge.SCENE_VIEWER?((n=this._parent)==null||n.triggerPointerDown(e),!1):!0}triggerPointerOut(e){var t;return this._parent.classType===Ge.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOut(e),!1):!0}triggerPointerLeave(e){var t;return this._parent.classType===Ge.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerLeave(e),!1):!0}triggerPointerOver(e){var t;return this._parent.classType===Ge.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOver(e),!1):!0}triggerPointerEnter(e){var t;return this._parent.classType===Ge.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerEnter(e),!1):!0}}class qi{constructor(e,t,n){var s;this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this.scrollX=0,this.scrollY=0,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this.onMouseWheelObserver=new Ae,this.onScrollAfterObserver=new Ae,this.onScrollBeforeObserver=new Ae,this.onScrollStopObserver=new Ae,this._viewPortKey=e,this._scene=t,this.top=(n==null?void 0:n.top)||0,this.left=(n==null?void 0:n.left)||0,this.bottom=(n==null?void 0:n.bottom)||0,this.right=(n==null?void 0:n.right)||0,n!=null&&n.width&&(this.width=n==null?void 0:n.width,this._widthOrigin=this.width),n!=null&&n.height&&(this.height=n==null?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new Bi),this._isWheelPreventDefaultX=(n==null?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(n==null?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),(s=this._scene)==null||s.getParent().onTransformChangeObservable.add(()=>{this._resizeCacheCanvasAndScrollBar()})}get scene(){return this._scene}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}set top(e){var t,n;this._topOrigin=e,this._top=Er(e,(n=(t=this._scene)==null?void 0:t.getParent())==null?void 0:n.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=Er(e,(t=this.scene.getParent())==null?void 0:t.width)}get bottom(){return this._bottom}set bottom(e){var t;this._bottomOrigin=e,this._bottom=Er(e,(t=this.scene.getParent())==null?void 0:t.height)}get right(){return this._right}set right(e){var t;this._rightOrigin=e,this._right=Er(e,(t=this.scene.getParent())==null?void 0:t.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}resize(e){const t=Object.keys(e);t.length!==0&&(this._width=void 0,this._height=void 0,t.forEach(n=>{e[n]!==void 0&&(this[n]=e[n])}),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}_resizeCacheCanvasAndScrollBar(e=!1){var o;const{width:t,height:n}=this._getViewPortSize(e);this.width=t,this.height=n;const s=this._scene.width*this._scene.scaleX,i=this._scene.height*this._scene.scaleY;(o=this._scrollBar)==null||o.resize(t,n,s,i),this.makeDirty(!0)}_getViewPortSize(e=!1){var i;const t=(i=this._scene)==null?void 0:i.getParent();let n,s;if(!e&&this._widthOrigin!==void 0)n=this._widthOrigin;else{const o=t.width;n=(t.classType===Ge.SCENE_VIEWER?o*t.scaleX:o)-(this._left+this._right)}if(!e&&this._heightOrigin!==void 0)s=this._heightOrigin;else{const o=t.height;s=(t.classType===Ge.SCENE_VIEWER?o*t.scaleY:o)-(this._top+this._bottom)}return{width:n,height:s}}makeDirty(e=!0){this._dirty=e}isDirty(){return this._dirty}scrollTo(e){return this._scroll(0,e)}scrollBy(e){return this._scroll(1,e)}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var i,o;if(!this._scrollBar)return;const e=((i=this._scrollBar)==null?void 0:i.limitX)||1/0,t=((o=this._scrollBar)==null?void 0:o.limitY)||1/0;let n=!0,s=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>e?this.scrollX=e:n=!1,this.scrollY<0?this.scrollY=0:this.scrollY>t?this.scrollY=t:s=!1,{isLimitedX:n,isLimitedY:s}}_triggerScrollStop(e,t,n){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout(()=>{var s,i;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:t,y:n,actualScrollX:e.x,actualScrollY:e.y,limitX:(s=this._scrollBar)==null?void 0:s.limitX,limitY:(i=this._scrollBar)==null?void 0:i.limitY})},0)}_scroll(e,t){var a,l,u,c;const{x:n,y:s}=t;n!==void 0&&(e===1?this.scrollX+=n:this.scrollX=n),s!==void 0&&(e===1?this.scrollY+=s:this.scrollY=s);const i=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:s,limitX:(a=this._scrollBar)==null?void 0:a.limitX,limitY:(l=this._scrollBar)==null?void 0:l.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const o=this.transformScroll();return this.actualScrollX=o.x,this.actualScrollY=o.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:n,y:s,actualScrollX:o.x,actualScrollY:o.y,limitX:(u=this._scrollBar)==null?void 0:u.limitX,limitY:(c=this._scrollBar)==null?void 0:c.limitY}),this._triggerScrollStop(o,n,s),i}getBarScroll(e,t){let n=e,s=t;if(this._scrollBar){n*=this._scrollBar.ratioScrollX,s*=this._scrollBar.ratioScrollY;const{scaleX:i,scaleY:o}=this.scene;n=Math.round(n)*i,s=Math.round(s)*o}else this.scrollX!==void 0&&(n=this.scrollX),this.scrollY!==void 0&&(s=this.scrollY);return{x:n,y:s}}getActualScroll(e,t){let n=e,s=t;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,s/=this._scrollBar.ratioScrollY;const{scaleX:i,scaleY:o}=this.scene;n=Math.round(n)/i,s=Math.round(s)/o}else this.actualScrollX!==void 0&&(n=this.actualScrollX),this.actualScrollY!==void 0&&(s=this.actualScrollY);return{x:n,y:s}}transformScroll(){let e=this.scrollX,t=this.scrollY;return this.getActualScroll(e,t)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:t,scrollY:n,actualScrollX:s,actualScrollY:i}=e;return t!==void 0&&(this.scrollX=t),n!==void 0&&(this.scrollY=n),s!==void 0&&(this.actualScrollX=s),i!==void 0&&(this.actualScrollY=i),this}getScrollBarTransForm(e=!1){const t=kt.create();return(e||!this._allowCache)&&t.multiply(kt.create([1,0,0,1,this._left,this._top])),t}render(e){var l;const t=e||((l=this._scene.getEngine())==null?void 0:l.getCanvas().getContext());if(!this.isDirty()&&this._allowCache){this._applyCache(t);return}let n=this._scene.transform.clone();n.multiply(kt.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let s=t;if(!s)return;const i=this._getApplyCanvasState();i&&(n.multiply(kt.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),s=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const o=n.getMatrix(),a=this.getScrollBarTransForm().getMatrix();s.save(),!i&&this._renderClipState&&(s.beginPath(),s.rect(this.left,this.top,this.width||0,this.height||0),s.clip()),s.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._scene.renderObjects(s,this._calViewportRelativeBounding()),s.restore(),this._scrollBar&&(s.save(),s.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.drawScrollbar(s),s.restore()),i&&this._applyCache(t),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}_calViewportRelativeBounding(){var c,h,f,d;let e=(h=(c=this._scrollBar)==null?void 0:c.ratioScrollX)!=null?h:1,t=(d=(f=this._scrollBar)==null?void 0:f.ratioScrollY)!=null?d:1,n=this.left,s=(this.width||0)+this.left,i=this.top,o=(this.height||0)+this.top,a=0,l=0;this._preScrollX!=null&&(a=(this._preScrollX-this.scrollX)/e),this._preScrollY!=null&&(l=(this._preScrollY-this.scrollY)/t);const u={tl:Re.FromArray([n,i]),tr:Re.FromArray([s,i]),bl:Re.FromArray([n,o]),br:Re.FromArray([s,o]),dx:a,dy:l};return u.tl=this.getRelativeVector(u.tl),u.tr=this.getRelativeVector(u.tr),u.bl=this.getRelativeVector(u.bl),u.br=this.getRelativeVector(u.br),u}getRelativeVector(e){const t=this.scene.transform.clone().invert(),n=this.transformScroll();return t.applyPoint(e).add(Re.FromArray([n.x,n.y]))}getAbsoluteVector(e){const t=this.scene.transform.clone(),n=this.transformScroll();return t.applyPoint(e).subtract(Re.FromArray([n.x,n.y]))}drawScrollbar(e){if(!this._scrollBar)return;const t=this._scene.getParent();t.classType===Ge.SCENE_VIEWER?this._scrollBar.render(e):t.classType===Ge.ENGINE&&this._scrollBar.render(e)}_applyCache(e){if(!e)return;const t=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*t,s=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,s,this.left,this.top,this.width||0,this.height||0)}onMouseWheel(e,t){if(!this._scrollBar)return;let n;if(e.inputIndex===Ne.MouseWheelX){const s=Math.abs(e.deltaX),i=this._scene.width;let a=(this.width||1)/i*s;e.deltaX>0?n=this.scrollBy({x:a}):n=this.scrollBy({x:-a}),this._scene.getParent().classType===Ge.SCENE_VIEWER?n!=null&&n.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():n!=null&&n.isLimitedX||e.preventDefault()}if(e.inputIndex===Ne.MouseWheelY){const s=Math.abs(e.deltaY),i=this._scene.height;let a=(this.height||1)/i*s;e.shiftKey?(e.deltaY>0?n=this.scrollBy({x:a}):n=this.scrollBy({x:-a}),this._scene.getParent().classType===Ge.SCENE_VIEWER?n!=null&&n.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():n!=null&&n.isLimitedX||e.preventDefault()):(e.deltaY>0?n=this.scrollBy({y:a}):n=this.scrollBy({y:-a}),this._scene.getParent().classType===Ge.SCENE_VIEWER?n!=null&&n.isLimitedY||t.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():n!=null&&n.isLimitedY||e.preventDefault())}e.inputIndex,Ne.MouseWheelZ}isHit(e){const{width:t,height:n}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+t&&e.y>=this.top&&e.y<=this.top+n}pickScrollBar(e){if(!this._scrollBar)return;const n=this.getScrollBarTransForm(!0).invert().applyPoint(e);return this._scrollBar.pick(n)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var e;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),(e=this._scrollBar)==null||e.dispose()}}class eu extends or{constructor(){super(Je.BASE_RENDER),this._engine=new Mm}static create(){return new eu}installTo(e){e.installPlugin(this)}getEngine(){return this._engine}}class tu{constructor(e,t){this._data=e,this._plugin=t}execute(){}}class Sf{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new tu(e,this._plugin)}check(e){return!1}}class yp{constructor(){this._clipboardExtensionFactoryList=[]}get clipboardExtensionFactoryList(){return this._clipboardExtensionFactoryList}add(...e){this._clipboardExtensionFactoryList.push(...e),this._clipboardExtensionFactoryList.sort(Ft)}delete(e){const t=this._clipboardExtensionFactoryList.indexOf(e);this._clipboardExtensionFactoryList.splice(t,1)}}const wn=class{static async writeText(r,e){var t;if(wn.clipboard)return wn.clipboard.writeText(r).then(()=>!0,n=>console.dir(n));(t=e==null?void 0:e.clipboardData)==null||t.setData("text/html",r)}static async write(r,e){var t,n,s;if(wn.clipboard){const i=new Blob([r.data],{type:(t=r.type)!=null?t:"text/html"}),o=[new ClipboardItem({"text/html":i})];return wn.clipboard.write(o).then(()=>!0,()=>!1)}(s=e==null?void 0:e.clipboardData)==null||s.setData((n=r.type)!=null?n:"text/html",r.data)}static async readText(){return wn.clipboard?wn.clipboard.readText().then(r=>r,()=>null):wn.textArea?new Promise((r,e)=>{r(wn.textArea.value)}).then(r=>r).then(()=>null):null}static async read(r){if(wn.clipboard){const s=await wn.clipboard.read(),i=[];for(const o of s)for(const a of o.types){const l=await o.getType(a),u=new FileReader;a==="image/png"?u.readAsDataURL(l):u.readAsText(l);const c=new Promise((h,f)=>{u.onload=d=>{const m={type:a,result:u.result};h(m)}}).then(h=>h,()=>null);i.push(c)}return Promise.all(i)}const e=[],t=r==null?void 0:r.clipboardData,n=t==null?void 0:t.types;if(!n)return null;for(let s=0;s<n.length;s++)e.push({type:n[s],result:t.getData(n[s])});return e}};let Af=wn;Af.clipboard=window.navigator.clipboard;class Sp{getRegister(){return this._register}constructor(){this._register=new yp}handle(e){var s;const t=(s=this._register)==null?void 0:s.clipboardExtensionFactoryList;if(!t)return;this._clipboardExtensionFactoryList=t;const n=this._checkExtension(e);n&&n.execute()}_checkExtension(e){if(!this._clipboardExtensionFactoryList)return!1;let t=!1;for(let n=0;n<this._clipboardExtensionFactoryList.length&&(t=this._clipboardExtensionFactoryList[n].check(e),t===!1);n++);return t}pasteResolver(e){return new Promise((t,n)=>{Af.read(e).then(s=>{var l,u;if(!s)return[];const i=s.findIndex((c,h)=>c&&c.type==="text/html"),o=s.findIndex((c,h)=>c&&c.type==="text/plain"),a={};if(i>-1){const c=(l=s[i])==null?void 0:l.result;a.html=c}if(o>-1){const c=(u=s[o])==null?void 0:u.result;a.plain=c}t(a)})})}}class Rf{constructor(e,t){this._data=e,this._plugin=t}execute(){}}class Ap{constructor(e){this._plugin=e}get zIndex(){return 0}create(e){return new Rf(e,this._plugin)}check(e){return!1}}class Rp{constructor(){this._DragAndDropExtensionFactoryList=[]}get DragAndDropExtensionFactoryList(){return this._DragAndDropExtensionFactoryList}add(...e){this._DragAndDropExtensionFactoryList.push(...e),this._DragAndDropExtensionFactoryList.sort(Ft)}delete(e){const t=this._DragAndDropExtensionFactoryList.indexOf(e);this._DragAndDropExtensionFactoryList.splice(t,1)}}class Dp{getRegister(){return this._register}constructor(){this._register=new Rp}handle(e){var n;const t=(n=this._register)==null?void 0:n.DragAndDropExtensionFactoryList;!t||(this._DragAndDropExtensionFactoryList=t,this._checkExtension(e))}_checkExtension(e){if(!this._DragAndDropExtensionFactoryList)return!1;this._DragAndDropExtensionFactoryList.forEach(t=>{const n=t.check(e);n!==!1&&n.execute()})}dragResolver(e){return new Promise((t,n)=>{if(!e.dataTransfer)return;const s=[];e.dataTransfer.items?[...e.dataTransfer.items].forEach((i,o)=>{if(i.kind==="file"){const a=i.getAsFile();a&&s.push({kind:i.kind,type:i.type,file:a})}}):[...e.dataTransfer.files].forEach((i,o)=>{i&&s.push({kind:"file",type:i.type,file:i})}),t(s)})}}const nu=rd({});class xp{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onKeyDownObservable","core",new Ae),this._observerManager.addObserver("onKeyUpObservable","core",new Ae),this._observerManager.addObserver("onKeyCopyObservable","core",new Ae),this._observerManager.addObserver("onKeyPasteObservable","core",new Ae),this._observerManager.addObserver("onKeyCutObservable","core",new Ae),this._observerManager.addObserver("onKeyCompositionStartObservable","core",new Ae),this._observerManager.addObserver("onKeyCompositionUpdateObservable","core",new Ae),this._observerManager.addObserver("onKeyCompositionEndObservable","core",new Ae)}handleKeyboardAction(e){const t=c=>{var h;(h=this._observerManager.requiredObserver("onKeyDownObservable","core"))==null||h.notifyObservers(c)},n=c=>{var h;(h=this._observerManager.requiredObserver("onKeyUpObservable","core"))==null||h.notifyObservers(c)},s=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCopyObservable","core"))==null||h.notifyObservers(c)},i=c=>{var h;(h=this._observerManager.requiredObserver("onKeyPasteObservable","core"))==null||h.notifyObservers(c)},o=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCutObservable","core"))==null||h.notifyObservers(c)},a=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCompositionStartObservable","core"))==null||h.notifyObservers(c)},l=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCompositionUpdateObservable","core"))==null||h.notifyObservers(c)},u=c=>{var h;(h=this._observerManager.requiredObserver("onKeyCompositionEndObservable","core"))==null||h.notifyObservers(c)};e.addEventListener("keydown",t),e.addEventListener("keyup",n),e.addEventListener("copy",s),e.addEventListener("paste",i),e.addEventListener("cut",o),e.addEventListener("compositionstart",a),e.addEventListener("compositionupdate",l),e.addEventListener("compositionend",u)}}class Ip{constructor(e){this._plugin=e,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onDropObservable","core",new Ae)}handleDragAction(e){const t=s=>{var i;s.preventDefault(),(i=this._observerManager.requiredObserver("onDropObservable","core"))==null||i.notifyObservers(s)},n=s=>{s.preventDefault()};e.addEventListener("drop",t),e.addEventListener("dragover",n)}}var Tn=(r=>(r.INPUT="input",r.COLOR="color",r.DOUBLE="double",r.JSX="jsx",r.INPUT_NUMBER="inputNumber",r))(Tn||{}),Qr,bt,Na,$c,Ns=0,Df=[],wo=[],Yc=We.__b,jc=We.__r,Kc=We.diffed,Zc=We.__c,qc=We.unmount;function Ws(r,e){We.__h&&We.__h(bt,r,Ns||e),Ns=0;var t=bt.__H||(bt.__H={__:[],__h:[]});return r>=t.__.length&&t.__.push({__V:wo}),t.__[r]}function Ui(r){return Ns=1,xf(If,r)}function xf(r,e,t){var n=Ws(Qr++,2);if(n.t=r,!n.__c&&(n.__=[t?t(e):If(void 0,e),function(i){var o=n.__N?n.__N[0]:n.__[0],a=n.t(o,i);o!==a&&(n.__N=[a,n.__[1]],n.__c.setState({}))}],n.__c=bt,!bt.u)){bt.u=!0;var s=bt.shouldComponentUpdate;bt.shouldComponentUpdate=function(i,o,a){if(!n.__c.__H)return!0;var l=n.__c.__H.__.filter(function(c){return c.__c});if(l.every(function(c){return!c.__N}))return!s||s.call(this,i,o,a);var u=!1;return l.forEach(function(c){if(c.__N){var h=c.__[0];c.__=c.__N,c.__N=void 0,h!==c.__[0]&&(u=!0)}}),!(!u&&n.__c.props===i)&&(!s||s.call(this,i,o,a))}}return n.__N||n.__}function Zr(r,e){var t=Ws(Qr++,3);!We.__s&&ru(t.__H,e)&&(t.__=r,t.i=e,bt.__H.__h.push(t))}function zi(r,e){var t=Ws(Qr++,4);!We.__s&&ru(t.__H,e)&&(t.__=r,t.i=e,bt.__h.push(t))}function Vn(r){return Ns=5,ra(function(){return{current:r}},[])}function Op(r,e,t){Ns=6,zi(function(){return typeof r=="function"?(r(e()),function(){return r(null)}):r?(r.current=e(),function(){return r.current=null}):void 0},t==null?t:t.concat(r))}function ra(r,e){var t=Ws(Qr++,7);return ru(t.__H,e)?(t.__V=r(),t.i=e,t.__h=r,t.__V):t.__}function Ms(r,e){return Ns=8,ra(function(){return r},e)}function kp(r){var e=bt.context[r.__c],t=Ws(Qr++,9);return t.c=r,e?(t.__==null&&(t.__=!0,e.sub(bt)),e.props.value):r.__}function Np(r,e){We.useDebugValue&&We.useDebugValue(e?e(r):r)}function Mp(){var r=Ws(Qr++,11);if(!r.__){for(var e=bt.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);r.__="P"+t[0]+"-"+t[1]++}return r.__}function Fp(){for(var r;r=Df.shift();)if(r.__P&&r.__H)try{r.__H.__h.forEach(To),r.__H.__h.forEach(cl),r.__H.__h=[]}catch(e){r.__H.__h=[],We.__e(e,r.__v)}}We.__b=function(r){bt=null,Yc&&Yc(r)},We.__r=function(r){jc&&jc(r),Qr=0;var e=(bt=r.__c).__H;e&&(Na===bt?(e.__h=[],bt.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=wo,t.__N=t.i=void 0})):(e.__h.forEach(To),e.__h.forEach(cl),e.__h=[])),Na=bt},We.diffed=function(r){Kc&&Kc(r);var e=r.__c;e&&e.__H&&(e.__H.__h.length&&(Df.push(e)!==1&&$c===We.requestAnimationFrame||(($c=We.requestAnimationFrame)||Bp)(Fp)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==wo&&(t.__=t.__V),t.i=void 0,t.__V=wo})),Na=bt=null},We.__c=function(r,e){e.some(function(t){try{t.__h.forEach(To),t.__h=t.__h.filter(function(n){return!n.__||cl(n)})}catch(n){e.some(function(s){s.__h&&(s.__h=[])}),e=[],We.__e(n,t.__v)}}),Zc&&Zc(r,e)},We.unmount=function(r){qc&&qc(r);var e,t=r.__c;t&&t.__H&&(t.__H.__.forEach(function(n){try{To(n)}catch(s){e=s}}),t.__H=void 0,e&&We.__e(e,t.__v))};var Jc=typeof requestAnimationFrame=="function";function Bp(r){var e,t=function(){clearTimeout(n),Jc&&cancelAnimationFrame(e),setTimeout(r)},n=setTimeout(t,100);Jc&&(e=requestAnimationFrame(t))}function To(r){var e=bt,t=r.__c;typeof t=="function"&&(r.__c=void 0,t()),bt=e}function cl(r){var e=bt;r.__c=r.__(),bt=e}function ru(r,e){return!r||r.length!==e.length||e.some(function(t,n){return t!==r[n]})}function If(r,e){return typeof e=="function"?e(r):e}function Of(r,e){for(var t in e)r[t]=e[t];return r}function hl(r,e){for(var t in r)if(t!=="__source"&&!(t in e))return!0;for(var n in e)if(n!=="__source"&&r[n]!==e[n])return!0;return!1}function Ma(r,e){return r===e&&(r!==0||1/r==1/e)||r!=r&&e!=e}function Fs(r){this.props=r}function Lp(r,e){function t(s){var i=this.props.ref,o=i==s.ref;return!o&&i&&(i.call?i(null):i.current=null),e?!e(this.props,s)||!o:hl(this.props,s)}function n(s){return this.shouldComponentUpdate=t,b(r,s)}return n.displayName="Memo("+(r.displayName||r.name)+")",n.prototype.isReactComponent=!0,n.__f=!0,n}(Fs.prototype=new At).isPureReactComponent=!0,Fs.prototype.shouldComponentUpdate=function(r,e){return hl(this.props,r)||hl(this.state,e)};var Qc=We.__b;We.__b=function(r){r.type&&r.type.__f&&r.ref&&(r.props.ref=r.ref,r.ref=null),Qc&&Qc(r)};var Pp=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function su(r){function e(t){var n=Of({},t);return delete n.ref,r(n,t.ref||null)}return e.$$typeof=Pp,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(r.displayName||r.name)+")",e}var eh=function(r,e){return r==null?null:zn(zn(r).map(e))},Hp={map:eh,forEach:eh,count:function(r){return r?zn(r).length:0},only:function(r){var e=zn(r);if(e.length!==1)throw"Children.only";return e[0]},toArray:zn},Up=We.__e;We.__e=function(r,e,t,n){if(r.then){for(var s,i=e;i=i.__;)if((s=i.__c)&&s.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),s.__c(r,e)}Up(r,e,t,n)};var th=We.unmount;function kf(r,e,t){return r&&(r.__c&&r.__c.__H&&(r.__c.__H.__.forEach(function(n){typeof n.__c=="function"&&n.__c()}),r.__c.__H=null),(r=Of({},r)).__c!=null&&(r.__c.__P===t&&(r.__c.__P=e),r.__c=null),r.__k=r.__k&&r.__k.map(function(n){return kf(n,e,t)})),r}function Nf(r,e,t){return r&&(r.__v=null,r.__k=r.__k&&r.__k.map(function(n){return Nf(n,e,t)}),r.__c&&r.__c.__P===e&&(r.__e&&t.insertBefore(r.__e,r.__d),r.__c.__e=!0,r.__c.__P=t)),r}function yo(){this.__u=0,this.t=null,this.__b=null}function Mf(r){var e=r.__.__c;return e&&e.__a&&e.__a(r)}function zp(r){var e,t,n;function s(i){if(e||(e=r()).then(function(o){t=o.default||o},function(o){n=o}),n)throw n;if(!t)throw e;return b(t,i)}return s.displayName="Lazy",s.__f=!0,s}function si(){this.u=null,this.o=null}We.unmount=function(r){var e=r.__c;e&&e.__R&&e.__R(),e&&r.__h===!0&&(r.type=null),th&&th(r)},(yo.prototype=new At).__c=function(r,e){var t=e.__c,n=this;n.t==null&&(n.t=[]),n.t.push(t);var s=Mf(n.__v),i=!1,o=function(){i||(i=!0,t.__R=null,s?s(a):a())};t.__R=o;var a=function(){if(!--n.__u){if(n.state.__a){var u=n.state.__a;n.__v.__k[0]=Nf(u,u.__c.__P,u.__c.__O)}var c;for(n.setState({__a:n.__b=null});c=n.t.pop();)c.forceUpdate()}},l=e.__h===!0;n.__u++||l||n.setState({__a:n.__b=n.__v.__k[0]}),r.then(o,o)},yo.prototype.componentWillUnmount=function(){this.t=[]},yo.prototype.render=function(r,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),n=this.__v.__k[0].__c;this.__v.__k[0]=kf(this.__b,t,n.__O=n.__P)}this.__b=null}var s=e.__a&&b(yt,null,r.fallback);return s&&(s.__h=null),[b(yt,null,e.__a?null:r.children),s]};var nh=function(r,e,t){if(++t[1]===t[0]&&r.o.delete(e),r.props.revealOrder&&(r.props.revealOrder[0]!=="t"||!r.o.size))for(t=r.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;r.u=t=t[2]}};function Wp(r){return this.getChildContext=function(){return r.context},r.children}function Vp(r){var e=this,t=r.i;e.componentWillUnmount=function(){Is(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),r.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(n){this.childNodes.push(n),e.i.appendChild(n)},insertBefore:function(n,s){this.childNodes.push(n),e.i.appendChild(n)},removeChild:function(n){this.childNodes.splice(this.childNodes.indexOf(n)>>>1,1),e.i.removeChild(n)}}),Is(b(Wp,{context:e.context},r.__v),e.l)):e.l&&e.componentWillUnmount()}function Gp(r,e){var t=b(Vp,{__v:r,i:e});return t.containerInfo=e,t}(si.prototype=new At).__a=function(r){var e=this,t=Mf(e.__v),n=e.o.get(r);return n[0]++,function(s){var i=function(){e.props.revealOrder?(n.push(s),nh(e,r,n)):s()};t?t(i):i()}},si.prototype.render=function(r){this.u=null,this.o=new Map;var e=zn(r.children);r.revealOrder&&r.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return r.children},si.prototype.componentDidUpdate=si.prototype.componentDidMount=function(){var r=this;this.o.forEach(function(e,t){nh(r,t,e)})};var Ff=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,Xp=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,$p=typeof document!="undefined",Yp=function(r){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(r)};function jp(r,e,t){return e.__k==null&&(e.textContent=""),Is(r,e),typeof t=="function"&&t(),r?r.__c:null}function Kp(r,e,t){return td(r,e),typeof t=="function"&&t(),r?r.__c:null}At.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(r){Object.defineProperty(At.prototype,r,{configurable:!0,get:function(){return this["UNSAFE_"+r]},set:function(e){Object.defineProperty(this,r,{configurable:!0,writable:!0,value:e})}})});var rh=We.event;function Zp(){}function qp(){return this.cancelBubble}function Jp(){return this.defaultPrevented}We.event=function(r){return rh&&(r=rh(r)),r.persist=Zp,r.isPropagationStopped=qp,r.isDefaultPrevented=Jp,r.nativeEvent=r};var Bf,sh={configurable:!0,get:function(){return this.class}},ih=We.vnode;We.vnode=function(r){var e=r.type,t=r.props,n=t;if(typeof e=="string"){var s=e.indexOf("-")===-1;for(var i in n={},t){var o=t[i];$p&&i==="children"&&e==="noscript"||i==="value"&&"defaultValue"in t&&o==null||(i==="defaultValue"&&"value"in t&&t.value==null?i="value":i==="download"&&o===!0?o="":/ondoubleclick/i.test(i)?i="ondblclick":/^onchange(textarea|input)/i.test(i+e)&&!Yp(t.type)?i="oninput":/^onfocus$/i.test(i)?i="onfocusin":/^onblur$/i.test(i)?i="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(i)?i=i.toLowerCase():s&&Xp.test(i)?i=i.replace(/[A-Z0-9]/g,"-$&").toLowerCase():o===null&&(o=void 0),/^oninput$/i.test(i)&&(i=i.toLowerCase(),n[i]&&(i="oninputCapture")),n[i]=o)}e=="select"&&n.multiple&&Array.isArray(n.value)&&(n.value=zn(t.children).forEach(function(a){a.props.selected=n.value.indexOf(a.props.value)!=-1})),e=="select"&&n.defaultValue!=null&&(n.value=zn(t.children).forEach(function(a){a.props.selected=n.multiple?n.defaultValue.indexOf(a.props.value)!=-1:n.defaultValue==a.props.value})),r.props=n,t.class!=t.className&&(sh.enumerable="className"in t,t.className!=null&&(n.class=t.className),Object.defineProperty(n,"className",sh))}r.$$typeof=Ff,ih&&ih(r)};var oh=We.__r;We.__r=function(r){oh&&oh(r),Bf=r.__c};var Qp={ReactCurrentDispatcher:{current:{readContext:function(r){return Bf.__n[r.__c].props.value}}}};function e_(r){return b.bind(null,r)}function Lf(r){return!!r&&r.$$typeof===Ff}function t_(r){return Lf(r)?nd.apply(null,arguments):r}function n_(r){return!!r.__k&&(Is(null,r),!0)}function r_(r){return r&&(r.base||r.nodeType===1&&r)||null}var s_=function(r,e){return r(e)},i_=function(r,e){return r(e)},o_=yt;function Pf(r){r()}function a_(r){return r}function l_(){return[!1,Pf]}var u_=zi;function c_(r,e){var t=e(),n=Ui({h:{__:t,v:e}}),s=n[0].h,i=n[1];return zi(function(){s.__=t,s.v=e,Ma(s.__,e())||i({h:s})},[r,t,e]),Zr(function(){return Ma(s.__,s.v())||i({h:s}),r(function(){Ma(s.__,s.v())||i({h:s})})},[r]),t}var vt={useState:Ui,useId:Mp,useReducer:xf,useEffect:Zr,useLayoutEffect:zi,useInsertionEffect:u_,useTransition:l_,useDeferredValue:a_,useSyncExternalStore:c_,startTransition:Pf,useRef:Vn,useImperativeHandle:Op,useMemo:ra,useCallback:Ms,useContext:kp,useDebugValue:Np,version:"17.0.2",Children:Hp,render:jp,hydrate:Kp,unmountComponentAtNode:n_,createPortal:Gp,createElement:b,createContext:rd,createFactory:e_,cloneElement:t_,createRef:Ve,Fragment:yt,isValidElement:Lf,findDOMNode:r_,Component:At,PureComponent:Fs,memo:Lp,forwardRef:su,flushSync:i_,unstable_batchedUpdates:s_,StrictMode:o_,Suspense:yo,SuspenseList:si,lazy:zp,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:Qp};class Xe extends At{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}Xe.contextType=nu;class h_ extends Fs{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}h_.contextType=nu;function d_(r){return r instanceof Element||r instanceof HTMLDocument}const f_=typeof HTMLElement=="object"?function(r){return r instanceof HTMLElement}:function(r){return r&&typeof r=="object"&&r.nodeType===1&&typeof r.nodeName=="string"};function Rr(r,e){e=e||document;let t=e.querySelectorAll(r);return t.length===1?Array.prototype.slice.call(t)[0]:Array.prototype.slice.call(t)}function dl(r){return r=r?`${r}-`:"",r+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function g_(r){let e=[],t=r.getElementsByTagName("*");for(let n=0,s=t.length;n<s;++n){if(t[n].nodeType!==1)continue;let i=t[n].parentNode;i&&i.nodeType===1?i===r&&(e[e.length]=t[n]):i&&i.parentNode===r&&(e[e.length]=t[n])}return e}function sn(...r){if(!r.length)return;let e="";return r.forEach(t=>{if(t instanceof Object)for(let n in t)t[n]&&(e+=` ${n}`);else e+=` ${t}`}),e}const m_=r=>[...r.parentNode.children].indexOf(r);function Xr(r,e){let t=null;return function(...n){clearTimeout(t),t=setTimeout(()=>{r(...n)},e)}}function p_(r){var e,t;if(window.getSelection){let n=document.createRange(),s=r.firstChild;s&&(n.setStart(s,0),n.setEnd(s,s.length),n.startContainer&&Hf(n.startContainer)&&((e=window.getSelection())==null||e.removeAllRanges(),(t=window.getSelection())==null||t.addRange(n)))}}function __(r,e){var t,n;if(window.getSelection){let s=document.createRange(),i=r.firstChild,o=e.firstChild;i&&o&&(s.setStart(i,0),s.setEnd(o,o.length),s.startContainer&&Hf(s.startContainer)&&((t=window.getSelection())==null||t.removeAllRanges(),(n=window.getSelection())==null||n.addRange(s)))}}function Hf(r){return r===document.body?!1:document.body.contains(r)}function Ut(r){return r.length===0?r:r.replace(/^\s+|\s+$/gm,"")}function Ai(r){if(f_(r.current))return r.current;let e=r.current;return e?e==null?void 0:e.base:r.base}function fl(r){return typeof r!="string"?r:r.replace(/<script>/g,"&lt;script&gt;").replace(/<\/script>/,"&lt;/script&gt;")}function b_(r){const e=window.getSelection();e&&e.selectAllChildren(r),e&&e.collapseToEnd()}function Uf(r){var a;let e=r.childNodes;if(e.length===0)return r.textContent;if(e[0].nodeName==="DIV"&&(e=e[0].childNodes),e.length===1&&e[0].nodeName==="#text")return e[0].textContent;const t={},n=[];let s=0;for(let l=0;l<e.length;l++){let u=e[`${l}`],c;u.nodeName==="#text"?(c=(a=u.textContent)!=null?a:"",u=u.parentElement):c=u.innerText;let h=iu(u);v_(c).forEach(d=>{s=+d.length;let m=Rt(6);t[m]={eId:m,st:0,ed:d.length-1,et:0,tr:{ct:d,ts:h}},n.push({elementId:m,paragraphElementType:0})})}const i=Rt(6);return{id:Rt(6),body:{blockElements:{[i]:{blockId:i,st:0,ed:s,blockType:0,paragraph:{elements:t,elementOrder:n}},b:{blockId:"b",st:0,ed:0,blockType:ze.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:1,sectionType:0}}},blockElementOrder:[i,"b"]},documentStyle:{}}}function zf(r){var t;let e="";if((t=r.body)!=null&&t.blockElements)for(let n in r.body.blockElements){const s=r.body.blockElements[n];if(!(s.blockType!==ze.PARAGRAPH&&s.blockType!==ze.SECTION_BREAK)&&s.blockType===ze.PARAGRAPH)for(let i in s.paragraph){const o=s.paragraph[i];for(let a in o){const l=o[a];if(l.et===q.TEXT_RUN){let u=`display:inline-block;${ou(l.tr.ts)}`;e+=`<span id='${l.eId}' ${u.length?`style="${u}"`:""} >${l.tr.ct}</span>`}}}}return e}function iu(r){const e=r.style.cssText;if(e==null||e.length===0)return{};let t=e.split(";"),n={};return t.forEach(s=>{s=s.toLowerCase();let i=Ut(s.substr(0,s.indexOf(":"))),o=Ut(s.substr(s.indexOf(":")+1));if(i==="font-weight")o==="bold"?n.bl=1:n.bl=0;else if(i==="font-style")o==="italic"?n.it=1:n.it=0;else if(i==="font-family")n.ff=o;else if(i==="font-size"){let a=parseInt(o);e.indexOf("vertical-align")>-1&&(e.indexOf("sub")>-1||e.indexOf("sup")>-1)&&(a*=2),o.indexOf("px")!==-1&&(a=Em(parseInt(o))),n.fs=a}else i==="color"?n.cl={rgb:o}:i==="background"||i==="background-color"?n.bg={rgb:o}:i==="text-decoration-line"?o==="underline"?(n.ul||(n.ul={s:1}),n.ul.s=1):o==="line-through"?(n.st||(n.st={s:1}),n.st.s=1):o==="overline"&&(n.ol||(n.ol={s:1}),n.ol.s=1):i==="text-decoration-color"?(n.hasOwnProperty("ul")&&(n.ul||(n.ul={s:1,cl:{rgb:o}}),n.ul.cl={rgb:o}),n.hasOwnProperty("st")&&(n.st||(n.st={s:1,cl:{rgb:o}}),n.st.cl={rgb:o}),n.hasOwnProperty("ol")&&(n.ol||(n.ol={s:1,cl:{rgb:o}}),n.ol.cl={rgb:o})):i==="text-decoration-style"?(n.hasOwnProperty("ul")&&(n.ul||(n.ul={s:1,t:Number(o)}),n.ul.t=Number(o)),n.hasOwnProperty("st")&&(n.st||(n.st={s:1,t:Number(o)}),n.st.t=Number(o)),n.hasOwnProperty("ol")&&(n.ol||(n.ol={s:1,t:Number(o)}),n.ol.t=Number(o))):(i==="text-decoration"||i==="univer-strike")&&(n.st={s:1});if(i==="univer-underline"&&(n.ul={s:1}),i==="vertical-align"&&(o==="sub"?n.va=1:o==="super"?n.va=2:o==="top"?n.vt=1:o==="middle"?n.vt=2:o==="bottom"?n.vt=3:n.va=0),i==="transform"){const a=o.split(")"),l=a.findIndex(u=>u.includes("rotate"));if(l>-1){const u=a[l].match(/\d+/g);let c=0,h=0;u!=null&&u.length&&(c=+u[0]),r.dataset.vertical&&(h=+r.dataset.vertical),n.tr={a:c,v:h}}}i==="text-align"&&(o==="left"?n.ht=1:o==="center"?n.ht=2:o==="right"?n.ht=3:o==="justify"?n.ht=4:n.ht=0),(i==="overflow-wrap"||i==="overflowWrap")&&o==="break-word"&&(n.tb=3)}),n}function v_(r){if(r==="")return[r];const e=/(?:(\n+.+)|(.+))/g;return r.match(e).map(s=>s.replace(/\n/g,`\r
`))}function ou(r,e=!1){var i;let t="";const n=new Map([["ff",()=>{r.ff&&(t+=`font-family: ${r.ff}; `)}],["fs",()=>{if(r.fs){let o=r.fs;r.va&&(o/=2),t+=`font-size: ${o}pt; `}}],["it",()=>{r.it?t+="font-style: italic; ":t+="font-style: normal; "}],["bl",()=>{r.bl?t+="font-weight: bold; ":t+="font-weight: normal; "}],["ul",()=>{var o;(o=r.ul)!=null&&o.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," underline"):t+="text-decoration-line: underline; ",r.ul.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${zt(r.ul.cl)}; `),r.ul.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${r.ul.t} `))}],["st",()=>{var o;(o=r.st)!=null&&o.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," line-through"):t+="text-decoration-line: line-through; ",r.st.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${zt(r.st.cl)}; `),r.st.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${r.st.t} `))}],["ol",()=>{var o;(o=r.ol)!=null&&o.s&&(t.indexOf("text-decoration-line")>-1?t=t.replace(new RegExp("(?<=text-decoration-line:.*)\\b(?=;)","g")," overline"):t+="text-decoration-line: overline; ",r.ol.cl&&t.indexOf("text-decoration-color")===-1&&(t+=`text-decoration-color: ${zt(r.ol.cl)}; `),r.ol.t&&t.indexOf("text-decoration-style")===-1&&(t+=`text-decoration-style: ${r.ol.t} `))}],["bg",()=>{t+=`background: ${zt(r.bg)}; `}],["bd",()=>{var o,a,l,u,c,h,f,d,m,g,p,_;(o=r.bd)!=null&&o.b&&(t+=`border-bottom: ${Ji((a=r.bd)==null?void 0:a.b.s)} ${(l=zt(r.bd.b.cl))!=null?l:""}; `),(u=r.bd)!=null&&u.t&&(t+=`border-top: ${Ji((c=r.bd)==null?void 0:c.t.s)} ${(h=zt(r.bd.t.cl))!=null?h:""}; `),(f=r.bd)!=null&&f.r&&(t+=`border-right: ${Ji((d=r.bd)==null?void 0:d.r.s)} ${(m=zt(r.bd.r.cl))!=null?m:""}; `),(g=r.bd)!=null&&g.l&&(t+=`border-left: ${Ji((p=r.bd)==null?void 0:p.l.s)} ${(_=zt(r.bd.l.cl))!=null?_:""}; `)}],["cl",()=>{t+=`color: ${zt(r.cl)}; `}],["va",()=>{r.va===un.NORMAL?t+="vertical-align: baseline; ":r.va===un.SUBSCRIPT?t+="vertical-align: sub; ":t+="vertical-align: super; "}],["td",()=>{r.td===Ci.UNSPECIFIED?t+="direction: inherit; ":r.td===Ci.LEFT_TO_RIGHT?t+="direction: ltr; ":t+="direction: rtl; "}],["tr",()=>{var o,a,l;t+=`data-rotate: (${(o=r.tr)==null?void 0:o.a}deg${(a=r.tr)!=null&&a.v?` ,${(l=r.tr)==null?void 0:l.v}`:""});`}],["ht",()=>{r.ht===ct.UNSPECIFIED?t+="text-align: inherit; ":r.ht===ct.LEFT?t+="text-align: left; ":r.ht===ct.RIGHT?t+="text-align: right; ":r.ht===ct.CENTER?t+="text-align: center; ":t+="text-align: justify; "}],["vt",()=>{r.vt===rn.UNSPECIFIED?t+="vertical-align: inherit; ":r.vt===rn.BOTTOM?t+="vertical-align: bottom; ":r.vt===rn.TOP?t+="vertical-align: top; ":t+="vertical-align: middle; "}],["tb",()=>{r.tb===Mt.CLIP?t+="text-overflow: clip; ":r.tb===Mt.OVERFLOW?t+="text-break: overflow; ":r.tb===Mt.WRAP&&(t+="word-wrap: break-word; word-break: normal; ")}],["pd",()=>{var c,h,f,d,m,g,p,_;let o=`${(c=r.pd)==null?void 0:c.b}pt`,a=`${(h=r.pd)==null?void 0:h.t}pt`,l=`${(f=r.pd)==null?void 0:f.l}pt`,u=`${(d=r.pd)==null?void 0:d.r}pt`;(m=r.pd)!=null&&m.b&&(t+=`padding-bottom: ${o}; `),(g=r.pd)!=null&&g.t&&(t+=`padding-top: ${a}; `),(p=r.pd)!=null&&p.l&&(t+=`padding-left: ${l}; `),(_=r.pd)!=null&&_.r&&(t+=`padding-right: ${u}; `)}]]),s=["bd","tr","tb"];for(let o in r)e&&s.includes(o)||(i=n.get(o))==null||i();return t}function Ji(r){let e="";return r===C.NONE?e="none":r===C.THIN?e="0.5pt solid":r===C.HAIR?e="0.5pt double":r===C.DOTTED?e="0.5pt dotted":r===C.DASHED||r===C.DASH_DOT?e="0.5pt dashed":r===C.DASH_DOT_DOT?e="0.5pt dotted":r===C.DOUBLE?e="0.5pt double":r===C.MEDIUM?e="1pt solid":r===C.MEDIUM_DASHED||r===C.MEDIUM_DASH_DOT?e="1pt dashed":r===C.MEDIUM_DASH_DOT_DOT?e="1pt dotted":r===C.SLANT_DASH_DOT?e="0.5pt dashed":r===C.THICK&&(e="1.5pt solid"),e}function C_(r){let e=[];const t=document.createElement("DIV");if(t.innerHTML=r,e=new Array(t.querySelectorAll("table tr").length),!e.length)return[];let n=0;const s=t.querySelectorAll("table tr");s[0].querySelectorAll("td").forEach(a=>{let l=0;const u=a.getAttribute("colSpan");u!==null?l=+u:l=1,n+=l});for(let a=0;a<e.length;a++)e[a]=new Array(n);let o=0;return s.forEach(a=>{let l=0;a.querySelectorAll("td").forEach(u=>{let c={};if(u.querySelectorAll("span").length||u.querySelectorAll("font").length){const d=Uf(u);typeof d!="string"&&(c.p=d)}let h=u.innerText;h.trim().length===0?(c.v="",c.m=""):(c.v=h,c.m=h);const f=iu(u);for(G.isPlainObject(f)&&(c.s=f);l<n&&e[o][l]!=null;)l++;if(l!==n){if(e[o][l]==null){e[o][l]=c;let d=Number(u.getAttribute("rowSpan")),m=Number(u.getAttribute("colSpan"));if(Number.isNaN(d)&&(d=1),Number.isNaN(m)&&(m=1),d>1||m>1){let g={rs:d-1,cs:m-1,r:o,c:l};e[o][l].mc=g;for(let p=0;p<d;p++)for(let _=0;_<m;_++)p===0&&_===0||(e[o+p][l+_]={mc:null})}}l++}}),o++}),e}function E_(r){let e=[];const t=document.createElement("DIV");t.innerHTML=r;let s=r.replace(/\r/g,"").split(`
`),i=s[0].split("	").length;for(let o=0;o<s.length;o++)s[o].split("	").length<i||e.push(s[o].split("	"));for(let o=0;o<e.length;o++)for(let a=0;a<e[o].length;a++)e[o][a].length?e[o][a]={v:e[o][a]||"",m:e[o][a]||""}:e[o][a]=null;return e}function w_(r,e){r.length,r[0].length;let t=0,n=0;e&&(t=e.startRow,n=e.startColumn);const s=[];for(let i=0;i<r.length;i++)for(let o=0;o<r[i].length;o++)if(r[i][o]&&typeof r[i][o]=="object"&&"mc"in r[i][o])if(r[i][o].mc){const a=r[i][o].mc,l=a.r+t,u=l+a.rs,c=a.c+n,h=c+a.cs;s.push({startRow:l,endRow:u,startColumn:c,endColumn:h}),delete r[i][o].mc}else r[i][o]=null;return{data:r,mergeData:s}}class T_{constructor(e){this._plugin=e,this.initialize()}initialize(){this.setClipboardExtensionManager(),this.setDragAndDropExtensionManager()}setClipboardExtensionManager(){this._clipboardExtensionManager=new Sp;const e=this._plugin.getContext().getObserverManager().getObserver("onKeyPasteObservable","core");e&&!e.hasObservers()&&e.add(t=>{this._clipboardExtensionManager.pasteResolver(t).then(n=>{this._clipboardExtensionManager.handle(n)})})}setDragAndDropExtensionManager(){this._dragAndDropExtensionManager=new Dp;const e=this._plugin.getContext().getObserverManager().getObserver("onDropObservable","core");e&&!e.hasObservers()&&e.add(t=>{this._dragAndDropExtensionManager.dragResolver(t).then(n=>{n.length!==0&&this._dragAndDropExtensionManager.handle(n)})})}getClipboardExtensionManager(){return this._clipboardExtensionManager}getDragAndDropExtensionManager(){return this._dragAndDropExtensionManager}onMounted(){this.initialize()}onDestroy(){}}class au extends or{constructor(){super(Je.BASE_COMPONENT)}static create(){return new au}installTo(e){e.installPlugin(this)}initialize(){this.getContext(),this.setRegisterManager()}setRegisterManager(){this._registerManager=new T_(this)}getRegisterManager(){return this._registerManager}onMounted(){this.initialize()}onDestroy(){}}const y_="univer-icon",S_="univer-icon-icon",A_="univer-icon-spin",R_="univer-loadingCircle";var Fa={icon:y_,iconIcon:S_,iconSpin:A_,loadingCircle:R_};const Se=r=>{const{spin:e,rotate:t,children:n,name:s,style:i,className:o}=r;let a;i?(a=i,a.transform=t?`rotate(${t}deg)`:""):a=t?{transform:`rotate(${t}deg)`}:{};const l=sn(Fa.icon,{[`${Fa.icon}-${s}`]:s,[`${Fa.icon}-spin`]:e||s==="loading"},o);return b("span",{role:"img",className:l,style:{...a}},n)},Wf=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"loading",style:r.style},b("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));class D_{render(){return Wf}}const x_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"logo",style:r.style},b("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},b("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),b("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),b("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),b("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),b("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"})));class I_{render(){return x_}}const O_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),b("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),b("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),b("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),b("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),k_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),b("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),b("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),b("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),N_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),M_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),F_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),B_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),b("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),L_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})));class P_{render(){return O_}}class H_{render(){return k_}}class U_{render(){return N_}}class z_{render(){return M_}}class W_{render(){return F_}}class V_{render(){return B_}}class G_{render(){return L_}}const X_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),$_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),b("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),b("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),Y_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),b("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),b("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),j_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),b("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),b("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),b("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),K_=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));class Z_{render(){return X_}}class q_{render(){return $_}}class J_{render(){return Y_}}class Q_{render(){return j_}}class e2{render(){return K_}}const t2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),b("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),n2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),b("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),r2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),b("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),b("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),s2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),b("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),b("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),b("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),b("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),b("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),b("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),i2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),b("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),b("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),b("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),b("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),b("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),o2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),b("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),b("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),b("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),b("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),b("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),b("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),a2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),b("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),b("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),l2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),b("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),b("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),b("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),u2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),b("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),b("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),c2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),b("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),h2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),b("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),d2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),b("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));class f2{render(){return t2}}class g2{render(){return n2}}class m2{render(){return r2}}class p2{render(){return s2}}class _2{render(){return i2}}class b2{render(){return o2}}class v2{render(){return a2}}class C2{render(){return l2}}class E2{render(){return u2}}class w2{render(){return c2}}class T2{render(){return h2}}class y2{render(){return d2}}const S2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),A2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),R2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),D2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),x2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),I2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),O2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),k2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),N2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),M2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),F2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),B2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),L2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),b("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),b("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),P2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),b("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),H2=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),b("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));class U2{render(){return S2}}class z2{render(){return A2}}class W2{render(){return R2}}class V2{render(){return D2}}class G2{render(){return x2}}class X2{render(){return I2}}class $2{render(){return O2}}class Y2{render(){return k2}}class j2{render(){return N2}}class K2{render(){return M2}}class Z2{render(){return F2}}class q2{render(){return B2}}class J2{render(){return L2}}class Q2{render(){return P2}}class eb{render(){return H2}}const tb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),nb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),b("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),rb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),b("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),b("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})));class sb{render(){return tb}}class ib{render(){return nb}}class ob{render(){return rb}}const Vf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),Gf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),Xf=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),$f=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"nextIcon",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),Yf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"rightIcon",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),jf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),b("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),Kf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},b("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),b("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),lu=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),b("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),Zf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),qf=r=>b(Se,{spin:r.spin,rotate:r.rotate,className:r.className,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),b("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),b("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var Ri={BackIcon:Vf,ForwardIcon:Gf,FormatIcon:Xf,NextIcon:$f,RightIcon:Yf,CorrectIcon:jf,LtIcon:Kf,CloseIcon:lu,MenuIcon:Zf,HideIcon:qf};class ab{render(){return Vf}}class lb{render(){return Gf}}class ub{render(){return Xf}}class cb{render(){return $f}}class hb{render(){return Yf}}class db{render(){return jf}}class fb{render(){return Kf}}class gb{render(){return lu}}class mb{render(){return lu}}class pb{render(){return Zf}}class _b{render(){return qf}}const bb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),vb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),Cb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),Eb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),wb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),Tb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),yb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),b("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),Sb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),Ab=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})));class Rb{render(){return bb}}class Db{render(){return vb}}class xb{render(){return Cb}}class Ib{render(){return Eb}}class Ob{render(){return wb}}class kb{render(){return Tb}}class Nb{render(){return yb}}class Mb{render(){return Sb}}class Fb{render(){return Ab}}const Jf=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),b("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"})));class Bb{render(){return Jf}}const Qf=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},b("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),b("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),b("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),b("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),b("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"})));class Lb{render(){return Qf}}const eg=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"})));class Pb{render(){return eg}}const tg=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"})));class Hb{render(){return tg}}const ng=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"})));class Ub{render(){return ng}}const rg=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"})));class zb{render(){return rg}}const sg=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"})));class Wb{render(){return sg}}const ig=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"})));class Vb{render(){return ig}}const og=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},b("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),b("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),b("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"})));class Gb{render(){return og}}const ag=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),b("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),b("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"})));class Xb{render(){return ag}}const lg=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"})));class $b{render(){return lg}}const ug=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));class Yb{render(){return ug}}var jb={CommentIcon:Jf,FreezeIcon:Qf,conditionalFormatIcon:eg,DivideIcon:tg,ReplaceIcon:ng,SearchIcon:rg,LockIcon:sg,LocationIcon:ig,PageIcon:og,RegularIcon:ag,LayoutIcon:lg,TableIcon:ug};const Kb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),b("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),b("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),Zb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),qb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),Jb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),b("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),Qb=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"foward",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})));class ev{render(){return Kb}}class tv{render(){return Zb}}class nv{render(){return qb}}class rv{render(){return Jb}}class sv{render(){return Qb}}const iv=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"logo",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},b("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),b("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"})));class ov{render(){return iv}}const av=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"logo",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},b("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),b("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),lv=r=>b(Se,{spin:r.spin,rotate:r.rotate,name:"dropdown",style:r.style},b("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},b("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),b("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})));var cg={Close:av,DropDownIcon:lv};const uv={RightIcon:b(Ri.RightIcon,null)},cv="univer-btn",hv="univer-btn-lg",dv="univer-btn-sm",fv="univer-btn-primary",gv="univer-btn-danger",mv="univer-btn-text",pv="univer-btn-round",_v="univer-btn-circle",bv="univer-btn-block",vv="univer-btn-loading";var Br={btn:cv,btnLg:hv,btnSm:dv,btnPrimary:fv,btnDanger:gv,btnText:mv,btnRound:pv,btnCircle:_v,btnBlock:bv,btnLoading:vv};const In=r=>{const{type:e,shape:t,size:n,htmlType:s="button",danger:i=!1,disabled:o,block:a=!1,loading:l=!1,active:u=!1,onClick:c,children:h,className:f="",style:d}=r,m=w=>{if(o){w.preventDefault();return}c&&c(w)};let g="";switch(n){case"large":g="lg";break;case"small":g="sm";break}const p=sn(Br.btn,{[`${Br.btn}-${e}`]:e,[`${Br.btn}-${t}`]:t,[`${Br.btn}-${g}`]:n,[`${Br.btn}-danger`]:!!i,[`${Br.btn}-block`]:a,[`${Br.btn}-loading`]:l},f);let _=d;return u&&(_=Object.assign(d||{},{background:"#eee"})),b("button",{type:s,onClick:m,className:p,disabled:o,style:{..._}},l?b(Wf,null):"",h)};class Cv{render(){return In}}var Ev={};class Nn extends Xe{constructor(){super(...arguments),this.canvasRef=Ve()}componentDidMount(){this.drawLine()}drawLine(){const e=this.canvasRef;this.props.drawLine(e)}setLineDash(e,t,n,s,i,o,a){try{t==="Hair"?e.setLineDash([1,2]):t.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):t.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):t.indexOf("Dotted")>-1?e.setLineDash([2]):t.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(l){console.log(l)}e.beginPath(),t.indexOf("Medium")>-1?(n==="h"?(e.moveTo(s,i-.5),e.lineTo(o,a-.5)):(e.moveTo(s-.5,i),e.lineTo(o-.5,a)),e.lineWidth=2):t==="Thick"?(e.moveTo(s,i),e.lineTo(o,a),e.lineWidth=3):(e.moveTo(s,i),e.lineTo(o,a),e.lineWidth=1)}render(){return b("canvas",{ref:this.canvasRef,className:Ev.canvas,width:this.props.width,height:this.props.height})}}class wv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Thin","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Tv{render(){return wv}}class yv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Hair","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Sv{render(){return yv}}class Av extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Dotted","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Rv{render(){return Av}}class Dv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Dashed","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class xv{render(){return Dv}}class Iv extends Xe{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"DashDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Ov{render(){return Iv}}class kv extends Xe{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"DashDotDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Nv{render(){return kv}}class Mv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Medium","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Fv{render(){return Mv}}class Bv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashed","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Lv{render(){return Bv}}class Pv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Hv{render(){return Pv}}class Uv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"MediumDashDotDot","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class zv{render(){return Uv}}class Wv extends At{constructor(){super(...arguments),this.ref=Ve()}drawLine(e){let n=e.current.getContext("2d");this.ref.current.setLineDash(n,"Thick","h",0,5,100,5),n.stroke(),n.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return b(Nn,{ref:this.ref,width:e,height:t,drawLine:n=>this.drawLine(n)})}}class Vv{render(){return Wv}}const Gv="univer-cell-range-modal",Xv="univer-input",$v="univer-cell-modal-icon";var ah={cellRangeModal:Gv,input:Xv,cellModalIcon:$v};class Yv extends Xe{constructor(){super(...arguments),this.ref=Ve(),this.state={modalData:[{name:"dataValidation.selectCellRange2",show:!1,group:[{name:"button.confirm",type:"primary",onClick:()=>this.handleOk()},{name:"button.cancel"}]}],placeholderState:{name:"dataValidation.selectCellRange2"},value:""},this.showModal=(e,t)=>{let{modalData:n}=this.state;const s=n.findIndex(i=>i.name===e);s>-1&&(n[s].show=t),this.setValue({modalData:n})},this.handleOk=()=>{const e=this.ref.current.getValue();this.showModal("dataValidation.selectCellRange2",!1),this.setValue({value:e})},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.changeRange=e=>{const t=e.target;this.setValue({value:t.value})},this.showRange=()=>{var e;this.showModal("dataValidation.selectCellRange2",!0),(e=this._context.getWorkBook().getActiveSheet())==null||e.getSelection().setSelection({selection:this.state.value})}}setLocale(){const e=this.context.locale;this.setState(t=>{let{modalData:n,placeholderState:s}=t;return n.forEach(i=>{i.title=e.get(i.locale),i.group&&i.group.length&&i.group.forEach(o=>{o.label=e.get(o.locale)})}),s.label=e.get(s.name),{modalData:n,placeholderState:s}})}componentWillReceiveProps(e){this.setValue({value:e.valueProps})}componentDidMount(){var e,t;this.setValue({value:this.props.valueProps}),this.setLocale(),this._context,this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()}),this._localeObserver1=(t=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable","worksheet"))==null?void 0:t.add(n=>{console.dir(n)})}componentWillUnmount(){}render(e,t){const{modalData:n,placeholderState:s,value:i}=t,{placeholderProps:o}=e;return b("div",{className:ah.cellRangeModal},b(xi,{placeholder:o,value:i,onChange:a=>this.changeRange(a)}),b("span",{className:ah.cellModalIcon,onClick:this.showRange},b(jb.TableIcon,null)),n.map(a=>{if(!!a.show)return b(du,{title:a.title,visible:a.show,group:a.group,onCancel:a.onCancel},b(xi,{readonly:!0,placeholder:s.label,value:i,ref:this.ref}))}))}}class jv{render(){return Yv}}const Kv="univer-checkbox-wrapper",Zv="univer-check-box",qv="univer-checkbox-input",Jv="univer-checkbox-inner",Qv="univer-check-box-checked",eC="univer-check-box-disabled",tC="univer-checkbox-group";var Kn={checkboxWrapper:Kv,checkBox:Zv,checkboxInput:qv,checkboxInner:Jv,checkBoxChecked:Qv,checkBoxDisabled:eC,checkboxGroup:tC};class hg extends Xe{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${Kn.checkBox}`:Kn.checkBox,check:!0},this.handleStyle=(e,t)=>{let n=sn(Kn.checkBox,{[`${Kn.checkBox}-checked`]:e,[`${Kn.checkBox}-disabled`]:t});this.setState(s=>({classes:n,check:e}))},this.handleChange=e=>{var n,s;const t=e.target;this.handleStyle(t.checked,this.props.disabled),(s=(n=this.props).onChange)==null||s.call(n,e)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(e){this.handleStyle(e.checked,e.disabled)}render(e,t){const{classes:n,check:s}=t,{value:i,name:o,disabled:a,children:l}=e;return b("label",{className:Kn.checkboxWrapper},b("span",{className:n},b("span",{className:Kn.checkboxInner}),b("input",{type:"checkbox",name:o,checked:s,disabled:a,className:Kn.checkboxInput,value:i,onChange:this.handleChange})),l&&b("span",null,l))}}class nC{render(){return hg}}const rC=r=>{let{options:e,onChange:t,disabled:n,name:s}=r,i=Vn(null);n&&e.forEach(a=>{a.disabled=!0}),s&&e.forEach(a=>{a.name=s});const o=()=>{var u;if(!t)return;let a=(u=i.current)==null?void 0:u.querySelectorAll("label input"),l=[];a==null||a.forEach(c=>{let h=c;h.checked&&l.push(h.value)}),t(l)};return b("div",{className:Kn.checkboxGroup,ref:i},e.map(a=>b(hg,{name:a.name,disabled:a.disabled,checked:a.checked,onChange:o,value:a.value},a.label)))};class sC{render(){return rC}}const iC="univer-panel-wrapper",oC="univer-panel-header",aC="univer-panel-header-icon",lC="univer-panel-header-icon-rotate",uC="univer-panel-body",cC="univer-active";var Zn={panelWrapper:iC,panelHeader:oC,panelHeaderIcon:aC,panelHeaderIconRotate:lC,panelBody:uC,active:cC};const hC=r=>{const{header:e,children:t}=r;let[n,s]=Ui(sn(Zn.panelBody));const i=()=>{n.includes("active")?s(sn(Zn.panelBody)):s(sn(Zn.panelBody,Zn.active))};return b("div",{className:Zn.panelWrapper},b("div",{className:Zn.panelHeader,onClick:()=>i()},e,b("span",{className:`${Zn.panelHeaderIcon} ${n.includes("active")?Zn.panelHeaderIconRotate:""}`},b(Ri.NextIcon,null))),b("div",{className:n},t))},dC=r=>{const{children:e}=r;return b("div",{className:Zn.collapseWrapper},e)};class fC{render(){return dC}}class gC{render(){return hC}}function Vs(){return(Vs=Object.assign||function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r}).apply(this,arguments)}function sa(r,e){if(r==null)return{};var t,n,s={},i=Object.keys(r);for(n=0;n<i.length;n++)e.indexOf(t=i[n])>=0||(s[t]=r[t]);return s}function Di(r){var e=Vn(r),t=Vn(function(n){e.current&&e.current(n)});return e.current=r,t.current}var Bs=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),r>t?t:r<e?e:r},pi=function(r){return"touches"in r},gl=function(r){return r&&r.ownerDocument.defaultView||self},lh=function(r,e,t){var n=r.getBoundingClientRect(),s=pi(e)?function(i,o){for(var a=0;a<i.length;a++)if(i[a].identifier===o)return i[a];return i[0]}(e.touches,t):e;return{left:Bs((s.pageX-(n.left+gl(r).pageXOffset))/n.width),top:Bs((s.pageY-(n.top+gl(r).pageYOffset))/n.height)}},uh=function(r){!pi(r)&&r.preventDefault()},uu=vt.memo(function(r){var e=r.onMove,t=r.onKey,n=sa(r,["onMove","onKey"]),s=Vn(null),i=Di(e),o=Di(t),a=Vn(null),l=Vn(!1),u=ra(function(){var d=function(p){uh(p),(pi(p)?p.touches.length>0:p.buttons>0)&&s.current?i(lh(s.current,p,a.current)):g(!1)},m=function(){return g(!1)};function g(p){var _=l.current,v=gl(s.current),w=p?v.addEventListener:v.removeEventListener;w(_?"touchmove":"mousemove",d),w(_?"touchend":"mouseup",m)}return[function(p){var _=p.nativeEvent,v=s.current;if(v&&(uh(_),!function(y,A){return A&&!pi(y)}(_,l.current)&&v)){if(pi(_)){l.current=!0;var w=_.changedTouches||[];w.length&&(a.current=w[0].identifier)}v.focus(),i(lh(v,_,a.current)),g(!0)}},function(p){var _=p.which||p.keyCode;_<37||_>40||(p.preventDefault(),o({left:_===39?.05:_===37?-.05:0,top:_===40?.05:_===38?-.05:0}))},g]},[o,i]),c=u[0],h=u[1],f=u[2];return Zr(function(){return f},[f]),vt.createElement("div",Vs({},n,{onTouchStart:c,onMouseDown:c,className:"react-colorful__interactive",ref:s,onKeyDown:h,tabIndex:0,role:"slider"}))}),ia=function(r){return r.filter(Boolean).join(" ")},cu=function(r){var e=r.color,t=r.left,n=r.top,s=n===void 0?.5:n,i=ia(["react-colorful__pointer",r.className]);return vt.createElement("div",{className:i,style:{top:100*s+"%",left:100*t+"%"}},vt.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Kt=function(r,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*r)/t},dg=function(r){var e=r.s,t=r.v,n=r.a,s=(200-e)*t/100;return{h:Kt(r.h),s:Kt(s>0&&s<200?e*t/100/(s<=100?s:200-s)*100:0),l:Kt(s/2),a:Kt(n,2)}},ml=function(r){var e=dg(r);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Ba=function(r){var e=dg(r);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},mC=function(r){var e=r.h,t=r.s,n=r.v,s=r.a;e=e/360*6,t/=100,n/=100;var i=Math.floor(e),o=n*(1-t),a=n*(1-(e-i)*t),l=n*(1-(1-e+i)*t),u=i%6;return{r:Kt(255*[n,a,o,o,l,n][u]),g:Kt(255*[l,n,n,a,o,o][u]),b:Kt(255*[o,o,l,n,n,a][u]),a:Kt(s,2)}},pC=function(r){var e=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(r);return e?_C({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):{h:0,s:0,v:0,a:1}},_C=function(r){var e=r.r,t=r.g,n=r.b,s=r.a,i=Math.max(e,t,n),o=i-Math.min(e,t,n),a=o?i===e?(t-n)/o:i===t?2+(n-e)/o:4+(e-t)/o:0;return{h:Kt(60*(a<0?a+6:a)),s:Kt(i?o/i*100:0),v:Kt(i/255*100),a:s}},bC=vt.memo(function(r){var e=r.hue,t=r.onChange,n=ia(["react-colorful__hue",r.className]);return vt.createElement("div",{className:n},vt.createElement(uu,{onMove:function(s){t({h:360*s.left})},onKey:function(s){t({h:Bs(e+360*s.left,0,360)})},"aria-label":"Hue","aria-valuenow":Kt(e),"aria-valuemax":"360","aria-valuemin":"0"},vt.createElement(cu,{className:"react-colorful__hue-pointer",left:e/360,color:ml({h:e,s:100,v:100,a:1})})))}),vC=vt.memo(function(r){var e=r.hsva,t=r.onChange,n={backgroundColor:ml({h:e.h,s:100,v:100,a:1})};return vt.createElement("div",{className:"react-colorful__saturation",style:n},vt.createElement(uu,{onMove:function(s){t({s:100*s.left,v:100-100*s.top})},onKey:function(s){t({s:Bs(e.s+100*s.left,0,100),v:Bs(e.v-100*s.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Kt(e.s)+"%, Brightness "+Kt(e.v)+"%"},vt.createElement(cu,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:ml(e)})))}),CC=function(r,e){if(r===e)return!0;for(var t in r)if(r[t]!==e[t])return!1;return!0},EC=function(r,e){return r.replace(/\s/g,"")===e.replace(/\s/g,"")};function wC(r,e,t){var n=Di(t),s=Ui(function(){return r.toHsva(e)}),i=s[0],o=s[1],a=Vn({color:e,hsva:i});Zr(function(){if(!r.equal(e,a.current.color)){var u=r.toHsva(e);a.current={hsva:u,color:e},o(u)}},[e,r]),Zr(function(){var u;CC(i,a.current.hsva)||r.equal(u=r.fromHsva(i),a.current.color)||(a.current={hsva:i,color:u},n(u))},[i,r,n]);var l=Ms(function(u){o(function(c){return Object.assign({},c,u)})},[]);return[i,l]}var TC=typeof window!="undefined"?zi:Zr,yC=function(){return typeof __webpack_nonce__!="undefined"?__webpack_nonce__:void 0},ch=new Map,SC=function(r){TC(function(){var e=r.current?r.current.ownerDocument:document;if(e!==void 0&&!ch.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,ch.set(e,t);var n=yC();n&&t.setAttribute("nonce",n),e.head.appendChild(t)}},[])},AC=function(r){var e=r.className,t=r.hsva,n=r.onChange,s={backgroundImage:"linear-gradient(90deg, "+Ba(Object.assign({},t,{a:0}))+", "+Ba(Object.assign({},t,{a:1}))+")"},i=ia(["react-colorful__alpha",e]),o=Kt(100*t.a);return vt.createElement("div",{className:i},vt.createElement("div",{className:"react-colorful__alpha-gradient",style:s}),vt.createElement(uu,{onMove:function(a){n({a:a.left})},onKey:function(a){n({a:Bs(t.a+a.left)})},"aria-label":"Alpha","aria-valuetext":o+"%","aria-valuenow":o,"aria-valuemin":"0","aria-valuemax":"100"},vt.createElement(cu,{className:"react-colorful__alpha-pointer",left:t.a,color:Ba(t)})))},RC=function(r){var e=r.className,t=r.colorModel,n=r.color,s=n===void 0?t.defaultColor:n,i=r.onChange,o=sa(r,["className","colorModel","color","onChange"]),a=Vn(null);SC(a);var l=wC(t,s,i),u=l[0],c=l[1],h=ia(["react-colorful",e]);return vt.createElement("div",Vs({},o,{ref:a,className:h}),vt.createElement(vC,{hsva:u,onChange:c}),vt.createElement(bC,{hue:u.h,onChange:c}),vt.createElement(AC,{hsva:u,onChange:c,className:"react-colorful__last-control"}))},DC={defaultColor:"rgba(0, 0, 0, 1)",toHsva:pC,fromHsva:function(r){var e=mC(r);return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},equal:EC},xC=function(r){return vt.createElement(RC,Vs({},r,{colorModel:DC}))},IC=/^#?([0-9A-F]{3,8})$/i,OC=function(r){var e=r.color,t=e===void 0?"":e,n=r.onChange,s=r.onBlur,i=r.escape,o=r.validate,a=r.format,l=r.process,u=sa(r,["color","onChange","onBlur","escape","validate","format","process"]),c=Ui(function(){return i(t)}),h=c[0],f=c[1],d=Di(n),m=Di(s),g=Ms(function(_){var v=i(_.target.value);f(v),o(v)&&d(l?l(v):v)},[i,l,o,d]),p=Ms(function(_){o(_.target.value)||f(i(t)),m(_)},[t,i,o,m]);return Zr(function(){f(i(t))},[t,i]),vt.createElement("input",Vs({},u,{value:a?a(h):h,spellCheck:"false",onChange:g,onBlur:p}))},hh=function(r){return"#"+r},kC=function(r){var e=r.prefixed,t=r.alpha,n=sa(r,["prefixed","alpha"]),s=Ms(function(o){return o.replace(/([^0-9A-F]+)/gi,"").substring(0,t?8:6)},[t]),i=Ms(function(o){return function(a,l){var u=IC.exec(a),c=u?u[1].length:0;return c===3||c===6||!!l&&c===4||!!l&&c===8}(o,t)},[t]);return vt.createElement(OC,Vs({},n,{escape:s,format:e?hh:void 0,process:hh,validate:i}))};const NC="univer-input",MC="univer-input-focused",FC="univer-input-disabled",BC="univer-input-borderless",LC="univer-input-borderless-focused";var La={input:NC,inputFocused:MC,inputDisabled:FC,inputBorderless:BC,inputBorderlessFocused:LC};class xi extends Xe{constructor(){super(...arguments),this.ref=Ve(),this.setValue=(e,t)=>{this.setState(n=>({value:e}),t)},this.handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const n=e.target;this.setValue(n.value),t(e)},this.handleKeyUp=e=>{const{onKeyUp:t}=this.props;t==null||t(e)},this.onFocus=e=>{const{onFocus:t}=this.props;t==null||t(e)},this.onClick=e=>{const{onClick:t}=this.props;t==null||t(e)},this.onBlur=e=>{const{onBlur:t}=this.props;t==null||t(e)},this.getValue=()=>this.ref.current.value}initialize(e){this.state={value:e.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(e){e.value&&e.value!==this.state.value&&this.setValue(e.value)}render(e,t){const{id:n,disabled:s,type:i,placeholder:o,bordered:a=!0,className:l="",readonly:u}=e,{value:c}=t,h=sn(La.input,{[`${La.input}-disable`]:s,[`${La.input}-borderless`]:!a},l);return b("input",{type:i,onBlur:this.onBlur,onFocus:this.onFocus,className:h,placeholder:o,disabled:s,ref:this.ref,onChange:this.handleChange,value:c,onClick:this.onClick,readonly:u,id:n,onKeyUp:this.handleKeyUp})}}class PC{render(){return xi}}const HC=r=>{let{color:e}=r;if(!e)return null;let t;if(e.indexOf("#")>-1){if(e=sr.hexToRgbString(e),!e)return null;t=e.replace("rgba(","").replace(")","").split(",")}else e.indexOf("rgba")>-1?t=e.replace("rgba(","").replace(")","").split(","):(t=e.replace("rgb(","").replace(")","").split(","),t.push("1"));let n=Vn(null);const s=()=>{r.onChange(n.current.base.value)};return b(xi,{ref:n,type:"text",value:`rgba(${t})`,onChange:s})},UC="univer-color-picker-panel",zC="univer-color-picker-panel-setting",WC="univer-panel-input",VC="univer-panel-color";var js={colorPickerPanel:UC,colorPickerPanelSetting:zC,panelInput:WC,panelColor:VC};class GC extends Xe{initialize(e){this.state={color:e.color||"#000"}}setColor(e){this.setState({color:e}),this.props.onChange(e)}render(){return b("div",{className:js.colorPickerPanel,onClick:e=>e.stopPropagation()},b(xC,{className:js.colorPicker,color:this.state.color,onChange:Xr(this.setColor.bind(this),500)}),b("div",{className:js.colorPickerPanelSetting},b("div",{className:js.panelInput},this.props.rgb?b(HC,{color:this.state.color,onChange:Xr(this.setColor.bind(this),500)}):b(kC,{color:this.state.color,onChange:Xr(this.setColor.bind(this),500)})),b("div",{className:js.panelColor},b("div",{style:{background:this.state.color}}),b("div",{style:{background:this.props.color}}))))}}const XC="univer-color-picker-outer",$C="univer-color-picker",YC="univer-picker",jC="univer-picker-swatches",KC="univer-picker-swatches-item",ZC="univer-picker-swatch",qC="univer-picker-swatch-btn",JC="univer-colorful-warp",QC="univer-color-btn",e5="univer-color-picker-slot";var cr={colorPickerOuter:XC,colorPicker:$C,picker:YC,pickerSwatches:jC,pickerSwatchesItem:KC,pickerSwatch:ZC,pickerSwatchBtn:qC,colorfulWarp:JC,colorBtn:QC,colorPickerSlot:e5};let t5=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class _r extends Xe{constructor(){super(...arguments),this.ulRef=Ve(),this.onChange=e=>{this.props.onChange&&this.props.onChange(e),this.setState({afterColor:e})},this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=e=>{e&&this.ulRef.current.contains(e.target)||(this.setState(t=>({styles:{display:"none"}})),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=e=>{this.setState(t=>({styles:{display:"block"}})),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(e,t)=>{const n=e.getBoundingClientRect(),s=this.ulRef.current.getBoundingClientRect(),i=document.documentElement.clientWidth||document.body.clientWidth,o=document.documentElement.clientHeight||document.body.clientHeight;let a=0,l=0;return l=n.top+s.height>o?n.top-s.height:n.top+n.height,a=n.left+s.width>i?i-s.width:n.left,{left:a,top:l}},this.onSwitch=e=>{e.stopImmediatePropagation(),new Promise((t,n)=>{this.setState({setting:!this.state.setting}),t("end")}).then(()=>{if(this.state.root){const{top:t,left:n}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${n}px`,this.ulRef.current.style.top=`${t}px`}})}}initialize(e){this.state={presetColors:t5,defaultColor:e.color||"#000",afterColor:e.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}render(){var t;const e=Object.assign(this.state.styles||{},this.props.style);return this.props.lang=(t=this.props.lang)!=null?t:{collapse:"",customColor:"",confirmColor:"",cancelColor:"",change:""},b("div",{className:`${cr.colorPickerOuter} ${this.props.className}`,ref:this.ulRef,style:{...e}},b("div",{className:cr.colorPicker,onClick:n=>{}},b("div",{className:cr.picker},b("div",{className:cr.pickerSwatches},this.state.presetColors.map(n=>b("div",{className:cr.pickerSwatchesItem},n.map(s=>b("span",{className:cr.pickerSwatch,style:{background:s}},b(br,{title:s,placement:"top"},b("button",{key:s,className:cr.pickerSwatchBtn,style:{background:s},onClick:i=>{this.props.onClick&&this.props.onClick(s,i)}}))))))),b("div",null,b(In,{onClick:this.onSwitch},this.state.setting?this.props.lang.collapse:this.props.lang.customColor))),this.state.setting?b("div",{className:cr.colorfulWarp},b(GC,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),b("div",null,b(In,{type:"primary",onClick:n=>{var s;(s=this.onClick)==null||s.call(this,this.state.afterColor,n)}},this.props.lang.confirmColor),b(In,{danger:!0,onClick:n=>{this.onCancel()}},this.props.lang.cancelColor),b(In,{onClick:n=>{n.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.props.lang.change))):null))}}class n5{render(){return _r}}const r5="univer-color-picker-circle-button",s5="univer-color-select-circle",i5="univer-vertical-middle";var Qi={colorPickerCircleButton:r5,colorSelectCircle:s5,verticalMiddle:i5};class o5 extends Xe{constructor(){super(...arguments),this.ref=Ve(),this.colorRef=Ve(),this.handleColorSelectButtonClick=e=>{e.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(e){const{color:t,onClick:n,onCancel:s,style:i,colorPickerStyle:o}=e,a=this.getComponentRender().renderFunction("NextIcon");return b("div",{style:i,className:Qi.colorPickerCircleButton,ref:this.ref,onClick:this.handleColorSelectButtonClick},b("span",{className:`${Qi.colorSelectCircle} ${Qi.verticalMiddle}`,style:{backgroundColor:t}}),b(a,{className:Qi.verticalMiddle}),b(_r,{color:t,onClick:n,onCancel:s,style:o,ref:this.colorRef}))}}class a5{render(){return o5}}const So=su((r,e)=>{const{children:t,style:n,className:s,onClick:i}=r;return b("div",{ref:e,style:n,className:s,onClick:i},t)});class l5{render(){return So}}const u5="univer-format-modal",c5="univer-cols-menu",h5="univer-cols-menuitem",d5="univer-cols-menuitem-content";var f5={formatModal:u5,colsMenu:c5,colsMenuitem:h5,colsMenuitemContent:d5};class g5 extends Xe{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.showModal=(e,t)=>{let n=this.state.data,s=n.findIndex(i=>i.name===e);s>-1&&(n[s].show=t,this.setValue({data:n},()=>({data:n})))}}initialize(e){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const e=this.context.locale;let t=this.state.data;t.forEach(n=>{var s;n.title=e.get(n.name),n.name==="format.titleCurrency"?n.children=e.get("currencyDetail").map(i=>({label:i.name,icon:i.value})):n.name==="format.titleDateTime"?n.children=e.get("dateFmtList").map(i=>({label:i.name,icon:i.value})):n.name==="format.titleNumber"&&(n.children=e.get("numFmtList").map(i=>({label:i.name,icon:i.value}))),(s=n.group)!=null&&s.length&&n.group.forEach(i=>{i.label=e.get(i.locale)})}),this.setState(n=>({data:t}))}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}render(e,t){const{data:n}=t;return b(yt,null,n.map((s,i)=>s.show?b(du,{title:s.title,className:f5.formatModal,group:s.group,visible:s.show,onCancel:s.onCancel},s.label,b(Yr,{show:!0,children:s.children,ref:o=>this.refs[i]=o})):b(yt,null)))}}class m5{render(){return g5}}const p5="univer-select-item",_5="univer-select-item-selected",b5="univer-select-item-content",v5="univer-select-item-suffix",C5="univer-select-disabled-item";var Ks={selectItem:p5,selectItemSelected:_5,selectItemContent:b5,selectItemSuffix:v5,selectDisabledItem:C5};class E5 extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const e=this._render.renderFunction("CorrectIcon"),{selected:t,label:n,suffix:s,disabled:i}=this.props;return b("div",{className:sn(Ks.selectItem,i?Ks.selectDisabledItem:"")},t?b("span",{className:Ks.selectItemSelected},b(e,null)):"",b("span",{className:Ks.selectItemContent},n),s?b("span",{className:Ks.selectItemSuffix},s):"")}}const w5="univer-select-component",T5="univer-select-button",y5="univer-select-single",S5="univer-select-input",A5="univer-select-color",R5="univer-cols-menu",D5="univer-cols-menuitem",x5="univer-select-item",I5="univer-select-double",O5="univer-dropdown",k5="univer-drop-content",N5="univer-select-line",M5="univer-drop-icon",F5="univer-select-label";var Yn={selectComponent:w5,selectButton:T5,selectSingle:y5,selectInput:S5,selectColor:A5,colsMenu:R5,colsMenuitem:D5,selectItem:x5,selectDouble:I5,dropdown:O5,dropContent:k5,selectLine:N5,dropIcon:M5,selectLabel:F5},fg=(r=>(r[r.SINGLE=0]="SINGLE",r[r.INPUT=1]="INPUT",r[r.COLOR=2]="COLOR",r[r.DOUBLE=3]="DOUBLE",r[r.FIX=4]="FIX",r[r.DOUBLEFIX=5]="DOUBLEFIX",r))(fg||{});class hu extends Xe{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:n}=this.props;return t.length&&(t.forEach(i=>{i.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,n)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,i=this._render.renderFunction("Button");return b("div",{className:`${Yn.selectSingle} ${n}`},b(i,{type:"text"},b(ps,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},b("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,i=this._render.renderFunction("Input"),o=this._render.renderFunction("Button");return b("div",{className:`${Yn.selectInput} ${n}`},b(o,{type:"text"},b(ps,{tooltip:s,menu:{menu:t,onClick:this.onClick},showArrow:!0},b(i,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{className:n="",tooltip:s}=this.props,i=this._render.renderFunction("NextIcon"),o=this._render.renderFunction("Button");return b("div",{className:`${Yn.selectDouble} ${n}`},b(o,{type:"text"},b(ps,{tooltip:s,menu:{menu:t,onClick:this.onClick},icon:b(i,null)},b("div",{className:Yn.selectLabel},e))))},this.getFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:s}=this.state,i=this._render.renderFunction("Button");return b("div",{className:`${Yn.selectDouble} ${t}`},b(i,{type:"text"},b(ps,{tooltip:n,menu:{menu:s,onClick:this.onClick},showArrow:!0},b("div",{className:Yn.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,className:t="",tooltip:n}=this.props,{menu:s}=this.state,i=this._render.renderFunction("Button"),o=this._render.renderFunction("NextIcon");return b("div",{className:`${Yn.selectDouble} ${t}`},b(i,{type:"text"},b(ps,{tooltip:n,onClick:this.onClick,menu:{menu:s,onClick:this.onClick},icon:b(o,null)},b("div",{className:Yn.selectLabel},e))))}}initialize(){var i;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const{children:t=[],hideSelectedIcon:n}=this.props,s=this.resetMenu(t,n);this.state={menu:s,color:(i=this.props.defaultColor)!=null?i:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:e,display:t,children:n=[],label:s}=this.props;if(e===0||e===3){if(!n.length)return;let i=n.findIndex(l=>l.selected);i<0&&(i=0);const o=this.handleSelected(i),a=n[i];t===1?this.setState({content:a.suffix,menu:o}):this.setState({content:a.label,menu:o}),this.onClick=(...l)=>{var h,f;const u=n[l[2]];if((f=(h=this.props).onClick)==null||f.call(h,l[1],l[2],l[3]),u.unSelectable)return;const c=this.handleSelected(l[2]);t===1?this.setState({content:n[l[2]].suffix,menu:c}):this.setState({content:n[l[2]].label,menu:c})}}else if(e===1){if(!n.length)return;const i=o=>{if(o!==null){if(o==="")return;let a=n.findIndex(u=>o===u.label),l=this.handleSelected(a<0?null:a);this.setState({content:o,menu:l})}else{let a=n.findIndex(c=>c.selected);a<0&&(a=0);let l=this.handleSelected(a);const u=n[a];this.setState({content:u.label,menu:l})}};i(s),this.onClick=(...o)=>{var l,u;(u=(l=this.props).onClick)==null||u.call(l,o[1],o[2],o[3]);const a=this.handleSelected(o[2]);this.setState({content:n[o[2]].label,menu:a})},this.onKeyUp=o=>{var l,u;const a=o.currentTarget.value;(u=(l=this.props).onKeyUp)==null||u.call(l,a),i(a)}}else if(e===2){const i=this.handleSelected(null);this.setState({menu:i}),this.onClick=()=>{var a,l;const{color:o}=this.state;(l=(a=this.props).onClick)==null||l.call(a,o)}}else if(e===4||e===5){if(!n.length)return;let i=n.findIndex(l=>l.selected);i<0&&(i=0);const o=n[i],a=this.handleSelected(i);this.setState({menu:a,value:o.value}),this.onClick=(...l)=>{var u,c,h,f;if(l.length){(c=(u=this.props).onClick)==null||c.call(u,l[1],l[2],l[3]);const d=this.handleSelected(l[2]);this.setState({menu:d,value:n[l[2]].value})}else(f=(h=this.props).onClick)==null||f.call(h,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(e){this.props=Object.assign(this.props,e),this.initData()}resetMenu(e,t){var s;const n=[];for(let i=0;i<e.length;i++){let o=!1;t||(o=(s=e[i].selected)!=null?s:!1),n[i]={label:""},n[i].label=b(E5,{disabled:e[i].disabled,border:e[i].border,selected:o,label:e[i].label,suffix:e[i].suffix}),n[i].disabled=e[i].disabled,n[i].style=e[i].style,n[i].value=e[i].value,n[i].className=e[i].className,n[i].onClick=e[i].onClick,n[i].border=e[i].border,e[i].children&&(n[i].children=this.resetMenu(e[i].children))}return n}render(){const{type:e=0}=this.props;return b("div",{className:Yn.selectComponent},this.getType(e))}}const B5="univer-formula-box",L5="univer-select-button",P5="univer-tooltip-Group",H5="univer-tooltip-body",U5="univer-formula-bar",z5="univer-formula-icon",W5="univer-formula-grey",V5="univer-formula-black",G5="univer-formula-input",X5="univer-formula-content";var Lr={formulaBox:B5,selectButton:L5,tooltipGroup:P5,tooltipBody:H5,formulaBar:U5,formulaIcon:z5,formulaGrey:W5,formulaBlack:V5,formulaInput:G5,formulaContent:X5};class $5 extends Xe{constructor(){super(...arguments),this.onkeyUp=e=>{},this.printChange=e=>{this.onkeyUp(e.target)}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this._render.renderFunction("NextIcon"),this.state={namedRanges:[{value:"1",label:"1"}],spanClass:Lr.formulaGrey,formulaContent:""},this.onkeyUp=Xr(this.onkeyUp,300)}setFormulaContent(e){this.setState({formulaContent:e})}setNamedRanges(e){this.setState({namedRanges:e})}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onFormulaBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{namedRanges:n}=t,s=this._render.renderFunction("CloseIcon"),i=this._render.renderFunction("CorrectIcon"),o=this._render.renderFunction("FxIcon");return b("div",{className:Lr.formulaBox},b(hu,{children:n,type:0}),b("div",{className:Lr.formulaBar},b("div",{className:Lr.formulaIcon},b("span",{className:t.spanClass},b(s,null)),b("span",{className:t.spanClass},b(i,null)),b("span",{className:Lr.formulaBlack},b(o,null))),b("div",{className:Lr.formulaInput},b("div",{autoFocus:!0,contentEditable:!0,className:Lr.formulaContent,onKeyUp:a=>this.printChange(a)},t.formulaContent))))}}const Y5="univer-layout-wrapper",j5="univer-layout-wrapper-has-sider",K5="univer-header-wrapper",Z5="univer-footer-wrapper",q5="univer-content-wrapper",J5="univer-sider-wrapper";var $r={layoutWrapper:Y5,layoutWrapperHasSider:j5,headerWrapper:K5,footerWrapper:Z5,contentWrapper:q5,siderWrapper:J5};class Ao extends Xe{constructor(){super(...arguments),this.ref=Ve(),this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let e=g_(this.ref.current);const t=e instanceof Array?e:[e];for(const n of t)n.tagName==="ASIDE"&&this.setState({isAside:!0})}}render(e,t){const{children:n,style:s,className:i=""}=e,{isAside:o}=t;return b("section",{style:s,ref:this.ref,className:o?`${$r.layoutWrapper} ${$r.layoutWrapperHasSider} ${i}`:`${$r.layoutWrapper} ${i}`},n)}}const gg=r=>{const{children:e,style:t,className:n=""}=r;return b("header",{style:t,className:`${$r.headerWrapper} ${n}`},e)},mg=r=>{const{children:e,style:t,className:n=""}=r;return b("footer",{style:t,className:`${$r.footerWrapper} ${n}`},e)},pg=su((r,e)=>{const{children:t,style:n,className:s=""}=r;return b("main",{ref:e,style:n,className:`${$r.contentWrapper} ${s}`},t)}),ii=r=>{const{children:e,style:t,className:n=""}=r;return b("aside",{style:t,className:`${$r.siderWrapper} ${n}`},e)};class Q5{render(){return Ao}}class e4{render(){return gg}}class t4{render(){return mg}}class n4{render(){return pg}}class r4{render(){return ii}}const s4="univer-cols-menu",i4="univer-cols-menuitem",o4="univer-cols-menuitem-line",a4="univer-cols-menuitem-disabled";var eo={colsMenu:s4,colsMenuitem:i4,colsMenuitemLine:o4,colsMenuitemDisabled:a4};class oa extends Xe{constructor(){super(...arguments),this._MenuRef=Ve(),this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(e,t,n)=>{var i,o;const{deep:s=0}=this.props;(i=t.onClick)==null||i.call(null,e,t.value,n,s),(o=this.props.onClick)==null||o.call(null,e,t.value,n,s),this.showMenu(!1)},this.showMenu=e=>{this.setState(t=>({show:e}),()=>{this.getStyle()})},this.mouseEnter=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!0)},this.mouseLeave=(e,t)=>{const{menu:n=[]}=this.props;n[t].children&&this._refs[t].showMenu(!1)},this.getStyle=()=>{var a;const e=this._MenuRef.current;if(!e)return;let t={};const n=e.getBoundingClientRect();let s;const{dom:i,parent:o}=this.props;if(s={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},o){e.style.position="fixed";let l=(a=e.parentElement)==null?void 0:a.getBoundingClientRect();if(!l)return;l.right+n.width>s.right?(t.left=`${l.left-n.width}px`,t.top=`${l.top}px`):(t.left=`${l.right}px`,t.top=`${l.top}px`),this.setState({posStyle:t})}}}initialize(){this.state={show:!1,posStyle:{}}}render(){const{className:e="",style:t="",menu:n,deep:s=0}=this.props,{show:i,posStyle:o}=this.state;return b("ul",{className:sn(eo.colsMenu,e),style:{...t,...o,display:i?"block":"none"},ref:this._MenuRef},n==null?void 0:n.map((a,l)=>{var u,c;if(!a.hide)return b(yt,null,b("li",{className:sn(eo.colsMenuitem,(u=a.className)!=null?u:"",a.disabled?eo.colsMenuitemDisabled:""),style:(c=a.style)!=null?c:"",onClick:h=>this.handleClick(h,a,l),onMouseEnter:h=>{this.mouseEnter(h,l)},onMouseLeave:h=>{this.mouseLeave(h,l)}},a.label,a.children?b(oa,{ref:h=>this._refs[l]=h,menu:a.children,onClick:a.onClick,className:a.className,style:a.style,parent:this,deep:s+1}):b(yt,null)),a.border?b("div",{className:eo.colsMenuitemLine}):"")}))}}class l4{render(){return oa}}const u4="univer-drag",c4="univer-drag-top",h4="univer-drag-bottom",d4="univer-drag-left",f4="univer-drag-right";var g4={drag:u4,dragTop:c4,dragBottom:h4,dragLeft:d4,dragRight:f4};class m4 extends Xe{constructor(){super(...arguments),this.root=Ve(),this.onMouseMove=e=>{let t=this.state.offsetX,n=this.state.offsetY,s=e.x,i=e.y,o=`${s-t}px`,a=`${i-n}px`;this.setState({top:a,left:o})}}initialize(){this.state={left:"",top:"",width:0,height:0,rootW:0,rootH:0,rootL:0,rootT:0,offsetX:0,offsetY:0}}onMouseUp(e){window.removeEventListener("mousemove",this.onMouseMove)}onMouseDown(e){window.addEventListener("mousemove",this.onMouseMove);let t=e.offsetX,n=e.offsetY;this.setState({offsetX:t,offsetY:n})}getWindowRect(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,n=this.root.current.offsetWidth,s=this.root.current.offsetHeight,i=this.root.current.offsetLeft,o=this.root.current.offsetTop,a=`${(t-s)/2}px`,l=`${(e-n)/2}px`;this.setState({width:e,height:t,rootW:n,rootH:s,rootL:i,rootT:o,top:a,left:l})}componentDidMount(){this.props.isDrag&&this.getWindowRect()}render(){const{isDrag:e}=this.props;return b(yt,null,e?b("div",{ref:this.root,className:g4.drag,style:{top:this.state.top,left:this.state.left},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this)},this.props.children):this.props.children)}}const p4="univer-modal-mask",_4="univer-modal-wrapper",b4="univer-modal-darg-wrapper",v4="univer-modal-header",C4="univer-modal-close",E4="univer-modal-body",w4="univer-modal-footer";var Pr={modalMask:p4,modalWrapper:_4,modalDargWrapper:b4,modalHeader:v4,modalClose:C4,modalBody:E4,modalFooter:w4};class du extends Xe{constructor(){super(...arguments),this.handleClickCancel=e=>{e&&e()},this.showModal=e=>{this.setState(t=>({visible:e}))},this.handleClick=e=>{this.showModal(!1),e&&e()}}initialize(){var e;this.state={visible:(e=this.props.visible)!=null?e:!1}}componentWillReceiveProps(e){e.visible!==this.state.visible&&this.setState({visible:e.visible})}render(){const{title:e,width:t=500,top:n=0,style:s,children:i,className:o="",group:a=[],isDrag:l=!1,mask:u=!0,footer:c=!0}=this.props,{visible:h}=this.state;return b(yt,null,h?b("div",{className:o},u?b("div",{className:Pr.modalMask,onClick:f=>{var d,m;(m=(d=this.props).onCancel)==null||m.call(d,f),this.showModal(!1)}}):null,b(m4,{isDrag:l},b("div",{className:`${l?Pr.modalDargWrapper:Pr.modalWrapper}`,style:{width:`${t}px`,...s}},b("div",{className:Pr.modalHeader},b("span",null,e),b("span",{className:Pr.modalClose,onClick:f=>{var d,m;(m=(d=this.props).onCancel)==null||m.call(d,f),this.showModal(!1)}},b(cg.Close,null))),b("div",{className:Pr.modalBody},i),c?b("div",{className:Pr.modalFooter},a.map(f=>b(In,{type:f.type,onClick:()=>this.handleClick(f.onClick)},f.label))):null))):null)}}class T4{render(){return du}}const y4="univer-radio-group",S4="univer-radio-wrap",A4="univer-radio-left",R4="univer-circle",D4="univer-active",x4="univer-fork",I4="univer-label";var ls={radioGroup:y4,radioWrap:S4,radioLeft:A4,circle:R4,active:D4,fork:x4,label:I4};class _g extends Xe{render(){return b("div",{className:ls.radioWrap},b("div",{className:ls.radioLeft},b("div",{onClick:this.props.onClick.bind(this,this.props.value)},b("div",{className:`${ls.circle} ${this.props.active&&ls.active}`},b("div",{className:ls.fork})),b("div",{className:ls.label},this.props.label)),this.props.children))}}class O4{render(){return _g}}class k4{render(){return _g}}const N4="univer-rich-text-editor-container",M4="univer-rich-text-editor",F4="univer-formula-text-color",B4="univer-formula-text-string";var _i={richTextEditorContainer:N4,richTextEditor:M4,formulaTextColor:F4,formulaTextString:B4};class L4{constructor(e){this.inlineStyleAffectAttribute={bl:1,it:1,ff:1,cl:1,un:1,fs:1,fc:1,bg:1},this.inlineStyleAffectCssName={"font-weight":1,"font-style":1,"font-family":1,"text-decoration":1,"border-bottom":1,"font-size":1,color:1,background:1},this.univerToCssName={bl:"font-weight",it:"font-style",ff:"font-family",fs:"font-size",fc:"color",bg:"background",cl:"text-decoration",un:"border-bottom"},this.editor=e}updateFormat(e,t){e in this.inlineStyleAffectAttribute&&this.editor.textContent.substr(0,1)!=="="&&this.updateInlineStringFormat(e,t)}updateInlineStringFormat(e,t){var c;let n=window.getSelection(),s;if((n==null?void 0:n.type)==="None"||(s=n==null?void 0:n.getRangeAt(0)),!s)return;let i=this.editor,o=s.endContainer,a=s.startContainer,l=s.endOffset,u=s.startOffset;if(i){if(a===o){let h=a.parentNode,f,d=!1,m=h.innerHTML;i.innerHTML.substr(0,5)!=="<span"&&(d=!0);let p="",_="",v="",w=0,y=u,A=l,I=m.length;p=m.substring(w,y),_=m.substring(y,A),v=m.substring(A,I);let R="";if(p!==""){let S=h.style.cssText;if(d){let k=h.closest(`.${_i.richTextEditorContainer}`);k!=null&&(S=this.extendCssText(k.style.cssText,S))}R+=`<span style='${S}'>${p}</span>`}if(_!==""){let S=this.getCssText(h.style.cssText,e,t);if(d){let k=h.closest(`.${_i.richTextEditorContainer}`);k!=null&&(S=this.extendCssText(k.style.cssText,S))}R+=`<span style='${S}'>${_}</span>`}if(v!==""){let S=h.style.cssText;if(d){let k=h.closest(`.${_i.richTextEditorContainer}`);k!=null&&(S=this.extendCssText(k.style.cssText,S))}R+=`<span style='${S}'>${v}</span>`}if(a.parentNode.tagName==="SPAN"){f=Rr("span",i).indexOf(h);let S=(c=h.parentElement)==null?void 0:c.innerHTML,k=h.outerHTML.replace("\\","");const N=S==null?void 0:S.replace(k,R);h.parentElement.innerHTML=N}else f=0,h.innerHTML=R;let x=0;w===y?x=f:x=f+1,p_(i.querySelectorAll("span")[x])}else if(a.parentNode.tagName==="SPAN"&&o.parentNode.tagName==="SPAN"){let h=a.parentNode,f,d=o.parentNode,m;f=Rr("span",i).indexOf(h),m=Rr("span",i).indexOf(d);let g=h.innerHTML,p=d.innerHTML,_="",v="",w="",y="",A=0,I=u,R=l,x=p.length;_=g.substring(A,I),v=g.substring(I,g.length),w=p.substring(0,R),y=p.substring(R,x);let S=Array.prototype.slice.call(i.querySelectorAll("span"));S.slice(f,m+1);let k="";for(let D=0;D<f;D++){let E=S[`${D}`],F=E.innerHTML;k+=`<span style='${E.style.cssText}'>${F}</span>`}if(_!==""&&(k+=`<span style='${h.style.cssText}'>${_}</span>`),v!==""&&(k+=`<span style='${this.getCssText(h.style.cssText,e,t)}'>${v}</span>`),f<m)for(let D=f+1;D<m;D++){let E=S[`${D}`],F=E.innerHTML;k+=`<span style='${this.getCssText(E.style.cssText,e,t)}'>${F}</span>`}w!==""&&(k+=`<span style='${this.getCssText(d.style.cssText,e,t)}'>${w}</span>`),y!==""&&(k+=`<span style='${d.style.cssText}'>${y}</span>`);for(let D=m+1;D<S.length;D++){let E=S[`${D}`],F=E.innerHTML;k+=`<span style='${E.style.cssText}'>${F}</span>`}i.innerHTML=k;let N,O;A===I?(N=f,O=m):(N=f+1,O=m+1),S=i.querySelectorAll("span"),__(S[`${N}`],S[`${O}`])}}}extendCssText(e,t,n=!0){let s=e.split(";"),i=t.split(";"),o="",a={};for(let l=0;l<s.length;l++){let u=s[l],c=!0;u=u.toLowerCase();let h=Ut(u.substr(0,u.indexOf(":")));if(h==="font-size")continue;let f=Ut(u.substr(u.indexOf(":")+1));if(!(n&&!(h in this.inlineStyleAffectCssName))){for(let d=0;d<i.length;d++){let m=i[d];m=m.toLowerCase();let g=Ut(m.substr(0,m.indexOf(":"))),p=Ut(m.substr(m.indexOf(":")+1));if(h===g){o+=`${g}:${p};`,c=!1;continue}}c&&(o+=`${h}:${f};`),a[h]=1}}for(let l=0;l<i.length;l++){let u=i[l];u=u.toLowerCase();let c=Ut(u.substr(0,u.indexOf(":"))),h=Ut(u.substr(u.indexOf(":")+1));n&&!(c in this.inlineStyleAffectCssName)||c in a||(o+=`${c}:${h};`)}return o}getCssText(e,t,n){let s={};if(s[t]=n,t==="un"){let l=this.getClassWithcss(e,"color");l===""&&(l="#000000");let u=this.getClassWithcss(e,"font-size"),c=parseInt(u);u===""&&(c=11),s._fontSize=c,s._color=l}let i=this.getFontStyleByCell(s,void 0,void 0,!1),o=Ut(i&&i.substr(0,i.indexOf(":"))),a=Ut(i&&i.substr(i.indexOf(":")+1));return a=a.substr(0,a.length-1),e=this.removeClassWidthCss(e,t),e=this.upsetClassWithCss(e,o,a),e}getClassWithcss(e,t){let n=e.split(";");if(t==null||t.length===0)return e;if(e.indexOf(t)>-1)for(let s=0;s<n.length;s++){let i=n[s];i=i.toLowerCase();let o=Ut(i.substr(0,i.indexOf(":"))),a=Ut(i.substr(i.indexOf(":")+1));if(o===t)return a}return""}removeClassWidthCss(e,t){let n=e.split(";"),s="",i=t;if(t==null||t.length===0)return e;if(t in this.univerToCssName&&(t=this.univerToCssName[t]),e.indexOf(t)>-1)for(let o=0;o<n.length;o++){let a=n[o];a=a.toLowerCase();let l=Ut(a.substr(0,a.indexOf(":"))),u=Ut(a.substr(a.indexOf(":")+1));l===t||i==="cl"&&l==="lucky-strike"||i==="un"&&l==="lucky-underline"||l.length>0&&(s+=`${l}:${u};`)}else s=e;return s}upsetClassWithCss(e,t,n){let s=e.split(";"),i="";if(t==null||t.length===0)return e;if(e.indexOf(t)>-1)for(let o=0;o<s.length;o++){let a=s[o];a=a.toLowerCase();let l=Ut(a.substr(0,a.indexOf(":"))),u=Ut(a.substr(a.indexOf(":")+1));l===t?i+=`${l}:${n};`:l.length>0&&(i+=`${l}:${u};`)}else t.length>0&&(e+=`${t}:${n};`,i=e);return i}getFontStyleByCell(e,t,n,s=!0){if(e==null)return"";let i="";for(let o in e){let a=e[o];if(s&&(a=this.checkstatusByCell(e,o)),o==="bl"&&a!=="0"&&(i+="font-weight: bold;"),o==="it"&&a!=="0"&&(i+="font-style:italic;"),o==="ff"&&(i+=`font-family: ${a};`),o==="fs"&&a!=="10"&&(i+=`font-size: ${a}pt;`),(o==="fc"&&a!=="#000000"||t!=null||n!=null&&n.textColor!=null)&&(n!=null&&n.textColor!=null?i+=`color: ${n.textColor};`:t!=null?i+=`color: ${t[0]};`:i+=`color: ${a};`),o==="bg"&&a!=="#ffffff"&&a!=="#fff"&&(i+=`background: ${a};`),o==="cl"&&a!=="0"&&(i+="text-decoration: line-through;"),o==="un"&&(a==="1"||a==="3")){let l=e._color;l==null&&(l=e.fc);let u=e._fontSize||11;u==null&&(u=e.fs||11),i+=`border-bottom: ${Math.floor(u/9)}px solid ${l};`}}return i}checkstatusByCell(e,t){let n;return t in{bl:1,it:1,ff:1,cl:1,un:1}?n==null?n="0":(n=n[t],n==null&&(n="0")):t==="fc"?n==null?n="#000000":(n=n[t],n==null&&(n="#000000"),n.indexOf("rgba")>-1&&(n=sr.rgbColorToHexValue(n))):t==="bg"?n==null?n=null:(n=n[t],n==null?n=null:n.toString().indexOf("rgba")>-1&&(n=sr.rgbColorToHexValue(n))):t.substr(0,2)==="bs"?n==null?n="none":(n=n[t],n==null&&(n="none")):t.substr(0,2)==="bc"?n==null?n="#000000":(n=n[t],n==null&&(n="#000000")):t==="ht"?(n==null?n="1":(n=n[t],n==null&&(n="1")),["0","1","2"].indexOf(n.toString())===-1&&(n="1")):t==="vt"?(n==null?n="0":(n=n[t],n==null&&(n="0")),["0","1","2"].indexOf(n.toString())===-1&&(n="0")):t==="ct"?n==null?n=null:(n=n[t],n==null&&(n=null)):t==="fs"?n==null?n="10":(n=n[t],n==null&&(n="10")):t==="tb"||t==="tr"?n==null?n="0":(n=n[t],n==null&&(n="0")):t==="rt"&&(n==null?n=null:(n=n[t],n==null&&(n=null))),n}}class to extends Xe{constructor(){super(...arguments),this.container=Ve(),this.ref=Ve(),this.hooks=new Map}initialize(e){}setValue(e){this.ref.current&&(this.ref.current.innerHTML=fl(e))}getValue(){var e;return((e=this.ref.current)==null?void 0:e.innerHTML)||""}show(){this.container.current.style.display="block"}hide(){this.container.current.style.display="none"}onKeyDown(e){const t=this.hooks.get("onKeyDown");t&&t(e),e.key==="Enter"&&e.preventDefault()}onKeyUp(e){const t=this.hooks.get("onKeyUp");t&&t(e),e.key==="Enter"&&e.preventDefault()}componentWillMount(){}componentDidMount(){var e;this.cellTextStyle=new L4(this.ref.current),(e=this._context.getObserverManager().getObserver("onRichTextDidMountObservable"))==null||e.notifyObservers(this)}componentWillUnmount(){}render(e,t){const{style:n,className:s="",onClick:i,text:o}=e;return b("div",{className:`${_i.richTextEditorContainer} ${s}`,style:n,ref:this.container},b("div",{ref:this.ref,className:_i.richTextEditor,onClick:i,onKeyDown:this.onKeyDown.bind(this),onKeyUp:this.onKeyUp.bind(this),dangerouslySetInnerHTML:{__html:o||""},contentEditable:!0}))}}const P4="univer-select-button",H4="univer-select-button-inner",U4="univer-select-color",z4="univer-select-button-inner-label-icon",W4="univer-select-button-inner-label-string",V4="univer-select-input",G4="univer-select-line",X4="univer-btn",$4="univer-color-picker",Y4="univer-select-double-button",j4="univer-double-buttons";var ft={selectButton:P4,selectButtonInner:H4,selectColor:U4,selectButtonInnerLabelIcon:z4,selectButtonInnerLabelString:W4,selectInput:V4,selectLine:G4,btn:X4,colorPicker:$4,selectDoubleButton:Y4,doubleButtons:j4};class K4 extends Fs{constructor(e){super(e),this.ref=Ve(),this.inputRef=Ve(),this.colorBtn=Ve(),this.showSelect=n=>{n.stopImmediatePropagation();const s=this.ref.current;s&&this.props.selectType===Tn.COLOR?s.showSelect(this.colorBtn.current):s&&s.showSelect(),window.addEventListener("click",this.hide,!0)},this.hide=n=>{!this.ref.current||!this.ref.current.ulRef&&!this.ref.current.ulRef.current||this.ref.current.ulRef.current.contains(n.target)||this.hideSelect(n)},this.hideSelect=n=>{this.ref.current.hideSelect(n),window.removeEventListener("click",this.hide,!0)},this.changeValue=n=>{this.setState(s=>({...n}))},this.update=n=>{const s=typeof this.props.label,i=this.state.children;let o;i==null||i.forEach((a,l)=>{a.value===n?(a.selected=!0,this.props.needChange&&(this.setState({label:s==="string"?a.label:a.icon}),o=a.label)):a.selected=!1}),this.setState({children:i}),this.props.selectType===Tn.INPUT_NUMBER&&this.inputRef.current.setValue(o)},this.handleClick=(...n)=>{var u,c;const s=typeof this.props.label;this.hideSelect(n[0]);const{item:i,index:o}=n[1],a=this.state.children;a==null||a.forEach(h=>h.selected=!1),a[o].selected=!0;let l=a[o].label;if(this.setState({children:a}),this.props.needChange){this.setState({label:s==="string"?l:i.icon}),[Tn.INPUT,Tn.INPUT_NUMBER].includes(this.props.selectType)&&this.inputRef.current.setValue(l);const h=this.props.children;if(h[10]&&h[10].locale==="borderLine.borderColor"){let m=h[10].children[0].value,g=h[11].value;(u=this.props.onClick)==null||u.call(this,a[o].hasOwnProperty("value")?a[o].value:a[o].label,m,g);return}}(c=this.props.onClick)==null||c.call(this,a[o].hasOwnProperty("value")?a[o].value:a[o].label)},this.handleButtonClick=()=>{var o,a,l,u;const n=this.state.children,s=n==null?void 0:n.find(c=>c.selected===!0),i=this.props.children;if(this.props.selectType==="color")(o=this.props.onClick)==null||o.call(this,this.state.selectColor);else if(i&&i[10]&&i[10].locale==="borderLine.borderColor"){let f=i[10].children[0].value,d=i[11].value;s&&((a=this.props.onClick)==null||a.call(this,s.hasOwnProperty("value")?s.value:s.label,f,d));return}else if(i&&i[0]&&i[0].locale&&i[0].locale.indexOf("merge")>-1){(l=this.props.onClick)==null||l.call(this,"all");return}s&&((u=this.props.onClick)==null||u.call(this,s.hasOwnProperty("value")?s.value:s.label))},this.handleKeyUp=n=>{var s;if(n.key==="Enter"){this.props.selectType===Tn.INPUT_NUMBER&&this.inputRef.current.base.blur();const i=n.currentTarget.value;this.update(i),this.hideSelect(n),(s=this.props.onKeyUp)==null||s.call(this,i)}},this.state={label:"",children:[],selectColor:"#000"};const{triggerUpdate:t}=e;t&&t(this.update.bind(this))}componentWillMount(){this.changeValue({label:this.props.label,children:this.props.children})}render(e){const{icon:t,tooltip:n,selectType:s,border:i,slot:o,style:a,onClick:l}=e;return this.state.label,s===Tn.INPUT||s===Tn.INPUT_NUMBER?b("div",{className:ft.selectButton},b("div",{className:ft.selectInput},b(xi,{type:s===Tn.INPUT_NUMBER?"number":"text",value:this.state.label,onClick:this.showSelect,ref:this.inputRef,bordered:!1,onKeyUp:this.handleKeyUp}),b("span",{onClick:this.showSelect},t)),i?b("div",{className:ft.selectLine}):"",b(Yr,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):s===Tn.DOUBLE?b("div",{className:`${ft.selectButton} ${ft.selectDoubleButton}`},b("div",{style:{display:"flex",alignItems:"center"}},b(br,{title:n,placement:"bottom"},b(In,{type:"text",onClick:this.handleButtonClick},b("div",{className:ft.selectButtonInner},b("div",{className:typeof this.state.label=="string"?ft.selectButtonInnerLabelString:ft.selectButtonInnerLabelIcon},this.state.label)))),b(br,{title:this.props.tooltipRight,placement:"bottom"},b(In,{type:"text",onClick:this.showSelect,className:ft.doubleButtons},b("div",{className:ft.selectButtonInner},t)))),i?b("div",{className:ft.selectLine}):"",b(Yr,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):s===Tn.COLOR?b("div",{className:`${ft.selectButton} ${ft.selectDoubleButton}`,ref:this.colorBtn},b("div",{style:{display:"flex",alignItems:"center"}},b(br,{title:n,placement:"bottom"},b(In,{type:"text",onClick:this.handleButtonClick},b("div",{className:ft.selectButtonInner},b("div",{className:typeof this.state.label=="string"?ft.selectButtonInnerLabelString:ft.selectButtonInnerLabelIcon},this.state.label),b("div",{className:ft.selectColor,style:{backgroundColor:this.state.selectColor}})))),b(br,{title:this.props.tooltipRight,placement:"bottom"},b(In,{type:"text",onClick:this.showSelect,className:ft.doubleButtons},b("div",{className:ft.selectButtonInner},t)))),i?b("div",{className:ft.selectLine}):"",b(_r,{color:"#000",onClick:u=>{this.setState({selectColor:u},()=>{l&&l(this.state.selectColor)})},slot:o,ref:this.ref})):b("div",{className:ft.selectButton},b(br,{title:n,placement:"bottom"},b(In,{type:"text",onClick:this.showSelect},b("div",{className:ft.selectButtonInner},b("div",{className:typeof this.state.label=="string"?ft.selectButtonInnerLabelString:ft.selectButtonInnerLabelIcon},this.state.label),t))),i?b("div",{className:ft.selectLine}):"",b(Yr,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a}))}}class Z4{render(){return K4}}const q4="univer-dropdown",J4="univer-drop-content",Q4="univer-drop-icon";var Pa={dropdown:q4,dropContent:J4,dropIcon:Q4};class ps extends Xe{constructor(){super(...arguments),this.MenuRef=Ve(),this.DropRef=Ve(),this.IconRef=Ve(),this.handleClick=e=>{var n,s,i;(s=(n=this.props).onClick)==null||s.call(n);const{icon:t}=this.props;t||(i=this.MenuRef.current)==null||i.showMenu(!0)},this.handleSubClick=()=>{var e;(e=this.MenuRef.current)==null||e.showMenu(!0)},this.hideMenu=e=>{var t,n;(!this.DropRef.current||!((t=this.DropRef.current)!=null&&t.contains(e.target)))&&((n=this.MenuRef.current)==null||n.showMenu(!1))}}initialize(){this.state={menuStyle:{}}}componentDidMount(){const{placement:e}=this.props;let t={position:"absolute"};!e||e==="Bottom"?(t.left=0,t.top="100%"):e==="Top"?(t.left=0,t.top="-100%"):e==="Left"?(t.left="-100%",t.top=0):(t.left="100%",t.top=0),this.setState({menuStyle:t}),window.addEventListener("click",this.hideMenu)}componentWillUnmount(){window.removeEventListener("click",this.hideMenu)}render(){const{children:e,menu:t,showArrow:n,icon:s,tooltip:i}=this.props,{menuStyle:o}=this.state;return b("div",{className:Pa.dropdown,ref:this.DropRef},b(br,{title:i,placement:"bottom"},b("div",{className:Pa.dropContent,onClick:this.handleClick},e,n?b(Ri.NextIcon,null):"")),s?b("div",{ref:this.IconRef,className:Pa.dropIcon,onClick:this.handleSubClick},s):"",b(oa,{onClick:t.onClick,ref:this.MenuRef,menu:t.menu,className:t.className,style:{...t.style,...o}}))}}class eE{render(){return ps}}const tE="univer-sider-modal",nE="univer-sider-modal-header",rE="univer-sider-modal-title",sE="univer-sider-modal-close",iE="univer-sider-modal-body",oE="univer-sider-modal-body-inner",aE="univer-sider-modal-footer";var Hr={siderModal:tE,siderModalHeader:nE,siderModalTitle:rE,siderModalClose:sE,siderModalBody:iE,siderModalBodyInner:oE,siderModalFooter:aE};class lE extends Xe{initialize(e){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(e){const{className:t="",style:n}=e;return b("div",{className:`${Hr.siderModal} ${t}`,style:{...n}},b("div",{className:Hr.siderModalHeader},b("h3",{className:Hr.siderModalTitle},this.props.title),b("span",{className:Hr.siderModalClose,onClick:()=>this.close()},b(cg.Close,null))),b("div",{className:Hr.siderModalBody},b("div",{className:Hr.siderModalBodyInner},this.props.children)),b("div",{className:Hr.siderModalFooter},this.props.footer))}}class uE{render(){return lE}}const cE="univer-slider",hE="univer-sr-only";var us={slider:cE,srOnly:hE};class dE extends Xe{constructor(){super(...arguments),this.ref=Ve(),this.onInput=(e,t)=>{var i;const s=t.target.value;this.changeInputValue(e,s),(i=this.props.onChange)==null||i.call(this,t)},this.onClick=(e,t)=>{var c;const{min:n=0,max:s=100,step:i=1}=this.props,o=t.currentTarget;let a=t.offsetX;const l=o.offsetWidth;if(a<0||a>l)return;let u=a/this.width*(s-n);u%i&&(u+=i-u%i),this.changeInputValue(e,u),(c=this.props.onClick)==null||c.call(this,t,u)},this.changeInputValue=(e,t)=>{let n=this.ref.current,i=n.getElementsByTagName("input")[e].id;n.style.setProperty(`--${i}`,t),e?this.setValue({valueNext:t}):this.setValue({valuePrev:t})},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)}}initialize(e){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=dl("slider"),this.idNext=dl("slider")}componentDidMount(){const{min:e=0,max:t=100,range:n}=this.props;let s=t-e,i=this.ref.current;if(this.width=i.offsetWidth,i.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${us.slider}::after`,`margin-left: calc((var(--${this.idNext}) - ${e})/${s}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${s}*100%);`),document.styleSheets[0].insertRule(`.${us.slider}::after {margin-left: calc((var(--${this.idNext}) - ${e})/${s}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${s}*100%);}`,0),document.styleSheets[0].addRule(`.${us.slider}::before`,`margin-left: calc((var(--${this.idPrev}) - ${e})/${s}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${s}*100%);`),document.styleSheets[0].insertRule(`.${us.slider}::before {margin-left: calc((var(--${this.idPrev}) - ${e})/${s}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${s}*100%);}`,0),n){let{value:o}=this.props;o=o||[0,0],this.setValue({valuePrev:o[0],valueNext:o[1]})}else{let{value:o}=this.props;o=o||0,this.changeInputValue(0,o)}}render(e,t){const{valuePrev:n,valueNext:s}=t,{step:i=1,min:o=0,max:a=100,range:l=!1}=e;return l?b("div",{className:us.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":o,"--max":a},ref:this.ref},b("label",{class:"sr-only",for:this.idPrev}),b("input",{id:this.idPrev,type:"range",min:o,value:n,max:a,step:i,onInput:u=>this.onInput(0,u)}),b("label",{class:"sr-only",for:this.idNext}),b("input",{id:this.idNext,type:"range",min:o,value:s,max:a,step:i,onInput:u=>this.onInput(1,u)})):b("div",{className:us.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":o,"--max":a},ref:this.ref,onClick:u=>this.onClick(0,u)},b("label",{class:"sr-only",for:this.idPrev}),b("input",{id:this.idPrev,type:"range",min:o,value:n,max:a,step:i,onInput:u=>this.onInput(0,u)}))}}class fE{render(){return dE}}const gE="univer-tabs",mE="univer-tabs-nav",pE="univer-tabs-nav-wrap",_E="univer-tabs-nav-list",bE="univer-tabs-tab",vE="univer-tabs-tab-active",CE="univer-tabs-content",EE="univer-tabs-panel",wE="univer-tabs-panel-active",TE="univer-tabs-card";var Rn={tabs:gE,tabsNav:mE,tabsNavWrap:pE,tabsNavList:_E,tabsTab:bE,tabsTabActive:vE,tabsContent:CE,tabsPanel:EE,tabsPanelActive:wE,tabsCard:TE};class yE extends Fs{constructor(){super(...arguments),this.state={active:""},this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.parseNavList=()=>{const{active:e}=this.state;return zn(this.props.children).map(t=>{const{tab:n,keys:s}=t.props,i=`${dl("tab")}-${s}`;return e===s?b("div",{id:i,onClick:this.handleClick,className:sn(Rn.tabsTab,Rn.tabsTabActive)},n):b("div",{id:i,onClick:this.handleClick,className:Rn.tabsTab},n)})},this.handleClick=e=>{var i,o;const t=e.target.id,n=t.lastIndexOf("-"),s=t.slice(n+1);this.setValue({active:s}),(o=(i=this.props).onTabClick)==null||o.call(i,s,e)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(e,t){const{children:n,type:s="line",className:i=""}=e,o=sn(Rn.tabs,{[`${Rn.tabs}-card`]:s==="card"},i);return b("div",{className:o},b("div",{className:Rn.tabsNav},b("div",{className:Rn.tabsNavWrap},b("div",{className:Rn.tabsNavList},this.parseNavList()))),b("div",{className:Rn.tabsContent},n.map(a=>b(bg,{keys:a.props.keys,active:a.props.keys===this.state.active},a.props.children))))}}const bg=r=>{const{id:e,keys:t,style:n,children:s,active:i}=r;return b("div",{id:e&&`${e}-panel-${t}`,role:"tabpanel",style:{...n},className:sn(Rn.tabsPanel,i&&Rn.tabsPanelActive)},i&&s)};class SE{render(){return yE}}class AE{render(){return bg}}const RE="univer-tooltip-Group",DE="univer-tooltip-title",xE="univer-tooltip-body",IE="univer-tooltip-ss",OE="univer-top",kE="univer-tooltip-triangle",NE="univer-right",ME="univer-bottom",FE="univer-left";var Tr={tooltipGroup:RE,tooltipTitle:DE,tooltipBody:xE,tooltipSs:IE,top:OE,tooltipTriangle:kE,right:NE,bottom:ME,left:FE};const BE={top:Tr.top,bottom:Tr.bottom,left:Tr.left,right:Tr.right};class br extends Xe{constructor(){super(...arguments),this.tooltip=Ve()}initialize(e){this.state={placement:e.placement||"top",placementClassName:sn(Tr.tooltipTitle,BE[e.placement||"top"]),top:"",left:""}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let e=this.tooltip.current.getBoundingClientRect(),t=e.height,n=e.width;this.state.placement==="bottom"?this.setState({top:t+10,left:n/2}):this.state.placement==="left"?this.setState({top:t/2,left:n+5}):this.state.placement==="right"?this.setState({top:t/2,left:-n-10}):this.setState({top:-t-20,left:n/2})}}render(){return b("div",{ref:this.tooltip,className:Tr.tooltipGroup,style:this.props.styles},b("div",{className:Tr.tooltipBody,onMouseEnter:this.handleMouseOver.bind(this)},this.props.children),this.props.title?b("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`}},this.props.title,b("span",{className:Tr.tooltipTriangle})):null)}}class LE{render(){return br}}const PE="univer-cols-menu",HE="univer-cols-menu-jsx",UE="univer-cols-menuitem",zE="univer-line",WE="univer-cols-menuitem-content",VE="univer-ul-icon",GE="univer-submenu-arrow",XE="univer-icon-rightIcon";var Fn={colsMenu:PE,colsMenuJsx:HE,colsMenuitem:UE,line:zE,colsMenuitemContent:WE,ulIcon:VE,submenuArrow:GE,iconRightIcon:XE};class Yr extends Xe{constructor(){super(...arguments),this.refs=[],this.ulRef=Ve(),this.filterChildren=e=>{let t;return Array.from(e.children).forEach(n=>{n.nodeName==="UL"&&(t=!0)}),t},this.mouseOver=(e,t)=>{this.refs.forEach(s=>{s.hideSelect()});const n=e.currentTarget;!this.filterChildren(n)||this.refs[t].showSelect()},this.mouseLeave=(e,t)=>{(this.refs[t]?this.refs[t].props.children[0].selectType:"")!=="jsx"&&this.refs.forEach(s=>{s.hideSelect()})},this.handleClick=(e,{item:t,index:n,ref:s},i)=>{e.stopImmediatePropagation(),i==null||i.call(this,e,{item:t,index:n,ref:s})},this.handleKeyUp=(e,{item:t,index:n,ref:s},i)=>{e.stopImmediatePropagation(),i==null||i.call(this,e,{item:t,index:n,ref:s})},this.sendParent=()=>this,this.hideSelect=()=>{var e;window.removeEventListener("resize",this.resizeUl),((e=this.state.style)==null?void 0:e.display)!=="none"&&(this.refs.forEach(t=>{t.hideSelect()}),this.setState(t=>({style:{display:"none"}})))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState(e=>({style:{display:"inline-block"}}),()=>{this.getStyle()})},this.getStyle=()=>{var c;const e=(c=this.ulRef.current)==null?void 0:c.parentElement,t=this.ulRef.current;let n={},s;if(!t||!e)return;const i=t.getBoundingClientRect();let o=e==null?void 0:e.getBoundingClientRect();s=this.getContext().getPluginManager().getPluginByName("spreadsheet").getSheetContainerControl().getContentRef().current.getBoundingClientRect(),!(!s||!o)&&((e==null?void 0:e.nodeName)==="LI"?(t.style.position="fixed",o=e==null?void 0:e.getBoundingClientRect(),o.right+i.width>s.right?(n.left=`${o.left-i.width}px`,n.top=`${o.top}px`):(n.left=`${o.right}px`,n.top=`${o.top}px`)):(e==null?void 0:e.nodeName)==="DIV"&&(o.right+i.width>s.right||o.right+i.width>document.documentElement.clientWidth?(n.right="0",n.left="auto"):(n.left="0",n.right="auto"),i.top>=s.bottom&&(n.top="auto",n.bottom="100%")),this.setState(h=>({posStyle:n})))},this.showIcon=e=>"selected"in e||"hidden"in e?e.selected?b("span",{className:Fn.ulIcon},b(Ri.CorrectIcon,{style:{fontSize:"13px"}})):e.hidden?b("span",{className:Fn.ulIcon},b(Ri.HideIcon,{style:{fontSize:"13px"}})):b("span",{className:Fn.ulIcon}):"",this.getIcon=e=>{let t=e;return typeof t=="string"&&/Icon$/.test(t)&&(t=uv[t]),b("span",{className:Fn.submenuArrow},t)},this.getParent=()=>{var e;return(e=this.props.getParent())!=null?e:null}}initialize(e){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=Xr(this.getStyle,200)}componentWillMount(){const{show:e=!1}=this.props;e&&this.setState(t=>({style:{display:"inline-block"}}))}render(e,t){var u;const{children:n,onClick:s,style:i,onKeyUp:o}=e,{posStyle:a}=t,l=Object.assign((u=this.state.style)!=null?u:{},a,i||{});return n!=null&&n.length?(n.some((c,h)=>c.selected?(n.forEach((f,d)=>{h!==d&&(f.selected=!1)}),!0):!1),b("ul",{className:n[0].selectType==="jsx"?Fn.colsMenuJsx:Fn.colsMenu,style:{...l},ref:this.ulRef},n==null?void 0:n.map((c,h)=>{var d;let f=c.className?`${Fn.colsMenuitem} ${c.className}`:Fn.colsMenuitem;if(!c.hideLi)return b("li",{className:f,style:{...c.style},onClick:m=>{m.stopPropagation(),this.handleClick(m,{item:c,index:h,ref:this},c.onClick?c.onClick:s)},onMouseEnter:m=>{this.mouseOver(m,h)},onMouseLeave:m=>{this.mouseLeave(m,h)},onKeyUp:m=>{this.handleKeyUp(m,{item:c,index:h,ref:this},c.onKeyUp?c.onKeyUp:o)}},b("div",{className:c.selectType==="jsx"?"":Fn.colsMenuitemContent},this.showIcon(c),b("div",null,c.selectType==="jsx"?b("span",null,nd(c.label,{onChange:this.getStyle})):b("span",null,c.label),c.icon?this.getIcon(c.icon):"")),(d=c.children)!=null&&d.length?b(Yr,{children:c.children,onClick:c.onClick,ref:m=>this.refs[h]=m,getParent:this.sendParent}):b(yt,null),c.border?b("div",{className:Fn.line}):"")}))):b(yt,null)}}class $E{render(){return Yr}}class YE extends or{constructor(){super("ComponentSheet")}getComponentRender(){return new jE(this.getComponentFactory())}getComponentFactory(){return new KE}}class jE{constructor(e){this._componentFactory=e}renderForwardFn(e){return this._componentFactory.createComponent(e).render()}renderClass(e){return this._componentFactory.createComponent(e).render()}renderFunction(e){return this._componentFactory.createComponent(e).render()}}class KE{createComponent(e){switch(e){case"Button":return new Cv;case"Select":return new Z4;case"Container":return new l5;case"CellRangeModal":return new jv;case"Modal":return new T4;case"SiderModal":return new uE;case"Layout":return new Q5;case"Header":return new e4;case"Footer":return new t4;case"Content":return new n4;case"Sider":return new r4;case"Checkbox":return new nC;case"CheckboxGroup":return new sC;case"ColorPicker":return new n5;case"ColorPickerCircleButton":return new a5;case"Input":return new PC;case"Radio":return new O4;case"RadioGroup":return new k4;case"Tab":return new SE;case"TabPane":return new AE;case"Tooltip":return new LE;case"Ul":return new $E;case"Collapse":return new fC;case"Panel":return new gC;case"FormatModal":return new m5;case"Menu":return new l4;case"Dropdown":return new eE;case"NextIcon":return new cb;case"RightIcon":return new hb;case"OrderIcon":return new xb;case"CommentIcon":return new Bb;case"ConditionalFormatIcon":return new Pb;case"ScreenshotIcon":return new tv;case"CheckIcon":return new Fb;case"SearchIcon":return new zb;case"ReplaceIcon":return new Ub;case"FreezeIcon":return new Lb;case"PivotableIcon":return new Rb;case"FillColorIcon":return new f2;case"BoldIcon":return new Z_;case"FullBorderIcon":return new g2;case"TopBorderIcon":return new m2;case"BottomBorderIcon":return new p2;case"LeftBorderIcon":return new _2;case"RightBorderIcon":return new b2;case"NoneBorderIcon":return new v2;case"OuterBorderIcon":return new C2;case"InnerBorderIcon":return new E2;case"StripingBorderIcon":return new w2;case"VerticalBorderIcon":return new T2;case"MergeIcon":return new y2;case"SumIcon":return new Db;case"OrderDESCIcon":return new Ib;case"OrderASCIcon":return new Ob;case"FilterIcon":return new kb;case"FilterRankIcon":return new Nb;case"CleanIcon":return new Mb;case"DeleteIcon":return new ov;case"DeleteLineIcon":return new J_;case"UnderLineIcon":return new Q_;case"ItalicIcon":return new q_;case"TextColorIcon":return new e2;case"BackIcon":return new ab;case"ForwardIcon":return new lb;case"FormatIcon":return new ub;case"CorrectIcon":return new db;case"LtIcon":return new fb;case"CloseIcon":return new gb;case"DropDownIcon":return new mb;case"MenuIcon":return new pb;case"HideIcon":return new _b;case"PhotoIcon":return new sb;case"LinkIcon":return new ib;case"ChartIcon":return new ob;case"LoadingIcon":return new D_;case"LogoIcon":return new I_;case"AddNumIcon":return new P_;case"ReduceNumIcon":return new H_;case"PercentIcon":return new U_;case"MoneyIcon":return new z_;case"FxIcon":return new W_;case"AddIcon":return new V_;case"ReduceIcon":return new G_;case"DivideIcon":return new Hb;case"LockIcon":return new Wb;case"LocationIcon":return new Vb;case"PageIcon":return new Gb;case"RegularIcon":return new Xb;case"LayoutIcon":return new $b;case"TableIcon":return new Yb;case"ImageIcon":return new sv;case"LeftAlignIcon":return new U2;case"CenterAlignIcon":return new z2;case"RightAlignIcon":return new W2;case"TopVerticalIcon":return new V2;case"CenterVerticalIcon":return new G2;case"BottomVerticalIcon":return new X2;case"TextRotateIcon":return new $2;case"TextRotateAngleUpIcon":return new Y2;case"TextRotateAngleDownIcon":return new j2;case"TextRotateVerticalIcon":return new K2;case"TextRotateRotationUpIcon":return new Z2;case"TextRotateRotationDownIcon":return new q2;case"BrIcon":return new J2;case"OverflowIcon":return new Q2;case"CutIcon":return new eb;case"PrintIcon":return new ev;case"PrintAreaIcon":return new nv;case"PrintTitleIcon":return new rv;case"BorderDashDot":return new Ov;case"BorderDashDotDot":return new Nv;case"BorderDashed":return new xv;case"BorderDotted":return new Rv;case"BorderHair":return new Sv;case"BorderMedium":return new Fv;case"BorderMediumDashDot":return new Hv;case"BorderMediumDashDotDot":return new zv;case"BorderMediumDashed":return new Lv;case"BorderThick":return new Vv;case"BorderThin":return new Tv;case"Slider":return new fE}throw new Error("Not Found Component")}}function ZE(r){r.deleteObserve("onAfterChangeFontFamilyObservable"),r.deleteObserve("onAfterChangeFontSizeObservable"),r.deleteObserve("onAfterChangeFontWeightObservable"),r.deleteObserve("onAfterChangeFontItalicObservable"),r.deleteObserve("onAfterChangeFontStrikethroughObservable"),r.deleteObserve("onAfterChangeFontUnderlineObservable"),r.deleteObserve("onAfterChangeFontBackgroundObservable"),r.deleteObserve("onAfterChangeFontColorObservable"),r.deleteObserve("onDragAndDropStartObserver"),r.deleteObserve("onDragAndDroppingObserver"),r.deleteObserve("onDragAndDropEndEndObserver"),r.deleteObserve("onFillStartObserver"),r.deleteObserve("onFillingObserver"),r.deleteObserve("onFillEndObserver"),r.deleteObserve("onChangeSelectionObserver"),r.deleteObserve("onToolBarDidMountObservable"),r.deleteObserve("onModalGroupDidMountObservable"),r.deleteObserve("onRichTextDidMountObservable"),r.deleteObserve("onRichTextKeyDownObservable"),r.deleteObserve("onRichTextKeyUpObservable"),r.deleteObserve("onFormulaBarDidMountObservable"),r.deleteObserve("onChangeCurrentSheetObserver"),r.deleteObserve("onSheetContainerDidMountObservable"),r.deleteObserve("onCellRangeModalDidMountObservable")}function qE(r){r.pushToObserve("onAfterChangeFontFamilyObservable"),r.pushToObserve("onAfterChangeFontSizeObservable"),r.pushToObserve("onAfterChangeFontWeightObservable"),r.pushToObserve("onAfterChangeFontItalicObservable"),r.pushToObserve("onAfterChangeFontStrikethroughObservable"),r.pushToObserve("onAfterChangeFontUnderlineObservable"),r.pushToObserve("onAfterChangeFontBackgroundObservable"),r.pushToObserve("onAfterChangeFontColorObservable"),r.pushToObserve("onDragAndDropStartObserver"),r.pushToObserve("onDragAndDroppingObserver"),r.pushToObserve("onDragAndDropEndEndObserver"),r.pushToObserve("onFillStartObserver"),r.pushToObserve("onFillingObserver"),r.pushToObserve("onFillEndObserver"),r.pushToObserve("onChangeSelectionObserver"),r.pushToObserve("onChangeCurrentSheetObserver"),r.pushToObserve("onToolBarDidMountObservable"),r.pushToObserve("onCellRangeModalDidMountObservable"),r.pushToObserve("onModalGroupDidMountObservable"),r.pushToObserve("onRichTextDidMountObservable"),r.pushToObserve("onRichTextKeyDownObservable"),r.pushToObserve("onRichTextKeyUpObservable"),r.pushToObserve("onFormulaBarDidMountObservable"),r.pushToObserve("onLineColorDidMountObservable"),r.pushToObserve("onLineBoldDidMountObservable"),r.pushToObserve("onColorSelectDidMountObservable"),r.pushToObserve("onSheetBarDidMountObservable"),r.pushToObserve("onCountBarDidMountObservable"),r.pushToObserve("onInfoBarDidMountObservable"),r.pushToObserve("onRightMenuDidMountObservable"),r.pushToObserve("onSheetContainerDidMountObservable")}var JE={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",cut:"\u526A\u5207",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},QE={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",cut:"Cut",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};class ew{constructor(){this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(e){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var jt=(r=>(r.MAIN_SCENE="mainScene",r.VIEW_MAIN="viewMain",r.VIEW_TOP="viewTop",r.VIEW_LEFT="viewLeft",r.VIEW_LEFT_TOP="viewLeftTop",r.SHEET_VIEW="sheetView",r.DRAG_LINE_VIEW="dragLineView",r))(jt||{});const vg=xr.create(),Cg={outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,formulaBar:!0,toolBar:!0,countBar:!0,sheetBar:!0,contentSplit:!1,rightMenu:!0},Eg={undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0},pl={hideInsertRow:!1,hideInsertColumn:!1,hideAddRowTop:!0,hideAddRowBottom:!0,hideAddColumnLeft:!0,hideAddColumnRight:!0,hideDeleteRow:!1,hideDeleteColumn:!1,hideHideRow:!0,hideShowRow:!0,hideRowHeight:!1,hideHideColumn:!0,hideShowColumn:!0,hideColumnWidth:!1,hideDeleteCell:!1,hideClearContent:!1,hideMatrix:!0},tw={container:"universheet",layout:{sheetContainerConfig:Cg,toolBarConfig:Eg,rightMenuConfig:pl},selections:{"sheet-01":[{selection:{startRow:0,endRow:0,startColumn:0,endColumn:0}}],"sheet-02":[{selection:{startRow:0,endRow:0,startColumn:0,endColumn:0}}]}};var Ls=(r=>(r.SET_SELECTION_VALUE_ACTION="SetSelectionValueAction",r))(Ls||{});class wg{constructor(e,t){this._cell=e,this._value=t}getCell(){return this._cell}setValue(e){}execute(){}}class nw{constructor(e){this._plugin=e}get zIndex(){return 0}create(e,t){return new wg(e,t)}check(e){return!1}}class fu{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new fu}}const rw=fu.create();class sw{constructor(){this._cellEditExtensionFactoryList=[]}get cellEditExtensionFactoryList(){return this._cellEditExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellEditExtensionFactoryList.push(...e),this._cellEditExtensionFactoryList.sort(Ft)}delete(e){const t=this._cellEditExtensionFactoryList.indexOf(e);this._cellEditExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellEditExtensionFactoryList.push(...rw.getData().sort(Ft))}}class Rs{handle(e){var s;const t=(s=Rs==null?void 0:Rs.register)==null?void 0:s.cellEditExtensionFactoryList;if(!t)return;this._cellEditExtensionFactoryList=t;const n=this._checkExtension(e);if(n)return n.execute(),n.getCell()}_checkExtension(e){let t=!1;if(!this._cellEditExtensionFactoryList)return!1;for(let n=0;n<this._cellEditExtensionFactoryList.length&&(t=this._cellEditExtensionFactoryList[n].check(e),t===!1);n++);return t}static create(){return this.register||(this.register=new sw,this.register.initialize()),this.register}}class Tg{constructor(e,t){this._cell=e,this._value=t}getCell(){return this._cell}setValue(e){}execute(){}}class iw{constructor(e){this._plugin=e}get zIndex(){return 0}create(e,t){return new Tg(e,t)}check(e){return!1}}class gu{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new gu}}const ow=gu.create();class aw{constructor(){this._cellInputExtensionFactoryList=[]}get cellInputExtensionFactoryList(){return this._cellInputExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._cellInputExtensionFactoryList.push(...e),this._cellInputExtensionFactoryList.sort(Ft)}delete(e){const t=this._cellInputExtensionFactoryList.indexOf(e);this._cellInputExtensionFactoryList.splice(t,1)}_initExtensions(){this._cellInputExtensionFactoryList.push(...ow.getData().sort(Ft))}}class Ds{handle(e){var s;const t=(s=Ds==null?void 0:Ds.register)==null?void 0:s.cellInputExtensionFactoryList;if(!t)return;this._cellInputExtensionFactoryList=t;const n=this._checkExtension(e);if(n)return n.execute(),n.getCell()}_checkExtension(e){let t=!1;if(!this._cellInputExtensionFactoryList)return!1;for(let n=0;n<this._cellInputExtensionFactoryList.length&&(t=this._cellInputExtensionFactoryList[n].check(e),t===!1);n++);return t}static create(){return this.register||(this.register=new aw,this.register.initialize()),this.register}}function dh(r,e){var s;const t=(s=r.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET))==null?void 0:s.getSelectionManager();if(!t)return[];const n=t==null?void 0:t.getCurrentModelsValue();return t.setModels(e),n}class lw extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e};const s=this.do();this._oldActionData={...e,selections:s},this.validate()}do(){const{selections:e}=this._doActionData,t=this.getWorkSheet(),n=dh(t,e);return this._observers.notifyObservers({type:we.REDO,data:this._doActionData,action:this}),n}redo(){const{sheetId:e}=this._doActionData,t=this.do();this._oldActionData={actionName:Ls.SET_SELECTION_VALUE_ACTION,sheetId:e,selections:t}}undo(){const{selections:e,sheetId:t}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Ls.SET_SELECTION_VALUE_ACTION,sheetId:t,selections:dh(n,e)},this._observers.notifyObservers({type:we.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Be.register(Ls.SET_SELECTION_VALUE_ACTION,lw);class uw{constructor(e){this._range=e}getRange(){return this._range}getRect(){return this._rect}setRect(e){this._rect=e}setRange(e){this._range=e}}class cw{constructor(e){this._sheetId=e,this._antLineList=[]}deleteAntLineById(e){const t=this._antLineList.findIndex(n=>n.getRange().id===e);t>-1&&this._antLineList.splice(t,1)}addAntLine(e){this._antLineList.push(e)}getSheetId(){return this._sheetId}getAntLineList(){return this._antLineList}getAntLineById(e){const t=this._antLineList.findIndex(n=>n.getRange().id===e);if(t>-1)return this._antLineList[t]}}class hw{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class dw{get copy(){return this._copy}get copyAs(){return this._copyAs}get paste(){return this._paste}get menuList(){return this._menuList}setValue(e){const{copy:t,copyAs:n,paste:s}=e;this._copy=t,this._copyAs=n,this._paste=s}setRightMenu(e){this._menuList=e}}class fw{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class mu{constructor(e){this._control=e,this._startOffsetX=0,this._startOffsetY=0,this._zIndex=e.zIndex+1,this._model=e.model,this._initialize()}_initialize(){this._control.getPlugin().getMainComponent();const{leftControl:t,rightControl:n,topControl:s,bottomControl:i,fillControl:o}=this._control;t.onPointerEnterObserver.add(u=>{t.cursor=gt.MOVE}),t.onPointerLeaveObserver.add(u=>{t.resetCursor()}),n.onPointerEnterObserver.add(u=>{n.cursor=gt.MOVE}),n.onPointerLeaveObserver.add(u=>{n.resetCursor()}),s.onPointerEnterObserver.add(u=>{s.cursor=gt.MOVE}),s.onPointerLeaveObserver.add(u=>{s.resetCursor()}),i.onPointerEnterObserver.add(u=>{i.cursor=gt.MOVE}),i.onPointerLeaveObserver.add(u=>{i.resetCursor()}),i.onPointerDownObserver.add(u=>{this.dragDown(u,Q.BOTTOM)}),i.onPointerUpObserver.add(u=>{i.resetCursor()});const a=this._zIndex;this._leftDragControl=new rt("__LeftDragControl__"+a,{top:0,left:-je.strokeWidth/2,width:je.strokeWidth*2,fill:je.strokeColor,zIndex:a}),this._rightDragControl=new rt("__RightDragControl__"+a,{width:je.strokeWidth*2,fill:je.strokeColor,zIndex:a}),this._topDragControl=new rt("__TopDragControl__"+a,{top:-je.strokeWidth/2,left:-je.strokeWidth/2,height:je.strokeWidth*2,fill:je.strokeColor,zIndex:a}),this._bottomDragControl=new rt("__BottomDragControl__"+a,{height:je.strokeWidth*2,fill:je.strokeColor,left:-je.strokeWidth/2,zIndex:a}),this._selectionDragShape=new Qo("__SelectionDragShape__"+a,this._leftDragControl,this._rightDragControl,this._topDragControl,this._bottomDragControl),this._selectionDragShape.evented=!1,this._selectionDragShape.zIndex=a,this._control.getScene().addObject(this._selectionDragShape)}dragEventInitial(){}dragDown(e,t){const n=this._control.getPlugin().getMainComponent(),s=this._model.getValue().selection;this._model=new zo(yr.NORMAL,this._control.getPlugin()),this._model.setValue(s),this._updateControl();const{offsetX:i,offsetY:o}=e;this._startOffsetX=i,this._startOffsetY=o;const a=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY);let l=null;switch(t){case Q.LEFT:l=n.calculateCellIndexByPosition(i+je.strokeWidth,o,a);break;case Q.TOP:l=n.calculateCellIndexByPosition(i,o+je.strokeWidth,a);break;case Q.RIGHT:l=n.calculateCellIndexByPosition(i-je.strokeWidth,o,a);break;case Q.BOTTOM:l=n.calculateCellIndexByPosition(i,o-je.strokeWidth,a);break}const u=Ei(l);if(!u)return!1;const{startRow:c,startColumn:h,endColumn:f,endRow:d,startY:m,endY:g,startX:p,endX:_}=u,v={startColumn:h,startRow:c,endColumn:f,endRow:d,startY:m,endY:g,startX:p,endX:_};this._oldSelectionRange=v,this._cellPositionOffset={top:v.startRow-this._model.startRow,bottom:this._model.endRow-v.endRow,left:v.startColumn-this._model.startColumn,right:this._model.endColumn-v.endColumn};const w=this._control.getScene();w.disableEvent();const y=Kr.create(w);y.startScroll(i,o),this._moveObserver=w.onPointerMoveObserver.add(A=>{this.dragMoving(A);const{offsetX:I,offsetY:R}=A;y.scrolling(I,R,()=>{this.dragMoving(A)})}),this._upObserver=w.onPointerUpObserver.add(A=>{this.dragUp(),w.onPointerMoveObserver.remove(this._moveObserver),w.onPointerUpObserver.remove(this._upObserver),w.enableEvent(),y.stopScroll()})}dragMoving(e){const t=this._control.getPlugin().getMainComponent(),{offsetX:n,offsetY:s,clientX:i,clientY:o}=e,a=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),l=t.calculateCellIndexByPosition(n,s,a),u=Ei(l);if(!u)return!1;const{startRow:c,startColumn:h,endColumn:f,endRow:d,startX:m,startY:g,endX:p,endY:_}=u,v={startColumn:h,startRow:c,endColumn:f,endRow:d,startY:g||0,endY:_||0,startX:m||0,endX:p||0},{startRow:w,endRow:y,startColumn:A,endColumn:I}=this._oldSelectionRange;if(A!==h||w!==c||I!==f||y!==d){this._oldSelectionRange=v;const{left:R,right:x,top:S,bottom:k}=this._cellPositionOffset,N=c-S,O=d+k,D=h-R,E=f+x;if(N<0||O<0||D<0||E<0)return;const F={startRow:N,endRow:O,startColumn:D,endColumn:E},j=t.getNoMergeCellPositionByIndex(F.startRow,F.startColumn),L=t.getNoMergeCellPositionByIndex(F.endRow,F.endColumn),re=Object.assign(F,{startY:(j==null?void 0:j.startY)||0,endY:(L==null?void 0:L.endY)||0,startX:(j==null?void 0:j.startX)||0,endX:(L==null?void 0:L.endX)||0});this._model.setValue(re),this._updateControl()}}dragUp(){const e=this._control.getPlugin().getMainComponent();this.hide();const{selection:t}=this._model.getValue(),n=e.getCellByIndex(t.startRow,t.startColumn);this._control.update(t,n)}_updateControl(){const{startX:e,startY:t,endX:n,endY:s}=this._model;this._leftDragControl.resize(void 0,s-t),this._rightDragControl.transformByState({height:s-t,left:n-e-je.strokeWidth/2}),this._topDragControl.resize(n-e+je.strokeWidth),this._bottomDragControl.transformByState({width:n-e+je.strokeWidth,top:s-t-je.strokeWidth/2}),this._selectionDragShape.show(),this._selectionDragShape.translate(e,t),this._selectionDragShape.makeDirty(!0)}hide(){this._selectionDragShape.hide(),this._selectionDragShape.makeDirty(!0)}dispose(){this._leftDragControl.dispose(),this._rightDragControl.dispose(),this._topDragControl.dispose(),this._bottomDragControl.dispose(),this._selectionDragShape.dispose()}remove(){const{leftControl:e,rightControl:t,topControl:n,bottomControl:s}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear(),t.onPointerEnterObserver.clear(),t.onPointerLeaveObserver.clear(),n.onPointerEnterObserver.clear(),n.onPointerLeaveObserver.clear(),s.onPointerEnterObserver.clear(),s.onPointerLeaveObserver.clear()}static create(e){return new mu(e)}}class pu{constructor(e){this._control=e,this._initialize()}_initialize(){const{fillControl:e}=this._control;this._control.getPlugin(),e.onPointerEnterObserver.add(t=>{e.cursor=gt.CROSSHAIR}),e.onPointerLeaveObserver.add(t=>{e.resetCursor()})}remove(){const{fillControl:e}=this._control;e.onPointerEnterObserver.clear(),e.onPointerLeaveObserver.clear()}static create(e){return new pu(e)}}const je={strokeColor:"rgb(1,136,251)",backgroundColor:"rgba(1,136,251, 0.1)",strokeWidth:2,fillSideLength:6,fillStrokeLength:1,fillStrokeColor:"rgb(255,255,255)"};var yr=(r=>(r[r.NORMAL=0]="NORMAL",r[r.ROW=1]="ROW",r[r.COLUMN=2]="COLUMN",r))(yr||{});class Cs{constructor(e,t){this._manager=e,this._zIndex=t,this._initialize()}_initialize(){this._selectionModel=new zo(0,this._manager.getPlugin());const e=this._zIndex;this._leftControl=new rt("__SpreadsheetSelectionShapeLeftControl__"+e,{top:0,left:-je.strokeWidth/2,width:je.strokeWidth,fill:je.strokeColor,zIndex:e}),this._rightControl=new rt("__SpreadsheetSelectionShapeRightControl__"+e,{width:je.strokeWidth,fill:je.strokeColor,zIndex:e}),this._topControl=new rt("__SpreadsheetSelectionTopControl__"+e,{top:-je.strokeWidth/2,left:-je.strokeWidth/2,height:je.strokeWidth,fill:je.strokeColor,zIndex:e}),this._bottomControl=new rt("__SpreadsheetSelectionBottomControl__"+e,{height:je.strokeWidth,fill:je.strokeColor,left:-je.strokeWidth/2,zIndex:e}),this._backgroundControlTop=new rt("__SpreadsheetSelectionBackgroundControlTop__"+e,{fill:je.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlBottom=new rt("__SpreadsheetSelectionBackgroundControlBottom__"+e,{fill:je.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleLeft=new rt("__SpreadsheetSelectionBackgroundControlMiddleLeft__"+e,{fill:je.backgroundColor,zIndex:e-1,evented:!1}),this._backgroundControlMiddleRight=new rt("__SpreadsheetSelectionBackgroundControlMiddleRight__"+e,{fill:je.backgroundColor,zIndex:e-1,evented:!1});const t=je.fillSideLength-je.fillStrokeLength;this._fillControl=new rt("__SpreadsheetSelectionFillControl__"+e,{width:t,height:t,fill:je.strokeColor,strokeWidth:je.fillStrokeLength,stroke:je.fillStrokeColor,zIndex:e+1}),this._selectionShape=new Qo("__SpreadsheetSelectionShape__"+e,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=e,this._selectionDragAndDrop=mu.create(this),this._selectionControlFill=pu.create(this),this.getScene().addObject(this._selectionShape)}get zIndex(){return this._zIndex}_updateControl(){const{startX:e,startY:t,endX:n,endY:s}=this._selectionModel;this.leftControl.resize(void 0,s-t),this.rightControl.transformByState({height:s-t,left:n-e-je.strokeWidth/2}),this.topControl.resize(n-e+je.strokeWidth),this.bottomControl.transformByState({width:n-e+je.strokeWidth,top:s-t-je.strokeWidth/2}),this.fillControl.translate(n-e-je.fillSideLength/2,s-t-je.fillSideLength/2),this._updateBackgroundControl(),this._updateDragAndFill(),this.selectionShape.show(),this.selectionShape.translate(e,t),this.selectionShape.makeDirty(!0)}_updateBackgroundControl(){const{startColumn:e,startRow:t,endColumn:n,endRow:s,startX:i,startY:o,endX:a,endY:l}=this._selectionModel,u=this._selectionModel.highlightToSelection();if(!u){this._backgroundControlTop.resize(a-i,l-o),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),this._backgroundControlMiddleRight.resize(0,0);return}const{startX:c,startY:h,endX:f,endY:d}=u,m=je.strokeWidth/2,g={left:-m,top:-m,width:a-i+m*2,height:h-o+m};g.height<0&&(g.width=0,g.height=0),this._backgroundControlTop.transformByState(g);const p={left:-m,top:h-o,width:c-i+m,height:d-h};p.width<0&&(p.width=0,p.height=0),this._backgroundControlMiddleLeft.transformByState(p);const _={left:f-i-m,top:h-o,width:a-f+m*2,height:d-h};_.width<0&&(_.width=0,_.height=0),this._backgroundControlMiddleRight.transformByState(_);const v={left:-m,top:d-o,width:a-i+m*2,height:l-d+m};v.height<0&&(v.width=0,v.height=0),this._backgroundControlBottom.transformByState(v)}_updateDragAndFill(){this._selectionModel.highlightToSelection()||(this._selectionDragAndDrop.remove(),this._fillControl.resize(0,0),this._selectionControlFill.remove())}update(e,t){this._selectionModel.setValue(e,t),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}dispose(){var e,t,n,s,i,o,a,l,u,c;(e=this._leftControl)==null||e.dispose(),(t=this._rightControl)==null||t.dispose(),(n=this._topControl)==null||n.dispose(),(s=this._bottomControl)==null||s.dispose(),(i=this._backgroundControlTop)==null||i.dispose(),(o=this._backgroundControlMiddleLeft)==null||o.dispose(),(a=this._backgroundControlMiddleRight)==null||a.dispose(),(l=this._backgroundControlBottom)==null||l.dispose(),(u=this._fillControl)==null||u.dispose(),(c=this._selectionShape)==null||c.dispose(),this._selectionDragAndDrop.dispose()}getScene(){return this._manager.getScene()}getPlugin(){return this._manager.getPlugin()}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}getCurrentCellInfo(){const e=this.model.currentCell;if(e){let t;if(e.isMerged){const n=e.mergeInfo;t={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:s,startX:i,endX:o,startY:a,endY:l}=e;t={startRow:n,endRow:n,startColumn:s,endColumn:s,startX:i,endX:o,startY:a,endY:l}}return t}}static create(e,t){return new this(e,t)}static fromJson(e,t,n){const s=Cs.create(e,t);return s.update(n),s}}class zo{constructor(e=yr.NORMAL,t){this._type=e,this._plugin=t}isEqual(e){const{startColumn:t,startRow:n,endColumn:s,endRow:i,type:o}=this,{startColumn:a,startRow:l,endColumn:u,endRow:c}=e;return t===a&&n===l&&s===u&&i===c}isInclude(e){const{startColumn:t,startRow:n,endColumn:s,endRow:i,type:o}=this,{startColumn:a,startRow:l,endColumn:u,endRow:c}=e;return!(u<t||a>s||l>i||c<n)}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}highlightToSelection(){return Ei(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(e,t){const{startColumn:n,startRow:s,endColumn:i,endRow:o,startX:a,startY:l,endX:u,endY:c}=e;this._startColumn=n,this._startRow=s,this._endColumn=i,this._endRow=o,this._startX=a,this._startY=l,this._endX=u,this._endY=c,this.setTypeByData(),this.setCurrentCell(t)}setCurrentCell(e){e&&(this._currentCell=e)}clearCurrentCell(){this._currentCell=null}setTypeByData(){const e=this._plugin.getWorkbook().getActiveSheet().getConfig().rowCount,t=this._plugin.getWorkbook().getActiveSheet().getConfig().columnCount;return this._startRow===0&&this._endRow===e-1?this._type=yr.COLUMN:this._startColumn===0&&this._endColumn===t-1?this._type=yr.ROW:this._type=yr.NORMAL}}const cs={strokeColor:"rgb(1,136,251)",strokeWidth:1,fillStrokeWidth:5};var _u=(r=>(r[r.VERTICAL=0]="VERTICAL",r[r.HORIZONTAL=1]="HORIZONTAL",r))(_u||{});class gw{constructor(e){this._manager=e}create(e){const{direction:t,end:n,dragUp:s,start:i}=e;this._direction=t,this._end=n,this._start=i,this._dragUp=s;const o=this._manager.getSheetView().getSpreadsheetColumnTitle().getSkeleton();if(t){const l=o==null?void 0:o.rowTitleWidth,u=o==null?void 0:o.columnTotalWidth;this._dragLineControlMain=new rt("__SpreadsheetDragLineMain__",{width:l,height:5,top:this._end-5,fill:cs.strokeColor}),this._dragLineControlContent=new rt("__SpreadsheetDragLineContent__",{width:u,height:1,top:this._end-1,left:l,fill:cs.strokeColor})}else{const l=o==null?void 0:o.columnTitleHeight,u=o==null?void 0:o.rowTotalHeight;this._dragLineControlMain=new rt("__SpreadsheetDragLineMain__",{width:cs.fillStrokeWidth,height:l,left:this._end-5,fill:cs.strokeColor}),this._dragLineControlContent=new rt("__SpreadsheetDragLineContent__",{width:cs.strokeWidth,height:u,top:l,left:this._end-1,fill:cs.strokeColor})}this._dragLine=new Qo("__SpreadsheetDragLine__",this._dragLineControlMain,this._dragLineControlContent),this._dragLine.hide(),this._dragLine.evented=!1,this._manager.getScene().addObject(this._dragLine,3)}dragDown(e){const t=this._manager.getScene();t.disableEvent(),this._state={distance:this._direction?e.clientY:e.clientX},this._dragLine.show(),this._moveObserver=t.onPointerMoveObserver.add(n=>{this.dragMoving(n)}),this._upObserver=t.onPointerUpObserver.add(n=>{this.dragUp(n),t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent()})}dragMoving(e){if(this._direction){if(e.clientY<this._state.distance&&this._state.distance-e.clientY>=this._end-this._start-5)return;this._dragLine.transformByState({top:e.clientY-this._state.distance})}else{if(e.clientX<this._state.distance&&this._state.distance-e.clientX>=this._end-this._start-5)return;this._dragLine.transformByState({left:e.clientX-this._state.distance})}}dragUp(e){let t;this._direction?(t=e.clientY-this._state.distance,e.clientY<this._state.distance&&this._state.distance-e.clientY>=this._end-this._start-5&&(t=null)):(t=e.clientX-this._state.distance,e.clientX<this._state.distance&&this._state.distance-e.clientX>=this._end-this._start-5&&(t=null)),this._dragUp(t),this._dragLine.dispose()}}class mw{constructor(e){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentWidth=0,this._manager=e,this._leftTopWidth=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().width,this._highlightItem=new rt("HighLightColumnTitle",{width:0,height:this._manager.getSheetView().getSpreadsheetSkeleton().columnTitleHeight,left:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem.hide(),this._highlightItem.evented=!1,this._manager.getScene().addObject(this._highlightItem,3)}pointerDown(e){var u,c;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const i=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),o=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientX-i.x-this._leftTopWidth-o.current.getBoundingClientRect().left,l=(c=(u=t.getSkeleton())==null?void 0:u.columnWidthAccumulation)!=null?c:[];for(let h=0;h<(l==null?void 0:l.length);h++)if(l[h]>=a){this._index=h;break}if(this._currentWidth=l[0],this._index&&(this._currentWidth=l[this._index]-l[this._index-1]),l[this._index]-a<=5){const h=l[this._index]+this._leftTopWidth,f=(this._index?l[this._index-1]:0)+this._leftTopWidth;this._manager.getDragLineControl().create({direction:_u.VERTICAL,end:h,start:f,dragUp:this.setColumnWidth.bind(this)}),this._manager.getDragLineControl().dragDown(e)}this.highlightColumn()}setColumnWidth(e){const n=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();e===null?n.setColumnWidth(this._index,1,5):n.setColumnWidth(this._index,1,e+this._currentWidth),this.highlightColumn()}highlightColumn(){this._manager.clearSelectionControls();const e=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:0,startColumn:this._index,endColumn:this._index,endRow:e.getRowCount()-1},{row:0,column:this._index})}highlightColumnTitle(e){var c,h;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const i=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),o=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientX-i.x-this._leftTopWidth-o.current.getBoundingClientRect().left,l=(h=(c=t.getSkeleton())==null?void 0:c.columnWidthAccumulation)!=null?h:[];for(let f=0;f<(l==null?void 0:l.length);f++)if(l[f]>=a){this._index=f;break}this._currentWidth=l[0];let u=this._leftTopWidth;this._index&&(this._currentWidth=l[this._index]-l[this._index-1],u=this._leftTopWidth+l[this._index-1]),this._highlightItem.transformByState({width:this._currentWidth,left:u}),this._highlightItem.show()}unHighlightColumnTitle(){this._highlightItem.hide()}}class pw{constructor(e){this._startOffsetX=0,this._startOffsetY=0,this._index=0,this._currentHeight=0,this._manager=e,this._leftTopHeight=this._manager.getSheetView().getSpreadsheetLeftTopPlaceholder().getState().height,this._highlightItem=new rt("HighLightRowTitle",{width:this._manager.getSheetView().getSpreadsheetSkeleton().rowTitleWidth,height:0,top:0,fill:"rgb(220,220,220,0.5)"}),this._highlightItem.hide(),this._highlightItem.evented=!1,this._manager.getScene().addObject(this._highlightItem,3)}pointerDown(e){var u,c;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const i=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),o=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientY+i.y-this._leftTopHeight-o.current.getBoundingClientRect().top,l=(c=(u=t.getSkeleton())==null?void 0:u.rowHeightAccumulation)!=null?c:[];for(let h=0;h<(l==null?void 0:l.length);h++)if(l[h]>=a){this._index=h;break}if(this._currentHeight=l[0],this._index&&(this._currentHeight=l[this._index]-l[this._index-1]),l[this._index]-a<=5){const h=l[this._index]+this._leftTopHeight,f=(this._index?l[this._index-1]:0)+this._leftTopHeight;this._manager.getDragLineControl().create({direction:_u.HORIZONTAL,end:h,start:f,dragUp:this.setRowHeight.bind(this)}),this._manager.getDragLineControl().dragDown(e)}this.highlightRow()}setRowHeight(e){const n=this._manager.getPlugin().getContext().getWorkBook().getActiveSheet();e===null?n.setRowHeights(this._index,1,5):n.setRowHeights(this._index,1,e+this._currentHeight),this.highlightRow()}highlightRow(){this._manager.clearSelectionControls();const e=this._manager.getPlugin().getWorkbook().getActiveSheet();this._manager.addControlToCurrentByRangeData({startRow:this._index,startColumn:0,endColumn:e.getColumnCount()-1,endRow:this._index},{row:this._index,column:0})}highlightRowTitle(e){var c,h;const t=this._manager.getMainComponent(),{offsetX:n,offsetY:s}=e;this._startOffsetX=n,this._startOffsetY=s;const i=t.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),o=this._manager.getPlugin().getSheetContainerControl().getContentRef(),a=e.clientY+i.y-this._leftTopHeight-o.current.getBoundingClientRect().top,l=(h=(c=t.getSkeleton())==null?void 0:c.rowHeightAccumulation)!=null?h:[];for(let f=0;f<(l==null?void 0:l.length);f++)if(l[f]>=a){this._index=f;break}this._currentHeight=l[0];let u=this._leftTopHeight;this._index&&(this._currentHeight=l[this._index]-l[this._index-1],u=this._leftTopHeight+l[this._index-1]),this._highlightItem.transformByState({height:this._currentHeight,top:u}),this._highlightItem.show()}unHighlightRowTitle(){this._highlightItem.hide()}}class _w{constructor(e){this._sheetView=e,this._selectionControls=[],this._selectionModels=new Map,this._startOffsetX=0,this._startOffsetY=0,this.hasSelection=!1,this._plugin=this._sheetView.getPlugin(),this._initialize(),this._initializeObserver()}getSheetView(){return this._sheetView}getScene(){return this._sheetView.getScene()}getContext(){return this._sheetView.getContext()}getMainComponent(){return this._mainComponent}updateToSheet(e){this._worksheet=e;const t=this.getWorksheetId();t&&(this._selectionModels.get(t)||this._selectionModels.set(t,[]))}getCurrentControls(){return this._selectionControls}getCurrentControl(){const e=this.getCurrentControls();if(e&&e.length>0){for(const t of e)if(t.model.currentCell)return t}}getCurrentModels(){const e=this.getWorksheetId();return e?(this._selectionModels.get(e)||this._selectionModels.set(e,[]),this._selectionModels.get(e)):void 0}getCurrentCellModel(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const n=t.currentCell;if(n)return n}}getCurrentModel(){const e=this.getCurrentModels();if(e&&e.length>0){for(const t of e)if(t.currentCell)return t}}getCurrentModelsValue(){const e=this.getCurrentModels();if(!e)return[];const t=[];for(let n of e)t.push(n.getValue());return t}renderCurrentControls(e){const t=this.getWorksheetId();if(t){if(this._selectionControls)for(let s of this._selectionControls)s.dispose();const n=e||this._selectionModels.get(t);this._selectionControls=[],n==null||n.forEach(s=>{const i=s.currentCell,o=this._mainComponent,a=Cs.create(this,this._selectionControls.length);let l=null;i&&(l=o.getCellByIndex(i.row,i.column));const{startRow:u,startColumn:c,endRow:h,endColumn:f}=s,d=o.getNoMergeCellPositionByIndex(u,c),m=o.getNoMergeCellPositionByIndex(h,f);a.update({startColumn:c,startRow:u,endColumn:f,endRow:h,startY:(d==null?void 0:d.startY)||0,endY:(m==null?void 0:m.endY)||0,startX:(d==null?void 0:d.startX)||0,endX:(m==null?void 0:m.endX)||0},l),this._selectionControls.push(a)}),this.setSelectionModel()}}getPlugin(){return this._plugin}getWorksheetId(){var e;return(e=this._worksheet)==null?void 0:e.getSheetId()}addControlToCurrentByRangeData(e,t){const n=this.getCurrentControls();if(!n)return;const s=this._mainComponent,i=Cs.create(this,n.length);let o=null;t&&(o=s.getCellByIndex(t.row,t.column));const{startRow:a,startColumn:l,endRow:u,endColumn:c}=e,h=s.getNoMergeCellPositionByIndex(a,l),f=s.getNoMergeCellPositionByIndex(u,c);i.update({startColumn:l,startRow:a,endColumn:c,endRow:u,startY:(h==null?void 0:h.startY)||0,endY:(f==null?void 0:f.endY)||0,startX:(h==null?void 0:h.startX)||0,endX:(f==null?void 0:f.endX)||0},o),n.push(i),this.setSelectionModel()}clearSelectionControls(){let e=this.getCurrentControls();if(e.length>0){for(let t of e)t.dispose();e.length=0}}setSelectionModel(e){if(!this._worksheet)return;e||(e=this._selectionControls.map(o=>o.model.getValue()));const t=this._worksheet.getContext().getWorkBook(),n=t.getCommandManager(),s={sheetId:this._worksheet.getSheetId(),actionName:Ls.SET_SELECTION_VALUE_ACTION,selections:e},i=new fe({WorkBookUnit:t},s);n.invoke(i)}updateSelectionModel(e,t,n){const s=this.getWorksheetId();if(!this._worksheet||!s)return;const i=this._selectionModels.get(s),o=[];i==null||i.forEach((h,f)=>{f===n?o.push({selection:e,cell:t}):o.push(h.getValue())});const a=this._worksheet.getContext().getWorkBook(),l=a.getCommandManager(),u={sheetId:this._worksheet.getSheetId(),actionName:Ls.SET_SELECTION_VALUE_ACTION,selections:o},c=new fe({WorkBookUnit:a},u);l.invoke(c)}setModels(e){const t=this.getWorksheetId();if(!t)return;const n=e.map(({selection:s,cell:i})=>{const o=new zo(yr.NORMAL,this._plugin);return o.setValue(s,i),o});this._selectionModels.set(t,n)}move(e){var u,c;const t=this.getCurrentCellModel();if(!t)return;let{row:n,column:s}=t;const i=((u=this._worksheet)==null?void 0:u.getRowCount())||1e3,o=((c=this._worksheet)==null?void 0:c.getColumnCount())||50;switch(e){case Q.TOP:n--,n<0&&(n=0);break;case Q.BOTTOM:n++,n>i&&(n=i);break;case Q.LEFT:s--,s<0&&(s=0);break;case Q.RIGHT:s++,s>o&&(s=o);break}let a={startRow:n,endRow:n,startColumn:s,endColumn:s},l={row:n,column:s};this.clearSelectionControls(),this.addControlToCurrentByRangeData(a,l)}_initialize(){this._mainComponent=this._sheetView.getSpreadsheet(),this._rowComponent=this._sheetView.getSpreadsheetRowTitle(),this._columnComponent=this._sheetView.getSpreadsheetColumnTitle(),this._leftTopComponent=this._sheetView.getSpreadsheetLeftTopPlaceholder(),this._mainEventInitial(),this._rowEventInitial(),this._columnEventInitial(),this._leftTopEventInitial(),this._worksheet=this.getContext().getWorkBook().getActiveSheet(),this._initModels(),this._dragLineControl=new gw(this),this._columnTitleControl=new mw(this),this._rowTitleControl=new pw(this)}_mainEventInitial(){const e=this._mainComponent;e.onPointerDownObserver.add(t=>{var I;const{offsetX:n,offsetY:s}=t;this._startOffsetX=n,this._startOffsetY=s;const i=e.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),o=e.calculateCellIndexByPosition(n,s,i),a=Ei(o);if(!a||!this._worksheet)return!1;const{startRow:l,startColumn:u,endColumn:c,endRow:h,startY:f,endY:d,startX:m,endX:g}=a,p={startColumn:u,startRow:l,endColumn:c,endRow:h,startY:f,endY:d,startX:m,endX:g};this._startSelectionRange=p;let _=this.getCurrentControl(),v=this.getCurrentControls();if(!v)return!1;for(let R of v){if(t.button===2&&R.model.isInclude(p)){_=R;return}if(R.model.isEqual(p)){_=R;break}t.shiftKey||R.clearHighlight()}if(v.length>0&&!t.ctrlKey&&!t.shiftKey){for(let R of v)R.dispose();v.length=0}const w=_&&_.model.currentCell;if(_&&t.shiftKey&&w){const{row:R,column:x}=w,S=e.getNoMergeCellPositionByIndex(R,x),k=e.getNoMergeCellPositionByIndex(h,c),N={startColumn:x,startRow:R,endColumn:p.startColumn,endRow:p.startRow,startY:(S==null?void 0:S.startY)||0,endY:(k==null?void 0:k.endY)||0,startX:(S==null?void 0:S.startX)||0,endX:(k==null?void 0:k.endX)||0};_.update(N,w)}else _=Cs.create(this,v.length),_.update(p,o),v.push(_);this.hasSelection=!0;const y=this.getScene();y.disableEvent();const A=Kr.create(this.getScene());A.startScroll(n,s),this.setSelectionModel(),(I=this._plugin.getObserver("onChangeSelectionObserver"))==null||I.notifyObservers(_),this._moveObserver=y.onPointerMoveObserver.add(R=>{this.moving(R,_);const{offsetX:x,offsetY:S}=R;A.scrolling(x,S,()=>{this.moving(R,_)})}),this._upObserver=y.onPointerUpObserver.add(R=>{this.up(),y.onPointerMoveObserver.remove(this._moveObserver),y.onPointerUpObserver.remove(this._upObserver),y.enableEvent(),A.stopScroll()})})}moving(e,t){var Y;const n=this._mainComponent,{offsetX:s,offsetY:i,clientX:o,clientY:a}=e,{startRow:l,startColumn:u,endRow:c,endColumn:h}=this._startSelectionRange,f=n.getAncestorScrollXY(this._startOffsetX,this._startOffsetY),d=n.calculateCellIndexByPosition(s,i,f),m=Ei(d);if(!m)return!1;const{startRow:g,startColumn:p,endColumn:_,endRow:v}=m,w=Math.min(g,l),y=Math.min(p,u),A=Math.max(v,c),I=Math.max(_,h),R=n.getSelectionBounding(w,y,A,I);if(!R)return!1;const{startRow:x,startColumn:S,endRow:k,endColumn:N}=R,O=n.getNoMergeCellPositionByIndex(x,S),D=n.getNoMergeCellPositionByIndex(k,N),E={startColumn:S,startRow:x,endColumn:N,endRow:k,startY:(O==null?void 0:O.startY)||0,endY:(D==null?void 0:D.endY)||0,startX:(O==null?void 0:O.startX)||0,endX:(D==null?void 0:D.endX)||0},{startRow:F,endRow:j,startColumn:L,endColumn:re}=(t==null?void 0:t.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};(L!==S||F!==x||re!==N||j!==k)&&(t&&t.update(E),this.setSelectionModel(),t&&((Y=this._plugin.getObserver("onChangeSelectionObserver"))==null||Y.notifyObservers(t)))}up(){this.setSelectionModel()}_rowEventInitial(){const e=this._rowComponent;e.onPointerDownObserver.add(t=>{this._rowTitleControl.pointerDown(t)}),e.onPointerEnterObserver.add(t=>{this._rowTitleControl.highlightRowTitle(t)}),e.onPointerMoveObserver.add(t=>{this._rowTitleControl.highlightRowTitle(t)}),e.onPointerLeaveObserver.add(()=>{this._rowTitleControl.unHighlightRowTitle()})}_columnEventInitial(){const e=this._columnComponent;e.onPointerDownObserver.add(t=>{this._columnTitleControl.pointerDown(t)}),e.onPointerEnterObserver.add(t=>{this._columnTitleControl.highlightColumnTitle(t)}),e.onPointerMoveObserver.add(t=>{this._columnTitleControl.highlightColumnTitle(t)}),e.onPointerLeaveObserver.add(()=>{this._columnTitleControl.unHighlightColumnTitle()})}_leftTopEventInitial(){this._leftTopComponent.onPointerDownObserver.add(t=>{console.log("leftTop_moveObserver",t)})}_initModels(){const e=this._plugin.config.selections;Object.keys(e).forEach(t=>{const n=e[t],s=[];n.forEach(i=>{const{startColumn:o,startRow:a,endColumn:l,endRow:u}=i.selection,c=i.cell,h=new zo(yr.NORMAL,this._plugin),f=c?{row:c.row,column:c.column,isMerged:!1,isMergedMainCell:!1,startY:0,endY:0,startX:0,endX:0,mergeInfo:{startColumn:o,startRow:a,endColumn:l,endRow:u,startY:0,endY:0,startX:0,endX:0}}:null;h.setValue({startColumn:o,startRow:a,endColumn:l,endRow:u,startY:0,endY:0,startX:0,endX:0},f),s.push(h)}),this._selectionModels.set(t,s)})}_initControls(){const e=this._plugin.config.selections;Object.keys(e).forEach(t=>{const n=e[t],s=[];n.forEach(i=>{const o=i.selection,a=i.cell,l=this._mainComponent,u=Cs.create(this,s.length);let c=null;a&&(c=l.getCellByIndex(a.row,a.column));const{startRow:h,startColumn:f,endRow:d,endColumn:m}=o,g=l.getNoMergeCellPositionByIndex(h,f),p=l.getNoMergeCellPositionByIndex(d,m);u.model.setValue({startColumn:f,startRow:h,endColumn:m,endRow:d,startY:(g==null?void 0:g.startY)||0,endY:(p==null?void 0:p.endY)||0,startX:(g==null?void 0:g.startX)||0,endX:(p==null?void 0:p.endX)||0},c),s.push(u)})})}_initializeObserver(){var t;this._plugin.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{this.renderCurrentControls()}),(t=this._worksheet)==null||t.getContext().getContextObserver("onSheetRenderDidMountObservable").add(()=>{this.renderCurrentControls()})}getActiveRangeListData(){const e=this.getCurrentModels();if(e&&e.length>0)return e==null?void 0:e.map(n=>({startRow:n.startRow,startColumn:n.startColumn,endRow:n.endRow,endColumn:n.endColumn}))}getActiveRangeList(){var t;const e=this.getActiveRangeListData();return e&&((t=this._worksheet)==null?void 0:t.getRangeList(e))}getActiveRangeData(){const e=this.getCurrentModels();if(e&&e.length>0){for(const t of e)if(t.currentCell)return{startRow:t.startRow,startColumn:t.startColumn,endRow:t.endRow,endColumn:t.endColumn}}}getActiveRange(){var t;const e=this.getActiveRangeData();return e&&((t=this._worksheet)==null?void 0:t.getRange(e))}getCurrentCellData(){const e=this.getCurrentModels();if(e&&e.length>0)for(const t of e){const n=t.currentCell;if(n)return{startRow:n.row,startColumn:n.column,endRow:n.row,endColumn:n.column}}}getCurrentCell(){var t;const e=this.getCurrentCellData();return e&&((t=this._worksheet)==null?void 0:t.getRange(e))}getDragLineControl(){return this._dragLineControl}}class bw extends ew{constructor(){super(...arguments),this.viewKey=jt.SHEET_VIEW}_initialize(){const e=this.getScene(),n=this.getContext().getWorkBook();let s=n.getActiveSheet();s||(s=n.getSheets()[0]);const i=this._buildSkeleton(s),{rowTotalHeight:o,columnTotalWidth:a,rowTitleWidth:l,columnTitleHeight:u}=i,c=new bp("__SpreadsheetRender__",i),h=new vp("__SpreadsheetRowTitle__",i),f=new Cp("__SpreadsheetColumnTitle__",i),d=new rt("__SpreadsheetLeftTopPlaceholder__",{zIndex:2,left:-1,top:-1,width:l,height:u,fill:xt([248,249,250]),stroke:xt([217,217,217]),strokeWidth:1});this._spreadsheetSkeleton=i,this._spreadsheet=c,this._spreadsheetRowTitle=h,this._spreadsheetColumnTitle=f,this._spreadsheetLeftTopPlaceholder=d,e.addObjects([c],0),e.addObjects([h,f,d],2),e.transformByState({width:this._columnWidthByTitle(s),height:this._rowHeightByTitle(s)+o}),this._updateViewport(l,u),this._selectionManager=new _w(this)}getSelectionManager(){return this._selectionManager}getSelectionControls(){return this._selectionManager.getCurrentControls()}getSpreadsheetSkeleton(){return this._spreadsheetSkeleton}getSpreadsheet(){return this._spreadsheet}getSpreadsheetRowTitle(){return this._spreadsheetRowTitle}getSpreadsheetColumnTitle(){return this._spreadsheetColumnTitle}getSpreadsheetLeftTopPlaceholder(){return this._spreadsheetLeftTopPlaceholder}updateToSheet(e){const t=this.getScene(),n=this._buildSkeleton(e),{rowTotalHeight:s,columnTotalWidth:i,rowTitleWidth:o,columnTitleHeight:a}=n;this._spreadsheetSkeleton=n,this._spreadsheet.updateSkeleton(n),this._spreadsheetRowTitle.updateSkeleton(n),this._spreadsheetColumnTitle.updateSkeleton(n),this._spreadsheetLeftTopPlaceholder.transformByState({width:o,height:a}),t.transformByState({width:this._columnWidthByTitle(e),height:this._rowHeightByTitle(e)+s}),this._updateViewport(o,a),this._selectionManager.updateToSheet(e)}_updateViewport(e,t){const n=this.getScene(),s=e*n.scaleX,i=t*n.scaleY,o=n.getViewport(jt.VIEW_MAIN),a=n.getViewport(jt.VIEW_TOP),l=n.getViewport(jt.VIEW_LEFT),u=n.getViewport(jt.VIEW_LEFT_TOP);o==null||o.resize({left:s,top:i}),a==null||a.resize({left:s,height:i}),l==null||l.resize({top:i,width:s}),u==null||u.resize({width:s,height:i})}_buildSkeleton(e){const t=this.getContext(),n=t.getWorkBook(),s=e.getConfig();return Ql.create(s,e.getCellMatrix(),n.getStyles(),t)}_rowHeightByTitle(e){const t=e==null?void 0:e.getConfig();return(t==null?void 0:t.columnTitle.height)||0}_columnWidthByTitle(e){const t=e==null?void 0:e.getConfig();return(t==null?void 0:t.rowTitle.width)||0}}class vw{create(e,t){return new bw().initialize(e,t)}}vg.add(new vw);ot.COLUMN,lt.PARAGRAPH,tn.WRAP_SQUARE,te.FALSE,Wn.BOTH_SIDES,Ct.START,Ct.START,Ct.START,Ct.START,Lt.ROMAN,Ct.START,Lt.ROMAN,Ct.START,Lt.ROMAN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,un.SUPERSCRIPT,q.TEXT_RUN,q.TEXT_RUN,q.DRAWING,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN;class Cw{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._initialize()}_initialize(){const e=this._engine,t=this._plugin.getContext(),n=t.getWorkBook();let s=n.getActiveSheet();s||(s=n.getSheets()[0]);const i=s.getConfig(),o=i.rowTitle,a=i.columnTitle,l=new Tp(jt.MAIN_SCENE,e,{width:1200,height:1e3});l.openTransformer(),this._scene=l;const u=new qi(jt.VIEW_MAIN,l,{left:o.width,top:a.height,bottom:0,right:0,isWheelPreventDefaultX:!0}),c=new qi(jt.VIEW_TOP,l,{left:o.width,top:0,height:a.height,right:0,isWheelPreventDefaultX:!0}),h=new qi(jt.VIEW_LEFT,l,{left:0,top:a.height,bottom:0,width:o.width,isWheelPreventDefaultX:!0}),f=new qi(jt.VIEW_LEFT_TOP,l,{left:0,top:0,width:o.width,height:a.height,isWheelPreventDefaultX:!0});u.onScrollAfterObserver.add(d=>{const{scrollX:m,scrollY:g,actualScrollX:p,actualScrollY:_}=d;c.updateScroll({scrollX:m,actualScrollX:p}).makeDirty(!0),h.updateScroll({scrollY:g,actualScrollY:_}).makeDirty(!0)}),t.getContextObserver("onZoomRatioSheetObservable").add(d=>{this._plugin,this._scene.scale(d.zoomRatio,d.zoomRatio)}),l.addViewport(u,h,c,f).attachControl(),l.on(Jt.wheel,(d,m)=>{const g=d;if(g.ctrlKey){const p=Math.abs(g.deltaX);let _=p<40?.2:p<80?.4:.2;if(_*=g.deltaY>0?-1:1,l.scaleX<1&&(_/=2),l.scaleX+_>4)l.scale(4,4);else if(l.scaleX+_<.1)l.scale(.1,.1);else{const v=t.getWorkBook().getActiveSheet(),w=g.deltaY>0?.1:-.1;v.setZoomRatio(v.getZoomRatio()+w),g.preventDefault()}}else u.onMouseWheel(g,m)}),new Gl(u),l.addLayer(il.create(l,[],0),il.create(l,[],2)),this._viewLoader(l,this._plugin),e.runRenderLoop(()=>{l.render();const d=document.getElementById("app");d&&(d.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getSheetView(){return this.getView(jt.SHEET_VIEW)}updateToSheet(e){for(let t of this._views)t.updateToSheet(e)}_viewLoader(e,t){vg.getData().forEach(n=>{this._views.push(n.create(e,t))})}}const Ew="#52c41a",ww="#faad14",Tw="#f5222d",yw="2px",Sw="1px",Aw="solid",Rw="1.5715",Dw="400",xw="14px",Iw="16px",Ow="12px",kw="1em",Nw="1em",Mw="#ffffff",Fw="#fafafa",Bw="#f5f5f5",Lw="#f0f0f0",Pw="#d9d9d9",Hw="#bfbfbf",Uw="#8c8c8c",zw="#595959",Ww="#434343",Vw="#262626",Gw="#1f1f1f",Xw="#141414",$w="#000000",Yw="#efefef",jw="#e0e0e0",Kw="#ececec",Zw="#cbcbcb",qw="#0188fb",Jw="#5391ff",Qw="#1890ff",e7="#fff",t7="14px",n7="#262626",r7="#333",s7="#8c8c8c",i7="#bfbfbf",o7="#f5f5f5",a7="#d9d9d9",l7="0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",u7="#bfbfbf";var c7={successColor:Ew,warningColor:ww,errorColor:Tw,borderRadiusBase:yw,borderWidthBase:Sw,borderStyleBase:Aw,lineHeightBase:Rw,fontWeight:Dw,fontSizeBase:xw,fontSizeLg:Iw,fontSizeSm:Ow,paddingBase:kw,marginBase:Nw,gray1:Mw,gray2:Fw,gray3:Bw,gray4:Lw,gray5:Pw,gray6:Hw,gray7:Uw,gray8:zw,gray9:Ww,gray10:Vw,gray11:Gw,gray12:Xw,gray13:$w,gray14:Yw,gray15:jw,gray16:Kw,gray17:Zw,primaryColor:qw,primaryColorHover:Jw,linkColor:Qw,bg:e7,fontSize:t7,headingColor:n7,textColor:r7,textColorSecondary:s7,disabledColor:i7,disabledBg:o7,borderColorBase:a7,boxShadowBase:l7,borderColorBaseHover:u7};const h7="#52c41a",d7="#faad14",f7="#f5222d",g7="2px",m7="1px",p7="solid",_7="1.5715",b7="400",v7="14px",C7="16px",E7="12px",w7="1em",T7="1em",y7="#ffffff",S7="#fafafa",A7="#f5f5f5",R7="#f0f0f0",D7="#d9d9d9",x7="#bfbfbf",I7="#8c8c8c",O7="#595959",k7="#434343",N7="#262626",M7="#1f1f1f",F7="#141414",B7="#000000",L7="#efefef",P7="#e0e0e0",H7="#ececec",U7="#cbcbcb",z7="#0188fb",W7="#5391ff",V7="#1890ff",G7="#0d1117",X7="14px",$7="rgba(255, 255, 255, 0.85)",Y7="#8b949e",j7="rgba(255, 255, 255, 0.45)",K7="rgba(255, 255, 255, 0.25)",Z7="rgba(255, 255, 255, 0.04)",q7="rgba(255, 255, 255, 0.15)",J7="0 3px 6px -4px rgba(255, 255, 255, 0.12), 0 6px 16px 0 rgba(255, 255, 255, 0.08), 0 9px 28px 8px rgba(255, 255, 255, 0.05)",Q7="#bfbfbf";var eT={successColor:h7,warningColor:d7,errorColor:f7,borderRadiusBase:g7,borderWidthBase:m7,borderStyleBase:p7,lineHeightBase:_7,fontWeight:b7,fontSizeBase:v7,fontSizeLg:C7,fontSizeSm:E7,paddingBase:w7,marginBase:T7,gray1:y7,gray2:S7,gray3:A7,gray4:R7,gray5:D7,gray6:x7,gray7:I7,gray8:O7,gray9:k7,gray10:N7,gray11:M7,gray12:F7,gray13:B7,gray14:L7,gray15:P7,gray16:H7,gray17:U7,primaryColor:z7,primaryColorHover:W7,linkColor:V7,bg:G7,fontSize:X7,headingColor:$7,textColor:Y7,textColorSecondary:j7,disabledColor:K7,disabledBg:Z7,borderColorBase:q7,boxShadowBase:J7,borderColorBaseHover:Q7};const tT="#52c41a",nT="#faad14",rT="#f5222d",sT="2px",iT="1px",oT="solid",aT="1.5715",lT="400",uT="14px",cT="16px",hT="12px",dT="1em",fT="1em",gT="#ffffff",mT="#fafafa",pT="#f5f5f5",_T="#f0f0f0",bT="#d9d9d9",vT="#bfbfbf",CT="#8c8c8c",ET="#595959",wT="#434343",TT="#262626",yT="#1f1f1f",ST="#141414",AT="#000000",RT="#efefef",DT="#e0e0e0",xT="#ececec",IT="#cbcbcb",OT="#004b1c",kT="#0e5c2f",NT="#217346",MT="#fff",FT="14px",BT="rgba(0, 0, 0, 0.85)",LT="rgba(0, 0, 0, 0.65)",PT="rgba(0, 0, 0, 0.45)",HT="rgba(0, 0, 0, 0.25)",UT="rgba(0, 0, 0, 0.04)",zT="rgba(0, 0, 0, 0.15)",WT="0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",VT="#bfbfbf";var GT={successColor:tT,warningColor:nT,errorColor:rT,borderRadiusBase:sT,borderWidthBase:iT,borderStyleBase:oT,lineHeightBase:aT,fontWeight:lT,fontSizeBase:uT,fontSizeLg:cT,fontSizeSm:hT,paddingBase:dT,marginBase:fT,gray1:gT,gray2:mT,gray3:pT,gray4:_T,gray5:bT,gray6:vT,gray7:CT,gray8:ET,gray9:wT,gray10:TT,gray11:yT,gray12:ST,gray13:AT,gray14:RT,gray15:DT,gray16:xT,gray17:IT,primaryColor:OT,primaryColorHover:kT,linkColor:NT,bg:MT,fontSize:FT,headingColor:BT,textColor:LT,textColorSecondary:PT,disabledColor:HT,disabledBg:UT,borderColorBase:zT,boxShadowBase:WT,borderColorBaseHover:VT};/*!
 * css-vars-ponyfill
 * v2.4.8
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function Qt(){return Qt=Object.assign?Object.assign.bind():function(r){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(r[n]=t[n])}return r},Qt.apply(this,arguments)}/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function fh(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={mimeType:e.mimeType||null,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},n=Array.isArray(r)?r:[r],s=Array.apply(null,Array(n.length)).map(function(u){return null});function i(u){var c=typeof u=="string",h=c&&u.trim().charAt(0)==="<";return c&&!h}function o(u,c){t.onError(u,n[c],c)}function a(u,c){var h=t.onSuccess(u,n[c],c);u=h===!1?"":h||u,s[c]=u,s.indexOf(null)===-1&&t.onComplete(s)}var l=document.createElement("a");n.forEach(function(u,c){l.setAttribute("href",u),l.href=String(l.href);var h=Boolean(document.all&&!window.atob),f=h&&l.host.split(":")[0]!==location.host.split(":")[0];if(f){var d=l.protocol===location.protocol;if(d){var m=new XDomainRequest;m.open("GET",u),m.timeout=0,m.onprogress=Function.prototype,m.ontimeout=Function.prototype,m.onload=function(){var p=m.responseText;i(p)?a(p,c):o(m,c)},m.onerror=function(p){o(m,c)},setTimeout(function(){m.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(u,")")),o(null,c)}else{var g=new XMLHttpRequest;g.open("GET",u),t.mimeType&&g.overrideMimeType&&g.overrideMimeType(t.mimeType),t.onBeforeSend(g,u,c),g.onreadystatechange=function(){if(g.readyState===4){var p=g.responseText;g.status<400&&i(p)||g.status===0&&i(p)?a(p,c):o(g,c)}},g.send()}})}/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function gh(r){var e={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},t={rootElement:r.rootElement||document,include:r.include||'style,link[rel="stylesheet"]',exclude:r.exclude||null,filter:r.filter||null,skipDisabled:r.skipDisabled!==!1,useCSSOM:r.useCSSOM||!1,onBeforeSend:r.onBeforeSend||Function.prototype,onSuccess:r.onSuccess||Function.prototype,onError:r.onError||Function.prototype,onComplete:r.onComplete||Function.prototype},n=Array.apply(null,t.rootElement.querySelectorAll(t.include)).filter(function(u){return!XT(u,t.exclude)}),s=Array.apply(null,Array(n.length)).map(function(u){return null});function i(){var u=s.indexOf(null)===-1;if(u){s.reduce(function(h,f,d){return f===""&&h.push(d),h},[]).reverse().forEach(function(h){return[n,s].forEach(function(f){return f.splice(h,1)})});var c=s.join("");t.onComplete(c,s,n)}}function o(u,c,h,f){var d=t.onSuccess(u,h,f);u=d!==void 0&&Boolean(d)===!1?"":d||u,l(u,h,f,function(m,g){s[c]===null&&(g.forEach(function(p){return t.onError(p.xhr,h,p.url)}),!t.filter||t.filter.test(m)?s[c]=m:s[c]="",i())})}function a(u,c){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],f={};return f.rules=(u.replace(e.cssComments,"").match(e.cssImports)||[]).filter(function(d){return h.indexOf(d)===-1}),f.urls=f.rules.map(function(d){return d.replace(e.cssImports,"$1")}),f.absoluteUrls=f.urls.map(function(d){return Ha(d,c)}),f.absoluteRules=f.rules.map(function(d,m){var g=f.urls[m],p=Ha(f.absoluteUrls[m],c);return d.replace(g,p)}),f}function l(u,c,h,f){var d=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],m=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],g=a(u,h,m);g.rules.length?fh(g.absoluteUrls,{onBeforeSend:function(_,v,w){t.onBeforeSend(_,c,v)},onSuccess:function(_,v,w){var y=t.onSuccess(_,c,v);_=y===!1?"":y||_;var A=a(_,v,m);return A.rules.forEach(function(I,R){_=_.replace(I,A.absoluteRules[R])}),_},onError:function(_,v,w){d.push({xhr:_,url:v}),m.push(g.rules[w]),l(u,c,h,f,d,m)},onComplete:function(_){_.forEach(function(v,w){u=u.replace(g.rules[w],v)}),l(u,c,h,f,d,m)}}):f(u,d)}n.length?n.forEach(function(u,c){var h=u.getAttribute("href"),f=u.getAttribute("rel"),d=u.nodeName.toLowerCase()==="link"&&h&&f&&f.toLowerCase().indexOf("stylesheet")!==-1,m=t.skipDisabled===!1?!1:u.disabled,g=u.nodeName.toLowerCase()==="style";if(d&&!m){var p=h.indexOf("data:text/css")!==-1;if(p){var _=decodeURIComponent(h.substring(h.indexOf(",")+1));t.useCSSOM&&(_=Array.apply(null,u.sheet.cssRules).map(function(w){return w.cssText}).join("")),o(_,c,u,location.href)}else fh(h,{mimeType:"text/css",onBeforeSend:function(y,A,I){t.onBeforeSend(y,u,A)},onSuccess:function(y,A,I){var R=Ha(h);o(y,c,u,R)},onError:function(y,A,I){s[c]="",t.onError(y,u,A),i()}})}else if(g&&!m){var v=u.textContent;t.useCSSOM&&(v=Array.apply(null,u.sheet.cssRules).map(function(w){return w.cssText}).join("")),o(v,c,u,location.href)}else s[c]="",i()}):t.onComplete("",[])}function Ha(r,e){var t=document.implementation.createHTMLDocument(""),n=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(s),n.href=e||document.baseURI||(document.querySelector("base")||{}).href||location.href,s.href=r,s.href}function XT(r,e){var t=r.matches||r.matchesSelector||r.webkitMatchesSelector||r.mozMatchesSelector||r.msMatchesSelector||r.oMatchesSelector;return t.call(r,e)}var yg=Sg;function Sg(r,e,t){r instanceof RegExp&&(r=mh(r,t)),e instanceof RegExp&&(e=mh(e,t));var n=Ag(r,e,t);return n&&{start:n[0],end:n[1],pre:t.slice(0,n[0]),body:t.slice(n[0]+r.length,n[1]),post:t.slice(n[1]+e.length)}}function mh(r,e){var t=e.match(r);return t?t[0]:null}Sg.range=Ag;function Ag(r,e,t){var n,s,i,o,a,l=t.indexOf(r),u=t.indexOf(e,l+1),c=l;if(l>=0&&u>0){if(r===e)return[l,u];for(n=[],i=t.length;c>=0&&!a;)c==l?(n.push(c),l=t.indexOf(r,c+1)):n.length==1?a=[n.pop(),u]:(s=n.pop(),s<i&&(i=s,o=u),u=t.indexOf(e,c+1)),c=l<u&&l>=0?l:u;n.length&&(a=[i,o])}return a}function bu(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,removeComments:!1},n=Qt({},t,e),s=[];function i(D){throw new Error("CSS parse error: ".concat(D))}function o(D){var E=D.exec(r);if(E)return r=r.slice(E[0].length),E}function a(){return o(/^{\s*/)}function l(){return o(/^}/)}function u(){o(/^\s*/)}function c(){if(u(),!(r[0]!=="/"||r[1]!=="*")){for(var D=2;r[D]&&(r[D]!=="*"||r[D+1]!=="/");)D++;if(!r[D])return i("end of comment is missing");var E=r.slice(2,D);return r=r.slice(D+2),{type:"comment",comment:E}}}function h(){for(var D=[],E;E=c();)D.push(E);return n.removeComments?[]:D}function f(){for(u();r[0]==="}";)i("extra closing bracket");var D=o(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(D){var E=D[0].trim(),F,j=/\/\*/.test(E);j&&(E=E.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var L=/["']\w*,\w*["']/.test(E);L&&(E=E.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(Y){return Y.replace(/,/g,"\u200C")}));var re=/,/.test(E);return re?F=E.split(/\s*(?![^(]*\)),\s*/):F=[E],L&&(F=F.map(function(Y){return Y.replace(/\u200C/g,",")})),F}}function d(){if(r[0]==="@")return k();o(/^([;\s]*)+/);var D=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,E=o(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(!!E){if(E=E[0].trim(),!o(/^:\s*/))return i("property missing ':'");var F=o(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),j={type:"declaration",property:E.replace(D,""),value:F?F[0].replace(D,"").trim():""};return o(/^[;\s]*/),j}}function m(){if(!a())return i("missing '{'");for(var D,E=h();D=d();)E.push(D),E=E.concat(h());return l()?E:i("missing '}'")}function g(){u();for(var D=[],E;E=o(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)D.push(E[1]),o(/^,\s*/);if(D.length)return{type:"keyframe",values:D,declarations:m()}}function p(){var D=o(/^@([-\w]+)?keyframes\s*/);if(!!D){var E=D[1];if(D=o(/^([-\w]+)\s*/),!D)return i("@keyframes missing name");var F=D[1];if(!a())return i("@keyframes missing '{'");for(var j,L=h();j=g();)L.push(j),L=L.concat(h());return l()?{type:"keyframes",name:F,vendor:E,keyframes:L}:i("@keyframes missing '}'")}}function _(){var D=o(/^@page */);if(D){var E=f()||[];return{type:"page",selectors:E,declarations:m()}}}function v(){var D=o(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(D){var E="".concat(D[1],"-").concat(D[2])+(D[3]?"-".concat(D[3]):"");return{type:"page-margin-box",name:E,declarations:m()}}}function w(){var D=o(/^@font-face\s*/);if(D)return{type:"font-face",declarations:m()}}function y(){var D=o(/^@supports *([^{]+)/);if(D)return{type:"supports",supports:D[1].trim(),rules:O()}}function A(){var D=o(/^@host\s*/);if(D)return{type:"host",rules:O()}}function I(){var D=o(/^@media([^{]+)*/);if(D)return{type:"media",media:(D[1]||"").trim(),rules:O()}}function R(){var D=o(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(D)return{type:"custom-media",name:D[1].trim(),media:D[2].trim()}}function x(){var D=o(/^@([-\w]+)?document *([^{]+)/);if(D)return{type:"document",document:D[2].trim(),vendor:D[1]?D[1].trim():null,rules:O()}}function S(){var D=o(/^@(import|charset|namespace)\s*([^;]+);/);if(D)return{type:D[1],name:D[2].trim()}}function k(){if(u(),r[0]==="@"){var D=S()||w()||I()||p()||y()||x()||R()||A()||_()||v();if(D&&!n.preserveStatic){var E=!1;if(D.declarations)E=D.declarations.some(function(j){return/var\(/.test(j.value)});else{var F=D.keyframes||D.rules||[];E=F.some(function(j){return(j.declarations||[]).some(function(L){return/var\(/.test(L.value)})})}return E?D:{}}return D}}function N(){if(!n.preserveStatic){var D=yg("{","}",r);if(D){var E=/:(?:root|host)(?![.:#(])/.test(D.pre)&&/--\S*\s*:/.test(D.body),F=/var\(/.test(D.body);if(!E&&!F)return r=r.slice(D.end+1),{}}}var j=f()||[],L=n.preserveStatic?m():m().filter(function(re){var Y=j.some(function(U){return/:(?:root|host)(?![.:#(])/.test(U)})&&/^--\S/.test(re.property),ee=/var\(/.test(re.value);return Y||ee});return j.length||i("selector missing"),{type:"rule",selectors:j,declarations:L}}function O(D){if(!D&&!a())return i("missing '{'");for(var E,F=h();r.length&&(D||r[0]!=="}")&&(E=k()||N());)E.type&&F.push(E),F=F.concat(h());return!D&&!l()?i("missing '}'"):F}return{type:"stylesheet",stylesheet:{rules:O(!0),errors:s}}}function ph(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={parseHost:!1,store:{},onWarning:function(){}},n=Qt({},t,e),s=new RegExp(":".concat(n.parseHost?"host":"root","$"));return typeof r=="string"&&(r=bu(r,n)),r.stylesheet.rules.forEach(function(i){i.type!=="rule"||!i.selectors.some(function(o){return s.test(o)})||i.declarations.forEach(function(o,a){var l=o.property,u=o.value;l&&l.indexOf("--")===0&&(n.store[l]=u)})}),n.store}function Rg(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,n={charset:function(o){return"@charset "+o.name+";"},comment:function(o){return o.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+o.comment+"*/":""},"custom-media":function(o){return"@custom-media "+o.name+" "+o.media+";"},declaration:function(o){return o.property+":"+o.value+";"},document:function(o){return"@"+(o.vendor||"")+"document "+o.document+"{"+s(o.rules)+"}"},"font-face":function(o){return"@font-face{"+s(o.declarations)+"}"},host:function(o){return"@host{"+s(o.rules)+"}"},import:function(o){return"@import "+o.name+";"},keyframe:function(o){return o.values.join(",")+"{"+s(o.declarations)+"}"},keyframes:function(o){return"@"+(o.vendor||"")+"keyframes "+o.name+"{"+s(o.keyframes)+"}"},media:function(o){return"@media "+o.media+"{"+s(o.rules)+"}"},namespace:function(o){return"@namespace "+o.name+";"},page:function(o){return"@page "+(o.selectors.length?o.selectors.join(", "):"")+"{"+s(o.declarations)+"}"},"page-margin-box":function(o){return"@"+o.name+"{"+s(o.declarations)+"}"},rule:function(o){var a=o.declarations;if(a.length)return o.selectors.join(",")+"{"+s(a)+"}"},supports:function(o){return"@supports "+o.supports+"{"+s(o.rules)+"}"}};function s(i){for(var o="",a=0;a<i.length;a++){var l=i[a];t&&t(l);var u=n[l.type](l);u&&(o+=u,u.length&&l.selectors&&(o+=e))}return o}return s(r.stylesheet.rules)}function Dg(r,e){r.rules.forEach(function(t){if(t.rules){Dg(t,e);return}if(t.keyframes){t.keyframes.forEach(function(n){n.type==="keyframe"&&e(n.declarations,t)});return}!t.declarations||e(t.declarations,r)})}var $T="--",YT="var";function jT(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},n=Qt({},t,e);return typeof r=="string"&&(r=bu(r,n)),Dg(r.stylesheet,function(s,i){for(var o=0;o<s.length;o++){var a=s[o],l=a.type,u=a.property,c=a.value;if(l==="declaration"){if(!n.preserveVars&&u&&u.indexOf($T)===0){s.splice(o,1),o--;continue}if(c.indexOf(YT+"(")!==-1){var h=oi(c,n);h!==a.value&&(h=KT(h),n.preserveVars?(s.splice(o,0,{type:l,property:u,value:h}),o++):a.value=h)}}}}),Rg(r)}function KT(r){var e=/calc\(([^)]+)\)/g;return(r.match(e)||[]).forEach(function(t){var n="calc".concat(t.split("calc").join(""));r=r.replace(t,n)}),r}function oi(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;if(r.indexOf("var(")===-1)return r;var n=yg("(",")",r);function s(o){var a=o.split(",")[0].replace(/[\s\n\t]/g,""),l=(o.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],u=Object.prototype.hasOwnProperty.call(e.variables,a)?String(e.variables[a]):void 0,c=u||(l?String(l):void 0),h=t||o;return u||e.onWarning('variable "'.concat(a,'" is undefined')),c&&c!=="undefined"&&c.length>0?oi(c,e,h):"var(".concat(h,")")}if(n)if(n.pre.slice(-3)==="var"){var i=n.body.trim().length===0;return i?(e.onWarning("var() must contain a non-whitespace string"),r):n.pre.slice(0,-3)+s(n.body)+oi(n.post,e)}else return n.pre+"(".concat(oi(n.body,e),")")+oi(n.post,e);else return r.indexOf("var(")!==-1&&e.onWarning('missing closing ")" in the value "'.concat(r,'"')),r}var aa=typeof window!="undefined",_h=aa&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),Wr={group:0,job:0},no={rootElement:aa?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},Hn={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},wt={dom:{},job:{},user:{}},Ro=!1,ln=null,ai=0,_l=null,bl=!1;/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (—), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */function Qn(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e="cssVars(): ",t=Qt({},no,r);function n(c,h,f,d){!t.silent&&window.console&&console.error("".concat(e).concat(c,`
`),h),t.onError(c,h,f,d)}function s(c){!t.silent&&window.console&&console.warn("".concat(e).concat(c)),t.onWarning(c)}function i(c){t.onFinally(Boolean(c),_h,Ua()-t.__benchmark)}if(!!aa){if(t.watch){t.watch=no.watch,ZT(t),Qn(t);return}else t.watch===!1&&ln&&(ln.disconnect(),ln=null);if(!t.__benchmark){if(Ro===t.rootElement){qT(r);return}var o=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(t.__benchmark=Ua(),t.exclude=[ln?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",t.exclude].filter(function(c){return c}).join(","),t.variables=ey(t.variables),o.forEach(function(c){var h=c.nodeName.toLowerCase()==="style"&&c.__cssVars.text,f=h&&c.textContent!==c.__cssVars.text;h&&f&&(c.sheet&&(c.sheet.disabled=!1),c.setAttribute("data-cssvars",""))}),!ln){var a=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars="out"]'));a.forEach(function(c){var h=c.getAttribute("data-cssvars-group"),f=h?t.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(h,'"]')):null;f||c.parentNode.removeChild(c)}),ai&&o.length<ai&&(ai=o.length,wt.dom={})}}if(document.readyState!=="loading")if(_h&&t.onlyLegacy){var l=!1;if(t.updateDOM){var u=t.rootElement.host||(t.rootElement===document?document.documentElement:t.rootElement);Object.keys(t.variables).forEach(function(c){var h=t.variables[c];l=l||h!==getComputedStyle(u).getPropertyValue(c),u.style.setProperty(c,h)})}i(l)}else!bl&&(t.shadowDOM||t.rootElement.shadowRoot||t.rootElement.host)?gh({rootElement:no.rootElement,include:no.include,exclude:t.exclude,skipDisabled:!1,onSuccess:function(h,f,d){var m=(f.sheet||{}).disabled&&!f.__cssVars;return m?!1:(h=h.replace(Hn.cssComments,"").replace(Hn.cssMediaQueries,""),h=(h.match(Hn.cssVarDeclRules)||[]).join(""),h||!1)},onComplete:function(h,f,d){ph(h,{store:wt.dom,onWarning:s}),bl=!0,Qn(t)}}):(Ro=t.rootElement,gh({rootElement:t.rootElement,include:t.include,exclude:t.exclude,skipDisabled:!1,onBeforeSend:t.onBeforeSend,onError:function(h,f,d){var m=h.responseURL||xg(d,location.href),g=h.statusText?"(".concat(h.statusText,")"):"Unspecified Error"+(h.status===0?" (possibly CORS related)":""),p="CSS XHR Error: ".concat(m," ").concat(h.status," ").concat(g);n(p,f,h,m)},onSuccess:function(h,f,d){var m=(f.sheet||{}).disabled&&!f.__cssVars;if(m)return!1;var g=f.nodeName.toLowerCase()==="link",p=f.nodeName.toLowerCase()==="style"&&h!==f.textContent,_=t.onSuccess(h,f,d);return h=_!==void 0&&Boolean(_)===!1?"":_||h,t.updateURLs&&(g||p)&&(h=QT(h,d)),h},onComplete:function(h,f){var d=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],m=Qt({},wt.dom,wt.user),g=!1;if(wt.job={},d.forEach(function(R,x){var S=f[x];if(R.__cssVars=R.__cssVars||{},R.__cssVars.text=S,Hn.cssVars.test(S))try{var k=bu(S,{preserveStatic:t.preserveStatic,removeComments:!0});ph(k,{parseHost:Boolean(t.rootElement.host),store:wt.dom,onWarning:s}),R.__cssVars.tree=k}catch(N){n(N.message,R)}}),Qt(wt.job,wt.dom),t.updateDOM?(Qt(wt.user,t.variables),Qt(wt.job,wt.user)):(Qt(wt.job,wt.user,t.variables),Qt(m,t.variables)),g=Wr.job>0&&Boolean(Object.keys(wt.job).length>Object.keys(m).length||Boolean(Object.keys(m).length&&Object.keys(wt.job).some(function(R){return wt.job[R]!==m[R]}))),g)vl(t.rootElement),Qn(t);else{var p=[],_=[],v=!1;if(t.updateDOM&&Wr.job++,d.forEach(function(R,x){var S=!R.__cssVars.tree;if(R.__cssVars.tree)try{jT(R.__cssVars.tree,Qt({},t,{variables:wt.job,onWarning:s}));var k=Rg(R.__cssVars.tree);if(t.updateDOM){var N=f[x],O=Hn.cssVarFunc.test(N);if(R.getAttribute("data-cssvars")||R.setAttribute("data-cssvars","src"),k.length&&O){var D=R.getAttribute("data-cssvars-group")||++Wr.group,E=k.replace(/\s/g,""),F=t.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(D,'"]'))||document.createElement("style");v=v||Hn.cssKeyframes.test(k),t.preserveStatic&&R.sheet&&(R.sheet.disabled=!0),F.hasAttribute("data-cssvars")||F.setAttribute("data-cssvars","out"),E===R.textContent.replace(/\s/g,"")?(S=!0,F&&F.parentNode&&(R.removeAttribute("data-cssvars-group"),F.parentNode.removeChild(F))):E!==F.textContent.replace(/\s/g,"")&&([R,F].forEach(function(j){j.setAttribute("data-cssvars-job",Wr.job),j.setAttribute("data-cssvars-group",D)}),F.textContent=k,p.push(k),_.push(F),F.parentNode||R.parentNode.insertBefore(F,R.nextSibling))}}else R.textContent.replace(/\s/g,"")!==k&&p.push(k)}catch(j){n(j.message,R)}S&&R.setAttribute("data-cssvars","skip"),R.hasAttribute("data-cssvars-job")||R.setAttribute("data-cssvars-job",Wr.job)}),ai=t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,t.shadowDOM){for(var w=[].concat(t.rootElement).concat([].slice.call(t.rootElement.querySelectorAll("*"))),y=0,A;A=w[y];++y)if(A.shadowRoot&&A.shadowRoot.querySelector("style")){var I=Qt({},t,{rootElement:A.shadowRoot});Qn(I)}}t.updateDOM&&v&&JT(t.rootElement),Ro=!1,t.onComplete(p.join(""),_,JSON.parse(JSON.stringify(wt.job)),Ua()-t.__benchmark),i(_.length)}}}));else document.addEventListener("DOMContentLoaded",function c(h){Qn(r),document.removeEventListener("DOMContentLoaded",c)})}}Qn.reset=function(){Wr.job=0,Wr.group=0,Ro=!1,ln&&(ln.disconnect(),ln=null),ai=0,_l=null,bl=!1;for(var r in wt)wt[r]={}};function ZT(r){function e(l){var u=t(l)&&l.hasAttribute("disabled"),c=(l.sheet||{}).disabled;return u||c}function t(l){var u=l.nodeName.toLowerCase()==="link"&&(l.getAttribute("rel")||"").indexOf("stylesheet")!==-1;return u}function n(l){return l.nodeName.toLowerCase()==="style"}function s(l){var u=!1;if(l.type==="attributes"&&t(l.target)&&!e(l.target)){var c=l.attributeName==="disabled",h=l.attributeName==="href",f=l.target.getAttribute("data-cssvars")==="skip",d=l.target.getAttribute("data-cssvars")==="src";c?u=!f&&!d:h&&(f?l.target.setAttribute("data-cssvars",""):d&&vl(r.rootElement,!0),u=!0)}return u}function i(l){var u=!1;if(l.type==="childList"){var c=n(l.target),h=l.target.getAttribute("data-cssvars")==="out";u=c&&!h}return u}function o(l){var u=!1;return l.type==="childList"&&(u=[].slice.call(l.addedNodes).some(function(c){var h=c.nodeType===1,f=h&&c.hasAttribute("data-cssvars"),d=n(c)&&Hn.cssVars.test(c.textContent),m=!f&&(t(c)||d);return m&&!e(c)})),u}function a(l){var u=!1;return l.type==="childList"&&(u=[].slice.call(l.removedNodes).some(function(c){var h=c.nodeType===1,f=h&&c.getAttribute("data-cssvars")==="out",d=h&&c.getAttribute("data-cssvars")==="src",m=d;if(d||f){var g=c.getAttribute("data-cssvars-group"),p=r.rootElement.querySelector('[data-cssvars-group="'.concat(g,'"]'));d&&vl(r.rootElement,!0),p&&p.parentNode.removeChild(p)}return m})),u}!window.MutationObserver||(ln&&(ln.disconnect(),ln=null),ln=new MutationObserver(function(l){var u=l.some(function(c){return s(c)||i(c)||o(c)||a(c)});u&&Qn(r)}),ln.observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function qT(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;clearTimeout(_l),_l=setTimeout(function(){r.__benchmark=null,Qn(r)},e)}function JT(r){var e=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(f){return getComputedStyle(document.body)[f]})[0];if(e){for(var t=[].slice.call(r.querySelectorAll("*")),n=[],s="__CSSVARSPONYFILL-KEYFRAMES__",i=0,o=t.length;i<o;i++){var a=t[i],l=getComputedStyle(a)[e];l!=="none"&&(a.style[e]+=s,n.push(a))}document.body.offsetHeight;for(var u=0,c=n.length;u<c;u++){var h=n[u].style;h[e]=h[e].replace(s,"")}}}function QT(r,e){var t=r.replace(Hn.cssComments,"").match(Hn.cssUrls)||[];return t.forEach(function(n){var s=n.replace(Hn.cssUrls,"$1"),i=xg(s,e);r=r.replace(n,n.replace(s,i))}),r}function ey(){var r=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=/^-{2}/;return Object.keys(r).reduce(function(t,n){var s=e.test(n)?n:"--".concat(n.replace(/^-+/,""));return t[s]=r[n],t},{})}function xg(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:location.href,t=document.implementation.createHTMLDocument(""),n=t.createElement("base"),s=t.createElement("a");return t.head.appendChild(n),t.body.appendChild(s),n.href=e,s.href=r,s.href}function Ua(){return aa&&(window.performance||{}).now?window.performance.now():new Date().getTime()}function vl(r){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=[].slice.call(r.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));t.forEach(function(n){return n.setAttribute("data-cssvars","")}),e&&(wt.dom={})}const ty="univer-context-menu",ny="univer-cols-menu",ry="univer-cols-menuitem",sy="univer-btn",iy="univer-right-menu-center",oy="univer-right-menu-item";var Wo={contextMenu:ty,colsMenu:ny,colsMenuitem:ry,btn:sy,rightMenuCenter:iy,rightMenuItem:oy};class ay extends Xe{constructor(){super(...arguments),this.ulRef=Ve(),this.root=Ve(),this.handleContextMenu=async(e,t,n)=>{e.preventDefault(),this.setState({visible:!0,srcElement:e.target,eventType:e.type},()=>{new Promise((s,i)=>{this.ulRef.current.showMenu(!0),s()}).then(()=>{const s=n?t.x:e.clientX,i=n?t.y:e.clientY,o=window.innerWidth,a=window.innerHeight,l=this.ulRef.current.base.offsetWidth,u=this.ulRef.current.base.offsetHeight,c=o-s>l,h=!c,f=a-i>u,d=!f;c&&(this.root.current.style.left=`${s}px`),h&&(this.root.current.style.left=`${s-l}px`),f&&(this.root.current.style.top=`${i}px`),d&&(this.root.current.style.top=`${i-u}px`)})})},this.handleClick=e=>{const{visible:t,eventType:n,srcElement:s}=this.state;!this.root.current||n==="click"&&s&&s.contains(e.target)||this.root.current.contains(e.target)||t&&this.setState({visible:!1})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={visible:!1,srcElement:null,eventType:null,children:[]}}resetMenuList(e){var n;const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);for(let s=0;s<e.length;s++){const i=e[s];if(i.customLabel){const o=t.getRegisterComponent(i.customLabel.name),a=(n=i.customLabel.props)!=null?n:{};o&&(i.label=b(o,{...a}))}i.children&&(i.children=this.resetMenuList(i.children))}return e}setMenuList(e){this.setState({children:this.resetMenuList(e)})}componentDidMount(){var e;document.addEventListener("click",this.handleClick),(e=this._context.getObserverManager().getObserver("onRightMenuDidMountObservable",Je.SPREADSHEET))==null||e.notifyObservers(this)}componentWillUnmount(){document.removeEventListener("click",this.handleClick)}showRightMenu(e){this.ulRef.current.showMenu(e)}render(){if(!this.state.children.length)return;const e={...this.props.style},{visible:t}=this.state,n=this._render.renderFunction("Menu");return t&&b("div",{ref:this.root,className:Wo.contextMenu,style:e,onContextMenu:s=>{s.preventDefault()}},b(n,{ref:this.ulRef,menu:this.state.children,onClick:this.handleClick}))}}class hs extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e,children:t}=this.props,n=this._render.renderFunction("Button");return b("div",null,e,t.map(s=>b(n,{type:"primary"},s.label)))}}class hr extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}handleClick(e){e.stopPropagation()}handleKeyUp(e){const{onKeyUp:t}=this.props;t==null||t(e)}render(){const{prefix:e,suffix:t}=this.props,n=this._render.renderFunction("Input");return b("div",null,e,b(n,{onKeyUp:this.handleKeyUp.bind(this),type:"number",placeholder:"1",onClick:this.handleClick}),t)}}class li extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e}=this.props,t=this._render.renderFunction("RightIcon");return b("div",{className:Wo.rightMenuItem},e,b(t,null))}}class za extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{label:e,options:t}=this.props,n=this._render.renderFunction("Input");return b("div",null,b("div",null,e),b("select",null,t.map(s=>b("option",null,s.label))),b(n,{type:"number",placeholder:"2"}))}}const ly="univer-info-detail",uy="univer-info-return",cy="univer-univericon",hy="univer-univericon-logo",dy="univer-sheet-name",fy="univer-info-detail-update",gy="univer-info-detail-save";var ro={infoDetail:ly,infoReturn:uy,univericon:cy,univericonLogo:hy,sheetName:dy,infoDetailUpdate:fy,infoDetailSave:gy};class my extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",Je.SPREADSHEET))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;this._render.renderFunction("Button");const e=this._render.renderFunction("Container"),t=this._render.renderFunction("Input"),n=this._render.renderFunction("Tooltip");this._render.renderFunction("DropDownIcon"),this._render.renderFunction("LogoIcon");const{back:s,sheet:i,update:o,save:a,rename:l}=this.state.infoList;return b(e,{className:ro.infoDetail},b("div",{className:ro.sheetName},b(n,{title:l.label,placement:"bottom"},b(t,{bordered:!1,value:i.label,onBlur:i.onBlur}))),b("div",{className:ro.infoDetailUpdate},o.label),b("div",{className:ro.infoDetailSave},a.label))}}const py="univer-layout-container",_y="univer-content-container-horizontal",by="univer-content-inner-left-container",vy="univer-hover-cursor",Cy="univer-content-inner-right-container",Ey="univer-content-container-vertical",wy="univer-main-content",Ty="univer-outer-right-container";var dr={layoutContainer:py,contentContainerHorizontal:_y,contentInnerLeftContainer:by,hoverCursor:vy,contentInnerRightContainer:Cy,contentContainerVertical:Ey,mainContent:wy,outerRightContainer:Ty};const yy="univer-text-button";var Sy={textButton:yy};class Ay extends Xe{constructor(){super(...arguments),this.handleClick=()=>{var t,n;const e=!this.state.active;(n=(t=this.props).onClick)==null||n.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={active:this.props.active}}componentWillReceiveProps(e,t){e.active!==this.props.active&&this.setState({active:e.active})}render(){const{label:e}=this.props,{active:t}=this.state,n=this._render.renderFunction("Button");return b("div",{className:Sy.textButton},b(n,{type:"text",active:t,onClick:this.handleClick},e))}}const Ry="univer-toolbar-warp",Dy="univer-single-button",xy="univer-more-hide",Iy="univer-more-show",Oy="univer-toolbar",ky="univer-select-button",Ny="univer-cols-menu",My="univer-select-label-string",Fy="univer-drop-content",By="univer-select-double-string",Ly="univer-select-color-picker-parent",Py="univer-select-item-content",Hy="univer-select-color-picker",Uy="univer-select-item",zy="univer-select-line-bold-parent",Wy="univer-univericon-nextIcon",Vy="univer-more-button",Gy="univer-more-tool";var St={toolbarWarp:Ry,singleButton:Dy,moreHide:xy,moreShow:Iy,toolbar:Oy,selectButton:ky,colsMenu:Ny,selectLabelString:My,dropContent:Fy,selectDoubleString:By,selectColorPickerParent:Ly,selectItemContent:Py,selectColorPicker:Hy,selectItem:Uy,selectLineBoldParent:zy,univericonNextIcon:Wy,moreButton:Vy,moreTool:Gy};class Xy extends Xe{constructor(){super(...arguments),this.toolbarRef=Ve(),this.moreBtnRef=Ve(),this.moreToolRef=Ve(),this.SelectRef=Ve(),this.clientWidth=0,this.showMore=()=>{let e=this.state.showMore;this.setState({showMore:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.debounceSetToolbarListWidth=Xr(()=>{this.setToolbarListWidth()},50),this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const e=this.toolbarRef.current.querySelectorAll(`.${St.toolbarWarp} > div`),t=this.moreBtnRef.current.clientWidth;let n=60+t,s=null;const i=document.documentElement.clientWidth;if(i<=this.clientWidth){this.clientWidth=i;for(let o=0;o<e.length;o++)if(n+=e[o].clientWidth+6,n>i){s=o;break}s!==null&&this.setState({defaultToolList:this.state.toolList.slice(0,s),moreToolList:s?this.state.toolList.slice(s):[]},()=>{this.resetUl(),this.forceUpdate()})}else if(this.clientWidth=i,this.state.moreToolList.length){let o=30+t;for(let c=0;c<e.length;c++)o+=e[c].clientWidth+6;const a=this.moreToolRef.current.querySelectorAll(`.${St.moreTool} > div`);let l=null,u=!1;for(let c=0;c<a.length;c++)if(o+=a[c].clientWidth+6,o>i){l=c;break}else c===a.length-1&&(l=c,u=!0);l!==null&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,u?l+1:l)),moreToolList:u?[]:this.state.moreToolList.slice(l)},()=>{this.resetUl(),this.forceUpdate()})}},this.resetLabel=e=>{var n,s;const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);for(let i=0;i<e.length;i++){const o=e[i];if(o.customLabel){const a=t==null?void 0:t.getRegisterComponent(o.customLabel.name);if(a){const l=(n=o.customLabel.props)!=null?n:{};o.label=b(a,{...l})}}if(o.customSuffix){const a=t==null?void 0:t.getRegisterComponent(o.customSuffix.name);if(a){const l=(s=o.customSuffix.props)!=null?s:{};o.suffix=b(a,{...l})}}o.children&&(o.children=this.resetLabel(o.children))}return e},this.setToolBar=(e,t)=>{e=this.resetLabel(e),this.setState({toolList:e,defaultToolList:e,moreText:t},()=>{this.setToolbarListWidth()})},this.resetUl=()=>{var s;const t=`${((s=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET))==null?void 0:s.getSheetContainerControl().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let i=0;i<n.length;i++)n[i].style.maxHeight=t}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[],moreText:{}}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolBarList(e){const t=this._render.renderFunction("Tooltip");return e.map(n=>{if(n.toolbarType){if(n.show)return b(t,{title:n.tooltip,placement:"bottom"},b(Ay,{active:n.active,label:n.label,onClick:n.onClick}))}else if(n.show)return b(hu,{tooltip:n.tooltip,type:n.type,display:n.display,children:n.children,customLabel:n.customLabel,customSuffix:n.customSuffix,label:n.label,onClick:n.onClick,onKeyUp:n.onKeyUp,defaultColor:n.defaultColor,hideSelectedIcon:n.hideSelectedIcon,className:n.className});return null})}render(){const{defaultToolList:e,moreToolList:t,moreText:n,showMore:s}=this.state,i=this._render.renderFunction("Button"),o=this._render.renderFunction("Container"),a=this._render.renderFunction("Tooltip");return b(o,{style:{position:"relative"}},b("div",{className:`${St.toolbarWarp} ${St.toolbar}`,ref:this.toolbarRef},this.getToolBarList(e),b("div",{ref:this.moreBtnRef,className:St.moreButton,style:{visibility:t.length?"visible":"hidden"}},b(a,{title:n.tip,placement:"bottom"},b(i,{type:"text",onClick:this.showMore},b("div",{style:{fontSize:"14px"}},n.more))))),t.length?b("div",{style:{visibility:s?"visible":"hidden"},className:`${St.moreTool} ${St.toolbar}`,ref:this.moreToolRef},this.getToolBarList(t)):"")}}const $y="univer-count-bar",Yy="univer-btn",jy="univer-count-zoom",Ky="univer-count-slider",Zy="univer-count-statistic";var so={countBar:$y,btn:Yy,countZoom:jy,countSlider:Ky,countStatistic:Zy};class qy extends Xe{constructor(){super(...arguments),this.max=400,this.min=0,this.ref=Ve(),this.setValue=(e,t)=>{this.setState(n=>({...e}),t)},this.onChange=e=>{let t=e.target;this.state.onChange&&this.state.onChange(t.value),this.setValue({zoom:t.value}),console.log(t.value),this.ref.current.changeInputValue(0,t.value)},this.handleClick=(e,t)=>{this.setValue({zoom:t})},this.addZoom=()=>{let t=(Math.floor(this.state.zoom/10)+1)*10;t>=this.max&&(t=this.max),this.setValue({zoom:t}),this.state.onChange&&this.state.onChange(String(t))},this.reduceZoom=()=>{let t=(Math.ceil(this.state.zoom/10)-1)*10;t<=this.min&&(t=this.min),this.setValue({zoom:t}),this.state.onChange&&this.state.onChange(String(t)),this.ref.current.changeInputValue(0,t)}}initialize(e){this.state={zoom:100,content:""}}setZoom(e){e!==this.state.zoom&&(this.setValue({zoom:e}),this.ref.current.changeInputValue(0,e))}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onCountBarDidMountObservable",Je.SPREADSHEET))==null||e.notifyObservers(this)}render(e,t){const{zoom:n,content:s}=t,i=this.getComponentRender().renderFunction("ReduceIcon"),o=this.getComponentRender().renderFunction("RegularIcon"),a=this.getComponentRender().renderFunction("Slider"),l=this.getComponentRender().renderFunction("Button"),u=this.getComponentRender().renderFunction("AddIcon");return b("div",{className:so.countBar},b(l,{type:"text",className:so.countZoom},n),b(l,{type:"text",onClick:this.addZoom},b(u,null)),b("div",{className:so.countSlider},b(a,{ref:this.ref,onChange:this.onChange,value:n,min:this.min,max:this.max,onClick:this.handleClick})),b(l,{type:"text",onClick:this.reduceZoom},b(i,null)),b(l,{type:"text"},b(o,null)),b("span",{className:so.countStatistic},s))}}class Jy extends Xe{constructor(){super(...arguments),this.refs=[]}initialize(){this.state={modalGroup:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onModalGroupDidMountObservable"))==null||e.notifyObservers(this)}setModalGroup(e){const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET),n=e.map((s,i)=>{const o=t==null?void 0:t.getRegisterComponent(s);return o?b(o,{ref:a=>this.refs[i]=a}):null});this.setState({modalGroup:n})}getModalGroup(){return this.refs}render(){const{modalGroup:e}=this.state;return b(yt,null,e.map(t=>t))}}class Qy extends Xe{initialize(){this.state={sideGroup:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSideGroupDidMountObservable"))==null||e.notifyObservers(this)}setSideGroup(e){const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET),n=e.map(s=>{const i=t==null?void 0:t.getRegisterComponent(s.name);return i&&(s.side=b(i,null)),s});this.setState({sideGroup:n})}render(){const{sideGroup:e}=this.state;return b("div",null,e.map(t=>t.show?b("div",{onClick:()=>t.onClick(t.name),style:{zIndex:t.zIndex}},t.side):b(yt,null)))}}class eS{constructor(e){const t=e.primeval();this._scrollX=t.scrollLeft,this._slideTabBar=e}scrollX(e){const t=this._slideTabBar.primeval();t.scrollLeft=e,this._scrollX=t.scrollLeft}scrollRight(){const e=this._slideTabBar.primeval();e.scrollLeft=e.scrollWidth,this._scrollX=e.scrollLeft}getScrollX(){return this._scrollX}}const tS={easeOutStrong(r,e,t,n){return-t*((r=r/n-1)*r*r*r-1)+e},backOut(r,e,t,n,s){return typeof s=="undefined"&&(s=.7),t*((r=r/n-1)*r*((s+1)*r+s)+1)+e}},nS={loop:!1,begin:0,end:0,duration:300,delay:0,type:"easeOutStrong",receive(r){},success(r){},cancel(r){},complete(r){}};class rS{static success(...e){let t=0;return new Promise(n=>{for(let s=0;s<e.length;s++){let i=e[s],o=i._config,a=o.success;o.loop||(o.success=u=>{t++,a&&a.call(i,u),t===e.length&&n()})}})}_fakeHandle(){let e=Date.now()-this._start;e=e>=this._config.duration?this._config.duration:e;let n=tS[this._config.type](e,this._config.begin,this._config.end-this._config.begin,this._config.duration,.7).toFixed(2);if(this._config.receive(n),this._status===1){this._config.cancel(n),this._config.complete(n);return}if(e===this._config.duration){this._config.success(n),this._config.complete(n);return}this._handle=requestAnimationFrame(()=>{this._fakeHandle()})}constructor(e){this._config={...nS,...e},this._config.loop&&(this._config.complete=()=>{},this._config.success=()=>{this.request()})}request(){this._config.delay===0?(this._status=0,this._start=Date.now(),this._fakeHandle()):(this._delayHandle&&clearTimeout(this._delayHandle),this._delayHandle=setTimeout(()=>{this._status=0,this._start=Date.now(),this._fakeHandle()},this._config.delay))}cancel(){this._status=1,this._delayHandle&&clearTimeout(this._delayHandle),cancelAnimationFrame(this._handle)}}class er{static midline(e){return e.getBoundingRect().x+e.getBoundingRect().width/2}static make(e,t){let n=[];return e.forEach(s=>n.push(new er(s,t))),n}constructor(e,t){this._slideTabItem=e,this._animate=null,this._translateX=0,this._editMode=!1,this._slideTabBar=t,this._placeholder=null,this._scrollbar=t.getScrollbar(),this.update()}isEditMode(){return this._editMode}classList(){return this._slideTabItem.classList}primeval(){return this._slideTabItem}translateX(e){return this._translateX=e,this._slideTabItem.style.transform=`translateX(${e}px)`,this.getTranslateXDirection()}editor(e){if(this._editMode===!1){let t=this.primeval().querySelector("span"),n=i=>{this._editMode=!1,t&&(t.removeAttribute("contentEditable"),t.removeEventListener("blur",n),t.removeEventListener("input",s)),this._slideTabBar.updateItems(),this._slideTabBar.getConfig().onChangeName&&this._slideTabBar.getConfig().onChangeName(i),e&&e(i)},s=()=>{if(t){const i=t.querySelectorAll("br");i.length>0&&(i.forEach(o=>{t&&t.removeChild(o)}),t.blur())}};t&&(t.setAttribute("contentEditable","true"),t.addEventListener("blur",n),t.addEventListener("input",s),this._editMode=!0,la.keepLastIndex(t))}}animate(){return{translateX:e=>{this._translateX!==e&&(this._animate&&(this._animate.cancel(),this._animate=null),this._animate=new rS({begin:this._translateX,end:e,receive:t=>{this._slideTabItem.style.transform=`translateX(${t}px)`}}),this._translateX=e,this._animate.request())},cancel:()=>{this._animate&&(this._animate.cancel(),this._animate=null)}}}after(e){this._slideTabItem.after(e._slideTabItem||e)}update(){this._midline=er.midline(this)}disableFixed(){if(this._placeholder){const e=this._slideTabBar.primeval();this._slideTabItem.style.removeProperty("position"),this._slideTabItem.style.removeProperty("left"),this._slideTabItem.style.removeProperty("top"),this._slideTabItem.style.removeProperty("width"),this._slideTabItem.style.removeProperty("height"),this._slideTabItem.style.removeProperty("box-shadow"),this._slideTabItem.style.removeProperty("background"),this._placeholder.after(this._slideTabItem),e.removeChild(this._placeholder),this._placeholder=null}}enableFixed(){const e=document.createElement("div"),t=this.getBoundingRect();this._placeholder=e,this._placeholder.style.width=`${t.width}px`,this._placeholder.style.height=`${t.height}px`,this._placeholder.style.flexShrink="0",this._slideTabItem.style.left=`${t.x-this.getScrollbar().getScrollX()}px`,this._slideTabItem.style.top=`${t.y}px`,this._slideTabItem.style.width=`${t.width}px`,this._slideTabItem.style.height=`${t.height}px`,this._slideTabItem.style.background=getComputedStyle(this._slideTabItem).background,this._slideTabItem.style.boxShadow="0px 0px 1px 1px rgba(82,82,82,0.1)",this._slideTabItem.style.position="fixed",this._slideTabItem.after(e),document.body.appendChild(this._slideTabItem)}addEventListener(e,t,n){this._slideTabItem.addEventListener(e,t,n)}removeEventListener(e,t,n){this._slideTabItem.removeEventListener(e,t,n)}getScrollbar(){return this._scrollbar}getMidLine(){return this._midline}getBoundingRect(){const e=this._slideTabItem.getBoundingClientRect();return e.x+=this._scrollbar.getScrollX(),e}getWidth(){return this.getBoundingRect().width}getTranslateXDirection(){const e=er.midline(this);return e>this._midline?1:e<this._midline?-1:0}equals(e){return e&&e._slideTabItem===this._slideTabItem}}class la{static checkedSkipSlide(e){let t=e.target;for(;t!=null&&t!==document.body;){if(t.getAttribute("data-slide-skip"))return!0;t=t.parentElement}return!1}static keepLastIndex(e){setTimeout(()=>{const t=window.getSelection();t&&(t.selectAllChildren(e),t.collapseToEnd())})}_hasEditItem(){for(let e=0;e<this._slideTabItems.length;e++)if(this._slideTabItems[e].isEditMode())return!0;return!1}_autoScrollFrame(){if(this._activeTabItem)switch(this._compareDirection=this._activeTabItem.translateX(this._moveActionX),this._compareDirection){case 1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareRight();break}case 0:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareIndex=this._activeTabItemIndex;break}case-1:{this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+this._scrollIncremental),this._compareLeft();break}}this._autoScrollTime=requestAnimationFrame(()=>{this._autoScrollFrame()})}_startAutoScroll(){this._autoScrollTime==null&&this._autoScrollFrame()}_closeAutoScroll(){this._autoScrollTime&&cancelAnimationFrame(this._autoScrollTime),this._autoScrollTime=null}_scrollLeft(e){const t=this.getBoundingRect(),n=10,s=e.pageX-t.x;s<n&&(this._scrollIncremental=-Math.min(Math.abs(s-n)*.1,50))}_scrollRight(e){const t=this.getBoundingRect(),n=10,s=e.pageX-t.x;s>t.width-n&&(this._scrollIncremental=Math.min(Math.abs(s-(t.width-n))*.1,50))}_sortedItems(){if(this._activeTabItem!=null&&this._activeTabItemIndex!=null&&this._compareIndex!=null&&(this._slideTabItems.splice(this._activeTabItemIndex,1),this._slideTabItems.splice(this._compareIndex,0,this._activeTabItem),this._config.slideTabBarItemAutoSort))for(let e=0;e<this._slideTabItems.length;e++){let t=this._slideTabItems[e],n=this._slideTabItems[e+1];n&&t.after(n)}}_compareLeft(){if(this._activeTabItem&&this._activeTabItemIndex){let e=this._slideTabItems.findIndex(i=>i.equals(this._activeTabItem)),t=this._slideTabItems.length,n=[];for(let i=0;i<e&&!(i>=e);i++)n.push(this._slideTabItems[i]);for(let i=e+1;i<t;i++)this._slideTabItems[i].animate().translateX(0);let s=!0;for(let i=n.length-1;i>=0;i--){let o=n[i];er.midline(this._activeTabItem)<o.getMidLine()?(o.animate().translateX(this._activeTabItem.getWidth()),this._compareIndex=i,s=!1):(o.animate().translateX(0),s&&(this._compareIndex=this._activeTabItemIndex))}}}_compareRight(){if(this._activeTabItem){let e=this._slideTabItems.findIndex(i=>i.equals(this._activeTabItem)),t=this._slideTabItems.length,n=[];for(let i=e+1;i<t;i++)n.push(this._slideTabItems[i]);for(let i=0;i<e;i++)this._slideTabItems[i].animate().translateX(0);let s=!0;for(let i=0;i<n.length;i++){let o=n[i];er.midline(this._activeTabItem)>o.getMidLine()?(o.animate().translateX(-this._activeTabItem.getWidth()),this._compareIndex=e+i+1,s=!1):(o.animate().translateX(0),s&&(this._compareIndex=this._activeTabItemIndex))}}}_initialize(){document.addEventListener("mousemove",this._moveAction),document.addEventListener("mouseup",this._upAction),this._slideTabBar.addEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.addEventListener("mousedown",this._downAction)})}constructor(e){var a,l;if(e.slideTabRoot==null)throw new Error("not found slide-tab-bar root element");const t=e.slideTabRoot.querySelector(`.${(a=e.slideTabBarClassName)!=null?a:"slide-tab-bar"}`),n=e.slideTabRoot.querySelectorAll(`.${(l=e.slideTabBarItemClassName)!=null?l:"slide-tab-item"}`);if(t==null)throw new Error("not found slide-tab-bar");this._config=e,this._activeTabItem=null,this._downActionX=0,this._moveActionX=0,this._compareDirection=0,this._compareIndex=0,this._activeTabItemIndex=0,this._slideTabBar=t,this._slideScrollbar=new eS(this),this._slideTabItems=er.make(n,this);let s=0,i=0,o=0;this._downAction=u=>{var p;if(u.button===2){s=0,o=0,i=0;return}const{pageX:c,pageY:h}=u,f=Date.now();if(f-o<=800&&c===s&&h===i){const _=this._slideTabItems.find(v=>v.equals(new er(u.currentTarget,this)));_&&_.editor(),o=0,s=0,i=0}else{if(!this._hasEditItem()){if(la.checkedSkipSlide(u)){s=0,o=0,i=0;return}const _=this._slideTabItems.findIndex(v=>v.equals(new er(u.currentTarget,this)));_>-1?(this._compareIndex=_,this._downActionX=u.pageX,this._moveActionX=0,this._scrollIncremental=0,this._activeTabItem=this._slideTabItems[_],this._activeTabItemIndex=_,this._config.activeClassNameAutoController&&(this._slideTabItems.forEach(v=>{var w;v.classList().remove((w=this._config.slideTabBarItemActiveClassName)!=null?w:"slide-tab-active")}),this._activeTabItem.classList().add((p=this._config.slideTabBarItemActiveClassName)!=null?p:"slide-tab-active")),this._activeTabItem.enableFixed(),this._startAutoScroll()):(this.updateItems(),this._activeTabItemIndex=0,this._downActionX=0,this._scrollIncremental=0,this._compareIndex=0,this._activeTabItem=null)}s=c,i=h,o=f}},this._upAction=u=>{if(this._activeTabItem){this._closeAutoScroll(),this._activeTabItem.disableFixed(),this._sortedItems(),this.updateItems(),this._config.onSlideEnd&&this._activeTabItemIndex!==this._compareIndex&&this._config.onSlideEnd(u);let c=new MouseEvent("click",{view:window,bubbles:!0,cancelable:!0});this._activeTabItem.primeval().dispatchEvent(c),this._scrollIncremental=0,this._activeTabItemIndex=0,this._downActionX=0,this._moveActionX=0,this._compareIndex=0,this._activeTabItem=null}},this._moveAction=u=>{this._activeTabItem&&(this._moveActionX=u.pageX-this._downActionX,this._scrollIncremental=0,this._scrollLeft(u),this._scrollRight(u))},this._wheelAction=u=>{u.deltaY>0?this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+u.deltaY):this._slideScrollbar.scrollX(this._slideScrollbar.getScrollX()+u.deltaY)},this._initialize()}primeval(){return this._slideTabBar}updateItems(){for(let e=0;e<this._slideTabItems.length;e++)this._slideTabItems[e].animate().cancel(),this._slideTabItems[e].translateX(0),this._slideTabItems[e].update()}getScrollbar(){return this._slideScrollbar}getConfig(){return this._config}getBoundingRect(){return this._slideTabBar.getBoundingClientRect()}getSlideTabItems(){return this._slideTabItems}destroy(){document.removeEventListener("mousemove",this._moveAction),document.removeEventListener("mouseup",this._upAction),document.removeEventListener("wheel",this._wheelAction),this._slideTabItems.forEach(e=>{e.removeEventListener("mousedown",this._downAction)})}}const sS="univer-sheet-bar",iS="univer-sheet-bar-options",oS="univer-sheet-bar-options-button",aS="univer-sheet_bar_scroll_button",lS="univer-slide-tab-bar",uS="univer-slide-tab-active",cS="univer-slide-tab-item",hS="univer-slide-tab-divider",dS="univer-slide-tab-content",fS="univer-slide-tab-title",gS="univer-slide-tab-icon",mS="univer-slide-tab-footer",pS="univer-slide-tab-active-bar";var It={sheetBar:sS,sheetBarOptions:iS,sheetBarOptionsButton:oS,sheetBarScrollButton:aS,slideTabBar:lS,slideTabActive:uS,slideTabItem:cS,slideTabDivider:hS,slideTabContent:dS,slideTabTitle:fS,slideTabIcon:gS,slideTabFooter:mS,slideTabActiveBar:pS};class _S extends Xe{constructor(){super(...arguments),this.ref=Ve(),this.ulRef=Ve(),this.sheetContainerRef=Ve(),this.slideTabRoot=Ve(),this.sheetContentRef=Ve(),this.sheetBarContentRef=Ve(),this._renderKey=1,this.setValue=(e,t)=>{const{sheetList:n,menuList:s,sheetUl:i}=e;n&&this.jointJsx(n),s&&this.jointJsx(s),i&&this.jointJsx(i),this.setState(o=>({...e}),t)},this.scrollLeft=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()-50)},this.scrollRight=e=>{this.slideTabBar.getScrollbar().scrollX(this.slideTabBar.getScrollbar().getScrollX()+50)},this.overGrid=()=>{},this.contextMenu=e=>{e.preventDefault(),this.showUlList(e)},this.showSelect=(e,t)=>{e.stopImmediatePropagation();const n=t.current;n&&n.showSelect(),window.addEventListener("click",this.hideSelect)},this.hideSelect=e=>{const t=this.ref.current,n=this.ulRef.current;t&&t.hideSelect(),n&&n.hideSelect(),window.removeEventListener("click",this.hideSelect)},this.showUlList=e=>{new Promise(t=>{e.currentTarget.dataset.id,this.showSelect(e,this.ulRef),t()}).then(()=>{const t=e.currentTarget.closest(`.${It.slideTabItem}`);if(t){const n=t.getBoundingClientRect(),s=`${n.left}px`,i=`${n.height}px`,o=this.ulRef.current.ulRef.current;o.style.left=s,o.style.bottom=i,o.style.top="auto",o.style.right="auto"}})},this.reNameSheet=e=>{const t=this.slideTabBar.getSlideTabItems().find(n=>n.primeval().dataset.id===e);t&&t.editor()},this.changeEditable=e=>{const t=e.target;let n;t.contentEditable="true",t.focus(),t.addEventListener("blur",n=s=>{this.state.changeSheetName&&this.state.changeSheetName(e),t.contentEditable="false",t.removeEventListener("blur",n)})},this.time=0,this.target=null,this.cloneTarget=null}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this.state={sheetList:[],sheetUl:[],menuList:[],addSheet:null,contextMenu:null,selectSheet:null,changeSheetName:null,dragEnd:null}}jointJsx(e){e.forEach(t=>{if(t.icon&&typeof t.icon=="string"&&/Icon$/.test(t.icon)){const n=this._render.renderFunction(t.icon);t.icon=b(n,null)}if(t.selectType&&t.selectType==="jsx"){const n=this._render.renderFunction(t.label);t.label=b(n,{style:{visibility:"visible",marginTop:"-60px",marginLeft:"-50px"},onClick:s=>{t.onClick(s)}})}t.children&&t.children.length>0&&this.jointJsx(t.children)})}componentWillUnmount(){}componentDidUpdate(){this.slideTabBar&&this.slideTabBar.destroy(),this.slideTabBar=new la({slideTabBarClassName:"univer-slide-tab-bar",slideTabBarItemActiveClassName:"univer-slide-tab-active",slideTabBarItemClassName:"univer-slide-tab-item",slideTabBarItemAutoSort:!0,slideTabRoot:this.slideTabRoot.current,onChangeName:e=>{this.state.changeSheetName&&this.state.changeSheetName(e)},onSlideEnd:e=>{this.state.dragEnd&&this.state.dragEnd(this.slideTabBar.getSlideTabItems().map(t=>t.primeval()))}})}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSheetBarDidMountObservable",Je.SPREADSHEET))==null||e.notifyObservers(this)}render(e,t){const{sheetList:n,menuList:s,sheetUl:i,addSheet:o,contextMenu:a,selectSheet:l}=t;if(!o||!l||!a)return;const u=this._render.renderFunction("Button"),c=this._render.renderFunction("Ul"),h=this._render.renderFunction("AddIcon"),f=this._render.renderFunction("MenuIcon"),d=this._render.renderFunction("NextIcon");return b("div",{className:It.sheetBar,ref:this.slideTabRoot},b("div",{className:It.sheetBarOptions},b(u,{className:It.sheetBarOptionsButton,onClick:o,type:"text"},b(h,{style:{fontSize:"20px"}})),b(u,{className:It.sheetBarOptionsButton,onClick:m=>this.showSelect(m,this.ref),type:"text"},b(f,{style:{fontSize:"20px"}}),b(c,{onClick:l,children:s,ref:this.ref,style:{bottom:"2.2rem",left:"0"}}))),b("div",{className:It.slideTabBar,ref:this.sheetContainerRef},n.map(m=>b("div",{onMouseDown:m.onDown,onClick:m.onClick,onContextMenu:a,"data-id":m.sheetId,key:this._renderKey++,className:`${It.slideTabItem} ${m.selected?It.slideTabActive:""}`},b("div",{className:`${It.slideTabContent}`},b("div",{className:`${It.slideTabDivider}`}),b("div",{className:`${It.slideTabTitle}`},b("span",{style:{padding:"2px 5px 2px 5px"}},m.label)),b("div",{className:`${It.slideTabIcon}`,"data-slide-skip":"true",style:{lineHeight:1},"data-id":m.sheetId,onClick:a},m.icon)),b("div",{className:`${It.slideTabFooter}`},b("div",{className:`${It.slideTabActiveBar}`,style:m.color?{background:m.color}:{}}))))),b(c,{children:i,ref:this.ulRef}),b("div",{className:`${It.sheetBarOptions} ${It.sheetBarScrollButton}`},b(u,{type:"text",className:It.sheetBarOptionsButton,onClick:this.scrollLeft},b(d,{rotate:90,style:{padding:"5px"}})),b(u,{type:"text",className:It.sheetBarOptionsButton,onClick:this.scrollRight},b(d,{rotate:-90,style:{padding:"5px"}}))))}}class bS extends Xe{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=Ve(),this.contentRef=Ve(),this.layoutContainerRef=Ve(),this.handleSplitBarMouseDown=n=>{var i,o,a,l,u;this.leftContentLeft=(i=this.splitLeftRef.current)==null?void 0:i.getBoundingClientRect().left,this.leftContentTop=(o=this.splitLeftRef.current)==null?void 0:o.getBoundingClientRect().top;const s=(a=this.splitLeftRef.current)==null?void 0:a.parentElement;this.rightBorderX=(l=s==null?void 0:s.getBoundingClientRect())==null?void 0:l.width,this.rightBorderY=(u=s==null?void 0:s.getBoundingClientRect())==null?void 0:u.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=n=>{n=n||window.event;let s=n.clientX-this.leftContentLeft,i=n.clientY-this.leftContentTop;s=s>=this.rightBorderX?this.rightBorderX:s,i=i>=this.rightBorderY?this.rightBorderY:i,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${i}px`:this.splitLeftRef.current.style.width=`${s}px`},this.handleSplitBarMouseUp=n=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)};const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this.state={layout:{},currentLocale:"",currentSkin:e.config.skin},this.changeSkin(e.config.container,e.config.skin)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}getLayoutContainerRef(){return this.layoutContainerRef}handleChangeSkin(e){const{changeSkin:t}=this.props,s=e.target.value;this.setState({currentSkin:s},()=>{this.changeSkin(this.props.config.container,s)}),t()}changeSkin(e,t){let n=document.documentElement,i={default:c7,dark:eT,green:GT}[t];i=Object.fromEntries(Object.keys(i).map(l=>[`--${l.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,i[l]])),G.isIEBrowser()?Qn({rootElement:n,variables:i}):o(e.id).insertRule(`#${e.id} ${JSON.stringify(i).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function o(l){const u="universheet-skin-style";for(let f=0;f<document.styleSheets.length;f++)if(document.styleSheets[f].title===u)return a(document.styleSheets[f],l),document.styleSheets[f];const c=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=u,c.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(l,u){let c=0;for(let h=0;h<l.cssRules.length;h++){const f=l.cssRules[h];if(f instanceof CSSStyleRule&&f.selectorText===`#${u}`){c=h,l.deleteRule(c);break}}}}setLocale(e){const{changeLocale:t}=this.props,s=e.target.value;this.setState({currentLocale:s},()=>{t(s)})}componentDidMount(){var e;(e=this.getContext().getPluginManager().getRequirePluginByName(Je.SPREADSHEET).getObserver("onSheetContainerDidMountObservable"))==null||e.notifyObservers(this)}render(){const{context:e}=this.props.config,{layout:t,currentLocale:n,currentSkin:s}=this.state;return b(nu.Provider,{value:{coreContext:e}},b(So,{ref:this.layoutContainerRef,className:dr.layoutContainer},b(Ao,null,b(ii,{style:{display:t.outerLeft?"block":"none"}}),b(Ao,{className:dr.mainContent,style:{position:"relative"}},b(gg,{style:{display:t.header?"block":"none"}},t.infoBar&&b(my,null),t.toolBar&&b(Xy,{toolList:[]}),t.formulaBar&&b($5,null)),b(Ao,null,b(ii,{style:{display:t.innerLeft?"block":"none"}}),b(pg,{className:t.contentSplit==="vertical"?dr.contentContainerVertical:dr.contentContainerHorizontal},b(Jy,null),!!t.contentSplit&&b(So,{ref:this.splitLeftRef,className:dr.contentInnerLeftContainer},b("div",{className:dr.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),b(So,{ref:this.contentRef,className:dr.contentInnerRightContainer},b(ay,null),b("div",{style:{position:"fixed",right:"200px",top:"10px",fontSize:"14px"}},b("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"\u76AE\u80A4"),b("select",{value:s,onChange:this.handleChangeSkin.bind(this),style:{width:55}},b("option",{value:"default"},"\u9ED8\u8BA4"),b("option",{value:"dark"},"\u6697\u9ED1"),b("option",{value:"green"},"\u7EFF\u8272")),b("span",{style:{display:"inline-block",width:50,margin:"5px 0 0 5px"}},"\u8BED\u8A00"),b("select",{value:n,onChange:this.setLocale.bind(this),style:{width:55}},b("option",{value:"en"},"English"),b("option",{value:"zh"},"\u4E2D\u6587"))))),b(ii,{style:{display:t.innerRight?"block":"none"}},b(Qy,null))),b(mg,{style:{display:t.footer?"block":"none"}},t.sheetBar&&b(_S,null),t.countBar&&b(qy,null))),b(ii,{style:{display:t.outerRight?"block":"none"},className:dr.outerRightContainer}))))}}class vS{_removeAntLineModelBySheetId(e){const t=this._antLineModelList.findIndex(n=>n.getSheetId()!==e);t>-1&&this._antLineModelList.splice(t,1)}_findAntLineModelBySheetId(e,t){var n;return(n=this._antLineModelList.find(s=>s.getSheetId()===e))!=null?n:t}_saveOrUpdateAntLineModel(e){for(let t=0;t<this._antLineModelList.length;t++)if(this._antLineModelList[t].getSheetId()===e.getSheetId()){this._antLineModelList[t]=e;return}this._antLineModelList.push(e)}_createAntLineRectBySheetIdAndRange(e,t){let s=this.getWorkBook().getSheetBySheetId(e);if(s==null)throw new Error(`not found sheet from id: ${e}`);let i=s.getConfig().rowTitle.width,o=s.getConfig().columnTitle.height,a=s.getRowManager(),l=s.getColumnManager(),u=0,c=0;for(let d=t.startRow;d<t.endRow;d++)u+=a.getRowHeight(d);for(let d=t.startColumn;d<t.endColumn;d++)c+=l.getColumnWidth(d);let h=0,f=0;for(let d=0;d<=t.startRow-1;d++)f+=a.getRowHeight(d);for(let d=0;d<=t.startColumn-1;d++)h+=l.getColumnWidth(d);return new rt("__AntLineShape__",{stroke:"red",strokeWidth:2,left:h+i,top:f+o,height:u,width:c,strokeDashArray:[5]})}_deleteSceneAllAntLineRect(){for(let e=0;e<this._antLineModelList.length;e++){let n=this._antLineModelList[e].getAntLineList();for(let s=0;s<n.length;s++){let o=n[s].getRect();o&&this.getSheetViewScene().removeObject(o)}}}_makeUpdateSceneAntLineRect(){this._deleteSceneAllAntLineRect();for(let e=0;e<this._antLineModelList.length;e++){let t=this._antLineModelList[e],n=t.getAntLineList();if(t.getSheetId()===this._activeSheetId)for(let s=0;s<n.length;s++){let i=n[s],o=this._createAntLineRectBySheetIdAndRange(t.getSheetId(),i.getRange());i.setRect(o),console.log(o),this.getSheetViewScene().addObject(o)}}}constructor(e){this._plugin=e,this._antLineModelList=[],e.getContext().getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()}),e.getContext().getContextObserver("onSheetRenderDidMountObservable").add(()=>{this._activeSheetId=e.getWorkbook().getActiveSheet().getSheetId(),this._makeUpdateSceneAntLineRect()})}removeSheetAntLine(e=this._activeSheetId){this._removeAntLineModelBySheetId(e),this._makeUpdateSceneAntLineRect()}addAntLineToSheet(e,t=this._activeSheetId){const n=this._findAntLineModelBySheetId(t,new cw(t));n.addAntLine(new uw(e)),this._saveOrUpdateAntLineModel(n),this._makeUpdateSceneAntLineRect()}getSheetView(){return this._plugin.getCanvasView().getSheetView()}getWorkBook(){return this._plugin.getWorkbook()}getSheetViewScene(){return this._plugin.getCanvasView().getSheetView().getScene()}}class CS{constructor(e){this._plugin=e,this._initialize()}_initialize(){var e,t;(e=this._plugin.getObserver("onSheetContainerDidMountObservable"))==null||e.add(n=>{var s;this._initRegisterComponent(),this._sheetContainer=n,this._initRegisterComponent(),(s=this._plugin.getObserver("onRichTextDidMountObservable"))==null||s.add(i=>{this.richTextEle=Ai(i.container),this.richTextEditEle=Rr("div",this.richTextEle),this.richText=i,this.hideEditContainer(),this._keyboardManager.handleKeyboardAction(this.richTextEditEle),this._handleKeyboardObserver(),this.richText.hooks.set("onKeyDown",o=>{var a;(a=this._plugin.getObserver("onRichTextKeyDownObservable"))==null||a.notifyObservers(o)}),this.richText.hooks.set("onKeyUp",o=>{var a;(a=this._plugin.getObserver("onRichTextKeyUpObservable"))==null||a.notifyObservers(o)})})}),(t=this._plugin.context.getObserverManager().getObserver("onSheetRenderDidMountObservable","core"))==null||t.add(n=>{const s=this._plugin.getMainComponent();s.onDblclickObserver.add(i=>{i.button!==2&&this.enterEditMode()}),s.onPointerDownObserver.add(i=>{this.exitEditMode(),i.preventDefault()})}),this._cellEditExtensionManager=new Rs,this._keyboardManager=new xp(this._plugin)}_initRegisterComponent(){this._plugin.registerModal(`${Je.SPREADSHEET+to.name}cell`,to),this._plugin.registerModal(`${Je.SPREADSHEET+to.name}formula`,to)}_handleKeyboardObserver(){const e=this._plugin.getContext().getObserverManager().getObserver("onKeyDownObservable","core"),t=this._plugin.getContext().getObserverManager().getObserver("onKeyCompositionStartObservable","core");e&&!e.hasObservers()&&e.add(n=>{if(!n.ctrlKey&&J0(n.key))this.enterEditMode(!0);else switch(n.key){case"Enter":if(this.isEditMode){this.exitEditMode();const s=this._plugin.getSelectionManager().getCurrentCellModel();s!=null&&s.isMerged||this._plugin.getSelectionManager().move(Q.BOTTOM)}else this.enterEditMode();break;case"Space":this.isEditMode||this.enterEditMode(!0);break;case"ArrowUp":this.isEditMode||this._plugin.getSelectionManager().move(Q.TOP);break;case"ArrowDown":this.isEditMode||this._plugin.getSelectionManager().move(Q.BOTTOM);break;case"ArrowLeft":this.isEditMode||this._plugin.getSelectionManager().move(Q.LEFT);break;case"ArrowRight":this.isEditMode||this._plugin.getSelectionManager().move(Q.RIGHT);break;case"Tab":this.isEditMode||this._plugin.getSelectionManager().move(Q.RIGHT),n.preventDefault();break}}),t&&!t.hasObservers()&&t.add(n=>{this.isEditMode||this.enterEditMode(!0)})}hideEditContainer(){this.richTextEle.style.maxHeight="1px",this.richTextEle.style.maxWidth="1px",this.richTextEle.style.minWidth="1px",this.richTextEle.style.minHeight="1px",this.richTextEle.style.borderWidth="0px",this.richTextEle.style.transform="scale(0)"}enterEditMode(e=!1){var d,m,g,p;if(this.focusEditEle(),this.isEditMode)return;setTimeout(()=>{b_(this.richTextEditEle)},1),this.isEditMode=!0;const t=this._plugin.getSelectionManager().getCurrentCellModel();if(!t)return!1;let n,s,i,o;if(t.isMerged){const _=t.mergeInfo;n=_.startX,s=_.endX,i=_.startY,o=_.endY}else n=t.startX,s=t.endX,i=t.startY,o=t.endY;const a=((m=(d=this._plugin.getMainScene())==null?void 0:d.getViewport(jt.VIEW_TOP))==null?void 0:m.actualScrollX)||0,l=((p=(g=this._plugin.getMainScene())==null?void 0:g.getViewport(jt.VIEW_LEFT))==null?void 0:p.actualScrollY)||0;this.richTextEle.style.left=`${n-a}px`,this.richTextEle.style.top=`${i-l}px`,this.richTextEle.style.minWidth=`${s-n}px`,this.richTextEle.style.minHeight=`${o-i}px`,this.richTextEle.style.borderWidth="2px";const u=Ai(this._sheetContainer.contentRef).getBoundingClientRect();this.richTextEle.style.maxWidth=`${u.width-n+a}px`,this.richTextEle.style.maxHeight=`${u.height-i+l}px`,this.richTextEle.style.transform="";let c=this.getSelectionValue();const h=this._cellEditExtensionManager.handle({row:t.row,column:t.column,value:c});h&&(c=h.value),e&&(c=""),this.richText.setValue(c);const f=this.getSelectionStyle();this.richTextEditEle.style.cssText="",f&&(this.richTextEditEle.style.cssText=ou(f,!0)),this.setCurrentEditRangeData()}exitEditMode(){if(this.focusEditEle(),!this.isEditMode)return;this.isEditMode=!1;const e=Uf(this.richTextEditEle),t=this.richTextEditEle.innerText;let n={};typeof e=="string"?(n.v=e,n.m=e):typeof e=="object"&&(n.p=e,n.v=t,n.m=t);const s=iu(this.richTextEditEle);G.isPlainObject(s)&&(n.s=s),this.setCurrentEditRangeValue(n),this.hideEditContainer()}focusEditEle(){setTimeout(()=>{this.richTextEditEle.focus()},100)}setCurrentEditRangeData(){const e=this._plugin.getSelectionManager().getCurrentCellModel();if(!e)return;let t,n;if(e.isMerged){const s=e.mergeInfo;t=s.startRow,n=s.startColumn}else t=e.row,n=e.column;this.currentEditRangeData={startRow:t,startColumn:n,endRow:t,endColumn:n}}getCurrentEditRangeData(){return this.currentEditRangeData}setCurrentEditRangeValue(e){const{startRow:t,startColumn:n,endRow:s,endColumn:i}=this.currentEditRangeData;this._plugin.getContext().getWorkBook().getActiveSheet().getRange(t,n,s,i).setRangeData(e)}getSelectionValue(){const e=this._plugin.getSelectionManager().getActiveRange();if(!e)return"";const t=e&&e.getDisplayValue();return typeof t=="string"?t:typeof t=="object"&&t!==null?zf(t):""}getSelectionStyle(){var e;return(e=this._plugin.getSelectionManager().getActiveRange())==null?void 0:e.getTextStyle()}setSelectionValue(e){const t=this._plugin.getSelectionManager().getActiveRange();!t||(typeof e=="string"&&t.setValue(e),typeof e=="object"&&t.setRangeData({p:e}))}handleBackSpace(){}handleDirection(e){}}class ES{constructor(e){this._master=e}}class wS{_initialize(){const n=this._master.getPlugin().getContext().getWorkBook();this._countBar.setState({onChange:s=>{n.getActiveSheet().setZoomRatio(G.numberFixed(s/100,2))}})}_totalRangeList(e){let t=e.getRangeList(),n=[],l=this._master.getPlugin().getContext().getWorkBook().getActiveSheet().getCellMatrix(),u=0,c=0,h=0;for(let f=0;f<t.length;f++){let d=t[f];for(let m=d.startRow;m<=d.endRow;m++)for(let g=d.startColumn;g<=d.endColumn;g++){if(n.includes(`${m}${g}`))continue;const p=l.getValue(m,g);if(p){let _=parseFloat(p.v);isNaN(_)||(h+=1,c+=_)}n.push(`${m}${g}`)}}h>0&&(u=c/h),this._countBar.setState({content:`\u5E73\u5747\u6570\uFF1A${G.numberFixed(u,2)} \u8BA1\u6570\uFF1A${G.numberFixed(c,2)} \u6570\u91CF\uFF1A${h}`})}_initializeSelectedObserver(){var n;const e=this._master.getPlugin(),t=e.getSelectionManager();(n=e.getObserver("onChangeSelectionObserver"))==null||n.add(()=>{const s=t.getActiveRangeList();s&&this._countBar&&this._totalRangeList(s)})}constructor(e){this._master=e;const t=e.getPlugin().getContext();t.getObserverManager().requiredObserver("onCountBarDidMountObservable").add(s=>{this._countBar=s,this._initialize()}),t.getContextObserver("onAfterChangeActiveSheetObservable").add(()=>{const s=t.getWorkBook().getActiveSheet().getZoomRatio();this._countBar.setZoom(Math.trunc(s*100))}),t.getContextObserver("onSheetRenderDidMountObservable").add(()=>{this._initializeSelectedObserver()}),t.getContextObserver("onZoomRatioSheetObservable").add(s=>{this._countBar.setZoom(Math.trunc(s.zoomRatio*100))})}}class TS{constructor(e){this._plugin=e,this._uiController=new wS(this),this._apiController=new ES(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}}class yS{constructor(e){this._plugin=e;const t=e.getContext().getWorkBook().getConfig().name;this._infoBarModel=new hw(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:n=>{this.setSheetName(n)}}},this._initialize()}_initialize(){const e=this._plugin.context;e.getObserverManager().requiredObserver("onInfoBarDidMountObservable",Je.SPREADSHEET).add(n=>{this._infoBar=n,this.resetInfoList(this._infoList)}),e.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let n in e)e[n].locale&&(e[n].label=t.get(e[n].locale));this._infoBar.setInfoList(e)}setSheetName(e){const n=e.target.value;this._infoBarModel.setName(n)}}class SS{constructor(e,t){this.insertRow=(...s)=>{const i=this._getSelections();if((i==null?void 0:i.length)===1){const o=this._plugin.getContext().getWorkBook().getActiveSheet();o==null||o.insertRowBefore(i[0].startRow,i[0].endRow-i[0].startRow+1)}},this.deleteRow=(...s)=>{const i=this._getSelections();if((i==null?void 0:i.length)===1){const o=this._plugin.getContext().getWorkBook().getActiveSheet();o==null||o.deleteRows(i[0].startRow,i[0].endRow-i[0].startRow+1)}},this.insertColumn=(...s)=>{const i=this._getSelections();(i==null?void 0:i.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().insertColumnBefore(i[0].startColumn,i[0].endColumn-i[0].startColumn+1)},this.deleteColumn=(...s)=>{const i=this._getSelections();(i==null?void 0:i.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().deleteColumns(i[0].startColumn,i[0].endColumn-i[0].startColumn+1)},this.clear=(...s)=>{const i=this._getSelections();(i==null?void 0:i.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(i[0]).clear()},this.deleteCellLeft=(...s)=>{const i=this._getSelections();(i==null?void 0:i.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(i[0]).deleteCells(0)},this.deleteCellTop=(...s)=>{const i=this._getSelections();(i==null?void 0:i.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().getRange(i[0]).deleteCells(1)},this.addItem=s=>{s instanceof Array?this._menuList.push(...s):this._menuList.push(s),this.resetMenuList(this.resetMenuLabel(this._menuList))},this._plugin=e,this._initRegisterComponent();const n=t?G.deepClone(pl):G.deepMerge(pl,t);this._menuList=[{locale:["rightClick.insert","rightClick.row"],onClick:this.insertRow,hide:n.hideInsertRow},{locale:["rightClick.insert","rightClick.column"],onClick:this.insertColumn,hide:n.hideInsertColumn},{customLabel:{name:hr.name,props:{prefixLocale:["rightClick.to","rightClick.top","rightClick.add"],suffixLocale:"rightClick.row"}},hide:n.hideAddRowTop},{customLabel:{name:hr.name,props:{prefixLocale:["rightClick.to","rightClick.bottom","rightClick.add"],suffixLocale:"rightClick.row"}},hide:n.hideAddRowBottom},{customLabel:{name:hr.name,props:{prefixLocale:["rightClick.to","rightClick.left","rightClick.add"],suffixLocale:"rightClick.column"}},hide:n.hideAddColumnLeft},{customLabel:{name:hr.name,props:{prefixLocale:["rightClick.to","rightClick.right","rightClick.add"],suffixLocale:"rightClick.column"}},hide:n.hideAddColumnRight},{locale:["rightClick.deleteSelected","rightClick.row"],onClick:this.deleteRow,hide:n.hideDeleteRow},{locale:["rightClick.deleteSelected","rightClick.column"],onClick:this.deleteColumn,hide:n.hideDeleteColumn},{locale:["rightClick.hideSelected","rightClick.row"],hide:n.hideHideRow},{locale:["rightClick.showHide","rightClick.row"],hide:n.hideShowRow},{customLabel:{name:hr.name,props:{prefixLocale:["rightClick.row","rightClick.height"],suffix:"px",onKeyUp:this.setRowHeight.bind(this)}},onClick:(...s)=>console.dir(s),hide:n.hideRowHeight},{locale:["rightClick.hideSelected","rightClick.column"],hide:n.hideHideColumn},{locale:["rightClick.showHide","rightClick.column"],hide:n.hideShowColumn},{customLabel:{name:hr.name,props:{prefixLocale:["rightClick.column","rightClick.width"],suffix:"px",onKeyUp:this.setColumnWidth.bind(this)}},hide:n.hideColumnWidth},{hide:n.hideDeleteCell,customLabel:{name:li.name,props:{locale:"rightClick.deleteCell"}},border:!0,children:[{locale:["rightClick.moveLeft"],className:Wo.rightMenuCenter,onClick:(...s)=>this.deleteCellLeft(...s)},{locale:["rightClick.moveUp"],className:Wo.rightMenuCenter,onClick:(...s)=>this.deleteCellTop(...s)}]},{locale:["rightClick.clearContent"],onClick:(...s)=>this.clear(...s),border:!0,hide:n.hideClearContent},{hide:n.hideMatrix,customLabel:{name:li.name,props:{locale:"rightClick.matrix"}},children:[{customLabel:{name:hs.name,props:{locale:"rightClick.flip",children:[{locale:"rightClick.upAndDown"},{locale:"rightClick.leftAndRight"}]}}},{customLabel:{name:hs.name,props:{locale:"rightClick.flip",children:[{locale:"rightClick.clockwise"},{locale:"rightClick.counterclockwise"}]}}},{locale:["rightClick.transpose"]},{customLabel:{name:za.name,props:{locale:"rightClick.matrixCalculation",options:[{locale:"rightClick.plus"},{locale:"rightClick.minus"},{locale:"rightClick.multiply"},{locale:"rightClick.divided"},{locale:"rightClick.power"},{locale:"rightClick.root"},{locale:"rightClick.log"}]}}},{customLabel:{name:hs.name,props:{locale:"rightClick.delete0",children:[{locale:"rightClick.byRow"},{locale:"rightClick.byCol"}]}}},{customLabel:{name:hs.name,props:{locale:"rightClick.removeDuplicate",children:[{locale:"rightClick.byRow"},{locale:"rightClick.byCol"}]}}}]}],this._rightMenuModel=new dw,this._initialize()}_initialize(){const e=this._plugin.getContext();e.getObserverManager().requiredObserver("onRightMenuDidMountObservable",Je.SPREADSHEET).add(n=>{this._RightMenu=n,this.resetMenuList(this.resetMenuLabel(this._menuList))}),e.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetMenuList(this.resetMenuLabel(this._menuList))}),e.getContextObserver("onSheetRenderDidMountObservable").add(()=>{const n=this._plugin.getSheetContainerControl().getContentRef().current;!n||this._plugin.getMainComponent().onPointerDownObserver.add(s=>{if(s.button===2){n.oncontextmenu=()=>!1;const i=this._plugin.getSelectionManager().getCurrentModel();console.log("selecionModel",i==null?void 0:i.type),this._RightMenu.handleContextMenu(s)}})})}_initRegisterComponent(){this._plugin.registerComponent(hr.name,hr),this._plugin.registerComponent(hs.name,hs),this._plugin.registerComponent(za.name,za),this._plugin.registerComponent(li.name,li)}resetLabel(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if(t==="locale")e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this.findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this.resetMenuLabel(e[t]));return e}resetMenuLabel(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetMenuLabel(n.children))}return e}resetMenuList(e){var t;(t=this._RightMenu)==null||t.setMenuList(e)}_getSelections(){var n;const e=(n=this._plugin)==null?void 0:n.getSelectionManager().getCurrentControls();return e==null?void 0:e.map(s=>{const i=s.model;return{startRow:i.startRow,startColumn:i.startColumn,endRow:i.endRow,endColumn:i.endColumn}})}setColumnWidth(e){if(e.key!=="Enter")return;const t=e.target.value,n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().setColumnWidth(n[0].startColumn,n[0].endColumn-n[0].startColumn+1,Number(t)),this._RightMenu.showRightMenu(!1)}setRowHeight(e){if(e.key!=="Enter")return;const t=e.target.value,n=this._getSelections();(n==null?void 0:n.length)===1&&this._plugin.getContext().getWorkBook().getActiveSheet().setRowHeights(n[0].startRow,n[0].endRow-n[0].startRow+1,Number(t)),this._RightMenu.showRightMenu(!1)}}class AS{constructor(e){this._barControl=e,this._sheetUl=[{locale:"sheetConfig.delete",onClick:(...t)=>{t[1].ref.hideSelect(),e.deleteSheet()}},{locale:"sheetConfig.copy",onClick:(...t)=>{t[1].ref.hideSelect(),e.copySheet()}},{locale:"sheetConfig.rename",onClick:(...t)=>{t[1].ref.hideSelect(),e.reNameSheet()}},{locale:"sheetConfig.changeColor",icon:"RightIcon",children:[{selectType:"jsx",label:"ColorPicker",onClick:t=>{e.setSheetColor(t)}}]},{locale:"sheetConfig.hide",border:!0,onClick:(...t)=>{t[1].ref.hideSelect(),e.hideSheet()}},{locale:"sheetConfig.unhide",onClick:(...t)=>{t[1].ref.hideSelect(),e.unHideSheet()}},{locale:"sheetConfig.moveLeft",border:!0,onClick:(...t)=>{t[1].ref.hideSelect(),e.moveSheet("left")}},{locale:"sheetConfig.moveRight",onClick:(...t)=>{t[1].ref.hideSelect(),e.moveSheet("right")}}],this._initializeData(),this._initializeObserver()}getMenuList(){return this._menuList}getSheetList(){return this._sheetList}getSheetBar(){return this._sheetBar}getDataId(){return this._dataId}_initializeObserver(){const e=this._barControl.getPlugin(),t=e.getContext(),n=t.getObserverManager(),i=t.getWorkBook().getUnitId();n.requiredObserver("onSheetBarDidMountObservable",Je.SPREADSHEET).add(o=>{this._sheetBar=o,this.resetSheetUl(),this._sheetBar.setValue({sheetList:this._sheetList,sheetUl:this._sheetUl,menuList:this._menuList,addSheet:()=>{this._barControl.addSheet()},selectSheet:(a,l)=>{this._dataId=l.item.sheetId;const u=e.getContext().getWorkBook().getSheetBySheetId(this._dataId);u&&u.activate()},contextMenu:a=>{const l=a.currentTarget;this._dataId=l.dataset.id,this._barControl.contextMenu(a)},changeSheetName:a=>{this._barControl.changeSheetName(a)},dragEnd:a=>{this._barControl.dragEnd(a)}})}),t.getContextObserver("onAfterChangeUILocaleObservable").add(()=>{this.resetSheetUl(),this._sheetBar.setValue({sheetUl:this._sheetUl})}),Be.getActionObservers().add(o=>{const u=o.action.getWorkBook().getUnitId();if(i!==u)return;const{data:c}=o;switch(c.actionName){case W.SET_SHEET_ORDER_ACTION:case W.INSERT_SHEET_ACTION:case W.SET_TAB_COLOR_ACTION:case W.REMOVE_SHEET_ACTION:case W.SET_WORKSHEET_NAME_ACTION:case W.SET_WORKSHEET_ACTIVATE_ACTION:case W.SET_WORKSHEET_STATUS_ACTION:{this._initializeData(),this._sheetBar.setValue({sheetList:this._sheetList,menuList:this._menuList});break}}})}_initializeData(){const n=this._barControl.getPlugin().getWorkbook().getSheets();this._menuList=n.map((s,i)=>({label:s.getName(),index:String(i),sheetId:s.getSheetId(),hidden:s.isSheetHidden(),selected:s.getStatus()===1,onClick:o=>{console.log("000000000");const a=o.currentTarget;this._dataId=a.dataset.id,s.showSheet(),s.activate()}})),this._sheetList=n.filter(s=>!s.isSheetHidden()).map((s,i)=>({sheetId:s.getSheetId(),label:s.getName(),icon:"NextIcon",index:String(i),selected:s.getStatus()===1,color:s.getTabColor(),onDown:o=>{const a=o.currentTarget;this._dataId=a.dataset.id},onClick:o=>{const a=o.currentTarget;this._dataId=a.dataset.id,s.activate()}})),this._sheetIndex=n.findIndex(s=>s.getStatus()===1),this._dataId=n[this._sheetIndex].getSheetId()}resetSheetUl(){const e=this._barControl.getPlugin().context.getLocale();this._sheetUl.forEach(t=>{t.label=e.get(t.locale)})}selectSheet(...e){}deleteSheet(){}sortMenu(e,t,n){}copySheet(){}addSheet(e,t){this._sheetBar.setValue({sheetList:this._sheetList,menuList:this._menuList},()=>{this._sheetBar.overGrid()})}reNameSheet(){this._sheetBar.reNameSheet(this._dataId)}hideSheet(){}unHideSheet(){this._sheetBar.ref.current.showSelect()}moveSheet(e){}changeSheetName(e){}contextMenu(e){this._sheetBar.contextMenu(e)}dragEnd(e){let t=[];Array.from(e).forEach(n=>{const s=this._sheetList.find(i=>i.sheetId===n.dataset.id);s&&t.push(s)}),this._sheetList=t,this._sheetBar.setValue({sheetList:t})}}class RS{constructor(e){this._barControl=e}deleteSheet(){const t=this._barControl.getPlugin().getWorkbook();t&&t.removeSheetBySheetId(this._barControl.getUIController().getDataId())}copySheet(){const e=this._barControl.getPlugin().getWorkbook(),n=e.getActiveSheet().copy(Sr.getSheetName());e&&e.insertSheet(e.getActiveSheetIndex()+1,n.getConfig())}setSheetColor(e){const s=this._barControl.getPlugin().getWorkbook().getSheetBySheetId(this._barControl.getUIController().getDataId());s&&s.setTabColor(e)}changeSheetName(e){const n=this._barControl.getUIController().getMenuList().find(a=>a.sheetId===this._barControl.getUIController().getDataId()),o=this._barControl.getPlugin().getContext().getWorkBook();if(n){const a=o.getSheetBySheetId(n.sheetId),l=e.target.innerText;a&&l!==a.getName()&&a.setName(l)}}addSheet(){this._barControl.getPlugin().getContext().getWorkBook().insertSheet()}moveSheet(e){const s=this._barControl.getPlugin().getContext().getWorkBook();switch(e){case"left":{const i=s.getActiveSheetIndex(),o=s.getActiveSheet();this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(o.getSheetId(),Math.max(i-1,0));break}case"right":{const i=s.getActiveSheetIndex(),o=s.getSheetSize(),a=s.getActiveSheet();this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(a.getSheetId(),Math.min(i+1,o));break}}}dragEnd(e){let t=[],n=this._barControl.getUIController().getDataId();Array.from(e).forEach(s=>{const i=this._barControl.getUIController().getSheetList().find(o=>o.sheetId===s.dataset.id);i&&t.push(i)}),console.log(n),t.forEach((s,i)=>{s.sheetId===n&&this._barControl.getPlugin().getContext().getWorkBook().setSheetOrder(s.sheetId,i)}),console.log(e)}hideSheet(){const n=this._barControl.getPlugin().getWorkbook().getSheetBySheetId(this._barControl.getUIController().getDataId());n&&n.hideSheet()}}class DS{constructor(e){this._plugin=e,this._apiController=new RS(this),this._uiController=new AS(this)}getPlugin(){return this._plugin}getUIController(){return this._uiController}getAPIController(){return this._apiController}selectSheet(...e){}hideSheet(){this._apiController.hideSheet()}unHideSheet(){this._uiController.unHideSheet()}addSheet(e,t){this._apiController.addSheet(),this._uiController.addSheet(e,t),this._uiController.getSheetBar().slideTabBar.getScrollbar().scrollRight()}deleteSheet(){this._apiController.deleteSheet(),this._uiController.deleteSheet()}moveSheet(e){this._apiController.moveSheet(e)}copySheet(){this._apiController.copySheet()}reNameSheet(){this._uiController.reNameSheet()}changeSheetName(e){this._apiController.changeSheetName(e),this._uiController.changeSheetName(e)}setSheetColor(e){this._apiController.setSheetColor(e)}contextMenu(e){this._uiController.contextMenu(e)}dragEnd(e){this._apiController.dragEnd(e),this._uiController.dragEnd(e)}}class Cl extends Xe{constructor(){super(...arguments),this.inputRef=Ve(),this.modalRef=Ve()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={modalData:{}}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onCellRangeModalDidMountObservable",Je.SPREADSHEET))==null||e.notifyObservers(this)}confirmRange(){var e;(e=this.inputRef.current)==null||e.value}setModal(e){this.setState({modalData:e})}render(){const{value:e,title:t,children:n,group:s,show:i}=this.state.modalData,o=this._render.renderFunction("Input"),a=this._render.renderFunction("Modal");if(!!i)return b(a,{isDrag:!0,visible:i,title:t,group:s,mask:!1},b(o,{ref:this.inputRef,readonly:!0,placeholder:n==null?void 0:n.placeholder,value:e}))}}class xS{constructor(e,t){var n;this.changeSkin=()=>{var s;(s=this._plugin.getContext().getObserverManager().getObserver("onAfterChangeUISkinObservable"))==null||s.notifyObservers(this._plugin.getContext().getWorkBook())},this.changeLocale=s=>{var i;this._plugin.getContext().getLocale().change(s),(i=this._plugin.getContext().getContextObserver("onAfterChangeUILocaleObservable"))==null||i.notifyObservers()},this._plugin=e,this._config=t,this._initRegisterComponent(),this._initialize(),this._defaultLayout=((n=this._config.layout)==null?void 0:n.sheetContainerConfig)||Cg}_initialize(){Be.getCommandObservers().add(({actions:e})=>{const t=this._plugin;if(!t||!e||e.length===0)return;const n=e[0],s=t.context.getWorkBook().getUnitId(),i=n.getWorkBook().getUnitId();if(s!==i)return;const o=n.getWorkBook().getActiveSheet();if(o)try{const a=t.getCanvasView();a&&(a.updateToSheet(o),t.getMainComponent().makeDirty(!0))}catch(a){console.info(a)}}),this._plugin.getContext().getObserverManager().requiredObserver("onSheetContainerDidMountObservable",Je.SPREADSHEET).add(e=>{this._sheetContainer=e,this._sheetContainer.setState({layout:this._defaultLayout,currentLocale:this._plugin.getContext().getLocale().options.currentLocale}),this._dragManager.handleDragAction(Ai(e))}),this._dragManager=new Ip(this._plugin)}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const t={ForwardIcon:this._render.renderFunction("ForwardIcon"),BackIcon:this._render.renderFunction("BackIcon"),BoldIcon:this._render.renderFunction("BoldIcon"),RightIcon:this._render.renderFunction("RightIcon"),ItalicIcon:this._render.renderFunction("ItalicIcon"),DeleteLineIcon:this._render.renderFunction("DeleteLineIcon"),UnderLineIcon:this._render.renderFunction("UnderLineIcon"),TextColorIcon:this._render.renderFunction("TextColorIcon"),FillColorIcon:this._render.renderFunction("FillColorIcon"),MergeIcon:this._render.renderFunction("MergeIcon"),TopBorderIcon:this._render.renderFunction("TopBorderIcon"),BottomBorderIcon:this._render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this._render.renderFunction("LeftBorderIcon"),RightBorderIcon:this._render.renderFunction("RightBorderIcon"),NoneBorderIcon:this._render.renderFunction("NoneBorderIcon"),FullBorderIcon:this._render.renderFunction("FullBorderIcon"),OuterBorderIcon:this._render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this._render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this._render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this._render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this._render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this._render.renderFunction("CenterAlignIcon"),RightAlignIcon:this._render.renderFunction("RightAlignIcon"),TopVerticalIcon:this._render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this._render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this._render.renderFunction("BottomVerticalIcon"),OverflowIcon:this._render.renderFunction("OverflowIcon"),BrIcon:this._render.renderFunction("BrIcon"),CutIcon:this._render.renderFunction("CutIcon"),TextRotateIcon:this._render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this._render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this._render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this._render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this._render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this._render.renderFunction("TextRotateRotationDownIcon"),SearchIcon:this._render.renderFunction("SearchIcon"),ReplaceIcon:this._render.renderFunction("ReplaceIcon"),LocationIcon:this._render.renderFunction("LocationIcon"),BorderDashDot:this._render.renderFunction("BorderDashDot"),BorderDashDotDot:this._render.renderFunction("BorderDashDotDot"),BorderDashed:this._render.renderFunction("BorderDashed"),BorderDotted:this._render.renderFunction("BorderDotted"),BorderHair:this._render.renderFunction("BorderHair"),BorderMedium:this._render.renderFunction("BorderMedium"),BorderMediumDashDot:this._render.renderFunction("BorderMediumDashDot"),BorderMediumDashDotDot:this._render.renderFunction("BorderMediumDashDotDot"),BorderMediumDashed:this._render.renderFunction("BorderMediumDashed"),BorderThick:this._render.renderFunction("BorderThick"),BorderThin:this._render.renderFunction("BorderThin")};for(let n in t)this._plugin.registerComponent(n,t[n]);this._plugin.registerModal(Cl.name,Cl)}getContentRef(){return this._sheetContainer.getContentRef()}getSplitLeftRef(){return this._sheetContainer.getSplitLeftRef()}getLayoutContainerRef(){return this._sheetContainer.getLayoutContainerRef()}}class Wa extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={color:"rgb(217,217,217)"}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))==null||e.notifyObservers(this)}setColor(e){this.setState({color:e})}render(){const e=this._render.renderFunction("RightIcon"),{color:t}=this.state,{label:n}=this.props;return b("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},b("span",{style:{display:"inline-block",borderBottom:`3px solid ${t}`}},n),b(e,null))}}const IS=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],OS=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],kS=[{locale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{locale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{locale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{locale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{locale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{locale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{locale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{locale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{locale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{locale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],NS=[{locale:"borderLine.borderNone",value:""},{customLabel:{name:"BorderThin"},value:"BorderThin"},{customLabel:{name:"BorderHair"},value:"BorderHair"},{customLabel:{name:"BorderDotted"},value:"BorderDotted"},{customLabel:{name:"BorderDashed"},value:"BorderDashed"},{customLabel:{name:"BorderDashDot"},value:"BorderDashDot"},{customLabel:{name:"BorderDashDotDot"},value:"BorderDashDotDot"},{customLabel:{name:"BorderMedium"},value:"BorderMedium"},{customLabel:{name:"BorderMediumDashed"},value:"BorderMediumDashed"},{customLabel:{name:"BorderMediumDashDot"},value:"BorderMediumDashDot"},{customLabel:{name:"BorderMediumDashDotDot"},value:"BorderMediumDashDotDot"},{customLabel:{name:"BorderThick"},value:"BorderThick"}],MS=[{locale:"merge.all",value:"all"},{locale:"merge.vertical",value:"vertical"},{locale:"merge.horizontal",value:"horizontal"},{locale:"merge.cancel",value:"cancel"}],FS=[{locale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{locale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{locale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],BS=[{locale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{locale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{locale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],LS=[{locale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{locale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{locale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],PS=[{locale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{locale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{locale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{locale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{locale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{locale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];class Va extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={img:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineBoldDidMountObservable"))==null||e.notifyObservers(this)}setLineType(e){this.setState({img:e})}getImg(e){const n={width:document.querySelector(".base-sheets-line-bold").offsetWidth},s=this._render.renderFunction(e);return b(s,{...n})}render(){const e=this._render.renderFunction("RightIcon"),{img:t}=this.state,{label:n}=this.props;return b("div",{style:{paddingBottom:"3px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},b("span",{className:"base-sheets-line-bold",style:{position:"relative"}},n,b("div",{style:{width:"100%",height:0,position:"absolute",left:0,bottom:"10px"}},t.length?this.getImg(t):"")),b(e,null))}}const HS="univer-color-select",US="univer-color-select-line";var bh={colorSelect:HS,colorSelectLine:US};class io extends Xe{componentDidMount(){var n;(n=this._context.getObserverManager().getObserver("onColorSelectDidMountObservable"))==null||n.notifyObservers(this);const e=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);let t=this.props.label;if(this.props.customLabel){const s=e==null?void 0:e.getRegisterComponent(this.props.customLabel.name);t=b(s,{...this.props.customLabel.props})}this.setState({label:t,color:"#000"})}setColor(e){this.setState({color:e})}getId(){return this.props.id}render(){return b("div",{className:bh.colorSelect},b("div",null,this.state.label),b("div",{className:bh.colorSelectLine,style:{background:this.state.color}}))}}class zS{constructor(e,t){this._colorSelect=[],this._plugin=e;const n=this._plugin.getPluginName();this._initRegisterComponent();const s=t||Eg;this._borderInfo={color:"rgb(217, 217, 217)",type:1},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",name:"undo",customLabel:{name:"ForwardIcon"},show:s.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},name:"redo",show:s.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",className:St.selectLabelString,name:"font",show:s.font,border:!0,onClick:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||o.notifyObservers(i)},children:OS},{type:1,tooltipLocale:"toolbar.fontSize",label:String(bo.fs),name:"fontSize",show:s.fontSize,onClick:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||o.notifyObservers(i)},onKeyUp:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||o.notifyObservers(i)},children:IS},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},active:!1,name:"bold",show:s.bold,onClick:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||o.notifyObservers(i)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},name:"italic",show:s.italic,onClick:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||o.notifyObservers(i)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},name:"strikethrough",show:s.strikethrough,onClick:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||o.notifyObservers(i)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},name:"underline",show:s.underline,onClick:i=>{var o;(o=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||o.notifyObservers(i)}},{type:5,tooltipLocale:"toolbar.textColor.main",customLabel:{name:n+io.name,props:{customLabel:{name:"TextColorIcon"},id:"textColor"}},hideSelectedIcon:!0,className:St.selectColorPickerParent,children:[{customLabel:{name:n+_r.name,props:{onClick:(i,o)=>{var l;const a=this._colorSelect.find(u=>u.getId()==="textColor");a==null||a.setColor(i),(l=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||l.notifyObservers(i)},lang:{collapseLocale:"colorPicker.collapse",customColorLocale:"colorPicker.customColor",confirmColorLocale:"colorPicker.confirmColor",cancelColorLocale:"colorPicker.cancelColor",changeLocale:"colorPicker.change"}}},className:St.selectColorPicker}],name:"textColor",show:s.textColor},{type:5,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:n+io.name,props:{customLabel:{name:"FillColorIcon"},id:"fillColor"}},hideSelectedIcon:!0,className:St.selectColorPickerParent,children:[{customLabel:{name:n+_r.name,props:{onClick:(i,o)=>{var l;const a=this._colorSelect.find(u=>u.getId()==="fillColor");a==null||a.setColor(i),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.notifyObservers(i)},lang:{collapseLocale:"colorPicker.collapse",customColorLocale:"colorPicker.customColor",confirmColorLocale:"colorPicker.confirmColor",cancelColorLocale:"colorPicker.cancelColor",changeLocale:"colorPicker.change"}}},className:St.selectColorPicker}],name:"fillColor",show:s.fillColor},{type:3,display:1,show:s.border,tooltipLocale:"toolbar.border.main",className:St.selectDoubleString,onClick:i=>{i&&this.setBorder(i)},name:"border",children:[...kS,{customLabel:{name:n+Wa.name,props:{locale:"borderLine.borderColor"}},unSelectable:!0,className:St.selectColorPickerParent,children:[{customLabel:{name:n+_r.name,props:{onClick:(i,o)=>this.handleLineColor(i,o),lang:{collapseLocale:"colorPicker.collapse",customColorLocale:"colorPicker.customColor",confirmColorLocale:"colorPicker.confirmColor",cancelColorLocale:"colorPicker.cancelColor",changeLocale:"colorPicker.change"}}},className:St.selectColorPicker,onClick:this.handleLineColor}]},{customLabel:{name:n+Va.name,props:{locale:"borderLine.borderSize"}},onClick:(...i)=>this.handleLineBold(i[1],i[2],i[0]),className:St.selectLineBoldParent,unSelectable:!0,children:NS}]},{type:5,tooltipLocale:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:s.mergeCell,onClick:i=>{this.setMerge(i)},name:"mergeCell",children:MS},{type:3,tooltipLocale:"toolbar.horizontalAlignMode.main",className:St.selectDoubleString,display:1,name:"horizontalAlignMode",show:s.horizontalAlignMode,onClick:i=>{this.setHorizontalAlignment(i)},children:FS},{type:3,tooltipLocale:"toolbar.verticalAlignMode.main",className:St.selectDoubleString,display:1,name:"verticalAlignMode",show:s.verticalAlignMode,onClick:i=>{this.setVerticalAlignment(i)},children:BS},{type:3,className:St.selectDoubleString,tooltipLocale:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:s.textWrapMode,onClick:i=>{this.setWrapStrategy(i)},children:LS},{type:3,className:St.selectDoubleString,name:"textRotateMode",tooltipLocale:"toolbar.textRotateMode.main",display:1,show:s.textRotateMode,onClick:i=>{this.setTextRotation(i)},children:PS}],this._moreText={more:"toolbar.toolMore",tip:"toolbar.toolMoreTip"},this._toolBarModel=new fw,this._toolBarModel.config=s,this._toolBarModel.toolList=this._toolList,this.init()}_changeToolBarState(e){var s,i,o,a,l;const n=this._plugin.getContext().getWorkBook().getActiveSheet();if(n){n.getCellMatrix();const u=e.getStrikeThrough(),c=e.getFontSize(),h=e.getFontWeight(),f=e.getFontFamily(),d=e.getFontStyle(),m=e.getUnderline(),g=e.getHorizontalAlignment(),p=e.getVerticalAlignment(),_=e.getTextRotation(),v=this._toolList.find(N=>N.name==="textRotateMode"),w=this._toolList.find(N=>N.name==="fontSize"),y=this._toolList.find(N=>N.name==="font"),A=this._toolList.find(N=>N.name==="bold"),I=this._toolList.find(N=>N.name==="italic"),R=this._toolList.find(N=>N.name==="strikethrough"),x=this._toolList.find(N=>N.name==="underline"),S=this._toolList.find(N=>N.name==="horizontalAlignMode"),k=this._toolList.find(N=>N.name==="verticalAlignMode");R&&(R.active=!!(u&&u.s)),y&&((s=y.children)==null||s.forEach(N=>{N.selected=f===N.value})),w&&((i=w.children)==null||i.forEach(N=>{N.selected=c===N.value})),A&&(A.active=!!h),I&&(I.active=!!d),x&&(x.active=!!(m&&m.s)),S&&((o=S.children)==null||o.forEach(N=>{N.selected=g===N.value})),v&&((a=v.children)==null||a.forEach(N=>{N.selected=_===N.value})),k&&((l=k.children)==null||l.forEach(N=>{N.selected=p===N.value})),this.resetToolBarList()}}init(){var e,t,n,s,i,o,a,l,u,c,h,f,d,m;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("ff",g):this.setFontFamily(g)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("fs",g):this.setFontSize(g)}),(n=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||n.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("bl",g?"1":"0"):this.setFontWeight(g)}),(s=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||s.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("it",g?"1":"0"):this.setFontStyle(g)}),(i=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||i.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("cl",g?"1":"0"):this.setStrikeThrough(g)}),(o=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||o.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("un",g?"1":"0"):this.setUnderline(g)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("fc",g):this.setFontColor(g)}),(l=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||l.add(g=>{this._plugin.getCellEditorController().isEditMode?this._plugin.getCellEditorController().richText.cellTextStyle.updateFormat("bg",g):this.setBackground(g)}),(u=this._plugin.getObserver("onToolBarDidMountObservable"))==null||u.add(g=>{this._toolBarComponent=g,this.resetToolBarList()}),(c=this._plugin.getObserver("onLineColorDidMountObservable"))==null||c.add(g=>{this._lineColor=g}),(h=this._plugin.getObserver("onLineBoldDidMountObservable"))==null||h.add(g=>{this._lineBold=g}),(f=this._plugin.getObserver("onColorSelectDidMountObservable"))==null||f.add(g=>{this._colorSelect.push(g)}),(d=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","core"))==null||d.add(()=>{this.resetToolBarList()}),(m=this._plugin.getObserver("onChangeSelectionObserver"))==null||m.add(g=>{const p=this._plugin.getSelectionManager(),_=p==null?void 0:p.getCurrentCell();_&&this._changeToolBarState(_)})}_initRegisterComponent(){const e=this._plugin.getPluginName();this._plugin.registerComponent(e+Wa.name,Wa),this._plugin.registerComponent(e+Va.name,Va),this._plugin.registerComponent(e+io.name,io),this._plugin.registerComponent(e+_r.name,_r)}resetLabel(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}findLocale(e){for(let t in e)if(t==="locale")e.label=this.resetLabel(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this.resetLabel(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this.findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this.resetToolListLabel(e[t]));return e}resetToolListLabel(e){for(let t=0;t<e.length;t++){let n=e[t];n=this.findLocale(n),n.children&&(n.children=this.resetToolListLabel(n.children))}return e}resetToolBarList(){const e=this._plugin.context.getLocale(),t=this.resetToolListLabel(this._toolList);this._toolBarComponent.setToolBar(t,{more:e.get(this._moreText.more),tip:e.get(this._moreText.tip)})}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontColor(e)}setBackground(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setBackground(e)}setFontSize(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontSize(e)}setFontFamily(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontFamily(e)}setFontWeight(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontWeight(e)}setFontStyle(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setFontStyle(e)}setStrikeThrough(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setStrikeThrough(e)}setUnderline(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setUnderline(e)}setMerge(e){const t=this._plugin.getSelectionManager().getActiveRange();switch(e){case"all":t==null||t.merge();break;case"vertical":t==null||t.mergeVertically();break;case"horizontal":t==null||t.mergeAcross();break;case"cancel":t==null||t.breakApart();break}}setHorizontalAlignment(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setHorizontalAlignment(e)}setVerticalAlignment(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setVerticalAlignment(e)}setWrapStrategy(e){var t;(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setWrapStrategy(e)}setTextRotation(e){var t,n;e==="v"?(t=this._plugin.getSelectionManager().getActiveRangeList())==null||t.setVerticalText(1):(n=this._plugin.getSelectionManager().getActiveRangeList())==null||n.setTextRotation(e)}setBorder(e){const t=this._plugin.getSelectionManager().getCurrentControls();t&&t.length>0&&(t==null||t.forEach(n=>{const s=n.model,i={startRow:s.startRow,startColumn:s.startColumn,endRow:s.endRow,endColumn:s.endColumn};this._plugin.getContext().getWorkBook().getActiveSheet().getRange(i).setBorderByType(e,this._borderInfo.color,this._borderInfo.type)}))}handleLineColor(e,t){t.stopPropagation(),this._lineColor.setColor(e),this._borderInfo.color=e}handleLineBold(e,t,n){console.log("handleLineBold===",e,t,n),t===7?t=8:t===8?t=9:t===9?t=10:t===10?t=11:t===11&&(t=13),n.stopPropagation(),e&&(this._lineBold.setLineType(e),this._borderInfo.type=t)}addToolButton(e){this._toolList.findIndex(n=>n.name===e.name)>-1||(this._toolList.push(e),this._toolBarComponent&&this.resetToolBarList())}}class WS{constructor(e){this._plugin=e,this._ModalGroup=[],this.init()}init(){var e;(e=this._plugin.getObserver("onModalGroupDidMountObservable"))==null||e.add(t=>{this._ModalGroupComponent=t})}addModal(e,t){var s;this._ModalGroup.findIndex(i=>i===e)<0&&(this._plugin.registerComponent(e,t),this._ModalGroup.push(e),(s=this._ModalGroupComponent)==null||s.setModalGroup(this._ModalGroup))}getModal(e){return this._ModalGroupComponent.getModalGroup().find(n=>n.constructor.name===e)}}class VS{constructor(e){this._plugin=e,this._initialize()}_initialize(){var n;this._plugin.context.getObserverManager().requiredObserver("onFormulaBarDidMountObservable",Je.SPREADSHEET).add(s=>{this._formulaBar=s,this._namedRanges=this._plugin.getContext().getWorkBook().getConfig().namedRanges;const i=this._namedRanges.map(o=>({value:o.name,label:o.name}));this._formulaBar.setNamedRanges(i)}),(n=this._plugin.getObserver("onChangeSelectionObserver"))==null||n.add(s=>{const i=s.model.currentCell;if(i){let o;if(i.isMerged){const l=i.mergeInfo;o={startRow:l.startRow,endRow:l.endRow,startColumn:l.startColumn,endColumn:l.endColumn}}else{const{row:l,column:u}=i;o={startRow:l,endRow:l,startColumn:u,endColumn:u}}const a=this._plugin.getWorkbook().getActiveSheet().getRange(o).getObjectValue({isIncludeStyle:!0});if(a){let l=String(a.m||a.v||"");const u=this._cellInputExtensionManager.handle({row:o.startRow,column:o.startColumn,value:l});u&&(l=u.value),this._formulaBar.setFormulaContent(l)}}}),this._cellInputExtensionManager=new Ds}}class GS extends Zo{execute(){this.actionDataList.forEach(t=>{if(t.operation!=null&&!Dr.hasExtension(t))return!1;if(t.actionName===W.INSERT_ROW_ACTION){const{sheetId:n,rowCount:s,rowIndex:i}=t,o=G.deepClone(this._plugin.getWorkbook().getConfig().namedRanges);for(let a=0;a<o.length;a++){const l=o[a].range.rangeData;if(i>l.endRow)continue;i>=l.startRow&&i<=l.endRow||(l.startRow+=s),l.endRow+=s;const u={actionName:W.SET_NAMED_RANGE_ACTION,namedRange:o[a],sheetId:n};this.push(u)}}})}}class XS extends Bl{get zIndex(){return 3}create(e){return new GS(e,this._plugin)}}class $S extends or{constructor(e={}){super(Je.SPREADSHEET),this._config=G.deepMerge(tw,e)}register(e){let t=Ai(this._sheetContainerController.getContentRef());this._canvasEngine=e,e.setContainer(t),window.addEventListener("resize",()=>{e.resize()})}initialize(e){var l,u,c,h;this.context=e,e.getLocale().load({en:QE,zh:JE});const t=e.getWorkBook().getConfig(),n=this._initContainer(this._config.container),s={skin:t.skin||"default",layout:this._config.layout,container:n,onDidMount:()=>{},context:e};this._componentList=new Map;const i=(l=this._config.layout)==null?void 0:l.sheetContainerConfig,o=(u=this._config.layout)==null?void 0:u.rightMenuConfig,a=(c=this._config.layout)==null?void 0:c.toolBarConfig;this._modalGroupController=new WS(this),this._sheetContainerController=new xS(this,s),i!=null&&i.rightMenu&&(this._rightMenuControl=new SS(this,o)),i!=null&&i.toolBar&&(this._toolBarControl=new zS(this,a)),i!=null&&i.infoBar&&(this._infoBarControl=new yS(this)),i!=null&&i.sheetBar&&(this._sheetBarControl=new DS(this)),this._cellEditorController=new CS(this),this._antLineController=new vS(this),i!=null&&i.countBar&&(this._countBarController=new TS(this)),i!=null&&i.formulaBar&&(this._formulaBarController=new VS(this)),(h=this.getObserver("onSheetContainerDidMountObservable"))==null||h.add(()=>{this._initializeRender(e)}),Is(b(bS,{changeLocale:this._sheetContainerController.changeLocale,changeSkin:this._sheetContainerController.changeSkin,config:s}),n),this.registerExtension()}_initContainer(e){let t=null;if(typeof e=="string"){const n=document.getElementById(e);n==null?(t=document.createElement("div"),t.id=e):t=n}else d_(e)?t=e:(t=document.createElement("div"),t.id="universheet");return t}onMounted(e){qE(this),this.initialize(e),Be.getActionObservers().add(t=>{const n=this.getContext().getWorkBook().getUnitId(),s=t.action,i=s.getDoActionData(),o=s.getWorkBook().getUnitId();n===o&&i.actionName===W.SET_NAMED_RANGE_ACTION&&i.namedRange})}get config(){return this._config}_initializeRender(e){var n,s;const t=(n=this.getPluginByName(Je.BASE_RENDER))==null?void 0:n.getEngine();this.register(t),this._canvasView==null&&(this._canvasView=new Cw(t,this)),(s=this.context.getContextObserver("onSheetRenderDidMountObservable"))==null||s.notifyObservers()}onDestroy(){super.onDestroy(),ZE(this),this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._namedRangeActionExtensionFactory)}registerExtension(){const e=this.context.getCommandManager().getActionExtensionManager().getRegister();this._namedRangeActionExtensionFactory=new XS(this),e.add(this._namedRangeActionExtensionFactory)}addButton(e){this._addButtonFunc(e)}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}getMainScene(){return this._canvasEngine.getScene(jt.MAIN_SCENE)}getSheetView(){return this.getCanvasView().getSheetView()}getSelectionManager(){var e;return(e=this.getSheetView())==null?void 0:e.getSelectionManager()}getCurrentControls(){var e;return(e=this.getSelectionManager())==null?void 0:e.getCurrentControls()}getSelectionShape(){return this._canvasEngine}getMainComponent(){return this.getSheetView().getSpreadsheet()}getLeftTopComponent(){return this.getSheetView().getSpreadsheetLeftTopPlaceholder()}getRowComponent(){return this.getSheetView().getSpreadsheetRowTitle()}getColumnComponent(){return this.getSheetView().getSpreadsheetColumnTitle()}getSpreadsheetSkeleton(){return this.getSheetView().getSpreadsheetSkeleton()}getWorkbook(){return this.context.getWorkBook()}getRightMenuControl(){return this._rightMenuControl}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSheetBarControl(){return this._sheetBarControl}getCellEditorController(){return this._cellEditorController}getModalGroupControl(){return this._modalGroupController}getSheetContainerControl(){return this._sheetContainerController}addRightMenu(e){this._rightMenuControl&&this._rightMenuControl.addItem(e)}addToolButton(e){this._toolBarControl&&this._toolBarControl.addToolButton(e)}registerComponent(e,t,n){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}registerModal(e,t){this._modalGroupController.addModal(e,t)}}const YS="univer-cell-range",jS="univer-cell-modal-icon";var vh={cellRange:YS,cellModalIcon:jS};class KS extends Xe{constructor(){super(...arguments),this.inputRef=Ve()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this._group=[{label:this.props.confirmText,type:"primary",onClick:this.confirmRange}],this.state={show:!1,value:this.props.value}}changeInput(e){const t=e.target.value;this.setState({value:t})}confirmRange(){var t;const e=(t=this.inputRef.current)==null?void 0:t.value;this.setState({value:e})}handleClick(){const{onClick:e}=this.props;e==null||e()}render(){const{placeholder:e,value:t,onTableClick:n}=this.props,s=this._render.renderFunction("Input"),i=this._render.renderFunction("TableIcon");return b("div",{className:vh.cellRange},b(s,{onClick:this.handleClick.bind(this),placeholder:e,value:t,onChange:this.changeInput}),b("span",{className:vh.cellModalIcon,onClick:n},b(i,null)))}}var vu=(r=>(r.SET_FORMULA_RANGE_DATA_ACTION="SetFormulaRangeDataAction",r))(vu||{});const ZS={formulaData:{"workbook-01":{"sheet-0003":{11:{6:{formula:"=E12*F12",row:11,column:6,sheetId:"sheet-0003"}},12:{6:{formula:"=E13*F13",row:12,column:6,sheetId:"sheet-0003"}},13:{6:{formula:"=LAMBDA(x,x+2)(E14)",row:13,column:6,sheetId:"sheet-0003"}},19:{6:{formula:"=SUM(G12:G19)",row:19,column:6,sheetId:"sheet-0003"}}}}}},qS=[{locale:"formula.formulaMore.Math"},{locale:"formula.formulaMore.Statistical"},{locale:"formula.formulaMore.Lookup"},{locale:"formula.formulaMore.universheet"},{locale:"formula.formulaMore.dataMining"},{locale:"formula.formulaMore.Database"},{locale:"formula.formulaMore.Date"},{locale:"formula.formulaMore.Filter"},{locale:"formula.formulaMore.Financial"},{locale:"formula.formulaMore.Engineering"},{locale:"formula.formulaMore.Logical"},{locale:"formula.formulaMore.Operator"},{locale:"formula.formulaMore.Text"},{locale:"formula.formulaMore.Parser"},{locale:"formula.formulaMore.Array"},{locale:"formula.formulaMore.other"}],JS=[{n:"SUMIF",t:0,dLocale:"formula.functionList.SUMIF.d",p:[{nameLocale:"formula.functionList.SUMIF.p.range.name",detailLocale:"formula.functionList.SUMIF.p.range.detail",example:"A1:A10"},{nameLocale:"formula.functionList.SUMIF.p.rangeAll.name",detailLocale:"formula.functionList.SUMIF.p.rangeAll.detail",example:'">20"'},{nameLocale:"formula.functionList.SUMIF.p.range1.name",detailLocale:"formula.functionList.SUMIF.p.range1.detail",example:"B1:B10"}]},{n:"SUMIF1",t:1,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF2",t:2,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF3",t:3,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF4",t:4,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF5",t:5,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF6",t:6,dLocale:"formula.functionList.SUMIF.d"},{n:"SUMIF7",t:7,dLocale:"formula.functionList.SUMIF.d"}],Pt="formula",QS={show:!0};var Ig=(r=>(r.AUTOMATIC="Automatic",r.MANUAL="Manual",r.AUTOMATIC_EXCEPT_TABLE="AutomaticExceptTable",r))(Ig||{});function Ch(r,e){const t=r.getContext().getPluginManager().getRequirePluginByName(Pt).getFormulaController().getDataModel(),n=G.deepClone(t.getFormulaData());return t.setFormulaData(e),n}class eA extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,formulaData:this.do()}}do(){return this.redo()}redo(){const{_workbook:e}=this,{formulaData:t}=this._doActionData;return Ch(e,t)}undo(){const{_workbook:e}=this,{formulaData:t}=this._oldActionData;Ch(e,t)}validate(){return!1}}Be.register(vu.SET_FORMULA_RANGE_DATA_ACTION,eA);var Ee=(r=>(r.DIV_BY_ZERO="#DIV/0!",r.NAME="#NAME!",r.VALUE="#VALUE!",r.NUM="#NUM!",r.NA="#NA!",r.CYCLE="#CYCLE!",r.REF="#REF!",r.SPILL="#SPILL!",r.CALC="#CALC!",r.ERROR="#ERROR!",r.CONNECT="#GETTING_DATA",r.NULL="#NULL!",r))(Ee||{});const tA=new Set(["#DIV/0!","#NAME!","#VALUE!","#NUM!","#NA!","#CYCLE!","#REF!","#SPILL!","#CALC!","#ERROR!","#GETTING_DATA","#NULL!"]),ui="P_1",Ii="R_1",Vo="L_1",Og="LR_1";class nt{constructor(){this._children=[]}getLambdaId(){return this._lambdaId}setLambdaId(e){this._lambdaId=e}getLambdaPrivacyVar(){return this._lambdaPrivacyVar}setLambdaPrivacyVar(e){this._lambdaPrivacyVar=e}getLambdaParameter(){return this._lambdaParameter}setLambdaParameter(e){this._lambdaParameter=e}getParent(){return this._parent}setParent(e){this._parent=e}getChildren(){return this._children}setChildren(e){this._children=e}addChildren(e){this._children.push(e)}getToken(){return this._token}setToken(e){this._token=e}changeToParent(e){const t=this.getParent();t&&t.removeChild(this),this.setParent(e),e.getChildren().push(this)}removeChild(e){const t=this.getChildren(),n=t.length;for(let s=0;s<n;s++)if(t[s]===e){t.splice(s,1);return}}serialize(){const e=this.getToken(),t=this.getChildren(),n=[],s=t.length;for(let i=0;i<s;i++){const o=t[i];o instanceof nt?n.push(o.serialize()):n.push(o)}return{token:e,children:n}}}var gn=(r=>(r.PLUS="+",r.MINUS="-",r.MULTIPLY="*",r.DIVIDED="/",r.CONCATENATE="&",r.POWER="^",r.EQUALS="=",r.NOT_EQUAL="<>",r.GREATER_THAN=">",r.GREATER_THAN_OR_EQUAL=">=",r.LESS_THAN="<",r.LESS_THAN_OR_EQUAL="<=",r))(gn||{}),$e=(r=>(r.EQUALS="=",r.NOT_EQUAL="<>",r.GREATER_THAN=">",r.GREATER_THAN_OR_EQUAL=">=",r.LESS_THAN="<",r.LESS_THAN_OR_EQUAL="<=",r))($e||{});const El=new Map([["<>",3],["<",3],[">=",3],["=",3],[">",3],["<=",3],["&",2],["+",2],["-",2],["/",1],["*",1],["^",0]]),ci=new Set(El.keys()),nA=new Set(["=","<>",">",">=","<","<="]);var _t=(r=>(r.OPEN_BRACKET="(",r.CLOSE_BRACKET=")",r.COMMA=",",r.SINGLE_QUOTATION="'",r.DOUBLE_QUOTATION='"',r.OPEN_BRACES="{",r.CLOSE_BRACES="}",r.COLON=":",r))(_t||{}),Ps=(r=>(r.PERCENTAGE="%",r.POUND="#",r))(Ps||{});const rA=new Set(["%","#"]);var nn=(r=>(r.AT="@",r.MINUS="-",r))(nn||{});class ua{constructor(e){this._formulaString=e,this._upLevel=0,this._segment="",this._bracketState=[],this._bracesState=0,this._singleQuotationState=0,this._doubleQuotationState=0,this._lambdaState=!1,this._colonState=!1}_resetCurrentLexerNode(){this._currentLexerNode=new nt}_resetSegment(){this._segment=""}_pushNodeToChildren(e,t=!1){if(e!==""){const n=this._currentLexerNode.getChildren();if(!(e instanceof nt)&&this.isColonOpen()){const s=new nt;s.setToken(e),s.setParent(this._currentLexerNode),e=s}t?n.unshift(e):n.push(e)}this.isColonOpen()&&(this._setAncestorCurrentLexerNode(),this._closeColon())}_openBracket(e=0){this._bracketState.push(e)}_closeBracket(){this._bracketState.pop()}_getCurrentBracket(){const e=this._bracketState;return e[e.length-1]}_openBraces(){this._bracesState+=1}_closeBraces(){this._bracesState-=1}_openSingleQuotation(){this._singleQuotationState+=1}_closeSingleQuotation(){this._singleQuotationState-=1}_openDoubleQuotation(){this._doubleQuotationState+=1}_closeDoubleQuotation(){this._doubleQuotationState-=1}_openLambda(){this._lambdaState=!0}_closeLambda(){this._lambdaState=!1}_openColon(e){this._upLevel=e,this._colonState=!0}_closeColon(){this._upLevel=0,this._colonState=!1}getUpLevel(){return this._upLevel}isColonClose(){return this._colonState===!1}isColonOpen(){return this._colonState===!0}isDoubleQuotationClose(){return this._doubleQuotationState===0}isLambdaOpen(){return this._lambdaState===!0}isLambdaClose(){return this._lambdaState===!1}isSingleQuotationClose(){return this._singleQuotationState===0}isBracesClose(){return this._bracesState===0}isBracketClose(){return this._bracketState.length===0}_getLastChildCurrentLexerNode(){const e=this._currentLexerNode.getChildren();if(e&&e.length>0){const t=e[e.length-1];if(t instanceof nt)return t}return!1}_getLastChildCurrent(){const e=this._currentLexerNode.getChildren();return e&&e.length>0?e[e.length-1]:!1}_setParentCurrentLexerNode(){const e=this._currentLexerNode.getParent();return e?(this._currentLexerNode=e,!0):!1}_setAncestorCurrentLexerNode(){var n,s,i,o;const e=(n=this._currentLexerNode)==null?void 0:n.getParent();let t=!1;e&&e.getToken()===Vo?(s=e==null?void 0:e.getParent())!=null&&s.getParent()&&(this._currentLexerNode=(i=this._currentLexerNode.getParent())==null?void 0:i.getParent().getParent(),t=!0):e!=null&&e.getParent()&&(this._currentLexerNode=this._currentLexerNode.getParent().getParent(),t=!0);for(let a=0;a<this._upLevel;a++)this._currentLexerNode=(o=this._currentLexerNode)==null?void 0:o.getParent(),this._currentLexerNode?t=!0:t=!1;return t}_segmentCount(){return this._segment.trim().length}_pushSegment(e){this._segment+=e}_setCurrentLexerNode(e,t=!1){this._pushNodeToChildren(e,t),e.setParent(this._currentLexerNode),this._currentLexerNode=e}_newAndPushCurrentLexerNode(e,t=!1){const n=new nt;n.setToken(e),this._setCurrentLexerNode(n,t)}_getTopNode(e){let t=e;for(;t.getParent();)t=t.getParent();return t}_removeLastChild(){this._currentLexerNode.getChildren().splice(-1)}_findPreviousToken(e,t){for(;t>=0;){const n=e[t];if(n!==" ")return n;t--}}getCurrentLexerNode(){return this._currentLexerNode}treeMaker(){return this._resetCurrentLexerNode(),this._currentLexerNode.setToken(Ii),this._nodeMaker(this._formulaString),this._currentLexerNode=this._getTopNode(this._currentLexerNode),this._currentLexerNode}suffixExpressionHandler(e){var o,a;const t=e.getChildren();if(!t)return;const n=t.length,s=[],i=[];for(let l=0;l<n;l++){const u=t[l];if(u instanceof nt)this.suffixExpressionHandler(u),s.push(u);else{const c=u.trim();if(c==="")continue;if(ci.has(c)){for(;i.length>0;){const h=(o=i[i.length-1])==null?void 0:o.trim();if(!h||h===_t.OPEN_BRACKET)break;const f=El.get(h),d=El.get(c);if(!f||!d)break;if(d>f)s.push(i.pop());else break}i.push(u)}else if(c===_t.OPEN_BRACKET)i.push(u);else if(c===_t.CLOSE_BRACKET)for(;i.length>0;){const h=(a=i[i.length-1])==null?void 0:a.trim();if(!h)break;if(h===_t.OPEN_BRACKET){i.pop();break}s.push(i.pop())}else s.push(u)}}for(;i.length>0;)s.push(i.pop());e.setChildren(s)}_negativeCondition(e){return!!(ci.has(e)||e===_t.OPEN_BRACKET||e===_t.COMMA)}_nodeMaker(e){e.substring(0,1)===gn.EQUALS&&(e=e.substring(1));const t=e.split(""),n=t.length;let s=0;for(this._resetSegment();s<n;){const i=t[s];if(i===_t.OPEN_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())if(this._segmentCount()>0||this.isLambdaOpen()){this.isLambdaClose()&&(this._newAndPushCurrentLexerNode(this._segment),this._resetSegment()),this._openBracket(1),this._closeLambda();const o=t[s+1];if(o&&o===_t.CLOSE_BRACKET){if(!this._setParentCurrentLexerNode()&&s!==n-1)return Ee.VALUE;s++}else o&&this._newAndPushCurrentLexerNode(ui)}else this._pushNodeToChildren(i),this._openBracket(0);else if(i===_t.CLOSE_BRACKET&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){this._pushNodeToChildren(this._segment),this._resetSegment();const o=this._getCurrentBracket();if(o===0)this._pushNodeToChildren(i);else if(o===1){const a=t[s+1];if(a&&a===_t.OPEN_BRACKET){if(!this._setParentCurrentLexerNode()&&s!==n-1)return Ee.VALUE;this._newAndPushCurrentLexerNode(Vo,!0),this._openLambda()}else if(!this._setAncestorCurrentLexerNode()&&s!==n-1)return Ee.VALUE}else return Ee.VALUE;this._closeBracket()}else if(i===_t.OPEN_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(i),this._openBraces();else if(i===_t.CLOSE_BRACES&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose())this._pushSegment(i),this._pushNodeToChildren(this._segment),this._resetSegment(),this._closeBraces();else if(i===_t.DOUBLE_QUOTATION&&this.isSingleQuotationClose()&&this.isBracesClose()){if(this.isDoubleQuotationClose())this._openDoubleQuotation();else{const o=t[s+1];o&&o===_t.DOUBLE_QUOTATION?s++:this._closeDoubleQuotation()}this._pushSegment(i)}else if(i===_t.SINGLE_QUOTATION&&this.isDoubleQuotationClose()){if(this.isSingleQuotationClose())this._openSingleQuotation();else{const o=t[s+1];o&&o===_t.SINGLE_QUOTATION?s++:this._closeSingleQuotation()}this._pushSegment(i)}else if(i===_t.COMMA&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose())if(this._getCurrentBracket()===1){if(this._pushNodeToChildren(this._segment),this._resetSegment(),!this._setParentCurrentLexerNode()&&s!==n-1)return Ee.VALUE;this._newAndPushCurrentLexerNode(ui)}else return Ee.VALUE;else if(i===_t.COLON&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()&&this.isBracesClose()){const o=new nt;o.setToken(i);const a=new nt;a.setToken(ui),a.setParent(o);const l=new nt;l.setToken(ui),l.setParent(o),o.getChildren().push(a,l);let u=o,c=0;if(this._segmentCount()>0){let h,f,d=0;new RegExp(nn.MINUS,"g").test(this._segment)&&(h=new nt,h.setToken(nn.MINUS),d++),new RegExp(nn.AT,"g").test(this._segment)&&(f=new nt,f.setToken(nn.AT),h&&(h.addChildren(f),f.setParent(h)),d++),d>0&&(this._segment=this._segment.slice(d)),c=d,f?(f.addChildren(o),o.setParent(f),f.getParent()?u=f.getParent():u=f):h&&(u=h,h.addChildren(o),o.setParent(h));const m=new nt;m.setToken(this._segment),m.setParent(a),a.getChildren().push(m),this._resetSegment()}else{const h=this._getLastChildCurrentLexerNode();h&&h.changeToParent(a)}this._setCurrentLexerNode(u),this._currentLexerNode=l,this._openColon(c)}else if(rA.has(i)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){this._pushNodeToChildren(this._segment);const o=new nt;o.setToken(i);const a=this._getLastChildCurrent();a instanceof nt?a.changeToParent(o):a!==!1&&(o.getChildren().push(a),this._removeLastChild()),this._pushNodeToChildren(o),o.setParent(this._currentLexerNode),this._resetSegment()}else if(ci.has(i)&&this.isSingleQuotationClose()&&this.isDoubleQuotationClose()){let o=this._segment.trim();if(i===gn.MINUS&&o===""){const a=this._findPreviousToken(t,s-1)||"";if(this._negativeCondition(a)){this._pushSegment(gn.MINUS),s++;continue}}else this._segment.length>0&&o===""?o=this._segment:(this._pushNodeToChildren(this._segment),o="");if(i===gn.LESS_THAN||i===gn.GREATER_THAN){const a=t[s+1];a&&ci.has(i+a)?(this._pushNodeToChildren(o+i+a),s++):this._pushNodeToChildren(o+i)}else this._pushNodeToChildren(o+i);this._resetSegment()}else this._pushSegment(i);s++}this._pushNodeToChildren(this._segment)}}const _n=xr.create(),Gt=Hl.create();var qr=(r=>(r.FALSE="FALSE",r.TRUE="TRUE",r))(qr||{}),Oi=(r=>(r[r.SUCCESS=0]="SUCCESS",r[r.ERROR=1]="ERROR",r))(Oi||{}),zr=(r=>(r.ALL="#All",r.DATA="#Data",r.HEADERS="#Headers",r.TOTALS="#Totals",r))(zr||{}),rr=(r=>(r[r.FRONT=0]="FRONT",r[r.BACK=1]="BACK",r))(rr||{}),et=(r=>(r.REFERENCE="ReferenceNode",r.VALUE="ValueNode",r.OPERATOR="OperatorNode",r.FUNCTION="FunctionNode",r.LAMBDA="LambdaNode",r.LAMBDA_PARAMETER="LambdaNodeParameter",r.ERROR="ErrorNode",r.BASE="Base",r.ROOT="Root",r.UNION="UnionNode",r.PREFIX="PrefixNode",r.SUFFIX="SuffixNode",r))(et||{});const Gn=new Map([["ReferenceNode",7],["ValueNode",9],["OperatorNode",8],["FunctionNode",6],["LambdaNode",1],["LambdaNodeParameter",2],["Root",10],["UnionNode",3],["PrefixNode",4],["SuffixNode",5]]);class bn{constructor(e){this._token=e,this._children=[],this._calculateState=!1,this._async=!1,this._address=!1}get nodeType(){return et.BASE}isAsync(){return this._async}isAddress(){return this._address}setAsync(){this._async=!0}setAddress(){this._address=!0}getParent(){return this._parent}setParent(e){this._parent=e,e.addChildren(this)}getChildren(){return this._children}addChildren(...e){this._children.push(...e)}getToken(){return this._token}setValue(e){this._valueObject=e}getValue(){return this._valueObject}isCalculated(){return this._calculateState}setCalculated(){this._calculateState=!0}execute(e,t){}async executeAsync(e){return Promise.resolve(Oi.SUCCESS)}serialize(){const e=this.getToken(),t=this.getChildren(),n=[],s=t.length;for(let o=0;o<s;o++){const a=t[o];n.push(a.serialize())}const i={token:e,nodeType:this.nodeType};return s>0&&(i.children=n),i}}class Xn{get zIndex(){return 0}create(e,t){let n;return e instanceof nt?n=e.getToken():n=e,new bn(n)}checkAndCreateNodeType(e,t){return!1}}class wl extends bn{get nodeType(){return et.ROOT}execute(){const t=this.getChildren()[0];this.setValue(t.getValue())}}class sA extends Xn{get zIndex(){return Gn.get(et.ROOT)||100}checkAndCreateNodeType(e){return e instanceof nt&&e.getToken()===Ii?new wl(Ii):!1}}_n.add(new sA);class Cu{isErrorObject(){return!1}isAsyncObject(){return!1}isReferenceObject(){return!1}isValueObject(){return!1}}const kg=class extends Cu{constructor(r){super(),this._errorType=r}getErrorType(){return this._errorType}isErrorObject(){return!0}static create(r){if(this.errorMap.has(r))return this.errorMap.get(r);{const e=new kg(r);return this.errorMap.set(r,e),e}}};let Ie=kg;Ie.errorMap=new Map;class Nt extends bn{constructor(e){super(e),this._errorValueObject=Ie.create(e)}get nodeType(){return et.ERROR}getValue(){return this._errorValueObject}static create(e){return new Nt(e)}}class Xt{get name(){return""}isAsync(){return!1}isAddress(){return!1}calculate(...e){return Ie.create(Ee.VALUE)}checkArrayType(e){return e.isReferenceObject()||e.isValueObject()&&e.isArray()}static create(){return this.functionMap.has(this.name)?this.functionMap.get(this.name):new this}}Xt.functionMap=new Map;const Ng="COMPARE";class iA extends Xt{get name(){return Ng}setCompareType(e){this._compareType=e}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Ie.create(Ee.VALUE);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().compare(t.toArrayValueObject(),this._compareType):this.checkArrayType(e)?n=e.toArrayValueObject().compare(t,this._compareType):this.checkArrayType(t)?n=e.compare(t.toArrayValueObject(),this._compareType):n=e.compare(t,this._compareType),n}}Gt.add(Ng,iA.create());const Mg="DIVIDED";class oA extends Xt{get name(){return Mg}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Ie.create(Ee.VALUE);if(t.getValue()===0)return Ie.create(Ee.DIV_BY_ZERO);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().divided(t.toArrayValueObject()):this.checkArrayType(e)?n=e.toArrayValueObject().divided(t):this.checkArrayType(t)?n=e.divided(t.toArrayValueObject()):n=e.divided(t),n}}Gt.add(Mg,oA.create());const Fg="MINUS";class aA extends Xt{get name(){return Fg}calculate(e,t){return e.isErrorObject()||t.isErrorObject()?Ie.create(Ee.VALUE):e.minus(t)}}Gt.add(Fg,aA.create());const Bg="MULTIPLY";class lA extends Xt{get name(){return Bg}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Ie.create(Ee.VALUE);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().multiply(t.toArrayValueObject()):this.checkArrayType(e)?n=e.toArrayValueObject().multiply(t):this.checkArrayType(t)?n=e.multiply(t.toArrayValueObject()):n=e.multiply(t),n}}Gt.add(Bg,lA.create());const Lg="PLUS";class uA extends Xt{get name(){return Lg}calculate(e,t){if(e.isErrorObject()||t.isErrorObject())return Ie.create(Ee.VALUE);let n;return this.checkArrayType(e)&&this.checkArrayType(t)?n=e.toArrayValueObject().plus(t.toArrayValueObject()):this.checkArrayType(e)?n=e.toArrayValueObject().plus(t):this.checkArrayType(t)?n=e.plus(t.toArrayValueObject()):n=e.plus(t),n}}Gt.add(Lg,uA.create());const Pg="UNION";class cA extends Xt{get name(){return Pg}setCompareType(e){this._compareType=e}calculate(e,t){return e.isErrorObject()||t.isErrorObject()||!e.isReferenceObject()||!t.isReferenceObject()?Ie.create(Ee.REF):(e=e,t=t,e.isCell()&&t.isCell()||e.isRow()&&t.isRow()||e.isColumn()&&t.isColumn()?e.unionBy(t):Ie.create(Ee.REF))}}Gt.add(Pg,cA.create());function Hg(r){let e;switch(r){case $e.EQUALS:e=$e.NOT_EQUAL;break;case $e.GREATER_THAN:e=$e.LESS_THAN_OR_EQUAL;break;case $e.GREATER_THAN_OR_EQUAL:e=$e.LESS_THAN;break;case $e.LESS_THAN:e=$e.GREATER_THAN_OR_EQUAL;break;case $e.LESS_THAN_OR_EQUAL:e=$e.GREATER_THAN;break;case $e.NOT_EQUAL:e=$e.EQUALS;break}return e}function hA(r){return""}class ca extends Cu{constructor(e){super(),this._rawValue=e}isValueObject(){return!0}getValue(){return 0}getArrayValue(){return[]}setValue(e){}setArrayValue(e){}isArray(){return!1}isString(){return!1}isNumber(){return!1}isBoolean(){return!1}isError(){return!1}getNegative(){return Ie.create(Ee.VALUE)}getReciprocal(){return Ie.create(Ee.VALUE)}plus(e){return Ie.create(Ee.VALUE)}minus(e){return Ie.create(Ee.VALUE)}multiply(e){return Ie.create(Ee.VALUE)}divided(e){return Ie.create(Ee.VALUE)}compare(e,t){return Ie.create(Ee.VALUE)}concatenateFront(e){return Ie.create(Ee.VALUE)}concatenateBack(e){return Ie.create(Ee.VALUE)}plusBy(e){return Ie.create(Ee.VALUE)}minusBy(e){return Ie.create(Ee.VALUE)}multiplyBy(e){return Ie.create(Ee.VALUE)}dividedBy(e){return Ie.create(Ee.VALUE)}compareBy(e,t){return Ie.create(Ee.VALUE)}concatenate(e,t=rr.FRONT){let n=this.getValue().toString();if(typeof e=="string")t===rr.FRONT?n=e+n:n+=e;else if(typeof e=="number")t===rr.FRONT?n=e.toString()+n:n+=e.toString();else if(typeof e=="boolean"){const s=e?"TRUE":"FALSE";t===rr.FRONT?n=s+n:n+=s}return this.setValue(n),this}}class ki extends ca{constructor(e,t=!1){if(super(e),t){this._value=e;return}if(typeof e=="boolean")this._value=e;else if(typeof e=="string"){const n=e.toLocaleUpperCase();n===qr.TRUE?this._value=!0:n===qr.FALSE&&(this._value=!1)}else e===1?this._value=!0:this._value=!1}_convertTonNumber(){const e=this.getValue();let t=0;return e&&(t=1),new Vt(t,!0)}getValue(){return this._value}isBoolean(){return!0}getNegative(){const e=this.getValue();let t=0;return e&&(t=1),new Vt(-t,!0)}getReciprocal(){return this.getValue()?new Vt(1,!0):Ie.create(Ee.DIV_BY_ZERO)}plus(e){return this._convertTonNumber().plus(e)}minus(e){return this._convertTonNumber().minus(e)}multiply(e){return this._convertTonNumber().multiply(e)}divided(e){return this._convertTonNumber().divided(e)}compare(e,t){return this._convertTonNumber().compare(e,t)}concatenateFront(e){return this._convertTonNumber().concatenateFront(e)}concatenateBack(e){return this._convertTonNumber().concatenateBack(e)}}class Vt extends ca{constructor(e,t=!1){if(super(e),this._value=0,t){this._value=e;return}this._value=Number(e)}getValue(){return this._value}setValue(e){this._value=e}isNumber(){return!0}getNegative(){return new Vt(0).minus(this)}getReciprocal(){return new Vt(1).divided(this)}plus(e){return e.isArray()?e.plus(this):this.plusBy(e.getValue())}equalZero(){return this._value===0}minus(e){if(e.isArray()){const t=e.getNegative();return t.isErrorObject()?t:t.plus(this)}return this.minusBy(e.getValue())}multiply(e){return e.isArray()?e.multiply(this):this.multiplyBy(e.getValue())}divided(e){if(e.isArray()){const t=e.getReciprocal();return t.isErrorObject()?t:t.multiply(this)}return this.dividedBy(e.getValue())}concatenateFront(e){return e.isArray()?e.concatenateBack(this):this.concatenate(e.getValue(),rr.FRONT)}concatenateBack(e){return e.isArray()?e.concatenateFront(this):this.concatenate(e.getValue(),rr.BACK)}compare(e,t){if(e.isArray()){const n=e.getReciprocal();return n.isErrorObject()?n:n.compare(this,Hg(t))}return this.compareBy(e.getValue(),t)}plusBy(e){let t=this.getValue();return typeof e=="string"?Ie.create(Ee.VALUE):(typeof e=="number"?this.setValue(t+e):typeof e=="boolean"&&this.setValue(t+(e?1:0)),this)}minusBy(e){let t=this.getValue();return typeof e=="string"?Ie.create(Ee.VALUE):(typeof e=="number"?this.setValue(t-e):typeof e=="boolean"&&this.setValue(t-(e?1:0)),this)}multiplyBy(e){let t=this.getValue();return typeof e=="string"?Ie.create(Ee.VALUE):(typeof e=="number"?this.setValue(t*e):typeof e=="boolean"&&this.setValue(t*(e?1:0)),this)}dividedBy(e){let t=this.getValue();if(typeof e=="string")return Ie.create(Ee.VALUE);if(typeof e=="number"){if(e===0)return Ie.create(Ee.DIV_BY_ZERO);this.setValue(t/e)}else if(typeof e=="boolean"){if(e===!1)return Ie.create(Ee.DIV_BY_ZERO);this.setValue(t/1)}return this}compareBy(e,t){let n=this.getValue(),s=!1;if(typeof e=="string")switch(t){case $e.EQUALS:case $e.GREATER_THAN:case $e.GREATER_THAN_OR_EQUAL:s=!1;break;case $e.LESS_THAN:case $e.LESS_THAN_OR_EQUAL:case $e.NOT_EQUAL:s=!0;break}else if(typeof e=="number")switch(t){case $e.EQUALS:s=n===e;break;case $e.GREATER_THAN:s=n>e;break;case $e.GREATER_THAN_OR_EQUAL:s=n>=e;break;case $e.LESS_THAN:s=n<e;break;case $e.LESS_THAN_OR_EQUAL:s=n<=e;break;case $e.NOT_EQUAL:s=n!==e;break}else if(typeof e=="boolean")switch(t){case $e.EQUALS:case $e.GREATER_THAN:case $e.GREATER_THAN_OR_EQUAL:s=!1;break;case $e.LESS_THAN:case $e.LESS_THAN_OR_EQUAL:case $e.NOT_EQUAL:s=!0;break}return new ki(s)}}const Ug="COUNT";class zg extends Xt{get name(){return Ug}calculate(...e){let t=new Vt(0);for(let n=0;n<e.length;n++){let s=e[n];s.isReferenceObject()||s.isValueObject()&&s.isArray()?s.iterator((i,o,a)=>{!i.isErrorObject()&&!i.isString()&&(t=t.plusBy(1))}):s.isString()||(t=t.plusBy(1))}return t}}Gt.add(Ug,zg.create());const Wg="SUM";class Vg extends Xt{get name(){return Wg}calculate(...e){let t=new Vt(0);for(let n=0;n<e.length;n++){let s=e[n];if(s.isErrorObject())return Ie.create(Ee.VALUE);if(s.isReferenceObject()||s.isValueObject()&&s.isArray()){let i=!1;if(s.iterator((o,a,l)=>{if(o.isErrorObject())return i=!0,!1;t=t.plus(o)}),i)return Ie.create(Ee.VALUE)}else t=t.plus(s)}return t}}Gt.add(Wg,Vg.create());const Gg="AVERAGE";class dA extends Xt{get name(){return Gg}calculate(...e){const t=Vg.create().calculate(...e),n=zg.create().calculate(...e);return t.isErrorObject()||n.isErrorObject()?Ie.create(Ee.VALUE):t.divided(n)}}Gt.add(Gg,dA.create());const Xg="CONCATENATE";class fA extends Xt{get name(){return Xg}calculate(e,t){return Ie.create(Ee.VALUE)}}Gt.add(Xg,fA.create());const $g="MAX";class gA extends Xt{get name(){return $g}_validator(e,t){return e.compare(t,$e.LESS_THAN).getValue()&&(e=t),e}calculate(...e){let t=new Vt(-1/0);for(let n=0;n<e.length;n++){let s=e[n];s.isReferenceObject()||s.isValueObject()&&s.isArray()?s.iterator((i,o,a)=>{!i.isErrorObject()&&!i.isString()&&(t=this._validator(t,i))}):s.isString()||(t=this._validator(t,s))}return t}}Gt.add($g,gA.create());const Yg="MIN";class mA extends Xt{get name(){return Yg}_validator(e,t){return e.compare(t,$e.GREATER_THAN).getValue()&&(e=t),e}calculate(...e){let t=new Vt(1/0);for(let n=0;n<e.length;n++){let s=e[n];s.isReferenceObject()||s.isValueObject()&&s.isArray()?s.iterator((i,o,a)=>{!i.isErrorObject()&&!i.isString()&&(t=this._validator(t,i))}):s.isString()||(t=this._validator(t,s))}return t}}Gt.add(Yg,mA.create());const jg="POWER";class pA extends Xt{get name(){return jg}calculate(e,t){return Ie.create(Ee.VALUE)}}Gt.add(jg,pA.create());const Eu=`'?\\[((?![\\/?:"<>|*\\\\]).)*\\]`,wu="((?![\\[\\]\\/?*\\\\]).)*!",Go="$",_A="#",bA=`\\${Go}?[A-Za-z]+\\${Go}?[0-9]+`,vA=`^(${Eu})?(${wu})?\\s*?${bA}(${_A})?$`,CA=`^(${Eu})?(${wu})?\\s*?\\${Go}?[0-9]+$`,EA=`^(${Eu})?(${wu})?\\s*?\\${Go}?[A-Za-z]+$`,Kg=/[.*?]/g,wA=/{.*?}/g;class Zg extends ca{constructor(e,t=!1){if(super(e),t){this._value=e;return}let n=e.toString();n.charAt(0)==='"'&&n.charAt(n.length-1)==='"'&&(n=n.slice(1,-1),n=n.replace(/""/g,'"')),this._value=n}getValue(){return this._value}isString(){return!0}concatenateFront(e){return e.isArray()?e.concatenateBack(this):this.concatenate(e.getValue(),rr.FRONT)}concatenateBack(e){return e.isArray()?e.concatenateFront(this):this.concatenate(e.getValue(),rr.BACK)}compare(e,t){if(e.isArray()){const n=e.getReciprocal();return n.isErrorObject()?n:n.compare(this,Hg(t))}return this.compareBy(e.getValue(),t)}compareBy(e,t){let n=this.getValue(),s=!1;if(typeof e=="string")switch(t){case $e.EQUALS:s=n===e;break;case $e.GREATER_THAN:s=n>e;break;case $e.GREATER_THAN_OR_EQUAL:s=n>=e;break;case $e.LESS_THAN:s=n<e;break;case $e.LESS_THAN_OR_EQUAL:s=n<=e;break;case $e.NOT_EQUAL:s=n!==e;break}else if(typeof e=="number")switch(t){case $e.EQUALS:case $e.GREATER_THAN:case $e.GREATER_THAN_OR_EQUAL:s=!0;break;case $e.LESS_THAN:case $e.LESS_THAN_OR_EQUAL:case $e.NOT_EQUAL:s=!1;break}else if(typeof e=="boolean")switch(t){case $e.EQUALS:case $e.GREATER_THAN:case $e.GREATER_THAN_OR_EQUAL:s=!1;break;case $e.LESS_THAN:case $e.LESS_THAN_OR_EQUAL:case $e.NOT_EQUAL:s=!0;break}return new ki(s)}}class qg{static create(e){if(typeof e=="boolean")return new ki(e,!0);if(typeof e=="string"){const t=e.toLocaleUpperCase();return t===qr.TRUE||t===qr.FALSE?new ki(t):isNaN(Number(e))?wA.test(e)?new Jg(e):new Zg(e):new Vt(e)}else if(typeof e=="number")return new Vt(e,!0);return Ie.create(Ee.NA)}}class Jg extends ca{constructor(e){var t=(...n)=>{super(...n)};if(e instanceof String)t(e);else{const n=hA();t(n)}this._value=this._formatValue(e)}_formatValue(e){if(!(e instanceof String))return e=e,this._rowCount=e.rowCount,this._columnCount=e.columnCount,e.calculateValueList;e=e.slice(1,-1);const t=e.split(";"),n=t.length,s=[];let i=0;for(let o=0;o<n;o++){const l=t[o].split(","),u=l.length;i<u&&(i=u);const c=[];for(let h=0;h<u;h++){const f=l[h];c.push(qg.create(f))}s.push(c)}return this._rowCount=n,this._columnCount=i,s}getRowCount(){return this._rowCount}setRowCount(e){this._rowCount=e}getColumnCount(){return this._columnCount}setColumnCount(e){this._columnCount=e}getArrayValue(){return this._value}setArrayValue(e){this._value=e}isArray(){return!0}getRangePosition(){let e=0,t=this.getRowCount(),n=0,s=this.getColumnCount();return{startRow:e,endRow:t-1,startColumn:n,endColumn:s-1}}iterator(e){const{startRow:t,endRow:n,startColumn:s,endColumn:i}=this.getRangePosition(),o=this.getArrayValue();for(let a=t;a<=n;a++)for(let l=s;l<=i;l++)if(e(o[a][l],a,l)===!1)return}_batchOperator(e,t,n){var a,l,u,c,h;if(e.isArray()){let f=e.getRowCount(),d=e.getColumnCount();f<this._rowCount&&(f=this._rowCount),d<this._columnCount&&(d=this._columnCount);const m=[],g=e.getArrayValue();for(let p=0;p<f;p++){const _=[];for(let v=0;v<d;v++){const w=(l=(a=this._value)==null?void 0:a[p])==null?void 0:l[v],y=(u=g==null?void 0:g[p])==null?void 0:u[v];if(w&&y)if(w.isErrorObject()||y.isErrorObject())_[v]=Ie.create(Ee.VALUE);else switch(t){case 1:_[v]=w.plus(y);break;case 0:_[v]=w.minus(y);break;case 2:_[v]=w.multiply(y);break;case 3:_[v]=w.divided(y);break;case 4:n?_[v]=w.compare(y,n):_[v]=Ie.create(Ee.VALUE);break;case 5:_[v]=w.concatenateFront(y);break;case 6:_[v]=w.concatenateBack(y);break}else w?_[v]=w:y?_[v]=y:_[v]=Ie.create(Ee.VALUE)}m.push(_)}return this.setArrayValue(m),this.setRowCount(f),this.setColumnCount(d),this}let s=this._rowCount,i=this._columnCount;const o=[];for(let f=0;f<s;f++){const d=[];for(let m=0;m<i;m++){const g=(h=(c=this._value)==null?void 0:c[f])==null?void 0:h[m];if(g&&e)if(g.isErrorObject()||e.isErrorObject())d[m]=Ie.create(Ee.VALUE);else switch(t){case 1:d[m]=g.plus(e);break;case 0:d[m]=g.minus(e);break;case 2:d[m]=g.multiply(e);break;case 3:d[m]=g.divided(e);break;case 4:n?d[m]=g.compare(e,n):d[m]=Ie.create(Ee.VALUE);break;case 5:d[m]=g.concatenateFront(e);break;case 6:d[m]=g.concatenateBack(e);break}else g?d[m]=g:e?d[m]=e:d[m]=Ie.create(Ee.VALUE)}o.push(d)}return this.setArrayValue(o),this.setRowCount(s),this.setColumnCount(i),this}plus(e){return this._batchOperator(e,1)}minus(e){return this._batchOperator(e,0)}multiply(e){return this._batchOperator(e,2)}divided(e){return this._batchOperator(e,3)}compare(e,t){return this._batchOperator(e,4,t)}concatenateFront(e){return this._batchOperator(e,5)}concatenateBack(e){return this._batchOperator(e,6)}}class Wi extends Cu{constructor(e){super(),this._token=e,this._rowCount=0,this._columnCount=0}getRangePosition(){let e=this._rangeData.startRow,t=this._rangeData.endRow,n=this._rangeData.startColumn,s=this._rangeData.endColumn;return e===-1&&(e=0),n===-1&&(n=0),t===-1&&(t=this._rowCount-1),s===-1&&(s=this._columnCount-1),{startRow:e,endRow:t,startColumn:n,endColumn:s}}isReferenceObject(){return!0}iterator(e){const{startRow:t,endRow:n,startColumn:s,endColumn:i}=this.getRangePosition();for(let o=t;o<=n;o++)for(let a=s;a<=i;a++){const l=this.getCellData(o,a);let u=!1;if(!l){u=e(new Vt(0,!0),o,a);continue}const c=this.getCellValueObject(l);if(u=e(c,o,a),u===!1)return}}getRangeData(){return this._rangeData}setRangeData(e){this._rangeData=e}getUnitId(){return this._forcedUnitId?this._forcedUnitId:this._defaultUnitId}getSheetId(){return this._forcedSheetId?this._forcedSheetId:this._defaultSheetId}setForcedUnitIdDirect(e){this._forcedUnitId=e}getForcedUnitId(){return this._forcedUnitId}setForcedSheetId(e){this._forcedSheetId=e[this._forcedSheetName]}setForcedSheetIdDirect(e){this._forcedSheetId=e}getForcedSheetId(){return this._forcedSheetId}setForcedSheetName(e){this._forcedSheetName=e}getForcedSheetName(){return this._forcedSheetName}setDefaultSheetId(e){this._defaultSheetId=e}getDefaultSheetId(){return this._defaultSheetId}setDefaultUnitId(e){this._defaultUnitId=e}getDefaultUnitId(){return this._defaultUnitId}getUnitData(){return this._unitData}setUnitData(e){this._unitData=e}getRuntimeData(){return this._runtimeData}setRuntimeData(e){this._runtimeData=e}getRowCount(){return this._rowCount}setRowCount(e){this._rowCount=e}getColumnCount(){return this._columnCount}setColumnCount(e){this._columnCount=e}isCell(){return!1}isColumn(){return!1}isRow(){return!1}isRange(){return!1}isTable(){return!1}unionBy(e){return Ie.create(Ee.REF)}unionRange(e,t){return{startRow:-1,startColumn:-1,endRow:-1,endColumn:-1}}getCellValueObject(e){const t=e.v||0;return tA.has(t)?Ie.create(t):e.t===On.BOOLEAN?new ki(t):e.t===On.FORCE_STRING||e.t===On.STRING?new Zg(t):new Vt(t)}getCellByRow(e){return this.getCellByPosition(e)}getCellByColumn(e){return this.getCellByPosition(void 0,e)}getCurrentActiveSheetData(){return this._unitData[this.getUnitId()][this.getSheetId()]}getCurrentRuntimeSheetData(){var e,t;return(t=(e=this._runtimeData)==null?void 0:e[this.getUnitId()])==null?void 0:t[this.getSheetId()]}getCellData(e,t){const n=this.getCurrentActiveSheetData(),s=this.getCurrentRuntimeSheetData();return(s==null?void 0:s.getValue(e,t))||n.getValue(e,t)}getCellByPosition(e,t){e||(e=this._rangeData.startRow),t||(t=this._rangeData.startColumn);const n=this.getCellData(e,t);return n?this.getCellValueObject(n):Ie.create(Ee.VALUE)}toArrayValueObject(){const{startRow:e,endRow:t,startColumn:n,endColumn:s}=this.getRangePosition(),i=t-e+1,o=s-n+1,a=new Array(i);this.iterator((u,c,h)=>{const f=c-e,d=h-n;a[f]||(a[f]=new Array(o)),a[f][d]=u});const l={calculateValueList:a,rowCount:a.length,columnCount:a[0].length};return new Jg(l)}toUnitRange(){return{rangeData:this._rangeData,sheetId:this.getSheetId(),unitId:this.getUnitId()}}}class TA extends Wi{constructor(e,t,n){super(""),this.setRangeData(e),t&&this.setForcedSheetIdDirect(t),n&&this.setForcedUnitIdDirect(n)}isRange(){return!0}}class Tu extends Wi{constructor(e){super(e);const t=Ml(e);this.setForcedSheetName(t.sheetName),this.setRangeData(t.rangeData)}_createRange(e){const t=new TA(e,this.getForcedSheetId(),this.getForcedUnitId());return t.setUnitData(this.getUnitData()),t.setDefaultSheetId(this.getDefaultSheetId()),t.setRowCount(this.getRowCount()),t.setColumnCount(this.getColumnCount()),t.setDefaultUnitId(this.getDefaultUnitId()),t.setRuntimeData(this.getRuntimeData()),this.getForcedUnitId()!=null&&t.setForcedSheetIdDirect(this.getForcedUnitId()),t}isCell(){return!0}unionBy(e){if(!e.isCell())return Ie.create(Ee.REF);const t=e,n=this.unionRange(this.getRangeData(),t.getRangeData());return this._createRange(n)}unionRange(e,t){const n=e.startRow,s=e.startColumn,i=t.startRow,o=t.startColumn;let a={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};return n>i?(a.startRow=i,a.endRow=n):(a.startRow=n,a.endRow=i),s>o?(a.startColumn=o,a.endColumn=s):(a.startColumn=s,a.endColumn=o),a}}const Qg="OFFSET";class yA extends Xt{get name(){return Qg}calculate(e,t,n,s,i){return new Tu("A5")}}Gt.add(Qg,yA.create());const e6="INDIRECT";class SA extends Xt{get name(){return e6}calculate(e,t){return new Tu("A5")}}Gt.add(e6,SA.create());class AA{constructor(){this._astNodeFactoryArray=[],this._functionMap=new Map,this._tableMap=new Map,this._tableOptionMap=new Map,this._definedNameMap=new Map}_initialNode(){this.registerNode(..._n.getData().sort(Ft))}_initialFunction(){this._functionMap=Gt.getData()}registerNode(...e){this._astNodeFactoryArray.push(...e)}registerFunction(...e){for(let t=0;t<e.length;t++){const n=e[t];this._functionMap.set(n.name,n)}}registerTable(e,t){this._tableMap.set(e,t)}registerDefinedName(e,t){this._definedNameMap.set(e,t)}registerTableOptionMap(e,t){this._tableOptionMap.set(e,t)}getTableOptionMap(){return this._tableOptionMap}getFunctionMap(){return this._functionMap}getAstNodeFactoryArray(){return this._astNodeFactoryArray}getTableMap(){return this._tableMap}getDefinedNameMap(){return this._definedNameMap}getExecutor(e){return this._functionMap.get(e)}getLambdaRuntime(){return this._lambdaRuntime}setLambdaRuntime(e){this._lambdaRuntime=e}hasLambdaRuntime(){return this._lambdaRuntime!=null}hasExecutor(e){return this._functionMap.has(e)}initialize(){this._initialNode(),this._initialFunction()}}class Xo extends bn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.PREFIX}_handlerAT(e,t){if(!e.isReferenceObject())return Ie.create(Ee.VALUE);const n=e;if(n.isCell())return Ie.create(Ee.VALUE);const s=(t==null?void 0:t.currentRow)||0,i=(t==null?void 0:t.currentColumn)||0;return n.isRow()?n.getCellByColumn(i):n.isColumn()?n.getCellByRow(s):n.isRange()||n.isTable()?n.getCellByPosition():Ie.create(Ee.VALUE)}execute(e){const n=this.getChildren()[0].getValue();let s;this._operatorString===nn.MINUS?s=this._functionExecutor.calculate(new Vt(0),n):this._operatorString===nn.AT?s=this._handlerAT(n,e):s=Ie.create(Ee.VALUE),this.setValue(s)}}class RA extends Xn{get zIndex(){return Gn.get(et.PREFIX)||100}checkAndCreateNodeType(e,t){if(!(e instanceof nt))return!1;const n=e.getToken(),s=n.trim();if(s.charAt(0)==='"'&&s.charAt(s.length-1)==='"')return!1;let i="";if(s===nn.MINUS)i="MINUS";else return s===nn.AT?new Xo(s):!1;const o=t.getExecutor(i);return o?new Xo(s,o):(console.error("No function "+n),Nt.create(Ee.NAME))}}_n.add(new RA);class DA extends bn{constructor(e,t){super(e),this._functionExecutor=t,this._functionExecutor.isAsync()&&this.setAsync(),this._functionExecutor.isAddress()&&this.setAddress()}get nodeType(){return et.FUNCTION}async executeAsync(){const e=[],t=this.getChildren(),n=t.length;for(let i=0;i<n;i++)e.push(t[i].getValue());const s=this._functionExecutor.calculate(...e);return s.isAsyncObject()?this.setValue(await s.getValue()):this.setValue(s),Promise.resolve(Oi.SUCCESS)}execute(){const e=[],t=this.getChildren(),n=t.length;for(let i=0;i<n;i++)e.push(t[i].getValue());const s=this._functionExecutor.calculate(...e);this.setValue(s)}}class xA extends Xn{get zIndex(){return Gn.get(et.FUNCTION)||100}create(e,t){const n=t.getExecutor(e);return n?new DA(e,n):(console.error("No function "+e),Nt.create(Ee.NAME))}checkAndCreateNodeType(e,t){if(typeof e=="string")return!1;let s=e.getToken().trim().toUpperCase(),i,o;const a=s.slice(0,2);let l=0;if(new RegExp(nn.MINUS,"g").test(a)){const u=t.getExecutor("MINUS");i=new Xo(nn.MINUS,u),l++}if(new RegExp(nn.AT,"g").test(a)&&(o=new Xo(nn.AT),i&&o.setParent(i),l++),l>0&&(s=s.slice(l)),t!=null&&t.hasExecutor(s)){const u=this.create(s,t);return console.log("functionNode",u),o?u.setParent(o):i&&u.setParent(i),u}return!1}}_n.add(new xA);const IA="LAMBDA";class OA extends bn{constructor(e,t){super(e),this._lambdaId=t}get nodeType(){return et.LAMBDA}getLambdaId(){return this._lambdaId}execute(){const e=this.getChildren(),t=e.length;this.setValue(e[t-1].getValue())}}class kA extends Xn{get zIndex(){return Gn.get(et.LAMBDA)||100}_updateLambdaStatement(e,t,n){this._updateTree(e,t,n)}_updateTree(e,t,n){const s=e.getChildren(),i=s.length;for(let o=0;o<i;o++){const a=s[o];if(a instanceof nt)this._updateTree(a,t,n);else{const l=a.trim();if(n.has(l)){const u=new nt;u.setToken(Og),u.setLambdaId(t),u.setLambdaPrivacyVar(n),u.setLambdaParameter(l),s[o]=u}}}}create(e,t){const n=e.getChildren(),s=n[0],i=n.slice(1,-1),o=n[n.length-1];if(!(s instanceof nt&&o instanceof nt)||s.getToken()!==Vo)return Nt.create(Ee.NAME);const a=s.getChildren();if(i.length!==a.length)return Nt.create(Ee.VALUE);const l=Rt(8),u=t.getLambdaRuntime(),c=new Map;for(let h=0;h<i.length;h++){const f=i[h];if(f instanceof nt){const d=f.getChildren()[0];c.set(d,null)}else return Nt.create(Ee.VALUE)}return u.registerLambdaPrivacyVar(l,c),this._updateLambdaStatement(o,l,c),new OA(e.getToken(),l)}checkAndCreateNodeType(e,t){return!(e instanceof nt)||e.getToken().trim().toUpperCase()!==IA?!1:this.create(e,t)}}_n.add(new kA);class NA extends bn{constructor(e,t,n){super(e),this._lambdaParameter=t,this._currentLambdaPrivacyVar=n}get nodeType(){return et.LAMBDA_PARAMETER}execute(){const e=this._currentLambdaPrivacyVar.get(this._lambdaParameter);e?this.setValue(e.getValue()):this.setValue(Ie.create(Ee.SPILL))}}class MA extends Xn{get zIndex(){return Gn.get(et.LAMBDA_PARAMETER)||100}create(e){e.getLambdaId();const t=e.getLambdaPrivacyVar(),n=e.getLambdaParameter();return t?new NA(e.getToken(),n,t):new Nt(Ee.SPILL)}checkAndCreateNodeType(e){return!(e instanceof nt)||e.getToken().trim()!==Og?!1:this.create(e)}}_n.add(new MA);const FA="PLUS",BA="MINUS",LA="MULTIPLY",PA="DIVIDED",HA="CONCATENATE",UA="POWER",t6="COMPARE";class zA extends bn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.OPERATOR}execute(){const e=this.getChildren();this._functionExecutor.name===t6&&this._functionExecutor.setCompareType(this.getToken()),this.setValue(this._functionExecutor.calculate(e[0].getValue(),e[1].getValue()))}}class WA extends Xn{get zIndex(){return Gn.get(et.OPERATOR)||100}create(e,t){let n="";const s=e;s===gn.PLUS?n=FA:s===gn.MINUS?n=BA:s===gn.MULTIPLY?n=LA:s===gn.DIVIDED?n=PA:s===gn.CONCATENATE?n=HA:s===gn.POWER?n=UA:nA.has(s)&&(n=t6);const i=t.getExecutor(n);return i?new zA(s,i):(console.error("No function "+e),Nt.create(Ee.NAME))}checkAndCreateNodeType(e,t){if(e instanceof nt)return!1;const n=e.trim();return n.charAt(0)==='"'&&n.charAt(n.length-1)==='"'?!1:ci.has(n)?this.create(n,t):!1}}_n.add(new WA);class VA extends Wi{constructor(e){super(e);const t=Ml(e);this.setForcedSheetName(t.sheetName);const n={startColumn:-1,startRow:t.rangeData.startRow,endColumn:-1,endRow:-1};this.setRangeData(n)}isRow(){return!0}unionBy(e){if(!e.isRow())return Ie.create(Ee.REF);const t=e;if(t.getForcedSheetName()!==void 0)return Ie.create(Ee.REF);const n=this.getRangeData();if(n.endRow!==-1)return Ie.create(Ee.REF);const s=t.getRangeData().startRow,i=n.startRow;return s>i?n.endRow=s:(n.startRow=s,n.endRow=i),this}}class GA extends Wi{constructor(e){super(e);const t=Ml(e);this.setForcedSheetName(t.sheetName);const n={startColumn:t.rangeData.startColumn,startRow:-1,endColumn:-1,endRow:-1};this.setRangeData(n)}isColumn(){return!0}unionBy(e){if(!e.isColumn())return Ie.create(Ee.REF);const t=e;if(t.getForcedSheetName()!==void 0)return Ie.create(Ee.REF);const n=this.getRangeData();if(n.endColumn!==-1)return Ie.create(Ee.REF);const s=t.getRangeData().startColumn,i=n.startColumn;return s>i?n.endColumn=s:(n.startColumn=s,n.endColumn=i),this}}class XA extends Wi{constructor(e,t,n,s){super(e),this._tableData=t,this._columnDataString=n;const i=this._tableData.sheetId,o=this._tableData.rangeData,a=this._tableData.titleMap;this.setForcedSheetIdDirect(i);const l=this._stringToColumnData(this._columnDataString,a,s),u=l.startColumn,c=l.endColumn,h=l.type;let f=-1,d=-1;const m=o.startRow,g=o.startColumn;h===zr.ALL?(f=m,d=g):h===zr.DATA?(f=m+1,d=g):h===zr.HEADERS?(f=m,d=m):h===zr.TOTALS&&(f=g,d=g),this.setRangeData({startColumn:u,endColumn:c,startRow:f,endRow:d})}_stringToColumnData(e,t,n){e=e.substring(1,-1);const s=e.indexOf(_t.COMMA);let i=-1,o=-1,a=zr.ALL;if(s===-1){const l=this._columnHandler(e,t);i=l.startColumn,o=l.endColumn}else{const l=e.substring(0,s).substring(1,-1),u=e.substring(s+1),c=this._columnHandler(u,t,!0);i=c.startColumn,o=c.endColumn,a=n.get(l),a||(a=zr.ALL)}return{startColumn:i,endColumn:o,type:a}}_columnHandler(e,t,n=!1){let s=-1,i=-1;const o=e.indexOf(_t.COLON);if(Kg.test(e)){const a=e.substring(0,o).substring(1,-1),l=e.substring(o+1).substring(1,-1);s=t[a],i=t[l]}else n&&(e=e.substring(1,-1)),s=t[e],i=s;return{startColumn:s,endColumn:i}}isTable(){return!0}}class oo extends bn{constructor(e,t){super(e),this._operatorString=e,this._referenceObject=t}get nodeType(){return et.REFERENCE}execute(e,t){const n=e;n&&(this._referenceObject.setUnitData(n.unitData),this._referenceObject.setDefaultSheetId(n.currentSheetId),this._referenceObject.setForcedSheetId(n.sheetNameMap),this._referenceObject.setRowCount(n.rowCount),this._referenceObject.setColumnCount(n.columnCount),this._referenceObject.setDefaultUnitId(n.currentUnitId)),t&&this._referenceObject.setRuntimeData(t),this.setValue(this._referenceObject)}}class $A extends Xn{get zIndex(){return Gn.get(et.REFERENCE)||100}checkAndCreateNodeType(e,t){let n=!1,s;if(e instanceof nt?(n=!0,s=e.getToken().trim()):s=e.trim(),!n&&s.charAt(0)==='"'&&s.charAt(s.length-1)==='"')return!1;if(new RegExp(vA).test(s))return new oo(s,new Tu(s));if(n&&new RegExp(CA).test(s))return new oo(s,new VA(s));if(n&&new RegExp(EA).test(s))return new oo(s,new GA(s));const i=t.getDefinedNameMap();if(!n&&i.has(s)){const u=i.get(s),c=new ua(u),h=c.treeMaker();return c.suffixExpressionHandler(h),new Nt(Ee.VALUE)}const o=t.getTableMap(),a=Kg,l=s.replace(a,"");if(!n&&o.has(l)){const u=a.exec(s);let c="";u&&(c=u[0]);const h=o.get(l),f=t.getTableOptionMap();return new oo(s,new XA(s,h,c,f))}return!1}}_n.add(new $A);class Eh extends bn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.SUFFIX}_handlerPound(e,t){var h,f,d,m;if(!e.isReferenceObject()||!e.isCell())return Ie.create(Ee.VALUE);const n=e,s=n.getRangeData(),i=n.getUnitId(),o=n.getSheetId(),a=t==null?void 0:t.formulaData,l=(m=(d=(f=(h=a==null?void 0:a[i])==null?void 0:h[o])==null?void 0:f[s.startRow])==null?void 0:d[s.startColumn])==null?void 0:m.formula;if(!l)return Ie.create(Ee.VALUE);const u=new ua(l),c=u.treeMaker();return u.suffixExpressionHandler(c),Ie.create(Ee.VALUE)}execute(e){const n=this.getChildren()[0].getValue();let s;this._operatorString===Ps.PERCENTAGE?s=this._functionExecutor.calculate(n,new Vt(100)):this._operatorString===Ps.POUND?s=this._handlerPound(n,e):s=Ie.create(Ee.VALUE),this.setValue(s)}}class YA extends Xn{get zIndex(){return Gn.get(et.SUFFIX)||100}checkAndCreateNodeType(e,t){if(!(e instanceof nt))return!1;const n=e.getToken().trim();if(n.charAt(0)==='"'&&n.charAt(n.length-1)==='"')return!1;let s="";if(n===Ps.PERCENTAGE)s="DIVIDED";else return n===Ps.POUND?new Eh(n):!1;const i=t.getExecutor(s);return i?new Eh(n,i):(console.error("No function "+e),Nt.create(Ee.NAME))}}_n.add(new YA);const jA="UNION";class KA extends bn{constructor(e,t){super(e),this._operatorString=e,this._functionExecutor=t}get nodeType(){return et.UNION}execute(){const e=this.getChildren(),t=e[0].getValue(),n=e[1].getValue();let s;this._operatorString===_t.COLON?s=this._functionExecutor.calculate(t,n):s=Ie.create(Ee.NAME),this.setValue(s)}}class ZA extends Xn{get zIndex(){return Gn.get(et.UNION)||100}create(e,t){const n=t.getExecutor(jA);return n?new KA(e,n):(console.error("No function "+e),Nt.create(Ee.NAME))}checkAndCreateNodeType(e,t){if(!(e instanceof nt))return!1;const s=e.getToken().trim();return s.charAt(0)==='"'&&s.charAt(s.length-1)==='"'||s!==_t.COLON?!1:this.create(s,t)}}_n.add(new ZA);class qA extends bn{constructor(e){super(e),this._operatorString=e}get nodeType(){return et.VALUE}execute(){this.setValue(qg.create(this._operatorString))}}class JA extends Xn{get zIndex(){return Gn.get(et.VALUE)||100}_checkValueNode(e){if(isNaN(Number(e))){const t=e.trim(),n=t.charAt(0),s=t.charAt(t.length-1);if(n==='"'&&s==='"')return this.create(t);if(n==="{"&&s==="}")return this.create(t);if(t===qr.TRUE||t===qr.FALSE)return this.create(t)}else return this.create(e);return!1}create(e){return new qA(e)}checkAndCreateNodeType(e){return e instanceof nt?!1:this._checkValueNode(e)}}_n.add(new JA);class QA{constructor(){this._lambdaPrivacyVar=new Map}registerLambdaPrivacyVar(e,t){this._lambdaPrivacyVar.set(e,t)}getCurrentPrivacyVar(e){return this._lambdaPrivacyVar.get(e)}}class ha{constructor(){this._parserDataLoader=new AA}parse(e){this._astNodeFactoryList=_n.getData(),this._parserDataLoader.setLambdaRuntime(new QA);const t=new wl(Ii);return this._parse(e,t)}_lambdaParameterHandler(e,t){const n=t.getLambdaId(),s=new wl(Ii),o=this._parserDataLoader.getLambdaRuntime().getCurrentPrivacyVar(n);if(!o)return!1;const a=[...o.keys()],l=e.getChildren(),u=l.length;for(let f=0;f<u;f++){const d=l[f];if(d instanceof nt)this._parse(d,s);else return!1}const c=s.getChildren(),h=c.length;for(let f=0;f<h;f++){const d=c[f];o.set(a[f],d)}return s.setParent(t),t}_getTopParent(e){let t=e;for(;t.getParent();)t=t.getParent(),console.log(t);return t}_parse(e,t){const n=e.getChildren(),s=n.length,i=[];let o=!1;if(e.getToken()===ui)o=t;else{if(e.getToken()===Vo){let l=this._lambdaParameterHandler(e,t);return l===!1&&(l=Nt.create(Ee.ERROR)),l}if(o=this._checkAstNode(e),o===!1)return Nt.create(Ee.ERROR)}for(let l=0;l<s;l++){if(o.nodeType===et.LAMBDA&&t.nodeType!==et.LAMBDA&&l!==0&&l!==s-1)continue;const u=n[l];let c=!1;if(u instanceof nt){if(c=this._parse(u,o),c===o)continue}else c=this._checkAstNode(u);if(c===!1)return Nt.create(Ee.ERROR);switch(c=this._getTopParent(c),c.nodeType){case et.ERROR:return c;case et.FUNCTION:i.push(c);break;case et.LAMBDA:i.push(c);break;case et.LAMBDA_PARAMETER:i.push(c);break;case et.OPERATOR:const h=i.pop(),f=i.pop();if(f)f.setParent(c);else return Nt.create(Ee.ERROR);if(h)h.setParent(c);else return Nt.create(Ee.ERROR);i.push(c);break;case et.REFERENCE:i.push(c);break;case et.ROOT:i.push(c);break;case et.UNION:i.push(c);break;case et.VALUE:i.push(c);break;case et.PREFIX:i.push(c);break;case et.SUFFIX:i.push(c);break}}const a=i.length;for(let l=0;l<a;l++)i[l].setParent(o);return o}_checkAstNode(e){let t=!1;const n=this._astNodeFactoryList.length;for(let s=0;s<n&&(t=this._astNodeFactoryList[s].checkAndCreateNodeType(e,this._parserDataLoader),t===!1);s++);return t}_findTopNode(){}getDataLoader(){return this._parserDataLoader}static create(){return this.maker||(this.maker=new ha,this.maker._parserDataLoader.initialize()),this.maker}}class Ni{constructor(e){this._interpreterDatasetConfig=e,this._runtimeData={},this._unitArrayFormulaData={}}_checkAsyncNode(e,t){const n=e.getChildren(),s=n.length;for(let i=0;i<s;i++){const o=n[i];t.push(o.isAsync()),this._checkAsyncNode(o,t)}}async _executeAsync(e){const t=e.getChildren(),n=t.length;for(let s=0;s<n;s++){const i=t[s];this._executeAsync(i)}return e.nodeType===et.FUNCTION&&e.isAsync()?await e.executeAsync(this._interpreterDatasetConfig):e.execute(this._interpreterDatasetConfig,this._runtimeData),Promise.resolve(Oi.SUCCESS)}_execute(e){const t=e.getChildren(),n=t.length;for(let s=0;s<n;s++){const i=t[s];this._execute(i)}return e.execute(this._interpreterDatasetConfig,this._runtimeData),Oi.SUCCESS}_objectValueToCellValue(e){if(e.isErrorObject())return{v:e.getErrorType(),t:On.STRING};if(e.isValueObject()){const t=e,n=t.getValue();return t.isNumber()?{v:n,t:On.NUMBER}:t.isBoolean()?{v:n,t:On.BOOLEAN}:{v:n,t:On.STRING}}}async executeAsync(e){if(!e)return Ie.create(Ee.VALUE);await this._executeAsync(e);const t=e.getValue();return Promise.resolve(t)}execute(e){return e?(this._execute(e),e.getValue()):Ie.create(Ee.VALUE)}executePreCalculateNode(e){return e.execute(this._interpreterDatasetConfig,this._runtimeData),e.getValue()}checkAsyncNode(e){const t=[];this._checkAsyncNode(e,t);for(let n=0,s=t.length;n<s;n++)if(t[n]===!0)return!0;return!1}setRuntimeData(e,t,n,s,i){this._runtimeData[s]===void 0&&(this._runtimeData[s]={});const o=this._runtimeData[s];o[n]===void 0&&(o[n]=new pe),this._unitArrayFormulaData[s]===void 0&&(this._unitArrayFormulaData[s]={});const a=this._unitArrayFormulaData[s];a[n]===void 0&&(a[n]=new pe);const l=o[n],u=a[n];if(i.isReferenceObject()||i.isValueObject()&&i.isArray()){const c=i,{startRow:h,startColumn:f,endRow:d,endColumn:m}=c.getRangePosition();c.iterator((g,p,_)=>{l.setValue(p-h+e,_-f+t,this._objectValueToCellValue(g))}),u.setValue(e,t,{startRow:e,startColumn:t,endRow:d-h+1+e,endColumn:m-f+1+t})}else l.setValue(e,t,this._objectValueToCellValue(i))}getSheetData(e){return this._runtimeData[e]}getSheetArrayFormula(e){return this._unitArrayFormulaData[e]}setProps(e){this._interpreterDatasetConfig=e}setCurrentPosition(e,t,n,s){!this._interpreterDatasetConfig||(this._interpreterDatasetConfig.currentRow=e,this._interpreterDatasetConfig.currentColumn=t,this._interpreterDatasetConfig.currentSheetId=n,this._interpreterDatasetConfig.currentUnitId=s)}static create(e){return new Ni(e)}}const eR=1e5;class tR{constructor(){this._cache=new s3(eR)}_hash(e){return g3(e)}set(e,t){const n=this._hash(e);this._cache.set(n,t)}get(e){const t=this._hash(e);return this._cache.get(t)}}const wh=new tR;function nR(r){let e=wh.get(r);if(e)return e;const t=new ua(r),n=t.treeMaker();return t.suffixExpressionHandler(n),e=ha.create().parse(n),wh.set(r,e),e}class rR{constructor(){this.children=[],this.parents=[],this._state=0,this.rangeList=[]}_pushParent(e){this.parents.push(e)}setAdded(){this._state=1}isAdded(){return this._state===1}setSkip(){this._state=2}isSkip(){return this._state===2}compareRangeData(e){const t=e.startRow,n=e.startColumn,s=e.endRow,i=e.endColumn;return!(this.row<t||this.row>s||this.column<n||this.column>i)}dependencyRange(e){if(this.rangeList.length===0)return!1;for(let t=0,n=this.rangeList.length;t<n;t++){const s=this.rangeList[t],i=s.unitId,o=s.sheetId,a=s.rangeData;if(!e.has(i))continue;const l=e.get(i);if(!l.has(o))continue;const u=l.get(o),{startRow:c,startColumn:h,endRow:f,endColumn:d}=u;if(!(a.startRow>f||a.endRow<c||a.startColumn>d||a.endColumn<h))return!0}return!1}pushChildren(e){this.children.push(e),e._pushParent(this)}pushRangeList(e){this.rangeList.push(e)}dependency(e){if(this.rangeList.length===0)return!1;for(let t=0,n=this.rangeList.length;t<n;t++){const s=this.rangeList[t],i=s.unitId,o=s.sheetId,a=s.rangeData;if(e.unitId===i&&e.sheetId===o&&e.compareRangeData(a))return!0}return!1}}class yu{constructor(e,t=!1){this._formulaData=e,this._forceCalculate=t,this._updateRangeFlattenCache=new Map}updateRangeFlatten(e){if(!this._forceCalculate){this._updateRangeFlattenCache=new Map;for(let t=0;t<e.length;t++){const n=e[t],s=n.rangeData,i=n.sheetId,o=n.unitId;this._addFlattenCache(o,i,s)}}}_addFlattenCache(e,t,n){let s=this._updateRangeFlattenCache.get(e);s||(s=new Map,this._updateRangeFlattenCache.set(e,s)),s.set(t,n)}_isPreCalculateNode(e){return e.nodeType===et.UNION||e.nodeType===et.PREFIX&&e.getToken()===nn.AT||e.nodeType===et.SUFFIX&&e.getToken()===Ps.POUND}_nodeTraversalRef(e,t){const n=e.getChildren(),s=n.length;for(let i=0;i<s;i++){const o=n[i];if(this._isPreCalculateNode(o)){t.push(o);continue}else o.nodeType===et.REFERENCE&&t.push(o);this._nodeTraversalRef(o,t)}}_nodeTraversalReferenceFunction(e,t){const n=e.getChildren(),s=n.length;for(let i=0;i<s;i++){const o=n[i];if(o.nodeType===et.FUNCTION&&o.isAddress()){t.push(o);continue}this._nodeTraversalReferenceFunction(o,t)}}async _executeNode(e,t){let n;return t.checkAsyncNode(e)?n=await t.executeAsync(e):n=t.execute(e),n}async _getRangeListByNode(e,t){const n=[],s=[];this._nodeTraversalRef(e,n),this._nodeTraversalReferenceFunction(e,s);const i=[];for(let o=0,a=n.length;o<a;o++){const l=n[o],c=(await this._executeNode(l,t)).toUnitRange();i.push(c)}for(let o=0,a=s.length;o<a;o++){const l=s[o],c=(await this._executeNode(l,t)).toUnitRange();i.push(c)}return i}_includeTree(e){const t=e.unitId,n=e.sheetId;if(!this._updateRangeFlattenCache.has(t))return!1;const s=this._updateRangeFlattenCache.get(t);if(!s.has(n))return!1;const i=s.get(n);return!!e.compareRangeData(i)}_getUpdateTreeListAndMakeDependency(e){const t=[],n=new Set;for(let s=0,i=e.length;s<i;s++){const o=e[s];for(let a=0,l=e.length;a<l;a++){const u=e[a];o!==u&&o.dependency(u)&&o.pushChildren(u)}(this._forceCalculate||o.dependencyRange(this._updateRangeFlattenCache)||this._includeTree(o))&&!n.has(o)&&(t.push(o),n.add(o))}return t}_calculateRunList(e){let t=e;const n=[];for(;t.length>0;){let s=t.pop();if(s===void 0||s.isSkip())continue;if(s.isAdded()){n.push(s);continue}const i=[];for(let o=0,a=s.parents.length;o<a;o++){const l=s.parents[o];i.push(l)}i.length==0?(n.push(s),s.setSkip()):(s.setAdded(),t.push(s),t=t.concat(i))}return n.reverse()}async generate(e=[],t){this.updateRangeFlatten(e);const n=Ni.create(t),s=Object.keys(this._formulaData),i=[];for(let a of s){const l=this._formulaData[a],u=Object.keys(l);for(let c of u)new pe(l[c]).forValue((f,d,m)=>{const g=m.formula,p=nR(g),_=new rR;_.node=p,_.formula=g,_.unitId=a,_.sheetId=c,_.row=f,_.column=d,i.push(_)})}for(let a=0,l=i.length;a<l;a++){const u=i[a];n.setCurrentPosition(u.row,u.column,u.sheetId,u.unitId);const c=await this._getRangeListByNode(u.node,n);for(let h=0,f=c.length;h<f;h++)u.pushRangeList(c[h])}const o=this._getUpdateTreeListAndMakeDependency(i);return Promise.resolve(this._calculateRunList(o))}static create(e,t=!1){return new yu(e,t)}}class Su extends or{constructor(e){super("formulaEngine")}async execute(e,t,n,s=!1,i=[]){const a=await yu.create(t,s).generate(i,n),l=Ni.create(n);for(let u=0,c=a.length;u<c;u++){const h=a[u],f=h.node;let d;l.setCurrentPosition(h.row,h.column,h.sheetId,h.unitId),l.checkAsyncNode(f)?d=await l.executeAsync(f):d=l.execute(f),l.setRuntimeData(h.row,h.column,h.sheetId,h.unitId,d)}return{sheetData:l.getSheetData(e),arrayFormulaData:l.getSheetArrayFormula(e)}}calculate(e){var a,l;(a=this.getObserver("onBeforeFormulaCalculateObservable"))==null||a.notifyObservers(e);const t=new ua(e),n=t.treeMaker();t.suffixExpressionHandler(n),(l=this.getObserver("onAfterFormulaLexerObservable"))==null||l.notifyObservers(n);const i=ha.create().parse(n),o=Ni.create();o.checkAsyncNode(i)?o.executeAsync(i).then(c=>{console.log("formulaResult",c)}):console.log(o.execute(i))}initialize(){}onMapping(e){}onMounted(e){this.initialize()}onDestroy(){}static create(e){return new Su(e)}}var sR={formula:{formulaLabel:"\u6C42\u548C",formulaRightLabel:"\u66F4\u591A\u516C\u5F0F",ok:"\u786E\u5B9A",cancel:"\u53D6\u6D88",clearValidation:"\u6E05\u9664\u9A8C\u8BC1",formula:{sum:"\u6C42\u548C",average:"\u5E73\u5747\u503C",count:"\u8BA1\u6570",max:"\u6700\u5927\u503C",min:"\u6700\u5C0F\u503C",if:"if\u516C\u5F0F\u751F\u6210\u5668",more:"\u66F4\u591A\u51FD\u6570..."},functionList:{SUMIF:{d:"\u5BF9\u8303\u56F4\u4E2D\u7B26\u5408\u6307\u5B9A\u6761\u4EF6\u7684\u503C\u6C42\u548C\u3002",p:{range:{name:"\u8303\u56F4",detail:"\u8981\u6839\u636E\u6761\u4EF6\u8FDB\u884C\u68C0\u6D4B\u7684\u8303\u56F4\u3002"},rangeAll:{name:"\u6761\u4EF6",detail:`\u8981\u5E94\u7528\u4E8E\u8303\u56F4\u7684\u6A21\u5F0F\u6216\u6D4B\u8BD5\u6761\u4EF6\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6587\u672C\uFF0C\u5219\u6761\u4EF6\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u3002\u6761\u4EF6\u53EF\u4EE5\u5305\u542B\u901A\u914D\u7B26\uFF0C\u5305\u62EC\u7528\u4E8E\u5339\u914D\u5355\u4E2A\u5B57\u7B26\u7684?\u6216\u7528\u4E8E\u5339\u914D\u96F6\u4E2A\u6216\u8FDE\u7EED\u591A\u4E2A\u5B57\u7B26\u7684*\u3002\u8981\u5339\u914D\u95EE\u53F7\u661F\u53F7\u672C\u8EAB\uFF0C\u8BF7\u5728\u8BE5\u5B57\u7B26\u524D\u9762\u52A0\u4E0A\u6CE2\u6D6A\u53F7(~)\u524D\u7F00\uFF08\u5373~?\u548C~*\uFF09\u3002\u5B57\u7B26\u4E32\u6761\u4EF6\u5FC5\u987B\u7528\u5F15\u53F7\u62EC\u8D77\u6765\u3002\u51FD\u6570\u4F1A\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u4E0E\u6761\u4EF6\u662F\u5426\u76F8\u7B49\u6216\u5339\u914D\uFF08\u5982\u679C\u4F7F\u7528\u4E86\u901A\u914D\u7B26\uFF09\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6570\u5B57\uFF0C\u5219\u6761\u4EF6\u53EF\u4EE5\u662F\u5B57\u7B26\u4E32\u4E5F\u53EF\u4EE5\u662F\u6570\u5B57\u3002\u5982\u679C\u7ED9\u5B9A\u7684\u6761\u4EF6\u662F\u4E00\u4E2A\u6570\u5B57\uFF0C\u5219\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u662F\u5426\u7B49\u4E8E\u6761\u4EF6\u3002\u53E6\u5916\uFF0C\u6761\u4EF6\u4E5F\u53EF\u80FD\u662F\u5305\u542B\u6570\u5B57\u7684\u5B57\u7B26\u4E32\uFF08\u4E5F\u5C06\u5BF9\u5176\u8FDB\u884C\u76F8\u7B49\u68C0\u6D4B\uFF09\uFF0C\u6216\u8005\u5E26\u6709\u4EE5\u4E0B\u524D\u7F00\u7684\u6570\u5B57\uFF1A=\uFF08\u68C0\u67E5\u662F\u5426\u76F8\u7B49\uFF09\u3001>\uFF08\u68C0\u67E5\u8303\u56F4\u5355\u5143\u683C\u7684\u503C\u662F\u5426\u5927\u4E8E\u6761\u4EF6\u503C\uFF09\u6216<\uFF08\u68C0\u67E5\u8303\u56F4\u5355\u5143\u683C\u7684\u503C\u662F\u5426\u5C0F\u4E8E\u6761\u4EF6\u503C\uFF09`},range1:{name:"\u6C42\u548C\u8303\u56F4",detail:"\u8981\u6C42\u548C\u7684\u8303\u56F4\uFF08\u5982\u679C\u4E0E\u8303\u56F4\u4E0D\u540C\uFF09\u3002"}}},TAN:{d:"\u8FD4\u56DE\u5DF2\u77E5\u89D2\u5EA6\u7684\u6B63\u5207\u503C\u3002",p:{rangeNumber:{name:"\u89D2\u5EA6",detail:"\u8981\u6C42\u5176\u6B63\u5207\u503C\u7684\u89D2\u5EA6\uFF0C\u4EE5\u5F27\u5EA6\u8868\u793A\u3002"}}},TANH:{d:"\u8FD4\u56DE\u7ED9\u5B9A\u5B9E\u6570\u7684\u53CC\u66F2\u6B63\u5207\u503C\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CC\u66F2\u6B63\u5207\u503C\u7684\u5B9E\u6570\u3002"}}},CEILING:{d:"\u5C06\u6570\u503C\u5411\u4E0A\u53D6\u6574\u4E3A\u6700\u63A5\u8FD1\u7684\u6307\u5B9A\u56E0\u6570\u7684\u500D\u6570\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u5411\u4E0A\u820D\u5165\u7684\u6570\u503C\u3002"},rangeNumber1:{name:"\u56E0\u6570",detail:"\u8981\u5C06\u503C\u820D\u5165\u5230\u6B64\u6570\u7684\u6574\u6570\u500D\u3002"}}},ATAN:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u53CD\u6B63\u5207\u503C\uFF0C\u4EE5\u5F27\u5EA6\u8868\u793A\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CD\u6B63\u5207\u503C\u7684\u6570\u503C\u3002"}}},ASINH:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u53CD\u53CC\u66F2\u6B63\u5F26\u503C\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CD\u53CC\u66F2\u6B63\u5F26\u503C\u7684\u6570\u503C\u3002"}}},ABS:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u7EDD\u5BF9\u503C\u3002",p:{rangeNumber:{name:"value",detail:"\u8981\u8FD4\u56DE\u5176\u7EDD\u5BF9\u503C\u7684\u6570\u3002"}}},COUNTBLANK:{d:"\u8FD4\u56DE\u7ED9\u5B9A\u8303\u56F4\u5185\u7684\u7A7A\u5355\u5143\u683C\u6570\u3002",p:{range:{name:"\u8303\u56F4",detail:"\u8981\u7EDF\u8BA1\u7A7A\u767D\u5355\u5143\u683C\u6570\u91CF\u7684\u8303\u56F4\u3002"}}},COSH:{d:"\u8FD4\u56DE\u7ED9\u5B9A\u5B9E\u6570\u7684\u53CC\u66F2\u4F59\u5F26\u503C\u3002",p:{rangeNumber:{name:"\u503C",detail:"\u8981\u8BA1\u7B97\u5176\u53CC\u66F2\u4F59\u5F26\u503C\u7684\u5B9E\u6570\u503C\u3002"}}},COUNTIF:{d:"\u8FD4\u56DE\u8303\u56F4\u5185\u6EE1\u8DB3\u67D0\u4E2A\u6761\u4EF6\u7684\u5355\u5143\u683C\u7684\u6570\u91CF\u3002",p:{range:{name:"\u8303\u56F4",detail:"\u8981\u6839\u636E\u6761\u4EF6\u8FDB\u884C\u68C0\u6D4B\u7684\u8303\u56F4\u3002"},rangeAll:{name:"\u6761\u4EF6",detail:`\u8981\u5E94\u7528\u4E8E\u8303\u56F4\u7684\u6A21\u5F0F\u6216\u6D4B\u8BD5\u6761\u4EF6\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6587\u672C\uFF0C\u5219\u6761\u4EF6\u5FC5\u987B\u4E3A\u5B57\u7B26\u4E32\u3002\u6761\u4EF6\u53EF\u4EE5\u5305\u542B\u901A\u914D\u7B26\uFF0C\u5305\u62EC\u7528\u4E8E\u5339\u914D\u5355\u4E2A\u5B57\u7B26\u7684?\u6216\u7528\u4E8E\u5339\u914D\u96F6\u4E2A\u6216\u8FDE\u7EED\u591A\u4E2A\u5B57\u7B26\u7684*\u3002\u8981\u5339\u914D\u95EE\u53F7\u661F\u53F7\u672C\u8EAB\uFF0C\u8BF7\u5728\u8BE5\u5B57\u7B26\u524D\u9762\u52A0\u4E0A\u6CE2\u6D6A\u53F7(~)\u524D\u7F00\uFF08\u5373~?\u548C~*\uFF09\u3002\u5B57\u7B26\u4E32\u6761\u4EF6\u5FC5\u987B\u7528\u5F15\u53F7\u62EC\u8D77\u6765\u3002\u51FD\u6570\u4F1A\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u4E0E\u6761\u4EF6\u662F\u5426\u76F8\u7B49\u6216\u5339\u914D\uFF08\u5982\u679C\u4F7F\u7528\u4E86\u901A\u914D\u7B26\uFF09\u3002

\u5982\u679C\u8303\u56F4\u5305\u542B\u7684\u662F\u8981\u68C0\u6D4B\u7684\u6570\u5B57\uFF0C\u5219\u6761\u4EF6\u53EF\u4EE5\u662F\u5B57\u7B26\u4E32\u4E5F\u53EF\u4EE5\u662F\u6570\u5B57\u3002\u5982\u679C\u7ED9\u5B9A\u7684\u6761\u4EF6\u662F\u4E00\u4E2A\u6570\u5B57\uFF0C\u5219\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u6BCF\u4E2A\u5355\u5143\u683C\u662F\u5426\u7B49\u4E8E\u6761\u4EF6\u3002\u53E6\u5916\uFF0C\u6761\u4EF6\u4E5F\u53EF\u80FD\u662F\u5305\u542B\u6570\u5B57\u7684\u5B57\u7B26\u4E32\uFF08\u4E5F\u5C06\u5BF9\u5176\u8FDB\u884C\u76F8\u7B49\u68C0\u6D4B\uFF09\uFF0C\u6216\u8005\u5E26\u6709\u4EE5\u4E0B\u524D\u7F00\u7684\u6570\u5B57\uFF1A=\u3001>\u3001>=\u3001<\u6216<=\uFF0C\u8FD9\u4E9B\u6761\u4EF6\u5C06\u5206\u522B\u7528\u4E8E\u68C0\u67E5\u8303\u56F4\u4E2D\u7684\u5355\u5143\u683C\u662F\u5426\u7B49\u4E8E\u3001\u5927\u4E8E\u3001\u5927\u4E8E\u7B49\u4E8E\u3001\u5C0F\u4E8E\u3001\u5C0F\u4E8E\u7B49\u4E8E\u6761\u4EF6\u503C\u3002`}}},ERFC:{d:"\u8FD4\u56DE\u6570\u503C\u7684\u4E92\u8865\u9AD8\u65AF\u8BEF\u5DEE\u51FD\u6570\u3002",p:{rangeNumber:{name:"z",detail:"\u8981\u4E3A\u5176\u8BA1\u7B97\u4E92\u8865\u9AD8\u65AF\u8BEF\u5DEE\u51FD\u6570\u7684\u6570\u503C\u3002"}}},VLOOKUP:{d:"\u7EB5\u5411\u67E5\u627E\u3002\u5728\u8303\u56F4\u7684\u7B2C\u4E00\u5217\u4E2D\u81EA\u4E0A\u800C\u4E0B\u641C\u7D22\u67D0\u4E2A\u952E\u503C\uFF0C\u5E76\u8FD4\u56DE\u6240\u627E\u5230\u7684\u884C\u4E2D\u6307\u5B9A\u5355\u5143\u683C\u7684\u503C\u3002",p:{rangeAll:{name:"\u641C\u7D22\u952E\u503C",detail:'\u8981\u641C\u7D22\u7684\u503C\uFF0C\u5982 42\u3001"Cats" \u6216 I24\u3002'},rangeAll1:{name:"\u8303\u56F4",detail:"\u8981\u8FDB\u884C\u641C\u7D22\u7684\u8303\u56F4\u3002VLOOKUP \u5C06\u5728\u8BE5\u8303\u56F4\u7684\u7B2C\u4E00\u5217\u4E2D\u641C\u7D22\u641C\u7D22\u952E\u503C\u4E2D\u6307\u5B9A\u7684\u952E\u503C\u3002"},rangeNumber:{name:"\u7D22\u5F15",detail:`\u8981\u8FD4\u56DE\u7684\u503C\u7684\u5217\u7D22\u5F15\uFF0C\u8303\u56F4\u4E2D\u7684\u7B2C\u4E00\u5217\u7F16\u53F7\u4E3A 1\u3002

\u5982\u679C\u7D22\u5F15\u4E0D\u662F\u4ECB\u4E8E 1 \u548C\u8303\u56F4\u4E2D\u7684\u5217\u6570\u4E4B\u95F4\uFF0C\u5C06\u8FD4\u56DE #VALUE! \u3002`},rangeAll2:{name:"\u5DF2\u6392\u5E8F",detail:`[\u9ED8\u8BA4\u503C\u4E3A TRUE() ] - \u6307\u793A\u8981\u641C\u7D22\u7684\u5217\uFF08\u6307\u5B9A\u8303\u56F4\u7684\u7B2C\u4E00\u5217\uFF09\u662F\u5426\u5DF2\u6392\u5E8F\u3002\u5927\u591A\u6570\u60C5\u51B5\u4E0B\uFF0C\u5EFA\u8BAE\u8BBE\u4E3A FALSE()\u3002

\u5EFA\u8BAE\u5C06\u5DF2\u6392\u5E8F\u8BBE\u4E3A FALSE\u3002\u5982\u679C\u8BBE\u4E3A FALSE\uFF0C\u5C06\u8FD4\u56DE\u5B8C\u5168\u5339\u914D\u9879\u3002\u5982\u679C\u5B58\u5728\u591A\u4E2A\u5339\u914D\u503C\uFF0C\u5C06\u8FD4\u56DE\u627E\u5230\u7684\u7B2C\u4E00\u4E2A\u503C\u5BF9\u5E94\u7684\u5355\u5143\u683C\u7684\u5185\u5BB9\uFF0C\u5982\u679C\u627E\u4E0D\u5230\u5339\u914D\u503C\uFF0C\u5219\u8FD4\u56DE #N/A\u3002

\u5982\u679C\u5C06\u5DF2\u6392\u5E8F\u8BBE\u4E3A TRUE \u6216\u7701\u7565\uFF0C\u5C06\u8FD4\u56DE\uFF08\u5C0F\u4E8E\u6216\u7B49\u4E8E\u641C\u7D22\u952E\u503C\u7684\uFF09\u6700\u63A5\u8FD1\u7684\u5339\u914D\u9879\u3002\u5982\u679C\u641C\u7D22\u7684\u5217\u4E2D\u6240\u6709\u7684\u503C\u5747\u5927\u4E8E\u641C\u7D22\u952E\u503C\uFF0C\u5219\u8FD4\u56DE #N/A\u3002`}}},TIME:{d:"\u5C06\u7ED9\u5B9A\u7684\u5C0F\u65F6\u3001\u5206\u949F\u548C\u79D2\u8F6C\u6362\u4E3A\u65F6\u95F4\u3002",p:{rangeNumber:{name:"\u5C0F\u65F6",detail:`0\uFF08\u96F6\uFF09\u5230 32767 \u4E4B\u95F4\u7684\u6570\u5B57\uFF0C\u4EE3\u8868\u5C0F\u65F6\u3002

\u4EFB\u4F55\u5927\u4E8E 23 \u7684\u503C\u90FD\u4F1A\u9664\u4EE5 24\uFF0C\u4F59\u6570\u5C06\u4F5C\u4E3A\u5C0F\u65F6\u503C\u3002`},rangeNumber1:{name:"\u5206\u949F",detail:`0\uFF08\u96F6\uFF09\u5230 32767 \u4E4B\u95F4\u7684\u6570\u5B57\uFF0C\u4EE3\u8868\u5206\u949F\u3002

\u4EFB\u4F55\u5927\u4E8E 59 \u7684\u503C\u5C06\u8F6C\u6362\u4E3A\u5C0F\u65F6\u548C\u5206\u949F\u3002`},rangeNumber2:{name:"\u79D2",detail:`0\uFF08\u96F6\uFF09\u5230 32767 \u4E4B\u95F4\u7684\u6570\u5B57\uFF0C\u4EE3\u8868\u79D2\u3002

\u4EFB\u4F55\u5927\u4E8E 59 \u7684\u503C\u5C06\u8F6C\u6362\u4E3A\u5C0F\u65F6\u3001\u5206\u949F\u548C\u79D2\u3002`}}},EFFECT:{d:"\u6839\u636E\u540D\u4E49\u5229\u7387\u53CA\u6BCF\u5E74\u7684\u590D\u5229\u8BA1\u606F\u671F\u6570\u6765\u8BA1\u7B97\u5B9E\u9645\u5E74\u5229\u7387\u3002",p:{rangeNumber:{name:"nominal_rate",detail:"\u6BCF\u5E74\u7684\u540D\u4E49\u5229\u7387\u3002"},rangeNumber1:{name:"npery",detail:"\u6BCF\u5E74\u7684\u590D\u5229\u8BA1\u7B97\u671F\u6570\u3002"}}},BIN2DEC:{d:"\u5C06\u4E8C\u8FDB\u5236\u6570\u8F6C\u6362\u4E3A\u5341\u8FDB\u5236\u6570\u3002",p:{rangeAll:{name:"number",detail:`\u8981\u8F6C\u6362\u4E3A\u5341\u8FDB\u5236\u6570\u7684\u5E26\u7B26\u53F7\u768410\u4F4D\u4E8C\u8FDB\u5236\u6570\u503C\uFF08\u4EE5\u5B57\u7B26\u4E32\u5F62\u5F0F\u63D0\u4F9B\uFF09\u3002

\u5E26\u7B26\u53F7\u7684\u4E8C\u8FDB\u5236\u6570\u7684\u6700\u9AD8\u4F4D\u662F\u7B26\u53F7\u4F4D\uFF1B\u4E5F\u5C31\u662F\u8BF4\uFF0C\u8D1F\u6570\u662F\u4EE5\u4E8C\u7684\u8865\u7801\u5F62\u5F0F\u8868\u793A\u7684\u3002

\u5BF9\u4E8E\u6B64\u51FD\u6570\uFF0C\u6700\u5927\u7684\u6B63\u6570\u8F93\u5165\u503C\u4E3A0111111111\uFF0C\u6700\u5C0F\u7684\u8D1F\u6570\u8F93\u5165\u503C\u4E3A1000000000\u3002

\u5982\u679C\u6240\u63D0\u4F9B\u7684\u5E26\u7B26\u53F7\u7684\u4E8C\u8FDB\u5236\u6570\u662F\u6709\u6548\u7684\u4E8C\u8FDB\u5236\u6570\uFF0C\u4F1A\u81EA\u52A8\u5C06\u5176\u8F6C\u6362\u4E3A\u76F8\u5E94\u7684\u5B57\u7B26\u4E32\u8F93\u5165\u3002\u4F8B\u5982\uFF0CBIN2DEC(100)\u548CBIN2DEC("100")\u5F97\u51FA\u7684\u7ED3\u679C\u76F8\u540C\uFF0C\u5747\u4E3A4\u3002`}}},TRUE:{d:"\u8FD4\u56DE\u903B\u8F91\u503C TRUE\u3002"},NE:{d:"\u5982\u679C\u6307\u5B9A\u7684\u503C\u4E0D\u76F8\u7B49\uFF0C\u5219\u8FD4\u56DE\u201CTRUE\u201D\uFF1B\u5426\u5219\u8FD4\u56DE\u201CFALSE\u201D\u3002\u76F8\u5F53\u4E8E\u201C<>\u201D\u8FD0\u7B97\u7B26\u3002",p:{rangeAll:{name:"value1",detail:"\u7B2C\u4E00\u4E2A\u503C\u3002"},rangeAll1:{name:"value2",detail:"\u8981\u68C0\u67E5\u662F\u5426\u4E0E value1 \u4E0D\u76F8\u7B49\u7684\u503C\u3002"}}},SEX_BY_IDCARD:{d:"\u6839\u636E\u4E2D\u56FD\u8EAB\u4EFD\u8BC1\u53F7\u8BA1\u7B97\u51FA\u6027\u522B\u3002\u652F\u630115\u4F4D\u621618\u4F4D\u8EAB\u4EFD\u8BC1",p:{rangeAll:{name:"\u8EAB\u4EFD\u8BC1\u53F7",detail:"15\u4F4D\u6216\u800518\u4F4D\u7684\u8EAB\u4EFD\u8BC1\u53F7\u6216\u8303\u56F4\u3002"}}}},formulaMore:{valueTitle:"\u503C",tipSelectDataRange:"\u9009\u53D6\u6570\u636E\u8303\u56F4",tipDataRangeTile:"\u6570\u636E\u8303\u56F4",findFunctionTitle:"\u67E5\u627E\u51FD\u6570",tipInputFunctionName:"\u8BF7\u8F93\u5165\u60A8\u8981\u67E5\u627E\u7684\u51FD\u6570\u540D\u79F0\u6216\u51FD\u6570\u529F\u80FD\u7684\u7B80\u8981\u63CF\u8FF0",whole:"\u5168\u90E8",Math:"\u6570\u5B66",Statistical:"\u7EDF\u8BA1",Lookup:"\u67E5\u627E",universheet:"UniverSheet\u5185\u7F6E",dataMining:"\u6570\u636E\u6316\u6398",Database:"\u6570\u636E\u6E90",Date:"\u65E5\u671F",Filter:"\u8FC7\u6EE4\u5668",Financial:"\u8D22\u52A1",Engineering:"\u5DE5\u7A0B\u8BA1\u7B97",Logical:"\u903B\u8F91",Operator:"\u8FD0\u7B97\u7B26",Text:"\u6587\u672C",Parser:"\u8F6C\u6362\u5DE5\u5177",Array:"\u6570\u7EC4",other:"\u5176\u5B83",selectFunctionTitle:"\u9009\u62E9\u51FD\u6570",calculationResult:"\u8BA1\u7B97\u7ED3\u679C",tipSuccessText:"\u6210\u529F",tipParamErrorText:"\u53C2\u6570\u7C7B\u578B\u9519\u8BEF",helpClose:"\u5173\u95ED",helpCollapse:"\u6536\u8D77",helpExample:"\u793A\u4F8B",helpAbstract:"\u6458\u8981",execfunctionError:'\u63D0\u793A", "\u516C\u5F0F\u5B58\u5728\u9519\u8BEF',execfunctionSelfError:"\u516C\u5F0F\u4E0D\u53EF\u5F15\u7528\u5176\u672C\u8EAB\u7684\u5355\u5143\u683C",execfunctionSelfErrorResult:"\u516C\u5F0F\u4E0D\u53EF\u5F15\u7528\u5176\u672C\u8EAB\u7684\u5355\u5143\u683C\uFF0C\u4F1A\u5BFC\u81F4\u8BA1\u7B97\u7ED3\u679C\u4E0D\u51C6\u786E",allowRepeatText:"\u53EF\u91CD\u590D",allowOptionText:"\u53EF\u9009",selectCategory:"\u6216\u9009\u62E9\u7C7B\u522B"},ifFormula:{tipNotBelongToIf:"\u8BE5\u5355\u5143\u683C\u51FD\u6570\u4E0D\u5C5E\u4E8Eif\u516C\u5F0F\uFF01",tipSelectCell:"\u8BF7\u9009\u62E9\u5355\u5143\u683C\u63D2\u5165\u51FD\u6570",ifGenCompareValueTitle:"\u6BD4\u8F83\u503C",ifGenSelectCellTitle:"\u70B9\u51FB\u9009\u62E9\u5355\u5143\u683C",ifGenRangeTitle:"\u8303\u56F4",ifGenRangeTo:"\u81F3",ifGenRangeEvaluate:"\u8303\u56F4\u8BC4\u4F30",ifGenSelectRangeTitle:"\u70B9\u51FB\u9009\u62E9\u8303\u56F4",ifGenCutWay:"\u5212\u5206\u65B9\u5F0F",ifGenCutSame:"\u5212\u5206\u503C\u76F8\u540C",ifGenCutNpiece:"\u5212\u5206\u4E3AN\u4EFD",ifGenCutCustom:"\u81EA\u5B9A\u4E49\u8F93\u5165",ifGenCutConfirm:"\u751F\u6210",ifGenTipSelectCell:"\u9009\u62E9\u5355\u5143\u683C",ifGenTipSelectCellPlace:"\u8BF7\u9009\u62E9\u5355\u5143\u683C",ifGenTipSelectRange:"\u9009\u62E9\u5355\u8303\u56F4",ifGenTipSelectRangePlace:"\u8BF7\u9009\u62E9\u8303\u56F4",ifGenTipNotNullValue:"\u6BD4\u8F83\u503C\u4E0D\u80FD\u4E3A\u7A7A\uFF01",ifGenTipLableTitile:"\u6807\u7B7E",ifGenTipRangeNotforNull:"\u8303\u56F4\u4E0D\u80FD\u4E3A\u7A7A\uFF01",ifGenTipCutValueNotforNull:"\u5212\u5206\u503C\u4E0D\u80FD\u4E3A\u7A7A\uFF01",ifGenTipNotGenCondition:"\u6CA1\u6709\u751F\u6210\u53EF\u7528\u7684\u6761\u4EF6\uFF01"}}},iR={formula:{formulaLabel:"SUM",formulaRightLabel:"more formule",ok:"Ok",cancel:"Cancel",clearValidation:"Clear Validation",formula:{sum:"sum",average:"average",count:"count",max:"max",min:"min",if:"If formula generator",more:"More functions..."},functionList:{SUMIF:{d:"Returns a conditional sum across a range.",p:{range:{name:"range",detail:"The range which is tested against `criterion`."},rangeAll:{name:"criterion",detail:"The pattern or test to apply to `range`."},range1:{name:"sum_range",detail:"The range to be summed, if different from `range`."}}},TAN:{d:"Returns the tangent of an angle provided in radians.",p:{rangeNumber:{name:"angle",detail:"The angle to find the tangent of, in radians."}}},TANH:{d:"Returns the hyperbolic tangent of any real number.",p:{rangeNumber:{name:"value",detail:"Any real value to calculate the hyperbolic tangent of."}}},CEILING:{d:"Rounds a number up to the nearest integer multiple of specified significance `factor`.",p:{rangeNumber:{name:"value",detail:"The value to round up to the nearest integer multiple of `factor`."},rangeNumber1:{name:"factor",detail:"The number to whose multiples `value` will be rounded."}}},ATAN:{d:"Returns the inverse tangent of a value, in radians.",p:{rangeNumber:{name:"value",detail:"The value for which to calculate the inverse tangent."}}},ASINH:{d:"Returns the inverse hyperbolic sine of a number.",p:{rangeNumber:{name:"value",detail:"The value for which to calculate the inverse hyperbolic sine."}}},ABS:{d:"Returns the absolute value of a number.",p:{rangeNumber:{name:"value",detail:"The number of which to return the absolute value."}}},COUNTBLANK:{d:"Returns the number of empty values in a list of values and ranges.",p:{range:{name:"value1",detail:"The first value or range in which to count the number of blanks."}}},COSH:{d:"Returns the hyperbolic cosine of any real number.",p:{rangeNumber:{name:"value",detail:"Any real value to calculate the hyperbolic cosine of."}}},COUNTIF:{d:"Returns a conditional count across a range.",p:{range:{name:"range",detail:"The range that is tested against `criterion`."},rangeAll:{name:"criterion",detail:"The pattern or test to apply to `range`."}}},ERFC:{d:"Returns the complementary Gauss error function of a value.",p:{rangeNumber:{name:"z",detail:"The number for which to calculate the complementary Gauss error function."}}},VLOOKUP:{d:"Vertical lookup. Searches down the first column of a range for a key and returns the value of a specified cell in the row found.",p:{rangeAll:{name:"search_key",detail:'The value to search for. For example, `42`, `"Cats"`, or `I24`.'},rangeAll1:{name:"range",detail:"The range to consider for the search. The first column in the range is searched for the key specified in `search_key`. "},rangeNumber:{name:"index",detail:"The column index of the value to be returned, where the first column in `range` is numbered 1."},rangeAll2:{name:"is_sorted",detail:"Indicates whether the column to be searched (the first column of the specified range) is sorted, in which case the closest match for `search_key` will be returned."}}},TIME:{d:"Converts a provided hour, minute, and second into a time.",p:{rangeNumber:{name:"hour",detail:"0The hour component of the time."},rangeNumber1:{name:"minute",detail:"The minute component of the time."},rangeNumber2:{name:"second",detail:"The second component of the time."}}},EFFECT:{d:"Calculates the annual effective interest rate given the nominal rate and number of compounding periods per year.",p:{rangeNumber:{name:"nominal_rate",detail:"The nominal interest rate per year."},rangeNumber1:{name:"periods_per_year",detail:"The number of compounding periods per year."}}},BIN2DEC:{d:"Converts a signed binary number to decimal format.",p:{rangeAll:{name:"signed_binary_number",detail:"The signed 10-bit binary value to be converted to decimal, provided as a string."}}},TRUE:{d:"Returns the logical value `TRUE`."},NE:{d:"Returns `TRUE` if two specified values are not equal and `FALSE` otherwise. Equivalent to the `!=` operator.",p:{rangeAll:{name:"value1",detail:"The first value."},rangeAll1:{name:"value2",detail:"The value to test against `value1` for inequality."}}},SEX_BY_IDCARD:{d:"Calculate gender based on Chinese ID number. Support 15 or 18",p:{rangeAll:{name:"ID number",detail:"15-digit or 18-digit ID number or range."}}}},functiontype:{0:"Math",1:"Statistical",2:"Lookup",3:"UniverSheet",4:"Data Mining",5:"Database",6:"Date",7:"Filter",8:"Financial",9:"Engineering",10:"Logical",11:"Operator",12:"Text",13:"Parser",14:"Array",15:"Other"},formulaMore:{valueTitle:"Value",tipSelectDataRange:"Select data range",tipDataRangeTile:"Data range",findFunctionTitle:"Search function",tipInputFunctionName:"Function name or brief description of function",whole:"Whole",Math:"Math",Statistical:"Statistical",Lookup:"Lookup",universheet:"UniverSheet",dataMining:"Data Mining",Database:"Database",Date:"Date",Filter:"Filter",Financial:"Financial",Engineering:"Engineering",Logical:"Logical",Operator:"Operator",Text:"Text",Parser:"Parser",Array:"Array",other:"Other",selectFunctionTitle:"Select a function",calculationResult:"Result",tipSuccessText:"Success",tipParamErrorText:"Parameter type error",helpClose:"Close",helpCollapse:"Collapse",helpExample:"Example",helpAbstract:"Abstract",execfunctionError:"Error in the formula",execfunctionSelfError:"The formula cannot refer to its own cell",execfunctionSelfErrorResult:"The formula cannot refer to its own cell, which will lead to inaccurate calculation results",allowRepeatText:"Repeat",allowOptionText:"Option",selectCategory:"Or select a category"},ifFormula:{tipNotBelongToIf:"This cell function does not belong to the if formula!",tipSelectCell:"Please select the cell to insert the function",ifGenCompareValueTitle:"Comparison value",ifGenSelectCellTitle:"Click to select cell",ifGenRangeTitle:"Range",ifGenRangeTo:"to",ifGenRangeEvaluate:"Range evaluate",ifGenSelectRangeTitle:"Click to select range",ifGenCutWay:"Partition way",ifGenCutSame:"Same Partition value",ifGenCutNpiece:"Partition by N",ifGenCutCustom:"Custom",ifGenCutConfirm:"Confirm",ifGenTipSelectCell:"Select cells",ifGenTipSelectCellPlace:"Please select cells",ifGenTipSelectRange:"Select range",ifGenTipSelectRangePlace:"Please select range",ifGenTipNotNullValue:"The comparison value cannot be empty!",ifGenTipLableTitile:"Label",ifGenTipRangeNotforNull:"The range cannot be empty!",ifGenTipCutValueNotforNull:"The partition value cannot be empty!",ifGenTipNotGenCondition:"No conditions are available for generation!"}}};class oR{constructor(e){this._formulaData={},this._calculationChain=[],this._recalculationMode=Ig.AUTOMATIC,e!=null&&e.formulaData&&(this._formulaData=e.formulaData),e!=null&&e.calculationChain&&(this._calculationChain=e.calculationChain),e!=null&&e.recalculationMode&&(this._recalculationMode=e.recalculationMode)}getFormulaData(){return this._formulaData}setFormulaData(e){this._formulaData=e}}class Ga extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const e=this._render.renderFunction("SumIcon"),{label:t}=this.props;return b("div",{style:{display:"flex",alignItems:"center"}},b(e,null),t)}}class aR{constructor(e,t){this._plugin=e,this._formulaDataModel=new oR(t),this._context=this._plugin.getContext(),this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET),this._initRegisterComponent(),this._sheetPlugin.addToolButton({name:Pt,locale:Pt,hideSelectedIcon:!0,customLabel:{name:Pt+Ga.name,props:{locale:"formula.formula.sum"}},type:5,show:QS.show,tooltipLocale:"formula.formulaLabel",children:[{locale:"formula.formula.sum",suffix:"SUM"},{locale:"formula.formula.average",suffix:"AVERAGE"},{locale:"formula.formula.max",suffix:"MAX"},{locale:"formula.formula.min",suffix:"MIN",border:!0},{locale:"formula.formula.if",suffix:"IF"},{locale:"formula.formula.more",onClick:()=>this._plugin.getSearchFormulaController().showFormulaModal("SearchFormula",!0)}]})}_initRegisterComponent(){this._sheetPlugin.registerComponent(Pt+Ga.name,Ga)}getDataModel(){return this._formulaDataModel}setFormulaEngine(e){this._formulaEngine=e}getFormulaEngine(){return this._formulaEngine}toInterpreterCalculateProps(e=!0){return(e||!this._interpreterCalculatePropsCache)&&(this._interpreterCalculatePropsCache=this._toInterpreterCalculateProps()),this._interpreterCalculatePropsCache}getCommandManager(){return this._context.getCommandManager()}getWorkbook(){return this._context.getWorkBook()}getUnitId(){return this.getWorkbook().getUnitId()}_toInterpreterCalculateProps(){const e=this._context.getWorkBook(),t=e.getSheets(),n={},s={},i={},o=e.getUnitId();for(let h of t)n[h.getSheetId()]=h.getCellMatrix(),i[h.getName()]=h.getSheetId();s[o]=n;const a=this._formulaDataModel.getFormulaData(),l=e.getActiveSheet(),u=l.getRowCount(),c=l.getColumnCount();return{unitData:s,formulaData:a,sheetNameMap:i,currentRow:-1,currentColumn:-1,currentSheetId:"",currentUnitId:o,rowCount:u,columnCount:c}}}function lR(r){const e=r.getDataModel(),n=r.getFormulaEngine().execute(r.getUnitId(),e.getFormulaData(),r.toInterpreterCalculateProps(),!0),s=r.getCommandManager(),i=r.getWorkbook();n.then(o=>{if(!o)return;const{sheetData:a,arrayFormulaData:l}=o;if(!a)return;const u=Object.keys(a),c=[];for(let f=0,d=u.length;f<d;f++){const m=u[f];a[m].forValue((p,_,v)=>{const w={actionName:W.SET_RANGE_DATA_ACTION,sheetId:m,cellValue:{[p]:{[_]:v}}};c.push(Dr.make(w).removeCollaboration().removeUndo().removeExtension().getAction())})}const h=new fe({WorkBookUnit:i},...c);s.invoke(h)})}class uR extends wg{setValue(e){this._cell.value=e}execute(){this.setValue(this._value)}}class cR extends nw{get zIndex(){return 0}create(e,t){return new uR(e,t)}check(e){const{row:t,column:n}=e,s=this._plugin.getFormulaController().getDataModel().getFormulaData();let i;return Object.keys(s).forEach(o=>{const a=s[o],l=Object.keys(a);for(let u=0,c=l.length;u<c;u++){const h=l[u],f=a[h];Object.keys(f).forEach(d=>{f[d].forEach((g,p)=>{if(Number(d)===t&&g===n)return i=this._plugin.getFormulaPromptController().cellInputHandler.functionHTMLGenerate(p.formula),!1})})}}),i?this.create(e,i):!1}}class hR extends Tg{setValue(e){this._cell.value=e}execute(){this.setValue(this._value)}}class dR extends iw{get zIndex(){return 0}create(e,t){return new hR(e,t)}check(e){const{row:t,column:n}=e,s=this._plugin.getFormulaController().getDataModel().getFormulaData();let i;return Object.keys(s).forEach(o=>{const a=s[o],l=Object.keys(a);for(let u=0,c=l.length;u<c;u++){const h=l[u],f=a[h];Object.keys(f).forEach(d=>{f[d].forEach((g,p)=>{if(Number(d)===t&&g===n)return i=p.formula,!1})})}}),i?this.create(e,i):!1}}class fR extends Zo{execute(){const e=this._plugin.getFormulaEngine(),t=this._plugin.getFormulaController(),n=t.getDataModel(),s=G.deepClone(n.getFormulaData()),i=this._plugin.getContext().getWorkBook().getUnitId(),o=this.actionDataList,a=[];let l=!1;o.forEach(u=>{if(u.operation!=null&&!Dr.hasExtension(u))return!1;if(u.actionName===W.SET_RANGE_DATA_ACTION){const{sheetId:c,cellValue:h}=u;if(G.isEmptyObject(s))return;const f=new pe(s[i][c]);if(h==null)return;const d=new pe(h);d.forValue((m,g,p)=>{var v;const _=p.m;G.isStringNumber(_)?(l=!0,(v=f.getRow(m))!=null&&v.get(g)&&f.deleteValue(m,g)):H0(_)&&(l=!0,f.setValue(m,g,{formula:_,row:m,column:g,sheetId:c}))}),a.push({unitId:i,sheetId:c,rangeData:d.getDataRange()})}}),!(a.length===0||!l)&&e.execute(i,s,t.toInterpreterCalculateProps(),!1,a).then(u=>{const{sheetData:c,arrayFormulaData:h}=u;if(!c){console.error("No sheetData from Formula Engine!");return}const f=Object.keys(c),d=[];f.forEach(v=>{const w=c[v];w.forValue((y,A,I)=>{const R=w.getValue(y,A);R&&R.p&&delete R.p,R&&Number.isNaN(R.v)&&(R.v=0);const x={actionName:W.SET_RANGE_DATA_ACTION,sheetId:v,cellValue:{[y]:{[A]:R||{}}}},S=Dr.make(x).removeCollaboration().removeUndo().removeExtension().getAction();d.push(S)})});const m={actionName:vu.SET_FORMULA_RANGE_DATA_ACTION,sheetId:o[0].sheetId,formulaData:s},g=this._plugin.getContext().getWorkBook(),p=this._plugin.getContext().getCommandManager(),_=new fe({WorkBookUnit:g},...d,m);p.invoke(_)})}}class gR extends Bl{get zIndex(){return 1}create(e){return new fR(e,this._plugin)}}function mR(r){r.pushToObserve("onSearchFormulaModalDidMountObservable"),r.pushToObserve("onSearchItemDidMountObservable"),r.pushToObserve("onSearchFunctionDidMountObservable"),r.pushToObserve("onHelpFunctionDidMountObservable")}const pR="univer-function-modal",_R="univer-function-search",bR="univer-function-select",vR="univer-function-label",CR="univer-function-selector",ER="univer-select-button",wR="univer-function-list",TR="univer-function-lists",yR="univer-function-lists-item",SR="univer-function-lists-item-active",AR="univer-function-param-modal",RR="univer-function-param-list",DR="univer-function-param-desc",xR="univer-function-param-desc-details",IR="univer-function-btn",OR="univer-btn";var Tt={functionModal:pR,functionSearch:_R,functionSelect:bR,functionLabel:vR,functionSelector:CR,selectButton:ER,functionList:wR,functionLists:TR,functionListsItem:yR,functionListsItemActive:SR,functionParamModal:AR,functionParamList:RR,functionParamDesc:DR,functionParamDescDetails:xR,functionBtn:IR,btn:OR};class Xa extends Xe{constructor(){super(...arguments),this.functionListRef=Ve()}initialize(){var n;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender();const t=(n=this.props.funList.children)==null?void 0:n.filter(s=>s.t===0);this.state={functionList:t,type:0}}changeInput(e){var i;const t=e.target.value;let{functionList:n,type:s}=this.state;t?n=n==null?void 0:n.filter(o=>{var a,l;return((a=o.n)==null?void 0:a.includes(t))||((l=o.d)==null?void 0:l.includes(t))?o:null}):n=(i=this.props.funList.children)==null?void 0:i.filter(o=>o.t===s),this.setState({functionList:n})}selectType(e,t){var i;const{funList:n}=this.props,s=(i=n.children)==null?void 0:i.filter(o=>o.t===t);this.setState({functionList:s,type:t},()=>{this.highLightLi(0)})}componentDidMount(){this.highLightLi(0)}highLightLi(e){const t=this.functionListRef.current.querySelectorAll(`.${Tt.functionListsItem}`);for(let n=0;n<t.length;n++)t[n].classList.remove(Tt.functionListsItemActive);t[e].classList.add(Tt.functionListsItemActive),t[e].click()}handleClick(e,t){const{funList:n}=this.props;this.highLightLi(t),n.onClick(e)}render(){const e=this._render.renderFunction("Input"),{input:t,select:n,funList:s}=this.props,{functionList:i}=this.state;if(!!t)return b("div",{className:Tt.functionModal},b("div",{className:Tt.functionSearch},b("div",{className:Tt.functionLabel},t.label),b(e,{placeholder:t.placeholder,onChange:Xr(this.changeInput.bind(this),50)})),b("div",{className:Tt.functionSelect},b("div",{className:Tt.functionLabel},n.label),b("div",{className:Tt.functionSelector},b(hu,{onClick:this.selectType.bind(this),type:0,children:n.children,hideSelectedIcon:!0}))),b("div",{className:Tt.functionList,ref:this.functionListRef},b("div",{className:Tt.functionLabel},s.label),b("ul",{className:Tt.functionLists},i==null?void 0:i.map((o,a)=>b("li",{className:`${Tt.functionListsItem}`,onClick:()=>this.handleClick(o,a)},b("div",{className:Tt.functionListsItemName},o.n),b("div",{className:Tt.functionListsItemDetail},o.d))))))}}class Th extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={modalData:[]}}componentDidMount(){this._context.getPluginManager().getPluginByName(Pt).getObserver("onSearchFormulaModalDidMountObservable").notifyObservers(this)}setModal(e){const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);e.forEach(n=>{var i;const s=t.getRegisterComponent(n.children.name);if(s){const o=(i=n.children.props)!=null?i:{};n.modal=b(s,{...o})}}),this.setState({modalData:e})}render(){const e=this._render.renderFunction("Modal"),{modalData:t}=this.state;return b(yt,null,t.map(n=>{var s;if(!!n.show)return b(e,{isDrag:!0,mask:n.mask,title:(s=n.label)==null?void 0:s.funParams.n,visible:n.show,group:n.group,onCancel:n.onCancel},n.modal)}))}}class $a extends Xe{initialize(){this.state={description:{},rangeList:[],index:0}}componentDidMount(){var s;this._context.getPluginManager().getPluginByName(Pt).getObserver("onSearchItemDidMountObservable").notifyObservers(this);const{funParams:t}=this.props,n=(s=t==null?void 0:t.funParams.p)==null?void 0:s[0];this.setState({description:n})}handleClick(e){var s;const{funParams:t}=this.props,n=(s=t==null?void 0:t.funParams.p)==null?void 0:s[e];this.setState({description:n,index:e})}changeRange(e){const{index:t,rangeList:n}=this.state;n[t]=e,this.setState({rangeList:n})}render(){var o,a,l;const{funParams:e,calc:t,onTableClick:n}=this.props,{description:s,rangeList:i}=this.state;if(!!e)return b("div",{className:Tt.functionParamModal},b("div",{className:Tt.functionParamList},(a=(o=e.funParams)==null?void 0:o.p)==null?void 0:a.map((u,c)=>b("div",null,b("span",null,u.name,"\uFF1A"),b(KS,{onTableClick:n,value:i[c],onClick:()=>this.handleClick(c)}),b("span",null,"=","{}")))),b("div",{className:Tt.functionParamDesc},b("div",{className:Tt.functionParamDescDetail},(l=e.funParams)==null?void 0:l.d),b("div",{className:Tt.functionParamDescDetails},b("p",null,s.name,": ",s.detail))),b("div",{className:Tt.functionParamResult},t,"="))}}class kR{constructor(e){this._plugin=e,this._funParams={funParams:{}},this._modalData=[{name:"SearchFormula",show:!1,group:[{locale:"button.confirm",type:"primary",onClick:this.showSearchItemModal.bind(this)},{locale:"button.cancel"}],onCancel:()=>this.showFormulaModal("SearchFormula",!1),children:{name:Pt+Xa.name,props:{input:{locale:"formula.formulaMore.findFunctionTitle",placeholderLocale:"formula.formulaMore.tipInputFunctionName"},select:{locale:"formula.formulaMore.selectCategory",children:qS},funList:{onClick:this.selectFunParams.bind(this),locale:"formula.formulaMore.selectFunctionTitle",children:JS}}}},{name:"SearchItem",label:this._funParams,show:!1,mask:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showFormulaModal("SearchItem",!1),children:{name:Pt+$a.name,props:{funParams:this._funParams,calcLocale:"formula.formulaMore.calculationResult",range:"A1:B10",onTableClick:()=>this.showCellRangeModal(!0)}}}],this._cellRangeModalData={name:"cellRangeModal",titleLocale:"formula.formulaMore.tipSelectDataRange",show:!1,mask:!1,group:[{locale:"button.confirm",type:"primary"}],onCancel:()=>this.showFormulaModal("cellRangeModal",!1),children:{props:{placeholderLocale:""}}},this._initRegisterComponent(),this._initialize()}_initialize(){var t;this._plugin.getObserver("onSearchFormulaModalDidMountObservable").add(n=>{this._formulaModal=n,this._modalData=this._resetLabel(this._modalData),this._cellRangeModalData=this._resetLabel(this._cellRangeModalData)}),this._plugin.getObserver("onSearchItemDidMountObservable").add(n=>{this._searchItem=n}),(t=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET).getObserver("onChangeSelectionObserver"))==null||t.add(n=>{var i;const s=n.getCurrentCellInfo();this._searchItem.changeRange((i=s==null?void 0:s.startColumn.toString())!=null?i:"")})}_initRegisterComponent(){const e=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET);e.registerModal(Pt+Th.name,Th),e.registerModal(Pt+$a.name,$a),e.registerComponent(Pt+Xa.name,Xa)}_resetLocale(e){const t=this._plugin.context.getLocale();let n="";return e instanceof Array?e.forEach(s=>{s.includes(".")?n+=t.get(s):n+=s}):e.includes(".")?n=t.get(e):n+=e,n}_findLocale(e){for(let t in e)if(t==="locale")e.label=this._resetLocale(e[t]);else if(t.endsWith("Locale")){const n=t.indexOf("Locale");e[t.slice(0,n)]=this._resetLocale(e[t])}else e[t].$$typeof||(Object.prototype.toString.call(e[t])==="[object Object]"?this._findLocale(e[t]):Object.prototype.toString.call(e[t])==="[object Array]"&&this._resetLabel(e[t]));return e}_resetLabel(e){if(e instanceof Array){for(let t=0;t<e.length;t++){let n=e[t];n=this._findLocale(n),n.children&&(n.children=this._resetLabel(n.children))}return e}if(e instanceof Object)return e=this._findLocale(e),e}selectFunParams(e){this._funParams.funParams=e}showFormulaModal(e,t){const n=this._modalData.findIndex(s=>s.name===e);n>-1&&(this._modalData[n].show=t,this._formulaModal.setModal(this._modalData))}showCellRangeModal(e){this._cellRangeModalData.show=e;const t=this._plugin.getPluginByName(Je.SPREADSHEET);(t==null?void 0:t.getModalGroupControl().getModal(Cl.name)).setModal(this._cellRangeModalData),this.showFormulaModal("SearchItem",!1)}showSearchItemModal(){this.showFormulaModal("SearchFormula",!1),this.showFormulaModal("SearchItem",!0)}}const NR=[{n:"SUM",t:0,d:"\u8FD4\u56DE\u4E00\u7EC4\u6570\u503C\u548C/\u6216\u5355\u5143\u683C\u7684\u603B\u548C\u3002",a:"\u8FD4\u56DE\u4E00\u7EC4\u6570\u503C\u548C/\u6216\u5355\u5143\u683C\u7684\u603B\u548C\u3002",m:[1,255],p:[{name:"\u503C1",detail:"\u8981\u76F8\u52A0\u7684\u7B2C\u4E00\u4E2A\u6570\u503C\u6216\u8303\u56F4\u3002",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"\u503C2",detail:"[\u53EF\u9009] - \u8981\u76F8\u52A0\u7684\u5176\u4ED6\u6570\u503C\u6216\u8303\u56F4\u3002",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SUBTOTAL",t:0,d:"\u4F7F\u7528\u6307\u5B9A\u7684\u6C47\u603B\u51FD\u6570\uFF0C\u8FD4\u56DE\u4E00\u7CFB\u5217\u7EB5\u5411\u5355\u5143\u683C\u7684\u5206\u7C7B\u6C47\u603B\u3002",a:"\u4F7F\u7528\u6307\u5B9A\u7684\u6C47\u603B\u51FD\u6570",m:[2,256],p:[{name:"\u51FD\u6570\u4EE3\u7801",detail:`\u7528\u4E8E\u8BA1\u7B97\u5206\u7C7B\u6C47\u603B\u7684\u51FD\u6570\u3002

1\u4EE3\u8868AVERAGE

2\u4EE3\u8868COUNT

3\u4EE3\u8868COUNTA

4\u4EE3\u8868MAX

5\u4EE3\u8868MIN

6\u4EE3\u8868PRODUCT

7\u4EE3\u8868STDEV

8\u4EE3\u8868STDEVP

9\u4EE3\u8868SUM

10\u4EE3\u8868VAR

11\u4EE3\u8868VARP

\u901A\u8FC7\u5728\u8FD9\u4E9B2\u4F4D\u4EE3\u7801\u524D\u9644\u52A010\uFF08\u5BF9\u4E8E1\u4F4D\u4EE3\u7801\uFF09\u62161\uFF08\u5BF9\u4E8E2\u4F4D\u4EE3\u7801\uFF09\uFF0C\u53EF\u4EE5\u5C06\u9690\u85CF\u503C\u5FFD\u7565\u3002\u4F8B\u5982\uFF0C102\u4EE3\u8868\u5FFD\u7565\u9690\u85CF\u5355\u5143\u683C\u7684COUNT\uFF0C\u800C110\u5219\u4EE3\u8868\u5FFD\u7565\u9690\u85CF\u503C\u7684VAR\u3002`,example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"\u8303\u56F41",detail:"\u8981\u8BA1\u7B97\u5206\u7C7B\u6C47\u603B\u7684\u7B2C\u4E00\u4E2A\u8303\u56F4\u3002",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"\u8303\u56F42",detail:"[\u53EF\u9009] - \u8981\u8BA1\u7B97\u5206\u7C7B\u6C47\u603B\u7684\u5176\u4ED6\u8303\u56F4\u3002",example:"B2:B8",require:"o",repeat:"y",type:"range"}]}],MR=[{n:"SUM",t:0,d:"Returns the sum of a series of numbers and/or cells.",a:"Sum of a series of numbers and/or cells.",m:[1,255],p:[{name:"value1",detail:"The first number or range to add together.",example:"A2:A100",require:"m",repeat:"n",type:"rangeAll"},{name:"value2",detail:"Additional numbers or ranges to add to `value1`.",example:"2",require:"o",repeat:"y",type:"rangeAll"}]},{n:"SUBTOTAL",t:0,d:"Returns a subtotal for a vertical range of cells using a specified aggregation function.",a:"Subtotal for a range using a specific function.",m:[2,256],p:[{name:"function_code",detail:"The function to use in subtotal aggregation.",example:"1",require:"m",repeat:"n",type:"rangeNumber"},{name:"range1",detail:"The first range over which to calculate a subtotal.",example:"A2:A5",require:"m",repeat:"n",type:"range"},{name:"range2",detail:"Additional ranges over which to calculate subtotals.",example:"B2:B8",require:"o",repeat:"y",type:"range"}]}],Mi={zh:NR,en:MR},FR="univer-search-function",BR="univer-formula-detail",LR="univer-search-function-active",PR="univer-help-function",HR="univer-help-function-title",UR="univer-help-function-content",zR="univer-help-function-content-params",WR="univer-help-function-content-title",VR="univer-help-function-content-detail",GR="univer-help-function-active";var mn={searchFunction:FR,formulaDetail:BR,searchFunctionActive:LR,helpFunction:PR,helpFunctionTitle:HR,helpFunctionContent:UR,helpFunctionContentParams:zR,helpFunctionContentTitle:WR,helpFunctionContentDetail:VR,helpFunctionActive:GR};class yh extends Xe{initialize(){this.state={activeIndex:0,lang:"",locale:[],formula:[],functionInfo:null,helpFormulaActive:!1,position:{left:0,top:0}}}componentWillMount(){this.setLocale()}componentDidMount(){this._context.getPluginManager().getPluginByName(Pt).getObserver("onHelpFunctionDidMountObservable").notifyObservers(this)}updateState(e,t=0,n="",s={left:0,top:0}){const i=this.state.formula.find(o=>o.n===n)||{};this.setState({helpFormulaActive:e,functionInfo:i,activeIndex:t,position:s})}getState(){return this.state}setLocale(){const e=this._context.getLocale().options.currentLocale;this.setState({lang:e,formula:Mi[`${e}`],functionInfo:Mi[`${e}`][0]})}render(e,t){const{activeIndex:n,functionInfo:s,helpFormulaActive:i,position:o}=t;return b("div",{className:mn.helpFunction,style:{display:i?"block":"none",position:"absolute",left:`${o.left}px`,top:`${o.top}px`}},b("div",{class:mn.helpFunctionTitle},b(Ah,{title:s.n,value:s.p,type:"name",active:n})),b("div",{className:mn.helpFunctionContent},b("div",null,"\u793A\u4F8B"),b(Ah,{title:s.n,value:s.p,type:"example",active:n}),b(Sh,{title:"\u6458\u8981",value:s.d}),b(yt,null,s&&s.p&&s.p.map((a,l)=>b(Sh,{className:n===l?mn.helpFunctionActive:"",title:a.name,value:a.detail,active:n})))))}}const Sh=r=>b("div",{className:`${mn.helpFunctionContentParams} ${r.className}`},b("div",{className:mn.helpFunctionContentTitle},r.title),b("div",{className:mn.helpFunctionContentDetail},r.value)),Ah=r=>b("div",null,b("span",null,r.title,"("),r.value&&r.value.map((e,t)=>b("span",{className:r.active===t?mn.helpFunctionActive:""},e[`${r.type}`],",")),b("span",null,")"));class Rh extends Xe{initialize(){this.state={lang:"",locale:[],formulaValue:"",functionList:[],selectIndex:0,formula:[],searchActive:!1,position:{left:0,top:0}}}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentDidMount(){this.setState({functionList:this.state.locale}),this._context.getPluginManager().getPluginByName(Pt).getObserver("onSearchFunctionDidMountObservable").notifyObservers(this)}componentWillUpdate(e){}setLocale(){const e=this._context.getLocale().options.currentLocale;this.setState({lang:e,locale:Mi[`${e}`]})}onKeyDown(e){}updateState(e,t=[],n=0,s={left:0,top:0}){this.setState({searchActive:e,formula:t,selectIndex:n,position:s})}getState(){return this.state}render(e,t){const{selectIndex:n,formula:s,searchActive:i,position:o}=t;return b("ul",{className:mn.searchFunction,onKeyDown:this.onKeyDown.bind(this),style:{display:i?"block":"none",position:"absolute",left:`${o.left}px`,top:`${o.top}px`}},s.map((a,l)=>b("li",{className:n===l?mn.searchFunctionActive:""},b("div",{className:mn.formulaName},a.n),b("div",{className:mn.formulaDetail},a.a))))}}const XR=["#c1232b","#27727b","#fcce10","#e87c25","#b5c334","#fe8463","#9bca63","#fad860","#f3a43b","#60c0dd","#d7504b","#c6e579","#f4e001","#f0805a","#26c0c0","#c12e34","#e6b600","#0098d9","#2b821d","#005eaa","#339ca8","#cda819","#32a487","#3fb1e3","#6be6c1","#626c91","#a0a7e6","#c4ebad","#96dee8"];class $R{constructor(e){this.functionHTMLIndex=0,this.functionRangeIndex=[],this.operator="===|!==|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",this.operatorjson=this.covertOperatorjson(),this.rangestart=!1,this.rangedrag_column_start=!1,this.rangedrag_row_start=!1,this.functionlistPosition={},this.editor=e}covertOperatorjson(){let e=this.operator.split("|"),t={};for(let n=0;n<e.length;n++)t[e[n].toString()]=1;return t}getFormula(){return this.formula||[]}getInputValue(){return this.editor.innerHTML}setInputValue(e){this.editor.innerHTML=fl(e)}getHelpFormula(){return[this.funcName,this.paramindex]}getFunctionlistPosition(){return this.functionlistPosition}functionInputHandler(e,t){let n=this,s=e,i=s.innerHTML,o=s.textContent||"";setTimeout(()=>{var l,u;let a=s.textContent||"";if(a=fl(a),n.funcName=null,a.length>0&&a.substr(0,1)==="="&&(t!==229||a.length===1)){a=n.functionHTMLGenerate(a),i=n.functionHTMLGenerate(o);let c=window.getSelection();if(c)if((c==null?void 0:c.anchorNode)instanceof HTMLElement&&((l=c.anchorNode)==null?void 0:l.matches("div"))){let f=Rr("span",s).length;n.functionRangeIndex=[f-1,Rr("span",s)[f-1].textContent.length]}else n.functionRangeIndex=[m_((u=c.anchorNode)==null?void 0:u.parentNode),c.anchorOffset];else{let f=document.selection.createRange();n.functionRangeIndex=f}s.innerHTML=a,n.functionRange(s,a,i),n.canceFunctionrangeSelected(),n.rangestart=!1,n.rangedrag_column_start=!1,n.rangedrag_row_start=!1;const h=n.getrangeseleciton();n.helpFunctionExe(s,h)}else o.substr(0,1)},1)}findrangeindex(e,t){let n=this,s=/<span.*?>/g,i=e.replace(s,""),o=t.replace(s,""),a=i.split("</span>"),l=o.split("</span>");a.pop(),l.pop();let u=n.functionRangeIndex;l.length>a.length?a.length:l.length;let c=l.length,h=a.length;if(c===h){let f=u[0],d=l[f],m=a[f];if(d==null)return l.length<=f?u=[l.length-1,l.length-1]:a.length<=f&&(u=[a.length-1,a.length-1]),u;if(d.length===m.length)return l[f+1]!=null&&a[f+1]!=null&&l[f+1].length<a[f+1].length&&(u[0]+=1,u[1]=1),u;if(d.length>m.length)return d!=null&&a[f+1]!=null&&a[f+1].substr(0,1)==='"'&&(d.indexOf("{")>-1||d.indexOf("}")>-1)&&(u[0]+=1,u[1]=1),u;if(d.length<m.length)return u[1]>m.length&&(u[1]=m.length),u}else if(c>h){let f=u[0],d=l[f],m=a[f];if(m==null)if(a[f-1].indexOf("{")>-1){u[0]-=1;let g=a[f-1].search("{");u[1]+=g}else u[0]=0,u[1]=0;else{if(d.length===m.length)return a[f+1]!=null&&(a[f+1].substr(0,1)==='"'||a[f+1].substr(0,1)==="{"||a[f+1].substr(0,1)==="}")?(u[0]+=1,u[1]=1):d!=null&&d.length>2&&d.substr(0,1)==='"'&&d.substr(d.length-1,1)==='"'||(a[f]!=null&&a[f]==='")'||a[f]!=null&&a[f]==='"}'||a[f]!=null&&a[f]==="{)"?u[1]=1:u[1]=m.length),u;if(d.length>m.length)return a[f+1]!=null&&(a[f+1].substr(0,1)==='"'||a[f+1].substr(0,1)==="{"||a[f+1].substr(0,1)==="}")&&(u[0]+=1,u[1]=1),u;if(d.length<m.length)return u}return u}else if(c<h){let f=u[0],d=l[f],m=a[f];if(d==null)u[0]=a.length-1,m!=null?u[1]=m.length:u[1]=1;else{if(d.length===m.length)return l[f+1]!=null&&(l[f+1].substr(0,1)==='"'||l[f+1].substr(0,1)==="{"||l[f+1].substr(0,1)==="}")?u[1]=m.length:a[f+1]!=null&&a[f+1].substr(0,1)==='"'&&(a[f+1].substr(0,1)==="{"||a[f+1].substr(0,1)==="}")?(u[0]+=1,u[1]=1):m!=null&&m.substr(0,1)==='"'&&m.substr(m.length-1,1)==='"'&&d.substr(0,1)==='"'&&d.substr(d.length-1,1)===")"||m!=null&&m.substr(0,1)==="{"&&m.substr(m.length-1,1)==="}"&&d.substr(0,1)==="{"&&d.substr(d.length-1,1)===")"?u[1]=m.length:(u[0]=u[0]+h-c,a.length>l.length?u[1]=a[f+1].length:u[1]=1),u;if(d.length>m.length)return d!=null&&d.substr(0,1)==='"'?u[1]=m.length:a[f+1]!=null&&/{.*?}/.test(a[f+1])?(u[0]+=1,u[1]=a[f+1].length):d!=null&&a[f+1].substr(0,1)==='"'&&(d.indexOf("{")>-1||d.indexOf("}")>-1)?(u[0]+=1,u[1]=1):(u[0]=u[0]+h-c-1,u[1]=a[f-1].length),u;if(d.length<m.length)return u}return u}return null}setCaretPosition(e,t,n){try{let s=e,i=document.createRange(),o=window.getSelection();i.setStart(s.childNodes[t],n),i.collapse(!0),o==null||o.removeAllRanges(),o==null||o.addRange(i),s.focus()}catch{}}functionRange(e,t,n){let s=this,i=window.getSelection(),o=s.findrangeindex(t,n);if(o==null&&i)i.selectAllChildren(e[0]),i.collapseToEnd();else if(o!=null){let a=Rr("span",e);s.setCaretPosition(Array.isArray(a)?a[o[0]]:a,0,o[1])}}functionHTMLGenerate(e){let t=this;return e.length===0||e.substr(0,1)!=="="?e:(t.functionHTMLIndex=0,`<span dir="auto" class="universheet-formula-text-color">=</span>${t.functionHTML(e)}`)}functionHTML(e){let t=this;if(t.operatorjson==null){let l=t.operator.split("|"),u={};for(let c=0;c<l.length;c++)u[l[c].toString()]=1;t.operatorjson=u}e.substr(0,1)==="="&&(e=e.substr(1));let n=e.split(""),s=0,i="",o="",a={bracket:0,comma:0,squote:0,dquote:0,braces:0};for(;s<n.length;){let l=n[s];if(l==="("&&a.squote===0&&a.dquote===0&&a.braces===0)a.bracket+=1,i.length>0?o+=`<span dir="auto" class="universheet-formula-text-func">${i}</span><span dir="auto" class="universheet-formula-text-lpar">(</span>`:o+='<span dir="auto" class="universheet-formula-text-lpar">(</span>',i="";else if(l===")"&&a.squote===0&&a.dquote===0&&a.braces===0)a.bracket-=1,o+=`${t.functionHTML(i)}<span dir="auto" class="universheet-formula-text-rpar">)</span>`,i="";else if(l==="{"&&a.squote===0&&a.dquote===0)i+="{",a.braces+=1;else if(l==="}"&&a.squote===0&&a.dquote===0)i+="}",a.braces-=1;else if(l==='"'&&a.squote===0)a.dquote>0?(i.length>0?o+=`${i}"</span>`:o+='"</span>',a.dquote-=1,i=""):(a.dquote+=1,i.length>0?o+=`${t.functionHTML(i)}<span dir="auto" class="universheet-formula-text-string">"`:o+='<span dir="auto" class="universheet-formula-text-string">"',i="");else if(l==="'"&&a.dquote===0)i+="'",a.squote=a.squote===0?1:0;else if(l===","&&a.squote===0&&a.dquote===0&&a.braces===0)o+=`${t.functionHTML(i)}<span dir="auto" class="universheet-formula-text-comma">,</span>`,i="";else if(l==="&"&&a.squote===0&&a.dquote===0&&a.braces===0)i.length>0?(o+=`${t.functionHTML(i)}<span dir="auto" class="universheet-formula-text-calc">&</span>`,i=""):o+='<span dir="auto" class="universheet-formula-text-calc">&</span>';else if(l in t.operatorjson&&a.squote===0&&a.dquote===0&&a.braces===0){let u="";s+1<n.length&&(u=n[s+1]);let c=s-1,h=null;if(c>=0)do h=n[c--];while(c>=0&&h===" ");l+u in t.operatorjson?(i.length>0?(o+=`${t.functionHTML(i)}<span dir="auto" class="universheet-formula-text-calc">${l}${u}</span>`,i=""):o+=`<span dir="auto" class="universheet-formula-text-calc">${l}${u}</span>`,s++):!/[^0-9]/.test(u)&&l==="-"&&(h==="("||h==null||h===","||h===" "||h in t.operatorjson)?i+=l:i.length>0?(o+=`${t.functionHTML(i)}<span dir="auto" class="universheet-formula-text-calc">${l}</span>`,i=""):o+=`<span dir="auto" class="universheet-formula-text-calc">${l}</span>`}else i+=l;if(s===n.length-1){if(t.iscelldata(i.trim()))o+=`<span class="universheet-formula-functionrange-cell" rangeindex="${t.functionHTMLIndex}" dir="auto" style="color:${XR[t.functionHTMLIndex]};">${i}</span>`,t.functionHTMLIndex++;else if(a.dquote>0)o+=`${i}</span>`;else if(i.indexOf("</span>")===-1&&i.length>0){let u=/{.*?}/;if(u.test(i.trim())){let c=u.exec(i)[0],h=i.search(u),f="";h>0&&(f+=`<span dir="auto" class="universheet-formula-text-color">${i.substr(0,h)}</span>`),f+=`<span dir="auto" style="color:#959a05" class="universheet-formula-text-array">${c}</span>`,h+c.length<i.length&&(f+=`<span dir="auto" class="universheet-formula-text-color">${i.substr(h+c.length,i.length)}</span>`),o+=f}else o+=`<span dir="auto" class="universheet-formula-text-color">${i}</span>`}}s++}return o}canceFunctionrangeSelected(){}iscelldata(e){let t=e.split("!"),n;t.length>1?n=t[1]:n=t[0];let s=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,i=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(n.indexOf(":")===-1){let l=parseInt(n.replace(/[^0-9]/g,""))-1,u=G.ABCatNum(n.replace(/[^A-Za-z]/g,""));return!Number.isNaN(l)&&!Number.isNaN(u)&&n.toString().match(s)?!0:(!Number.isNaN(l)||!Number.isNaN(u),!1)}i=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,n=n.split(":");let o=[],a=[];return o[0]=parseInt(n[0].replace(/[^0-9]/g,""))-1,o[1]=parseInt(n[1].replace(/[^0-9]/g,""))-1,o[0]>o[1]||(a[0]=G.ABCatNum(n[0].replace(/[^A-Za-z]/g,"")),a[1]=G.ABCatNum(n[1].replace(/[^A-Za-z]/g,"")),a[0]>a[1])?!1:!!(n[0].toString().match(i)&&n[1].toString().match(i))}getrangeseleciton(){var i,o,a;let e=window.getSelection(),t=e.anchorNode,n=e.anchorOffset,s=t==null?void 0:t.parentElement.querySelectorAll("span");if(((i=t==null?void 0:t.parentNode)==null?void 0:i.nodeName)==="SPAN"&&n!==0){let l=t.textContent.trim();if(l.length===0&&t.parentNode.previousSibling){let u=t.parentNode.previousSibling;return l=u.textContent.trim(),l.substring(l.length-1,1),u}return l.substring(n-1,1),t.parentNode}if(((o=t==null?void 0:t.parentElement)==null?void 0:o.className)==="universheet-rich-text-editor"){let l=(a=t.textContent)==null?void 0:a.trim();if(l.length===0&&t.parentElement.querySelectorAll("span").length>1){let u=t==null?void 0:t.parentElement.querySelectorAll("span");const c=u[`${u.length-2}`].textContent;return l=c&&c.trim()||"",u[s.length-1]}return t.parentElement.querySelectorAll("span")[s.length-1]}return null}searchFunction(e){let t=this;const n="zh";this.formula=[];let s=Mi[`${n}`],i=t.getrangeseleciton();if(t.searchFunctionCell=i,i==null||e==null)return;let o=e.innerText,a=i.textContent.toUpperCase();if(!/^[a-zA-Z]|[a-zA-Z_]+$/.test(a)||o.substr(0,1)!=="=")return;let u={f:[],s:[],t:[]},c=0;for(let f=0;f<s.length;f++){let d=s[f],m=d.n;if(m===a?(u.f.unshift(d),c++):m.substr(0,a.length)===a?(u.s.unshift(d),c++):m.indexOf(a)>-1&&(u.t.unshift(d),c++),c>=10)break}let h=u.t.concat(u.s.concat(u.f));this.formula=h}helpFunctionExe(e,t){let n=this,i=Mi["zh"];if(document.querySelectorAll("#universheet-formula-help-c").length===0)for(let f=0;f<i.length;f++)n.functionlistPosition[i[f].n]=f;if(!t)return;let o=t,a=e.querySelectorAll("span"),l=[].indexOf.call(t.parentNode.querySelectorAll(t.tagName),t),u=l;if(o==null)return;let c=null,h=null;if(a[`${u}`].className==="universheet-rich-text-editor")c=a[`${u}`].textContent;else{let f=null,d=[-1,-1];for(;--u>0;)if(f=a[`${u}`],f.className==="universheet-formula-text-func"||f.textContent.trim().toUpperCase()in n.functionlistPosition){c=f.textContent,h=null;let m=!0;for(let g=u;g<=l;g++)if(h||(h=0),!(g>=d[0]&&g<=d[1])){if(f=a[`${g}`],f.className==="universheet-formula-text-rpar"){d=[u,g],c=null,m=!1;break}f.className==="universheet-formula-text-comma"&&h++}if(m)break}}c!=null&&(this.funcName=c,this.paramindex=h)}searchFunctionEnter(e){let t=this,n=e,s=t.searchFunctionCell;s.innerText=n;const i=document.createElement("span");i.dir="auto",i.className="universheet-formula-text-color",i.innerText="(",YR(i,s),t.setCaretPosition(i,0,1)}}function YR(r,e){let t=e.parentNode;t.lastChild===e?t.appendChild(r):t.insertBefore(r,e.nextSibling)}class jR{constructor(e){this._plugin=e,this._context=this._plugin.getContext(),this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET),this._initialize(),this._initRegisterComponent()}_initRegisterComponent(){this._sheetPlugin.registerModal(Pt+Rh.name,Rh),this._sheetPlugin.registerModal(Pt+yh.name,yh)}_initialize(){var e,t,n;(e=this._sheetPlugin.getObserver("onRichTextDidMountObservable"))==null||e.add(s=>{this.richTextEle=Ai(s.container),this.richTextEditEle=Rr("div",this.richTextEle),this.cellInputHandler=new $R(this.richTextEditEle)}),(t=this._sheetPlugin.getObserver("onRichTextKeyDownObservable"))==null||t.add(s=>{s.ctrlKey,s.altKey,s.shiftKey;let i=s.keyCode;(!(i>=112&&i<=123||i<=46||i===144||i===108||s.ctrlKey||s.altKey||s.shiftKey&&(i===37||i===38||i===39||i===40||i===fr.WIN||i===fr.WIN_R||i===fr.MENU))||i===8||i===32||i===46||s.ctrlKey&&i===86)&&this.cellInputHandler.functionInputHandler(this.richTextEditEle,i)}),(n=this._sheetPlugin.getObserver("onRichTextKeyUpObservable"))==null||n.add(s=>{let i=s.keyCode;if(i===fr.ENTER)this._searchFunction.updateState(!1),this._helpFunction.updateState(!1);else if(!(i>=112&&i<=123||i<=46||i===144||i===108||s.ctrlKey||s.altKey||s.shiftKey&&(i===37||i===38||i===39||i===40||i===fr.WIN||i===fr.WIN_R||i===fr.MENU))||i===8||i===32||i===46||s.ctrlKey&&i===86){this.cellInputHandler.searchFunction(this.richTextEditEle);const a=this.cellInputHandler.getFormula();let l=this.cellInputHandler.getHelpFormula();const u=parseInt(this.richTextEle.style.left),c=parseInt(this.richTextEle.style.top)+parseInt(this.richTextEle.style.minHeight),h={left:u,top:c};a[0]?(this._searchFunction.updateState(!0,a,0,h),this._helpFunction.updateState(!1)):l[0]?(this._helpFunction.updateState(!0,l[1],l[0].toUpperCase(),h),this._searchFunction.updateState(!1)):(this._searchFunction.updateState(!1,a),this._helpFunction.updateState(!1))}const o=this.cellInputHandler.getInputValue();if(o.length>0&&o.substr(0,1)==="="&&(i!==229||o.length===1)&&i===13){s.preventDefault(),s.stopPropagation();const a=this._searchFunction.getState();if(a.searchActive){const l=a.formula[a.selectIndex];this.cellInputHandler.searchFunctionEnter(l.n)}}}),this._plugin.getObserver("onSearchFunctionDidMountObservable").add(s=>{this._searchFunction=s,console.log("get search function",s)}),this._plugin.getObserver("onHelpFunctionDidMountObservable").add(s=>{this._helpFunction=s,console.log("get help function",s)})}}class Au extends or{constructor(e){super(Pt),this._config=e}static create(e){return new Au(e)}installTo(e){e.installPlugin(this);let n=this.getContext().getPluginManager().getPluginByName("formulaEngine");n||(n=new Su,e.installPlugin(n)),this._formulaController=new aR(this,this._config),this._searchFormulaController=new kR(this),this._formulaPromptController=new jR(this),this._formulaController.setFormulaEngine(n),lR(this._formulaController)}initialize(e){this.context=e,this.getContext().getLocale().load({en:iR,zh:sR}),this.registerExtension()}onMapping(e){}onMounted(e){mR(this),this.initialize(e)}onDestroy(){this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._formulaActionExtensionFactory)}registerExtension(){Rs.create().add(new cR(this)),Ds.create().add(new dR(this));const n=this.context.getCommandManager().getActionExtensionManager().getRegister();this._formulaActionExtensionFactory=new gR(this),n.add(this._formulaActionExtensionFactory)}getFormulaEngine(){return this._formulaController.getFormulaEngine()}getFormulaController(){return this._formulaController}getSearchFormulaController(){return this._searchFormulaController}getFormulaPromptController(){return this._formulaPromptController}}var da=(r=>(r.SET_NUMFMT_RANGE_DATA_ACTION="SetNumfmtRangeDataAction",r))(da||{});const KR=[{locale:"defaultFmt.Automatic.text",selected:!0},{locale:"defaultFmt.PlainText.text",border:!0},{locale:"defaultFmt.Number.text",suffixLocale:"defaultFmt.Number.example"},{locale:"defaultFmt.Percent.text",suffixLocale:"defaultFmt.Percent.example"},{locale:"defaultFmt.Scientific.text",suffixLocale:"defaultFmt.Scientific.example",border:!0},{locale:"defaultFmt.Accounting.text",suffixLocale:"defaultFmt.Accounting.example"},{locale:"defaultFmt.Thousand.text",suffixLocale:"defaultFmt.Thousand.example"},{locale:"defaultFmt.Currency.text",suffixLocale:"defaultFmt.Currency.example"},{locale:"defaultFmt.Digit.text",suffixLocale:"defaultFmt.Digit.example",border:!0},{locale:"defaultFmt.Date.text",suffixLocale:"defaultFmt.Date.example"},{locale:"defaultFmt.Time.text",suffixLocale:"defaultFmt.Time.example"},{locale:"defaultFmt.Time24H.text",suffixLocale:"defaultFmt.Time24H.example"},{locale:"defaultFmt.DateTime.text",suffixLocale:"defaultFmt.DateTime.example"},{locale:"defaultFmt.DateTime24H.text",suffixLocale:"defaultFmt.DateTime.example"}],ZR=[{locale:"currencyDetail.RMB",suffix:"\xA5"},{locale:"currencyDetail.USdollar",suffix:"$"},{locale:"currencyDetail.EUR",suffix:"\u20AC"},{locale:"currencyDetail.GBP",suffix:"\uFFE1"},{locale:"currencyDetail.HK",suffix:"$"},{locale:"currencyDetail.JPY",suffix:"\uFFE5"},{locale:"currencyDetail.AlbanianLek",suffix:"Lek"},{locale:"currencyDetail.AlgerianDinar",suffix:"din"},{locale:"currencyDetail.Afghani",suffix:"Af"},{locale:"currencyDetail.ArgentinePeso",suffix:"$"},{locale:"currencyDetail.UnitedArabEmiratesDirham",suffix:"dh"},{locale:"currencyDetail.ArubanFlorin",suffix:"Afl"},{locale:"currencyDetail.OmaniRial",suffix:"Rial"},{locale:"currencyDetail.Azerbaijanimanat",suffix:"?"},{locale:"currencyDetail.EgyptianPound",suffix:"\uFFE1"},{locale:"currencyDetail.EthiopianBirr",suffix:"Birr"},{locale:"currencyDetail.AngolaKwanza",suffix:"Birr"}],qR=[{label:"1930-08-05",suffix:"yyyy-MM-dd"},{label:"1930/08/05",suffix:"yyyy/MM/dd"},{label:"1930\u5E7408\u670805\u65E5",suffix:'yyyy"\u5E74"MM"\u6708"dd"\u65E5"'},{label:"08-05",suffix:"MM-dd"},{label:"8\u67085\u65E5",suffix:'M"\u6708"d"\u65E5"'},{label:"13:30:30",suffix:"h:mm:ss"},{label:"13:30",suffix:"h:mm"},{label:"\u4E0B\u534801:30",suffix:"\u4E0A\u5348/\u4E0B\u5348 hh:mm"},{label:"\u4E0B\u53481:30",suffix:"\u4E0A\u5348/\u4E0B\u5348 h:mm"},{label:"\u4E0B\u53481:30:30",suffix:"\u4E0A\u5348/\u4E0B\u5348 h:mm:ss"},{label:"08-05 \u4E0B\u5348 01:30",suffix:"MM-dd \u4E0A\u5348/\u4E0B\u5348 hh:mm"}],JR=[{label:"1235",suffix:"0"},{label:"1234.56",suffix:"0.00"},{label:"12345",suffix:"#,##0"},{label:"1,234.56",suffix:"#,##0.00"},{label:"1,235",suffix:"#,##0_);(#,##0)"},{label:"1,235",suffix:"#,##0_);[Red](#,##0)"},{label:"1,234.56",suffix:"#,##0.00_);(#,##0.00)"},{label:"1,234.56",suffix:"#,##0.00_);[Red](#,##0.00)"},{label:"$1,235",suffix:"$#,##0_);($#,##0)"},{label:"$1,235",suffix:"$#,##0_);[Red]($#,##0)"}],tr="NUMFMT_PLUGIN_NAME",QR={show:!0};function Dh(r,e,t){const o=r.getContext().getPluginManager().getPluginByName(tr).getNumfmtBySheetIdConfig(e),a=new pe(o),l=new pe;return new pe(t).forValue((u,c,h)=>{const f=a.getValue(u,c);a.setValue(u,c,h),l.setValue(u,c,f)}),l.toJSON()}class eD extends Qe{constructor(e,t,n){super(e,t,n),this._doActionData={...e},this._oldActionData={...e,numfmtMatrix:this.do()}}do(){return this.redo()}redo(){return Dh(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.numfmtMatrix)}undo(){Dh(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.numfmtMatrix)}validate(){return!1}}Be.register(da.SET_NUMFMT_RANGE_DATA_ACTION,eD);function tD(r){r.pushToObserve("onNumfmtModalDidMountObservable")}const Do={1078:"af",1052:"sq",1118:"am",5121:"ar_DZ",15361:"ar_BH",3073:"ar_EG",2049:"ar_IQ",11265:"ar_JO",13313:"ar_KW",12289:"ar_LB",4097:"ar_LY",6145:"ar_MA",8193:"ar_OM",16385:"ar_QA",1025:"ar_SA",10241:"ar_SY",7169:"ar_TN",14337:"ar_AE",9217:"ar_YE",1067:"hy",1101:"as",2092:"az_AZ",1068:"az_AZ",1069:"eu",1059:"be",2117:"bn",1093:"bn_IN",5146:"bs",1026:"bg",1109:"my",1027:"ca",2052:"zh_CN",3076:"zh_HK",5124:"zh_MO",4100:"zh_SG",1028:"zh_TW",1050:"hr",1029:"cs",1030:"da",1125:"dv",2067:"nl_BE",1043:"nl_NL",1126:"bin",3081:"en_AU",10249:"en_BZ",4105:"en_CA",9225:"en_CB",2057:"en_GB",16393:"en_IN",6153:"en_IE",8201:"en_JM",5129:"en_NZ",13321:"en_PH",7177:"en_ZA",11273:"en_TT",1033:"en_US",12297:"en_ZW",1061:"et",1071:"mk",1080:"fo",1065:"fa",1124:"fil",1035:"fi",2060:"fr_BE",11276:"fr_CM",3084:"fr_CA",9228:"fr_CG",12300:"fr_CI",1036:"fr_FR",5132:"fr_LU",13324:"fr_ML",6156:"fr_MC",14348:"fr_MA",10252:"fr_SN",4108:"fr_CH",7180:"fr",1122:"fy_NL",2108:"gd_IE",1084:"gd",1110:"gl",1079:"ka",3079:"de_AT",1031:"de_DE",5127:"de_LI",4103:"de_LU",2055:"de_CH",1032:"el",1140:"gn",1095:"gu",1279:"en",1037:"he",1081:"hi",1038:"hu",1039:"is",1136:"ig_NG",1057:"id",1040:"it_IT",2064:"it_CH",1041:"ja",1099:"kn",1120:"ks",1087:"kk",1107:"km",1111:"kok",1042:"ko",1088:"ky",1108:"lo",1142:"la",1062:"lv",1063:"lt",2110:"ms_BN",1086:"ms_MY",1100:"ml",1082:"mt",1112:"mni",1153:"mi",1102:"mr",1104:"mn",2128:"mn",1121:"ne",1044:"no_NO",2068:"no_NO",1096:"or",1045:"pl",1046:"pt_BR",2070:"pt_PT",1094:"pa",1047:"rm",2072:"ro_MO",1048:"ro_RO",1049:"ru",2073:"ru_MO",1083:"se",1103:"sa",3098:"sr_SP",2074:"sr_SP",1072:"st",1074:"tn",1113:"sd",1115:"si",1051:"sk",1060:"sl",1143:"so",1070:"sb",11274:"es_AR",16394:"es_BO",13322:"es_CL",9226:"es_CO",5130:"es_CR",7178:"es_DO",12298:"es_EC",17418:"es_SV",4106:"es_GT",18442:"es_HN",2058:"es_MX",19466:"es_NI",6154:"es_PA",15370:"es_PY",10250:"es_PE",20490:"es_PR",1034:"es_ES",14346:"es_UY",8202:"es_VE",1089:"sw",2077:"sv_FI",1053:"sv_SE",1114:"syc",1064:"tg",1097:"ta",1092:"tt",1098:"te",1054:"th",1105:"bo",1073:"ts",1055:"tr",1090:"tk",1058:"uk",1056:"ur",2115:"uz_UZ",1091:"uz_UZ",1075:"ve",1066:"vi",1106:"cy",1076:"xh",1085:"yi",1077:"zu"},nD=1e-10;function n6(r,e,t){const n=r<0?-1:1,s=10**(e||2),i=10**(t||2);let o=Math.abs(r),a=0,l=0,u=0,c=1,h,f;if(r=o,r%1===0)f=[r*n,1];else if(r<1e-19)f=[n,1e19];else if(r>1e19)f=[1e19*n,1];else{do if(o=1/(o-Math.floor(o)),h=c,c=c*Math.floor(o)+a,a=h,l=u,u=Math.floor(r*c+.5),u>=s||c>=i)return[n*l,a];while(Math.abs(r-u/c)>=nD&&o!==Math.floor(o));f=[n*u,c]}return f}const r6=/^([a-z\d]+)(?:[_-]([a-z\d]+))?(?:\.([a-z\d]+))?(?:@([a-z\d]+))?$/i,s6={positive:"+",decimal:".",negative:"-",percent:"%",isDefault:!1,nan:"NaN",exponent:"E",group:" ",infinity:"\u221E",colors:["black","blue","cyan","green","magenta","red","white","yellow"],ampm:["AM","PM"],mmm:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],mmmm:["January","February","March","April","May","June","July","August","September","October","November","December"],mmm6:["Muh.","Saf.","Rab. I","Rab. II","Jum. I","Jum. II","Raj.","Sha.","Ram.","Shaw.","Dhu\u02BBl-Q.","Dhu\u02BBl-H."],mmmm6:["Muharram","Safar","Rabi\u02BB I","Rabi\u02BB II","Jumada I","Jumada II","Rajab","Sha\u02BBban","Ramadan","Shawwal","Dhu\u02BBl-Qi\u02BBdah","Dhu\u02BBl-Hijjah"],ddd:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],dddd:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},Es=s6;function Tl(r){return{...s6,...r}}function Ru(r){if(typeof r=="number")return Do[r&65535]||null;const e=parseInt(r,16);return isFinite(e)&&Do[e&65535]?Do[e&65535]||null:r6.test(r)?r:null}function fa(r){const e=r6.exec(r);if(!e)throw new SyntaxError(`Malformed locale: ${r}`);return{lang:e[1]+(e[2]?`_${e[2]}`:""),language:e[1],territory:e[2]||"",codeset:e[3]||"",modifier:e[4]||""}}function i6(r){const e=Ru(r);let t=null;if(e){const n=fa(e);t=Es[n.lang]||Es[n.language]||null}return t}function dt(r,e){const t=typeof e=="object"?e:fa(e);return Es[t.lang]=Tl(r),t.language!==t.lang&&!Es[t.language]&&(Es[t.language]=Tl(r)),Es[t.lang]}const Du=Tl({group:","});Du.isDefault=!0;dt({group:",",ampm:["\u4E0A\u5348","\u4E0B\u5348"],mmmm:["\u4E00\u6708","\u4E8C\u6708","\u4E09\u6708","\u56DB\u6708","\u4E94\u6708","\u516D\u6708","\u4E03\u6708","\u516B\u6708","\u4E5D\u6708","\u5341\u6708","\u5341\u4E00\u6708","\u5341\u4E8C\u6708"],mmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dddd:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],ddd:["\u5468\u65E5","\u5468\u4E00","\u5468\u4E8C","\u5468\u4E09","\u5468\u56DB","\u5468\u4E94","\u5468\u516D"]},"zh_CN");dt({group:",",nan:"\u975E\u6578\u503C",ampm:["\u4E0A\u5348","\u4E0B\u5348"],mmmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],mmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dddd:["\u661F\u671F\u65E5","\u661F\u671F\u4E00","\u661F\u671F\u4E8C","\u661F\u671F\u4E09","\u661F\u671F\u56DB","\u661F\u671F\u4E94","\u661F\u671F\u516D"],ddd:["\u9031\u65E5","\u9031\u4E00","\u9031\u4E8C","\u9031\u4E09","\u9031\u56DB","\u9031\u4E94","\u9031\u516D"]},"zh_TW");dt({group:",",ampm:["\u5348\u524D","\u5348\u5F8C"],mmmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],mmm:["1\u6708","2\u6708","3\u6708","4\u6708","5\u6708","6\u6708","7\u6708","8\u6708","9\u6708","10\u6708","11\u6708","12\u6708"],dddd:["\u65E5\u66DC\u65E5","\u6708\u66DC\u65E5","\u706B\u66DC\u65E5","\u6C34\u66DC\u65E5","\u6728\u66DC\u65E5","\u91D1\u66DC\u65E5","\u571F\u66DC\u65E5"],ddd:["\u65E5","\u6708","\u706B","\u6C34","\u6728","\u91D1","\u571F"]},"ja");dt({group:",",ampm:["\uC624\uC804","\uC624\uD6C4"],mmmm:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],mmm:["1\uC6D4","2\uC6D4","3\uC6D4","4\uC6D4","5\uC6D4","6\uC6D4","7\uC6D4","8\uC6D4","9\uC6D4","10\uC6D4","11\uC6D4","12\uC6D4"],dddd:["\uC77C\uC694\uC77C","\uC6D4\uC694\uC77C","\uD654\uC694\uC77C","\uC218\uC694\uC77C","\uBAA9\uC694\uC77C","\uAE08\uC694\uC77C","\uD1A0\uC694\uC77C"],ddd:["\uC77C","\uC6D4","\uD654","\uC218","\uBAA9","\uAE08","\uD1A0"]},"ko");dt({group:",",ampm:["\u0E01\u0E48\u0E2D\u0E19\u0E40\u0E17\u0E35\u0E48\u0E22\u0E07","\u0E2B\u0E25\u0E31\u0E07\u0E40\u0E17\u0E35\u0E48\u0E22\u0E07"],mmmm:["\u0E21\u0E01\u0E23\u0E32\u0E04\u0E21","\u0E01\u0E38\u0E21\u0E20\u0E32\u0E1E\u0E31\u0E19\u0E18\u0E4C","\u0E21\u0E35\u0E19\u0E32\u0E04\u0E21","\u0E40\u0E21\u0E29\u0E32\u0E22\u0E19","\u0E1E\u0E24\u0E29\u0E20\u0E32\u0E04\u0E21","\u0E21\u0E34\u0E16\u0E38\u0E19\u0E32\u0E22\u0E19","\u0E01\u0E23\u0E01\u0E0E\u0E32\u0E04\u0E21","\u0E2A\u0E34\u0E07\u0E2B\u0E32\u0E04\u0E21","\u0E01\u0E31\u0E19\u0E22\u0E32\u0E22\u0E19","\u0E15\u0E38\u0E25\u0E32\u0E04\u0E21","\u0E1E\u0E24\u0E28\u0E08\u0E34\u0E01\u0E32\u0E22\u0E19","\u0E18\u0E31\u0E19\u0E27\u0E32\u0E04\u0E21"],mmm:["\u0E21.\u0E04.","\u0E01.\u0E1E.","\u0E21\u0E35.\u0E04.","\u0E40\u0E21.\u0E22.","\u0E1E.\u0E04.","\u0E21\u0E34.\u0E22.","\u0E01.\u0E04.","\u0E2A.\u0E04.","\u0E01.\u0E22.","\u0E15.\u0E04.","\u0E1E.\u0E22.","\u0E18.\u0E04."],dddd:["\u0E27\u0E31\u0E19\u0E2D\u0E32\u0E17\u0E34\u0E15\u0E22\u0E4C","\u0E27\u0E31\u0E19\u0E08\u0E31\u0E19\u0E17\u0E23\u0E4C","\u0E27\u0E31\u0E19\u0E2D\u0E31\u0E07\u0E04\u0E32\u0E23","\u0E27\u0E31\u0E19\u0E1E\u0E38\u0E18","\u0E27\u0E31\u0E19\u0E1E\u0E24\u0E2B\u0E31\u0E2A\u0E1A\u0E14\u0E35","\u0E27\u0E31\u0E19\u0E28\u0E38\u0E01\u0E23\u0E4C","\u0E27\u0E31\u0E19\u0E40\u0E2A\u0E32\u0E23\u0E4C"],ddd:["\u0E2D\u0E32.","\u0E08.","\u0E2D.","\u0E1E.","\u0E1E\u0E24.","\u0E28.","\u0E2A."]},"th");dt({decimal:",",ampm:["dop.","odp."],mmmm:["ledna","\xFAnora","b\u0159ezna","dubna","kv\u011Btna","\u010Dervna","\u010Dervence","srpna","z\xE1\u0159\xED","\u0159\xEDjna","listopadu","prosince"],mmm:["led","\xFAno","b\u0159e","dub","kv\u011B","\u010Dvn","\u010Dvc","srp","z\xE1\u0159","\u0159\xEDj","lis","pro"],dddd:["ned\u011Ble","pond\u011Bl\xED","\xFAter\xFD","st\u0159eda","\u010Dtvrtek","p\xE1tek","sobota"],ddd:["ne","po","\xFAt","st","\u010Dt","p\xE1","so"]},"cs");dt({group:".",decimal:",",mmmm:["januar","februar","marts","april","maj","juni","juli","august","september","oktober","november","december"],mmm:["jan.","feb.","mar.","apr.","maj","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["s\xF8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\xF8rdag"],ddd:["s\xF8n.","man.","tir.","ons.","tor.","fre.","l\xF8r."]},"da");dt({group:".",decimal:",",ampm:["a.m.","p.m."],mmmm:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],mmm:["jan.","feb.","mrt.","apr.","mei","jun.","jul.","aug.","sep.","okt.","nov.","dec."],dddd:["zondag","maandag","dinsdag","woensdag","donderdag","vrijdag","zaterdag"],ddd:["zo","ma","di","wo","do","vr","za"]},"nl");dt({group:","},"en");dt({decimal:",",nan:"ep\xE4luku",ampm:["ap.","ip."],mmmm:["tammikuuta","helmikuuta","maaliskuuta","huhtikuuta","toukokuuta","kes\xE4kuuta","hein\xE4kuuta","elokuuta","syyskuuta","lokakuuta","marraskuuta","joulukuuta"],mmm:["tammik.","helmik.","maalisk.","huhtik.","toukok.","kes\xE4k.","hein\xE4k.","elok.","syysk.","lokak.","marrask.","jouluk."],dddd:["sunnuntaina","maanantaina","tiistaina","keskiviikkona","torstaina","perjantaina","lauantaina"],ddd:["su","ma","ti","ke","to","pe","la"]},"fi");dt({group:"\u202F",decimal:",",mmmm:["janvier","f\xE9vrier","mars","avril","mai","juin","juillet","ao\xFBt","septembre","octobre","novembre","d\xE9cembre"],mmm:["janv.","f\xE9vr.","mars","avr.","mai","juin","juil.","ao\xFBt","sept.","oct.","nov.","d\xE9c."],dddd:["dimanche","lundi","mardi","mercredi","jeudi","vendredi","samedi"],ddd:["dim.","lun.","mar.","mer.","jeu.","ven.","sam."]},"fr");dt({group:".",decimal:",",mmmm:["Januar","Februar","M\xE4rz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],mmm:["Jan.","Feb.","M\xE4rz","Apr.","Mai","Juni","Juli","Aug.","Sept.","Okt.","Nov.","Dez."],dddd:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ddd:["So.","Mo.","Di.","Mi.","Do.","Fr.","Sa."]},"de");dt({group:".",decimal:",",ampm:["\u03C0.\u03BC.","\u03BC.\u03BC."],mmmm:["\u0399\u03B1\u03BD\u03BF\u03C5\u03B1\u03C1\u03AF\u03BF\u03C5","\u03A6\u03B5\u03B2\u03C1\u03BF\u03C5\u03B1\u03C1\u03AF\u03BF\u03C5","\u039C\u03B1\u03C1\u03C4\u03AF\u03BF\u03C5","\u0391\u03C0\u03C1\u03B9\u03BB\u03AF\u03BF\u03C5","\u039C\u03B1\u0390\u03BF\u03C5","\u0399\u03BF\u03C5\u03BD\u03AF\u03BF\u03C5","\u0399\u03BF\u03C5\u03BB\u03AF\u03BF\u03C5","\u0391\u03C5\u03B3\u03BF\u03CD\u03C3\u03C4\u03BF\u03C5","\u03A3\u03B5\u03C0\u03C4\u03B5\u03BC\u03B2\u03C1\u03AF\u03BF\u03C5","\u039F\u03BA\u03C4\u03C9\u03B2\u03C1\u03AF\u03BF\u03C5","\u039D\u03BF\u03B5\u03BC\u03B2\u03C1\u03AF\u03BF\u03C5","\u0394\u03B5\u03BA\u03B5\u03BC\u03B2\u03C1\u03AF\u03BF\u03C5"],mmm:["\u0399\u03B1\u03BD","\u03A6\u03B5\u03B2","\u039C\u03B1\u03C1","\u0391\u03C0\u03C1","\u039C\u03B1\u0390","\u0399\u03BF\u03C5\u03BD","\u0399\u03BF\u03C5\u03BB","\u0391\u03C5\u03B3","\u03A3\u03B5\u03C0","\u039F\u03BA\u03C4","\u039D\u03BF\u03B5","\u0394\u03B5\u03BA"],dddd:["\u039A\u03C5\u03C1\u03B9\u03B1\u03BA\u03AE","\u0394\u03B5\u03C5\u03C4\u03AD\u03C1\u03B1","\u03A4\u03C1\u03AF\u03C4\u03B7","\u03A4\u03B5\u03C4\u03AC\u03C1\u03C4\u03B7","\u03A0\u03AD\u03BC\u03C0\u03C4\u03B7","\u03A0\u03B1\u03C1\u03B1\u03C3\u03BA\u03B5\u03C5\u03AE","\u03A3\u03AC\u03B2\u03B2\u03B1\u03C4\u03BF"],ddd:["\u039A\u03C5\u03C1","\u0394\u03B5\u03C5","\u03A4\u03C1\u03AF","\u03A4\u03B5\u03C4","\u03A0\u03AD\u03BC","\u03A0\u03B1\u03C1","\u03A3\u03AC\u03B2"]},"el");dt({decimal:",",ampm:["de.","du."],mmmm:["janu\xE1r","febru\xE1r","m\xE1rcius","\xE1prilis","m\xE1jus","j\xFAnius","j\xFAlius","augusztus","szeptember","okt\xF3ber","november","december"],mmm:["jan.","febr.","m\xE1rc.","\xE1pr.","m\xE1j.","j\xFAn.","j\xFAl.","aug.","szept.","okt.","nov.","dec."],dddd:["vas\xE1rnap","h\xE9tf\u0151","kedd","szerda","cs\xFCt\xF6rt\xF6k","p\xE9ntek","szombat"],ddd:["V","H","K","Sze","Cs","P","Szo"]},"hu");dt({group:".",decimal:",",ampm:["f.h.","e.h."],mmmm:["jan\xFAar","febr\xFAar","mars","apr\xEDl","ma\xED","j\xFAn\xED","j\xFAl\xED","\xE1g\xFAst","september","okt\xF3ber","n\xF3vember","desember"],mmm:["jan.","feb.","mar.","apr.","ma\xED","j\xFAn.","j\xFAl.","\xE1g\xFA.","sep.","okt.","n\xF3v.","des."],dddd:["sunnudagur","m\xE1nudagur","\xFEri\xF0judagur","mi\xF0vikudagur","fimmtudagur","f\xF6studagur","laugardagur"],ddd:["sun.","m\xE1n.","\xFEri.","mi\xF0.","fim.","f\xF6s.","lau."]},"is");dt({group:".",decimal:",",mmmm:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],mmm:["Jan","Feb","Mar","Apr","Mei","Jun","Jul","Agu","Sep","Okt","Nov","Des"],dddd:["Minggu","Senin","Selasa","Rabu","Kamis","Jumat","Sabtu"],ddd:["Min","Sen","Sel","Rab","Kam","Jum","Sab"]},"id");dt({group:".",decimal:",",mmmm:["gennaio","febbraio","marzo","aprile","maggio","giugno","luglio","agosto","settembre","ottobre","novembre","dicembre"],mmm:["gen","feb","mar","apr","mag","giu","lug","ago","set","ott","nov","dic"],dddd:["domenica","luned\xEC","marted\xEC","mercoled\xEC","gioved\xEC","venerd\xEC","sabato"],ddd:["dom","lun","mar","mer","gio","ven","sab"]},"it");dt({decimal:",",ampm:["a.m.","p.m."],mmmm:["januar","februar","mars","april","mai","juni","juli","august","september","oktober","november","desember"],mmm:["jan.","feb.","mar.","apr.","mai","jun.","jul.","aug.","sep.","okt.","nov.","des."],dddd:["s\xF8ndag","mandag","tirsdag","onsdag","torsdag","fredag","l\xF8rdag"],ddd:["s\xF8n.","man.","tir.","ons.","tor.","fre.","l\xF8r."]},"nb");dt({decimal:",",mmmm:["stycznia","lutego","marca","kwietnia","maja","czerwca","lipca","sierpnia","wrze\u015Bnia","pa\u017Adziernika","listopada","grudnia"],mmm:["sty","lut","mar","kwi","maj","cze","lip","sie","wrz","pa\u017A","lis","gru"],dddd:["niedziela","poniedzia\u0142ek","wtorek","\u015Broda","czwartek","pi\u0105tek","sobota"],ddd:["niedz.","pon.","wt.","\u015Br.","czw.","pt.","sob."]},"pl");dt({group:".",decimal:",",mmmm:["janeiro","fevereiro","mar\xE7o","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"],mmm:["jan.","fev.","mar.","abr.","mai.","jun.","jul.","ago.","set.","out.","nov.","dez."],dddd:["domingo","segunda-feira","ter\xE7a-feira","quarta-feira","quinta-feira","sexta-feira","s\xE1bado"],ddd:["dom.","seg.","ter.","qua.","qui.","sex.","s\xE1b."]},"pt");dt({decimal:",",nan:"\u043D\u0435\xA0\u0447\u0438\u0441\u043B\u043E",mmmm:["\u044F\u043D\u0432\u0430\u0440\u044F","\u0444\u0435\u0432\u0440\u0430\u043B\u044F","\u043C\u0430\u0440\u0442\u0430","\u0430\u043F\u0440\u0435\u043B\u044F","\u043C\u0430\u044F","\u0438\u044E\u043D\u044F","\u0438\u044E\u043B\u044F","\u0430\u0432\u0433\u0443\u0441\u0442\u0430","\u0441\u0435\u043D\u0442\u044F\u0431\u0440\u044F","\u043E\u043A\u0442\u044F\u0431\u0440\u044F","\u043D\u043E\u044F\u0431\u0440\u044F","\u0434\u0435\u043A\u0430\u0431\u0440\u044F"],mmm:["\u044F\u043D\u0432.","\u0444\u0435\u0432\u0440.","\u043C\u0430\u0440.","\u0430\u043F\u0440.","\u043C\u0430\u044F","\u0438\u044E\u043D.","\u0438\u044E\u043B.","\u0430\u0432\u0433.","\u0441\u0435\u043D\u0442.","\u043E\u043A\u0442.","\u043D\u043E\u044F\u0431.","\u0434\u0435\u043A."],dddd:["\u0432\u043E\u0441\u043A\u0440\u0435\u0441\u0435\u043D\u044C\u0435","\u043F\u043E\u043D\u0435\u0434\u0435\u043B\u044C\u043D\u0438\u043A","\u0432\u0442\u043E\u0440\u043D\u0438\u043A","\u0441\u0440\u0435\u0434\u0430","\u0447\u0435\u0442\u0432\u0435\u0440\u0433","\u043F\u044F\u0442\u043D\u0438\u0446\u0430","\u0441\u0443\u0431\u0431\u043E\u0442\u0430"],ddd:["\u0432\u0441","\u043F\u043D","\u0432\u0442","\u0441\u0440","\u0447\u0442","\u043F\u0442","\u0441\u0431"]},"ru");dt({decimal:",",mmmm:["janu\xE1ra","febru\xE1ra","marca","apr\xEDla","m\xE1ja","j\xFAna","j\xFAla","augusta","septembra","okt\xF3bra","novembra","decembra"],mmm:["jan","feb","mar","apr","m\xE1j","j\xFAn","j\xFAl","aug","sep","okt","nov","dec"],dddd:["nede\u013Ea","pondelok","utorok","streda","\u0161tvrtok","piatok","sobota"],ddd:["ne","po","ut","st","\u0161t","pi","so"]},"sk");dt({group:".",decimal:",",ampm:["a.\xA0m.","p.\xA0m."],mmmm:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],mmm:["ene.","feb.","mar.","abr.","may.","jun.","jul.","ago.","sept.","oct.","nov.","dic."],dddd:["domingo","lunes","martes","mi\xE9rcoles","jueves","viernes","s\xE1bado"],ddd:["dom.","lun.","mar.","mi\xE9.","jue.","vie.","s\xE1b."]},"es");dt({decimal:",",ampm:["fm","em"],mmmm:["januari","februari","mars","april","maj","juni","juli","augusti","september","oktober","november","december"],mmm:["jan.","feb.","mars","apr.","maj","juni","juli","aug.","sep.","okt.","nov.","dec."],dddd:["s\xF6ndag","m\xE5ndag","tisdag","onsdag","torsdag","fredag","l\xF6rdag"],ddd:["s\xF6n","m\xE5n","tis","ons","tors","fre","l\xF6r"]},"sv");dt({group:".",decimal:",",ampm:["\xD6\xD6","\xD6S"],mmmm:["Ocak","\u015Eubat","Mart","Nisan","May\u0131s","Haziran","Temmuz","A\u011Fustos","Eyl\xFCl","Ekim","Kas\u0131m","Aral\u0131k"],mmm:["Oca","\u015Eub","Mar","Nis","May","Haz","Tem","A\u011Fu","Eyl","Eki","Kas","Ara"],dddd:["Pazar","Pazartesi","Sal\u0131","\xC7ar\u015Famba","Per\u015Fembe","Cuma","Cumartesi"],ddd:["Paz","Pzt","Sal","\xC7ar","Per","Cum","Cmt"]},"tr");function kn(r,e=0){if(typeof r!="number")return r;if(r<0)return-kn(-r,e);if(e){const t=10**(e||0)||1;return kn(r*t,0)/t}return Math.round(r)}function rD(r){if(r===0)return r;const e=Math.ceil(Math.log10(r<0?-r:r)),t=10**(16-Math.floor(e));return Math.round(r*t)/t}const sD={total:1,sign:0,period:0,int:1,frac:0};function iD(r,e=!0){const t=Math.abs(r);if(!t)return sD;const n=e&&r<0?1:0,s=Math.floor(t),i=Math.floor(Math.log10(t)+1);let o=0,a=0;if(s!==t){o=1;const l=String(kn(i<0?t*10**-i:t/10**i,15));let u=l.length,c=!0,h=0;for(;h<=l.length;){if(l[h]==="."){u--;break}else l[h]==="0"&&c?u--:c=!1;h++}a=u-i,a<0&&(a=0,o=0)}return{total:n+Math.max(i,1)+o+a,digits:Math.max(i,0)+a,sign:n,period:o,int:Math.max(i,1),frac:a}}const Zs=(r,e)=>r.replace(/\./,e.decimal);function xh(r,e,t,n){const s=t|0,i=t<0&&(!e.condition||e.condition[0]==="<>"||e.condition[0]===">="||e.condition[0]===">");if(typeof t=="string")r.push(t);else if(t===s)i&&r.push(n.negative),r.push(Math.abs(s));else{i&&r.push(n.negative);let o=0;const a=Math.abs(t);a&&(o=Math.floor(Math.log10(a)));let l=o<0?a*10**-o:a/10**o;l===10&&(l=1,o++);const u=iD(a),c=()=>{const h=Math.abs(o);let f;l===1?f=l:f=kn(l,5),r.push(Zs(`${f}`,n),n.exponent,o<0?n.negative:n.positive,h<10?"0":"",h)};if(o>=-4&&o<=-1){const h=a.toPrecision(10+o).replace(/0+$/,"");r.push(Zs(h,n))}else if(o===10){const h=a.toFixed(10).slice(0,12).replace(/\.$/,"");r.push(Zs(h,n))}else if(Math.abs(o)<=9)if(u.total<=11){const f=kn(a,9).toFixed(u.frac);r.push(Zs(f,n))}else o===9?r.push(Math.floor(a)):o>=0&&o<9?r.push(kn(a,9-o)):c();else u.total>=12?c():Math.floor(a)===a?r.push(Math.floor(a)):r.push(Zs(kn(a,9).toFixed(u.frac),n))}return r}const ao=2,lo=2**2,Ya=2**3,ws=2**4,Ts=2**5,ys=2**6,yl=2**7,Sl=2**8,Al=2**9,oD=0,aD=2958466,lD=-694324,uD=35830291,cD=-1,Ih=1,xs=6,xn={"#":"",0:"0","?":"\xA0"},hD={"@":"text","-":"minus","+":"plus"},dD=["#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#000","#FFF","#F00","#0F0","#00F","#FF0","#F0F","#0FF","#800","#080","#008","#880","#808","#088","#CCC","#888","#99F","#936","#FFC","#CFF","#606","#F88","#06C","#CCF","#008","#F0F","#FF0","#0FF","#808","#800","#088","#00F","#0CF","#CFF","#CFC","#FF9","#9CF","#F9C","#C9F","#FC9","#36F","#3CC","#9C0","#FC0"],an=Math.floor;function o6(r,e=!0){if(e&&r>=0){if(r===0)return[1900,1,0];if(r===60)return[1900,2,29];if(r<60)return[1900,r<32?1:2,(r-1)%31+1]}let t=r+68569+2415019;const n=an(4*t/146097);t-=an((146097*n+3)/4);const s=an(4e3*(t+1)/1461001);t=t-an(1461*s/4)+31;const i=an(80*t/2447),o=t-an(2447*i/80);t=an(i/11);const a=i+2-12*t;return[100*(n-49)+s+t|0,a|0,o|0]}function fD(r){return o6(r+1462)}function gD(r){if(r===60)throw new Error("#VALUE!");if(r<=1)return[1317,8,29];if(r<60)return[1317,r<32?9:10,1+(r-2)%30];const e=10631/30,t=8.01/60;let n=r+466935;const s=an(n/10631);n-=10631*s;const i=an((n-t)/e);n-=an(i*e+t);const o=an((n+28.5001)/29.5);return o===13?[30*s+i,12,30]:[30*s+i,o,n-an(29.5001*o-29)]}function a6(r,e=0,t=!0){const n=an(r);return e===xs?gD(n):e===cD?fD(n):o6(n,t)}const Oh={int:"integer",frac:"fraction",man:"mantissa",num:"numerator",den:"denominator"},uo=86400,mD=(r,e)=>e?r<lD||r>=uD:r<oD||r>=aD;function kh(r,e,t,n){let s="",i="",o="",a="",l="",u=0,c=r|0,h=0,f=0,d=1,m=0,g=0,p=0,_=0,v=0,w=0;const y=n||Du;if(!e.text&&isFinite(e.scale)&&e.scale!==1&&(r=rD(r*e.scale)),e.exponential){let S=Math.abs(r);S&&(u=Math.round(Math.log10(S))),e.int_max>1&&(u=Math.floor(u/e.int_max)*e.int_max),S=u<0?S*10**-u:S/10**u,r=r<0?-S:S,s+=Math.abs(u)}if(e.integer){const S=Math.abs(kn(r,e.fractions?1:e.frac_max));l+=S<1?"":Math.floor(S)}if(e.grouping){let S="",k=l.length;for(k>e.group_pri&&(k-=e.group_pri,S=y.group+l.slice(k,k+e.group_pri)+S);k>e.group_sec;)k-=e.group_sec,S=y.group+l.slice(k,k+e.group_sec)+S;l=k?l.slice(0,k)+S:S}e.dec_fractions&&(a=String(kn(r,e.frac_max)).split(".")[1]||"");let A=!1;if(e.fractions){const S=Math.abs(e.integer?r%1:r);if(S)if(A=!0,isFinite(e.denominator))o+=e.denominator,i+=kn(S*e.denominator),i==="0"&&(i="",o="",A=!1,l||(l="0"));else{const k=e.integer?e.num_max:1/0,N=n6(S,k,e.den_max);i+=N[0],o+=N[1],e.integer&&i==="0"&&(l||(l="0"),i="",o="",A=!1)}}if(e.date_eval&&mD(r,t.dateSpanLarge)){if(t.dateErrorThrows)throw new Error("Date out of bounds");return t.dateErrorNumber?xh([],{},r,y).join(""):t.overflow}if(e.date){c=r|0;const S=uo*(r-c);if(h=Math.floor(S),w=S-h,Math.abs(w)<1e-6?w=0:w>.9999&&(w=0,h+=1,h===uo&&(h=0,c+=1)),c||e.date_system){const k=a6(r,e.date_system,t.leap1900);f=k[0],d=k[1],m=k[2]}if(h||w){const k=e.date&Al||e.date&Sl||e.date&yl||e.date&ys||e.date&Ts||e.date&ws;(k===Al&&w>.9995||k===Sl&&w>.995||k===yl&&w>.95||k===ys&&w>=.5||k===Ts&&w>=.5||k===ws&&w>=.5)&&(h++,w=0);const N=h<0?uo+h:h;v=Math.floor(N)%60,_=Math.floor(N/60)%60,p=Math.floor(N/60/60)%60}g=(6+c)%7}if(e.int_padding&&(l=e.int_padding.length===1?l||e.int_padding:e.int_padding.substring(0,e.int_padding.length-l.length)+l),e.num_padding&&(i=e.num_padding.length===1?i||e.num_padding:e.num_padding.substring(0,e.num_padding.length-i.length)+i),e.den_padding&&(o=e.den_padding.length===1?o||e.den_padding:o+e.den_padding.slice(o.length)),e.man_padding){const S=e.exp_plus?"+":"";s=e.man_padding.length===1?(u<0?"-":S)+(s||e.man_padding):(u<0?"-":S)+e.man_padding.slice(0,e.man_padding.length-s.length)+s}const I=[];let R=0;const x={int:0,frac:0,man:0,num:0,den:0};for(let S=0,k=e.tokens.length;S<k;S++){const N=e.tokens[S],O=N.num?N.num.length:0;if(N.type==="string")N.rule?N.rule==="num"?A?I.push(N.value):(e.num_min>0||e.den_min>0)&&I.push(N.value.replace(/./g,xn["?"])):N.rule==="num+int"?A&&l?I.push(N.value):e.den_min>0&&(l||e.num_min)&&I.push(N.value.replace(/./g,xn["?"])):N.rule==="den"&&(A?I.push(N.value):(e.den_min>0||e.den_min>0)&&I.push(N.value.replace(/./g,xn["?"]))):I.push(N.value);else if(N.type==="error")I.push(t.invalid);else if(N.type==="point")I.push(e.date?N.value:y.decimal);else if(N.type==="general")xh(I,e,r,y);else if(N.type==="exp")I.push(y.exponent);else if(N.type==="minus")N.volatile&&e.date||(N.volatile&&!e.fractions&&(e.integer||e.dec_fractions)?(l&&l!=="0"||a)&&I.push(y.negative):I.push(y.negative));else if(N.type==="plus")I.push(y.positive);else if(N.type==="text")I.push(r);else if(N.type==="div")A?I.push("/"):e.num_min>0||e.den_min>0?I.push(xn["?"]):I.push(xn["#"]);else if(N.type==="int")if(e.int_pattern.length===1)I.push(l);else{const D=R?e.int_pattern.join("").length-x.int:1/0,E=R===e.int_pattern.length-1?0:e.int_pattern.join("").length-(x.int+N.num.length);I.push(l.substring(l.length-D,l.length-E)),R++,x.int+=N.num.length}else if(N.type==="frac"){const D=x.frac;for(let E=0;E<O;E++)I.push(a[E+D]||xn[N.num[E]]);x.frac+=O}else if(N.type in Oh)e[`${N.type}_pattern`].length===1?(N.type==="int"&&I.push(l),N.type==="frac"&&I.push(a),N.type==="man"&&I.push(s),N.type==="num"&&I.push(i),N.type==="den"&&I.push(o)):(I.push(Oh[N.type].slice(x[N.type],x[N.type]+O)),x[N.type]+=O);else if(N.type==="year")f<0&&I.push(y.negative),I.push(String(Math.abs(f)).padStart(4,"0"));else if(N.type==="year-short"){const D=f%100;I.push(D<10?"0":"",D)}else if(N.type==="month")I.push(N.pad&&d<10?"0":"",d);else if(N.type==="monthname-single")e.date_system===xs?I.push(y.mmmm6[d-1].charAt(0)):I.push(y.mmmm[d-1].charAt(0));else if(N.type==="monthname-short")e.date_system===xs?I.push(y.mmm6[d-1]):I.push(y.mmm[d-1]);else if(N.type==="monthname")e.date_system===xs?I.push(y.mmmm6[d-1]):I.push(y.mmmm[d-1]);else if(N.type==="weekday-short")I.push(y.ddd[g]);else if(N.type==="weekday")I.push(y.dddd[g]);else if(N.type==="day")I.push(N.pad&&m<10?"0":"",m);else if(N.type==="hour"){const D=p%e.clock||(e.clock<24?e.clock:0);I.push(N.pad&&D<10?"0":"",D)}else if(N.type==="min")I.push(N.pad&&_<10?"0":"",_);else if(N.type==="sec")I.push(N.pad&&v<10?"0":"",v);else if(N.type==="subsec"){I.push(y.decimal);const D=w.toFixed(e.sec_decimals);I.push(D.slice(2,2+N.decimals))}else if(N.type==="am"){const D=p<12?0:1;N.short&&!n?I.push("AP"[D]):I.push(y.ampm[D])}else if(N.type==="hour-elap"){r<0&&I.push(y.negative);const D=c*24+Math.floor(Math.abs(h)/(60*60));I.push(String(Math.abs(D)).padStart(N.pad,"0"))}else if(N.type==="min-elap"){r<0&&I.push(y.negative);const D=c*1440+Math.floor(Math.abs(h)/60);I.push(String(Math.abs(D)).padStart(N.pad,"0"))}else if(N.type==="sec-elap"){r<0&&I.push(y.negative);const D=c*uo+Math.abs(h);I.push(String(Math.abs(D)).padStart(N.pad,"0"))}else if(N.type==="b-year")I.push(f+543);else if(N.type==="b-year-short"){const D=(f+543)%100;I.push(D<10?"0":"",D)}}return t.nbsp?I.join(""):I.join("").replace(/\u00a0/g," ")}const ja={};function qs(r,e,t){return e[`${t}_max`]=r.length,e[`${t}_min`]=r.replace(/#/g,"").length,e}function co(r){if(!(r in ja)){const e=[],t=r.replace(/^[#,]+/,"").replace(/[1-9]\d*/g,n=>"?".repeat(n.length));for(let n=0;n<t.length;n++){const s=t.charAt(n);e[n]=s in xn?xn[s]:s}ja[r]=e.join("")}return ja[r]}function Bt(r,e){typeof r=="string"&&(r=r.replace(/ /g,xn["?"]),r={type:"string",value:r}),r.type==="string"&&e.length&&e[e.length-1].type==="string"?e[e.length-1].value+=r.value:e.push(r)}function _s(r){const e=[],t={scale:1,percent:!1,text:!1,denominator:0,date:0,generated:!1,exponential:!1,exp_plus:!1,grouping:!1,date_eval:!1,locale:"",condition:null,date_system:null,sec_decimals:0,general:!1,integer:!1,group_sec:0,fractions:!1,group_pri:0,color:"",clock:24,int_padding:"",man_padding:"",num_padding:"",den_padding:"",dec_fractions:!1,pattern:"",int_pattern:[],frac_pattern:[],man_pattern:[],den_pattern:[],num_pattern:[],tokens:e};let n=`${r}`,s="int",i=!1,o=null,a=[],l,u=!1,c;for(;n&&!i;){if(c=/^General/i.exec(n))t.general=!0,Bt({type:"general"},e);else if(s==="int"&&(c=/^[#?0]+(?:,[#?0]+)*/.exec(n))||s==="den"&&(c=/^[#?\d]+/.exec(n))||(c=/^[#?0]+/.exec(n)))t[`${s}_pattern`].push(c[0]),o={type:s,num:c[0]},Bt(o,e);else if((c=/^\//.exec(n))&&t[`${s}_pattern`].length){if(!o)throw new SyntaxError(`Missing a numerator in pattern ${r}`);t.fractions=!0,t.num_pattern.push(t[`${s}_pattern`].pop()),o.type="num",s="den",Bt({type:"div"},e)}else if(c=/^,+/.exec(n)){const g=n.charAt(1)in xn;l.slice(-1)in xn&&(c[0].length>1||!g)?t.scale=.001**c[0].length:Bt(c[0],e)}else if(c=/^;/.exec(n)){i=!0;break}else if(c=/^[@+-]/.exec(n))c[0]==="@"&&(t.text=!0),Bt({type:hD[c[0]]},e);else if(c=/^(?:\[(h+|m+|s+)\])/i.exec(n)){const g=c[1].toLowerCase(),p=g[0],_={type:"",size:0,date:1,raw:c[0],pad:g.length};p==="h"?(_.size=ws,_.type="hour-elap"):p==="m"?(_.size=Ts,_.type="min-elap"):(_.size=ys,_.type="sec-elap"),t.date|=_.size,a.push(_),Bt(_,e)}else if(c=/^(?:B2)/i.exec(n))u||(t.date_system=xs);else if(c=/^(?:B1)/i.exec(n))u||(t.date_system=Ih);else if(c=/^(?:([hHmMsSyYbBdDegG])\1*)/.exec(n)){const g={type:"",size:0,date:1,raw:c[0],pad:0,indeterminate:!1,used:!1},p=c[0].toLowerCase(),_=p[0];if(p==="y"||p==="yy")g.size=ao,g.type="year-short";else if(_==="y"||_==="e")g.size=ao,g.type="year";else if(p==="b"||p==="bb")g.size=ao,g.type="b-year-short";else if(_==="b")g.size=ao,g.type="b-year";else if(p==="d"||p==="dd")g.size=Ya,g.type="day",g.pad=/dd/.test(p)?1:0;else if(p==="ddd")g.size=Ya,g.type="weekday-short";else if(_==="d")g.size=Ya,g.type="weekday";else if(_==="h")g.size=ws,g.type="hour",g.pad=/hh/i.test(p)?1:0;else if(_==="m"){p.length===3?(g.size=lo,g.type="monthname-short"):p.length===5?(g.size=lo,g.type="monthname-single"):p.length>=4&&(g.size=lo,g.type="monthname");const v=a[a.length-1];!g.type&&v&&!v.used&&v.size&(ws|ys)&&(v.used=!0,g.size=Ts,g.type="min",g.pad=/mm/.test(p)?1:0),g.type||(g.size=lo,g.type="month",g.pad=/mm/.test(p)?1:0,g.indeterminate=!0)}else if(_==="s"){g.size=ys,g.type="sec",g.pad=/ss/.test(p)?1:0;const v=a[a.length-1];v&&v.size&Ts?g.used=!0:v&&v.indeterminate&&(delete v.indeterminate,v.size=Ts,v.type="min",g.used=!0)}t.date|=g.size,t.date_eval=!0,a.push(g),Bt(g,e)}else if(c=/^(?:AM\/PM|am\/pm|A\/P)/.exec(n))t.clock=12,t.date|=ws,t.date_eval=!0,Bt({type:"am",short:c[0]==="A/P"},e);else if(t.date&&(c=/^\.0{1,3}/i.exec(n))){const g=c[0].length-1,p=[ys,yl,Sl,Al][g];t.date|=p,t.date_eval=!0,t.sec_decimals=Math.max(t.sec_decimals,g),Bt({type:"subsec",size:p,decimals:g,date:1,raw:c[0]},e)}else if((c=/^\\(.)/.exec(n))||(c=/^"([^"]*?)"/.exec(n)))Bt(c[1],e);else if(c=/^\[(<[=>]?|>=?|=)\s*(-?[.\d]+)\]/.exec(n))t.condition=[c[1],parseFloat(c[2])];else if(c=/^\[\$([^\]]+)\]/.exec(n)){const g=c[1].split("-"),p=g.length<2?"":g[g.length-1],_=g[0];_&&Bt(_,e);const v=Ru(p);v&&(t.locale=v);const w=parseInt(p,16);isFinite(w)&&w&16711680&&(w>>16&255)===6&&(t.date_system=xs),u=!0}else if(c=/^\[(black|blue|cyan|green|magenta|red|white|yellow|color\s*(\d+))\]/i.exec(n))t.color=c[2]?dD[parseInt(c[2],10)]||"#000":c[1].toLowerCase();else if(!(c=/^\[(DBNum1|ENG|HIJ|JPN|TWN)\]/i.exec(n))){if(c=/^%/.exec(n))t.scale=100,t.percent=!0,Bt("%",e);else if(c=/^_(\\.|.)/.exec(n))Bt(" ",e);else if(c=/^\./.exec(n))Bt({type:"point",value:c[0]},e),t.dec_fractions=!0,s="frac";else if(c=/^[Ee]([+-]?|(?=[0#?]))/.exec(n))t.exponential=!0,t.exp_plus=c[1]==="+",s="man",Bt({type:"exp",plus:c[1]==="+"},e);else if(!(c=/^\*(\\.|.)/.exec(n))){if(c=/^[BENn[]/.exec(n))throw new SyntaxError(`Unexpected char ${n.charAt(0)} in pattern ${r}`);c=[n[0]],Bt(c[0],e)}}l=c[0],n=n.slice(c?c[0].length:1)}if(t.pattern=r.slice(0,r.length-n.length),/^((?:\[[^\]]+\])+)(;|$)/.test(t.pattern)&&!/^\[(?:h+|m+|s+)\]/.test(t.pattern)&&Bt({type:"text"},e),t.fractions&&t.dec_fractions||t.fractions&&t.exponential)throw new SyntaxError(`Invalid pattern: ${t.pattern}`);const h=t.int_pattern.join("");if(t.grouping=h.indexOf(",")>=0,t.grouping){const g=h.split(","),p=g.length;p===2?(t.group_pri=g[1].length,t.group_sec=t.group_pri):p>2&&(t.group_pri=g[p-1].length,t.group_sec=g[p-2].length)}else t.group_pri=0,t.group_sec=0;qs(h.replace(/[,]/g,""),t,"int"),qs(t.frac_pattern.join(""),t,"frac"),qs(t.man_pattern.join(""),t,"man");let f=t.num_pattern.join(""),d=t.den_pattern.join("");const m=/\?/.test(d)||/\?/.test(f);if(d=d.replace(/\d/g,m?"?":"#"),m&&(d=d.replace(/#$/g,"?")),qs(f,t,"num"),qs(d,t,"den"),m&&(f=f.replace(/#$/g,"?")),t.int_padding=co(t.int_pattern.join("")),t.man_padding=co(t.man_pattern.join("")),t.num_padding=co(f),t.den_padding=co(d),t.den_pattern.length&&(t.denominator=parseInt(t.den_pattern.join("").replace(/\D/g,""),10)),t.integer=!!t.int_pattern.join("").length,t.fractions&&e.forEach((g,p)=>{const _=e[p+1];g.type==="string"&&_&&(_.type==="num"?g.rule="num+int":_.type==="div"?g.rule="num":_.type==="den"&&(g.rule="den"))}),(t.date||t.general)&&(t.int_pattern.length||t.frac_pattern.length||t.scale!==1||t.text))throw new Error("Illegal format");return t.date_system||(t.date_system=Ih),t}const l6=_s("@"),Ka="black";function u6(r,e){for(let t=0;t<3;t++){const n=e[t];if(n){let s;if(n.condition){const i=n.condition[0],o=n.condition[1];i==="="?s=r===o:i===">"?s=r>o:i==="<"?s=r<o:i===">="?s=r>=o:i==="<="?s=r<=o:i==="<>"&&(s=r!==o)}else s=!0;if(s)return n}}}function pD(r,e){if(typeof r!="number"||!isFinite(r))return(e[3]?e[3].color:l6.color)||Ka;const t=u6(r,e);return t&&t.color||Ka}function _D(r,e,t){const n=i6(t.locale),s=e[3]?e[3]:l6;if(typeof r=="boolean"&&(r=r?"TRUE":"FALSE"),r==null)return"";if(typeof r!="number")return kh(r,s,t,n);if(!isFinite(r)){const o=n||Du;return isNaN(r)?o.nan:(r<0?o.negative:"")+o.infinity}const i=u6(r,e);return i?kh(r,i,t,n):""}function bD(r){return!!(r[0]&&r[0].date||r[1]&&r[1].date||r[2]&&r[2].date||r[3]&&r[3].date)}function vD(r){const[e,t,n,s]=r;return!!((!e||e.generated)&&(!t||t.generated)&&(!n||n.generated)&&s&&s.text&&!s.generated)}function CD(r){return!!(r[0]&&r[0].percent||r[1]&&r[1].percent||r[2]&&r[2].percent||r[3]&&r[3].percent)}const xo={overflow:"######",dateErrorThrows:!1,dateErrorNumber:!0,dateSpanLarge:!0,leap1900:!0,nbsp:!0,throws:!0,invalid:"######",locale:"",ignoreTimezone:!1},Za={...xo};function xu(r={}){if(r===null&&(r=xo),r){for(const e in r)if(e in xo){const t=r[e];t==null?Za[e]=xo[e]:Za[e]=t}}return{...Za}}function c6(r){const e=[];let t=!1,n,s=null,i=r,o=0,a=null,l=0,u=0;do{if(a=_s(i),a.condition&&(u++,t=!0),a.text){if(s)throw new Error("Unexpected partition");s=a}a.locale&&(n=Ru(a.locale)),e.push(a),o=i.charAt(a.pattern.length)===";"?1:0,i=i.slice(a.pattern.length+o),l++}while(o&&l<4&&u<3);if(u>2)throw new Error("Unexpected condition");if(o)throw new Error("Unexpected partition");if(!t){if(e.length<4&&s)for(let c=0,h=e.length;c<h;c++)e[c]===s&&e.splice(c,1);if(e.length<1&&s&&(e[0]=_s("General"),e[0].generated=!0),e.length<2){const c=_s(e[0].pattern);c.tokens.unshift({type:"minus",volatile:!0}),c.generated=!0,e.push(c)}if(e.length<3){const c=_s(e[0].pattern);c.generated=!0,e.push(c)}if(e.length<4)if(s)e.push(s);else{const c=_s("@");c.generated=!0,e.push(c)}e[0].condition=[">",0],e[1].condition=["<",0],e[2].condition=null}return{pattern:r,partitions:e,locale:n}}function ED(r){try{return c6(r)}catch(e){const t={tokens:[{type:"error"}]};return{pattern:r,locale:null,partitions:[t,t,t,t],error:e.message}}}const ho=Math.floor,qa=86400;function $o(r,e){let t=null;if(Array.isArray(r)){const[n,s,i,o,a,l]=r;t=Date.UTC(n,s==null?0:s-1,i!=null?i:1,o||0,a||0,l||0)}else r instanceof Date&&(t=r.getTime(),(!e||!e.ignoreTimezone)&&(t-=r.getTimezoneOffset()*60*1e3));if(t!=null&&isFinite(t)){const n=t/864e5;return n-(n<=-25509?-25568:-25569)}return r}function h6(r,e){let t=r|0;const n=qa*(r-t);let s=ho(n);n-s>.9999&&(s+=1,s===qa&&(s=0,t+=1));const i=s<0?qa+s:s,[o,a,l]=a6(r,0,e&&e.leap1900),u=ho(i/60/60)%60,c=ho(i/60)%60,h=ho(i)%60;if(e&&e.nativeDate){const f=new Date(0);return f.setUTCFullYear(o,a-1,l),f.setUTCHours(u,c,h),f}return[o,a,l,u,c,h]}const wD=["d-F-y","d-F-Y","d-M-y","d-M-Y","F-d-y","F-d-Y","F-j-y","F-j-Y","j-F-y","j-F-Y","j-M-y","j-M-Y","M-d-y","M-d-Y","M-j-y","M-j-Y","m-d-y","m-d-Y","m-j-y","m-j-Y","n-d-y","n-d-Y","n-j-y","n-j-Y","y-F-d","y-F-j","y-M-d","y-M-j","Y-F-d","Y-F-j","Y-M-d","Y-m-d","Y-M-j","Y-m-j","Y-n-d","Y-n-j","M-d","M-j","d-F","d-M","n-d","n-j","j-F","j-M","M-Y","n-Y","m-d","F-d","m-j","F-j","m-Y","F-Y","Y-M","Y-n","Y-m","Y-F","Y-M"],yn={};function Sn(r,e){if(r){const t=r[0];e[t]=e[t]||{},Sn(r.slice(1),e[t])}else e.$=!0}wD.forEach(r=>{Sn(r,yn),Sn(`${r} x`,yn),Sn(`${r} l`,yn),Sn(`${r} l x`,yn),Sn(`l ${r}`,yn),Sn(`l ${r} x`,yn),Sn(`${r} D`,yn),Sn(`${r} D x`,yn),Sn(`D ${r}`,yn),Sn(`D ${r} x`,yn)});const TD={jan:1,feb:2,mar:3,apr:4,may:5,jun:6,jul:7,aug:8,sep:9,oct:10,nov:11,dec:12},yD={january:1,february:2,march:3,april:4,june:6,july:7,august:8,september:9,october:10,november:11,december:12},SD={sunday:"l",monday:"l",tuesday:"l",wednesday:"l",thursday:"l",friday:"l",saturday:"l",sun:"D",mon:"D",tue:"D",wed:"D",thu:"D",fri:"D",sat:"D"},AD=new Date().getUTCFullYear();function d6(r){const e=/^([\s+%$(-]*)(((?:(?:\d[\d,]*)(?:\.\d*)?|(?:\.\d+)))([eE][+-]?\d+)?)([\s%$)]*)$/.exec(r);if(e){const[,t,n,s,i,o]=e;let a=1,l="",u=!1,c=!1,h=!1,f=!1,d=!1,m=!1,g=parseFloat(n.replace(/,/g,""));if(!isFinite(g))return null;for(let _=0;_<t.length;_++){const v=t[_];if(v==="-"){if(u||c)return null;u=!0,a=-1}else if(v==="$"){if(d)return null;d=!0}else if(v==="("){if(c||u)return null;c=!0,a=-1}else if(v==="%"){if(f)return null;f=!0}}for(let _=0;_<o.length;_++){const v=o[_];if(v==="$"){if(d)return null;d=!0,m=!0}else if(v===")"){if(h||!c)return null;h=!0}else if(v==="%"){if(f)return null;f=!0}}if(i){if(f||d)return null;l="0.00E+00"}else if(f){if(d)return null;l=s.includes(".")?"0.00%":"0%",g*=.01}else d?m?l=s.includes(".")?"#,##0.00$":"#,##0$":l=s.includes(".")?"$#,##0.00":"$#,##0":s.includes(",")&&(l=s.includes(".")?"#,##0.00":"#,##0");const p={v:g*a,z:""};return l&&(p.z=l),p}}function RD(r,e,t){if(t<1||e<1||e>12)return!1;if(e===2){const s=r%4===0&&r%100!==0||r%400===0||r===1900?29:28;if(t>s)return!1}else if((e===4||e===6||e===9||e===11)&&t>30||(e===1||e===3||e===5||e===7||e===8||e===10||e===12)&&t>31)return!1;return!0}const Ln=(r,e,t)=>{const n=t.path||"",s=Object.keys(e);for(let i=0;i<s.length;i++){let o;const a=s[i];if(!!e[a]){if(a==="$")r||(o=t);else if(a==="-"){const l=/^(\s*([./-]|,\s)\s*|\s+)/.exec(r);if(l){const u=l[1]==="-"||l[1]==="/"||l[1]==="."?l[1]:" ";if(!t.sep||t.sep===u){const c=l[0].replace(/\s+/g," ");o=Ln(r.slice(l[0].length),e[a],{...t,sep:u,path:n+c})}}}else if(a===" "){const l=/^[,.]?\s+/.exec(r);if(l){const u=l[0].replace(/\s+/g," ");o=Ln(r.slice(l[0].length),e[a],{...t,path:n+u})}}else if(a==="j"||a==="d"){const l=/^(0?[1-9]|1\d|2\d|3[01])\b/.exec(r);l&&(o=Ln(r.slice(l[0].length),e[a],{...t,day:l[0],path:n+a}))}else if(a==="n"||a==="m"){const l=/^(0?[1-9]|1[012])\b/.exec(r);l&&(o=Ln(r.slice(l[0].length),e[a],{...t,month:+l[0],_mon:l[0],path:n+a}))}else if(a==="F"||a==="M"){const l=/^([a-z]{3,9})\b/i.exec(r),u=l&&(a==="F"?yD:TD)[l[0].toLowerCase()];u&&(o=Ln(r.slice(l[0].length),e[a],{...t,month:u,_mon:l[0],path:n+a}))}else if(a==="l"||a==="D"){const l=/^([a-z]{3,9})\b/i.exec(r);(l&&SD[l[0].toLowerCase()])===a&&(o=Ln(r.slice(l[0].length),e[a],{...t,path:n+a}))}else if(a==="y"){const l=/^\d\d\b/.exec(r);if(l){const u=+l[0]>=30?+l[0]+1900:+l[0]+2e3;o=Ln(r.slice(l[0].length),e[a],{...t,year:u,path:n+a})}}else if(a==="Y"){const l=/^\d\d\d\d\b/.exec(r);l&&(o=Ln(r.slice(l[0].length),e[a],{...t,year:+l[0],path:n+a}))}else if(a==="x"){const l=Iu(r);l&&(o=Ln("",e[a],{...t,time:l.v,tf:l.z,path:n+a}))}else throw new Error(`Unknown date token "${a}"`);if(o)return o}}};function f6(r,e){var n;if(!r)return null;const t=Ln(r.trim(),yn,{path:""});if(t){if(t.sep==="."&&t.path.length===3)return null;const s=+((n=t.year)!=null?n:AD);if(t.day||(t.day=1),!RD(s,t.month,t.day))return null;let i=-1/0;if(s<1900)return null;s<=1900&&t.month<=2?i=25568:s<1e4&&(i=25569);const o=Date.UTC(s,t.month-1,t.day)/864e5+i+(t.time||0);if(o>=0&&o<=2958465){const a=t._mon[0]==="0"||t.day[0]==="0"||t._mon.length===2&&t.day.length===2,l=t.path.replace(/[jdlDnmMFyYx-]/g,u=>u==="j"||u==="d"?a?"dd":"d":u==="D"?"ddd":u==="l"?"dddd":u==="n"||u==="m"?a?"mm":"m":u==="M"?"mmm":u==="F"?"mmmm":u==="y"?"yy":u==="x"?t.tf||"":u==="Y"?"yyyy":u);return e&&e.nativeDate?{v:h6(o,e),z:l}:{v:o,z:l}}}return null}function Iu(r){const e=/^\s*([10]?\d|2[0-4])(?::([0-5]\d|\d))?(?::([0-5]\d|\d))?(\.\d{1,10})?(?:\s*([AP])M?)?\s*$/i.exec(r);if(e){const[,t,n,s,i,o]=e;if(i&&!s||!o&&!n&&!s)return null;let a=parseFloat(t)||0;if(o){if(a>=13)return null;(o[0]==="p"||o[0]==="P")&&(a+=12)}const l=parseFloat(n)||0,u=parseFloat(s)||0,c=parseFloat(i)||0;return{v:(a*60*60+l*60+u+c)/(60*60*24),z:`${t.length===2?"hh":"h"}:mm${s?":ss":""}${o?" AM/PM":""}`}}return null}function g6(r){return/^\s*true\s*$/i.test(r)?{v:!0}:/^\s*false\s*$/i.test(r)?{v:!1}:null}function DD(r,e){var t,n,s;return(s=(n=(t=d6(r))!=null?t:f6(r,e))!=null?n:Iu(r))!=null?s:g6(r)}const bi={};function xD(r,e={}){const{pattern:t,partitions:n,locale:s}=r,i=a=>{const l={...xu(),...e,...a};return s&&(l.locale=s),l},o=(a,l)=>{if(a){const u=i(l);return _D($o(a,u),n,u)}return String()};return o.color=(a,l={})=>{const u=i(l);return pD($o(a,u),n)},o.isPercent=()=>CD(n),o.isDate=()=>bD(n),o.isText=()=>vD(n),o.pattern=t,r.error&&(o.error=r.error),o.options=i,o.locale=s||e&&e.locale||"",Object.freeze(o)}function ht(r,e={}){r||(r="General");let t=null;return bi[r]?t=bi[r]:(t={...xu(),...e}.throws?c6(r):ED(r),t.error||(bi[r]=t)),xD(t,e)}ht.isDate=r=>ht(r,{throws:!1}).isDate();ht.isPercent=r=>ht(r,{throws:!1}).isPercent();ht.isText=r=>ht(r,{throws:!1}).isText();ht.dateToSerial=$o;ht.dateFromSerial=h6;ht.options=xu;ht.dec2frac=n6;ht.round=kn;ht.codeToLocale=Do;ht.getLocale=i6;ht.parseLocale=fa;ht.addLocale=(r,e)=>{const t=fa(e);return delete bi[t.lang],delete bi[t.language],dt(r,t)};function ID(r,e,t,n=!1){const s=t&&typeof t=="object"?t:{locale:t,throws:!n};return ht(r,s)($o(e,s),s)}ht.format=ID;ht.is_date=ht.isDate;ht.parseNumber=d6;ht.parseDate=f6;ht.parseTime=Iu;ht.parseBool=g6;ht.parseValue=DD;class OD{constructor(){this._sheetsNumfmtConfig=new Map}getNumfmtBySheetIdConfig(e){let t=this._sheetsNumfmtConfig.get(e);return t||(t={},this._sheetsNumfmtConfig.set(e,t),t)}}const kD="univer-format-content",ND="univer-format-input",MD="univer-format-selected",FD="univer-custom-format",BD="univer-drop-content",LD="univer-select-item-content",PD="univer-custom-format-more",HD="univer-select-item-suffix",UD="univer-select-item";var Ss={formatContent:kD,formatInput:ND,formatSelected:MD,customFormat:FD,dropContent:BD,selectItemContent:LD,customFormatMore:PD,selectItemSuffix:HD,selectItem:UD};class zD{constructor(e){this._model=new OD,this._plugin=e,this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET);const t=s=>{const i=this._sheetPlugin.getSelectionManager(),o=this._plugin.getContext().getWorkBook(),a=o.getActiveSheet(),l=i.getActiveRangeList(),u=a.getCellMatrix();l!=null&&(l.getRangeList().forEach(c=>{let h=new pe;ut.foreach(c,(g,p)=>{const _=u.getValue(g,p);if(_){const v=ht(s);h.setValue(g,p,{v:_.v,m:v(_.v)})}});const f={sheetId:a.getSheetId(),actionName:W.SET_RANGE_DATA_ACTION,cellValue:h.getData()},d=Dr.make(f).removeExtension().getAction(),m=new fe({WorkBookUnit:o},d);o.getCommandManager().invoke(m)}),l.getRangeList().forEach(c=>{let h=new pe;ut.foreach(c,(m,g)=>{h.setValue(m,g,s)});const f={sheetId:a.getSheetId(),actionName:da.SET_NUMFMT_RANGE_DATA_ACTION,numfmtMatrix:h.getData()};new fe({WorkBookUnit:o},f).invoke()}))},n=KR.map((s,i)=>({onClick:()=>{switch(i){case 0:{t("G");break}case 1:{t("@");break}case 2:{t("#.##");break}case 3:{t("#.##%");break}case 4:{t("#.##E+");break}case 5:break;case 6:{t("\xA5#.##");break}case 7:break;case 8:{t("yyyy-mm-dd");break}case 9:{t("h:mm AM/PM");break}case 10:{t("h:mm");break}case 11:{t("yyyy-mm-dd h:mm AM/PM");break}case 12:{t("yyyy-mm-dd h:mm");break}}},...s}));this._numfmtList={name:tr,type:0,tooltipLocale:"toolbar.moreFormats",className:Ss.customFormat,show:QR.show,border:!0,children:[...n,{locale:"defaultFmt.CustomFormats.text",customSuffix:{name:"RightIcon"},className:Ss.customFormatMore,children:[{locale:"format.moreCurrency",onClick:()=>{this._plugin.getNumfmtModalController().showModal("currency",!0)}},{locale:"format.moreDateTime",onClick:()=>{this._plugin.getNumfmtModalController().showModal("date",!0)}},{locale:"format.moreNumber",onClick:()=>{this._plugin.getNumfmtModalController().showModal("number",!0)}}]}]},this._sheetPlugin.addToolButton(this._numfmtList)}getNumfmtBySheetIdConfig(e){return this._model.getNumfmtBySheetIdConfig(e)}setNumfmtByRange(e,t,n){const s=new pe;ut.foreach(t,(u,c)=>{s.setValue(u,c,n)});const i=this._plugin.getContext(),o=i.getCommandManager(),a={actionName:W.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:t,cellValue:s.toJSON()},l=new fe({WorkBookUnit:i.getWorkBook()},a);o.invoke(l)}setNumfmtByCoords(e,t,n,s){const i=new pe;i.setValue(t,n,s);const o={startRow:t,startColumn:n,endRow:t,endColumn:n},a=this._plugin.getContext(),l=a.getCommandManager(),u={actionName:W.SET_RANGE_DATA_ACTION,sheetId:e,rangeData:o,cellValue:i.toJSON()},c=new fe({WorkBookUnit:a.getWorkBook()},u);l.invoke(c)}}class Js extends Xe{constructor(){super(...arguments),this._ref=Ve()}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender()}getInput(){const{input:e}=this.props,t=this._render.renderFunction("Input");if(e)return b("div",{className:Ss.formatInput},b("span",null,e,":"),b(t,{type:"number",value:"2",onChange:this.handleChange.bind(this)}))}handleClick(e,t){const n=this._ref.current.querySelectorAll("li");for(let s=0;s<n.length;s++)n[s].classList.remove(Ss.formatSelected);n[t].classList.add(Ss.formatSelected),this.props.onClick(e)}handleChange(e){var n,s;const t=e.target.value;(s=(n=this.props).onChange)==null||s.call(n,t)}render(){const{data:e}=this.props;return b("div",{className:Ss.formatContent,ref:this._ref},this.getInput(),b("ul",null,e.map((t,n)=>b("li",{onClick:()=>this.handleClick(t.value,n)},b("span",null,t.label),b("span",null,t.suffix)))))}}class Nh extends Xe{initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=t.getComponentRender(),this.state={modalData:[]}}componentDidMount(){this._context.getPluginManager().getPluginByName(tr).getObserver("onNumfmtModalDidMountObservable").notifyObservers(this)}setModal(e){const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);e.forEach(n=>{var i;const s=t.getRegisterComponent(n.children.name);if(s){const o=(i=n.children.props)!=null?i:{};n.modal=b(s,{...o})}}),this.setState({modalData:e})}render(){const e=this._render.renderFunction("Modal"),{modalData:t}=this.state;return b(yt,null,t.map(n=>{if(!!n.show)return b(e,{title:n.title,visible:n.show,group:n.group,onCancel:n.onCancel},n.modal)}))}}class WD{constructor(e){const t=e.getContext().getLocale();this._plugin=e,this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET),this._modalData=[{name:"currency",locale:"toolbar.currencyFormat",show:!1,group:[{locale:"button.confirm",type:"primary",onClick:()=>{}},{locale:"button.cancel",onClick:()=>{}}],onCancel:()=>{this.showModal("currency",!1)},children:{name:tr+Js.name,props:{data:this.resetContentData(ZR),onClick:n=>console.dir(n),input:t.get("format.decimalPlaces"),onChange:n=>console.dir(n)}}},{name:"date",locale:"toolbar.currencyFormat",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>{this.showModal("currency",!1)},children:{name:tr+Js.name,props:{data:qR,onClick:n=>console.dir(n)}}},{name:"number",locale:"toolbar.numberFormat",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>{this.showModal("number",!1)},children:{name:tr+Js.name,props:{data:JR,onClick:n=>console.dir(n)}}}],this._initRegisterComponent(),this._initialize()}_initialize(){this._plugin.getObserver("onNumfmtModalDidMountObservable").add(e=>{this._numfmtModal=e,this.resetModalData()})}_initRegisterComponent(){this._sheetPlugin.registerComponent(tr+Js.name,Js),this._sheetPlugin.registerModal(tr+Nh.name,Nh)}resetContentData(e){const t=this._plugin.getContext().getLocale();for(let n=0;n<e.length;n++)e[n].locale&&(e[n].label=t.get(e[n].locale));return e}resetModalData(){const e=this._plugin.getContext().getLocale();this._modalData.forEach(t=>{t.title=e.get(t.locale),t.group&&t.group.length&&t.group.forEach(n=>{n.label=e.get(n.locale)})}),this._numfmtModal.setModal(this._modalData)}showModal(e,t){const n=this._modalData.findIndex(s=>s.name===e);n>-1&&(this._modalData[n].show=t,this.resetModalData())}}var VD={currencyDetail:{RMB:"\u4EBA\u6C11\u5E01",USdollar:"\u7F8E\u5143",EUR:"\u6B27\u5143",GBP:"\u82F1\u9551",HK:"\u6E2F\u5143",JPY:"\u65E5\u5143",AlbanianLek:"\u963F\u5C14\u5DF4\u5C3C\u4E9A\u5217\u514B",AlgerianDinar:"\u963F\u5C14\u53CA\u5229\u4E9A\u7B2C\u7EB3\u5C14",Afghani:"\u963F\u5BCC\u6C57\u5C3C",ArgentinePeso:"\u963F\u6839\u5EF7\u6BD4\u7D22",UnitedArabEmiratesDirham:"\u963F\u62C9\u4F2F\u8054\u5408\u914B\u957F\u56FD\u8FEA\u62C9\u59C6",ArubanFlorin:"\u963F\u9C81\u5DF4\u5F17\u7F57\u6797",OmaniRial:"\u963F\u66FC\u91CC\u4E9A\u5C14",Azerbaijanimanat:"\u963F\u585E\u62DC\u7586\u9A6C\u7EB3\u7279",EgyptianPound:"\u57C3\u53CA\u9551",EthiopianBirr:"\u57C3\u585E\u4FC4\u6BD4\u4E9A\u6BD4\u5C14",AngolaKwanza:"\u5B89\u54E5\u62C9\u5BBD\u624E",AustralianDollar:"\u6FB3\u5927\u5229\u4E9A\u5143",Patacas:"\u6FB3\u95E8\u5143",BarbadosDollar:"\u5DF4\u5DF4\u591A\u65AF\u5143",PapuaNewGuineaKina:"\u5DF4\u5E03\u4E9A\u65B0\u51E0\u5185\u4E9A\u57FA\u90A3",BahamianDollar:"\u5DF4\u54C8\u9A6C\u5143",PakistanRupee:"\u5DF4\u57FA\u65AF\u5766\u5362\u6BD4",ParaguayanGuarani:"\u5DF4\u62C9\u572D\u74DC\u62C9\u5C3C",BahrainiDinar:"\u5DF4\u6797\u7B2C\u7EB3\u5C14",PanamanianBalboa:"\u5DF4\u62FF\u9A6C\u5DF4\u6CE2\u4E9A",Brazilianreal:"\u5DF4\u897F\u91CC\u4E9A\u4F0A",Belarusianruble:"\u767D\u4FC4\u7F57\u65AF\u5362\u5E03",BermudianDollar:"\u767E\u6155\u5927\u5143",BulgarianLev:"\u4FDD\u52A0\u5229\u4E9A\u5217\u5F17",IcelandKrona:"\u51B0\u5C9B\u514B\u6717",BosniaHerzegovinaConvertibleMark:"\u6CE2\u9ED1\u53EF\u5151\u6362\u9A6C\u514B",PolishZloty:"\u6CE2\u5170\u5179\u7F57\u63D0",Boliviano:"\u73BB\u5229\u7EF4\u4E9A\u8BFA",BelizeDollar:"\u4F2F\u5229\u5179\u5143",BotswanaPula:"\u535A\u8328\u74E6\u7EB3\u666E\u62C9",NotDannuzhamu:"\u4E0D\u4E39\u52AA\u624E\u59C6",BurundiFranc:"\u5E03\u9686\u8FEA\u6CD5\u90CE",NorthKoreanWon:"\u671D\u9C9C\u5706",DanishKrone:"\u4E39\u9EA6\u514B\u6717",EastCaribbeanDollar:"\u4E1C\u52A0\u52D2\u6BD4\u5143",DominicaPeso:"\u591A\u7C73\u5C3C\u52A0\u6BD4\u7D22",RussianRuble:"\u4FC4\u56FD\u5362\u5E03",EritreanNakfa:"\u5384\u7ACB\u7279\u91CC\u4E9A\u7EB3\u514B\u6CD5",CFAfranc:"\u975E\u6D32\u91D1\u878D\u5171\u540C\u4F53\u6CD5\u90CE",PhilippinePeso:"\u83F2\u5F8B\u5BBE\u6BD4\u7D22",FijiDollar:"\u6590\u6D4E\u5143",CapeVerdeEscudo:"\u4F5B\u5F97\u89D2\u57C3\u65AF\u5E93\u591A",FalklandIslandsPound:"\u798F\u514B\u5170\u7FA4\u5C9B\u9551",GambianDalasi:"\u5188\u6BD4\u4E9A\u8FBE\u62C9\u897F",Congolesefranc:"\u521A\u679C\u6CD5\u90CE",ColombianPeso:"\u54E5\u4F26\u6BD4\u4E9A\u6BD4\u7D22",CostaRicanColon:"\u54E5\u65AF\u8FBE\u9ECE\u52A0\u79D1\u6717",CubanPeso:"\u53E4\u5DF4\u6BD4\u7D22",Cubanconvertiblepeso:"\u53E4\u5DF4\u53EF\u5151\u6362\u6BD4\u7D22",GuyanaDollar:"\u572D\u4E9A\u90A3\u5143",KazakhstanTenge:"\u54C8\u8428\u514B\u65AF\u5766\u575A\u6208",Haitiangourde:"\u6D77\u5730\u53E4\u5FB7",won:"\u97E9\u5143",NetherlandsAntillesGuilder:"\u8377\u5C5E\u5B89\u7684\u5217\u65AF\u76FE",Honduraslempiras:"\u6D2A\u90FD\u62C9\u65AF\u62C9\u4F26\u76AE\u62C9",DjiboutiFranc:"\u5409\u5E03\u63D0\u6CD5\u90CE",KyrgyzstanSom:"\u5409\u5C14\u5409\u65AF\u65AF\u5766\u7D22\u59C6",GuineaFranc:"\u51E0\u5185\u4E9A\u6CD5\u90CE",CanadianDollar:"\u52A0\u62FF\u5927\u5143",GhanaianCedi:"\u52A0\u7EB3\u585E\u5730",Cambodianriel:"\u67EC\u57D4\u5BE8\u745E\u5C14",CzechKoruna:"\u6377\u514B\u514B\u6717",ZimbabweDollar:"\u6D25\u5DF4\u5E03\u97E6\u5143",QatariRiyal:"\u5361\u5854\u5C14\u91CC\u4E9A\u5C14",CaymanIslandsDollar:"\u5F00\u66FC\u7FA4\u5C9B\u5143",Comorianfranc:"\u79D1\u6469\u7F57\u6CD5\u90CE",KuwaitiDinar:"\u79D1\u5A01\u7279\u7B2C\u7EB3\u5C14",CroatianKuna:"\u514B\u7F57\u5730\u4E9A\u5E93\u7EB3",KenyanShilling:"\u80AF\u5C3C\u4E9A\u5148\u4EE4",LesothoLoti:"\u83B1\u7D22\u6258\u6D1B\u8482",LaoKip:"\u8001\u631D\u57FA\u666E",LebanesePound:"\u9ECE\u5DF4\u5AE9\u9551",Lithuanianlitas:"\u7ACB\u9676\u5B9B\u7ACB\u7279",LibyanDinar:"\u5229\u6BD4\u4E9A\u7B2C\u7EB3\u5C14",LiberianDollar:"\u5229\u6BD4\u4E9A\u5143",RwandaFranc:"\u5362\u65FA\u8FBE\u6CD5\u90CE",RomanianLeu:"\u7F57\u9A6C\u5C3C\u4E9A\u5217\u4F0A",MalagasyAriary:"\u9A6C\u8FBE\u52A0\u65AF\u52A0\u963F\u91CC\u4E9A\u91CC",MaldivianRufiyaa:"\u9A6C\u5C14\u4EE3\u592B\u62C9\u83F2\u4E9A",MalawiKwacha:"\u9A6C\u62C9\u7EF4\u514B\u74E6\u67E5",MalaysianRinggit:"\u9A6C\u6765\u897F\u4E9A\u6797\u5409\u7279",MacedoniawearingDinar:"\u9A6C\u5176\u987F\u6234\u7B2C\u7EB3\u5C14",MauritiusRupee:"\u6BDB\u91CC\u6C42\u65AF\u5362\u6BD4",MauritanianOuguiya:"\u6BDB\u91CC\u5854\u5C3C\u4E9A\u4E4C\u5409\u4E9A",MongolianTugrik:"\u8499\u53E4\u56FE\u683C\u91CC\u514B",BangladeshiTaka:"\u5B5F\u52A0\u62C9\u5854\u5361",PeruvianNuevoSol:"\u79D8\u9C81\u65B0\u7D22\u5C14",MyanmarKyat:"\u7F05\u7538\u5F00\u4E9A\u7279",MoldovanLeu:"\u6469\u5C14\u591A\u74E6\u5217\u4F0A",MoroccanDirham:"\u6469\u6D1B\u54E5\u8FEA\u62C9\u59C6",MozambiqueMetical:"\u83AB\u6851\u6BD4\u514B\u6885\u8482\u5361\u5C14",MexicanPeso:"\u58A8\u897F\u54E5\u6BD4\u7D22",NamibianDollar:"\u7EB3\u7C73\u6BD4\u4E9A\u5143",SouthAfricanRand:"\u5357\u975E\u5170\u7279",SouthSudanesePound:"\u5357\u82CF\u4E39\u9551",NicaraguaCordoba:"\u5C3C\u52A0\u62C9\u74DC\u79D1\u591A\u5DF4",NepaleseRupee:"\u5C3C\u6CCA\u5C14\u5362\u6BD4",NigerianNaira:"\u5C3C\u65E5\u5229\u4E9A\u5948\u62C9",NorwegianKrone:"\u632A\u5A01\u514B\u6717",GeorgianLari:"\u4E54\u6CBB\u4E9A\u62C9\u745E",RMBOffshore:"\u4EBA\u6C11\u5E01\uFF08\u79BB\u5CB8\uFF09",SwedishKrona:"\u745E\u5178\u514B\u6717",SwissFranc:"\u745E\u58EB\u6CD5\u90CE",SerbianDinar:"\u585E\u5C14\u7EF4\u4E9A\u7B2C\u7EB3\u5C14",SierraLeone:"\u585E\u62C9\u5229\u6602\u5229\u6602",SeychellesRupee:"\u585E\u820C\u5C14\u5362\u6BD4",SaudiRiyal:"\u6C99\u7279\u91CC\u4E9A\u5C14",SaoTomeDobra:"\u5723\u591A\u7F8E\u591A\u5E03\u62C9",SaintHelenapound:"\u5723\u8D6B\u52D2\u62FF\u7FA4\u5C9B\u78C5",SriLankaRupee:"\u65AF\u91CC\u5170\u5361\u5362\u6BD4",SwazilandLilangeni:"\u65AF\u5A01\u58EB\u5170\u91CC\u5170\u5409\u5C3C",SudanesePound:"\u82CF\u4E39\u9551",Surinamesedollar:"\u82CF\u91CC\u5357\u5143",SolomonIslandsDollar:"\u6240\u7F57\u95E8\u7FA4\u5C9B\u5143",SomaliShilling:"\u7D22\u9A6C\u91CC\u5148\u4EE4",TajikistanSomoni:"\u5854\u5409\u514B\u65AF\u5766\u7D22\u83AB\u5C3C",PacificFranc:"\u592A\u5E73\u6D0B\u6CD5\u90CE",ThaiBaht:"\u6CF0\u56FD\u94E2",TanzanianShilling:"\u5766\u6851\u5C3C\u4E9A\u5148\u4EE4",TonganPaanga:"\u6C64\u52A0\u6F58\u52A0",TrinidadandTobagoDollar:"\u7279\u7ACB\u5C3C\u8FBE\u548C\u591A\u5DF4\u54E5\u5143",TunisianDinar:"\u7A81\u5C3C\u65AF\u7B2C\u7EB3\u5C14",TurkishLira:"\u571F\u8033\u5176\u91CC\u62C9",VanuatuVatu:"\u74E6\u52AA\u963F\u56FE\u74E6\u56FE",GuatemalanQuetzal:"\u5371\u5730\u9A6C\u62C9\u683C\u67E5\u5C14",CommissionBolivar:"\u59D4\u5185\u745E\u62C9\u535A\u5229\u74E6",BruneiDollar:"\u6587\u83B1\u5143",UgandanShilling:"\u4E4C\u5E72\u8FBE\u5148\u4EE4",UkrainianHryvnia:"\u4E4C\u514B\u5170\u683C\u91CC\u592B\u5C3C\u4E9A",UruguayanPeso:"\u4E4C\u62C9\u572D\u6BD4\u7D22",Uzbekistansom:"\u4E4C\u5179\u522B\u514B\u65AF\u5766\u82CF\u59C6",WesternSamoaTala:"\u897F\u8428\u6469\u4E9A\u5854\u62C9",SingaporeDollar:"\u65B0\u52A0\u5761\u5143",NT:"\u65B0\u53F0\u5E01",NewZealandDollar:"\u65B0\u897F\u5170\u5143",HungarianForint:"\u5308\u7259\u5229\u798F\u6797",SyrianPound:"\u53D9\u5229\u4E9A\u9551",JamaicanDollar:"\u7259\u4E70\u52A0\u5143",ArmenianDram:"\u4E9A\u7F8E\u5C3C\u4E9A\u5FB7\u62C9\u59C6",YemeniRial:"\u4E5F\u95E8\u91CC\u4E9A\u5C14",IraqiDinar:"\u4F0A\u62C9\u514B\u7B2C\u7EB3\u5C14",IranianRial:"\u4F0A\u6717\u91CC\u4E9A\u5C14",NewIsraeliShekel:"\u4EE5\u8272\u5217\u65B0\u8C22\u514B\u5C14",IndianRupee:"\u5370\u5EA6\u5362\u6BD4",IndonesianRupiah:"\u5370\u5EA6\u5C3C\u897F\u4E9A\u5362\u6BD4",JordanianDinar:"\u7EA6\u65E6\u7B2C\u7EB3\u5C14",VND:"\u8D8A\u5357\u76FE",ZambianKwacha:"\u8D5E\u6BD4\u4E9A\u514B\u74E6\u67E5",GibraltarPound:"\u76F4\u5E03\u7F57\u9640\u9551",ChileanPeso:"\u667A\u5229\u6BD4\u7D22",CFAFrancBEAC:"\u4E2D\u975E\u91D1\u878D\u5408\u4F5C\u6CD5\u90CE"}},GD={currencyDetail:{RMB:"RMB",USdollar:"US dollar",EUR:"EUR",GBP:"GBP",HK:"HK",JPY:"JPY",AlbanianLek:"Albanian Lek",AlgerianDinar:"Algerian Dinar",Afghani:"Afghani",ArgentinePeso:"Argentine Peso",UnitedArabEmiratesDirham:"United Arab Emirates Dirham",ArubanFlorin:"Aruban Florin",OmaniRial:"Omani Rial",Azerbaijanimanat:"Azerbaijani manat",EgyptianPound:"Egyptian Pound",EthiopianBirr:"Ethiopian Birr",AngolaKwanza:"Angola Kwanza",AustralianDollar:"Australian Dollar",Patacas:"Patacas",BarbadosDollar:"Barbados Dollar",PapuaNewGuineaKina:"Papua New Guinea Kina",BahamianDollar:"Bahamian Dollar",PakistanRupee:"Pakistan Rupee",ParaguayanGuarani:"Paraguayan Guarani",BahrainiDinar:"Bahraini Dinar",PanamanianBalboa:"Panamanian Balboa",Brazilianreal:"Brazilian real",Belarusianruble:"Belarusian ruble",BermudianDollar:"Bermudian Dollar",BulgarianLev:"Bulgarian Lev",IcelandKrona:"Iceland Krona",BosniaHerzegovinaConvertibleMark:"Bosnia-Herzegovina Convertible Mark",PolishZloty:"Polish Zloty",Boliviano:"Boliviano",BelizeDollar:"Belize Dollar",BotswanaPula:"Botswana Pula",NotDannuzhamu:"Not Dannuzhamu",BurundiFranc:"Burundi Franc",NorthKoreanWon:"North Korean Won",DanishKrone:"Danish Krone",EastCaribbeanDollar:"East Caribbean Dollar",DominicaPeso:"Dominica Peso",RussianRuble:"Russian Ruble",EritreanNakfa:"Eritrean Nakfa",CFAfranc:"CFA franc",PhilippinePeso:"Philippine Peso",FijiDollar:"Fiji Dollar",CapeVerdeEscudo:"Cape Verde Escudo",FalklandIslandsPound:"Falkland Islands Pound",GambianDalasi:"Gambian Dalasi",Congolesefranc:"Congolese franc",ColombianPeso:"Colombian Peso",CostaRicanColon:"Costa Rican Colon",CubanPeso:"Cuban Peso",Cubanconvertiblepeso:"Cuban convertible peso",GuyanaDollar:"Guyana Dollar",KazakhstanTenge:"Kazakhstan Tenge",Haitiangourde:"Haitian gourde",won:"won",NetherlandsAntillesGuilder:"Netherlands Antilles Guilder",Honduraslempiras:"Honduras lempiras",DjiboutiFranc:"Djibouti Franc",KyrgyzstanSom:"Kyrgyzstan Som",GuineaFranc:"Guinea Franc",CanadianDollar:"Canadian Dollar",GhanaianCedi:"Ghanaian Cedi",Cambodianriel:"Cambodian riel",CzechKoruna:"Czech Koruna",ZimbabweDollar:"Zimbabwe Dollar",QatariRiyal:"Qatari Riyal",CaymanIslandsDollar:"Cayman Islands Dollar",Comorianfranc:"Comorian franc",KuwaitiDinar:"Kuwaiti Dinar",CroatianKuna:"Croatian Kuna",KenyanShilling:"Kenyan Shilling",LesothoLoti:"Lesotho Loti",LaoKip:"Lao Kip",LebanesePound:"Lebanese Pound",Lithuanianlitas:"Lithuanian litas",LibyanDinar:"Libyan Dinar",LiberianDollar:"Liberian Dollar",RwandaFranc:"Rwanda Franc",RomanianLeu:"Romanian Leu",MalagasyAriary:"Malagasy Ariary",MaldivianRufiyaa:"Maldivian Rufiyaa",MalawiKwacha:"Malawi Kwacha",MalaysianRinggit:"Malaysian Ringgit",MacedoniawearingDinar:"Macedonia wearing Dinar",MauritiusRupee:"Mauritius Rupee",MauritanianOuguiya:"Mauritanian Ouguiya",MongolianTugrik:"Mongolian Tugrik",BangladeshiTaka:"Bangladeshi Taka",PeruvianNuevoSol:"Peruvian Nuevo Sol",MyanmarKyat:"Myanmar Kyat",MoldovanLeu:"Moldovan Leu",MoroccanDirham:"Moroccan Dirham",MozambiqueMetical:"Mozambique Metical",MexicanPeso:"Mexican Peso",NamibianDollar:"Namibian Dollar",SouthAfricanRand:"South African Rand",SouthSudanesePound:"South Sudanese Pound",NicaraguaCordoba:"Nicaragua Cordoba",NepaleseRupee:"Nepalese Rupee",NigerianNaira:"Nigerian Naira",NorwegianKrone:"Norwegian Krone",GeorgianLari:"Georgian Lari",RMBOffshore:"RMB (Offshore)",SwedishKrona:"Swedish Krona",SwissFranc:"Swiss Franc",SerbianDinar:"Serbian Dinar",SierraLeone:"Sierra Leone",SeychellesRupee:"Seychelles Rupee",SaudiRiyal:"Saudi Riyal",SaoTomeDobra:"Sao Tome Dobra",SaintHelenapound:"Saint Helena pound",SriLankaRupee:"Sri Lanka Rupee",SwazilandLilangeni:"Swaziland Lilangeni",SudanesePound:"Sudanese Pound",Surinamesedollar:"Surinamese dollar",SolomonIslandsDollar:"Solomon Islands Dollar",SomaliShilling:"Somali Shilling",TajikistanSomoni:"Tajikistan Somoni",PacificFranc:"Pacific Franc",ThaiBaht:"Thai Baht",TanzanianShilling:"Tanzanian Shilling",TonganPaanga:"Tongan Pa'anga",TrinidadandTobagoDollar:"Trinidad and Tobago Dollar",TunisianDinar:"Tunisian Dinar",TurkishLira:"Turkish Lira",VanuatuVatu:"Vanuatu Vatu",GuatemalanQuetzal:"Guatemalan Quetzal",CommissionBolivar:"Commission Bolivar",BruneiDollar:"Brunei Dollar",UgandanShilling:"Ugandan Shilling",UkrainianHryvnia:"Ukrainian Hryvnia",UruguayanPeso:"Uruguayan Peso",Uzbekistansom:"Uzbekistan som",WesternSamoaTala:"Western Samoa Tala",SingaporeDollar:"Singapore Dollar",NT:"NT",NewZealandDollar:"New Zealand Dollar",HungarianForint:"Hungarian Forint",SyrianPound:"Syrian Pound",JamaicanDollar:"Jamaican Dollar",ArmenianDram:"Armenian Dram",YemeniRial:"Yemeni Rial",IraqiDinar:"Iraqi Dinar",IranianRial:"Iranian Rial",NewIsraeliShekel:"New Israeli Shekel",IndianRupee:"Indian Rupee",IndonesianRupiah:"Indonesian Rupiah",JordanianDinar:"Jordanian Dinar",VND:"VND",ZambianKwacha:"Zambian Kwacha",GibraltarPound:"Gibraltar Pound",ChileanPeso:"Chilean Peso",CFAFrancBEAC:"CFA Franc BEAC"}};class XD extends Zo{execute(){const e=new pe;this.actionDataList.forEach(n=>{if(n.operation!=null&&!Dr.hasExtension(n))return!1;if(n.actionName===W.SET_RANGE_DATA_ACTION){let{cellValue:s,sheetId:i}=n;new pe(s).forValue((l,u,c)=>{const h=ht.parseValue(c.v);if(h){const f=ht(h.z);c.m=f(h.v),c.v=h.v||String(),e.setValue(l,u,h.z)}});const a={actionName:da.SET_NUMFMT_RANGE_DATA_ACTION,sheetId:i,cellValue:e.toJSON()};this.push(a)}})}}class $D extends Bl{get zIndex(){return 2}create(e){return new XD(e,this._plugin)}}class Ou extends or{constructor(e){super(tr)}static create(e){return new Ou(e)}onMounted(e){tD(this),e.getLocale().load({en:GD,zh:VD}),this._numfmtActionExtensionFactory=new $D(this),this._numfmtModalController=new WD(this),this._controller=new zD(this),this.context.getCommandManager().getActionExtensionManager().getRegister().add(this._numfmtActionExtensionFactory)}onDestroy(){super.onDestroy(),this.context.getCommandManager().getActionExtensionManager().getRegister().delete(this._numfmtActionExtensionFactory)}getNumfmtBySheetIdConfig(e){return this._controller.getNumfmtBySheetIdConfig(e)}setNumfmtByRange(e,t,n){this._controller.setNumfmtByRange(e,t,n)}setNumfmtByCoords(e,t,n,s){this._controller.setNumfmtByCoords(e,t,n,s)}getNumfmtModalController(){return this._numfmtModalController}}const YD={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:ot.COLUMN,posOffset:100},positionV:{relativeFrom:lt.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:tn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Wn.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Ct.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Ct.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Ct.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Ct.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Lt.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Ct.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Lt.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Ct.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Lt.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:un.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:q.DRAWING},{elementId:"smallSub",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},Yo={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:un.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"smallSub",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};pn.EN,te.FALSE,C.MEDIUM_DASHED,C.MEDIUM_DASHED,C.THICK,C.THIN,ct.RIGHT,rn.TOP,ct.RIGHT,rn.MIDDLE,Mt.WRAP,te.FALSE,C.THIN,C.THIN,C.THIN,C.THIN,Mt.WRAP,Dt.GRID,G.deepClone(Yo),te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,Dt.GRID,Dt.GRID,Dt.GRID,Dt.GRID,Dt.GRID;pn.EN,te.FALSE,C.MEDIUM_DASHED,C.MEDIUM_DASHED,C.THICK,C.THIN,ct.RIGHT,rn.TOP,Mt.WRAP,te.FALSE,C.THIN,C.THIN,C.THIN,C.THIN,Dt.GRID,G.deepClone(Yo),te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,te.FALSE,Dt.GRID;const jD={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u2460Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},threeElement:{eId:"threeElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u2461Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fourElement:{eId:"fourElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u2462Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fiveElement:{eId:"fiveElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement",paragraphElementType:q.PAGE_BREAK},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement1",paragraphElementType:q.PAGE_BREAK},{elementId:"threeElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:q.PAGE_BREAK},{elementId:"fourElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:q.PAGE_BREAK},{elementId:"fiveElement",paragraphElementType:q.TEXT_RUN}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},KD={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},ZD={id:"workbook-01",theme:"default",locale:pn.EN,creator:"univer",name:"UniverSheet Demo",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:[],pluginMeta:{},styles:{1:{fs:30,vt:2,bl:1,pd:{l:5}},2:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},pd:{l:5},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bl:1,bg:{rgb:"rgb(255,226,102)"},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{bl:1,vt:2,pd:{l:5},bg:{rgb:"rgb(255,226,102)"},ht:2},5:{vt:2,pd:{l:5}},6:{vt:2,ht:2,fs:12,cl:{rgb:"rgb(1,136,251)"}},7:{vt:2,pd:{l:5},bg:{rgb:"rgb(255,251,224)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},8:{vt:2,ht:2,cl:{rgb:"rgb(1,136,251)"},pd:{l:5},bg:{rgb:"rgb(255,251,224)"}},9:{vt:2,pd:{l:25}},10:{bg:{rgb:"#bf9000"},pd:{l:5},bd:{t:null,l:null,r:null,b:null}},11:{vt:2,ht:2,fs:24,bg:{rgb:"rgb(183,83,119)"},cl:{rgb:"#fff"}},12:{bg:{rgb:"rgb(248,237,241)"},bd:{t:null,l:null,r:null,b:null}},13:{vt:2,ht:2,bg:{rgb:"rgb(244,186,112)"},bd:{t:null,l:null,r:null,b:null}},14:{vt:2,ht:2,bg:{rgb:"rgb(248,237,241)"},bd:{b:{s:C.THICK,cl:{rgb:"rgb(218,170,186)"}}}},15:{vt:2,ht:2,bg:{rgb:"rgb(246,131,131)"},bd:{t:null,l:null,r:null,b:null}},16:{vt:2,ht:2,bg:{rgb:"rgb(207,98,170)"},bd:{t:null,l:null,r:null,b:null}},17:{vt:2,ht:2,bg:{rgb:"rgb(172,135,188)"},bd:{t:null,l:null,r:null,b:null}},18:{vt:2,ht:2,bg:{rgb:"rgb(97,170,206)"},bd:{t:null,l:null,r:null,b:null}},19:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(244,186,112,0.5)"},bd:{t:null,l:null,r:null,b:null}},20:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(246,131,131,0.5)"},bd:{t:null,l:null,r:null,b:null}},21:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(207,98,170,0.5)"},bd:{t:null,l:null,r:null,b:null}},22:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(172,135,188,0.5)"},bd:{t:null,l:null,r:null,b:null}},23:{vt:2,ht:2,cl:{rgb:"#fff"},bg:{rgb:"rgb(97,170,206,0.5)"},bd:{t:null,l:null,r:null,b:null}},24:{bg:{rgb:"#3d85c6"},bd:{t:null,l:null,r:null,b:null}},25:{bg:{rgb:"#c27ba0"},bd:{t:null,l:null,r:null,b:null}},26:{bg:{rgb:"rgb(224, 102, 102)"},bd:{t:null,l:null,r:null,b:null}},27:{bg:{rgb:"#f90"},bd:{t:null,l:null,r:null,b:null}},28:{bg:{rgb:"#76a5af"},bd:{t:null,l:null,r:null,b:null}},29:{bg:{rgb:"#38761d"},bd:{t:null,l:null,r:null,b:null}},30:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}},31:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},32:{vt:2,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},33:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},34:{vt:2,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},35:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},36:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},37:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},fs:14,cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},38:{vt:2,tb:3,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},39:{vt:2,ht:2,bg:{rgb:"#6fa8dc"},cl:{rgb:"#fff"},bd:{t:{s:C.THIN,cl:{rgb:"#000"}},l:{s:C.THIN,cl:{rgb:"#000"}},r:{s:C.THIN,cl:{rgb:"#000"}},b:{s:C.THIN,cl:{rgb:"#000"}}}},40:{vt:2,ht:2,fs:24,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},41:{ht:3,bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},42:{vt:2,cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},43:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},44:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},45:{vt:2,tb:3,pd:{l:10,r:10},bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}}}},46:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},47:{vt:2,ht:2,bd:{t:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},48:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},49:{vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},50:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},51:{vt:2,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},l:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}},r:{s:C.THICK,cl:{rgb:"rgb(125,133,22)"}},b:{s:C.THIN,cl:{rgb:"rgb(125,133,22)"}}}},52:{bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},53:{ht:2,vt:2,tr:{a:90,v:0},cl:{rgb:"rgb(125,133,22)"},bd:{t:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},54:{bd:{l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}}}},55:{ht:3,vt:3,tb:3,bd:{t:null,l:{s:C.THIN,cl:{rgb:"#fff"}},r:{s:C.THIN,cl:{rgb:"#fff"}},b:{s:C.THIN,cl:{rgb:"#fff"}}}},56:{vt:2,ht:2,fs:30,bl:1,bg:{rgb:"#9fc5e8"},cl:{rgb:"#fff"},bd:{t:null,l:null,r:null,b:null}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0004":{type:Dt.GRID,id:"sheet-0004",name:"sheet0004",cellData:{0:{0:{s:"40"},1:{m:"Travel Declaration Form",s:"40"},8:{p:KD,s:"41"},10:{s:"52"}},1:{1:{m:"Department:",s:"42"},6:{m:"Application Date:",s:"42"}},2:{1:{m:"Business Trip Employee",s:"43"},2:{s:"46"},3:{m:"Position",s:"46"},4:{s:"46"},6:{s:"46",m:"Entourage"},7:{s:"47"},10:{m:"Borrower write-off",s:"53"}},3:{1:{m:"Business Trip Place",s:"44"},2:{m:"                      To                      To                      To",s:"48"}},4:{1:{m:"Amount",s:"44"},2:{m:"(Capital)         \u4E07        \u4EDF        \u4F70        \u62FE        \u5143        \u89D2        \u5206",s:"49"},7:{m:"(Lower) \xA5",s:"48"}},5:{1:{m:"Departure Time",s:"44"},2:{s:"49"},3:{m:"ETR",s:"50"},5:{s:"50"},8:{m:"Days",s:"50"},9:{s:"48"}},6:{1:{m:"Reasons",s:"44"},2:{s:"48"}},7:{1:{m:"Applicant For Travel",s:"44"},2:{s:"50"},3:{m:"Administrator",s:"50"},4:{s:"50"},6:{m:"Financial Manager",s:"50"},7:{s:"50"},9:{m:"Payee",s:"51"}},8:{1:{m:"Department Head",s:"44"},2:{s:"50"},3:{m:"Manager",s:"50"},4:{s:"50"},6:{m:"Cashier",s:"50"},7:{s:"50"},9:{s:"51"}},9:{1:{m:"Record: The loan is used exclusively for travel expenses, and the travel expenses will not be written off without a business trip application.",s:"45"}}},tabColor:"blue",hidden:te.FALSE,freezeColumn:1,rowCount:10,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,mergeData:[{startRow:0,endRow:1,startColumn:10,endColumn:10},{startRow:0,endRow:9,startColumn:0,endColumn:0},{startRow:0,endRow:0,startColumn:1,endColumn:7},{startRow:0,endRow:0,startColumn:8,endColumn:9},{startRow:1,endRow:1,startColumn:1,endColumn:4},{startRow:1,endRow:1,startColumn:6,endColumn:9},{startRow:2,endRow:2,startColumn:4,endColumn:5},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:3,endRow:3,startColumn:2,endColumn:9},{startRow:4,endRow:4,startColumn:2,endColumn:6},{startRow:4,endRow:4,startColumn:7,endColumn:9},{startRow:5,endRow:5,startColumn:3,endColumn:4},{startRow:5,endRow:5,startColumn:5,endColumn:7},{startRow:6,endRow:6,startColumn:2,endColumn:9},{startRow:7,endRow:7,startColumn:4,endColumn:5},{startRow:8,endRow:8,startColumn:7,endColumn:8},{startRow:8,endRow:8,startColumn:4,endColumn:5},{startRow:7,endRow:7,startColumn:7,endColumn:8},{startRow:9,endRow:9,startColumn:1,endColumn:9},{startRow:2,endRow:9,startColumn:10,endColumn:10}],rowData:{0:{h:50},1:{h:20},6:{h:150},9:{h:30}},columnData:{0:{w:20},1:{w:180},2:{w:120},4:{w:60},5:{w:60},7:{w:30},8:{w:90},10:{w:40}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0003":{type:Dt.GRID,id:"sheet-0003",name:"sheet0003",cellData:{0:{1:{m:"Purchase Orders ",s:"56"},4:{s:"31"},5:{m:"Number:",s:"32"},6:{s:"31"}},1:{4:{s:"31"}},2:{4:{m:"[Company]:",s:"33"},5:{s:"34"}},3:{4:{m:"[Adress]:",s:"33"},5:{s:"34"}},4:{4:{m:"[TEL]:",s:"33"},5:{s:"34"}},5:{4:{m:"[FAX]:",s:"33"},5:{s:"34"}},6:{1:{s:"32"}},7:{1:{m:"Subscriber:",s:"32"},2:{s:"34"},3:{m:"Order Date:",s:"32"},4:{s:"34"},5:{m:"Telephone:",s:"32"},6:{s:"34"}},8:{1:{m:"Payment:",s:"32"},2:{s:"34"},3:{m:"Delivery:",s:"32"},4:{s:"34"},5:{s:"32"},6:{s:"32"}},9:{1:{s:"32"}},10:{1:{m:"SKU",s:"35"},2:{m:"Product name ",s:"35"},4:{m:"Quantity",s:"35"},5:{m:"Price",s:"35"},6:{m:"Amount",s:"35"}},11:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"1",v:"1"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"10",v:"10"}},12:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"10",v:"10"},6:{s:"36",m:"20",v:"20"}},13:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36",m:"2",v:"2"},5:{s:"36",m:"2",v:"2"},6:{s:"36"}},14:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},15:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},16:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},17:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},18:{1:{s:"36"},2:{s:"36"},3:{s:"36"},4:{s:"36"},5:{s:"36"},6:{s:"36"}},19:{1:{m:"Remark ",s:"37"},2:{m:"If there is any problem, please list the specific reasons in writing and fax to contact the company.",s:"38"},5:{m:"Subtotal",s:"39"},6:{s:"36"}},20:{5:{m:"Tax",s:"39"},6:{s:"36"}},21:{5:{m:"Freight",s:"39"},6:{s:"36"}},22:{5:{m:"Total ",s:"39"},6:{s:"36"}},23:{1:{s:"32"}},24:{1:{m:"Approval of Responsible Person:",s:"55"},2:{s:"34"},3:{m:"Accountant:",s:"55"},4:{s:"34"},5:{m:"Responsible Person:",s:"55"},6:{s:"34"}},25:{1:{m:"Company:",s:"55"},2:{s:"34"},3:{s:"32"},4:{s:"32"},5:{m:"Date:",s:"55"},6:{s:"34"}},26:{1:{s:"54"}}},tabColor:"green",hidden:te.FALSE,freezeColumn:1,rowCount:27,columnCount:8,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:25,mergeData:[{startRow:0,endRow:5,startColumn:1,endColumn:3},{startRow:1,endRow:1,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:5,endColumn:6},{startRow:3,endRow:3,startColumn:5,endColumn:6},{startRow:4,endRow:4,startColumn:5,endColumn:6},{startRow:5,endRow:5,startColumn:5,endColumn:6},{startRow:6,endRow:6,startColumn:1,endColumn:6},{startRow:9,endRow:9,startColumn:1,endColumn:6},{startRow:10,endRow:10,startColumn:2,endColumn:3},{startRow:11,endRow:11,startColumn:2,endColumn:3},{startRow:12,endRow:12,startColumn:2,endColumn:3},{startRow:13,endRow:13,startColumn:2,endColumn:3},{startRow:14,endRow:14,startColumn:2,endColumn:3},{startRow:15,endRow:15,startColumn:2,endColumn:3},{startRow:16,endRow:16,startColumn:2,endColumn:3},{startRow:17,endRow:17,startColumn:2,endColumn:3},{startRow:18,endRow:18,startColumn:2,endColumn:3},{startRow:19,endRow:22,startColumn:1,endColumn:1},{startRow:19,endRow:22,startColumn:2,endColumn:4},{startRow:23,endRow:23,startColumn:1,endColumn:6},{startRow:0,endRow:26,startColumn:0,endColumn:0},{startRow:0,endRow:26,startColumn:7,endColumn:7},{startRow:26,endRow:26,startColumn:1,endColumn:6}],rowData:{9:{h:10},23:{h:30},24:{h:70}},columnData:{0:{w:30},1:{w:80},2:{w:120},3:{w:80},7:{w:30}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0002":{type:Dt.GRID,id:"sheet-0002",name:"sheet0003",cellData:{0:{0:{m:"Annual Work Schedule",s:"11"}},1:{0:{s:"12"},1:{s:"12"},16:{s:"12"}},2:{0:{s:"12"},1:{m:"1/2",s:"13"},4:{m:"3/8",s:"15"},7:{m:"1/4",s:"16"},10:{m:"1/4",s:"17"},13:{m:"1/4",s:"18"},16:{s:"12"}},3:{1:{s:"12"}},4:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{m:"\u221A",s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},5:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase  Products",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},6:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},7:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},8:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},9:{1:{s:"12"}},10:{1:{s:"12"},2:{s:"19",m:"January"},3:{s:"12"},4:{s:"12"},5:{s:"20",m:"February"},6:{s:"12"},7:{s:"12"},8:{s:"21",m:"March"},9:{s:"12"},10:{s:"12"},11:{s:"22",m:"April"},12:{s:"12"},13:{s:"12"},14:{s:"23",m:"May"},15:{s:"12"}},11:{1:{s:"12"}},12:{0:{s:"12"},1:{m:"1/3",s:"13"},4:{m:"3/5",s:"15"},7:{m:"1/2",s:"16"},10:{m:"3/4",s:"17"},13:{m:"5/6",s:"18"},16:{s:"12"}},13:{0:{s:"12"},1:{s:"12"},2:{m:"Go to the party",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{m:"\u221A",s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},14:{0:{s:"12"},1:{s:"12"},2:{m:"Purchase Products",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{m:"\u221A",s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{m:"\u221A",s:"14"}},15:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{m:"\u221A",s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},16:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},17:{0:{s:"12"},1:{s:"12"},2:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},3:{s:"14"},4:{s:"12"},5:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},6:{s:"14"},7:{s:"12"},8:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},9:{s:"14"},10:{s:"12"},11:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},12:{s:"14"},13:{s:"12"},14:{m:"\xD7\xD7\xD7\xD7\xD7",s:"14"},15:{s:"14"}},18:{0:{s:"12"}},25:{0:{m:"\xB7",s:"123"}}},tabColor:"yellow",hidden:te.FALSE,freezeColumn:1,rowCount:26,columnCount:17,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:16},{startRow:1,endRow:17,startColumn:0,endColumn:0},{startRow:1,endRow:17,startColumn:16,endColumn:16},{startRow:1,endRow:1,startColumn:1,endColumn:15},{startRow:3,endRow:3,startColumn:1,endColumn:15},{startRow:2,endRow:2,startColumn:1,endColumn:3},{startRow:2,endRow:2,startColumn:4,endColumn:6},{startRow:2,endRow:2,startColumn:7,endColumn:9},{startRow:2,endRow:2,startColumn:10,endColumn:12},{startRow:2,endRow:2,startColumn:13,endColumn:15},{startRow:9,endRow:9,startColumn:1,endColumn:15},{startRow:11,endRow:11,startColumn:1,endColumn:15},{startRow:12,endRow:12,startColumn:1,endColumn:3},{startRow:12,endRow:12,startColumn:4,endColumn:6},{startRow:12,endRow:12,startColumn:7,endColumn:9},{startRow:12,endRow:12,startColumn:10,endColumn:12},{startRow:12,endRow:12,startColumn:13,endColumn:15},{startRow:18,endRow:22,startColumn:0,endColumn:16}],rowData:{0:{h:70},3:{h:20},9:{h:20},10:{h:40},11:{h:20}},columnData:{0:{w:50},1:{w:20},2:{w:150},3:{w:30},4:{w:20},5:{w:150},6:{w:30},7:{w:20},8:{w:150},9:{w:30},10:{w:20},11:{w:150},12:{w:30},13:{w:20},14:{w:150},15:{w:30},16:{w:50}},status:0,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}},"sheet-0001":{type:Dt.GRID,id:"sheet-0001",cellData:{0:{0:{s:"1",m:"A Schedule of Items"}},1:{0:{s:"2",m:"Division of Project"},1:{s:"3",m:"Responsible Person"},2:{s:"4",m:"Date"}},2:{0:{m:"General Project Manager",s:"5"},1:{m:"@XXX",s:"6"},2:{m:"March 1",s:"5"},3:{m:"March 2",s:"5"},4:{m:"March 3",s:"5"},5:{m:"March 4",s:"5"},6:{m:"March 5",s:"5"},7:{m:"March 6",s:"5"},8:{m:"March 7",s:"5"},9:{m:"March 8",s:"5"},10:{m:"March 9",s:"5"},11:{m:"March 10",s:"5"},12:{m:"March 11",s:"5"},13:{m:"March 12",s:"5"},14:{m:"March 13",s:"5"}},3:{0:{m:"1\u3001Responsible Person of Model Section",s:"7"},1:{m:"@George",s:"8"}},4:{0:{m:"Advertisement Signboard",s:"9"},1:{m:"@Paul",s:"6"},4:{s:"10"},5:{s:"10"},6:{s:"10"},7:{s:"10"},8:{s:"10"},9:{s:"10"},10:{s:"10"}},5:{0:{m:"Transport Ready",s:"9"},1:{m:"@George",s:"6"}},6:{0:{m:"2\u3001Head of Special Effects Section",s:"7"},1:{m:"@Paul",s:"8"}},7:{0:{m:"Render Output Parameter Test",s:"9"},1:{m:"@Paul",s:"6"},3:{s:"25"},4:{s:"25"},5:{s:"25"},6:{s:"25"},7:{s:"25"},8:{s:"25"},9:{s:"25"}},8:{0:{m:"Camera Moving Mirror",s:"9"},1:{m:"@Paul",s:"6"}},9:{0:{m:"3\u3001Responsible Person of Rendering Section",s:"7"},1:{m:"@Jennifer",s:"8"}},10:{0:{m:"Scene Dynamic Element Design",s:"9"},7:{s:"27"},8:{s:"27"},9:{s:"27"},10:{s:"27"},11:{s:"27"}},11:{0:{m:"Sky Map Selection",s:"9"}},12:{0:{m:"Reference Scenario Data Collection",s:"9"}},13:{0:{m:"Scene Dynamic Element Design",s:"9"},2:{s:"29"},3:{s:"29"},4:{s:"29"},5:{s:"29"},6:{s:"29"},7:{s:"29"}},14:{0:{p:jD}}},name:"sheet0001",tabColor:"red",hidden:te.FALSE,freezeColumn:1,rowCount:15,columnCount:15,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:32,mergeData:[{startRow:0,endRow:0,startColumn:0,endColumn:14},{startRow:1,endRow:1,startColumn:2,endColumn:14},{startRow:14,endRow:14,startColumn:0,endColumn:14}],rowData:{0:{h:70},2:{h:20},3:{h:20},4:{h:20},5:{h:20},6:{h:20},7:{h:20},8:{h:20},9:{h:20},10:{h:20},11:{h:20},12:{h:20},13:{h:20},14:{h:200}},columnData:{0:{w:250},1:{w:130},2:{w:60},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60},9:{w:60},10:{w:60},11:{w:60},12:{w:60},13:{w:60},14:{w:60}},status:0,showGridlines:1,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]};pn.EN,te.FALSE,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,Dt.GRID,te.FALSE,te.FALSE,te.FALSE,te.FALSE;pn.EN,te.FALSE,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,Dt.GRID,te.FALSE,te.FALSE,te.FALSE,te.FALSE;const qD={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u2460Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},threeElement:{eId:"threeElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u2461Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fourElement:{eId:"fourElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"\u2462Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fiveElement:{eId:"fiveElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement",paragraphElementType:q.PAGE_BREAK},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement1",paragraphElementType:q.PAGE_BREAK},{elementId:"threeElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:q.PAGE_BREAK},{elementId:"fourElement",paragraphElementType:q.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:q.PAGE_BREAK},{elementId:"fiveElement",paragraphElementType:q.TEXT_RUN}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};pn.EN,te.FALSE,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,Dt.GRID,te.FALSE,te.FALSE,te.FALSE,te.FALSE;const JD={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:ze.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},twoElement:{eId:"twoElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN},{elementId:"twoElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};pn.EN,te.FALSE,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THICK,C.THICK,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THICK,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,C.THIN,Dt.GRID,te.FALSE,te.FALSE,te.FALSE,te.FALSE;const Rl={id:"workbook-01",theme:"default",locale:pn.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:te.FALSE,extensions:[],sheetOrder:["sheet-0001"],pluginMeta:{},styles:{1:{vt:2,ht:2,bl:1,fs:14,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"}},2:{vt:2,ht:2,bl:1,fs:20,bg:{rgb:"rgb(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"},fs:14,ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{fs:12,vt:2,pd:{l:5},ht:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}},5:{ht:2,vt:2,bd:{t:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:C.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:Dt.GRID,id:"sheet-0001",name:"sheet-0001",tabColor:"blue",hidden:te.FALSE,freezeColumn:1,rowCount:12,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,cellData:{1:{1:{v:"Variants",s:"2"},2:{v:"Platform",s:"2"},3:{v:"UGC Buzz volume",s:"2"}},2:{3:{v:"Jul'21",s:"1"},4:{v:"Aug'21",s:"1"},5:{v:"Sep'21",s:"1"},6:{v:"Oct'21",s:"1"},7:{v:"Nov'21",s:"1"},8:{v:"Dec'21",s:"1"}},3:{1:{v:"Eleva",s:"3"},2:{v:"Amazon",s:"4"},3:{v:"4",s:"5"},4:{v:"145",s:"5"},5:{v:"44",s:"5"},6:{v:"20",s:"5"},7:{v:"7",s:"5"},8:{v:"12",s:"5"}},4:{2:{v:"Google",s:"4"},3:{v:"2",s:"5"},4:{v:"6",s:"5"},5:{v:"5",s:"5"},6:{v:"6",s:"5"},7:{v:"12",s:"5"},8:{v:"3113",s:"5"}},5:{2:{v:"Amazon",s:"4"},3:{v:"14",s:"5"},4:{v:"13",s:"5"},5:{v:"6",s:"5"},6:{v:"6",s:"5"},7:{v:"11",s:"5"},8:{v:"2",s:"5"}},6:{1:{v:"Similac",s:"3"},2:{v:"SaleForce",s:"4"},3:{v:"451",s:"5"},4:{v:"255",s:"5"},5:{v:"72",s:"5"},6:{v:"23",s:"5"},7:{v:"163",s:"5"},8:{v:"22",s:"5"}},7:{2:{v:"Oracle",s:"4"},3:{v:"0",s:"5"},4:{v:"1",s:"5"},5:{v:"1136",s:"5"},6:{v:"11",s:"5"},7:{v:"2",s:"5"},8:{v:"1",s:"5"}},8:{2:{v:"Apple",s:"4"},3:{v:"7",s:"5"},4:{v:"2",s:"5"},5:{v:"10",s:"5"},6:{v:"5",s:"5"},7:{v:"6",s:"5"},8:{v:"3",s:"5"}},9:{1:{v:"TC",s:"3"},2:{v:"IBM",s:"4"},3:{v:"1",s:"5"},4:{v:"12",s:"5"},5:{v:"2",s:"5"},6:{v:"1",s:"5"},7:{v:"1",s:"5"},8:{v:"1",s:"5"}},10:{2:{v:"Google",s:"4"},3:{v:"26",s:"5"},4:{v:"33",s:"5"},5:{v:"33",s:"5"},6:{v:"6",s:"5"},7:{v:"22",s:"5"},8:{v:"8",s:"5"}}},mergeData:[{startRow:1,endRow:2,startColumn:1,endColumn:1},{startRow:1,endRow:2,startColumn:2,endColumn:2},{startRow:1,endRow:1,startColumn:3,endColumn:8},{startRow:3,endRow:5,startColumn:1,endColumn:1},{startRow:6,endRow:8,startColumn:1,endColumn:1},{startRow:9,endRow:10,startColumn:1,endColumn:1}],rowData:{0:{h:20}},columnData:{0:{w:20},2:{w:120}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:te.FALSE},columnTitle:{height:20,hidden:te.FALSE},selections:["A2"],rightToLeft:te.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]},Vi={unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Ct.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Ct.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Ct.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Ct.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Lt.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Ct.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Lt.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Ct.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Lt.ROMAN,hanging:21,indentStart:63}]}};ot.COLUMN,lt.PARAGRAPH,tn.WRAP_SQUARE,te.FALSE,Wn.BOTH_SIDES,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,un.SUPERSCRIPT,q.TEXT_RUN,q.TEXT_RUN,q.DRAWING,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.PARAGRAPH,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,q.TEXT_RUN,ze.SECTION_BREAK,ir.NONE,Gr.SECTION_TYPE_UNSPECIFIED;const QD={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:1484*.15,height:864*.15},positionH:{relativeFrom:ot.COLUMN,posOffset:130},positionV:{relativeFrom:lt.PAGE,posOffset:510},angle:0,imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/gartner-tech-2022.png"}},layoutType:tn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Wn.BOTH_SIDES},shapeTest2:{objectId:"shapeTest2",objectProperties:{title:"test shape",description:"test shape",size:{width:2548*.1,height:2343*.1},positionH:{relativeFrom:ot.COLUMN,posOffset:130},positionV:{relativeFrom:lt.PAGE,posOffset:200},angle:0,imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/hype-cycle-for-emerging-tech-2022.png"}},layoutType:tn.WRAP_SQUARE,behindDoc:te.FALSE,wrapText:Wn.BOTH_SIDES}},lists:Vi,body:{blockElements:{p1:{blockId:"p1",st:0,ed:66,blockType:ze.PARAGRAPH,paragraph:{elements:{e1:{eId:"e1",st:0,ed:66,et:q.TEXT_RUN,tr:{ct:"What\u2019s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:te.TRUE,fs:24,cl:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p2:{blockId:"p2",st:67,ed:251,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:67,ed:251,et:q.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:18,cl:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p3:{blockId:"p3",st:252,ed:401,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:252,ed:401,et:q.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p4:{blockId:"p4",st:402,ed:429,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:402,ed:429,et:q.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p5:{blockId:"p5",st:430,ed:479,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:430,ed:479,et:q.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p6:{blockId:"p6",st:480,ed:510,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:{e1:{eId:"e1",st:480,ed:510,et:q.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p7:{blockId:"p7",st:511,ed:705,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:511,ed:672,et:q.TEXT_RUN,tr:{ct:"These technologies are expected to greatly impact business and society over the next two to 10 years, but will especially enable CIOs and IT leaders to deliver on",ts:{fs:16}}},e2:{eId:"e2",st:673,ed:705,et:q.TEXT_RUN,tr:{ct:"digital business transformation. ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:te.TRUE}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN},{elementId:"e2",paragraphElementType:q.TEXT_RUN}]}},p8:{blockId:"p8",st:706,ed:762,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20},elements:{e1:{eId:"e1",st:706,ed:762,et:q.TEXT_RUN,tr:{ct:"Three Hype Cycle themes to think about in 2022 and beyond",ts:{fs:24,cl:{rgb:"rgb(255,255,255)"},bg:{rgb:"rgb(0,40,86)"}}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p9:{blockId:"p9",st:763,ed:1233,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:{e1:{eId:"e1",st:763,ed:1233,et:q.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle features emerging technologies and distills insights from more than 2,000 technologies into a succinct high-potential set. Most technologies have multiple use cases but enterprise architecture and technology innovation leaders should prioritize those with the greatest potential benefit for their organization. (They will also need to launch a proof-of-concept project to demonstrate the feasibility of a technology for their target use case.)",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:q.DRAWING}]}},oneSectionBreak:{blockId:"oneSectionBreak",st:0,ed:0,blockType:ze.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:ir.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED}},p10:{blockId:"p10",st:1206+28,ed:1548+28,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:1206+28,ed:1548+28,et:q.TEXT_RUN,tr:{ct:"The benefit of these technologies is that they provide individuals with more control over their identities and data, and expand their range of experiences into virtual venues and ecosystems that can be integrated with digital currencies. These technologies also provide new ways to reach customers to strengthen or open up new revenue streams.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p11:{blockId:"p11",st:1549+28,ed:1944+28,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:1549+28,ed:1944+28,et:q.TEXT_RUN,tr:{ct:"Digital twin of the customer (DToC) is a dynamic virtual representation of a customer that simulates and learns to emulate and anticipate behavior. It can be used to modify and enhance the customer experience (CX) and support new digitalization efforts, products, services and opportunities. DToC will take five to 10 years until mainstream adoption but will be transformational to organizations.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p12:{blockId:"p12",st:1945+28,ed:2019+28,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:{e1:{eId:"e1",st:1945+28,ed:2019+28,et:q.TEXT_RUN,tr:{ct:"Other critical technologies in immersive experiences include the following:",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN}]}},p13:{blockId:"p13",st:2020+28,ed:2250+28,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2020+28,ed:2042+28,et:q.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:te.TRUE}}},e2:{eId:"e2",st:2043+28,ed:2250+28,et:q.TEXT_RUN,tr:{ct:"(DCI) allows an entity (typically a human user) to control their own digital identity by leveraging technologies such as blockchain or other distributed ledger technologies (DLTs), along with digital wallets.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN},{elementId:"e2",paragraphElementType:q.TEXT_RUN}]}},p14:{blockId:"p14",st:2251+28,ed:2393+28,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2251+28,ed:2265+28,et:q.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:te.TRUE}}},e2:{eId:"e2",st:2266+28,ed:2393+28,et:q.TEXT_RUN,tr:{ct:"are interactive, AI-driven representations that have some of the characteristics, personality, knowledge and mindset of a human.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN},{elementId:"e2",paragraphElementType:q.TEXT_RUN}]}},p15:{blockId:"p15",st:2394+28,ed:2582+28,blockType:ze.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:{e1:{eId:"e1",st:2394+28,ed:2422+28,et:q.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 0)"},bl:te.TRUE}}},e2:{eId:"e2",st:2423+28,ed:2582+28,et:q.TEXT_RUN,tr:{ct:"match internal employees and, in some cases, a pool of contingent workers, to time-boxed projects and various work opportunities, with no recruiter involvement.",ts:{fs:16}}}},elementOrder:[{elementId:"e1",paragraphElementType:q.TEXT_RUN},{elementId:"e2",paragraphElementType:q.TEXT_RUN}]}},twoSectionBreak:{blockId:"twoSectionBreak",st:0,ed:0,blockType:ze.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:5}],columnSeparatorType:ir.NONE,sectionType:Gr.SECTION_TYPE_UNSPECIFIED}}},blockElementOrder:["p1","p2","p3","p4","p5","p6","p7","p8","p9","oneSectionBreak","p10","p11","p12","p13","p14","p15","twoSectionBreak"]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}};Jr.SLIDE,De.IMAGE,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.TEXT;Jr.SLIDE,De.IMAGE,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.SHAPE,Wt.RECTANGLE,De.SHAPE,Wt.RECTANGLE,De.SHAPE,Wt.RECTANGLE,De.SHAPE,Wt.RECTANGLE,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT;const ex={id:"detailContent1",zIndex:3,left:53,top:363,width:273,height:54,title:"detailContent1",description:"",type:De.TEXT,richText:{rich:{id:"d",lists:Vi,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"Digital Immune System",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:59,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"Applied Observability",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},tx={id:"detailContent2",zIndex:3,left:334,top:363,width:273,height:120,title:"detailContent2",description:"",type:De.TEXT,richText:{rich:{id:"d",lists:Vi,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"combine SaaS, PaaS and IaaS with tailored",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:59,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"provides a curated set of tools, capabilities and processes that are packaged for easy consumption by developers and end users",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},nx={id:"detailContent3",zIndex:3,left:652,top:363,width:273,height:130,title:"detailContent3",description:"",type:De.TEXT,richText:{rich:{id:"d",lists:Vi,body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:59,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"SuperApps are more than composite applications that aggregate services.",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:59,blockType:ze.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:q.TEXT_RUN,tr:{ct:"Adaptive AI allows for model behavior change post-deployment by using real-time feedback",ts:{fs:12}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:q.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph"]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}};Jr.SLIDE,De.SHAPE,Wt.RECTANGLE,117*.3,16*.3,De.IMAGE,De.TEXT,De.TEXT,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.TEXT,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.TEXT,De.SHAPE,Wt.RECTANGLE,De.TEXT,De.TEXT,De.TEXT,De.TEXT,De.TEXT;const rx=Rl.sheets[Rl.sheetOrder[0]],sx=Rl.styles;Jr.SLIDE,De.SHAPE,Wt.RECTANGLE,117*.3,16*.3,De.IMAGE,De.TEXT,De.TEXT,De.SPREADSHEET;Jr.SLIDE,De.SHAPE,Wt.RECTANGLE,117*.3,16*.3,De.IMAGE,De.TEXT,De.TEXT,De.IMAGE,De.IMAGE,De.IMAGE,De.IMAGE,De.TEXT,De.TEXT,De.TEXT,De.IMAGE,De.TEXT,De.IMAGE,De.TEXT,De.IMAGE,De.TEXT;Jr.SLIDE,De.SHAPE,Wt.RECTANGLE,117*.3,16*.3,De.IMAGE,De.TEXT,De.TEXT,De.DOCUMENT;var ix={},ox={};const ku="ClipboardPlugin",An=class{static async writeText(r,e){var t;if(An.clipboard)return An.clipboard.writeText(r).then(()=>!0,n=>console.dir(n));(t=e==null?void 0:e.clipboardData)==null||t.setData("text/html",r)}static async write(r,e){var t,n,s;if(An.clipboard){const i=new Blob([r.data],{type:(t=r.type)!=null?t:"text/html"}),o=[new ClipboardItem({"text/html":i})];return An.clipboard.write(o).then(()=>!0,()=>!1)}(s=e==null?void 0:e.clipboardData)==null||s.setData((n=r.type)!=null?n:"text/html",r.data)}static async readText(){return An.clipboard?An.clipboard.readText().then(r=>r,()=>null):An.textArea?new Promise((r,e)=>{r(An.textArea.value)}).then(r=>r).then(()=>null):null}static async read(r){if(An.clipboard){const s=await An.clipboard.read(),i=[];for(const o of s)for(const a of o.types){const l=await o.getType(a),u=new FileReader;a==="image/png"?u.readAsDataURL(l):u.readAsText(l);const c=new Promise((h,f)=>{u.onload=d=>{const m={type:a,result:u.result};h(m)}}).then(h=>h,()=>null);i.push(c)}return Promise.all(i)}const e=[],t=r==null?void 0:r.clipboardData,n=t==null?void 0:t.types;if(console.dir(n),!n)return null;for(let s=0;s<n.length;s++)e.push({type:n[s],result:t.getData(n[s])});return e}};let Pn=An;Pn.clipboard=window.navigator.clipboard;class Mh extends Xe{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender()}render(){const{prefix:e,placeholder1:t,suffix:n,placeholder2:s}=this.props,i=this._render.renderFunction("Input");return b("div",null,e,b(i,{type:"number",placeholder:t}),n||"\xD7",s?b(i,{type:"number",placeholder:s}):"")}}class ax{constructor(e,t,n){this._context=e;const s=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);this._initRegisterComponent(n),s==null||s.addRightMenu(t),this._context.getObserverManager().requiredObserver("onKeyCopyObservable","core").add(o=>{this.copy(o)})}getContext(){return this._context}copy(e){e.preventDefault()}_initRegisterComponent(e){const t=this._context.getPluginManager().getPluginByName(Je.SPREADSHEET);for(let n=0;n<e.length;n++)t.registerComponent(ku+e[n].name,e[n])}}class lx extends ax{constructor(e){const t=[{locale:["rightClick.copy"],onClick:()=>this.copyTo()},{customLabel:{name:li.name,props:{locale:"rightClick.copyAs"}},children:[{locale:["Json","rightClick.firstLineTitle"],onClick:()=>this.copyJsonHead()},{locale:["Json","rightClick.untitled"],onClick:()=>this.copyJsonNoHead()},{locale:["rightClick.array1"],onClick:()=>this.copyArray1()},{locale:["rightClick.array2"],onClick:()=>this.copyArray2()},{customLabel:{name:ku+Mh.name,props:{prefixLocale:"rightClick.array3",placeholder1Locale:"rightClick.row",suffixLocale:"rightClick.column",placeholder2Locale:"rightClick.column"}}}]}];super(e,t,[Mh])}_getSheetInfo(){const e=this.getContext().getWorkBook().getActiveSheet(),t=this.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET),n=t==null?void 0:t.getMainComponent(),s=t==null?void 0:t.getSelectionManager().getCurrentControls(),i=s==null?void 0:s.map(o=>{const a=o.model;return{startRow:a.startRow,startColumn:a.startColumn,endRow:a.endRow,endColumn:a.endColumn}});return{sheet:e,spreadsheet:n,selections:i}}_getRangeInfo(){const{sheet:e,selections:t}=this._getSheetInfo();if(!t.length)return;const n=e.getRange(t[0]),s=n.getValues();if(!!s.length)return{range:n,rangeData:s}}_getCopyContent(){const{sheet:e,spreadsheet:t,selections:n}=this._getSheetInfo();if(n.length>1)return;const s=e.getRowManager().getRowData(),i=e.getColumnManager().getColumnData();let o=[],a=[];for(let h=0;h<n.length;h++){let f=n[h],d=f.startRow,m=f.endRow,g=f.startColumn,p=f.endColumn;for(let _=d;_<=m;_++){const v=s.get(_);if(!(v&&v.hd)){o.includes(_)||o.push(_);for(let w=g;w<=p;w++){const y=i.get(w);y&&y.hd||a.includes(w)||a.push(w)}}}}let l="",u="";for(let h=0;h<o.length;h++){let f=o[h];l+="<tr>";for(let d=0;d<a.length;d++){let m=a[d],g=e.getRange(f,m).getValue(),p="",_="",v="";if(f===o[0]){const R=i.get(m);R&&R.w?`${R.w}`:u+='<colgroup width="72px"></colgroup>'}const w=s.get(f);w&&w.h?_+=`height:${w.h}px;`:_+="height:19px;";const y=i.get(m);if(y&&y.w?_+=`width:${y.w}px;`:_+="width:72px;",g&&g.s){const R=this.getContext().getWorkBook().getStyles().get(g.s);R&&(_+=ou(R))}const A=t==null?void 0:t.getCellByIndex(f,m);if((A==null?void 0:A.isMerged)||!(A!=null&&A.isMerged)&&(A==null?void 0:A.isMergedMainCell))if(A.isMergedMainCell)v=`rowSpan="${A.mergeInfo.endRow-A.mergeInfo.startRow+1}" colSpan="${A.mergeInfo.endColumn-A.mergeInfo.startColumn+1}"`;else continue;if(_.includes("data-rotate")){let R=_.split(";").find(N=>N.includes("data-rotate"));const x=R==null?void 0:R.match(/\d+/g);let S=0,k=0;x!=null&&x.length&&(S=+x[0],k=+x[1]),p+=`<td ${v} ${k?`data-vertical=${k}`:""} style="display:inline-block;transform: rotate(${S}deg);${_}">`}else p=`<td ${v} style="${_}">`;let I;g?g.p?I=zf(g.p):(I=e.getRange(f,m).getDisplayValue(),I==null&&(I="")):I="",p+=I,p+="</td>",l+=p}l+="</tr>"}return`<table data-type="universheet_copy_action_table">${u}${l}</table>`}async copy(e){const t=this._getCopyContent();t&&Pn.write({data:t},e)}async copyTo(...e){const t=this._getCopyContent();t&&await Pn.write({data:t})}async copyJsonHead(...e){var o,a,l;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let i=[];if(s.length===1){let u={};for(let c=0;c<s[0].length;c++){const h=(o=n.getValues()[0][c])==null?void 0:o.v;typeof h=="string"||typeof h=="number"?u[h]="":u[""]=""}i.push(u)}else for(let u=1;u<s.length;u++){let c={};for(let h=0;h<s[0].length;h++){const f=(a=n.getValues()[0][h])==null?void 0:a.v,d=(l=n.getValues()[u][h])==null?void 0:l.v;typeof f=="string"||typeof f=="number"?c[f]=d:c[""]=d}i.push(c)}await Pn.writeText(JSON.stringify(i))}async copyJsonNoHead(...e){var o;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let i=[];for(let a=0;a<s.length;a++){let l={};for(let u=0;u<s[0].length;u++){const c=(o=n.getValues()[a][u])==null?void 0:o.v;l[G.chatAtABC(u+n.getRangeData().startColumn)]=c}i.push(l)}await Pn.writeText(JSON.stringify(i))}async copyArray1(...e){var o;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let i=[];for(let a=0;a<s.length;a++)for(let l=0;l<s[0].length;l++){const u=(o=n.getValues()[a][l])==null?void 0:o.v;i.push(u)}await Pn.writeText(JSON.stringify(i))}async copyArray2(...e){var o;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let i=[];for(let a=0;a<s.length;a++)for(let l=0;l<s[0].length;l++){const u=(o=n.getValues()[a][l])==null?void 0:o.v;i.push(u)}await Pn.writeText(JSON.stringify(i))}async copyArrayMore(e){var d,m,g;if(e.key!=="Enter")return;const t=this._getRangeInfo();if(!t)return;const{range:n,rangeData:s}=t;let i=[];for(let p=0;p<s.length;p++)for(let _=0;_<s[0].length;_++)i.push(s[p][_]);let o="0",a="0";const l=e.target,u=(d=l==null?void 0:l.previousSibling)==null?void 0:d.textContent;if(!u)return;if(u.length>1?(o=l.value,a=((m=l.parentNode)==null?void 0:m.querySelectorAll("input")[1]).value):(a=l.value,o=((g=l.parentNode)==null?void 0:g.querySelectorAll("input")[0]).value),o===""&&a===""){await Pn.writeText(JSON.stringify(i));return}if(o===""?o="1":o=`${parseInt(o)}`,a===""?a="1":a=`${parseInt(a)}`,+o<1||+a<1)return;let c=i.length,h=0,f=[];for(let p=0;p<+o;p++){let _=[];for(let v=0;v<+a;v++)if(_.push(i[h++]),h>=c){await Pn.writeText(JSON.stringify(f));return}f.push(_)}await Pn.writeText(JSON.stringify(f))}}class ux{constructor(e,t){this._context=e,this._context.getPluginManager().getRequirePluginByName(Je.SPREADSHEET).addRightMenu(t)}getContext(){return this._context}paste(e){}}class cx extends ux{constructor(e){const t=[{locale:["rightClick.paste"],onClick:()=>{}}];super(e,t)}pasteTo(e){if(!e||(e==null?void 0:e.length)===0)return;const t=this.getContext().getWorkBook().getActiveSheet();if(!t)return;const n=this.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET);if(!n||!(n==null?void 0:n.getMainComponent()))return;const i=n==null?void 0:n.getSelectionManager().getCurrentControls(),o=i==null?void 0:i.map(_=>{const v=_.model;return{startRow:v.startRow,startColumn:v.startColumn,endRow:v.endRow,endColumn:v.endColumn}});if(!o.length||o.length>1)return;const a=o[0];let l=e.length,u=e[0].length,c=a.startRow,h=c+l-1,f=a.startColumn,d=f+u-1;if(t.getMerges().getByRowColumn(c,h,f,d))return;const g=w_(e,a),p=g.mergeData;for(let _=0;_<p.length;_++)t.getMerges().add(p[_]);t.getRange(c,f,h,d).setRangeDatas(g.data)}paste(e){this.pasteTo(e)}}class hx extends tu{execute(){const e=this._data.html||this._data.plain;let t;e&&(e.indexOf("<table")>-1&&e.indexOf("<td")>-1?t=C_(e):t=E_(e)),this._plugin.getUniverPaste().pasteTo(t)}}class dx extends Sf{get zIndex(){return 1}create(e){return new hx(e,this._plugin)}check(e){const t=e.html||e.plain;return t&&t.indexOf("<table")>-1&&t.indexOf("<td")>-1?this.create(e):!1}}class fx extends tu{execute(){}}class gx extends Sf{get zIndex(){return 2}create(e){return new fx(e,this._plugin)}check(e){return!1}}class Nu extends or{constructor(){super(ku),this._copyResolvers=[],this._pasteResolvers=[]}static create(){return new Nu}initialize(){this.registerExtension()}registerExtension(){const e=this.getContext().getPluginManager().getRequirePluginByName(Je.BASE_COMPONENT).getRegisterManager().getClipboardExtensionManager().getRegister();this._clipboardExtensionFactory=new dx(this),e.add(this._clipboardExtensionFactory),this._clipboardOfficeExtensionFactory=new gx(this),e.add(this._clipboardOfficeExtensionFactory)}installTo(e){e.installPlugin(this)}onDestroy(){const e=this.getContext().getPluginManager().getRequirePluginByName(Je.BASE_COMPONENT).getRegisterManager().getClipboardExtensionManager().getRegister();e.delete(this._clipboardExtensionFactory),e.delete(this._clipboardOfficeExtensionFactory)}onMounted(e){super.onMounted(e),e.getLocale().load({en:ox,zh:ix}),this._univerPaste=new cx(e),this.installCopyResolver({name:"univerCopy",resolver:new lx(e)}),this.initialize()}getUniverPaste(){return this._univerPaste}installCopyResolver(e){if(this._copyResolvers.findIndex(n=>n.name===e.name)>-1)return!1;this._copyResolvers.push(e)}}var mx={importXlsx:{tooltip:"\u5BFC\u5165",upload:"\u4E0A\u4F20XLSX"}},px={importXlsx:{tooltip:"Import",upload:"Upload XLSX"}};const m6="importXlsx";var p6={exports:{}};/*!

JSZip v3.10.1 - A JavaScript class for generating and reading zip files
<http://stuartk.com/jszip>

(c) 2009-2016 Stuart Knightley <stuart [at] stuartk.com>
Dual licenced under the MIT license or GPLv3. See https://raw.github.com/Stuk/jszip/main/LICENSE.markdown.

JSZip uses the library pako released under the MIT license :
https://github.com/nodeca/pako/blob/main/LICENSE
*/(function(r,e){(function(t){r.exports=t()})(function(){return function t(n,s,i){function o(u,c){if(!s[u]){if(!n[u]){var h=typeof Yi=="function"&&Yi;if(!c&&h)return h(u,!0);if(a)return a(u,!0);var f=new Error("Cannot find module '"+u+"'");throw f.code="MODULE_NOT_FOUND",f}var d=s[u]={exports:{}};n[u][0].call(d.exports,function(m){var g=n[u][1][m];return o(g||m)},d,d.exports,t,n,s,i)}return s[u].exports}for(var a=typeof Yi=="function"&&Yi,l=0;l<i.length;l++)o(i[l]);return o}({1:[function(t,n,s){var i=t("./utils"),o=t("./support"),a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var u,c,h,f,d,m,g,p=[],_=0,v=l.length,w=v,y=i.getTypeOf(l)!=="string";_<l.length;)w=v-_,h=y?(u=l[_++],c=_<v?l[_++]:0,_<v?l[_++]:0):(u=l.charCodeAt(_++),c=_<v?l.charCodeAt(_++):0,_<v?l.charCodeAt(_++):0),f=u>>2,d=(3&u)<<4|c>>4,m=1<w?(15&c)<<2|h>>6:64,g=2<w?63&h:64,p.push(a.charAt(f)+a.charAt(d)+a.charAt(m)+a.charAt(g));return p.join("")},s.decode=function(l){var u,c,h,f,d,m,g=0,p=0,_="data:";if(l.substr(0,_.length)===_)throw new Error("Invalid base64 input, it looks like a data url.");var v,w=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===a.charAt(64)&&w--,l.charAt(l.length-2)===a.charAt(64)&&w--,w%1!=0)throw new Error("Invalid base64 input, bad content length.");for(v=o.uint8array?new Uint8Array(0|w):new Array(0|w);g<l.length;)u=a.indexOf(l.charAt(g++))<<2|(f=a.indexOf(l.charAt(g++)))>>4,c=(15&f)<<4|(d=a.indexOf(l.charAt(g++)))>>2,h=(3&d)<<6|(m=a.indexOf(l.charAt(g++))),v[p++]=u,d!==64&&(v[p++]=c),m!==64&&(v[p++]=h);return v}},{"./support":30,"./utils":32}],2:[function(t,n,s){var i=t("./external"),o=t("./stream/DataWorker"),a=t("./stream/Crc32Probe"),l=t("./stream/DataLengthProbe");function u(c,h,f,d,m){this.compressedSize=c,this.uncompressedSize=h,this.crc32=f,this.compression=d,this.compressedContent=m}u.prototype={getContentWorker:function(){var c=new o(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),h=this;return c.on("end",function(){if(this.streamInfo.data_length!==h.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),c},getCompressedWorker:function(){return new o(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},u.createWorkerFrom=function(c,h,f){return c.pipe(new a).pipe(new l("uncompressedSize")).pipe(h.compressWorker(f)).pipe(new l("compressedSize")).withStreamInfo("compression",h)},n.exports=u},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(t,n,s){var i=t("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=t("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(t,n,s){var i=t("./utils"),o=function(){for(var a,l=[],u=0;u<256;u++){a=u;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;l[u]=a}return l}();n.exports=function(a,l){return a!==void 0&&a.length?i.getTypeOf(a)!=="string"?function(u,c,h,f){var d=o,m=f+h;u^=-1;for(var g=f;g<m;g++)u=u>>>8^d[255&(u^c[g])];return-1^u}(0|l,a,a.length,0):function(u,c,h,f){var d=o,m=f+h;u^=-1;for(var g=f;g<m;g++)u=u>>>8^d[255&(u^c.charCodeAt(g))];return-1^u}(0|l,a,a.length,0):0}},{"./utils":32}],5:[function(t,n,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(t,n,s){var i=null;i=typeof Promise!="undefined"?Promise:t("lie"),n.exports={Promise:i}},{lie:37}],7:[function(t,n,s){var i=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Uint32Array!="undefined",o=t("pako"),a=t("./utils"),l=t("./stream/GenericWorker"),u=i?"uint8array":"array";function c(h,f){l.call(this,"FlateWorker/"+h),this._pako=null,this._pakoAction=h,this._pakoOptions=f,this.meta={}}s.magic="\b\0",a.inherits(c,l),c.prototype.processChunk=function(h){this.meta=h.meta,this._pako===null&&this._createPako(),this._pako.push(a.transformTo(u,h.data),!1)},c.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},c.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},c.prototype._createPako=function(){this._pako=new o[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var h=this;this._pako.onData=function(f){h.push({data:f,meta:h.meta})}},s.compressWorker=function(h){return new c("Deflate",h)},s.uncompressWorker=function(){return new c("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(t,n,s){function i(d,m){var g,p="";for(g=0;g<m;g++)p+=String.fromCharCode(255&d),d>>>=8;return p}function o(d,m,g,p,_,v){var w,y,A=d.file,I=d.compression,R=v!==u.utf8encode,x=a.transformTo("string",v(A.name)),S=a.transformTo("string",u.utf8encode(A.name)),k=A.comment,N=a.transformTo("string",v(k)),O=a.transformTo("string",u.utf8encode(k)),D=S.length!==A.name.length,E=O.length!==k.length,F="",j="",L="",re=A.dir,Y=A.date,ee={crc32:0,compressedSize:0,uncompressedSize:0};m&&!g||(ee.crc32=d.crc32,ee.compressedSize=d.compressedSize,ee.uncompressedSize=d.uncompressedSize);var U=0;m&&(U|=8),R||!D&&!E||(U|=2048);var V=0,_e=0;re&&(V|=16),_==="UNIX"?(_e=798,V|=function(Z,le){var ve=Z;return Z||(ve=le?16893:33204),(65535&ve)<<16}(A.unixPermissions,re)):(_e=20,V|=function(Z){return 63&(Z||0)}(A.dosPermissions)),w=Y.getUTCHours(),w<<=6,w|=Y.getUTCMinutes(),w<<=5,w|=Y.getUTCSeconds()/2,y=Y.getUTCFullYear()-1980,y<<=4,y|=Y.getUTCMonth()+1,y<<=5,y|=Y.getUTCDate(),D&&(j=i(1,1)+i(c(x),4)+S,F+="up"+i(j.length,2)+j),E&&(L=i(1,1)+i(c(N),4)+O,F+="uc"+i(L.length,2)+L);var ie="";return ie+=`
\0`,ie+=i(U,2),ie+=I.magic,ie+=i(w,2),ie+=i(y,2),ie+=i(ee.crc32,4),ie+=i(ee.compressedSize,4),ie+=i(ee.uncompressedSize,4),ie+=i(x.length,2),ie+=i(F.length,2),{fileRecord:h.LOCAL_FILE_HEADER+ie+x+F,dirRecord:h.CENTRAL_FILE_HEADER+i(_e,2)+ie+i(N.length,2)+"\0\0\0\0"+i(V,4)+i(p,4)+x+F+N}}var a=t("../utils"),l=t("../stream/GenericWorker"),u=t("../utf8"),c=t("../crc32"),h=t("../signature");function f(d,m,g,p){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=m,this.zipPlatform=g,this.encodeFileName=p,this.streamFiles=d,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}a.inherits(f,l),f.prototype.push=function(d){var m=d.meta.percent||0,g=this.entriesCount,p=this._sources.length;this.accumulate?this.contentBuffer.push(d):(this.bytesWritten+=d.data.length,l.prototype.push.call(this,{data:d.data,meta:{currentFile:this.currentFile,percent:g?(m+100*(g-p-1))/g:100}}))},f.prototype.openedSource=function(d){this.currentSourceOffset=this.bytesWritten,this.currentFile=d.file.name;var m=this.streamFiles&&!d.file.dir;if(m){var g=o(d,m,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:g.fileRecord,meta:{percent:0}})}else this.accumulate=!0},f.prototype.closedSource=function(d){this.accumulate=!1;var m=this.streamFiles&&!d.file.dir,g=o(d,m,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(g.dirRecord),m)this.push({data:function(p){return h.DATA_DESCRIPTOR+i(p.crc32,4)+i(p.compressedSize,4)+i(p.uncompressedSize,4)}(d),meta:{percent:100}});else for(this.push({data:g.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},f.prototype.flush=function(){for(var d=this.bytesWritten,m=0;m<this.dirRecords.length;m++)this.push({data:this.dirRecords[m],meta:{percent:100}});var g=this.bytesWritten-d,p=function(_,v,w,y,A){var I=a.transformTo("string",A(y));return h.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(_,2)+i(_,2)+i(v,4)+i(w,4)+i(I.length,2)+I}(this.dirRecords.length,g,d,this.zipComment,this.encodeFileName);this.push({data:p,meta:{percent:100}})},f.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},f.prototype.registerPrevious=function(d){this._sources.push(d);var m=this;return d.on("data",function(g){m.processChunk(g)}),d.on("end",function(){m.closedSource(m.previous.streamInfo),m._sources.length?m.prepareNextSource():m.end()}),d.on("error",function(g){m.error(g)}),this},f.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},f.prototype.error=function(d){var m=this._sources;if(!l.prototype.error.call(this,d))return!1;for(var g=0;g<m.length;g++)try{m[g].error(d)}catch{}return!0},f.prototype.lock=function(){l.prototype.lock.call(this);for(var d=this._sources,m=0;m<d.length;m++)d[m].lock()},n.exports=f},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(t,n,s){var i=t("../compressions"),o=t("./ZipFileWorker");s.generateWorker=function(a,l,u){var c=new o(l.streamFiles,u,l.platform,l.encodeFileName),h=0;try{a.forEach(function(f,d){h++;var m=function(v,w){var y=v||w,A=i[y];if(!A)throw new Error(y+" is not a valid compression method !");return A}(d.options.compression,l.compression),g=d.options.compressionOptions||l.compressionOptions||{},p=d.dir,_=d.date;d._compressWorker(m,g).withStreamInfo("file",{name:f,dir:p,date:_,comment:d.comment||"",unixPermissions:d.unixPermissions,dosPermissions:d.dosPermissions}).pipe(c)}),c.entriesCount=h}catch(f){c.error(f)}return c}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(t,n,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var o=new i;for(var a in this)typeof this[a]!="function"&&(o[a]=this[a]);return o}}(i.prototype=t("./object")).loadAsync=t("./load"),i.support=t("./support"),i.defaults=t("./defaults"),i.version="3.10.1",i.loadAsync=function(o,a){return new i().loadAsync(o,a)},i.external=t("./external"),n.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(t,n,s){var i=t("./utils"),o=t("./external"),a=t("./utf8"),l=t("./zipEntries"),u=t("./stream/Crc32Probe"),c=t("./nodejsUtils");function h(f){return new o.Promise(function(d,m){var g=f.decompressed.getContentWorker().pipe(new u);g.on("error",function(p){m(p)}).on("end",function(){g.streamInfo.crc32!==f.decompressed.crc32?m(new Error("Corrupted zip : CRC32 mismatch")):d()}).resume()})}n.exports=function(f,d){var m=this;return d=i.extend(d||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:a.utf8decode}),c.isNode&&c.isStream(f)?o.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",f,!0,d.optimizedBinaryString,d.base64).then(function(g){var p=new l(d);return p.load(g),p}).then(function(g){var p=[o.Promise.resolve(g)],_=g.files;if(d.checkCRC32)for(var v=0;v<_.length;v++)p.push(h(_[v]));return o.Promise.all(p)}).then(function(g){for(var p=g.shift(),_=p.files,v=0;v<_.length;v++){var w=_[v],y=w.fileNameStr,A=i.resolve(w.fileNameStr);m.file(A,w.decompressed,{binary:!0,optimizedBinaryString:!0,date:w.date,dir:w.dir,comment:w.fileCommentStr.length?w.fileCommentStr:null,unixPermissions:w.unixPermissions,dosPermissions:w.dosPermissions,createFolders:d.createFolders}),w.dir||(m.file(A).unsafeOriginalName=y)}return p.zipComment.length&&(m.comment=p.zipComment),m})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(t,n,s){var i=t("../utils"),o=t("../stream/GenericWorker");function a(l,u){o.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(u)}i.inherits(a,o),a.prototype._bindStream=function(l){var u=this;(this._stream=l).pause(),l.on("data",function(c){u.push({data:c,meta:{percent:0}})}).on("error",function(c){u.isPaused?this.generatedError=c:u.error(c)}).on("end",function(){u.isPaused?u._upstreamEnded=!0:u.end()})},a.prototype.pause=function(){return!!o.prototype.pause.call(this)&&(this._stream.pause(),!0)},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},n.exports=a},{"../stream/GenericWorker":28,"../utils":32}],13:[function(t,n,s){var i=t("readable-stream").Readable;function o(a,l,u){i.call(this,l),this._helper=a;var c=this;a.on("data",function(h,f){c.push(h)||c._helper.pause(),u&&u(f)}).on("error",function(h){c.emit("error",h)}).on("end",function(){c.push(null)})}t("../utils").inherits(o,i),o.prototype._read=function(){this._helper.resume()},n.exports=o},{"../utils":32,"readable-stream":16}],14:[function(t,n,s){n.exports={isNode:typeof Buffer!="undefined",newBufferFrom:function(i,o){if(Buffer.from&&Buffer.from!==Uint8Array.from)return Buffer.from(i,o);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new Buffer(i,o)},allocBuffer:function(i){if(Buffer.alloc)return Buffer.alloc(i);var o=new Buffer(i);return o.fill(0),o},isBuffer:function(i){return Buffer.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(t,n,s){function i(A,I,R){var x,S=a.getTypeOf(I),k=a.extend(R||{},c);k.date=k.date||new Date,k.compression!==null&&(k.compression=k.compression.toUpperCase()),typeof k.unixPermissions=="string"&&(k.unixPermissions=parseInt(k.unixPermissions,8)),k.unixPermissions&&16384&k.unixPermissions&&(k.dir=!0),k.dosPermissions&&16&k.dosPermissions&&(k.dir=!0),k.dir&&(A=_(A)),k.createFolders&&(x=p(A))&&v.call(this,x,!0);var N=S==="string"&&k.binary===!1&&k.base64===!1;R&&R.binary!==void 0||(k.binary=!N),(I instanceof h&&I.uncompressedSize===0||k.dir||!I||I.length===0)&&(k.base64=!1,k.binary=!0,I="",k.compression="STORE",S="string");var O=null;O=I instanceof h||I instanceof l?I:m.isNode&&m.isStream(I)?new g(A,I):a.prepareContent(A,I,k.binary,k.optimizedBinaryString,k.base64);var D=new f(A,O,k);this.files[A]=D}var o=t("./utf8"),a=t("./utils"),l=t("./stream/GenericWorker"),u=t("./stream/StreamHelper"),c=t("./defaults"),h=t("./compressedObject"),f=t("./zipObject"),d=t("./generate"),m=t("./nodejsUtils"),g=t("./nodejs/NodejsStreamInputAdapter"),p=function(A){A.slice(-1)==="/"&&(A=A.substring(0,A.length-1));var I=A.lastIndexOf("/");return 0<I?A.substring(0,I):""},_=function(A){return A.slice(-1)!=="/"&&(A+="/"),A},v=function(A,I){return I=I!==void 0?I:c.createFolders,A=_(A),this.files[A]||i.call(this,A,null,{dir:!0,createFolders:I}),this.files[A]};function w(A){return Object.prototype.toString.call(A)==="[object RegExp]"}var y={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(A){var I,R,x;for(I in this.files)x=this.files[I],(R=I.slice(this.root.length,I.length))&&I.slice(0,this.root.length)===this.root&&A(R,x)},filter:function(A){var I=[];return this.forEach(function(R,x){A(R,x)&&I.push(x)}),I},file:function(A,I,R){if(arguments.length!==1)return A=this.root+A,i.call(this,A,I,R),this;if(w(A)){var x=A;return this.filter(function(k,N){return!N.dir&&x.test(k)})}var S=this.files[this.root+A];return S&&!S.dir?S:null},folder:function(A){if(!A)return this;if(w(A))return this.filter(function(S,k){return k.dir&&A.test(S)});var I=this.root+A,R=v.call(this,I),x=this.clone();return x.root=R.name,x},remove:function(A){A=this.root+A;var I=this.files[A];if(I||(A.slice(-1)!=="/"&&(A+="/"),I=this.files[A]),I&&!I.dir)delete this.files[A];else for(var R=this.filter(function(S,k){return k.name.slice(0,A.length)===A}),x=0;x<R.length;x++)delete this.files[R[x].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(A){var I,R={};try{if((R=a.extend(A||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:o.utf8encode})).type=R.type.toLowerCase(),R.compression=R.compression.toUpperCase(),R.type==="binarystring"&&(R.type="string"),!R.type)throw new Error("No output type specified.");a.checkSupport(R.type),R.platform!=="darwin"&&R.platform!=="freebsd"&&R.platform!=="linux"&&R.platform!=="sunos"||(R.platform="UNIX"),R.platform==="win32"&&(R.platform="DOS");var x=R.comment||this.comment||"";I=d.generateWorker(this,R,x)}catch(S){(I=new l("error")).error(S)}return new u(I,R.type||"string",R.mimeType)},generateAsync:function(A,I){return this.generateInternalStream(A).accumulate(I)},generateNodeStream:function(A,I){return(A=A||{}).type||(A.type="nodebuffer"),this.generateInternalStream(A).toNodejsStream(I)}};n.exports=y},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(t,n,s){n.exports=t("stream")},{stream:void 0}],17:[function(t,n,s){var i=t("./DataReader");function o(a){i.call(this,a);for(var l=0;l<this.data.length;l++)a[l]=255&a[l]}t("../utils").inherits(o,i),o.prototype.byteAt=function(a){return this.data[this.zero+a]},o.prototype.lastIndexOfSignature=function(a){for(var l=a.charCodeAt(0),u=a.charCodeAt(1),c=a.charCodeAt(2),h=a.charCodeAt(3),f=this.length-4;0<=f;--f)if(this.data[f]===l&&this.data[f+1]===u&&this.data[f+2]===c&&this.data[f+3]===h)return f-this.zero;return-1},o.prototype.readAndCheckSignature=function(a){var l=a.charCodeAt(0),u=a.charCodeAt(1),c=a.charCodeAt(2),h=a.charCodeAt(3),f=this.readData(4);return l===f[0]&&u===f[1]&&c===f[2]&&h===f[3]},o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],18:[function(t,n,s){var i=t("../utils");function o(a){this.data=a,this.length=a.length,this.index=0,this.zero=0}o.prototype={checkOffset:function(a){this.checkIndex(this.index+a)},checkIndex:function(a){if(this.length<this.zero+a||a<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+a+"). Corrupted zip ?")},setIndex:function(a){this.checkIndex(a),this.index=a},skip:function(a){this.setIndex(this.index+a)},byteAt:function(){},readInt:function(a){var l,u=0;for(this.checkOffset(a),l=this.index+a-1;l>=this.index;l--)u=(u<<8)+this.byteAt(l);return this.index+=a,u},readString:function(a){return i.transformTo("string",this.readData(a))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var a=this.readInt(4);return new Date(Date.UTC(1980+(a>>25&127),(a>>21&15)-1,a>>16&31,a>>11&31,a>>5&63,(31&a)<<1))}},n.exports=o},{"../utils":32}],19:[function(t,n,s){var i=t("./Uint8ArrayReader");function o(a){i.call(this,a)}t("../utils").inherits(o,i),o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(t,n,s){var i=t("./DataReader");function o(a){i.call(this,a)}t("../utils").inherits(o,i),o.prototype.byteAt=function(a){return this.data.charCodeAt(this.zero+a)},o.prototype.lastIndexOfSignature=function(a){return this.data.lastIndexOf(a)-this.zero},o.prototype.readAndCheckSignature=function(a){return a===this.readData(4)},o.prototype.readData=function(a){this.checkOffset(a);var l=this.data.slice(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./DataReader":18}],21:[function(t,n,s){var i=t("./ArrayReader");function o(a){i.call(this,a)}t("../utils").inherits(o,i),o.prototype.readData=function(a){if(this.checkOffset(a),a===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+a);return this.index+=a,l},n.exports=o},{"../utils":32,"./ArrayReader":17}],22:[function(t,n,s){var i=t("../utils"),o=t("../support"),a=t("./ArrayReader"),l=t("./StringReader"),u=t("./NodeBufferReader"),c=t("./Uint8ArrayReader");n.exports=function(h){var f=i.getTypeOf(h);return i.checkSupport(f),f!=="string"||o.uint8array?f==="nodebuffer"?new u(h):o.uint8array?new c(i.transformTo("uint8array",h)):new a(i.transformTo("array",h)):new l(h)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(t,n,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(t,n,s){var i=t("./GenericWorker"),o=t("../utils");function a(l){i.call(this,"ConvertWorker to "+l),this.destType=l}o.inherits(a,i),a.prototype.processChunk=function(l){this.push({data:o.transformTo(this.destType,l.data),meta:l.meta})},n.exports=a},{"../utils":32,"./GenericWorker":28}],25:[function(t,n,s){var i=t("./GenericWorker"),o=t("../crc32");function a(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}t("../utils").inherits(a,i),a.prototype.processChunk=function(l){this.streamInfo.crc32=o(l.data,this.streamInfo.crc32||0),this.push(l)},n.exports=a},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(t,n,s){var i=t("../utils"),o=t("./GenericWorker");function a(l){o.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(a,o),a.prototype.processChunk=function(l){if(l){var u=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=u+l.data.length}o.prototype.processChunk.call(this,l)},n.exports=a},{"../utils":32,"./GenericWorker":28}],27:[function(t,n,s){var i=t("../utils"),o=t("./GenericWorker");function a(l){o.call(this,"DataWorker");var u=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(c){u.dataIsReady=!0,u.data=c,u.max=c&&c.length||0,u.type=i.getTypeOf(c),u.isPaused||u._tickAndRepeat()},function(c){u.error(c)})}i.inherits(a,o),a.prototype.cleanUp=function(){o.prototype.cleanUp.call(this),this.data=null},a.prototype.resume=function(){return!!o.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},a.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},a.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,u=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,u);break;case"uint8array":l=this.data.subarray(this.index,u);break;case"array":case"nodebuffer":l=this.data.slice(this.index,u)}return this.index=u,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},n.exports=a},{"../utils":32,"./GenericWorker":28}],28:[function(t,n,s){function i(o){this.name=o||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(o){this.emit("data",o)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(o){this.emit("error",o)}return!0},error:function(o){return!this.isFinished&&(this.isPaused?this.generatedError=o:(this.isFinished=!0,this.emit("error",o),this.previous&&this.previous.error(o),this.cleanUp()),!0)},on:function(o,a){return this._listeners[o].push(a),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(o,a){if(this._listeners[o])for(var l=0;l<this._listeners[o].length;l++)this._listeners[o][l].call(this,a)},pipe:function(o){return o.registerPrevious(this)},registerPrevious:function(o){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=o.streamInfo,this.mergeStreamInfo(),this.previous=o;var a=this;return o.on("data",function(l){a.processChunk(l)}),o.on("end",function(){a.end()}),o.on("error",function(l){a.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var o=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),o=!0),this.previous&&this.previous.resume(),!o},flush:function(){},processChunk:function(o){this.push(o)},withStreamInfo:function(o,a){return this.extraStreamInfo[o]=a,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var o in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,o)&&(this.streamInfo[o]=this.extraStreamInfo[o])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var o="Worker "+this.name;return this.previous?this.previous+" -> "+o:o}},n.exports=i},{}],29:[function(t,n,s){var i=t("../utils"),o=t("./ConvertWorker"),a=t("./GenericWorker"),l=t("../base64"),u=t("../support"),c=t("../external"),h=null;if(u.nodestream)try{h=t("../nodejs/NodejsStreamOutputAdapter")}catch{}function f(m,g){return new c.Promise(function(p,_){var v=[],w=m._internalType,y=m._outputType,A=m._mimeType;m.on("data",function(I,R){v.push(I),g&&g(R)}).on("error",function(I){v=[],_(I)}).on("end",function(){try{var I=function(R,x,S){switch(R){case"blob":return i.newBlob(i.transformTo("arraybuffer",x),S);case"base64":return l.encode(x);default:return i.transformTo(R,x)}}(y,function(R,x){var S,k=0,N=null,O=0;for(S=0;S<x.length;S++)O+=x[S].length;switch(R){case"string":return x.join("");case"array":return Array.prototype.concat.apply([],x);case"uint8array":for(N=new Uint8Array(O),S=0;S<x.length;S++)N.set(x[S],k),k+=x[S].length;return N;case"nodebuffer":return Buffer.concat(x);default:throw new Error("concat : unsupported type '"+R+"'")}}(w,v),A);p(I)}catch(R){_(R)}v=[]}).resume()})}function d(m,g,p){var _=g;switch(g){case"blob":case"arraybuffer":_="uint8array";break;case"base64":_="string"}try{this._internalType=_,this._outputType=g,this._mimeType=p,i.checkSupport(_),this._worker=m.pipe(new o(_)),m.lock()}catch(v){this._worker=new a("error"),this._worker.error(v)}}d.prototype={accumulate:function(m){return f(this,m)},on:function(m,g){var p=this;return m==="data"?this._worker.on(m,function(_){g.call(p,_.data,_.meta)}):this._worker.on(m,function(){i.delay(g,arguments,p)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(m){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new h(this,{objectMode:this._outputType!=="nodebuffer"},m)}},n.exports=d},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(t,n,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer!="undefined"&&typeof Uint8Array!="undefined",s.nodebuffer=typeof Buffer!="undefined",s.uint8array=typeof Uint8Array!="undefined",typeof ArrayBuffer=="undefined")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var o=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);o.append(i),s.blob=o.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!t("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(t,n,s){for(var i=t("./utils"),o=t("./support"),a=t("./nodejsUtils"),l=t("./stream/GenericWorker"),u=new Array(256),c=0;c<256;c++)u[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;u[254]=u[254]=1;function h(){l.call(this,"utf-8 decode"),this.leftOver=null}function f(){l.call(this,"utf-8 encode")}s.utf8encode=function(d){return o.nodebuffer?a.newBufferFrom(d,"utf-8"):function(m){var g,p,_,v,w,y=m.length,A=0;for(v=0;v<y;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<y&&(64512&(_=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(_-56320),v++),A+=p<128?1:p<2048?2:p<65536?3:4;for(g=o.uint8array?new Uint8Array(A):new Array(A),v=w=0;w<A;v++)(64512&(p=m.charCodeAt(v)))==55296&&v+1<y&&(64512&(_=m.charCodeAt(v+1)))==56320&&(p=65536+(p-55296<<10)+(_-56320),v++),p<128?g[w++]=p:(p<2048?g[w++]=192|p>>>6:(p<65536?g[w++]=224|p>>>12:(g[w++]=240|p>>>18,g[w++]=128|p>>>12&63),g[w++]=128|p>>>6&63),g[w++]=128|63&p);return g}(d)},s.utf8decode=function(d){return o.nodebuffer?i.transformTo("nodebuffer",d).toString("utf-8"):function(m){var g,p,_,v,w=m.length,y=new Array(2*w);for(g=p=0;g<w;)if((_=m[g++])<128)y[p++]=_;else if(4<(v=u[_]))y[p++]=65533,g+=v-1;else{for(_&=v===2?31:v===3?15:7;1<v&&g<w;)_=_<<6|63&m[g++],v--;1<v?y[p++]=65533:_<65536?y[p++]=_:(_-=65536,y[p++]=55296|_>>10&1023,y[p++]=56320|1023&_)}return y.length!==p&&(y.subarray?y=y.subarray(0,p):y.length=p),i.applyFromCharCode(y)}(d=i.transformTo(o.uint8array?"uint8array":"array",d))},i.inherits(h,l),h.prototype.processChunk=function(d){var m=i.transformTo(o.uint8array?"uint8array":"array",d.data);if(this.leftOver&&this.leftOver.length){if(o.uint8array){var g=m;(m=new Uint8Array(g.length+this.leftOver.length)).set(this.leftOver,0),m.set(g,this.leftOver.length)}else m=this.leftOver.concat(m);this.leftOver=null}var p=function(v,w){var y;for((w=w||v.length)>v.length&&(w=v.length),y=w-1;0<=y&&(192&v[y])==128;)y--;return y<0||y===0?w:y+u[v[y]]>w?y:w}(m),_=m;p!==m.length&&(o.uint8array?(_=m.subarray(0,p),this.leftOver=m.subarray(p,m.length)):(_=m.slice(0,p),this.leftOver=m.slice(p,m.length))),this.push({data:s.utf8decode(_),meta:d.meta})},h.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=h,i.inherits(f,l),f.prototype.processChunk=function(d){this.push({data:s.utf8encode(d.data),meta:d.meta})},s.Utf8EncodeWorker=f},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(t,n,s){var i=t("./support"),o=t("./base64"),a=t("./nodejsUtils"),l=t("./external");function u(g){return g}function c(g,p){for(var _=0;_<g.length;++_)p[_]=255&g.charCodeAt(_);return p}t("setimmediate"),s.newBlob=function(g,p){s.checkSupport("blob");try{return new Blob([g],{type:p})}catch{try{var _=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return _.append(g),_.getBlob(p)}catch{throw new Error("Bug : can't construct the Blob.")}}};var h={stringifyByChunk:function(g,p,_){var v=[],w=0,y=g.length;if(y<=_)return String.fromCharCode.apply(null,g);for(;w<y;)p==="array"||p==="nodebuffer"?v.push(String.fromCharCode.apply(null,g.slice(w,Math.min(w+_,y)))):v.push(String.fromCharCode.apply(null,g.subarray(w,Math.min(w+_,y)))),w+=_;return v.join("")},stringifyByChar:function(g){for(var p="",_=0;_<g.length;_++)p+=String.fromCharCode(g[_]);return p},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,a.allocBuffer(1)).length===1}catch{return!1}}()}};function f(g){var p=65536,_=s.getTypeOf(g),v=!0;if(_==="uint8array"?v=h.applyCanBeUsed.uint8array:_==="nodebuffer"&&(v=h.applyCanBeUsed.nodebuffer),v)for(;1<p;)try{return h.stringifyByChunk(g,_,p)}catch{p=Math.floor(p/2)}return h.stringifyByChar(g)}function d(g,p){for(var _=0;_<g.length;_++)p[_]=g[_];return p}s.applyFromCharCode=f;var m={};m.string={string:u,array:function(g){return c(g,new Array(g.length))},arraybuffer:function(g){return m.string.uint8array(g).buffer},uint8array:function(g){return c(g,new Uint8Array(g.length))},nodebuffer:function(g){return c(g,a.allocBuffer(g.length))}},m.array={string:f,array:u,arraybuffer:function(g){return new Uint8Array(g).buffer},uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(g)}},m.arraybuffer={string:function(g){return f(new Uint8Array(g))},array:function(g){return d(new Uint8Array(g),new Array(g.byteLength))},arraybuffer:u,uint8array:function(g){return new Uint8Array(g)},nodebuffer:function(g){return a.newBufferFrom(new Uint8Array(g))}},m.uint8array={string:f,array:function(g){return d(g,new Array(g.length))},arraybuffer:function(g){return g.buffer},uint8array:u,nodebuffer:function(g){return a.newBufferFrom(g)}},m.nodebuffer={string:f,array:function(g){return d(g,new Array(g.length))},arraybuffer:function(g){return m.nodebuffer.uint8array(g).buffer},uint8array:function(g){return d(g,new Uint8Array(g.length))},nodebuffer:u},s.transformTo=function(g,p){if(p=p||"",!g)return p;s.checkSupport(g);var _=s.getTypeOf(p);return m[_][g](p)},s.resolve=function(g){for(var p=g.split("/"),_=[],v=0;v<p.length;v++){var w=p[v];w==="."||w===""&&v!==0&&v!==p.length-1||(w===".."?_.pop():_.push(w))}return _.join("/")},s.getTypeOf=function(g){return typeof g=="string"?"string":Object.prototype.toString.call(g)==="[object Array]"?"array":i.nodebuffer&&a.isBuffer(g)?"nodebuffer":i.uint8array&&g instanceof Uint8Array?"uint8array":i.arraybuffer&&g instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(g){if(!i[g.toLowerCase()])throw new Error(g+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(g){var p,_,v="";for(_=0;_<(g||"").length;_++)v+="\\x"+((p=g.charCodeAt(_))<16?"0":"")+p.toString(16).toUpperCase();return v},s.delay=function(g,p,_){setImmediate(function(){g.apply(_||null,p||[])})},s.inherits=function(g,p){function _(){}_.prototype=p.prototype,g.prototype=new _},s.extend=function(){var g,p,_={};for(g=0;g<arguments.length;g++)for(p in arguments[g])Object.prototype.hasOwnProperty.call(arguments[g],p)&&_[p]===void 0&&(_[p]=arguments[g][p]);return _},s.prepareContent=function(g,p,_,v,w){return l.Promise.resolve(p).then(function(y){return i.blob&&(y instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(y))!==-1)&&typeof FileReader!="undefined"?new l.Promise(function(A,I){var R=new FileReader;R.onload=function(x){A(x.target.result)},R.onerror=function(x){I(x.target.error)},R.readAsArrayBuffer(y)}):y}).then(function(y){var A=s.getTypeOf(y);return A?(A==="arraybuffer"?y=s.transformTo("uint8array",y):A==="string"&&(w?y=o.decode(y):_&&v!==!0&&(y=function(I){return c(I,i.uint8array?new Uint8Array(I.length):new Array(I.length))}(y))),y):l.Promise.reject(new Error("Can't read the data of '"+g+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(t,n,s){var i=t("./reader/readerFor"),o=t("./utils"),a=t("./signature"),l=t("./zipEntry"),u=t("./support");function c(h){this.files=[],this.loadOptions=h}c.prototype={checkSignature:function(h){if(!this.reader.readAndCheckSignature(h)){this.reader.index-=4;var f=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+o.pretty(f)+", expected "+o.pretty(h)+")")}},isSignature:function(h,f){var d=this.reader.index;this.reader.setIndex(h);var m=this.reader.readString(4)===f;return this.reader.setIndex(d),m},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var h=this.reader.readData(this.zipCommentLength),f=u.uint8array?"uint8array":"array",d=o.transformTo(f,h);this.zipComment=this.loadOptions.decodeFileName(d)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var h,f,d,m=this.zip64EndOfCentralSize-44;0<m;)h=this.reader.readInt(2),f=this.reader.readInt(4),d=this.reader.readData(f),this.zip64ExtensibleData[h]={id:h,length:f,value:d}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var h,f;for(h=0;h<this.files.length;h++)f=this.files[h],this.reader.setIndex(f.localHeaderOffset),this.checkSignature(a.LOCAL_FILE_HEADER),f.readLocalPart(this.reader),f.handleUTF8(),f.processAttributes()},readCentralDir:function(){var h;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(a.CENTRAL_FILE_HEADER);)(h=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(h);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var h=this.reader.lastIndexOfSignature(a.CENTRAL_DIRECTORY_END);if(h<0)throw this.isSignature(0,a.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(h);var f=h;if(this.checkSignature(a.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===o.MAX_VALUE_16BITS||this.diskWithCentralDirStart===o.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===o.MAX_VALUE_16BITS||this.centralDirRecords===o.MAX_VALUE_16BITS||this.centralDirSize===o.MAX_VALUE_32BITS||this.centralDirOffset===o.MAX_VALUE_32BITS){if(this.zip64=!0,(h=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(h),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,a.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(a.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var d=this.centralDirOffset+this.centralDirSize;this.zip64&&(d+=20,d+=12+this.zip64EndOfCentralSize);var m=f-d;if(0<m)this.isSignature(f,a.CENTRAL_FILE_HEADER)||(this.reader.zero=m);else if(m<0)throw new Error("Corrupted zip: missing "+Math.abs(m)+" bytes.")},prepareReader:function(h){this.reader=i(h)},load:function(h){this.prepareReader(h),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},n.exports=c},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(t,n,s){var i=t("./reader/readerFor"),o=t("./utils"),a=t("./compressedObject"),l=t("./crc32"),u=t("./utf8"),c=t("./compressions"),h=t("./support");function f(d,m){this.options=d,this.loadOptions=m}f.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(d){var m,g;if(d.skip(22),this.fileNameLength=d.readInt(2),g=d.readInt(2),this.fileName=d.readData(this.fileNameLength),d.skip(g),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((m=function(p){for(var _ in c)if(Object.prototype.hasOwnProperty.call(c,_)&&c[_].magic===p)return c[_];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+o.pretty(this.compressionMethod)+" unknown (inner file : "+o.transformTo("string",this.fileName)+")");this.decompressed=new a(this.compressedSize,this.uncompressedSize,this.crc32,m,d.readData(this.compressedSize))},readCentralPart:function(d){this.versionMadeBy=d.readInt(2),d.skip(2),this.bitFlag=d.readInt(2),this.compressionMethod=d.readString(2),this.date=d.readDate(),this.crc32=d.readInt(4),this.compressedSize=d.readInt(4),this.uncompressedSize=d.readInt(4);var m=d.readInt(2);if(this.extraFieldsLength=d.readInt(2),this.fileCommentLength=d.readInt(2),this.diskNumberStart=d.readInt(2),this.internalFileAttributes=d.readInt(2),this.externalFileAttributes=d.readInt(4),this.localHeaderOffset=d.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");d.skip(m),this.readExtraFields(d),this.parseZIP64ExtraField(d),this.fileComment=d.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var d=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),d==0&&(this.dosPermissions=63&this.externalFileAttributes),d==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var d=i(this.extraFields[1].value);this.uncompressedSize===o.MAX_VALUE_32BITS&&(this.uncompressedSize=d.readInt(8)),this.compressedSize===o.MAX_VALUE_32BITS&&(this.compressedSize=d.readInt(8)),this.localHeaderOffset===o.MAX_VALUE_32BITS&&(this.localHeaderOffset=d.readInt(8)),this.diskNumberStart===o.MAX_VALUE_32BITS&&(this.diskNumberStart=d.readInt(4))}},readExtraFields:function(d){var m,g,p,_=d.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});d.index+4<_;)m=d.readInt(2),g=d.readInt(2),p=d.readData(g),this.extraFields[m]={id:m,length:g,value:p};d.setIndex(_)},handleUTF8:function(){var d=h.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=u.utf8decode(this.fileName),this.fileCommentStr=u.utf8decode(this.fileComment);else{var m=this.findExtraFieldUnicodePath();if(m!==null)this.fileNameStr=m;else{var g=o.transformTo(d,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(g)}var p=this.findExtraFieldUnicodeComment();if(p!==null)this.fileCommentStr=p;else{var _=o.transformTo(d,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(_)}}},findExtraFieldUnicodePath:function(){var d=this.extraFields[28789];if(d){var m=i(d.value);return m.readInt(1)!==1||l(this.fileName)!==m.readInt(4)?null:u.utf8decode(m.readData(d.length-5))}return null},findExtraFieldUnicodeComment:function(){var d=this.extraFields[25461];if(d){var m=i(d.value);return m.readInt(1)!==1||l(this.fileComment)!==m.readInt(4)?null:u.utf8decode(m.readData(d.length-5))}return null}},n.exports=f},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(t,n,s){function i(m,g,p){this.name=m,this.dir=p.dir,this.date=p.date,this.comment=p.comment,this.unixPermissions=p.unixPermissions,this.dosPermissions=p.dosPermissions,this._data=g,this._dataBinary=p.binary,this.options={compression:p.compression,compressionOptions:p.compressionOptions}}var o=t("./stream/StreamHelper"),a=t("./stream/DataWorker"),l=t("./utf8"),u=t("./compressedObject"),c=t("./stream/GenericWorker");i.prototype={internalStream:function(m){var g=null,p="string";try{if(!m)throw new Error("No output type specified.");var _=(p=m.toLowerCase())==="string"||p==="text";p!=="binarystring"&&p!=="text"||(p="string"),g=this._decompressWorker();var v=!this._dataBinary;v&&!_&&(g=g.pipe(new l.Utf8EncodeWorker)),!v&&_&&(g=g.pipe(new l.Utf8DecodeWorker))}catch(w){(g=new c("error")).error(w)}return new o(g,p,"")},async:function(m,g){return this.internalStream(m).accumulate(g)},nodeStream:function(m,g){return this.internalStream(m||"nodebuffer").toNodejsStream(g)},_compressWorker:function(m,g){if(this._data instanceof u&&this._data.compression.magic===m.magic)return this._data.getCompressedWorker();var p=this._decompressWorker();return this._dataBinary||(p=p.pipe(new l.Utf8EncodeWorker)),u.createWorkerFrom(p,m,g)},_decompressWorker:function(){return this._data instanceof u?this._data.getContentWorker():this._data instanceof c?this._data:new a(this._data)}};for(var h=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],f=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},d=0;d<h.length;d++)i.prototype[h[d]]=f;n.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(t,n,s){(function(i){var o,a,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var u=0,c=new l(m),h=i.document.createTextNode("");c.observe(h,{characterData:!0}),o=function(){h.data=u=++u%2}}else if(i.setImmediate||i.MessageChannel===void 0)o="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var g=i.document.createElement("script");g.onreadystatechange=function(){m(),g.onreadystatechange=null,g.parentNode.removeChild(g),g=null},i.document.documentElement.appendChild(g)}:function(){setTimeout(m,0)};else{var f=new i.MessageChannel;f.port1.onmessage=m,o=function(){f.port2.postMessage(0)}}var d=[];function m(){var g,p;a=!0;for(var _=d.length;_;){for(p=d,d=[],g=-1;++g<_;)p[g]();_=d.length}a=!1}n.exports=function(g){d.push(g)!==1||a||o()}}).call(this,typeof vr!="undefined"?vr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}],37:[function(t,n,s){var i=t("immediate");function o(){}var a={},l=["REJECTED"],u=["FULFILLED"],c=["PENDING"];function h(_){if(typeof _!="function")throw new TypeError("resolver must be a function");this.state=c,this.queue=[],this.outcome=void 0,_!==o&&g(this,_)}function f(_,v,w){this.promise=_,typeof v=="function"&&(this.onFulfilled=v,this.callFulfilled=this.otherCallFulfilled),typeof w=="function"&&(this.onRejected=w,this.callRejected=this.otherCallRejected)}function d(_,v,w){i(function(){var y;try{y=v(w)}catch(A){return a.reject(_,A)}y===_?a.reject(_,new TypeError("Cannot resolve promise with itself")):a.resolve(_,y)})}function m(_){var v=_&&_.then;if(_&&(typeof _=="object"||typeof _=="function")&&typeof v=="function")return function(){v.apply(_,arguments)}}function g(_,v){var w=!1;function y(R){w||(w=!0,a.reject(_,R))}function A(R){w||(w=!0,a.resolve(_,R))}var I=p(function(){v(A,y)});I.status==="error"&&y(I.value)}function p(_,v){var w={};try{w.value=_(v),w.status="success"}catch(y){w.status="error",w.value=y}return w}(n.exports=h).prototype.finally=function(_){if(typeof _!="function")return this;var v=this.constructor;return this.then(function(w){return v.resolve(_()).then(function(){return w})},function(w){return v.resolve(_()).then(function(){throw w})})},h.prototype.catch=function(_){return this.then(null,_)},h.prototype.then=function(_,v){if(typeof _!="function"&&this.state===u||typeof v!="function"&&this.state===l)return this;var w=new this.constructor(o);return this.state!==c?d(w,this.state===u?_:v,this.outcome):this.queue.push(new f(w,_,v)),w},f.prototype.callFulfilled=function(_){a.resolve(this.promise,_)},f.prototype.otherCallFulfilled=function(_){d(this.promise,this.onFulfilled,_)},f.prototype.callRejected=function(_){a.reject(this.promise,_)},f.prototype.otherCallRejected=function(_){d(this.promise,this.onRejected,_)},a.resolve=function(_,v){var w=p(m,v);if(w.status==="error")return a.reject(_,w.value);var y=w.value;if(y)g(_,y);else{_.state=u,_.outcome=v;for(var A=-1,I=_.queue.length;++A<I;)_.queue[A].callFulfilled(v)}return _},a.reject=function(_,v){_.state=l,_.outcome=v;for(var w=-1,y=_.queue.length;++w<y;)_.queue[w].callRejected(v);return _},h.resolve=function(_){return _ instanceof this?_:a.resolve(new this(o),_)},h.reject=function(_){var v=new this(o);return a.reject(v,_)},h.all=function(_){var v=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=_.length,y=!1;if(!w)return this.resolve([]);for(var A=new Array(w),I=0,R=-1,x=new this(o);++R<w;)S(_[R],R);return x;function S(k,N){v.resolve(k).then(function(O){A[N]=O,++I!==w||y||(y=!0,a.resolve(x,A))},function(O){y||(y=!0,a.reject(x,O))})}},h.race=function(_){var v=this;if(Object.prototype.toString.call(_)!=="[object Array]")return this.reject(new TypeError("must be an array"));var w=_.length,y=!1;if(!w)return this.resolve([]);for(var A=-1,I=new this(o);++A<w;)R=_[A],v.resolve(R).then(function(x){y||(y=!0,a.resolve(I,x))},function(x){y||(y=!0,a.reject(I,x))});var R;return I}},{immediate:36}],38:[function(t,n,s){var i={};(0,t("./lib/utils/common").assign)(i,t("./lib/deflate"),t("./lib/inflate"),t("./lib/zlib/constants")),n.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(t,n,s){var i=t("./zlib/deflate"),o=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/messages"),u=t("./zlib/zstream"),c=Object.prototype.toString,h=0,f=-1,d=0,m=8;function g(_){if(!(this instanceof g))return new g(_);this.options=o.assign({level:f,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:d,to:""},_||{});var v=this.options;v.raw&&0<v.windowBits?v.windowBits=-v.windowBits:v.gzip&&0<v.windowBits&&v.windowBits<16&&(v.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var w=i.deflateInit2(this.strm,v.level,v.method,v.windowBits,v.memLevel,v.strategy);if(w!==h)throw new Error(l[w]);if(v.header&&i.deflateSetHeader(this.strm,v.header),v.dictionary){var y;if(y=typeof v.dictionary=="string"?a.string2buf(v.dictionary):c.call(v.dictionary)==="[object ArrayBuffer]"?new Uint8Array(v.dictionary):v.dictionary,(w=i.deflateSetDictionary(this.strm,y))!==h)throw new Error(l[w]);this._dict_set=!0}}function p(_,v){var w=new g(v);if(w.push(_,!0),w.err)throw w.msg||l[w.err];return w.result}g.prototype.push=function(_,v){var w,y,A=this.strm,I=this.options.chunkSize;if(this.ended)return!1;y=v===~~v?v:v===!0?4:0,typeof _=="string"?A.input=a.string2buf(_):c.call(_)==="[object ArrayBuffer]"?A.input=new Uint8Array(_):A.input=_,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new o.Buf8(I),A.next_out=0,A.avail_out=I),(w=i.deflate(A,y))!==1&&w!==h)return this.onEnd(w),!(this.ended=!0);A.avail_out!==0&&(A.avail_in!==0||y!==4&&y!==2)||(this.options.to==="string"?this.onData(a.buf2binstring(o.shrinkBuf(A.output,A.next_out))):this.onData(o.shrinkBuf(A.output,A.next_out)))}while((0<A.avail_in||A.avail_out===0)&&w!==1);return y===4?(w=i.deflateEnd(this.strm),this.onEnd(w),this.ended=!0,w===h):y!==2||(this.onEnd(h),!(A.avail_out=0))},g.prototype.onData=function(_){this.chunks.push(_)},g.prototype.onEnd=function(_){_===h&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=_,this.msg=this.strm.msg},s.Deflate=g,s.deflate=p,s.deflateRaw=function(_,v){return(v=v||{}).raw=!0,p(_,v)},s.gzip=function(_,v){return(v=v||{}).gzip=!0,p(_,v)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(t,n,s){var i=t("./zlib/inflate"),o=t("./utils/common"),a=t("./utils/strings"),l=t("./zlib/constants"),u=t("./zlib/messages"),c=t("./zlib/zstream"),h=t("./zlib/gzheader"),f=Object.prototype.toString;function d(g){if(!(this instanceof d))return new d(g);this.options=o.assign({chunkSize:16384,windowBits:0,to:""},g||{});var p=this.options;p.raw&&0<=p.windowBits&&p.windowBits<16&&(p.windowBits=-p.windowBits,p.windowBits===0&&(p.windowBits=-15)),!(0<=p.windowBits&&p.windowBits<16)||g&&g.windowBits||(p.windowBits+=32),15<p.windowBits&&p.windowBits<48&&(15&p.windowBits)==0&&(p.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var _=i.inflateInit2(this.strm,p.windowBits);if(_!==l.Z_OK)throw new Error(u[_]);this.header=new h,i.inflateGetHeader(this.strm,this.header)}function m(g,p){var _=new d(p);if(_.push(g,!0),_.err)throw _.msg||u[_.err];return _.result}d.prototype.push=function(g,p){var _,v,w,y,A,I,R=this.strm,x=this.options.chunkSize,S=this.options.dictionary,k=!1;if(this.ended)return!1;v=p===~~p?p:p===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof g=="string"?R.input=a.binstring2buf(g):f.call(g)==="[object ArrayBuffer]"?R.input=new Uint8Array(g):R.input=g,R.next_in=0,R.avail_in=R.input.length;do{if(R.avail_out===0&&(R.output=new o.Buf8(x),R.next_out=0,R.avail_out=x),(_=i.inflate(R,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&S&&(I=typeof S=="string"?a.string2buf(S):f.call(S)==="[object ArrayBuffer]"?new Uint8Array(S):S,_=i.inflateSetDictionary(this.strm,I)),_===l.Z_BUF_ERROR&&k===!0&&(_=l.Z_OK,k=!1),_!==l.Z_STREAM_END&&_!==l.Z_OK)return this.onEnd(_),!(this.ended=!0);R.next_out&&(R.avail_out!==0&&_!==l.Z_STREAM_END&&(R.avail_in!==0||v!==l.Z_FINISH&&v!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(w=a.utf8border(R.output,R.next_out),y=R.next_out-w,A=a.buf2string(R.output,w),R.next_out=y,R.avail_out=x-y,y&&o.arraySet(R.output,R.output,w,y,0),this.onData(A)):this.onData(o.shrinkBuf(R.output,R.next_out)))),R.avail_in===0&&R.avail_out===0&&(k=!0)}while((0<R.avail_in||R.avail_out===0)&&_!==l.Z_STREAM_END);return _===l.Z_STREAM_END&&(v=l.Z_FINISH),v===l.Z_FINISH?(_=i.inflateEnd(this.strm),this.onEnd(_),this.ended=!0,_===l.Z_OK):v!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(R.avail_out=0))},d.prototype.onData=function(g){this.chunks.push(g)},d.prototype.onEnd=function(g){g===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=o.flattenChunks(this.chunks)),this.chunks=[],this.err=g,this.msg=this.strm.msg},s.Inflate=d,s.inflate=m,s.inflateRaw=function(g,p){return(p=p||{}).raw=!0,m(g,p)},s.ungzip=m},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(t,n,s){var i=typeof Uint8Array!="undefined"&&typeof Uint16Array!="undefined"&&typeof Int32Array!="undefined";s.assign=function(l){for(var u=Array.prototype.slice.call(arguments,1);u.length;){var c=u.shift();if(c){if(typeof c!="object")throw new TypeError(c+"must be non-object");for(var h in c)c.hasOwnProperty(h)&&(l[h]=c[h])}}return l},s.shrinkBuf=function(l,u){return l.length===u?l:l.subarray?l.subarray(0,u):(l.length=u,l)};var o={arraySet:function(l,u,c,h,f){if(u.subarray&&l.subarray)l.set(u.subarray(c,c+h),f);else for(var d=0;d<h;d++)l[f+d]=u[c+d]},flattenChunks:function(l){var u,c,h,f,d,m;for(u=h=0,c=l.length;u<c;u++)h+=l[u].length;for(m=new Uint8Array(h),u=f=0,c=l.length;u<c;u++)d=l[u],m.set(d,f),f+=d.length;return m}},a={arraySet:function(l,u,c,h,f){for(var d=0;d<h;d++)l[f+d]=u[c+d]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,o)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,a))},s.setTyped(i)},{}],42:[function(t,n,s){var i=t("./common"),o=!0,a=!0;try{String.fromCharCode.apply(null,[0])}catch{o=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{a=!1}for(var l=new i.Buf8(256),u=0;u<256;u++)l[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;function c(h,f){if(f<65537&&(h.subarray&&a||!h.subarray&&o))return String.fromCharCode.apply(null,i.shrinkBuf(h,f));for(var d="",m=0;m<f;m++)d+=String.fromCharCode(h[m]);return d}l[254]=l[254]=1,s.string2buf=function(h){var f,d,m,g,p,_=h.length,v=0;for(g=0;g<_;g++)(64512&(d=h.charCodeAt(g)))==55296&&g+1<_&&(64512&(m=h.charCodeAt(g+1)))==56320&&(d=65536+(d-55296<<10)+(m-56320),g++),v+=d<128?1:d<2048?2:d<65536?3:4;for(f=new i.Buf8(v),g=p=0;p<v;g++)(64512&(d=h.charCodeAt(g)))==55296&&g+1<_&&(64512&(m=h.charCodeAt(g+1)))==56320&&(d=65536+(d-55296<<10)+(m-56320),g++),d<128?f[p++]=d:(d<2048?f[p++]=192|d>>>6:(d<65536?f[p++]=224|d>>>12:(f[p++]=240|d>>>18,f[p++]=128|d>>>12&63),f[p++]=128|d>>>6&63),f[p++]=128|63&d);return f},s.buf2binstring=function(h){return c(h,h.length)},s.binstring2buf=function(h){for(var f=new i.Buf8(h.length),d=0,m=f.length;d<m;d++)f[d]=h.charCodeAt(d);return f},s.buf2string=function(h,f){var d,m,g,p,_=f||h.length,v=new Array(2*_);for(d=m=0;d<_;)if((g=h[d++])<128)v[m++]=g;else if(4<(p=l[g]))v[m++]=65533,d+=p-1;else{for(g&=p===2?31:p===3?15:7;1<p&&d<_;)g=g<<6|63&h[d++],p--;1<p?v[m++]=65533:g<65536?v[m++]=g:(g-=65536,v[m++]=55296|g>>10&1023,v[m++]=56320|1023&g)}return c(v,m)},s.utf8border=function(h,f){var d;for((f=f||h.length)>h.length&&(f=h.length),d=f-1;0<=d&&(192&h[d])==128;)d--;return d<0||d===0?f:d+l[h[d]]>f?d:f}},{"./common":41}],43:[function(t,n,s){n.exports=function(i,o,a,l){for(var u=65535&i|0,c=i>>>16&65535|0,h=0;a!==0;){for(a-=h=2e3<a?2e3:a;c=c+(u=u+o[l++]|0)|0,--h;);u%=65521,c%=65521}return u|c<<16|0}},{}],44:[function(t,n,s){n.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(t,n,s){var i=function(){for(var o,a=[],l=0;l<256;l++){o=l;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;a[l]=o}return a}();n.exports=function(o,a,l,u){var c=i,h=u+l;o^=-1;for(var f=u;f<h;f++)o=o>>>8^c[255&(o^a[f])];return-1^o}},{}],46:[function(t,n,s){var i,o=t("../utils/common"),a=t("./trees"),l=t("./adler32"),u=t("./crc32"),c=t("./messages"),h=0,f=4,d=0,m=-2,g=-1,p=4,_=2,v=8,w=9,y=286,A=30,I=19,R=2*y+1,x=15,S=3,k=258,N=k+S+1,O=42,D=113,E=1,F=2,j=3,L=4;function re(T,se){return T.msg=c[se],se}function Y(T){return(T<<1)-(4<T?9:0)}function ee(T){for(var se=T.length;0<=--se;)T[se]=0}function U(T){var se=T.state,ne=se.pending;ne>T.avail_out&&(ne=T.avail_out),ne!==0&&(o.arraySet(T.output,se.pending_buf,se.pending_out,ne,T.next_out),T.next_out+=ne,se.pending_out+=ne,T.total_out+=ne,T.avail_out-=ne,se.pending-=ne,se.pending===0&&(se.pending_out=0))}function V(T,se){a._tr_flush_block(T,0<=T.block_start?T.block_start:-1,T.strstart-T.block_start,se),T.block_start=T.strstart,U(T.strm)}function _e(T,se){T.pending_buf[T.pending++]=se}function ie(T,se){T.pending_buf[T.pending++]=se>>>8&255,T.pending_buf[T.pending++]=255&se}function Z(T,se){var ne,B,M=T.max_chain_length,X=T.strstart,ae=T.prev_length,oe=T.nice_match,$=T.strstart>T.w_size-N?T.strstart-(T.w_size-N):0,he=T.window,P=T.w_mask,z=T.prev,J=T.strstart+k,ue=he[X+ae-1],de=he[X+ae];T.prev_length>=T.good_match&&(M>>=2),oe>T.lookahead&&(oe=T.lookahead);do if(he[(ne=se)+ae]===de&&he[ne+ae-1]===ue&&he[ne]===he[X]&&he[++ne]===he[X+1]){X+=2,ne++;do;while(he[++X]===he[++ne]&&he[++X]===he[++ne]&&he[++X]===he[++ne]&&he[++X]===he[++ne]&&he[++X]===he[++ne]&&he[++X]===he[++ne]&&he[++X]===he[++ne]&&he[++X]===he[++ne]&&X<J);if(B=k-(J-X),X=J-k,ae<B){if(T.match_start=se,oe<=(ae=B))break;ue=he[X+ae-1],de=he[X+ae]}}while((se=z[se&P])>$&&--M!=0);return ae<=T.lookahead?ae:T.lookahead}function le(T){var se,ne,B,M,X,ae,oe,$,he,P,z=T.w_size;do{if(M=T.window_size-T.lookahead-T.strstart,T.strstart>=z+(z-N)){for(o.arraySet(T.window,T.window,z,z,0),T.match_start-=z,T.strstart-=z,T.block_start-=z,se=ne=T.hash_size;B=T.head[--se],T.head[se]=z<=B?B-z:0,--ne;);for(se=ne=z;B=T.prev[--se],T.prev[se]=z<=B?B-z:0,--ne;);M+=z}if(T.strm.avail_in===0)break;if(ae=T.strm,oe=T.window,$=T.strstart+T.lookahead,he=M,P=void 0,P=ae.avail_in,he<P&&(P=he),ne=P===0?0:(ae.avail_in-=P,o.arraySet(oe,ae.input,ae.next_in,P,$),ae.state.wrap===1?ae.adler=l(ae.adler,oe,P,$):ae.state.wrap===2&&(ae.adler=u(ae.adler,oe,P,$)),ae.next_in+=P,ae.total_in+=P,P),T.lookahead+=ne,T.lookahead+T.insert>=S)for(X=T.strstart-T.insert,T.ins_h=T.window[X],T.ins_h=(T.ins_h<<T.hash_shift^T.window[X+1])&T.hash_mask;T.insert&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[X+S-1])&T.hash_mask,T.prev[X&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=X,X++,T.insert--,!(T.lookahead+T.insert<S)););}while(T.lookahead<N&&T.strm.avail_in!==0)}function ve(T,se){for(var ne,B;;){if(T.lookahead<N){if(le(T),T.lookahead<N&&se===h)return E;if(T.lookahead===0)break}if(ne=0,T.lookahead>=S&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+S-1])&T.hash_mask,ne=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),ne!==0&&T.strstart-ne<=T.w_size-N&&(T.match_length=Z(T,ne)),T.match_length>=S)if(B=a._tr_tally(T,T.strstart-T.match_start,T.match_length-S),T.lookahead-=T.match_length,T.match_length<=T.max_lazy_match&&T.lookahead>=S){for(T.match_length--;T.strstart++,T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+S-1])&T.hash_mask,ne=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart,--T.match_length!=0;);T.strstart++}else T.strstart+=T.match_length,T.match_length=0,T.ins_h=T.window[T.strstart],T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+1])&T.hash_mask;else B=a._tr_tally(T,0,T.window[T.strstart]),T.lookahead--,T.strstart++;if(B&&(V(T,!1),T.strm.avail_out===0))return E}return T.insert=T.strstart<S-1?T.strstart:S-1,se===f?(V(T,!0),T.strm.avail_out===0?j:L):T.last_lit&&(V(T,!1),T.strm.avail_out===0)?E:F}function Ce(T,se){for(var ne,B,M;;){if(T.lookahead<N){if(le(T),T.lookahead<N&&se===h)return E;if(T.lookahead===0)break}if(ne=0,T.lookahead>=S&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+S-1])&T.hash_mask,ne=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),T.prev_length=T.match_length,T.prev_match=T.match_start,T.match_length=S-1,ne!==0&&T.prev_length<T.max_lazy_match&&T.strstart-ne<=T.w_size-N&&(T.match_length=Z(T,ne),T.match_length<=5&&(T.strategy===1||T.match_length===S&&4096<T.strstart-T.match_start)&&(T.match_length=S-1)),T.prev_length>=S&&T.match_length<=T.prev_length){for(M=T.strstart+T.lookahead-S,B=a._tr_tally(T,T.strstart-1-T.prev_match,T.prev_length-S),T.lookahead-=T.prev_length-1,T.prev_length-=2;++T.strstart<=M&&(T.ins_h=(T.ins_h<<T.hash_shift^T.window[T.strstart+S-1])&T.hash_mask,ne=T.prev[T.strstart&T.w_mask]=T.head[T.ins_h],T.head[T.ins_h]=T.strstart),--T.prev_length!=0;);if(T.match_available=0,T.match_length=S-1,T.strstart++,B&&(V(T,!1),T.strm.avail_out===0))return E}else if(T.match_available){if((B=a._tr_tally(T,0,T.window[T.strstart-1]))&&V(T,!1),T.strstart++,T.lookahead--,T.strm.avail_out===0)return E}else T.match_available=1,T.strstart++,T.lookahead--}return T.match_available&&(B=a._tr_tally(T,0,T.window[T.strstart-1]),T.match_available=0),T.insert=T.strstart<S-1?T.strstart:S-1,se===f?(V(T,!0),T.strm.avail_out===0?j:L):T.last_lit&&(V(T,!1),T.strm.avail_out===0)?E:F}function ge(T,se,ne,B,M){this.good_length=T,this.max_lazy=se,this.nice_length=ne,this.max_chain=B,this.func=M}function ye(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=v,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new o.Buf16(2*R),this.dyn_dtree=new o.Buf16(2*(2*A+1)),this.bl_tree=new o.Buf16(2*(2*I+1)),ee(this.dyn_ltree),ee(this.dyn_dtree),ee(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new o.Buf16(x+1),this.heap=new o.Buf16(2*y+1),ee(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new o.Buf16(2*y+1),ee(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Me(T){var se;return T&&T.state?(T.total_in=T.total_out=0,T.data_type=_,(se=T.state).pending=0,se.pending_out=0,se.wrap<0&&(se.wrap=-se.wrap),se.status=se.wrap?O:D,T.adler=se.wrap===2?0:1,se.last_flush=h,a._tr_init(se),d):re(T,m)}function Ze(T){var se=Me(T);return se===d&&function(ne){ne.window_size=2*ne.w_size,ee(ne.head),ne.max_lazy_match=i[ne.level].max_lazy,ne.good_match=i[ne.level].good_length,ne.nice_match=i[ne.level].nice_length,ne.max_chain_length=i[ne.level].max_chain,ne.strstart=0,ne.block_start=0,ne.lookahead=0,ne.insert=0,ne.match_length=ne.prev_length=S-1,ne.match_available=0,ne.ins_h=0}(T.state),se}function ke(T,se,ne,B,M,X){if(!T)return m;var ae=1;if(se===g&&(se=6),B<0?(ae=0,B=-B):15<B&&(ae=2,B-=16),M<1||w<M||ne!==v||B<8||15<B||se<0||9<se||X<0||p<X)return re(T,m);B===8&&(B=9);var oe=new ye;return(T.state=oe).strm=T,oe.wrap=ae,oe.gzhead=null,oe.w_bits=B,oe.w_size=1<<oe.w_bits,oe.w_mask=oe.w_size-1,oe.hash_bits=M+7,oe.hash_size=1<<oe.hash_bits,oe.hash_mask=oe.hash_size-1,oe.hash_shift=~~((oe.hash_bits+S-1)/S),oe.window=new o.Buf8(2*oe.w_size),oe.head=new o.Buf16(oe.hash_size),oe.prev=new o.Buf16(oe.w_size),oe.lit_bufsize=1<<M+6,oe.pending_buf_size=4*oe.lit_bufsize,oe.pending_buf=new o.Buf8(oe.pending_buf_size),oe.d_buf=1*oe.lit_bufsize,oe.l_buf=3*oe.lit_bufsize,oe.level=se,oe.strategy=X,oe.method=ne,Ze(T)}i=[new ge(0,0,0,0,function(T,se){var ne=65535;for(ne>T.pending_buf_size-5&&(ne=T.pending_buf_size-5);;){if(T.lookahead<=1){if(le(T),T.lookahead===0&&se===h)return E;if(T.lookahead===0)break}T.strstart+=T.lookahead,T.lookahead=0;var B=T.block_start+ne;if((T.strstart===0||T.strstart>=B)&&(T.lookahead=T.strstart-B,T.strstart=B,V(T,!1),T.strm.avail_out===0)||T.strstart-T.block_start>=T.w_size-N&&(V(T,!1),T.strm.avail_out===0))return E}return T.insert=0,se===f?(V(T,!0),T.strm.avail_out===0?j:L):(T.strstart>T.block_start&&(V(T,!1),T.strm.avail_out),E)}),new ge(4,4,8,4,ve),new ge(4,5,16,8,ve),new ge(4,6,32,32,ve),new ge(4,4,16,16,Ce),new ge(8,16,32,32,Ce),new ge(8,16,128,128,Ce),new ge(8,32,128,256,Ce),new ge(32,128,258,1024,Ce),new ge(32,258,258,4096,Ce)],s.deflateInit=function(T,se){return ke(T,se,v,15,8,0)},s.deflateInit2=ke,s.deflateReset=Ze,s.deflateResetKeep=Me,s.deflateSetHeader=function(T,se){return T&&T.state?T.state.wrap!==2?m:(T.state.gzhead=se,d):m},s.deflate=function(T,se){var ne,B,M,X;if(!T||!T.state||5<se||se<0)return T?re(T,m):m;if(B=T.state,!T.output||!T.input&&T.avail_in!==0||B.status===666&&se!==f)return re(T,T.avail_out===0?-5:m);if(B.strm=T,ne=B.last_flush,B.last_flush=se,B.status===O)if(B.wrap===2)T.adler=0,_e(B,31),_e(B,139),_e(B,8),B.gzhead?(_e(B,(B.gzhead.text?1:0)+(B.gzhead.hcrc?2:0)+(B.gzhead.extra?4:0)+(B.gzhead.name?8:0)+(B.gzhead.comment?16:0)),_e(B,255&B.gzhead.time),_e(B,B.gzhead.time>>8&255),_e(B,B.gzhead.time>>16&255),_e(B,B.gzhead.time>>24&255),_e(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),_e(B,255&B.gzhead.os),B.gzhead.extra&&B.gzhead.extra.length&&(_e(B,255&B.gzhead.extra.length),_e(B,B.gzhead.extra.length>>8&255)),B.gzhead.hcrc&&(T.adler=u(T.adler,B.pending_buf,B.pending,0)),B.gzindex=0,B.status=69):(_e(B,0),_e(B,0),_e(B,0),_e(B,0),_e(B,0),_e(B,B.level===9?2:2<=B.strategy||B.level<2?4:0),_e(B,3),B.status=D);else{var ae=v+(B.w_bits-8<<4)<<8;ae|=(2<=B.strategy||B.level<2?0:B.level<6?1:B.level===6?2:3)<<6,B.strstart!==0&&(ae|=32),ae+=31-ae%31,B.status=D,ie(B,ae),B.strstart!==0&&(ie(B,T.adler>>>16),ie(B,65535&T.adler)),T.adler=1}if(B.status===69)if(B.gzhead.extra){for(M=B.pending;B.gzindex<(65535&B.gzhead.extra.length)&&(B.pending!==B.pending_buf_size||(B.gzhead.hcrc&&B.pending>M&&(T.adler=u(T.adler,B.pending_buf,B.pending-M,M)),U(T),M=B.pending,B.pending!==B.pending_buf_size));)_e(B,255&B.gzhead.extra[B.gzindex]),B.gzindex++;B.gzhead.hcrc&&B.pending>M&&(T.adler=u(T.adler,B.pending_buf,B.pending-M,M)),B.gzindex===B.gzhead.extra.length&&(B.gzindex=0,B.status=73)}else B.status=73;if(B.status===73)if(B.gzhead.name){M=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>M&&(T.adler=u(T.adler,B.pending_buf,B.pending-M,M)),U(T),M=B.pending,B.pending===B.pending_buf_size)){X=1;break}X=B.gzindex<B.gzhead.name.length?255&B.gzhead.name.charCodeAt(B.gzindex++):0,_e(B,X)}while(X!==0);B.gzhead.hcrc&&B.pending>M&&(T.adler=u(T.adler,B.pending_buf,B.pending-M,M)),X===0&&(B.gzindex=0,B.status=91)}else B.status=91;if(B.status===91)if(B.gzhead.comment){M=B.pending;do{if(B.pending===B.pending_buf_size&&(B.gzhead.hcrc&&B.pending>M&&(T.adler=u(T.adler,B.pending_buf,B.pending-M,M)),U(T),M=B.pending,B.pending===B.pending_buf_size)){X=1;break}X=B.gzindex<B.gzhead.comment.length?255&B.gzhead.comment.charCodeAt(B.gzindex++):0,_e(B,X)}while(X!==0);B.gzhead.hcrc&&B.pending>M&&(T.adler=u(T.adler,B.pending_buf,B.pending-M,M)),X===0&&(B.status=103)}else B.status=103;if(B.status===103&&(B.gzhead.hcrc?(B.pending+2>B.pending_buf_size&&U(T),B.pending+2<=B.pending_buf_size&&(_e(B,255&T.adler),_e(B,T.adler>>8&255),T.adler=0,B.status=D)):B.status=D),B.pending!==0){if(U(T),T.avail_out===0)return B.last_flush=-1,d}else if(T.avail_in===0&&Y(se)<=Y(ne)&&se!==f)return re(T,-5);if(B.status===666&&T.avail_in!==0)return re(T,-5);if(T.avail_in!==0||B.lookahead!==0||se!==h&&B.status!==666){var oe=B.strategy===2?function($,he){for(var P;;){if($.lookahead===0&&(le($),$.lookahead===0)){if(he===h)return E;break}if($.match_length=0,P=a._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,P&&(V($,!1),$.strm.avail_out===0))return E}return $.insert=0,he===f?(V($,!0),$.strm.avail_out===0?j:L):$.last_lit&&(V($,!1),$.strm.avail_out===0)?E:F}(B,se):B.strategy===3?function($,he){for(var P,z,J,ue,de=$.window;;){if($.lookahead<=k){if(le($),$.lookahead<=k&&he===h)return E;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=S&&0<$.strstart&&(z=de[J=$.strstart-1])===de[++J]&&z===de[++J]&&z===de[++J]){ue=$.strstart+k;do;while(z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&z===de[++J]&&J<ue);$.match_length=k-(ue-J),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=S?(P=a._tr_tally($,1,$.match_length-S),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(P=a._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),P&&(V($,!1),$.strm.avail_out===0))return E}return $.insert=0,he===f?(V($,!0),$.strm.avail_out===0?j:L):$.last_lit&&(V($,!1),$.strm.avail_out===0)?E:F}(B,se):i[B.level].func(B,se);if(oe!==j&&oe!==L||(B.status=666),oe===E||oe===j)return T.avail_out===0&&(B.last_flush=-1),d;if(oe===F&&(se===1?a._tr_align(B):se!==5&&(a._tr_stored_block(B,0,0,!1),se===3&&(ee(B.head),B.lookahead===0&&(B.strstart=0,B.block_start=0,B.insert=0))),U(T),T.avail_out===0))return B.last_flush=-1,d}return se!==f?d:B.wrap<=0?1:(B.wrap===2?(_e(B,255&T.adler),_e(B,T.adler>>8&255),_e(B,T.adler>>16&255),_e(B,T.adler>>24&255),_e(B,255&T.total_in),_e(B,T.total_in>>8&255),_e(B,T.total_in>>16&255),_e(B,T.total_in>>24&255)):(ie(B,T.adler>>>16),ie(B,65535&T.adler)),U(T),0<B.wrap&&(B.wrap=-B.wrap),B.pending!==0?d:1)},s.deflateEnd=function(T){var se;return T&&T.state?(se=T.state.status)!==O&&se!==69&&se!==73&&se!==91&&se!==103&&se!==D&&se!==666?re(T,m):(T.state=null,se===D?re(T,-3):d):m},s.deflateSetDictionary=function(T,se){var ne,B,M,X,ae,oe,$,he,P=se.length;if(!T||!T.state||(X=(ne=T.state).wrap)===2||X===1&&ne.status!==O||ne.lookahead)return m;for(X===1&&(T.adler=l(T.adler,se,P,0)),ne.wrap=0,P>=ne.w_size&&(X===0&&(ee(ne.head),ne.strstart=0,ne.block_start=0,ne.insert=0),he=new o.Buf8(ne.w_size),o.arraySet(he,se,P-ne.w_size,ne.w_size,0),se=he,P=ne.w_size),ae=T.avail_in,oe=T.next_in,$=T.input,T.avail_in=P,T.next_in=0,T.input=se,le(ne);ne.lookahead>=S;){for(B=ne.strstart,M=ne.lookahead-(S-1);ne.ins_h=(ne.ins_h<<ne.hash_shift^ne.window[B+S-1])&ne.hash_mask,ne.prev[B&ne.w_mask]=ne.head[ne.ins_h],ne.head[ne.ins_h]=B,B++,--M;);ne.strstart=B,ne.lookahead=S-1,le(ne)}return ne.strstart+=ne.lookahead,ne.block_start=ne.strstart,ne.insert=ne.lookahead,ne.lookahead=0,ne.match_length=ne.prev_length=S-1,ne.match_available=0,T.next_in=oe,T.input=$,T.avail_in=ae,ne.wrap=X,d},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(t,n,s){n.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(t,n,s){n.exports=function(i,o){var a,l,u,c,h,f,d,m,g,p,_,v,w,y,A,I,R,x,S,k,N,O,D,E,F;a=i.state,l=i.next_in,E=i.input,u=l+(i.avail_in-5),c=i.next_out,F=i.output,h=c-(o-i.avail_out),f=c+(i.avail_out-257),d=a.dmax,m=a.wsize,g=a.whave,p=a.wnext,_=a.window,v=a.hold,w=a.bits,y=a.lencode,A=a.distcode,I=(1<<a.lenbits)-1,R=(1<<a.distbits)-1;e:do{w<15&&(v+=E[l++]<<w,w+=8,v+=E[l++]<<w,w+=8),x=y[v&I];t:for(;;){if(v>>>=S=x>>>24,w-=S,(S=x>>>16&255)===0)F[c++]=65535&x;else{if(!(16&S)){if((64&S)==0){x=y[(65535&x)+(v&(1<<S)-1)];continue t}if(32&S){a.mode=12;break e}i.msg="invalid literal/length code",a.mode=30;break e}k=65535&x,(S&=15)&&(w<S&&(v+=E[l++]<<w,w+=8),k+=v&(1<<S)-1,v>>>=S,w-=S),w<15&&(v+=E[l++]<<w,w+=8,v+=E[l++]<<w,w+=8),x=A[v&R];n:for(;;){if(v>>>=S=x>>>24,w-=S,!(16&(S=x>>>16&255))){if((64&S)==0){x=A[(65535&x)+(v&(1<<S)-1)];continue n}i.msg="invalid distance code",a.mode=30;break e}if(N=65535&x,w<(S&=15)&&(v+=E[l++]<<w,(w+=8)<S&&(v+=E[l++]<<w,w+=8)),d<(N+=v&(1<<S)-1)){i.msg="invalid distance too far back",a.mode=30;break e}if(v>>>=S,w-=S,(S=c-h)<N){if(g<(S=N-S)&&a.sane){i.msg="invalid distance too far back",a.mode=30;break e}if(D=_,(O=0)===p){if(O+=m-S,S<k){for(k-=S;F[c++]=_[O++],--S;);O=c-N,D=F}}else if(p<S){if(O+=m+p-S,(S-=p)<k){for(k-=S;F[c++]=_[O++],--S;);if(O=0,p<k){for(k-=S=p;F[c++]=_[O++],--S;);O=c-N,D=F}}}else if(O+=p-S,S<k){for(k-=S;F[c++]=_[O++],--S;);O=c-N,D=F}for(;2<k;)F[c++]=D[O++],F[c++]=D[O++],F[c++]=D[O++],k-=3;k&&(F[c++]=D[O++],1<k&&(F[c++]=D[O++]))}else{for(O=c-N;F[c++]=F[O++],F[c++]=F[O++],F[c++]=F[O++],2<(k-=3););k&&(F[c++]=F[O++],1<k&&(F[c++]=F[O++]))}break}}break}}while(l<u&&c<f);l-=k=w>>3,v&=(1<<(w-=k<<3))-1,i.next_in=l,i.next_out=c,i.avail_in=l<u?u-l+5:5-(l-u),i.avail_out=c<f?f-c+257:257-(c-f),a.hold=v,a.bits=w}},{}],49:[function(t,n,s){var i=t("../utils/common"),o=t("./adler32"),a=t("./crc32"),l=t("./inffast"),u=t("./inftrees"),c=1,h=2,f=0,d=-2,m=1,g=852,p=592;function _(O){return(O>>>24&255)+(O>>>8&65280)+((65280&O)<<8)+((255&O)<<24)}function v(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function w(O){var D;return O&&O.state?(D=O.state,O.total_in=O.total_out=D.total=0,O.msg="",D.wrap&&(O.adler=1&D.wrap),D.mode=m,D.last=0,D.havedict=0,D.dmax=32768,D.head=null,D.hold=0,D.bits=0,D.lencode=D.lendyn=new i.Buf32(g),D.distcode=D.distdyn=new i.Buf32(p),D.sane=1,D.back=-1,f):d}function y(O){var D;return O&&O.state?((D=O.state).wsize=0,D.whave=0,D.wnext=0,w(O)):d}function A(O,D){var E,F;return O&&O.state?(F=O.state,D<0?(E=0,D=-D):(E=1+(D>>4),D<48&&(D&=15)),D&&(D<8||15<D)?d:(F.window!==null&&F.wbits!==D&&(F.window=null),F.wrap=E,F.wbits=D,y(O))):d}function I(O,D){var E,F;return O?(F=new v,(O.state=F).window=null,(E=A(O,D))!==f&&(O.state=null),E):d}var R,x,S=!0;function k(O){if(S){var D;for(R=new i.Buf32(512),x=new i.Buf32(32),D=0;D<144;)O.lens[D++]=8;for(;D<256;)O.lens[D++]=9;for(;D<280;)O.lens[D++]=7;for(;D<288;)O.lens[D++]=8;for(u(c,O.lens,0,288,R,0,O.work,{bits:9}),D=0;D<32;)O.lens[D++]=5;u(h,O.lens,0,32,x,0,O.work,{bits:5}),S=!1}O.lencode=R,O.lenbits=9,O.distcode=x,O.distbits=5}function N(O,D,E,F){var j,L=O.state;return L.window===null&&(L.wsize=1<<L.wbits,L.wnext=0,L.whave=0,L.window=new i.Buf8(L.wsize)),F>=L.wsize?(i.arraySet(L.window,D,E-L.wsize,L.wsize,0),L.wnext=0,L.whave=L.wsize):(F<(j=L.wsize-L.wnext)&&(j=F),i.arraySet(L.window,D,E-F,j,L.wnext),(F-=j)?(i.arraySet(L.window,D,E-F,F,0),L.wnext=F,L.whave=L.wsize):(L.wnext+=j,L.wnext===L.wsize&&(L.wnext=0),L.whave<L.wsize&&(L.whave+=j))),0}s.inflateReset=y,s.inflateReset2=A,s.inflateResetKeep=w,s.inflateInit=function(O){return I(O,15)},s.inflateInit2=I,s.inflate=function(O,D){var E,F,j,L,re,Y,ee,U,V,_e,ie,Z,le,ve,Ce,ge,ye,Me,Ze,ke,T,se,ne,B,M=0,X=new i.Buf8(4),ae=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!O||!O.state||!O.output||!O.input&&O.avail_in!==0)return d;(E=O.state).mode===12&&(E.mode=13),re=O.next_out,j=O.output,ee=O.avail_out,L=O.next_in,F=O.input,Y=O.avail_in,U=E.hold,V=E.bits,_e=Y,ie=ee,se=f;e:for(;;)switch(E.mode){case m:if(E.wrap===0){E.mode=13;break}for(;V<16;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(2&E.wrap&&U===35615){X[E.check=0]=255&U,X[1]=U>>>8&255,E.check=a(E.check,X,2,0),V=U=0,E.mode=2;break}if(E.flags=0,E.head&&(E.head.done=!1),!(1&E.wrap)||(((255&U)<<8)+(U>>8))%31){O.msg="incorrect header check",E.mode=30;break}if((15&U)!=8){O.msg="unknown compression method",E.mode=30;break}if(V-=4,T=8+(15&(U>>>=4)),E.wbits===0)E.wbits=T;else if(T>E.wbits){O.msg="invalid window size",E.mode=30;break}E.dmax=1<<T,O.adler=E.check=1,E.mode=512&U?10:12,V=U=0;break;case 2:for(;V<16;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(E.flags=U,(255&E.flags)!=8){O.msg="unknown compression method",E.mode=30;break}if(57344&E.flags){O.msg="unknown header flags set",E.mode=30;break}E.head&&(E.head.text=U>>8&1),512&E.flags&&(X[0]=255&U,X[1]=U>>>8&255,E.check=a(E.check,X,2,0)),V=U=0,E.mode=3;case 3:for(;V<32;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}E.head&&(E.head.time=U),512&E.flags&&(X[0]=255&U,X[1]=U>>>8&255,X[2]=U>>>16&255,X[3]=U>>>24&255,E.check=a(E.check,X,4,0)),V=U=0,E.mode=4;case 4:for(;V<16;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}E.head&&(E.head.xflags=255&U,E.head.os=U>>8),512&E.flags&&(X[0]=255&U,X[1]=U>>>8&255,E.check=a(E.check,X,2,0)),V=U=0,E.mode=5;case 5:if(1024&E.flags){for(;V<16;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}E.length=U,E.head&&(E.head.extra_len=U),512&E.flags&&(X[0]=255&U,X[1]=U>>>8&255,E.check=a(E.check,X,2,0)),V=U=0}else E.head&&(E.head.extra=null);E.mode=6;case 6:if(1024&E.flags&&(Y<(Z=E.length)&&(Z=Y),Z&&(E.head&&(T=E.head.extra_len-E.length,E.head.extra||(E.head.extra=new Array(E.head.extra_len)),i.arraySet(E.head.extra,F,L,Z,T)),512&E.flags&&(E.check=a(E.check,F,Z,L)),Y-=Z,L+=Z,E.length-=Z),E.length))break e;E.length=0,E.mode=7;case 7:if(2048&E.flags){if(Y===0)break e;for(Z=0;T=F[L+Z++],E.head&&T&&E.length<65536&&(E.head.name+=String.fromCharCode(T)),T&&Z<Y;);if(512&E.flags&&(E.check=a(E.check,F,Z,L)),Y-=Z,L+=Z,T)break e}else E.head&&(E.head.name=null);E.length=0,E.mode=8;case 8:if(4096&E.flags){if(Y===0)break e;for(Z=0;T=F[L+Z++],E.head&&T&&E.length<65536&&(E.head.comment+=String.fromCharCode(T)),T&&Z<Y;);if(512&E.flags&&(E.check=a(E.check,F,Z,L)),Y-=Z,L+=Z,T)break e}else E.head&&(E.head.comment=null);E.mode=9;case 9:if(512&E.flags){for(;V<16;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(U!==(65535&E.check)){O.msg="header crc mismatch",E.mode=30;break}V=U=0}E.head&&(E.head.hcrc=E.flags>>9&1,E.head.done=!0),O.adler=E.check=0,E.mode=12;break;case 10:for(;V<32;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}O.adler=E.check=_(U),V=U=0,E.mode=11;case 11:if(E.havedict===0)return O.next_out=re,O.avail_out=ee,O.next_in=L,O.avail_in=Y,E.hold=U,E.bits=V,2;O.adler=E.check=1,E.mode=12;case 12:if(D===5||D===6)break e;case 13:if(E.last){U>>>=7&V,V-=7&V,E.mode=27;break}for(;V<3;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}switch(E.last=1&U,V-=1,3&(U>>>=1)){case 0:E.mode=14;break;case 1:if(k(E),E.mode=20,D!==6)break;U>>>=2,V-=2;break e;case 2:E.mode=17;break;case 3:O.msg="invalid block type",E.mode=30}U>>>=2,V-=2;break;case 14:for(U>>>=7&V,V-=7&V;V<32;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if((65535&U)!=(U>>>16^65535)){O.msg="invalid stored block lengths",E.mode=30;break}if(E.length=65535&U,V=U=0,E.mode=15,D===6)break e;case 15:E.mode=16;case 16:if(Z=E.length){if(Y<Z&&(Z=Y),ee<Z&&(Z=ee),Z===0)break e;i.arraySet(j,F,L,Z,re),Y-=Z,L+=Z,ee-=Z,re+=Z,E.length-=Z;break}E.mode=12;break;case 17:for(;V<14;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(E.nlen=257+(31&U),U>>>=5,V-=5,E.ndist=1+(31&U),U>>>=5,V-=5,E.ncode=4+(15&U),U>>>=4,V-=4,286<E.nlen||30<E.ndist){O.msg="too many length or distance symbols",E.mode=30;break}E.have=0,E.mode=18;case 18:for(;E.have<E.ncode;){for(;V<3;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}E.lens[ae[E.have++]]=7&U,U>>>=3,V-=3}for(;E.have<19;)E.lens[ae[E.have++]]=0;if(E.lencode=E.lendyn,E.lenbits=7,ne={bits:E.lenbits},se=u(0,E.lens,0,19,E.lencode,0,E.work,ne),E.lenbits=ne.bits,se){O.msg="invalid code lengths set",E.mode=30;break}E.have=0,E.mode=19;case 19:for(;E.have<E.nlen+E.ndist;){for(;ge=(M=E.lencode[U&(1<<E.lenbits)-1])>>>16&255,ye=65535&M,!((Ce=M>>>24)<=V);){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(ye<16)U>>>=Ce,V-=Ce,E.lens[E.have++]=ye;else{if(ye===16){for(B=Ce+2;V<B;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(U>>>=Ce,V-=Ce,E.have===0){O.msg="invalid bit length repeat",E.mode=30;break}T=E.lens[E.have-1],Z=3+(3&U),U>>>=2,V-=2}else if(ye===17){for(B=Ce+3;V<B;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}V-=Ce,T=0,Z=3+(7&(U>>>=Ce)),U>>>=3,V-=3}else{for(B=Ce+7;V<B;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}V-=Ce,T=0,Z=11+(127&(U>>>=Ce)),U>>>=7,V-=7}if(E.have+Z>E.nlen+E.ndist){O.msg="invalid bit length repeat",E.mode=30;break}for(;Z--;)E.lens[E.have++]=T}}if(E.mode===30)break;if(E.lens[256]===0){O.msg="invalid code -- missing end-of-block",E.mode=30;break}if(E.lenbits=9,ne={bits:E.lenbits},se=u(c,E.lens,0,E.nlen,E.lencode,0,E.work,ne),E.lenbits=ne.bits,se){O.msg="invalid literal/lengths set",E.mode=30;break}if(E.distbits=6,E.distcode=E.distdyn,ne={bits:E.distbits},se=u(h,E.lens,E.nlen,E.ndist,E.distcode,0,E.work,ne),E.distbits=ne.bits,se){O.msg="invalid distances set",E.mode=30;break}if(E.mode=20,D===6)break e;case 20:E.mode=21;case 21:if(6<=Y&&258<=ee){O.next_out=re,O.avail_out=ee,O.next_in=L,O.avail_in=Y,E.hold=U,E.bits=V,l(O,ie),re=O.next_out,j=O.output,ee=O.avail_out,L=O.next_in,F=O.input,Y=O.avail_in,U=E.hold,V=E.bits,E.mode===12&&(E.back=-1);break}for(E.back=0;ge=(M=E.lencode[U&(1<<E.lenbits)-1])>>>16&255,ye=65535&M,!((Ce=M>>>24)<=V);){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(ge&&(240&ge)==0){for(Me=Ce,Ze=ge,ke=ye;ge=(M=E.lencode[ke+((U&(1<<Me+Ze)-1)>>Me)])>>>16&255,ye=65535&M,!(Me+(Ce=M>>>24)<=V);){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}U>>>=Me,V-=Me,E.back+=Me}if(U>>>=Ce,V-=Ce,E.back+=Ce,E.length=ye,ge===0){E.mode=26;break}if(32&ge){E.back=-1,E.mode=12;break}if(64&ge){O.msg="invalid literal/length code",E.mode=30;break}E.extra=15&ge,E.mode=22;case 22:if(E.extra){for(B=E.extra;V<B;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}E.length+=U&(1<<E.extra)-1,U>>>=E.extra,V-=E.extra,E.back+=E.extra}E.was=E.length,E.mode=23;case 23:for(;ge=(M=E.distcode[U&(1<<E.distbits)-1])>>>16&255,ye=65535&M,!((Ce=M>>>24)<=V);){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if((240&ge)==0){for(Me=Ce,Ze=ge,ke=ye;ge=(M=E.distcode[ke+((U&(1<<Me+Ze)-1)>>Me)])>>>16&255,ye=65535&M,!(Me+(Ce=M>>>24)<=V);){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}U>>>=Me,V-=Me,E.back+=Me}if(U>>>=Ce,V-=Ce,E.back+=Ce,64&ge){O.msg="invalid distance code",E.mode=30;break}E.offset=ye,E.extra=15&ge,E.mode=24;case 24:if(E.extra){for(B=E.extra;V<B;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}E.offset+=U&(1<<E.extra)-1,U>>>=E.extra,V-=E.extra,E.back+=E.extra}if(E.offset>E.dmax){O.msg="invalid distance too far back",E.mode=30;break}E.mode=25;case 25:if(ee===0)break e;if(Z=ie-ee,E.offset>Z){if((Z=E.offset-Z)>E.whave&&E.sane){O.msg="invalid distance too far back",E.mode=30;break}le=Z>E.wnext?(Z-=E.wnext,E.wsize-Z):E.wnext-Z,Z>E.length&&(Z=E.length),ve=E.window}else ve=j,le=re-E.offset,Z=E.length;for(ee<Z&&(Z=ee),ee-=Z,E.length-=Z;j[re++]=ve[le++],--Z;);E.length===0&&(E.mode=21);break;case 26:if(ee===0)break e;j[re++]=E.length,ee--,E.mode=21;break;case 27:if(E.wrap){for(;V<32;){if(Y===0)break e;Y--,U|=F[L++]<<V,V+=8}if(ie-=ee,O.total_out+=ie,E.total+=ie,ie&&(O.adler=E.check=E.flags?a(E.check,j,ie,re-ie):o(E.check,j,ie,re-ie)),ie=ee,(E.flags?U:_(U))!==E.check){O.msg="incorrect data check",E.mode=30;break}V=U=0}E.mode=28;case 28:if(E.wrap&&E.flags){for(;V<32;){if(Y===0)break e;Y--,U+=F[L++]<<V,V+=8}if(U!==(4294967295&E.total)){O.msg="incorrect length check",E.mode=30;break}V=U=0}E.mode=29;case 29:se=1;break e;case 30:se=-3;break e;case 31:return-4;case 32:default:return d}return O.next_out=re,O.avail_out=ee,O.next_in=L,O.avail_in=Y,E.hold=U,E.bits=V,(E.wsize||ie!==O.avail_out&&E.mode<30&&(E.mode<27||D!==4))&&N(O,O.output,O.next_out,ie-O.avail_out)?(E.mode=31,-4):(_e-=O.avail_in,ie-=O.avail_out,O.total_in+=_e,O.total_out+=ie,E.total+=ie,E.wrap&&ie&&(O.adler=E.check=E.flags?a(E.check,j,ie,O.next_out-ie):o(E.check,j,ie,O.next_out-ie)),O.data_type=E.bits+(E.last?64:0)+(E.mode===12?128:0)+(E.mode===20||E.mode===15?256:0),(_e==0&&ie===0||D===4)&&se===f&&(se=-5),se)},s.inflateEnd=function(O){if(!O||!O.state)return d;var D=O.state;return D.window&&(D.window=null),O.state=null,f},s.inflateGetHeader=function(O,D){var E;return O&&O.state?(2&(E=O.state).wrap)==0?d:((E.head=D).done=!1,f):d},s.inflateSetDictionary=function(O,D){var E,F=D.length;return O&&O.state?(E=O.state).wrap!==0&&E.mode!==11?d:E.mode===11&&o(1,D,F,0)!==E.check?-3:N(O,D,F,F)?(E.mode=31,-4):(E.havedict=1,f):d},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(t,n,s){var i=t("../utils/common"),o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],a=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];n.exports=function(c,h,f,d,m,g,p,_){var v,w,y,A,I,R,x,S,k,N=_.bits,O=0,D=0,E=0,F=0,j=0,L=0,re=0,Y=0,ee=0,U=0,V=null,_e=0,ie=new i.Buf16(16),Z=new i.Buf16(16),le=null,ve=0;for(O=0;O<=15;O++)ie[O]=0;for(D=0;D<d;D++)ie[h[f+D]]++;for(j=N,F=15;1<=F&&ie[F]===0;F--);if(F<j&&(j=F),F===0)return m[g++]=20971520,m[g++]=20971520,_.bits=1,0;for(E=1;E<F&&ie[E]===0;E++);for(j<E&&(j=E),O=Y=1;O<=15;O++)if(Y<<=1,(Y-=ie[O])<0)return-1;if(0<Y&&(c===0||F!==1))return-1;for(Z[1]=0,O=1;O<15;O++)Z[O+1]=Z[O]+ie[O];for(D=0;D<d;D++)h[f+D]!==0&&(p[Z[h[f+D]]++]=D);if(R=c===0?(V=le=p,19):c===1?(V=o,_e-=257,le=a,ve-=257,256):(V=l,le=u,-1),O=E,I=g,re=D=U=0,y=-1,A=(ee=1<<(L=j))-1,c===1&&852<ee||c===2&&592<ee)return 1;for(;;){for(x=O-re,k=p[D]<R?(S=0,p[D]):p[D]>R?(S=le[ve+p[D]],V[_e+p[D]]):(S=96,0),v=1<<O-re,E=w=1<<L;m[I+(U>>re)+(w-=v)]=x<<24|S<<16|k|0,w!==0;);for(v=1<<O-1;U&v;)v>>=1;if(v!==0?(U&=v-1,U+=v):U=0,D++,--ie[O]==0){if(O===F)break;O=h[f+p[D]]}if(j<O&&(U&A)!==y){for(re===0&&(re=j),I+=E,Y=1<<(L=O-re);L+re<F&&!((Y-=ie[L+re])<=0);)L++,Y<<=1;if(ee+=1<<L,c===1&&852<ee||c===2&&592<ee)return 1;m[y=U&A]=j<<24|L<<16|I-g|0}}return U!==0&&(m[I+U]=O-re<<24|64<<16|0),_.bits=j,0}},{"../utils/common":41}],51:[function(t,n,s){n.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(t,n,s){var i=t("../utils/common"),o=0,a=1;function l(M){for(var X=M.length;0<=--X;)M[X]=0}var u=0,c=29,h=256,f=h+1+c,d=30,m=19,g=2*f+1,p=15,_=16,v=7,w=256,y=16,A=17,I=18,R=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],S=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],N=new Array(2*(f+2));l(N);var O=new Array(2*d);l(O);var D=new Array(512);l(D);var E=new Array(256);l(E);var F=new Array(c);l(F);var j,L,re,Y=new Array(d);function ee(M,X,ae,oe,$){this.static_tree=M,this.extra_bits=X,this.extra_base=ae,this.elems=oe,this.max_length=$,this.has_stree=M&&M.length}function U(M,X){this.dyn_tree=M,this.max_code=0,this.stat_desc=X}function V(M){return M<256?D[M]:D[256+(M>>>7)]}function _e(M,X){M.pending_buf[M.pending++]=255&X,M.pending_buf[M.pending++]=X>>>8&255}function ie(M,X,ae){M.bi_valid>_-ae?(M.bi_buf|=X<<M.bi_valid&65535,_e(M,M.bi_buf),M.bi_buf=X>>_-M.bi_valid,M.bi_valid+=ae-_):(M.bi_buf|=X<<M.bi_valid&65535,M.bi_valid+=ae)}function Z(M,X,ae){ie(M,ae[2*X],ae[2*X+1])}function le(M,X){for(var ae=0;ae|=1&M,M>>>=1,ae<<=1,0<--X;);return ae>>>1}function ve(M,X,ae){var oe,$,he=new Array(p+1),P=0;for(oe=1;oe<=p;oe++)he[oe]=P=P+ae[oe-1]<<1;for($=0;$<=X;$++){var z=M[2*$+1];z!==0&&(M[2*$]=le(he[z]++,z))}}function Ce(M){var X;for(X=0;X<f;X++)M.dyn_ltree[2*X]=0;for(X=0;X<d;X++)M.dyn_dtree[2*X]=0;for(X=0;X<m;X++)M.bl_tree[2*X]=0;M.dyn_ltree[2*w]=1,M.opt_len=M.static_len=0,M.last_lit=M.matches=0}function ge(M){8<M.bi_valid?_e(M,M.bi_buf):0<M.bi_valid&&(M.pending_buf[M.pending++]=M.bi_buf),M.bi_buf=0,M.bi_valid=0}function ye(M,X,ae,oe){var $=2*X,he=2*ae;return M[$]<M[he]||M[$]===M[he]&&oe[X]<=oe[ae]}function Me(M,X,ae){for(var oe=M.heap[ae],$=ae<<1;$<=M.heap_len&&($<M.heap_len&&ye(X,M.heap[$+1],M.heap[$],M.depth)&&$++,!ye(X,oe,M.heap[$],M.depth));)M.heap[ae]=M.heap[$],ae=$,$<<=1;M.heap[ae]=oe}function Ze(M,X,ae){var oe,$,he,P,z=0;if(M.last_lit!==0)for(;oe=M.pending_buf[M.d_buf+2*z]<<8|M.pending_buf[M.d_buf+2*z+1],$=M.pending_buf[M.l_buf+z],z++,oe===0?Z(M,$,X):(Z(M,(he=E[$])+h+1,X),(P=R[he])!==0&&ie(M,$-=F[he],P),Z(M,he=V(--oe),ae),(P=x[he])!==0&&ie(M,oe-=Y[he],P)),z<M.last_lit;);Z(M,w,X)}function ke(M,X){var ae,oe,$,he=X.dyn_tree,P=X.stat_desc.static_tree,z=X.stat_desc.has_stree,J=X.stat_desc.elems,ue=-1;for(M.heap_len=0,M.heap_max=g,ae=0;ae<J;ae++)he[2*ae]!==0?(M.heap[++M.heap_len]=ue=ae,M.depth[ae]=0):he[2*ae+1]=0;for(;M.heap_len<2;)he[2*($=M.heap[++M.heap_len]=ue<2?++ue:0)]=1,M.depth[$]=0,M.opt_len--,z&&(M.static_len-=P[2*$+1]);for(X.max_code=ue,ae=M.heap_len>>1;1<=ae;ae--)Me(M,he,ae);for($=J;ae=M.heap[1],M.heap[1]=M.heap[M.heap_len--],Me(M,he,1),oe=M.heap[1],M.heap[--M.heap_max]=ae,M.heap[--M.heap_max]=oe,he[2*$]=he[2*ae]+he[2*oe],M.depth[$]=(M.depth[ae]>=M.depth[oe]?M.depth[ae]:M.depth[oe])+1,he[2*ae+1]=he[2*oe+1]=$,M.heap[1]=$++,Me(M,he,1),2<=M.heap_len;);M.heap[--M.heap_max]=M.heap[1],function(de,Fe){var xe,Oe,ce,Te,be,Ue,Pe=Fe.dyn_tree,Ke=Fe.max_code,H=Fe.stat_desc.static_tree,K=Fe.stat_desc.has_stree,qe=Fe.stat_desc.extra_bits,Or=Fe.stat_desc.extra_base,ar=Fe.stat_desc.max_length,es=0;for(Te=0;Te<=p;Te++)de.bl_count[Te]=0;for(Pe[2*de.heap[de.heap_max]+1]=0,xe=de.heap_max+1;xe<g;xe++)ar<(Te=Pe[2*Pe[2*(Oe=de.heap[xe])+1]+1]+1)&&(Te=ar,es++),Pe[2*Oe+1]=Te,Ke<Oe||(de.bl_count[Te]++,be=0,Or<=Oe&&(be=qe[Oe-Or]),Ue=Pe[2*Oe],de.opt_len+=Ue*(Te+be),K&&(de.static_len+=Ue*(H[2*Oe+1]+be)));if(es!==0){do{for(Te=ar-1;de.bl_count[Te]===0;)Te--;de.bl_count[Te]--,de.bl_count[Te+1]+=2,de.bl_count[ar]--,es-=2}while(0<es);for(Te=ar;Te!==0;Te--)for(Oe=de.bl_count[Te];Oe!==0;)Ke<(ce=de.heap[--xe])||(Pe[2*ce+1]!==Te&&(de.opt_len+=(Te-Pe[2*ce+1])*Pe[2*ce],Pe[2*ce+1]=Te),Oe--)}}(M,X),ve(he,ue,M.bl_count)}function T(M,X,ae){var oe,$,he=-1,P=X[1],z=0,J=7,ue=4;for(P===0&&(J=138,ue=3),X[2*(ae+1)+1]=65535,oe=0;oe<=ae;oe++)$=P,P=X[2*(oe+1)+1],++z<J&&$===P||(z<ue?M.bl_tree[2*$]+=z:$!==0?($!==he&&M.bl_tree[2*$]++,M.bl_tree[2*y]++):z<=10?M.bl_tree[2*A]++:M.bl_tree[2*I]++,he=$,ue=(z=0)===P?(J=138,3):$===P?(J=6,3):(J=7,4))}function se(M,X,ae){var oe,$,he=-1,P=X[1],z=0,J=7,ue=4;for(P===0&&(J=138,ue=3),oe=0;oe<=ae;oe++)if($=P,P=X[2*(oe+1)+1],!(++z<J&&$===P)){if(z<ue)for(;Z(M,$,M.bl_tree),--z!=0;);else $!==0?($!==he&&(Z(M,$,M.bl_tree),z--),Z(M,y,M.bl_tree),ie(M,z-3,2)):z<=10?(Z(M,A,M.bl_tree),ie(M,z-3,3)):(Z(M,I,M.bl_tree),ie(M,z-11,7));he=$,ue=(z=0)===P?(J=138,3):$===P?(J=6,3):(J=7,4)}}l(Y);var ne=!1;function B(M,X,ae,oe){ie(M,(u<<1)+(oe?1:0),3),function($,he,P,z){ge($),z&&(_e($,P),_e($,~P)),i.arraySet($.pending_buf,$.window,he,P,$.pending),$.pending+=P}(M,X,ae,!0)}s._tr_init=function(M){ne||(function(){var X,ae,oe,$,he,P=new Array(p+1);for($=oe=0;$<c-1;$++)for(F[$]=oe,X=0;X<1<<R[$];X++)E[oe++]=$;for(E[oe-1]=$,$=he=0;$<16;$++)for(Y[$]=he,X=0;X<1<<x[$];X++)D[he++]=$;for(he>>=7;$<d;$++)for(Y[$]=he<<7,X=0;X<1<<x[$]-7;X++)D[256+he++]=$;for(ae=0;ae<=p;ae++)P[ae]=0;for(X=0;X<=143;)N[2*X+1]=8,X++,P[8]++;for(;X<=255;)N[2*X+1]=9,X++,P[9]++;for(;X<=279;)N[2*X+1]=7,X++,P[7]++;for(;X<=287;)N[2*X+1]=8,X++,P[8]++;for(ve(N,f+1,P),X=0;X<d;X++)O[2*X+1]=5,O[2*X]=le(X,5);j=new ee(N,R,h+1,f,p),L=new ee(O,x,0,d,p),re=new ee(new Array(0),S,0,m,v)}(),ne=!0),M.l_desc=new U(M.dyn_ltree,j),M.d_desc=new U(M.dyn_dtree,L),M.bl_desc=new U(M.bl_tree,re),M.bi_buf=0,M.bi_valid=0,Ce(M)},s._tr_stored_block=B,s._tr_flush_block=function(M,X,ae,oe){var $,he,P=0;0<M.level?(M.strm.data_type===2&&(M.strm.data_type=function(z){var J,ue=4093624447;for(J=0;J<=31;J++,ue>>>=1)if(1&ue&&z.dyn_ltree[2*J]!==0)return o;if(z.dyn_ltree[18]!==0||z.dyn_ltree[20]!==0||z.dyn_ltree[26]!==0)return a;for(J=32;J<h;J++)if(z.dyn_ltree[2*J]!==0)return a;return o}(M)),ke(M,M.l_desc),ke(M,M.d_desc),P=function(z){var J;for(T(z,z.dyn_ltree,z.l_desc.max_code),T(z,z.dyn_dtree,z.d_desc.max_code),ke(z,z.bl_desc),J=m-1;3<=J&&z.bl_tree[2*k[J]+1]===0;J--);return z.opt_len+=3*(J+1)+5+5+4,J}(M),$=M.opt_len+3+7>>>3,(he=M.static_len+3+7>>>3)<=$&&($=he)):$=he=ae+5,ae+4<=$&&X!==-1?B(M,X,ae,oe):M.strategy===4||he===$?(ie(M,2+(oe?1:0),3),Ze(M,N,O)):(ie(M,4+(oe?1:0),3),function(z,J,ue,de){var Fe;for(ie(z,J-257,5),ie(z,ue-1,5),ie(z,de-4,4),Fe=0;Fe<de;Fe++)ie(z,z.bl_tree[2*k[Fe]+1],3);se(z,z.dyn_ltree,J-1),se(z,z.dyn_dtree,ue-1)}(M,M.l_desc.max_code+1,M.d_desc.max_code+1,P+1),Ze(M,M.dyn_ltree,M.dyn_dtree)),Ce(M),oe&&ge(M)},s._tr_tally=function(M,X,ae){return M.pending_buf[M.d_buf+2*M.last_lit]=X>>>8&255,M.pending_buf[M.d_buf+2*M.last_lit+1]=255&X,M.pending_buf[M.l_buf+M.last_lit]=255&ae,M.last_lit++,X===0?M.dyn_ltree[2*ae]++:(M.matches++,X--,M.dyn_ltree[2*(E[ae]+h+1)]++,M.dyn_dtree[2*V(X)]++),M.last_lit===M.lit_bufsize-1},s._tr_align=function(M){ie(M,2,3),Z(M,w,N),function(X){X.bi_valid===16?(_e(X,X.bi_buf),X.bi_buf=0,X.bi_valid=0):8<=X.bi_valid&&(X.pending_buf[X.pending++]=255&X.bi_buf,X.bi_buf>>=8,X.bi_valid-=8)}(M)}},{"../utils/common":41}],53:[function(t,n,s){n.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(t,n,s){(function(i){(function(o,a){if(!o.setImmediate){var l,u,c,h,f=1,d={},m=!1,g=o.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(o);p=p&&p.setTimeout?p:o,l={}.toString.call(o.process)==="[object process]"?function(y){process.nextTick(function(){v(y)})}:function(){if(o.postMessage&&!o.importScripts){var y=!0,A=o.onmessage;return o.onmessage=function(){y=!1},o.postMessage("","*"),o.onmessage=A,y}}()?(h="setImmediate$"+Math.random()+"$",o.addEventListener?o.addEventListener("message",w,!1):o.attachEvent("onmessage",w),function(y){o.postMessage(h+y,"*")}):o.MessageChannel?((c=new MessageChannel).port1.onmessage=function(y){v(y.data)},function(y){c.port2.postMessage(y)}):g&&"onreadystatechange"in g.createElement("script")?(u=g.documentElement,function(y){var A=g.createElement("script");A.onreadystatechange=function(){v(y),A.onreadystatechange=null,u.removeChild(A),A=null},u.appendChild(A)}):function(y){setTimeout(v,0,y)},p.setImmediate=function(y){typeof y!="function"&&(y=new Function(""+y));for(var A=new Array(arguments.length-1),I=0;I<A.length;I++)A[I]=arguments[I+1];var R={callback:y,args:A};return d[f]=R,l(f),f++},p.clearImmediate=_}function _(y){delete d[y]}function v(y){if(m)setTimeout(v,0,y);else{var A=d[y];if(A){m=!0;try{(function(I){var R=I.callback,x=I.args;switch(x.length){case 0:R();break;case 1:R(x[0]);break;case 2:R(x[0],x[1]);break;case 3:R(x[0],x[1],x[2]);break;default:R.apply(a,x)}})(A)}finally{_(y),m=!1}}}}function w(y){y.source===o&&typeof y.data=="string"&&y.data.indexOf(h)===0&&v(+y.data.slice(h.length))}})(typeof self=="undefined"?i===void 0?this:i:self)}).call(this,typeof vr!="undefined"?vr:typeof self!="undefined"?self:typeof window!="undefined"?window:{})},{}]},{},[10])(10)})})(p6);var Qs=p6.exports;/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Dl=function(r,e){return Dl=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,n){t.__proto__=n}||function(t,n){for(var s in n)Object.prototype.hasOwnProperty.call(n,s)&&(t[s]=n[s])},Dl(r,e)};function Gs(r,e){Dl(r,e);function t(){this.constructor=r}r.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var hi=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],Fh={A:0,B:1,C:2,D:3,E:4,F:5,G:6,H:7,I:8,J:9,K:10,L:11,M:12,N:13,O:14,P:15,Q:16,R:17,S:18,T:19,U:20,V:21,W:22,X:23,Y:24,Z:25},fo="docProps/core.xml",Bh="docProps/app.xml",_x="xl/workbook.xml",bx="xl/calcChain.xml",jn="xl/styles.xml",vx="xl/sharedStrings.xml",Cx="xl/theme/theme1.xml",Ex="xl/_rels/workbook.xml.rels",wx={Boolean:"b",Date:"d",Error:"e",InlineString:"inlineStr",Number:"n",SharedString:"s",String:"str"},Lh={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"},Tx={0:"00000000",1:"00FFFFFF",2:"00FF0000",3:"0000FF00",4:"000000FF",5:"00FFFF00",6:"00FF00FF",7:"0000FFFF",8:"00000000",9:"00FFFFFF",10:"00FF0000",11:"0000FF00",12:"000000FF",13:"00FFFF00",14:"00FF00FF",15:"0000FFFF",16:"00800000",17:"00008000",18:"00000080",19:"00808000",20:"00800080",21:"00008080",22:"00C0C0C0",23:"00808080",24:"009999FF",25:"00993366",26:"00FFFFCC",27:"00CCFFFF",28:"00660066",29:"00FF8080",30:"000066CC",31:"00CCCCFF",32:"00000080",33:"00FF00FF",34:"00FFFF00",35:"0000FFFF",36:"00800080",37:"00800000",38:"00008080",39:"000000FF",40:"0000CCFF",41:"00CCFFFF",42:"00CCFFCC",43:"00FFFF99",44:"0099CCFF",45:"00FF99CC",46:"00CC99FF",47:"00FFCC99",48:"003366FF",49:"0033CCCC",50:"0099CC00",51:"00FFCC00",52:"00FF9900",53:"00FF6600",54:"00666699",55:"00969696",56:"00003366",57:"00339966",58:"00003300",59:"00333300",60:"00993300",61:"00993366",62:"00333399",63:"00333333",64:null,65:null},yx={none:0,thin:1,hair:2,dotted:3,dashed:4,dashDot:5,dashDotDot:6,double:7,medium:8,mediumDashed:9,mediumDashDot:10,mediumDashDotDot:11,slantDashDot:12,thick:13},Sx={0:"defualt",1:"Roman",2:"Swiss",3:"Modern",4:"Script",5:"Decorative"};function Io(r,e,t){e===void 0&&(e={}),t===void 0&&(t="1");var n=r.split("!"),s="",i="",o=-1;if(n.length>1){s=n[0],i=n[1];var a=e[s];a==null?o=parseInt(t):o=parseInt(a)}else o=parseInt(t),i=n[0];if(i.indexOf(":")==-1){var l=parseInt(i.replace(/[^0-9]/g,""))-1,u=qn(i.replace(/[^A-Za-z]/g,""));return!isNaN(l)&&!isNaN(u)?{row:[l,l],column:[u,u],sheetIndex:o}:null}else{var c=i.split(":"),l=[],u=[];return l[0]=parseInt(c[0].replace(/[^0-9]/g,""))-1,l[1]=parseInt(c[1].replace(/[^0-9]/g,""))-1,l[0]>l[1]||(u[0]=qn(c[0].replace(/[^A-Za-z]/g,"")),u[1]=qn(c[1].replace(/[^A-Za-z]/g,"")),u[0]>u[1])?null:{row:l,column:u,sheetIndex:o}}}function qn(r){r=r.toUpperCase();var e=r.length;if(e==0)return NaN;for(var t=r.split(""),n=hi.length,s=0,i=e-1;i>=0;i--)i==e-1?s+=Fh[t[i]]:s+=Math.pow(n,e-i-1)*(Fh[t[i]]+1);return s}function ds(r){var e=hi.length;if(r<e)return hi[r];for(var t=0,n="",s=1,i=0;r>=e/(e-1)*(Math.pow(e,s++)-1);)i=s;var o=r-e/(e-1)*(Math.pow(e,i-1)-1);t=o+1;for(var a=i;a>0;a--){var l=t;if(a==1)return l=l%e,l==0&&(l=26),n+hi[l-1];l=Math.ceil(l/Math.pow(e,a-1)),n+=hi[l-1],a>1&&(t=t-(l-1)*e)}}function _6(){return 72/96}function go(r){if(r==null)return 0;var e=r/914400,t=e*72,n=t/_6();return n}function pt(r,e,t){var n=r[e];return n=n==null?t:n,n}function Ph(r){var e=Math.round((r-.83)*8+5);return e}function Hh(r){var e=Math.round(r/_6());return e}function Ax(r,e){var t=r.substring(r.length-6,r.length),n=Dx("#"+t),s=Ix(n[0],n[1],n[2]);if(e>0)s[2]=s[2]*(1-e)+e;else if(e<0)s[2]=s[2]*(1+e);else return"#"+t;var i=xx(s[0],s[1],s[2]);return Rx("RGB("+i.join(",")+")")}function Rx(r){var e=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(/^(rgb|RGB)/.test(r)){for(var t=r.replace(/(?:\(|\)|rgb|RGB)*/g,"").split(","),n="#",s=0;s<t.length;s++){var i=Number(t[s]).toString(16);i.length<2&&(i="0"+i),n+=i}return n.length!==7&&(n=r),n}else if(e.test(r)){var o=r.replace(/#/,"").split("");if(o.length===6)return r;if(o.length===3){for(var a="#",s=0;s<o.length;s+=1)a+=o[s]+o[s];return a}}return r}function Dx(r){var e=r.toLowerCase(),t=/^#([0-9a-fA-f]{3}|[0-9a-fA-f]{6})$/;if(e&&t.test(e)){if(e.length===4){for(var n="#",s=1;s<4;s+=1)n+=e.slice(s,s+1).concat(e.slice(s,s+1));e=n}for(var i=[],s=1;s<7;s+=2)i.push(parseInt("0x"+e.slice(s,s+2)));return i}return null}function xx(r,e,t){var n,s,i;if(e==0)n=s=i=t;else{var o=function(c,h,f){return f<0&&(f+=1),f>1&&(f-=1),f<.16666666666666666?c+(h-c)*6*f:f<.5?h:f<.6666666666666666?c+(h-c)*(.6666666666666666-f)*6:c},a=t<.5?t*(1+e):t+e-t*e,l=2*t-a;n=o(l,a,r+1/3),s=o(l,a,r),i=o(l,a,r-1/3)}return[Math.round(n*255),Math.round(s*255),Math.round(i*255)]}function Ix(r,e,t){r/=255,e/=255,t/=255;var n=Math.max(r,e,t),s=Math.min(r,e,t),i,o,a=(n+s)/2;if(n==s)i=o=0;else{var l=n-s;switch(o=a>.5?l/(2-n-s):l/(n+s),n){case r:i=(e-t)/l+(e<t?6:0);break;case e:i=(t-r)/l+2;break;case t:i=(r-e)/l+4;break}i/=6}return[i,o,a]}function Ox(r){r==null&&(r="Sheet");for(var e=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),t="",n=0;n<5;n++)t+=e[Math.round(Math.random()*(e.length-1))];var s=new Date().getTime();return r+"_"+t+"_"+s}function ei(r){return r==null||r.length==0?r:r.replace(/&amp;/g,"&").replace(/&quot;/g,'"').replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&apos;/g,"'").replace(/&iexcl;/g,"\xA1").replace(/&cent;/g,"\xA2").replace(/&pound;/g,"\xA3").replace(/&curren;/g,"\xA4").replace(/&yen;/g,"\xA5").replace(/&brvbar;/g,"\xA6").replace(/&sect;/g,"\xA7").replace(/&uml;/g,"\xA8").replace(/&copy;/g,"\xA9").replace(/&ordf;/g,"\xAA").replace(/&laquo;/g,"\xAB").replace(/&not;/g,"\xAC").replace(/&shy;/g,"\xAD").replace(/&reg;/g,"\xAE").replace(/&macr;/g,"\xAF").replace(/&deg;/g,"\xB0").replace(/&plusmn;/g,"\xB1").replace(/&sup2;/g,"\xB2").replace(/&sup3;/g,"\xB3").replace(/&acute;/g,"\xB4").replace(/&micro;/g,"\xB5").replace(/&para;/g,"\xB6").replace(/&middot;/g,"\xB7").replace(/&cedil;/g,"\xB8").replace(/&sup1;/g,"\xB9").replace(/&ordm;/g,"\xBA").replace(/&raquo;/g,"\xBB").replace(/&frac14;/g,"\xBC").replace(/&frac12;/g,"\xBD").replace(/&frac34;/g,"\xBE").replace(/&iquest;/g,"\xBF").replace(/&times;/g,"\xD7").replace(/&divide;/g,"\xF7").replace(/&Agrave;/g,"\xC0").replace(/&Aacute;/g,"\xC1").replace(/&Acirc;/g,"\xC2").replace(/&Atilde;/g,"\xC3").replace(/&Auml;/g,"\xC4").replace(/&Aring;/g,"\xC5").replace(/&AElig;/g,"\xC6").replace(/&Ccedil;/g,"\xC7").replace(/&Egrave;/g,"\xC8").replace(/&Eacute;/g,"\xC9").replace(/&Ecirc;/g,"\xCA").replace(/&Euml;/g,"\xCB").replace(/&Igrave;/g,"\xCC").replace(/&Iacute;/g,"\xCD").replace(/&Icirc;/g,"\xCE").replace(/&Iuml;/g,"\xCF").replace(/&ETH;/g,"\xD0").replace(/&Ntilde;/g,"\xD1").replace(/&Ograve;/g,"\xD2").replace(/&Oacute;/g,"\xD3").replace(/&Ocirc;/g,"\xD4").replace(/&Otilde;/g,"\xD5").replace(/&Ouml;/g,"\xD6").replace(/&Oslash;/g,"\xD8").replace(/&Ugrave;/g,"\xD9").replace(/&Uacute;/g,"\xDA").replace(/&Ucirc;/g,"\xDB").replace(/&Uuml;/g,"\xDC").replace(/&Yacute;/g,"\xDD").replace(/&THORN;/g,"\xDE").replace(/&szlig;/g,"\xDF").replace(/&agrave;/g,"\xE0").replace(/&aacute;/g,"\xE1").replace(/&acirc;/g,"\xE2").replace(/&atilde;/g,"\xE3").replace(/&auml;/g,"\xE4").replace(/&aring;/g,"\xE5").replace(/&aelig;/g,"\xE6").replace(/&ccedil;/g,"\xE7").replace(/&egrave;/g,"\xE8").replace(/&eacute;/g,"\xE9").replace(/&ecirc;/g,"\xEA").replace(/&euml;/g,"\xEB").replace(/&igrave;/g,"\xEC").replace(/&iacute;/g,"\xED").replace(/&icirc;/g,"\xEE").replace(/&iuml;/g,"\xEF").replace(/&eth;/g,"\xF0").replace(/&ntilde;/g,"\xF1").replace(/&ograve;/g,"\xF2").replace(/&oacute;/g,"\xF3").replace(/&ocirc;/g,"\xF4").replace(/&otilde;/g,"\xF5").replace(/&ouml;/g,"\xF6").replace(/&oslash;/g,"\xF8").replace(/&ugrave;/g,"\xF9").replace(/&uacute;/g,"\xFA").replace(/&ucirc;/g,"\xFB").replace(/&uuml;/g,"\xFC").replace(/&yacute;/g,"\xFD").replace(/&thorn;/g,"\xFE").replace(/&yuml;/g,"\xFF")}var mo=function(){function r(){}return r.trim=function(e){return e==null&&(e=""),e.replace(/(^\s*)|(\s*$)/g,"")},r.functionCopy=function(e,t,n){var s=this;if(s.operatorjson==null){for(var i=s.operator.split("|"),o={},a=0;a<i.length;a++)o[i[a].toString()]=1;s.operatorjson=o}t==null&&(t="down"),n==null&&(n=1),e.substr(0,1)=="="&&(e=e.substr(1));for(var l=e.split(""),u=0,c="",h="",f={bracket:0,comma:0,squote:0,dquote:0};u<l.length;){var d=l[u];if(d=="("&&f.dquote==0)f.bracket+=1,c.length>0?h+=c+"(":h+="(",c="";else if(d==")"&&f.dquote==0)f.bracket-=1,h+=s.functionCopy(c,t,n)+")",c="";else if(d=='"'&&f.squote==0)f.dquote>0?(h+=c+'"',f.dquote-=1,c=""):(f.dquote+=1,c+='"');else if(d==","&&f.dquote==0)h+=s.functionCopy(c,t,n)+",",c="";else if(d=="&"&&f.dquote==0)c.length>0?(h+=s.functionCopy(c,t,n)+"&",c=""):h+="&";else if(d in s.operatorjson&&f.dquote==0){var m="";u+1<l.length&&(m=l[u+1]);var g=u-1,p=null;if(g>=0)do p=l[g--];while(g>=0&&p==" ");d+m in s.operatorjson?(c.length>0?(h+=s.functionCopy(c,t,n)+d+m,c=""):h+=d+m,u++):!/[^0-9]/.test(m)&&d=="-"&&(p=="("||p==null||p==","||p==" "||p in s.operatorjson)?c+=d:c.length>0?(h+=s.functionCopy(c,t,n)+d,c=""):h+=d}else c+=d;u==l.length-1&&(s.iscelldata(s.trim(c))?t=="down"?h+=s.downparam(s.trim(c),n):t=="up"?h+=s.upparam(s.trim(c),n):t=="left"?h+=s.leftparam(s.trim(c),n):t=="right"&&(h+=s.rightparam(s.trim(c),n)):h+=s.trim(c)),u++}return h},r.downparam=function(e,t){return this.updateparam("d",e,t)},r.upparam=function(e,t){return this.updateparam("u",e,t)},r.leftparam=function(e,t){return this.updateparam("l",e,t)},r.rightparam=function(e,t){return this.updateparam("r",e,t)},r.updateparam=function(e,t,n){var s=this,i=t.split("!"),o,a="";if(i.length>1?(o=i[1],a=i[0]+"!"):o=i[0],o.indexOf(":")==-1){var l=parseInt(o.replace(/[^0-9]/g,"")),u=qn(o.replace(/[^A-Za-z]/g,"")),c=s.isfreezonFuc(o),h=c[0]?"$":"",f=c[1]?"$":"";return e=="u"&&!c[0]?l-=n:e=="r"&&!c[1]?u+=n:e=="l"&&!c[1]?u-=n:c[0]||(l+=n),l<0||u<0?s.error.r:!isNaN(l)&&!isNaN(u)?a+f+ds(u)+h+l:isNaN(l)?isNaN(u)?t:a+f+ds(u):a+h+l}else{o=o.split(":");var l=[],u=[];if(l[0]=parseInt(o[0].replace(/[^0-9]/g,"")),l[1]=parseInt(o[1].replace(/[^0-9]/g,"")),l[0]>l[1]||(u[0]=qn(o[0].replace(/[^A-Za-z]/g,"")),u[1]=qn(o[1].replace(/[^A-Za-z]/g,"")),u[0]>u[1]))return t;var d=s.isfreezonFuc(o[0]),m=s.isfreezonFuc(o[1]),g=d[0]?"$":"",p=d[1]?"$":"",_=m[0]?"$":"",v=m[1]?"$":"";return e=="u"?(d[0]||(l[0]-=n),m[0]||(l[1]-=n)):e=="r"?(d[1]||(u[0]+=n),m[1]||(u[1]+=n)):e=="l"?(d[1]||(u[0]-=n),m[1]||(u[1]-=n)):(d[0]||(l[0]+=n),m[0]||(l[1]+=n)),l[0]<0||u[0]<0?s.error.r:isNaN(u[0])&&isNaN(u[1])?a+g+l[0]+":"+_+l[1]:isNaN(l[0])&&isNaN(l[1])?a+p+ds(u[0])+":"+v+ds(u[1]):a+p+ds(u[0])+g+l[0]+":"+v+ds(u[1])+_+l[1]}},r.iscelldata=function(e){var t=e.split("!"),n;t.length>1?n=t[1]:n=t[0];var s=/^(([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+))$/g,i=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+))))$/g;if(n.indexOf(":")==-1){var o=parseInt(n.replace(/[^0-9]/g,""))-1,a=qn(n.replace(/[^A-Za-z]/g,""));return!isNaN(o)&&!isNaN(a)&&n.toString().match(s)?!0:(isNaN(o)&&isNaN(a),!1)}else{i=/^(((([a-zA-Z]+)|([$][a-zA-Z]+))(([0-9]+)|([$][0-9]+)))|((([a-zA-Z]+)|([$][a-zA-Z]+)))|((([0-9]+)|([$][0-9]+s))))$/g,n=n.split(":");var o=[],a=[];return o[0]=parseInt(n[0].replace(/[^0-9]/g,""))-1,o[1]=parseInt(n[1].replace(/[^0-9]/g,""))-1,o[0]>o[1]||(a[0]=qn(n[0].replace(/[^A-Za-z]/g,"")),a[1]=qn(n[1].replace(/[^A-Za-z]/g,"")),a[0]>a[1])?!1:!!(n[0].toString().match(i)&&n[1].toString().match(i))}},r.isfreezonFuc=function(e){var t=e.replace(/[^0-9]/g,""),n=e.replace(/[^A-Za-z]/g,""),s=e.substr(e.indexOf(t)-1,1),i=e.substr(e.indexOf(n)-1,1),o=[!1,!1];return s=="$"&&(o[0]=!0),i=="$"&&(o[1]=!0),o},r.operator="==|!=|<>|<=|>=|=|+|-|>|<|/|*|%|&|^",r.error={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"},r.operatorjson=null,r}();function kx(r){var e=/[^\u4e00-\u9fa5]/,t=/[\u3002|\uff1f|\uff01|\uff0c|\u3001|\uff1b|\uff1a|\u201c|\u201d|\u2018|\u2019|\uff08|\uff09|\u300a|\u300b|\u3008|\u3009|\u3010|\u3011|\u300e|\u300f|\u300c|\u300d|\ufe43|\ufe44|\u3014|\u3015|\u2026|\u2014|\uff5e|\ufe4f|\uffe5]/;return t.test(r)?!0:!e.test(r)}function Nx(r){var e=/[^\u0800-\u4e00]/;return!e.test(r)}function Mx(r){return r>12592&&r<12687||r>=44032&&r<=55203}function Fx(r,e){var t,n,s,i;e||(e={});var o=function(){try{return new window.XMLHttpRequest}catch{}},a=function(){try{return new window.ActiveXObject("Microsoft.XMLHTTP")}catch{}},l=typeof window!="undefined"&&window.ActiveXObject?function(){return o()||a()}:o;typeof e=="function"?(i=e,e={}):typeof e.callback=="function"&&(i=e.callback),n=function(c){i(null,c)},s=function(c){i(c,null)};try{var u=l();u.open("GET",r,!0),"responseType"in u&&(u.responseType="arraybuffer"),u.overrideMimeType&&u.overrideMimeType("text/plain; charset=x-user-defined"),u.onreadystatechange=function(c){if(u.readyState===4)if(u.status===200||u.status===0)try{n(function(h){return h.response||h.responseText}(u))}catch(h){s(new Error(h))}else s(new Error("Ajax error for "+r+" : "+this.status+" "+this.statusText))},e.progress&&(u.onprogress=function(c){e.progress({path:r,originalEvent:c,percent:c.loaded/c.total*100,loaded:c.loaded,total:c.total})}),u.send()}catch(c){s(new Error(c),null)}return t}var b6=function(){function r(){}return r.prototype.getElementsByOneTag=function(e,t){var n;if(e.indexOf("|")>-1){for(var s=e.split("|"),i="",o=0;o<s.length;o++){var a=s[o];i+="|<"+a+" [^>]+?[^/]>[\\s\\S]*?</"+a+">|<"+a+" [^>]+?/>|<"+a+">[\\s\\S]*?</"+a+">|<"+a+"/>"}i=i.substr(1,i.length),n=new RegExp(i,"g")}else n=new RegExp("<"+e+" [^>]+?[^/]>[\\s\\S]*?</"+e+">|<"+e+" [^>]+?/>|<"+e+">[\\s\\S]*?</"+e+">|<"+e+"/>","g");var l=t.match(n);return l==null?[]:l},r}(),Bx=function(r){Gs(e,r);function e(t){var n=r.call(this)||this;return n.originFile=t,n}return e.prototype.getElementsByTagName=function(t,n){var s=this.getFileByName(n),i=t.split("/"),o;for(var a in i){var l=i[a];if(o==null)o=this.getElementsByOneTag(l,s);else if(o instanceof Array){var u=[];for(var c in o){var h=o[c];u=u.concat(this.getElementsByOneTag(l,h))}o=u}else o=this.getElementsByOneTag(l,o)}for(var f=[],d=0;d<o.length;d++){var m=new Lx(o[d]);f.push(m)}return f},e.prototype.getFileByName=function(t){for(var n in this.originFile)if(n.indexOf(t)>-1)return this.originFile[n];return""},e}(b6),Lx=function(r){Gs(e,r);function e(t){var n=r.call(this)||this;n.elementString=t,n.setValue();var s=new RegExp('[a-zA-Z0-9_:]*?=".*?"',"g"),i=n.container.match(s);if(n.attributeList={},i!=null)for(var o in i){var a=i[o];if(a.length!=0){var l=a.substr(0,a.indexOf("=")),u=a.substr(a.indexOf("=")+1);l==null||u==null||l.length==0||u.length==0||(n.attributeList[l]=u.substr(1,u.length-2))}}return n}return e.prototype.get=function(t){return this.attributeList[t]},e.prototype.getInnerElements=function(t){for(var n=this.getElementsByOneTag(t,this.elementString),s=[],i=0;i<n.length;i++){var o=new e(n[i]);s.push(o)}return s.length==0?null:s},e.prototype.setValue=function(){var t=this.elementString;if(t.substr(t.length-2,2)=="/>")this.value="",this.container=t;else{var n=this.getFirstTag(),s=new RegExp("(<"+n+" [^>]+?[^/]>)([\\s\\S]*?)</"+n+">|(<"+n+">)([\\s\\S]*?)</"+n+">","g"),i=s.exec(t);i!=null&&(i[1]!=null?(this.container=i[1],this.value=i[2]):(this.container=i[3],this.value=i[4]))}},e.prototype.getFirstTag=function(){var t=this.elementString,n=t.substr(0,t.indexOf(" "));return(n==""||n.indexOf(">")>-1)&&(n=t.substr(0,t.indexOf(">"))),n=n.substr(1,n.length),n},e}(b6);function Px(r,e){var t={};if(r==null||r.length==0)return e;for(var n in e){var s=e[n],i=parseInt(n),o=r[i];if(o==null)t[n]=s;else{var a=o.attributeList.rgb;t[n]=a}}return t}function bs(r,e,t){var n=r.attributeList,s=e.clrScheme,i=e.indexedColors;e.mruColors;var o=Px(i,Tx),a=n.indexed,l=n.rgb,u=n.theme,c=n.tint,h;if(a!=null){var f=parseInt(a);h=o[f],h!=null&&(h=h.substring(h.length-6,h.length),h="#"+h)}else if(l!=null)l=l.substring(l.length-6,l.length),h="#"+l;else if(u!=null){var d=parseInt(u);d==0?d=1:d==1?d=0:d==2?d=3:d==3&&(d=2);var m=s[d];if(m!=null){var g=m.getInnerElements("a:sysClr|a:srgbClr");if(g!=null){var p=g[0],_=p.attributeList;p.container.indexOf("sysClr")>-1?_.lastClr!=null?h="#"+_.lastClr:_.val!=null&&(h="#"+_.val):p.container.indexOf("srgbClr")>-1&&(h="#"+_.val)}}}if(c!=null){var v=parseFloat(c);h!=null&&(h=Ax(h,v))}return h}function Bn(r,e){var t=r.getInnerElements(e),n;if(t!=null&&t.length>0)if(e=="b"||e=="i"||e=="strike")n="1";else if(e=="u"){var s=t[0].attributeList.val;s=="double"?n="2":s=="singleAccounting"?n="3":s=="doubleAccounting"?n="4":n="1"}else if(e=="vertAlign"){var s=t[0].attributeList.val;s=="subscript"?n="1":s=="superscript"&&(n="2")}else n=t[0].attributeList.val;return n}var Uh=function(){function r(){}return r}(),v6=function(){function r(){}return r}(),Hx=function(){function r(){}return r}(),C6=function(){function r(){}return r}(),Ux=function(){function r(){}return r}(),po=function(){function r(){}return r}(),_o=function(){function r(){}return r}(),zx=function(){function r(){}return r}(),Wx=function(){function r(){}return r}(),Vx=function(){function r(){}return r}(),Gx=function(){function r(){}return r}(),Xx=function(){function r(){}return r}(),zh=function(){function r(){}return r}(),$x=function(){function r(){}return r}(),Yx=function(r){Gs(e,r);function e(t,n,s,i,o,a){var l=r.call(this)||this;l.cell=t,l.sheetFile=o,l.styles=n,l.sharedStrings=s,l.readXml=a,l.mergeCells=i;var u=t.attributeList,c=u.r,h=u.s,f=u.t,d=Io(c);return l.r=d.row[0],l.c=d.column[0],l.v=l.generateValue(h,f),l}return e.prototype.generateValue=function(t,n){var s=this,i=this.cell.getInnerElements("v"),o=this.cell.getInnerElements("f");i==null&&(i=this.cell.getInnerElements("t"));var a=this.styles.cellXfs,l=this.styles.cellStyleXfs;this.styles.cellStyles;var u=this.styles.fonts,c=this.styles.fills,h=this.styles.borders,f=this.styles.numfmts,d=this.styles.clrScheme,m=this.sharedStrings,g=new Ux;if(o!=null){var p=o[0],_=p.attributeList,v=_.t,w=_.ref,y=_.si,A=o[0].value;v=="shared"&&(this._fomulaRef=w,this._formulaType=v,this._formulaSi=y),(w!=null||A!=null&&A.length>0)&&(A=ei(A),g.f="="+A)}var I=null,R;if(t!=null){var x=parseInt(t),S=a[x],k=S.attributeList.xfId,N=void 0,O=void 0,D=void 0,E=void 0,F=void 0,j=void 0,L=void 0,re=void 0;if(k!=null){var Y=l[parseInt(k)],_=Y.attributeList,ee=_.applyNumberFormat,U=_.applyFont,V=_.applyFill,_e=_.applyBorder,ie=_.applyAlignment;if(_.applyProtection,R=_.quotePrefix,ee!="0"&&_.numFmtId!=null&&(N=_.numFmtId),U!="0"&&_.fontId!=null&&(O=_.fontId),V!="0"&&_.fillId!=null&&(D=_.fillId),_e!="0"&&_.borderId!=null&&(E=_.borderId),ie!=null&&ie!="0"){var Z=Y.getInnerElements("alignment");if(Z!=null){var le=Z[0].attributeList;le.horizontal!=null&&(F=le.horizontal),le.vertical!=null&&(j=le.vertical),le.wrapText!=null&&(L=le.wrapText),le.textRotation!=null&&(re=le.textRotation),le.shrinkToFit!=null&&le.shrinkToFit,le.indent!=null&&le.indent}}}var ve=S.attributeList.applyNumberFormat,Ce=S.attributeList.applyFont,ge=S.attributeList.applyFill,ye=S.attributeList.applyBorder,Me=S.attributeList.applyAlignment;if(S.attributeList.applyProtection!=null&&S.attributeList.applyProtection,S.attributeList.quotePrefix!=null&&(R=S.attributeList.quotePrefix),ve!="0"&&S.attributeList.numFmtId!=null&&(N=S.attributeList.numFmtId),Ce!="0"&&(O=S.attributeList.fontId),ge!="0"&&(D=S.attributeList.fillId),ye!="0"&&(E=S.attributeList.borderId),Me!="0"){var Z=S.getInnerElements("alignment");if(Z!=null&&Z.length>0){var _=Z[0].attributeList;_.horizontal!=null&&(F=_.horizontal),_.vertical!=null&&(j=_.vertical),_.wrapText!=null&&(L=_.wrapText),_.textRotation!=null&&(re=_.textRotation),_.shrinkToFit!=null&&_.shrinkToFit,_.indent!=null&&_.indent}}if(N!=null){var Ze=f[parseInt(N)],ke=new po;ke.fa=ei(Ze),ke.t=n,g.ct=ke}if(D!=null){var T=parseInt(D),se=c[T],ne=this.getBackgroundByFill(se,d);ne!=null&&(g.bg=ne)}if(O!=null){var B=parseInt(O),M=u[B];if(M!=null){var X=M.getInnerElements("sz"),ae=M.getInnerElements("color"),oe=M.getInnerElements("name"),$=M.getInnerElements("family");M.getInnerElements("charset");var he=M.getInnerElements("b"),P=M.getInnerElements("i"),z=M.getInnerElements("strike"),J=M.getInnerElements("u");if(X!=null&&X.length>0){var ue=X[0].attributeList.val;ue!=null&&(g.fs=parseInt(ue))}if(ae!=null&&ae.length>0){var de=ae[0],Fe=bs(de,this.styles);Fe!=null&&(g.fc=Fe)}if($!=null&&$.length>0){var xe=$[0].attributeList.val;xe!=null&&(I=Sx[xe])}if(oe!=null&&oe.length>0){var xe=oe[0].attributeList.val;xe!=null&&(g.ff=xe)}if(he!=null&&he.length>0){var Oe=he[0].attributeList.val;Oe=="0"?g.bl=0:g.bl=1}if(P!=null&&P.length>0){var ce=P[0].attributeList.val;ce=="0"?g.it=0:g.it=1}if(z!=null&&z.length>0){var Te=z[0].attributeList.val;Te=="0"?g.cl=0:g.cl=1}if(J!=null&&J.length>0){var be=J[0].attributeList.val;be=="single"?g.un=1:be=="double"?g.un=2:be=="singleAccounting"?g.un=3:be=="doubleAccounting"?g.un=4:g.un=0}}}if(F!=null&&(F=="center"||F=="centerContinuous"?g.ht=0:F=="left"?g.ht=1:F=="right"?g.ht=2:F=="distributed"?g.ht=0:F=="fill"||F=="general"?g.ht=1:F=="justify"?g.ht=0:g.ht=1),j!=null&&(j=="bottom"?g.vt=2:j=="center"||j=="distributed"||j=="justify"?g.vt=0:(j=="top",g.vt=1)),L!=null&&L=="1"?g.tb=2:g.tb=1,re!=null&&(re=="255"?g.tr=3:(g.tr=0,g.rt=parseInt(re))),E!=null){var Ue=parseInt(E),Pe=h[Ue],Ke=new Wx;Ke.rangeType="cell";var H=new Vx;H.row_index=this.r,H.col_index=this.c;var K=Pe.getInnerElements("left"),qe=Pe.getInnerElements("right"),Or=Pe.getInnerElements("top"),ar=Pe.getInnerElements("bottom"),es=Pe.getInnerElements("diagonal"),E6=Pe.getInnerElements("start"),w6=Pe.getInnerElements("end"),ga=this.getBorderInfo(K),ma=this.getBorderInfo(qe),pa=this.getBorderInfo(Or),_a=this.getBorderInfo(ar);this.getBorderInfo(es);var ba=this.getBorderInfo(E6),va=this.getBorderInfo(w6),kr=!1;ba!=null&&ba.color!=null&&(H.l=ba,kr=!0),va!=null&&va.color!=null&&(H.r=va,kr=!0),ga!=null&&ga.color!=null&&(H.l=ga,kr=!0),ma!=null&&ma.color!=null&&(H.r=ma,kr=!0),pa!=null&&pa.color!=null&&(H.t=pa,kr=!0),_a!=null&&_a.color!=null&&(H.b=_a,kr=!0),kr&&(Ke.value=H,this._borderObject=Ke)}}else g.tb=1;if(i!=null){var ts=i[0].value;if(/&#\d+;/.test(ts)&&(ts=this.htmlDecode(ts)),n==wx.SharedString){var T6=parseInt(i[0].value),Fu=m[T6],Bu=Fu.getInnerElements("r");if(Bu==null){var Lu=Fu.getInnerElements("t");if(Lu!=null){var vn="";if(Lu.forEach(function(y6){vn+=y6.value}),vn=ei(vn),I=="Roman"&&vn.length>0){var Gi=vn.split(""),Xi=null,Xs="",Ca=null,Pu="Times New Roman";g.ff!=null&&(Pu=g.ff);var ke=g.ct;ke==null&&(ke=new po),ke.s==null&&(ke.s=[]);for(var $s=0;$s<Gi.length;$s++){var Nr=Gi[$s],Mr=null,ns=Pu;if(kx(Nr)?(Mr="c",ns="\u5B8B\u4F53"):Nx(Nr)?(Mr="j",ns="Yu Gothic"):Mx(Nr)?(Mr="k",ns="Malgun Gothic"):Mr="e",Mr!=Xi&&Xi!=null||$s==Gi.length-1){var mt=new _o;if(mt.ff=Ca,g.fc!=null&&(mt.fc=g.fc),g.fs!=null&&(mt.fs=g.fs),g.cl!=null&&(mt.cl=g.cl),g.un!=null&&(mt.un=g.un),g.bl!=null&&(mt.bl=g.bl),g.it!=null&&(mt.it=g.it),$s==Gi.length-1)if(Mr==Xi)mt.ff=ns,mt.v=Xs+Nr;else{mt.ff=Ca,mt.v=Xs,ke.s.push(mt);var $n=new _o;$n.ff=ns,$n.v=Nr,g.fc!=null&&($n.fc=g.fc),g.fs!=null&&($n.fs=g.fs),g.cl!=null&&($n.cl=g.cl),g.un!=null&&($n.un=g.un),g.bl!=null&&($n.bl=g.bl),g.it!=null&&($n.it=g.it),ke.s.push($n);break}else mt.v=Xs;ke.s.push(mt),Xs=Nr}else Xs+=Nr;Xi=Mr,Ca=ns}ke.t="inlineStr",g.ct=ke}else if(vn=this.replaceSpecialWrap(vn),vn.indexOf(`\r
`)>-1||vn.indexOf(`
`)>-1){var mt=new _o;mt.v=vn;var ke=g.ct;ke==null&&(ke=new po),g.ff!=null&&(mt.ff=g.ff),g.fc!=null&&(mt.fc=g.fc),g.fs!=null&&(mt.fs=g.fs),g.cl!=null&&(mt.cl=g.cl),g.un!=null&&(mt.un=g.un),g.bl!=null&&(mt.bl=g.bl),g.it!=null&&(mt.it=g.it),ke.t="inlineStr",ke.s=[mt],g.ct=ke}else g.v=vn,R="1"}}else{var Hu=[];Bu.forEach(function(Uu){var Ea=Uu.getInnerElements("t"),wa=Uu.getInnerElements("rPr"),st=new _o;if(Ea!=null&&Ea.length>0){var Ys=Ea[0].value;Ys=s.replaceSpecialWrap(Ys),Ys=ei(Ys),st.v=Ys}if(wa!=null&&wa.length>0){var Cn=wa[0],zu=Bn(Cn,"sz"),Wu=Bn(Cn,"rFont");Bn(Cn,"family"),Bn(Cn,"charset"),Bn(Cn,"scheme");var Vu=Bn(Cn,"b"),Gu=Bn(Cn,"i"),Xu=Bn(Cn,"u"),$u=Bn(Cn,"strike"),Yu=Bn(Cn,"vertAlign"),Ta=void 0,ya=Cn.getInnerElements("color");ya!=null&&ya.length>0&&(Ta=bs(ya[0],s.styles));var Sa=void 0;Wu!=null&&(Sa=Wu),Sa!=null?st.ff=Sa:g.ff!=null&&(st.ff=g.ff),Ta!=null?st.fc=Ta:g.fc!=null&&(st.fc=g.fc),zu!=null?st.fs=parseInt(zu):g.fs!=null&&(st.fs=g.fs),$u!=null?st.cl=parseInt($u):g.cl!=null&&(st.cl=g.cl),Xu!=null?st.un=parseInt(Xu):g.un!=null&&(st.un=g.un),Vu!=null?st.bl=parseInt(Vu):g.bl!=null&&(st.bl=g.bl),Gu!=null?st.it=parseInt(Gu):g.it!=null&&(st.it=g.it),Yu!=null&&(st.va=parseInt(Yu))}else st.ff==null&&g.ff!=null&&(st.ff=g.ff),st.fc==null&&g.fc!=null&&(st.fc=g.fc),st.fs==null&&g.fs!=null&&(st.fs=g.fs),st.cl==null&&g.cl!=null&&(st.cl=g.cl),st.un==null&&g.un!=null&&(st.un=g.un),st.bl==null&&g.bl!=null&&(st.bl=g.bl),st.it==null&&g.it!=null&&(st.it=g.it);Hu.push(st)});var ke=g.ct;ke==null&&(ke=new po),ke.t="inlineStr",ke.s=Hu,g.ct=ke}}else ts=ei(ts),g.v=ts}return R!=null&&(g.qp=parseInt(R)),g},e.prototype.replaceSpecialWrap=function(t){return t=t.replace(/_x000D_/g,"").replace(/&#13;&#10;/g,`\r
`).replace(/&#13;/g,"\r").replace(/&#10;/g,`
`),t},e.prototype.getBackgroundByFill=function(t,n){var s=t.getInnerElements("patternFill");if(s!=null){var i=s[0],o=i.getInnerElements("fgColor"),a=i.getInnerElements("bgColor"),l=void 0,u=void 0;if(o!=null){var c=o[0];l=bs(c,this.styles)}if(a!=null){var h=a[0];u=bs(h,this.styles)}if(l!=null)return l;if(u!=null)return u}else{var f=t.getInnerElements("gradientFill");if(f!=null)return null}},e.prototype.getBorderInfo=function(t){if(t==null)return null;var n=t[0],s=n.attributeList;this.styles.clrScheme;var i=s.style;if(i==null||i=="none")return null;var o=n.getInnerElements("color"),a="#000000";if(o!=null){var l=o[0];a=bs(l,this.styles),a==null&&(a="#000000")}var u=new Gx;return u.style=yx[i],u.color=a,u},e.prototype.htmlDecode=function(t){return t.replace(/&#(x)?([^&]{1,5});?/g,function(n,s,i){return String.fromCharCode(parseInt(i,s?16:10))})},e}(C6),jx=function(r){Gs(e,r);function e(t,n,s,i,o){i===void 0&&(i=!1);var a=r.call(this)||this;a.isInitialCell=i,a.readXml=o.readXml,a.sheetFile=o.sheetFile,a.styles=o.styles,a.sharedStrings=o.sharedStrings,a.calcChainEles=o.calcChain,a.sheetList=o.sheetList,a.imageList=o.imageList,a.name=t,a.index=n,a.order=s.toString(),a.config=new zx,a.celldata=[],a.mergeCells=a.readXml.getElementsByTagName("mergeCells/mergeCell",a.sheetFile),a.styles.clrScheme;var l=a.readXml.getElementsByTagName("sheetViews/sheetView",a.sheetFile),u="1",c="0",h="100",f="A1";if(l.length>0){var d=l[0].attributeList;u=pt(d,"showGridLines","1"),c=pt(d,"tabSelected","0"),h=pt(d,"zoomScale","100");var m=l[0].getInnerElements("selection");if(m!=null&&m.length>0){f=pt(m[0].attributeList,"activeCell","A1");var g=Io(f,a.sheetList,n);a.luckysheet_select_save=[],a.luckysheet_select_save.push(g)}}a.showGridLines=u,a.status=c,a.zoomRatio=parseInt(h)/100;var p=a.readXml.getElementsByTagName("sheetPr/tabColor",a.sheetFile);if(p!=null&&p.length>0){var _=p[0],d=_.attributeList,v=bs(_,a.styles);a.color=v}var w=a.readXml.getElementsByTagName("sheetFormatPr",a.sheetFile),y,A;if(w.length>0){var d=w[0].attributeList;y=pt(d,"defaultColWidth","9.21"),A=pt(d,"defaultRowHeight","19")}a.defaultColWidth=Ph(parseFloat(y)),a.defaultRowHeight=Hh(parseFloat(A)),a.generateConfigColumnLenAndHidden();var I=a.generateConfigRowLenAndHiddenAddCell();if(a.formulaRefList!=null)for(var R in a.formulaRefList){var x=a.formulaRefList[R],S=x.mainRef,k=S.cellValue,N=S.fv,O=k.r,D=k.c;for(var E in x)if(E!="mainRef"){var F=x[E],j=F.cellValue;if(j!=null){var L=j.r,re=j.c,Y=N,ee=L-O,U=re-D;ee>0?Y="="+mo.functionCopy(Y,"down",ee):ee<0&&(Y="="+mo.functionCopy(Y,"up",Math.abs(ee))),U>0?Y="="+mo.functionCopy(Y,"right",U):U<0&&(Y="="+mo.functionCopy(Y,"left",Math.abs(U))),j.v.f=Y}}}a.calcChain==null&&(a.calcChain=[]);for(var V={},re=0;re<a.calcChainEles.length;re++){var _e=a.calcChainEles[re],d=_e.attributeList;if(d.i==n){var L=d.r,ie=d.i;d.l,d.s,d.a,d.t;var g=Io(L),Z=new zh;Z.r=g.row[0],Z.c=g.column[0],Z.index=a.index,a.calcChain.push(Z),V["r"+L+"c"+re]=null}}for(var R in I.formulaList)if(!(R in V)){var le=I.formulaList[R],Z=new zh;Z.r=le.r,Z.c=le.c,Z.index=a.index,a.calcChain.push(Z)}if(a.mergeCells!=null)for(var ie=0;ie<a.mergeCells.length;ie++){var ve=a.mergeCells[ie],d=ve.attributeList,Ce=d.ref;if(Ce!=null){var g=Io(Ce,a.sheetList,n),ge=new Xx;ge.r=g.row[0],ge.c=g.column[0],ge.rs=g.row[1]-g.row[0]+1,ge.cs=g.column[1]-g.column[0]+1,a.config.merge==null&&(a.config.merge={}),a.config.merge[g.row[0]+"_"+g.column[0]]=ge}}var ye=o.drawingFile,Me=o.drawingRelsFile;if(ye!=null&&Me!=null){var Ze=a.readXml.getElementsByTagName("xdr:twoCellAnchor",ye);if(Ze!=null&&Ze.length>0)for(var ie=0;ie<Ze.length;ie++){var ke=Ze[ie],T=pt(ke.attributeList,"editAs","twoCell"),se=ke.getInnerElements("xdr:from"),ne=ke.getInnerElements("xdr:to"),B=ke.getInnerElements("a:blip");if(se!=null&&B!=null&&se.length>0&&B.length>0){var M=se[0],X=ne[0],ae=B[0],oe=pt(ae.attributeList,"r:embed",null),$=a.getBase64ByRid(oe,Me),he=0,P=0,z=0,J=0;$.fromCol=a.getXdrValue(M.getInnerElements("xdr:col")),$.fromColOff=go(a.getXdrValue(M.getInnerElements("xdr:colOff"))),$.fromRow=a.getXdrValue(M.getInnerElements("xdr:row")),$.fromRowOff=go(a.getXdrValue(M.getInnerElements("xdr:rowOff"))),$.toCol=a.getXdrValue(X.getInnerElements("xdr:col")),$.toColOff=go(a.getXdrValue(X.getInnerElements("xdr:colOff"))),$.toRow=a.getXdrValue(X.getInnerElements("xdr:row")),$.toRowOff=go(a.getXdrValue(X.getInnerElements("xdr:rowOff"))),$.originWidth=z,$.originHeight=J,T=="absolute"?$.type="3":T=="oneCell"?$.type="2":$.type="1",$.isFixedPos=!1,$.fixedLeft=0,$.fixedTop=0;var ue={color:"#000",radius:0,style:"solid",width:0};$.border=ue;var de={height:J,offsetLeft:0,offsetTop:0,width:z};$.crop=de;var Fe={height:J,left:he,top:P,width:z};$.default=Fe,a.images==null&&(a.images={}),a.images[Ox("image")]=$}}}return a}return e.prototype.getXdrValue=function(t){return t==null||t.length==0?null:parseInt(t[0].value)},e.prototype.getBase64ByRid=function(t,n){var s=this.readXml.getElementsByTagName("Relationships/Relationship",n);if(s!=null&&s.length>0)for(var i=0;i<s.length;i++){var o=s[i],a=o.attributeList,l=pt(a,"Id",null),u=pt(a,"Target",null);if(l==t){u=u.replace(/\.\.\//g,""),u="xl/"+u;var c=this.imageList.getImageByName(u);return c}}return null},e.prototype.generateConfigColumnLenAndHidden=function(){for(var t=this.readXml.getElementsByTagName("cols/col",this.sheetFile),n=0;n<t.length;n++){var s=t[n],i=s.attributeList,o=pt(i,"min",null),a=pt(i,"max",null),l=pt(i,"width",null),u=pt(i,"hidden",null),c=pt(i,"customWidth",null);if(!(o==null||a==null))for(var h=parseInt(o)-1,f=parseInt(a)-1,d=parseFloat(l),m=h;m<=f;m++)l!=null&&(this.config.columnlen==null&&(this.config.columnlen={}),this.config.columnlen[m]=Ph(d)),u=="1"&&(this.config.colhidden==null&&(this.config.colhidden={}),this.config.colhidden[m]=0,this.config.columnlen&&delete this.config.columnlen[m]),c!=null&&(this.config.customWidth==null&&(this.config.customWidth={}),this.config.customWidth[m]=1)}},e.prototype.generateConfigRowLenAndHiddenAddCell=function(){var t=this.readXml.getElementsByTagName("sheetData/row",this.sheetFile),n={},s={};n.formulaList=s;for(var i=0;i<t.length;i++){var o=t[i],a=o.attributeList,l=pt(a,"r",null),u=pt(a,"ht",null),c=pt(a,"hidden",null),h=pt(a,"customHeight",null);if(l!=null){var f=parseInt(l)-1;if(u!=null){var d=parseFloat(u);this.config.rowlen==null&&(this.config.rowlen={}),this.config.rowlen[f]=Hh(d)}if(c=="1"&&(this.config.rowhidden==null&&(this.config.rowhidden={}),this.config.rowhidden[f]=0,this.config.rowlen&&delete this.config.rowlen[f]),h!=null&&(this.config.customHeight==null&&(this.config.customHeight={}),this.config.customHeight[f]=1),this.isInitialCell){var m=o.getInnerElements("c");for(var g in m){var p=m[g],_=new Yx(p,this.styles,this.sharedStrings,this.mergeCells,this.sheetFile,this.readXml);if(_._borderObject!=null&&(this.config.borderInfo==null&&(this.config.borderInfo=[]),this.config.borderInfo.push(_._borderObject),delete _._borderObject),_._formulaType=="shared"){this.formulaRefList==null&&(this.formulaRefList={}),this.formulaRefList[_._formulaSi]==null&&(this.formulaRefList[_._formulaSi]={});var v=void 0;_.v!=null&&(v=_.v.f);var w={t:_._formulaType,ref:_._fomulaRef,si:_._formulaSi,fv:v,cellValue:_};_._fomulaRef!=null?this.formulaRefList[_._formulaSi].mainRef=w:this.formulaRefList[_._formulaSi][_.r+"_"+_.c]=w}if(_.v!=null&&_.v.f!=null){var y={r:_.r,c:_.c};n.formulaList["r"+_.r+"c"+_.c]=y}this.celldata.push(_)}}}}return n},e}(v6),He={};He.G={concat:function(r,e){for(var t=0;t<e.cmds.length;t++)r.cmds.push(e.cmds[t]);for(var t=0;t<e.crds.length;t++)r.crds.push(e.crds[t])},getBB:function(r){for(var e=1e99,t=1e99,n=-e,s=-t,i=0;i<r.length;i+=2){var o=r[i],a=r[i+1];o<e?e=o:o>n&&(n=o),a<t?t=a:a>s&&(s=a)}return[e,t,n,s]},rectToPath:function(r){return{cmds:["M","L","L","L","Z"],crds:[r[0],r[1],r[2],r[1],r[2],r[3],r[0],r[3]]}},insideBox:function(r,e){return e[0]<=r[0]&&e[1]<=r[1]&&r[2]<=e[2]&&r[3]<=e[3]},isBox:function(r,e){var t=function(c,h){for(var f=0;f<8;f+=2){for(var d=!0,m=0;m<8;m++)if(Math.abs(h[m]-c[m+f&7])>=2){d=!1;break}if(d)return!0}return!1};if(r.cmds.length>10)return!1;var n=r.cmds.join(""),s=r.crds,i=!1;if(n=="MLLLZ"&&s.length==8||n=="MLLLLZ"&&s.length==10){s.length==10&&(s=s.slice(0,8));var o=e[0],a=e[1],l=e[2],u=e[3];i||(i=t(s,[o,a,l,a,l,u,o,u])),i||(i=t(s,[o,u,l,u,l,a,o,a]))}return i},boxArea:function(r){var e=r[2]-r[0],t=r[3]-r[1];return e*t},newPath:function(r){r.pth={cmds:[],crds:[]}},moveTo:function(r,e,t){var n=He.M.multPoint(r.ctm,[e,t]);r.pth.cmds.push("M"),r.pth.crds.push(n[0],n[1]),r.cpos=n},lineTo:function(r,e,t){var n=He.M.multPoint(r.ctm,[e,t]);r.cpos[0]==n[0]&&r.cpos[1]==n[1]||(r.pth.cmds.push("L"),r.pth.crds.push(n[0],n[1]),r.cpos=n)},curveTo:function(r,e,t,n,s,i,o){var a;a=He.M.multPoint(r.ctm,[e,t]),e=a[0],t=a[1],a=He.M.multPoint(r.ctm,[n,s]),n=a[0],s=a[1],a=He.M.multPoint(r.ctm,[i,o]),i=a[0],o=a[1],r.cpos=a,r.pth.cmds.push("C"),r.pth.crds.push(e,t,n,s,i,o)},closePath:function(r){r.pth.cmds.push("Z")},arc:function(r,e,R,n,s,i,o){if(o)for(;i>s;)i-=2*Math.PI;else for(;i<s;)i+=2*Math.PI;var a=(i-s)/4,l=Math.cos(a/2),u=-Math.sin(a/2),c=(4-l)/3,h=u==0?u:(1-l)*(3-l)/(3*u),f=c,d=-h,m=l,g=-u,p=[c,h],_=[f,d],v=[m,g],w={cmds:[r.pth.cmds.length==0?"M":"L","C","C","C","C"],crds:[l,u,c,h,f,d,m,g]},y=[1,0,0,1,0,0];He.M.rotate(y,-a);for(var A=0;A<3;A++)p=He.M.multPoint(y,p),_=He.M.multPoint(y,_),v=He.M.multPoint(y,v),w.crds.push(p[0],p[1],_[0],_[1],v[0],v[1]);var I=[n,0,0,n,e,R];He.M.rotate(y,-s+a/2),He.M.concat(y,I),He.M.multArray(y,w.crds),He.M.multArray(r.ctm,w.crds),He.G.concat(r.pth,w);var R=w.crds.pop();e=w.crds.pop(),r.cpos=[e,R]},toPoly:function(r){if(r.cmds[0]!="M"||r.cmds[r.cmds.length-1]!="Z")return null;for(var e=1;e<r.cmds.length-1;e++)if(r.cmds[e]!="L")return null;var t=[],n=r.crds.length;r.crds[0]==r.crds[n-2]&&r.crds[1]==r.crds[n-1]&&(n-=2);for(var e=0;e<n;e+=2)t.push([r.crds[e],r.crds[e+1]]);return He.G.polyArea(r.crds)<0&&t.reverse(),t},fromPoly:function(r){for(var e={cmds:[],crds:[]},t=0;t<r.length;t++)e.crds.push(r[t][0],r[t][1]),e.cmds.push(t==0?"M":"L");return e.cmds.push("Z"),e},polyArea:function(r){if(r.length<6)return 0;for(var e=r.length-2,t=(r[0]-r[e])*(r[e+1]+r[1]),n=0;n<e;n+=2)t+=(r[n+2]-r[n])*(r[n+1]+r[n+3]);return-t*.5},polyClip:function(r,e){var t,n,s,i,o=function(f){return(n[0]-t[0])*(f[1]-t[1])>(n[1]-t[1])*(f[0]-t[0])},a=function(){var f=[t[0]-n[0],t[1]-n[1]],d=[s[0]-i[0],s[1]-i[1]],m=t[0]*n[1]-t[1]*n[0],g=s[0]*i[1]-s[1]*i[0],p=1/(f[0]*d[1]-f[1]*d[0]);return[(m*d[0]-g*f[0])*p,(m*d[1]-g*f[1])*p]},l=r;t=e[e.length-1];for(var u in e){var n=e[u],c=l;l=[],s=c[c.length-1];for(var h in c){var i=c[h];o(i)?(o(s)||l.push(a()),l.push(i)):o(s)&&l.push(a()),s=i}t=n}return l}};He.M={getScale:function(r){return Math.sqrt(Math.abs(r[0]*r[3]-r[1]*r[2]))},translate:function(r,e,t){He.M.concat(r,[1,0,0,1,e,t])},rotate:function(r,e){He.M.concat(r,[Math.cos(e),-Math.sin(e),Math.sin(e),Math.cos(e),0,0])},scale:function(r,e,t){He.M.concat(r,[e,0,0,t,0,0])},concat:function(r,e){var t=r[0],n=r[1],s=r[2],i=r[3],o=r[4],a=r[5];r[0]=t*e[0]+n*e[2],r[1]=t*e[1]+n*e[3],r[2]=s*e[0]+i*e[2],r[3]=s*e[1]+i*e[3],r[4]=o*e[0]+a*e[2]+e[4],r[5]=o*e[1]+a*e[3]+e[5]},invert:function(r){var e=r[0],t=r[1],n=r[2],s=r[3],i=r[4],o=r[5],a=e*s-t*n;r[0]=s/a,r[1]=-t/a,r[2]=-n/a,r[3]=e/a,r[4]=(n*o-s*i)/a,r[5]=(t*i-e*o)/a},multPoint:function(r,e){var t=e[0],n=e[1];return[t*r[0]+n*r[2]+r[4],t*r[1]+n*r[3]+r[5]]},multArray:function(r,e){for(var t=0;t<e.length;t+=2){var n=e[t],s=e[t+1];e[t]=n*r[0]+s*r[2]+r[4],e[t+1]=n*r[1]+s*r[3]+r[5]}}};He.C={srgbGamma:function(r){return r<.0031308?12.92*r:1.055*Math.pow(r,1/2.4)-.055},cmykToRgb:function(r){var e=r[0],t=r[1],n=r[2],s=r[3],i=255+e*(-4.387332384609988*e+54.48615194189176*t+18.82290502165302*n+212.25662451639585*s+-285.2331026137004)+t*(1.7149763477362134*t-5.6096736904047315*n+-17.873870861415444*s-5.497006427196366)+n*(-2.5217340131683033*n-21.248923337353073*s+17.5119270841813)+s*(-21.86122147463605*s-189.48180835922747),o=255+e*(8.841041422036149*e+60.118027045597366*t+6.871425592049007*n+31.159100130055922*s+-79.2970844816548)+t*(-15.310361306967817*t+17.575251261109482*n+131.35250912493976*s-190.9453302588951)+n*(4.444339102852739*n+9.8632861493405*s-24.86741582555878)+s*(-20.737325471181034*s-187.80453709719578),a=255+e*(.8842522430003296*e+8.078677503112928*t+30.89978309703729*n-.23883238689178934*s+-14.183576799673286)+t*(10.49593273432072*t+63.02378494754052*n+50.606957656360734*s-112.23884253719248)+n*(.03296041114873217*n+115.60384449646641*s+-193.58209356861505)+s*(-22.33816807309886*s-180.12613974708367);return[Math.max(0,Math.min(1,i/255)),Math.max(0,Math.min(1,o/255)),Math.max(0,Math.min(1,a/255))]},labToRgb:function(r){for(var e=903.3,t=.008856,n=r[0],s=r[1],i=r[2],o=(n+16)/116,a=o*o*o,l=o-i/200,u=l*l*l,c=s/500+o,h=c*c*c,f=u>t?u:(116*l-16)/e,d=a>t?a:(116*o-16)/e,m=h>t?h:(116*c-16)/e,g=m*96.72,p=d*100,_=f*81.427,v=[g/100,p/100,_/100],w=[3.1338561,-1.6168667,-.4906146,-.9787684,1.9161415,.033454,.0719453,-.2289914,1.4052427],y=[w[0]*v[0]+w[1]*v[1]+w[2]*v[2],w[3]*v[0]+w[4]*v[1]+w[5]*v[2],w[6]*v[0]+w[7]*v[1]+w[8]*v[2]],A=0;A<3;A++)y[A]=Math.max(0,Math.min(1,He.C.srgbGamma(y[A])));return y}};He.getState=function(r){return{font:He.getFont(),dd:{flat:1},space:"/DeviceGray",ca:1,colr:[0,0,0],sspace:"/DeviceGray",CA:1,COLR:[0,0,0],bmode:"/Normal",SA:!1,OPM:0,AIS:!1,OP:!1,op:!1,SMask:"/None",lwidth:1,lcap:0,ljoin:0,mlimit:10,SM:.1,doff:0,dash:[],ctm:[1,0,0,1,0,0],cpos:[0,0],pth:{cmds:[],crds:[]},cpth:r?He.G.rectToPath(r):null}};He.getFont=function(){return{Tc:0,Tw:0,Th:100,Tl:0,Tf:"Helvetica-Bold",Tfs:1,Tmode:0,Trise:0,Tk:0,Tal:0,Tun:0,Tm:[1,0,0,1,0,0],Tlm:[1,0,0,1,0,0],Trm:[1,0,0,1,0,0]}};var Ye=function(){};Ye.Parse=function(r,e){r=new Uint8Array(r);for(var t=0,n={fill:!1,strk:!1,bb:[0,0,1,1],wbb:[0,0,1,1],fnt:{nam:"Arial",hgh:25,und:!1,orn:0},tclr:[0,0,0],talg:0},s,i=[],o=[],a=Ye.B.readShort,l=Ye.B.readUshort,u=Ye.B.readInt,c=Ye.B.readUint,h=Ye.B.readFloat;;){var f=c(r,t);t+=4;var d=Ye.K[f],m=c(r,t);t+=4;var g=t,p=null,_=0;if(d=="EOF")break;if(d=="HEADER")n.bb=Ye._readBox(r,g),g+=16,e.StartPage(n.bb[0],n.bb[1],n.bb[2],n.bb[3]),s=He.getState(n.bb);else if(d=="SAVEDC")o.push(JSON.stringify(s),JSON.stringify(n));else if(d=="RESTOREDC"){var v=u(r,g);for(g+=4;v<-1;)o.pop(),o.pop();n=JSON.parse(o.pop()),s=JSON.parse(o.pop())}else if(d=="SELECTCLIPPATH")s.cpth=JSON.parse(JSON.stringify(s.pth));else if(["SETMAPMODE","SETPOLYFILLMODE","SETBKMODE","SETICMMODE","SETROP2","EXTSELECTCLIPRGN"].indexOf(d)==-1){if(d=="SETMITERLIMIT")s.mlimit=c(r,g);else if(d=="SETTEXTCOLOR")n.tclr=[r[g]/255,r[g+1]/255,r[g+2]/255];else if(d=="SETTEXTALIGN")n.talg=c(r,g);else if(d=="SETVIEWPORTEXTEX"||d=="SETVIEWPORTORGEX"){n.vbb==null&&(n.vbb=[]);var w=d=="SETVIEWPORTORGEX"?0:2;n.vbb[w]=u(r,g),g+=4,n.vbb[w+1]=u(r,g),g+=4,d=="SETVIEWPORTEXTEX"&&Ye._updateCtm(n,s)}else if(d=="SETWINDOWEXTEX"||d=="SETWINDOWORGEX"){var w=d=="SETWINDOWORGEX"?0:2;n.wbb[w]=u(r,g),g+=4,n.wbb[w+1]=u(r,g),g+=4,d=="SETWINDOWEXTEX"&&Ye._updateCtm(n,s)}else if(d=="COMMENT")c(r,g),g+=4;else if(d=="SELECTOBJECT"){var y=c(r,g);if(g+=4,y==2147483648)n.fill=!0,s.colr=[1,1,1];else if(y==2147483653)n.fill=!1;else if(y==2147483655)n.strk=!0,n.lwidth=1,s.COLR=[0,0,0];else if(y==2147483656)n.strk=!1;else if(y!=2147483661){if(y!=2147483662){var A=i[y];if(A.t=="b"){if(n.fill=A.stl!=1,A.stl!=0){if(A.stl!=1)throw A.stl+" e"}s.colr=A.clr}else if(A.t=="p")n.strk=A.stl!=5,s.lwidth=A.wid,s.COLR=A.clr;else if(A.t=="f")n.fnt=A,s.font.Tf=A.nam,s.font.Tfs=Math.abs(A.hgh),s.font.Tun=A.und;else throw"e"}}}else if(d=="DELETEOBJECT"){var y=c(r,g);if(g+=4,i[y]!=null)i[y]=null;else throw"e"}else if(d=="CREATEBRUSHINDIRECT")_=c(r,g),g+=4,p={t:"b"},p.stl=c(r,g),g+=4,p.clr=[r[g]/255,r[g+1]/255,r[g+2]/255],g+=4,p.htc=c(r,g),g+=4;else if(d=="CREATEPEN"||d=="EXTCREATEPEN")_=c(r,g),g+=4,p={t:"p"},d=="EXTCREATEPEN"?(g+=16,p.stl=c(r,g),g+=4,p.wid=c(r,g),g+=4,g+=4):(p.stl=c(r,g),g+=4,p.wid=c(r,g),g+=4,g+=4),p.clr=[r[g]/255,r[g+1]/255,r[g+2]/255],g+=4;else if(d=="EXTCREATEFONTINDIRECTW"){_=c(r,g),g+=4,p={t:"f",nam:""},p.hgh=u(r,g),g+=4,g+=4*2,p.orn=u(r,g)/10,g+=4;var I=c(r,g);for(g+=4,p.und=r[g+1],p.stk=r[g+2],g+=4*2;l(r,g)!=0;)p.nam+=String.fromCharCode(l(r,g)),g+=2;I>500&&(p.nam+="-Bold")}else if(d=="EXTTEXTOUTW"){g+=16;var R=c(r,g);g+=4,h(r,g),g+=4,h(r,g),g+=4;var x=u(r,g);g+=4;var S=u(r,g);g+=4,s.font.Tm=[1,0,0,-1,0,0],He.M.rotate(s.font.Tm,n.fnt.orn*Math.PI/180),He.M.translate(s.font.Tm,x,S);var k=n.talg;if((k&6)==6)s.font.Tal=2;else if((k&7)==0)s.font.Tal=0;else throw k+" e";if((k&24)!=24)if((k&24)==0)He.M.translate(s.font.Tm,0,s.font.Tfs);else throw"e";var N=c(r,g);g+=4;var O=c(r,g);g+=4,c(r,g),g+=4,g+=16,c(r,g),g+=4,O+=t-8;for(var D="",E=0;E<N;E++){var F=l(r,O+E*2);D+=String.fromCharCode(F)}var j=s.colr;s.colr=n.tclr,e.PutText(s,D,D.length*s.font.Tfs*.5),s.colr=j}else if(d=="BEGINPATH")He.G.newPath(s);else if(d!="ENDPATH")if(d=="CLOSEFIGURE")He.G.closePath(s);else if(d=="MOVETOEX")He.G.moveTo(s,u(r,g),u(r,g+4));else if(d=="LINETO"){if(s.pth.cmds.length==0){var L=s.ctm.slice(0);He.M.invert(L);var re=He.M.multPoint(L,s.cpos);He.G.moveTo(s,re[0],re[1])}He.G.lineTo(s,u(r,g),u(r,g+4))}else if(d=="POLYGON"||d=="POLYGON16"||d=="POLYLINE"||d=="POLYLINE16"||d=="POLYLINETO"||d=="POLYLINETO16"){g+=16;var Y=d.startsWith("POLYGON"),ee=d.indexOf("TO")!=-1,U=c(r,g);g+=4,ee||He.G.newPath(s),g=Ye._drawPoly(r,g,U,s,d.endsWith("16")?2:4,Y,ee),ee||Ye._draw(e,s,n,Y)}else if(d=="POLYPOLYGON16"){g+=16;var Y=d.startsWith("POLYPOLYGON"),ee=d.indexOf("TO")!=-1,V=c(r,g);g+=4,g+=4;var _e=g;g+=V*4,ee||He.G.newPath(s);for(var E=0;E<V;E++){var ie=l(r,_e+E*4);g=Ye._drawPoly(r,g,ie,s,d.endsWith("16")?2:4,Y,ee)}ee||Ye._draw(e,s,n,Y)}else if(d=="POLYBEZIER"||d=="POLYBEZIER16"||d=="POLYBEZIERTO"||d=="POLYBEZIERTO16"){g+=16;var Z=d.endsWith("16"),le=Z?a:u,ve=Z?2:4,U=c(r,g);for(g+=4,d.indexOf("TO")==-1&&(He.G.moveTo(s,le(r,g),le(r,g+ve)),g+=2*ve,U--);U>0;)He.G.curveTo(s,le(r,g),le(r,g+ve),le(r,g+2*ve),le(r,g+3*ve),le(r,g+4*ve),le(r,g+5*ve)),g+=6*ve,U-=3}else if(d=="RECTANGLE"||d=="ELLIPSE"){He.G.newPath(s);var Ce=Ye._readBox(r,g);if(d=="RECTANGLE")He.G.moveTo(s,Ce[0],Ce[1]),He.G.lineTo(s,Ce[2],Ce[1]),He.G.lineTo(s,Ce[2],Ce[3]),He.G.lineTo(s,Ce[0],Ce[3]);else{var ge=(Ce[0]+Ce[2])/2,ye=(Ce[1]+Ce[3])/2;He.G.arc(s,ge,ye,(Ce[2]-Ce[0])/2,0,2*Math.PI,!1)}He.G.closePath(s),Ye._draw(e,s,n,!0)}else if(d=="FILLPATH")e.Fill(s,!1);else if(d=="STROKEPATH")e.Stroke(s);else if(d=="STROKEANDFILLPATH")e.Fill(s,!1),e.Stroke(s);else if(d=="SETWORLDTRANSFORM"||d=="MODIFYWORLDTRANSFORM"){for(var Me=[],E=0;E<6;E++)Me.push(h(r,g+E*4));if(g+=24,d=="SETWORLDTRANSFORM")s.ctm=Me;else{var R=c(r,g);if(g+=4,R==2){var Ze=s.ctm;s.ctm=Me,He.M.concat(s.ctm,Ze)}else throw"e"}}else if(d=="SETSTRETCHBLTMODE")c(r,g),g+=4;else if(d=="STRETCHDIBITS"){var Ce=Ye._readBox(r,g);g+=16;var ke=u(r,g);g+=4;var T=u(r,g);g+=4,u(r,g),g+=4,u(r,g),g+=4;var se=u(r,g);g+=4;var ne=u(r,g);g+=4;var B=c(r,g)+t-8;g+=4,c(r,g),g+=4;var M=c(r,g)+t-8;g+=4,c(r,g),g+=4;var X=c(r,g);if(g+=4,X!=0)throw"e";c(r,g),g+=4;var ae=u(r,g);g+=4;var oe=u(r,g);g+=4,c(r,B),B+=4;var $=c(r,B);B+=4;var he=c(r,B);if(B+=4,$!=se||he!=ne)throw"e";var P=l(r,B);B+=2;var z=l(r,B);if(B+=2,z!=8&&z!=24&&z!=32)throw z+" e";var J=c(r,B);if(B+=4,J!=0)throw J+" e";c(r,B),B+=4,c(r,B),B+=4,c(r,B),B+=4,c(r,B),B+=4,c(r,B),B+=4;var ue=Math.floor(($*P*z+31&-32)/8),de=new Uint8Array($*he*4);if(z==8)for(var ye=0;ye<he;ye++)for(var ge=0;ge<$;ge++){var Fe=ye*$+ge<<2,y=r[M+(he-1-ye)*ue+ge]<<2;de[Fe]=r[B+y+2],de[Fe+1]=r[B+y+1],de[Fe+2]=r[B+y+0],de[Fe+3]=255}if(z==24)for(var ye=0;ye<he;ye++)for(var ge=0;ge<$;ge++){var Fe=ye*$+ge<<2,xe=M+(he-1-ye)*ue+ge*3;de[Fe]=r[xe+2],de[Fe+1]=r[xe+1],de[Fe+2]=r[xe+0],de[Fe+3]=255}if(z==32)for(var ye=0;ye<he;ye++)for(var ge=0;ge<$;ge++){var Fe=ye*$+ge<<2,xe=M+(he-1-ye)*ue+ge*4;de[Fe]=r[xe+2],de[Fe+1]=r[xe+1],de[Fe+2]=r[xe+0],de[Fe+3]=r[xe+3]}var Oe=s.ctm.slice(0);s.ctm=[1,0,0,1,0,0],He.M.scale(s.ctm,ae,-oe),He.M.translate(s.ctm,ke,T+oe),He.M.concat(s.ctm,Oe),e.PutImage(s,de,$,he),s.ctm=Oe}else console.log(d,m)}p!=null&&(i[_]=p),t+=m-8}e.ShowPage(),e.Done()};Ye._readBox=function(r,e){for(var t=[],n=0;n<4;n++)t[n]=Ye.B.readInt(r,e+n*4);return t};Ye._updateCtm=function(r,e){var t=[1,0,0,1,0,0],n=r.wbb;r.bb;var s=r.vbb&&r.vbb.length==4?r.vbb:r.bb;He.M.translate(t,-n[0],-n[1]),He.M.scale(t,1/n[2],1/n[3]),He.M.scale(t,s[2],s[3]),e.ctm=t};Ye._draw=function(r,e,t,n){t.fill&&n&&r.Fill(e,!1),t.strk&&e.lwidth!=0&&r.Stroke(e)};Ye._drawPoly=function(r,e,t,n,s,i,o){for(var a=s==2?Ye.B.readShort:Ye.B.readInt,l=0;l<t;l++){var u=a(r,e);e+=s;var c=a(r,e);e+=s,l==0&&!o?He.G.moveTo(n,u,c):He.G.lineTo(n,u,c)}return i&&He.G.closePath(n),e};Ye.B={uint8:new Uint8Array(4),readShort:function(r,e){var t=Ye.B.uint8;return t[0]=r[e],t[1]=r[e+1],Ye.B.int16[0]},readUshort:function(r,e){var t=Ye.B.uint8;return t[0]=r[e],t[1]=r[e+1],Ye.B.uint16[0]},readInt:function(r,e){var t=Ye.B.uint8;return t[0]=r[e],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],Ye.B.int32[0]},readUint:function(r,e){var t=Ye.B.uint8;return t[0]=r[e],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],Ye.B.uint32[0]},readFloat:function(r,e){var t=Ye.B.uint8;return t[0]=r[e],t[1]=r[e+1],t[2]=r[e+2],t[3]=r[e+3],Ye.B.flot32[0]},readASCII:function(r,e,t){for(var n="",s=0;s<t;s++)n+=String.fromCharCode(r[e+s]);return n}};Ye.B.int16=new Int16Array(Ye.B.uint8.buffer);Ye.B.uint16=new Uint16Array(Ye.B.uint8.buffer);Ye.B.int32=new Int32Array(Ye.B.uint8.buffer);Ye.B.uint32=new Uint32Array(Ye.B.uint8.buffer);Ye.B.flot32=new Float32Array(Ye.B.uint8.buffer);Ye.C={EMR_HEADER:1,EMR_POLYBEZIER:2,EMR_POLYGON:3,EMR_POLYLINE:4,EMR_POLYBEZIERTO:5,EMR_POLYLINETO:6,EMR_POLYPOLYLINE:7,EMR_POLYPOLYGON:8,EMR_SETWINDOWEXTEX:9,EMR_SETWINDOWORGEX:10,EMR_SETVIEWPORTEXTEX:11,EMR_SETVIEWPORTORGEX:12,EMR_SETBRUSHORGEX:13,EMR_EOF:14,EMR_SETPIXELV:15,EMR_SETMAPPERFLAGS:16,EMR_SETMAPMODE:17,EMR_SETBKMODE:18,EMR_SETPOLYFILLMODE:19,EMR_SETROP2:20,EMR_SETSTRETCHBLTMODE:21,EMR_SETTEXTALIGN:22,EMR_SETCOLORADJUSTMENT:23,EMR_SETTEXTCOLOR:24,EMR_SETBKCOLOR:25,EMR_OFFSETCLIPRGN:26,EMR_MOVETOEX:27,EMR_SETMETARGN:28,EMR_EXCLUDECLIPRECT:29,EMR_INTERSECTCLIPRECT:30,EMR_SCALEVIEWPORTEXTEX:31,EMR_SCALEWINDOWEXTEX:32,EMR_SAVEDC:33,EMR_RESTOREDC:34,EMR_SETWORLDTRANSFORM:35,EMR_MODIFYWORLDTRANSFORM:36,EMR_SELECTOBJECT:37,EMR_CREATEPEN:38,EMR_CREATEBRUSHINDIRECT:39,EMR_DELETEOBJECT:40,EMR_ANGLEARC:41,EMR_ELLIPSE:42,EMR_RECTANGLE:43,EMR_ROUNDRECT:44,EMR_ARC:45,EMR_CHORD:46,EMR_PIE:47,EMR_SELECTPALETTE:48,EMR_CREATEPALETTE:49,EMR_SETPALETTEENTRIES:50,EMR_RESIZEPALETTE:51,EMR_REALIZEPALETTE:52,EMR_EXTFLOODFILL:53,EMR_LINETO:54,EMR_ARCTO:55,EMR_POLYDRAW:56,EMR_SETARCDIRECTION:57,EMR_SETMITERLIMIT:58,EMR_BEGINPATH:59,EMR_ENDPATH:60,EMR_CLOSEFIGURE:61,EMR_FILLPATH:62,EMR_STROKEANDFILLPATH:63,EMR_STROKEPATH:64,EMR_FLATTENPATH:65,EMR_WIDENPATH:66,EMR_SELECTCLIPPATH:67,EMR_ABORTPATH:68,EMR_COMMENT:70,EMR_FILLRGN:71,EMR_FRAMERGN:72,EMR_INVERTRGN:73,EMR_PAINTRGN:74,EMR_EXTSELECTCLIPRGN:75,EMR_BITBLT:76,EMR_STRETCHBLT:77,EMR_MASKBLT:78,EMR_PLGBLT:79,EMR_SETDIBITSTODEVICE:80,EMR_STRETCHDIBITS:81,EMR_EXTCREATEFONTINDIRECTW:82,EMR_EXTTEXTOUTA:83,EMR_EXTTEXTOUTW:84,EMR_POLYBEZIER16:85,EMR_POLYGON16:86,EMR_POLYLINE16:87,EMR_POLYBEZIERTO16:88,EMR_POLYLINETO16:89,EMR_POLYPOLYLINE16:90,EMR_POLYPOLYGON16:91,EMR_POLYDRAW16:92,EMR_CREATEMONOBRUSH:93,EMR_CREATEDIBPATTERNBRUSHPT:94,EMR_EXTCREATEPEN:95,EMR_POLYTEXTOUTA:96,EMR_POLYTEXTOUTW:97,EMR_SETICMMODE:98,EMR_CREATECOLORSPACE:99,EMR_SETCOLORSPACE:100,EMR_DELETECOLORSPACE:101,EMR_GLSRECORD:102,EMR_GLSBOUNDEDRECORD:103,EMR_PIXELFORMAT:104,EMR_DRAWESCAPE:105,EMR_EXTESCAPE:106,EMR_SMALLTEXTOUT:108,EMR_FORCEUFIMAPPING:109,EMR_NAMEDESCAPE:110,EMR_COLORCORRECTPALETTE:111,EMR_SETICMPROFILEA:112,EMR_SETICMPROFILEW:113,EMR_ALPHABLEND:114,EMR_SETLAYOUT:115,EMR_TRANSPARENTBLT:116,EMR_GRADIENTFILL:118,EMR_SETLINKEDUFIS:119,EMR_SETTEXTJUSTIFICATION:120,EMR_COLORMATCHTOTARGETW:121,EMR_CREATECOLORSPACEW:122};Ye.K=[];var Zt=function(r,e){this.canvas=document.createElement("canvas"),this.ctx=this.canvas.getContext("2d"),this.bb=null,this.currPage=0,this.needPage=r,this.scale=e};Zt.prototype.StartPage=function(r,e,t,n){if(this.currPage==this.needPage){this.bb=[r,e,t,n];var s=this.scale,i=window.devicePixelRatio,o=this.canvas,a=this.ctx;o.width=Math.round(t*s),o.height=Math.round(n*s),a.translate(0,n*s),a.scale(s,-s),o.setAttribute("style","border:1px solid; width:"+o.width/i+"px; height:"+o.height/i+"px")}};Zt.prototype.Fill=function(r,e){if(this.currPage==this.needPage){var t=this.ctx;t.beginPath(),this._setStyle(r,t),this._draw(r.pth,t),t.fill()}};Zt.prototype.Stroke=function(r){if(this.currPage==this.needPage){var e=this.ctx;e.beginPath(),this._setStyle(r,e),this._draw(r.pth,e),e.stroke()}};Zt.prototype.PutText=function(r,e,t){if(this.currPage==this.needPage){this._scale(r.ctm);var n=this.ctx;this._setStyle(r,n),n.save();var s=[1,0,0,-1,0,0];this._concat(s,r.font.Tm),this._concat(s,r.ctm),n.transform(s[0],s[1],s[2],s[3],s[4],s[5]),n.fillText(e,0,0),n.restore()}};Zt.prototype.PutImage=function(r,e,t,n,s){if(this.currPage==this.needPage){var i=this.ctx;if(e.length==t*n*4){if(e=e.slice(0),s&&s.length==t*n*4)for(var o=0;o<e.length;o+=4)e[o+3]=s[o+1];var a=document.createElement("canvas"),l=a.getContext("2d");a.width=t,a.height=n;for(var u=l.createImageData(t,n),o=0;o<e.length;o++)u.data[o]=e[o];l.putImageData(u,0,0),i.save();var c=[1,0,0,1,0,0];this._concat(c,[1/t,0,0,-1/n,0,1]),this._concat(c,r.ctm),i.transform(c[0],c[1],c[2],c[3],c[4],c[5]),i.drawImage(a,0,0),i.restore()}}};Zt.prototype.ShowPage=function(){this.currPage++};Zt.prototype.Done=function(){};function Kx(r){return""+parseFloat(r.toFixed(2))}Zt.prototype._setStyle=function(r,e){var t=this._scale(r.ctm);e.fillStyle=this._getFill(r.colr,r.ca,e),e.strokeStyle=this._getFill(r.COLR,r.CA,e),e.lineCap=["butt","round","square"][r.lcap],e.lineJoin=["miter","round","bevel"][r.ljoin],e.lineWidth=r.lwidth*t;for(var n=r.dash.slice(0),s=0;s<n.length;s++)n[s]=Kx(n[s]*t);e.setLineDash(n),e.miterLimit=r.mlimit*t;var i=r.font.Tf,o=i.toLowerCase(),a=o.indexOf("bold")!=-1?"bold ":"",l=o.indexOf("italic")!=-1||o.indexOf("oblique")!=-1?"italic ":"";e.font=a+l+r.font.Tfs+'px "'+i+'"'};Zt.prototype._getFill=function(r,e,t){if(r.typ==null)return this._colr(r,e);var n=r,s=n.crds,i=n.mat,o=this._scale(i),a;if(n.typ=="lin"){var l=this._multPoint(i,s.slice(0,2)),u=this._multPoint(i,s.slice(2));a=t.createLinearGradient(l[0],l[1],u[0],u[1])}else if(n.typ=="rad"){var l=this._multPoint(i,s.slice(0,2)),u=this._multPoint(i,s.slice(3));a=t.createRadialGradient(l[0],l[1],s[2]*o,u[0],u[1],s[5]*o)}for(var c=0;c<n.grad.length;c++)a.addColorStop(n.grad[c][0],this._colr(n.grad[c][1],e));return a};Zt.prototype._colr=function(r,e){return"rgba("+Math.round(r[0]*255)+","+Math.round(r[1]*255)+","+Math.round(r[2]*255)+","+e+")"};Zt.prototype._scale=function(r){return Math.sqrt(Math.abs(r[0]*r[3]-r[1]*r[2]))};Zt.prototype._concat=function(r,e){var t=r[0],n=r[1],s=r[2],i=r[3],o=r[4],a=r[5];r[0]=t*e[0]+n*e[2],r[1]=t*e[1]+n*e[3],r[2]=s*e[0]+i*e[2],r[3]=s*e[1]+i*e[3],r[4]=o*e[0]+a*e[2]+e[4],r[5]=o*e[1]+a*e[3]+e[5]};Zt.prototype._multPoint=function(r,e){var t=e[0],n=e[1];return[t*r[0]+n*r[2]+r[4],t*r[1]+n*r[3]+r[5]]},Zt.prototype._draw=function(r,e){for(var t=0,n=r.crds,s=0;s<r.cmds.length;s++){var i=r.cmds[s];i=="M"?(e.moveTo(n[t],n[t+1]),t+=2):i=="L"?(e.lineTo(n[t],n[t+1]),t+=2):i=="C"?(e.bezierCurveTo(n[t],n[t+1],n[t+2],n[t+3],n[t+4],n[t+5]),t+=6):i=="Q"?(e.quadraticCurveTo(n[t],n[t+1],n[t+2],n[t+3]),t+=4):i=="Z"&&e.closePath()}};var Zx=function(){function r(e){if(e!=null){this.images={};for(var t in e)if(t.indexOf("xl/media/")>-1){var n=t.split("."),s=n[n.length-1].toLowerCase();if(s in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1,emf:1})if(s=="emf"){var i=0,o=1,a=new Zt(i,o),l,u,c;Ye.K=[],l=Ye.C,u=Ye.K,c=4;for(var h in l)u[l[h]]=h.slice(c);Ye.Parse(e[t],a),this.images[t]=a.canvas.toDataURL("image/png")}else this.images[t]=e[t]}}}return r.prototype.getImageByName=function(e){if(e in this.images){var t=this.images[e];return new qx(e,t)}return null},r}(),qx=function(r){Gs(e,r);function e(t,n){var s=r.call(this)||this;return s.src=n,s}return e.prototype.setDefault=function(){},e}($x),Wh=function(r){Gs(e,r);function e(t,n){var s=r.call(this)||this;s.columnWidthSet=[],s.rowHeightSet=[],s.files=t,s.fileName=n,s.readXml=new Bx(t),s.getSheetNameList(),s.sharedStrings=s.readXml.getElementsByTagName("sst/si",vx),s.calcChain=s.readXml.getElementsByTagName("calcChain/c",bx),s.styles={},s.styles.cellXfs=s.readXml.getElementsByTagName("cellXfs/xf",jn),s.styles.cellStyleXfs=s.readXml.getElementsByTagName("cellStyleXfs/xf",jn),s.styles.cellStyles=s.readXml.getElementsByTagName("cellStyles/cellStyle",jn),s.styles.fonts=s.readXml.getElementsByTagName("fonts/font",jn),s.styles.fills=s.readXml.getElementsByTagName("fills/fill",jn),s.styles.borders=s.readXml.getElementsByTagName("borders/border",jn),s.styles.clrScheme=s.readXml.getElementsByTagName("a:clrScheme/a:dk1|a:lt1|a:dk2|a:lt2|a:accent1|a:accent2|a:accent3|a:accent4|a:accent5|a:accent6|a:hlink|a:folHlink",Cx),s.styles.indexedColors=s.readXml.getElementsByTagName("colors/indexedColors/rgbColor",jn),s.styles.mruColors=s.readXml.getElementsByTagName("colors/mruColors/color",jn),s.imageList=new Zx(t);for(var i=s.readXml.getElementsByTagName("numFmt/numFmt",jn),o=JSON.parse(JSON.stringify(Lh)),a=0;a<i.length;a++){var l=i[a].attributeList,u=pt(l,"numFmtId","49"),c=pt(l,"formatCode","@");u in Lh||(o[u]=c)}return s.styles.numfmts=o,s}return e.prototype.getSheetNameList=function(){var t=this.readXml.getElementsByTagName("Relationships/Relationship",Ex);if(t!=null){for(var n=new RegExp("worksheets/[^/]*?.xml"),s={},i=0;i<t.length;i++){var o=t[i],a=o.attributeList,l=a.Id,u=a.Target;n.test(u)&&(u.startsWith("/xl")?s[l]=u.substr(1):s[l]="xl/"+u)}this.sheetNameList=s}},e.prototype.getSheetFileBysheetId=function(t){return this.sheetNameList[t]},e.prototype.getWorkBookInfo=function(){var t=this.readXml.getElementsByTagName("Company",Bh),n=this.readXml.getElementsByTagName("AppVersion",Bh),s=this.readXml.getElementsByTagName("dc:creator",fo),i=this.readXml.getElementsByTagName("cp:lastModifiedBy",fo),o=this.readXml.getElementsByTagName("dcterms:created",fo),a=this.readXml.getElementsByTagName("dcterms:modified",fo);this.info=new Hx,this.info.name=this.fileName,this.info.creator=s.length>0?s[0].value:"",this.info.lastmodifiedby=i.length>0?i[0].value:"",this.info.createdTime=o.length>0?o[0].value:"",this.info.modifiedTime=a.length>0?a[0].value:"",this.info.company=t.length>0?t[0].value:"",this.info.appversion=n.length>0?n[0].value:""},e.prototype.getSheetsFull=function(t){t===void 0&&(t=!0);var n=this.readXml.getElementsByTagName("sheets/sheet",_x),s={};for(var i in n){var o=n[i];s[o.attributeList.name]=o.attributeList.sheetId}this.sheets=[];var a=0;for(var i in n){var o=n[i],l=o.attributeList.name,u=o.attributeList.sheetId,c=o.attributeList["r:id"],h=this.getSheetFileBysheetId(c),f=this.readXml.getElementsByTagName("worksheet/drawing",h),d=void 0,m=void 0;if(f!=null&&f.length>0){var g=f[0].attributeList,p=pt(g,"r:id",null);p!=null&&(d=this.getDrawingFile(p,h),m=this.getDrawingRelsFile(d))}if(h!=null){var _=new jx(l,u,a,t,{sheetFile:h,readXml:this.readXml,sheetList:s,styles:this.styles,sharedStrings:this.sharedStrings,calcChain:this.calcChain,imageList:this.imageList,drawingFile:d,drawingRelsFile:m});this.columnWidthSet=[],this.rowHeightSet=[],this.imagePositionCaculation(_),this.sheets.push(_),a++}}},e.prototype.extendArray=function(t,n,s,i,o){if(!(t<n.length)){var a=n.length,l=t,u=0;a>0&&(u=n[a-1]);for(var c=a;c<=l;c++){var h=s,f=c.toString();f in i?h=0:f in o&&(h=o[f]),u+=Math.round(h+1),n.push(u)}}},e.prototype.imagePositionCaculation=function(t){var n=t.images,s=t.defaultColWidth,i=t.defaultRowHeight,o={};t.config.colhidden&&(o=t.config.colhidden);var a={};t.config.columnlen&&(a=t.config.columnlen);var l={};t.config.rowhidden&&(l=t.config.rowhidden);var u={};t.config.rowlen&&(u=t.config.rowlen);for(var c in n){var h=n[c],f=h.fromCol,d=h.fromColOff,m=h.fromRow,g=h.fromRowOff,p=h.toCol,_=h.toColOff,v=h.toRow,w=h.toRowOff,y=0,A=0,I=0,R=0;f>=this.columnWidthSet.length&&this.extendArray(f,this.columnWidthSet,s,o,a),f==0?y=0:y=this.columnWidthSet[f-1],y=y+d,m>=this.rowHeightSet.length&&this.extendArray(m,this.rowHeightSet,i,l,u),m==0?A=0:A=this.rowHeightSet[m-1],A=A+g,p>=this.columnWidthSet.length&&this.extendArray(p,this.columnWidthSet,s,o,a),p==0?I=0:I=this.columnWidthSet[p-1],I=I+_-y,v>=this.rowHeightSet.length&&this.extendArray(v,this.rowHeightSet,i,l,u),v==0?R=0:R=this.rowHeightSet[v-1],R=R+w-A,console.log(s,o,a),console.log(f,this.columnWidthSet[f],d),console.log(p,this.columnWidthSet[p],_,JSON.stringify(this.columnWidthSet)),h.originWidth=I,h.originHeight=R,h.crop.height=R,h.crop.width=I,h.default.height=R,h.default.left=y,h.default.top=A,h.default.width=I}console.log(this.columnWidthSet,this.rowHeightSet)},e.prototype.getDrawingFile=function(t,n){var s="xl/worksheets/_rels/",i=n.split("/"),o=i[i.length-1],a=s+o+".rels",l=this.readXml.getElementsByTagName("Relationships/Relationship",a);if(l.length>0)for(var u=0;u<l.length;u++){var c=l[u],h=c.attributeList,f=pt(h,"Id",null);if(f==t){var d=pt(h,"Target",null);if(d!=null)return d.replace(/\.\.\//g,"")}}return null},e.prototype.getDrawingRelsFile=function(t){var n="xl/drawings/_rels/",s=t.split("/"),i=s[s.length-1],o=n+i+".rels";return o},e.prototype.getSheetsWithoutCell=function(){this.getSheetsFull(!1)},e.prototype.Parse=function(){return this.getWorkBookInfo(),this.getSheetsFull(),this.toJsonString(this)},e.prototype.toJsonString=function(t){var n=new Uh;return n.info=t.info,n.sheets=[],t.sheets.forEach(function(s){var i=new v6;s.name!=null&&(i.name=s.name),s.color!=null&&(i.color=s.color),s.config!=null&&(i.config=s.config),s.index!=null&&(i.index=s.index),s.status!=null&&(i.status=s.status),s.order!=null&&(i.order=s.order),s.row!=null&&(i.row=s.row),s.column!=null&&(i.column=s.column),s.luckysheet_select_save!=null&&(i.luckysheet_select_save=s.luckysheet_select_save),s.scrollLeft!=null&&(i.scrollLeft=s.scrollLeft),s.scrollTop!=null&&(i.scrollTop=s.scrollTop),s.zoomRatio!=null&&(i.zoomRatio=s.zoomRatio),s.showGridLines!=null&&(i.showGridLines=s.showGridLines),s.defaultColWidth!=null&&(i.defaultColWidth=s.defaultColWidth),s.defaultRowHeight!=null&&(i.defaultRowHeight=s.defaultRowHeight),s.celldata!=null&&(i.celldata=[],s.celldata.forEach(function(o){var a=new C6;a.r=o.r,a.c=o.c,a.v=o.v,i.celldata.push(a)})),s.chart!=null&&(i.chart=s.chart),s.isPivotTable!=null&&(i.isPivotTable=s.isPivotTable),s.pivotTable!=null&&(i.pivotTable=s.pivotTable),s.luckysheet_conditionformat_save!=null&&(i.luckysheet_conditionformat_save=s.luckysheet_conditionformat_save),s.freezen!=null&&(i.freezen=s.freezen),s.calcChain!=null&&(i.calcChain=s.calcChain),s.images!=null&&(i.images=s.images),n.sheets.push(i)}),JSON.stringify(n)},e}(Uh),Vh=function(){function r(e){this.uploadFile=e}return r.prototype.unzipFile=function(e,t){Qs.loadAsync(this.uploadFile).then(function(n){var s={},i=Object.keys(n.files).length,o=0;n.forEach(function(a,l){var u=l.name,c=u.split("."),h=c[c.length-1].toLowerCase(),f="string";h in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?f="base64":h=="emf"&&(f="arraybuffer"),l.async(f).then(function(d){f=="base64"&&(d="data:image/"+h+";base64,"+d),s[l.name]=d,i==o+1&&e(s),o++})})},function(n){t(n)})},r.prototype.unzipFileByUrl=function(e,t,n){new Qs,Fx(e,function(s,i){if(s)throw s;Qs.loadAsync(i).then(function(o){var a={},l=Object.keys(o.files).length,u=0;o.forEach(function(c,h){var f=h.name,d=f.split("."),m=d[d.length-1].toLowerCase(),g="string";m in{png:1,jpeg:1,jpg:1,gif:1,bmp:1,tif:1,webp:1}?g="base64":m=="emf"&&(g="arraybuffer"),h.async(g).then(function(p){g=="base64"&&(p="data:image/"+m+";base64,"+p),a[h.name]=p,l==u+1&&t(a),u++})})},function(o){n(o)})})},r.prototype.newZipFile=function(){var e=new Qs;this.workBook=e},r.prototype.addToZipFile=function(e,t){if(this.workBook==null){var n=new Qs;this.workBook=n}this.workBook.file(e,t)},r}(),Jx=function(){function r(){}return r.transformExcelToLucky=function(e,t){var n=new Vh(e);n.unzipFile(function(s){var i=new Wh(s,e.name),o=i.Parse(),a=JSON.parse(o);t!=null&&t(a,o)},function(s){console.error(s)})},r.transformExcelToLuckyByUrl=function(e,t,n){var s=new Vh;s.unzipFileByUrl(e,function(i){var o=new Wh(i,t),a=o.Parse(),l=JSON.parse(a);n!=null&&n(l,a)},function(i){console.error(i)})},r.transformLuckyToExcel=function(e,t){},r}();class Qx{constructor(e){this._plugin=e,this._sheetPlugin=this._plugin.getContext().getPluginManager().getPluginByName(Je.SPREADSHEET),this._toolButton={name:m6,type:fg.FIX,locale:"importXlsx.tooltip",tooltipLocale:"importXlsx.tooltip",show:!0,hideSelectedIcon:!0,children:[{locale:"importXlsx.upload",onClick:()=>{this.upload()}}]},this._sheetPlugin.addToolButton(this._toolButton)}upload(){const e=document.createElement("input");e.type="file",e.accept="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet",e.addEventListener("change",t=>{const n=t.currentTarget;this.handleFiles(n.files)}),e.click()}handleFiles(e){if(e==null||e.length==0){alert("No files wait for import");return}let n=e[0].name.split(".");if(n[n.length-1]!="xlsx"){alert("Currently only supports the import of xlsx files");return}const i=Jx.transformExcelToLucky;i(e[0],o=>{if(o.sheets==null||o.sheets.length==0){alert("Failed to read the content of the excel file, currently does not support xls files!");return}const a={container:"universheet",data:o.sheets,title:o.info.name},u=o3(a).sheets;if(!u)return alert("No content");const c=this._plugin.getContext().getWorkBook();G.deepClone(c.getConfig().sheetOrder),Object.keys(u).forEach(h=>{const f=u[h];c.insertSheet(f)})})}}class eI extends Rf{execute(){this._plugin.getImportXlsxController().handleFiles(this._data)}}class tI extends Ap{get zIndex(){return 1}create(e){return new eI(e,this._plugin)}check(e){const t=[];return e.forEach(n=>{n.type==="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"&&t.push(n.file)}),t.length>0?this.create(t):!1}}class Mu extends or{constructor(e){super(m6)}static create(e){return new Mu(e)}installTo(e){e.installPlugin(this)}initialize(){this.getContext().getLocale().load({en:px,zh:mx}),this._importXlsxController=new Qx(this),this.registerExtension()}registerExtension(){const e=this.getContext().getPluginManager().getRequirePluginByName(Je.BASE_COMPONENT).getRegisterManager().getDragAndDropExtensionManager().getRegister();this._dragAndDropExtensionFactory=new tI(this),e.add(this._dragAndDropExtensionFactory)}onMounted(){this.initialize()}onDestroy(){this.getContext().getPluginManager().getRequirePluginByName(Je.BASE_COMPONENT).getRegisterManager().getDragAndDropExtensionManager().getRegister().delete(this._dragAndDropExtensionFactory)}getImportXlsxController(){return this._importXlsxController}}const nI={container:"universheet",selections:{"sheet-0001":[{selection:{startRow:2,endRow:2,startColumn:3,endColumn:3},cell:{row:2,column:3}}]}},Ir=Ul.newInstance(ZD);Ir.installPlugin(new eu);Ir.installPlugin(new YE);Ir.installPlugin(new $S(nI));Ir.installPlugin(new au);Ir.installPlugin(new Ou);Au.create(ZS).installTo(Ir);Ir.installPlugin(new Nu);Ir.installPlugin(new Mu);
