const Nc=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))s(r);new MutationObserver(r=>{for(const o of r)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&s(i)}).observe(document,{childList:!0,subtree:!0});function t(r){const o={};return r.integrity&&(o.integrity=r.integrity),r.referrerpolicy&&(o.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?o.credentials="include":r.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(r){if(r.ep)return;r.ep=!0;const o=t(r);fetch(r.href,o)}};Nc();var Is,le,ca,as,Uo,ua,Zs={},ha=[],Mc=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Wt(n,e){for(var t in e)n[t]=e[t];return n}function da(n){var e=n.parentNode;e&&e.removeChild(n)}function m(n,e,t){var s,r,o,i={};for(o in e)o=="key"?s=e[o]:o=="ref"?r=e[o]:i[o]=e[o];if(arguments.length>2&&(i.children=arguments.length>3?Is.call(arguments,2):t),typeof n=="function"&&n.defaultProps!=null)for(o in n.defaultProps)i[o]===void 0&&(i[o]=n.defaultProps[o]);return ls(n,i,s,r,null)}function ls(n,e,t,s,r){var o={type:n,props:e,key:t,ref:s,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:r==null?++ca:r};return r==null&&le.vnode!=null&&le.vnode(o),o}function ge(){return{current:null}}function Je(n){return n.children}function Ue(n,e){this.props=n,this.context=e}function gs(n,e){if(e==null)return n.__?gs(n.__,n.__.__k.indexOf(n)+1):null;for(var t;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null)return t.__e;return typeof n.type=="function"?gs(n):null}function fa(n){var e,t;if((n=n.__)!=null&&n.__c!=null){for(n.__e=n.__c.base=null,e=0;e<n.__k.length;e++)if((t=n.__k[e])!=null&&t.__e!=null){n.__e=n.__c.base=t.__e;break}return fa(n)}}function Wr(n){(!n.__d&&(n.__d=!0)&&as.push(n)&&!Js.__r++||Uo!==le.debounceRendering)&&((Uo=le.debounceRendering)||setTimeout)(Js)}function Js(){for(var n;Js.__r=as.length;)n=as.sort(function(e,t){return e.__v.__b-t.__v.__b}),as=[],n.some(function(e){var t,s,r,o,i,a;e.__d&&(i=(o=(t=e).__v).__e,(a=t.__P)&&(s=[],(r=Wt({},o)).__v=o.__v+1,oo(a,o,r,t.__n,a.ownerSVGElement!==void 0,o.__h!=null?[i]:null,s,i==null?gs(o):i,o.__h),ba(s,o),o.__e!=i&&fa(o)))})}function ga(n,e,t,s,r,o,i,a,c,l){var u,h,d,f,g,b,p,v=s&&s.__k||ha,C=v.length;for(t.__k=[],u=0;u<e.length;u++)if((f=t.__k[u]=(f=e[u])==null||typeof f=="boolean"?null:typeof f=="string"||typeof f=="number"||typeof f=="bigint"?ls(null,f,null,null,f):Array.isArray(f)?ls(Je,{children:f},null,null,null):f.__b>0?ls(f.type,f.props,f.key,f.ref?f.ref:null,f.__v):f)!=null){if(f.__=t,f.__b=t.__b+1,(d=v[u])===null||d&&f.key==d.key&&f.type===d.type)v[u]=void 0;else for(h=0;h<C;h++){if((d=v[h])&&f.key==d.key&&f.type===d.type){v[h]=void 0;break}d=null}oo(n,f,d=d||Zs,r,o,i,a,c,l),g=f.__e,(h=f.ref)&&d.ref!=h&&(p||(p=[]),d.ref&&p.push(d.ref,null,f),p.push(h,f.__c||g,f)),g!=null?(b==null&&(b=g),typeof f.type=="function"&&f.__k===d.__k?f.__d=c=ma(f,c,n):c=_a(n,f,d,v,g,c),typeof t.type=="function"&&(t.__d=c)):c&&d.__e==c&&c.parentNode!=n&&(c=gs(d))}for(t.__e=b,u=C;u--;)v[u]!=null&&va(v[u],v[u]);if(p)for(u=0;u<p.length;u++)pa(p[u],p[++u],p[++u])}function ma(n,e,t){for(var s,r=n.__k,o=0;r&&o<r.length;o++)(s=r[o])&&(s.__=n,e=typeof s.type=="function"?ma(s,e,t):_a(t,s,s,r,s.__e,e));return e}function kt(n,e){return e=e||[],n==null||typeof n=="boolean"||(Array.isArray(n)?n.some(function(t){kt(t,e)}):e.push(n)),e}function _a(n,e,t,s,r,o){var i,a,c;if(e.__d!==void 0)i=e.__d,e.__d=void 0;else if(t==null||r!=o||r.parentNode==null)e:if(o==null||o.parentNode!==n)n.appendChild(r),i=null;else{for(a=o,c=0;(a=a.nextSibling)&&c<s.length;c+=1)if(a==r)break e;n.insertBefore(r,o),i=o}return i!==void 0?i:r.nextSibling}function kc(n,e,t,s,r){var o;for(o in t)o==="children"||o==="key"||o in e||Qs(n,o,null,t[o],s);for(o in e)r&&typeof e[o]!="function"||o==="children"||o==="key"||o==="value"||o==="checked"||t[o]===e[o]||Qs(n,o,e[o],t[o],s)}function Wo(n,e,t){e[0]==="-"?n.setProperty(e,t):n[e]=t==null?"":typeof t!="number"||Mc.test(e)?t:t+"px"}function Qs(n,e,t,s,r){var o;e:if(e==="style")if(typeof t=="string")n.style.cssText=t;else{if(typeof s=="string"&&(n.style.cssText=s=""),s)for(e in s)t&&e in t||Wo(n.style,e,"");if(t)for(e in t)s&&t[e]===s[e]||Wo(n.style,e,t[e])}else if(e[0]==="o"&&e[1]==="n")o=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in n?e.toLowerCase().slice(2):e.slice(2),n.l||(n.l={}),n.l[e+o]=t,t?s||n.addEventListener(e,o?Go:Vo,o):n.removeEventListener(e,o?Go:Vo,o);else if(e!=="dangerouslySetInnerHTML"){if(r)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in n)try{n[e]=t==null?"":t;break e}catch{}typeof t=="function"||(t==null||t===!1&&e.indexOf("-")==-1?n.removeAttribute(e):n.setAttribute(e,t))}}function Vo(n){this.l[n.type+!1](le.event?le.event(n):n)}function Go(n){this.l[n.type+!0](le.event?le.event(n):n)}function oo(n,e,t,s,r,o,i,a,c){var l,u,h,d,f,g,b,p,v,C,w,x,A,z,R,E=e.type;if(e.constructor!==void 0)return null;t.__h!=null&&(c=t.__h,a=e.__e=t.__e,e.__h=null,o=[a]),(l=le.__b)&&l(e);try{e:if(typeof E=="function"){if(p=e.props,v=(l=E.contextType)&&s[l.__c],C=l?v?v.props.value:l.__:s,t.__c?b=(u=e.__c=t.__c).__=u.__E:("prototype"in E&&E.prototype.render?e.__c=u=new E(p,C):(e.__c=u=new Ue(p,C),u.constructor=E,u.render=Lc),v&&v.sub(u),u.props=p,u.state||(u.state={}),u.context=C,u.__n=s,h=u.__d=!0,u.__h=[],u._sb=[]),u.__s==null&&(u.__s=u.state),E.getDerivedStateFromProps!=null&&(u.__s==u.state&&(u.__s=Wt({},u.__s)),Wt(u.__s,E.getDerivedStateFromProps(p,u.__s))),d=u.props,f=u.state,h)E.getDerivedStateFromProps==null&&u.componentWillMount!=null&&u.componentWillMount(),u.componentDidMount!=null&&u.__h.push(u.componentDidMount);else{if(E.getDerivedStateFromProps==null&&p!==d&&u.componentWillReceiveProps!=null&&u.componentWillReceiveProps(p,C),!u.__e&&u.shouldComponentUpdate!=null&&u.shouldComponentUpdate(p,u.__s,C)===!1||e.__v===t.__v){for(u.props=p,u.state=u.__s,e.__v!==t.__v&&(u.__d=!1),u.__v=e,e.__e=t.__e,e.__k=t.__k,e.__k.forEach(function(D){D&&(D.__=e)}),w=0;w<u._sb.length;w++)u.__h.push(u._sb[w]);u._sb=[],u.__h.length&&i.push(u);break e}u.componentWillUpdate!=null&&u.componentWillUpdate(p,u.__s,C),u.componentDidUpdate!=null&&u.__h.push(function(){u.componentDidUpdate(d,f,g)})}if(u.context=C,u.props=p,u.__v=e,u.__P=n,x=le.__r,A=0,"prototype"in E&&E.prototype.render){for(u.state=u.__s,u.__d=!1,x&&x(e),l=u.render(u.props,u.state,u.context),z=0;z<u._sb.length;z++)u.__h.push(u._sb[z]);u._sb=[]}else do u.__d=!1,x&&x(e),l=u.render(u.props,u.state,u.context),u.state=u.__s;while(u.__d&&++A<25);u.state=u.__s,u.getChildContext!=null&&(s=Wt(Wt({},s),u.getChildContext())),h||u.getSnapshotBeforeUpdate==null||(g=u.getSnapshotBeforeUpdate(d,f)),R=l!=null&&l.type===Je&&l.key==null?l.props.children:l,ga(n,Array.isArray(R)?R:[R],e,t,s,r,o,i,a,c),u.base=e.__e,e.__h=null,u.__h.length&&i.push(u),b&&(u.__E=u.__=null),u.__e=!1}else o==null&&e.__v===t.__v?(e.__k=t.__k,e.__e=t.__e):e.__e=Bc(t.__e,e,t,s,r,o,i,c);(l=le.diffed)&&l(e)}catch(D){e.__v=null,(c||o!=null)&&(e.__e=a,e.__h=!!c,o[o.indexOf(a)]=null),le.__e(D,e,t)}}function ba(n,e){le.__c&&le.__c(e,n),n.some(function(t){try{n=t.__h,t.__h=[],n.some(function(s){s.call(t)})}catch(s){le.__e(s,t.__v)}})}function Bc(n,e,t,s,r,o,i,a){var c,l,u,h=t.props,d=e.props,f=e.type,g=0;if(f==="svg"&&(r=!0),o!=null){for(;g<o.length;g++)if((c=o[g])&&"setAttribute"in c==!!f&&(f?c.localName===f:c.nodeType===3)){n=c,o[g]=null;break}}if(n==null){if(f===null)return document.createTextNode(d);n=r?document.createElementNS("http://www.w3.org/2000/svg",f):document.createElement(f,d.is&&d),o=null,a=!1}if(f===null)h===d||a&&n.data===d||(n.data=d);else{if(o=o&&Is.call(n.childNodes),l=(h=t.props||Zs).dangerouslySetInnerHTML,u=d.dangerouslySetInnerHTML,!a){if(o!=null)for(h={},g=0;g<n.attributes.length;g++)h[n.attributes[g].name]=n.attributes[g].value;(u||l)&&(u&&(l&&u.__html==l.__html||u.__html===n.innerHTML)||(n.innerHTML=u&&u.__html||""))}if(kc(n,d,h,r,a),u)e.__k=[];else if(g=e.props.children,ga(n,Array.isArray(g)?g:[g],e,t,s,r&&f!=="foreignObject",o,i,o?o[0]:t.__k&&gs(t,0),a),o!=null)for(g=o.length;g--;)o[g]!=null&&da(o[g]);a||("value"in d&&(g=d.value)!==void 0&&(g!==n.value||f==="progress"&&!g||f==="option"&&g!==h.value)&&Qs(n,"value",g,h.value,!1),"checked"in d&&(g=d.checked)!==void 0&&g!==n.checked&&Qs(n,"checked",g,h.checked,!1))}return n}function pa(n,e,t){try{typeof n=="function"?n(e):n.current=e}catch(s){le.__e(s,t)}}function va(n,e,t){var s,r;if(le.unmount&&le.unmount(n),(s=n.ref)&&(s.current&&s.current!==n.__e||pa(s,null,e)),(s=n.__c)!=null){if(s.componentWillUnmount)try{s.componentWillUnmount()}catch(o){le.__e(o,e)}s.base=s.__P=null,n.__c=void 0}if(s=n.__k)for(r=0;r<s.length;r++)s[r]&&va(s[r],e,t||typeof n.type!="function");t||n.__e==null||da(n.__e),n.__=n.__e=n.__d=void 0}function Lc(n,e,t){return this.constructor(n,t)}function zn(n,e,t){var s,r,o;le.__&&le.__(n,e),r=(s=typeof t=="function")?null:t&&t.__k||e.__k,o=[],oo(e,n=(!s&&t||e).__k=m(Je,null,[n]),r||Zs,Zs,e.ownerSVGElement!==void 0,!s&&t?[t]:r?null:e.firstChild?Is.call(e.childNodes):null,o,!s&&t?t:r?r.__e:e.firstChild,s),ba(o,n)}function Ca(n,e){zn(n,e,Ca)}function er(n,e,t){var s,r,o,i=Wt({},n.props);for(o in e)o=="key"?s=e[o]:o=="ref"?r=e[o]:i[o]=e[o];return arguments.length>2&&(i.children=arguments.length>3?Is.call(arguments,2):t),ls(n.type,i,s||n.key,r||n.ref,null)}function wa(n,e){var t={__c:e="__cC"+ua++,__:n,Consumer:function(s,r){return s.children(r)},Provider:function(s){var r,o;return this.getChildContext||(r=[],(o={})[e]=this,this.getChildContext=function(){return o},this.shouldComponentUpdate=function(i){this.props.value!==i.value&&r.some(Wr)},this.sub=function(i){r.push(i);var a=i.componentWillUnmount;i.componentWillUnmount=function(){r.splice(r.indexOf(i),1),a&&a.call(i)}}),s.children}};return t.Provider.__=t.Consumer.contextType=t}Is=ha.slice,le={__e:function(n,e,t,s){for(var r,o,i;e=e.__;)if((r=e.__c)&&!r.__)try{if((o=r.constructor)&&o.getDerivedStateFromError!=null&&(r.setState(o.getDerivedStateFromError(n)),i=r.__d),r.componentDidCatch!=null&&(r.componentDidCatch(n,s||{}),i=r.__d),i)return r.__E=r}catch(a){n=a}throw n}},ca=0,Ue.prototype.setState=function(n,e){var t;t=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Wt({},this.state),typeof n=="function"&&(n=n(Wt({},t),this.props)),n&&Wt(t,n),n!=null&&this.__v&&(e&&this._sb.push(e),Wr(this))},Ue.prototype.forceUpdate=function(n){this.__v&&(this.__e=!0,n&&this.__h.push(n),Wr(this))},Ue.prototype.render=Je,as=[],Js.__r=0,ua=0;var Ea=(n=>(n[n.OBSERVER_ACTION=1]="OBSERVER_ACTION",n[n.SERVER_ACTION=2]="SERVER_ACTION",n[n.UNDO_ACTION=3]="UNDO_ACTION",n[n.EXTENSION_ACTION=4]="EXTENSION_ACTION",n[n.DEFAULT_ACTION=7]="DEFAULT_ACTION",n))(Ea||{});class Ta{constructor(e,t){this._doActionData=e,this._observers=t,this._operation=1}getDoActionData(){return this._doActionData}getOldActionDaa(){return this._oldActionData}hasOperation(e){return(this._operation&e)===e}addOperation(e){this._operation|=e}removeOperation(e){this._operation&=~e}}class pe extends Ta{constructor(e,t,s){if(super(e,s),t.WorkBookUnit==null)throw new Error("action workbook domain can not be null!");this._workbook=t.WorkBookUnit}getWorkSheet(){const{_workbook:e,_doActionData:t}=this,{sheetId:s}=t;return e.getSheetBySheetId(s)}getWorkBook(){return this._workbook}}class Fc{constructor(e=!1){this.isStopPropagation=!1,this.initialize(e)}initialize(e=!1){return this.skipNextObservers=e,this}stopPropagation(){this.isStopPropagation=!0}}class Hc{constructor(e){this.callback=e,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class me{constructor(e){this._observers=new Array,this._eventState=new Fc,e&&(this._onObserverAdded=e)}get observers(){return this._observers}add(e,t=!1,s=!1){if(!e)return null;const r=new Hc(e);return r.unregisterOnNextCall=s,t?this._observers.unshift(r):this._observers.push(r),this._onObserverAdded&&this._onObserverAdded(r),r}addOnce(e){return this.add(e,void 0,!0)}remove(e){return e&&this._observers.indexOf(e)!==-1?(this._deferUnregister(e),!0):!1}removeCallback(e){for(let t=0;t<this._observers.length;t++){const s=this._observers[t];if(!s._willBeUnregistered&&s.callback===e)return this._deferUnregister(s),!0}return!1}_deferUnregister(e){e.unregisterOnNextCall=!1,e._willBeUnregistered=!0,setTimeout(()=>{this._remove(e)},0)}_remove(e){if(!e)return!1;const t=this._observers.indexOf(e);return t!==-1?(this._observers.splice(t,1),!0):!1}makeObserverTopPriority(e){this._remove(e),this._observers.unshift(e)}makeObserverBottomPriority(e){this._remove(e),this._observers.push(e)}notifyObservers(e){if(!this._observers.length)return null;const t=this._eventState;t.skipNextObservers=!1,t.lastReturnValue=e,t.isStopPropagation=!1;let s=!1;for(let r=0;r<this._observers.length;r++){const o=this._observers[r];if(!o._willBeUnregistered&&(t.lastReturnValue=o.callback(e,t),o.unregisterOnNextCall&&this._deferUnregister(o),t.isStopPropagation&&(s=!0),t.skipNextObservers))return{lastReturnValue:t.lastReturnValue,stopPropagation:s}}return{lastReturnValue:t.lastReturnValue,stopPropagation:s}}notifyObserversWithPromise(e){let t=Promise.resolve(e);if(!this._observers.length)return t;const s=this._eventState;s.skipNextObservers=!1;for(let r=0;r<this._observers.length;r++){const o=this._observers[r];s.skipNextObservers||o._willBeUnregistered||(t=t.then(()=>o.callback(e,s)),o.unregisterOnNextCall&&this._deferUnregister(o))}return t.then(()=>e)}notifyObserver(e,t){if(e._willBeUnregistered)return;const s=this._eventState;return s.skipNextObservers=!1,e.callback(t,s),e.unregisterOnNextCall&&this._deferUnregister(e),{lastReturnValue:s.lastReturnValue,stopPropagation:s.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const e=new me;return e._observers=this._observers.slice(0),e}}class Pc{constructor(e,t){this.name=e,this.observableHooks=t}}class zc{constructor(){this._observableHooksArray=new Array}addHooks(e,t){this._observableHooksArray.push(new Pc(e,t))}getHooks(e){const t=this._observableHooksArray.find(s=>s.name===e);return t?t.observableHooks:null}}const Ot=n=>n!=null;class Ee{static objectKeys(e){if(e){const t=Object.keys(e),s=t.indexOf("length");return s>-1&&t.splice(s,1),t}return[]}static getMaxLength(e){if(e){if(e.length)return e.length;const t=Ee.objectKeys(e);if(t.length)return Math.max(...t)+1}return 0}constructor(...e){if(S.hasLength(e,1)){if(S.isObject(e[0])){this._array=e[0],this._length=Ee.getMaxLength(this._array);return}if(S.isNumber(e[0])){this._array={},this._length=e[0];return}}if(S.hasLength(e,2)){const t=e[0],s=e[1];this._array=t,this._length=s;return}S.hasLength(e,0)&&(this._array={},this._length=0)}obtain(e,t){var s;return(s=this._array[e])!=null?s:t}getKeys(){return Ee.objectKeys(this._array)}get(e){return this._array[e]}set(e,t){if(Ot(t)){const s=this._length;this._array[e]=t,e>=s&&(this._length=e+1)}}pop(){const e=this._length,t=this._array;if(e>0){const s=e-1,r=t[s];return s>0&&(delete t[s],this._length--),r}return null}push(e){if(Ot(e)){let t=this._length;const s=this._array;s[t++]=e,this._length=t}}first(){return this._array[0]}last(){const e=this._length-1;return this._array[e]}shift(){const e=this._length;if(e>0){const t=this._array[0],s=e-1;let r;for(let o=0;o<s;o++)r=this._array[o+1],Ot(r)&&(this._array[o]=r);return this._length--,delete this._array[s],t}return null}unshift(e){if(Ot(e)){const t=this._length,s=this._array,r=t+1;let o=s[0];for(let i=1;i<r;i++){const a=this._array[i];Ot(o)&&(s[i]=o),o=a}s[0]=e,this._length=r}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const e=this._array;return Object.keys(e).length}toJSON(){return{...this._array,length:this._length}}toArray(){const e=new Array,t=this._array,s=Object.keys(t),r=s.length;for(let o=0;o<r;o++){const i=+s[o];e[i]=t[i]}return e}forEach(e){const t=this._array,s=Object.keys(t),r=s.length;for(let o=0;o<r;o++){const i=+s[o];if(e(i,t[i])===!1)return this}return this}clone(e){const t=new Ee;return e?this.forEach((s,r)=>{t.set(s,e(r))}):this.forEach((s,r)=>{t.set(s,r)}),t}isEmpty(){const e=this._array;return Object.keys(e).length===0}delete(e){this.splice(e,1)}includes(e){const t=this._array,s=Object.keys(t),r=s.length;for(let o=0;o<r;o++){const i=+s[o];if(t[i]===e)return!0}return!1}slice(e,t){const s=this._array;if(this._length>0){const o={};let i=0;for(let a=e;a<t;a++){const c=s[a];Ot(c)&&(o[i]=s[a],i++)}return new Ee(o,i)}return new Ee}concat(e){const t=this._array,s=Object.keys(t),r=s.length,o=e._array,i=Object.keys(o),a=i.length,c=new Ee(r+a),l=c._array;let u=0;for(let h=0;h<r;h++,u++){const d=s[h];l[u]=t[d]}for(let h=0;h<a;h++,u++){const d=i[h];l[u]=o[d]}return c}find(e){const t=this._array,s=Object.keys(t),r=s.length;for(let o=0;o<r;o++){const i=+s[o],a=t[i];if(e(i,a)===!0)return a}return null}splice(e,t){const s=this._length;if(s>0){const r=e+t,o=this._array;let i=0;const a={};for(let u=e;u<r;u++){const h=o[u];Ot(h)&&(delete o[u],a[i]=h,i++)}const c=r-e,l=s;if(this._length-=c,this._length<=0)this._array={},this._length=0;else for(let u=r;u<l;u++){const h=o[u];Ot(h)&&(o[u-c]=o[u],delete o[u])}return new Ee(a,i)}return new Ee}findIndex(e){const t=this._array,s=Object.keys(t),r=s.length;for(let o=0;o<r;o++){const i=+s[o];if(e(i,t[i])===!0)return o}return-1}map(e){const t=this._array,s=Object.keys(t),r=s.length,o={};for(let i=0;i<r;i++){const a=+s[i],c=t[a];o[i]=e(c)}return new Ee(o)}filter(e){const t=this._array,s=Object.keys(t),r=s.length,o={};let i=0;for(let a=0;a<r;a++){const c=+s[a],l=t[c];e(c,l)&&(o[i]=l,i++)}return new Ee(o,i)}insert(e,t){const s=this._length,r=this._array;for(let o=s-1;o>=e;o--)r[o+1]=r[o];return r[e]=t,this._length=s+1,this}inserts(e,t){const s=t._array,r=t._length,o=this._array,a=this._length-1;for(let c=a;c>=e;c--){const l=o[c];Ot(l)&&(delete o[c],o[c+r]=l)}for(let c=0;c<r;c++){const l=s[c];Ot(l)&&(o[c+e]=s[c])}return this._length+=r,this}[Symbol.iterator](){return new io(this)}}class io{constructor(e){this._array=e,this._keys=e.getKeys(),this._cursor=0}next(){const e=this._array,t=this._keys,s=this._cursor;if(s<t.length){const r=t[s],o=e.get(+r);return this._cursor++,{value:o,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new io(this._array)}}class ee{constructor(e={}){if(S.isAssignableFrom(e,ee)){this._matrix=e._matrix;return}if(S.isAssignableFrom(e,Ee)){this._matrix=e;return}S.isPlainObject(e)&&(this._matrix=new Ee(e))}getMatrix(){return this._matrix}forEach(e){const s=this._matrix.getKeys(),r=s.length;for(let o=0;o<r;o++){const i=+s[o],a=this.getRow(i);if(e(i,a)===!1)return this}return this}forValue(e){const s=this._matrix.getKeys(),r=s.length;for(let o=0;o<r;o++){const i=+s[o],a=this.getRow(i),c=a.getKeys(),l=c.length;for(let u=0;u<l;u++){const h=+c[u],d=a.get(h);if(e(i,h,d)===!1)return this}}return this}swapRow(e,t){const s=this._matrix.get(e),r=this._matrix.get(t);this._matrix.set(t,s),this._matrix.set(e,r)}getRow(e){const{_matrix:t}=this;let s=t.get(e);if(S.isAssignableFrom(s,Ee))return s;if(S.isPlainObject(s))return s=new Ee(s),t.set(e,s),s}getRowOrCreate(e){const t=this.getRow(e);if(t)return t;const s=new Ee;return this._matrix.set(e,s),s}reset(){this._matrix=new Ee({})}hasValue(){const e=this._matrix;for(const t of e)if(!t.isEmpty())return!0;return!1}getValue(e,t){const s=this.getRow(e);return s?s.get(t):null}setValue(e,t,s){this.getRowOrCreate(e).set(t,s)}deleteValue(e,t){const s=this.getRow(e);s&&s.delete(t)}spliceRows(e,t){const s=this._matrix.splice(e,t);return new ee(s)}pushRow(e){this._matrix.push(e)}insertRow(e,t){this._matrix.insert(e,t)}insertRows(e,t){this._matrix.inserts(e,t._matrix)}spliceColumns(e,t){const s=new ee;return this._matrix.forEach((r,o)=>{var i;for(let a=e;a<e+t;a++)s.setValue(r,a-e,this.getValue(r,a));(i=this._matrix.get(r))==null||i.splice(e,t)}),s}insertColumns(e,t){const s=t.getRow(0).getLength();this.forEach((r,o)=>{var i,a;for(let c=e;c<e+s;c++)(i=t.getRow(r))==null||i.get(c-e),o.insert(c,(a=t.getRow(r))==null?void 0:a.get(c-e))})}getFragments(e,t,s,r){const o=new ee;for(let i=e;i<=t;i++){const a=new Ee;for(let c=s;c<=r;c++){const l=this.getValue(i,c);a.push(l)}o.pushRow(a)}return o}getSizeOf(){return this._matrix.getSizeOf()}getLength(){return this._matrix.getLength()}getRange(){const s=this.getSizeOf();let r=0;const o=this.getLength();for(let i=0;i<o;i++){const a=this.getRow(i);if(a){const c=a.getSizeOf();a.getSizeOf()>r&&(r=c-1)}}return{startRow:0,startColumn:0,endRow:s,endColumn:r}}toArray(){return this._matrix.toArray().map(e=>e.toArray())}toJSON(){const{_matrix:e}=this;return e.toJSON()}getData(){const e=JSON.stringify(this);return JSON.parse(e)}getArrayData(){let e=0,t=0,s=!1,r=!1;const o=new ee;return this.forEach((i,a)=>{s||(s=!0,e=i),a.forEach((c,l)=>{r?c<t&&(t=c):(r=!0,t=c);const u=this.getValue(i,c);o.setValue(i-e,c-t,u)})}),o.getData()}getDataRange(){let e=0,t=0,s=0,r=!1,o=!1;this.forEach((a,c)=>{r||(r=!0,e=a);const l=c.getLength()-1;l>s&&(s=l),c.forEach((u,h)=>{o?u<t&&(t=u):(o=!0,t=u)})});const i=e+this.getSizeOf()-1;return{startRow:e,startColumn:t,endRow:i,endColumn:s}}}const Uc=/^-ms-/,Wc=/-([a-z])/g,Xt=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class S{static stringAt(e){let t="",s=e;for(;s>=Xt.length;)s/=Xt.length,s-=1,t+=Xt[s%Xt.length];const r=e%Xt.length;return t+=Xt[r],t}static getEnvironment(){const{appVersion:e}=navigator,t=this.getSystemType();return{app_version:e,os:t,os_version:t,device_id:"",platform:"web"}}static indexAt(e){let t=0;for(let s=0;s<e.length-1;s+=1){const r=e.charCodeAt(s)-65,o=e.length-1-s;t+=Xt.length**o+Xt.length*r}return t+=e.charCodeAt(e.length-1)-65,t}static deleteBlank(e){return S.isString(e)?e.replace(/\s/g,""):e}static getSystemType(){const e=navigator.userAgent,t=navigator.platform==="Win32"||navigator.platform==="Windows",s=navigator.platform==="Mac68K"||navigator.platform==="MacPPC"||navigator.platform==="Macintosh"||navigator.platform==="MacIntel";if(s)return"Mac";if(navigator.platform==="X11"&&!t&&!s)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(t){if(e.indexOf("Windows NT 5.0")>-1||e.indexOf("Windows 2000")>-1)return"Windows 2000";if(e.indexOf("Windows NT 5.1")>-1||e.indexOf("Windows XP")>-1)return"Windows XP";if(e.indexOf("Windows NT 5.2")>-1||e.indexOf("Windows 2003")>-1)return"Windows 2003";if(e.indexOf("Windows NT 6.0")>-1||e.indexOf("Windows Vista")>-1)return"Windows Vista";if(e.indexOf("Windows NT 6.1")>-1||e.indexOf("Windows 7")>-1)return"Windows 7";if(e.indexOf("Windows NT 10")>-1||e.indexOf("Windows 10")>-1)return"Windows 10";if(e.indexOf("Windows NT 11")>-1||e.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const e=navigator.userAgent,t=e.indexOf("Opera")>-1,s=e.indexOf("compatible")>-1&&e.indexOf("MSIE")>-1&&!t,r=e.indexOf("Trident")>-1&&e.indexOf("rv:11.0")>-1,o=e.indexOf("Edge")>-1,i=e.indexOf("Firefox")>-1,a=e.indexOf("Safari")>-1&&e.indexOf("Chrome")===-1,c=e.indexOf("Chrome")>-1&&e.indexOf("Safari")>-1;if(s){new RegExp("MSIE (\\d+\\.\\d+);").test(e);const u=parseFloat(RegExp.$1);return u===7?"IE7":u===8?"IE8":u===9?"IE9":u===10?"IE10":"0"}return i?"FF":t?"Opera":a?"Safari":c?"Chrome":o?"Edge":r?"IE11":"Unknown browser"}static generateRandomId(){function e(){return((1+Math.random())*65536|0).toString(16).substring(1)}return`${e()+e()}-${e()}-${e()}-${e()}-${e()}${e()}${e()}`}static getClassName(e){return e.constructor.name}static deepMerge(e,...t){t.forEach(i=>i&&o(i));function s(i,a){i.forEach((c,l)=>{var u,h;if(S.isArray(c)){const d=(u=a[l])!=null?u:[];a[l]=d,s(c,d);return}if(S.isObject(c)){const d=(h=a[l])!=null?h:{};a[l]=d,r(c,d);return}a[l]=c})}function r(i,a){Object.keys(i).forEach(c=>{var u,h;const l=i[c];if(S.isObject(l)){const d=(u=a[c])!=null?u:{};a[c]=d,r(l,d);return}if(S.isArray(l)){const d=(h=a[c])!=null?h:[];a[c]=d,s(l,d);return}a[c]=l})}function o(i){Object.keys(i).forEach(a=>{var l,u;const c=i[a];if(S.isArray(c)){const h=(l=e[a])!=null?l:[];e[a]=h,s(c,h);return}if(S.isObject(c)){const h=(u=e[a])!=null?u:{};e[a]=h,r(c,h);return}e[a]=c})}return e}static numberFixed(e,t){return Number(Number(e).toFixed(t))}static diffValue(e,t){function s(i,a){const c=S.getValueType(i),l=S.getValueType(a);return c!==l?!1:S.isArray(i)?r(i,a):S.isObject(i)?o(i,a):S.isDate(i)?i.getTime()===a.getTime():S.isRegExp(i)?i.toString()===a.toString():i===a}function r(i,a){if(e.length!==t.length)return!1;for(let c=0,l=i.length;c<l;c++){const u=i[c],h=a[c];if(!s(u,h))return!1}return!0}function o(i,a){const c=Object.keys(i),l=Object.keys(a);if(c.length!==l.length)return!1;for(const u of c){if(!l.includes(u))return!1;const h=i[u],d=a[u];if(!s(h,d))return!1}return!0}return s(e,t)}static deepClone(e){if(!this.isDefine(e))return e;if(this.isRegExp(e))return new RegExp(e);if(this.isDate(e))return new Date(e);if(this.isArray(e)){const t=[];return e.forEach((s,r)=>{t[r]=S.deepClone(s)}),t}if(this.isObject(e)){const t={};return Object.keys(e).forEach(s=>{const r=e[s];t[s]=S.deepClone(r)}),Object.setPrototypeOf(t,Object.getPrototypeOf(e)),t}return e}static getLanguage(){const e="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||e}static getValueType(e){return Object.prototype.toString.apply(e)}static isDefine(e){return e!=null}static isBlank(e){return this.isDefine(e)?this.isString(e)?e.trim()==="":!1:!0}static isAssignableFrom(e,t){return e instanceof t}static isBoolean(e){return this.getValueType(e)==="[object Boolean]"}static isPlainObject(e){return this.isDefine(e)?Object.getPrototypeOf(e)===Object.getPrototypeOf({}):!1}static isFunction(e){return this.getValueType(e)==="[object Function]"}static isDate(e){return this.getValueType(e)==="[object Date]"}static isRegExp(e){return this.getValueType(e)==="[object RegExp]"}static isArray(e){return this.getValueType(e)==="[object Array]"}static isString(e){return this.getValueType(e)==="[object String]"}static isNumber(e){return this.getValueType(e)==="[object Number]"}static isStringNumber(e){return!isNaN(parseFloat(e))&&isFinite(e)}static isObject(e){return this.getValueType(e)==="[object Object]"}static isEmptyObject(e){for(const t in e)return!1;return!0}static isMobile(){let e=0,t=0;return document.body.clientWidth&&(e=document.body.clientWidth),document.body.clientHeight&&(t=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||e<350&&t<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const e=navigator.userAgent.toLowerCase();return String(e.match(/MicroMessenger/i))==="micromessenger"}static isAndroid(){const e=navigator.userAgent;return e.indexOf("Android")>-1||e.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(e){return t=>{for(let s=0;s<e;s++)t&&t()}}static hasLength(e,t){return S.isDefine(e)?S.isDefine(t)?e.length===t:e.length>0:!1}static capitalize(e){return e.charAt(0).toUpperCase()+e.slice(1)}static fCamelCase(e,t){return t.toUpperCase()}static camelCase(e){return e.replace(Uc,"ms-").replace(Wc,this.fCamelCase)}static removeNull(e){if(this.isObject(e)){const t={};return Object.keys(e).forEach(s=>{const r=e[s];r==null?delete e[s]:S.removeNull(r)}),t}return e}static fillTwoDimensionalArray(e,t,s){return new Array(e).fill(s).map(r=>new Array(t).fill(s))}static fillObjectMatrix(e,t,s){const r=new ee;for(let o=0;o<e;o++)for(let i=0;i<t;i++)r.setValue(o,i,s);return r.getData()}static numToWord(e){let t="";for(;e>0;){let s=e%26;s=s===0?s=26:s,t=String.fromCharCode(96+s)+t,e=(e-s)/26}return t.toLocaleUpperCase()}static ABCatNum(e){if(e==null||e.length===0)return NaN;const t=e.toLowerCase().split(""),s=t.length;let r=0,o=0;for(let i=0;i<s;i++)o=t[i].charCodeAt(0)-96,r+=o*26**(s-i-1);return r===0?NaN:r-1}static chatAtABC(e){const t="a".charCodeAt(0),r="z".charCodeAt(0)-t+1;let o="";for(;e>=0;)o=String.fromCharCode(e%r+t)+o,e=Math.floor(e/r)-1;return o.toUpperCase()}static randSort(e){for(let t=0,s=e.length;t<s;t++){const r=parseInt((Math.random()*s).toString()),o=e[r];e[r]=e[t],e[t]=o}return e}static commonExtend(e,t){let s={};for(let r in e)s[r]=e[r];for(let r in t)t[r]!=null&&(s[r]=t[r]);return s}static commonExtend1(e,t){for(let s in e)t[s]==null&&(t[s]=e[s]);return t}static arrayToObject(e){const t={};return e.forEach((s,r)=>{t[r]={},s.forEach((o,i)=>{t[r][i]=o})}),t}}var Vr=(n=>(n[n.DEFAULT_SERIES=0]="DEFAULT_SERIES",n[n.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",n))(Vr||{}),_=(n=>(n[n.NONE=0]="NONE",n[n.THIN=1]="THIN",n[n.HAIR=2]="HAIR",n[n.DOTTED=3]="DOTTED",n[n.DASHED=4]="DASHED",n[n.DASH_DOT=5]="DASH_DOT",n[n.DASH_DOT_DOT=6]="DASH_DOT_DOT",n[n.DOUBLE=7]="DOUBLE",n[n.MEDIUM=8]="MEDIUM",n[n.MEDIUM_DASHED=9]="MEDIUM_DASHED",n[n.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",n[n.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",n[n.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",n[n.THICK=13]="THICK",n))(_||{}),vt=(n=>(n.TOP="top",n.BOTTOM="bottom",n.LEFT="left",n.RIGHT="right",n.NONE="none",n.ALL="all",n.OUTSIDE="outside",n.INSIDE="inside",n.HORIZONTAL="horizontal",n.VERTICAL="vertical",n))(vt||{}),Tt=(n=>(n[n.UNSUPPORTED=0]="UNSUPPORTED",n[n.RGB=1]="RGB",n[n.HEX=2]="HEX",n[n.THEME=3]="THEME",n))(Tt||{}),ts=(n=>(n[n.PASTE_NORMAL=0]="PASTE_NORMAL",n[n.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",n[n.PASTE_FORMAT=2]="PASTE_FORMAT",n[n.PASTE_FORMULA=3]="PASTE_FORMULA",n[n.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",n[n.PASTE_VALUES=5]="PASTE_VALUES",n[n.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",n[n.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",n))(ts||{}),wn=(n=>(n[n.COLUMNS=0]="COLUMNS",n[n.ROWS=1]="ROWS",n))(wn||{}),k=(n=>(n[n.LEFT=0]="LEFT",n[n.RIGHT=1]="RIGHT",n[n.TOP=2]="TOP",n[n.BOTTOM=3]="BOTTOM",n))(k||{}),Gr=(n=>(n[n.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",n[n.TEXT=1]="TEXT",n[n.NUMBER=2]="NUMBER",n[n.PERCENT=3]="PERCENT",n[n.CURRENCY=4]="CURRENCY",n[n.DATE=5]="DATE",n[n.TIME=6]="TIME",n[n.DATE_TIME=7]="DATE_TIME",n[n.SCIENTIFIC=8]="SCIENTIFIC",n))(Gr||{}),It=(n=>(n.EN="en",n.ZH="zh",n))(It||{}),Ge=(n=>(n[n.GRID=0]="GRID",n[n.KANBAN=1]="KANBAN",n[n.GANTT=2]="GANTT",n))(Ge||{}),Ra=(n=>(n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",n[n.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",n))(Ra||{}),He=(n=>(n[n.DASH=0]="DASH",n[n.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",n[n.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",n[n.DASHED_HEAVY=3]="DASHED_HEAVY",n[n.DASH_LONG=4]="DASH_LONG",n[n.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",n[n.DOT_DASH=6]="DOT_DASH",n[n.DOT_DOT_DASH=7]="DOT_DOT_DASH",n[n.DOTTED=8]="DOTTED",n[n.DOTTED_HEAVY=9]="DOTTED_HEAVY",n[n.DOUBLE=10]="DOUBLE",n[n.NONE=11]="NONE",n[n.SINGLE=12]="SINGLE",n[n.THICK=13]="THICK",n[n.WAVE=14]="WAVE",n[n.WAVY_DOUBLE=15]="WAVY_DOUBLE",n[n.WAVY_HEAVY=16]="WAVY_HEAVY",n[n.WORDS=17]="WORDS",n))(He||{}),Ye=(n=>(n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.LEFT=1]="LEFT",n[n.CENTER=2]="CENTER",n[n.RIGHT=3]="RIGHT",n[n.JUSTIFIED=4]="JUSTIFIED",n))(Ye||{}),Vt=(n=>(n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.TOP=1]="TOP",n[n.MIDDLE=2]="MIDDLE",n[n.BOTTOM=3]="BOTTOM",n))(Vt||{}),Bt=(n=>(n[n.UNSPECIFIED=0]="UNSPECIFIED",n[n.OVERFLOW=1]="OVERFLOW",n[n.CLIP=2]="CLIP",n[n.WRAP=3]="WRAP",n))(Bt||{}),Dt=(n=>(n[n.NORMAL=0]="NORMAL",n[n.SUBSCRIPT=1]="SUBSCRIPT",n[n.SUPERSCRIPT=2]="SUPERSCRIPT",n))(Dt||{}),L=(n=>(n[n.FALSE=0]="FALSE",n[n.TRUE=1]="TRUE",n))(L||{}),at=(n=>(n[n.DARK1=0]="DARK1",n[n.LIGHT1=1]="LIGHT1",n[n.DARK2=2]="DARK2",n[n.LIGHT2=3]="LIGHT2",n[n.ACCENT1=4]="ACCENT1",n[n.ACCENT2=5]="ACCENT2",n[n.ACCENT3=6]="ACCENT3",n[n.ACCENT4=7]="ACCENT4",n[n.ACCENT5=8]="ACCENT5",n[n.ACCENT6=9]="ACCENT6",n[n.HYPERLINK=10]="HYPERLINK",n[n.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",n))(at||{}),ao=(n=>(n.OFFICE="Office",n.OFFICE_2007_2010="Office 2007-2010",n.GRAYSCALE="Grayscale",n.BLUE_WARM="Blue Warm",n.BLUE="Blue",n.BLUE_II="Blue II",n.BLUE_GREEN="Blue Green",n.GREEN="Green",n.GREEN_YELLOW="Green Yellow",n.YELLOW="Yellow",n.YELLOW_ORANGE="Yellow Orange",n.ORANGE="Orange",n.ORANGE_RED="Orange Red",n.RED_ORANGE="Red Orange",n.RED="Red",n.RED_VIOLET="Red Violet",n.VIOLET="Violet",n.VIOLET_II="Violet II",n.MEDIAN="Median",n.PAPER="Paper",n.MARQUEE="Marquee",n.SLIPSTREAM="Slipstream",n.Aspect="Aspect",n))(ao||{}),Hn=(n=>(n[n.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",n[n.TEXT_BOX=1]="TEXT_BOX",n[n.RECTANGLE=2]="RECTANGLE",n[n.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",n[n.ELLIPSE=4]="ELLIPSE",n[n.ARC=5]="ARC",n[n.BENT_ARROW=6]="BENT_ARROW",n[n.BENT_UP_ARROW=7]="BENT_UP_ARROW",n[n.BEVEL=8]="BEVEL",n[n.BLOCK_ARC=9]="BLOCK_ARC",n[n.BRACE_PAIR=10]="BRACE_PAIR",n[n.BRACKET_PAIR=11]="BRACKET_PAIR",n[n.CAN=12]="CAN",n[n.CHEVRON=13]="CHEVRON",n[n.CHORD=14]="CHORD",n[n.CLOUD=15]="CLOUD",n[n.CORNER=16]="CORNER",n[n.CUBE=17]="CUBE",n[n.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",n[n.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",n[n.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",n[n.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",n[n.DECAGON=22]="DECAGON",n[n.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",n[n.DIAMOND=24]="DIAMOND",n[n.DODECAGON=25]="DODECAGON",n[n.DONUT=26]="DONUT",n[n.DOUBLE_WAVE=27]="DOUBLE_WAVE",n[n.DOWN_ARROW=28]="DOWN_ARROW",n[n.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",n[n.FOLDED_CORNER=30]="FOLDED_CORNER",n[n.FRAME=31]="FRAME",n[n.HALF_FRAME=32]="HALF_FRAME",n[n.HEART=33]="HEART",n[n.HEPTAGON=34]="HEPTAGON",n[n.HEXAGON=35]="HEXAGON",n[n.HOME_PLATE=36]="HOME_PLATE",n[n.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",n[n.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",n[n.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",n[n.LEFT_ARROW=40]="LEFT_ARROW",n[n.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",n[n.LEFT_BRACE=42]="LEFT_BRACE",n[n.LEFT_BRACKET=43]="LEFT_BRACKET",n[n.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",n[n.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",n[n.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",n[n.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",n[n.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",n[n.MATH_DIVIDE=49]="MATH_DIVIDE",n[n.MATH_EQUAL=50]="MATH_EQUAL",n[n.MATH_MINUS=51]="MATH_MINUS",n[n.MATH_MULTIPLY=52]="MATH_MULTIPLY",n[n.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",n[n.MATH_PLUS=54]="MATH_PLUS",n[n.MOON=55]="MOON",n[n.NO_SMOKING=56]="NO_SMOKING",n[n.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",n[n.OCTAGON=58]="OCTAGON",n[n.PARALLELOGRAM=59]="PARALLELOGRAM",n[n.PENTAGON=60]="PENTAGON",n[n.PIE=61]="PIE",n[n.PLAQUE=62]="PLAQUE",n[n.PLUS=63]="PLUS",n[n.QUAD_ARROW=64]="QUAD_ARROW",n[n.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",n[n.RIBBON=66]="RIBBON",n[n.RIBBON_2=67]="RIBBON_2",n[n.RIGHT_ARROW=68]="RIGHT_ARROW",n[n.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",n[n.RIGHT_BRACE=70]="RIGHT_BRACE",n[n.RIGHT_BRACKET=71]="RIGHT_BRACKET",n[n.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",n[n.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",n[n.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",n[n.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",n[n.SMILEY_FACE=76]="SMILEY_FACE",n[n.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",n[n.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",n[n.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",n[n.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",n[n.STAR_10=81]="STAR_10",n[n.STAR_12=82]="STAR_12",n[n.STAR_16=83]="STAR_16",n[n.STAR_24=84]="STAR_24",n[n.STAR_32=85]="STAR_32",n[n.STAR_4=86]="STAR_4",n[n.STAR_5=87]="STAR_5",n[n.STAR_6=88]="STAR_6",n[n.STAR_7=89]="STAR_7",n[n.STAR_8=90]="STAR_8",n[n.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",n[n.SUN=92]="SUN",n[n.TRAPEZOID=93]="TRAPEZOID",n[n.TRIANGLE=94]="TRIANGLE",n[n.UP_ARROW=95]="UP_ARROW",n[n.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",n[n.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",n[n.UTURN_ARROW=98]="UTURN_ARROW",n[n.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",n[n.WAVE=100]="WAVE",n[n.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",n[n.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",n[n.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",n[n.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",n[n.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",n[n.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",n[n.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",n[n.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",n[n.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",n[n.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",n[n.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",n[n.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",n[n.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",n[n.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",n[n.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",n[n.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",n[n.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",n[n.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",n[n.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",n[n.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",n[n.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",n[n.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",n[n.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",n[n.FLOW_CHART_OR=124]="FLOW_CHART_OR",n[n.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",n[n.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",n[n.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",n[n.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",n[n.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",n[n.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",n[n.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",n[n.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",n[n.ARROW_EAST=133]="ARROW_EAST",n[n.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",n[n.ARROW_NORTH=135]="ARROW_NORTH",n[n.SPEECH=136]="SPEECH",n[n.STARBURST=137]="STARBURST",n[n.TEARDROP=138]="TEARDROP",n[n.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",n[n.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",n[n.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",n[n.CUSTOM=142]="CUSTOM",n))(Hn||{});class ur{constructor(){this._colorType=Tt.UNSUPPORTED,this._themeColors=ao.OFFICE,this._themeTint=0}asRgbColor(){return new hr(this._rgbValue,this)}asThemeColor(){return new Da(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Tt.THEME:return this.asThemeColor();case Tt.RGB:return this.asRgbColor();case Tt.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(e){return this._colorType=Tt.RGB,this._rgbValue=e,this}setThemeColors(e){this._colorType=Tt.THEME,this._themeColors=e}setThemeTint(e){this._colorType=Tt.THEME,this._themeTint=e}setThemeColor(e){return this._colorType=Tt.THEME,this._themeValue=e,this}getColorType(){return this._colorType}}const Vc={[ao.OFFICE]:{[at.ACCENT1]:"#4472C4",[at.ACCENT2]:"#ED7D31",[at.ACCENT3]:"#A5A5A5",[at.ACCENT4]:"#70AD47",[at.ACCENT5]:"#5B9BD5",[at.ACCENT6]:"#70AD47",[at.DARK1]:"#000000",[at.DARK2]:"#44546A",[at.LIGHT1]:"#FFFFFF",[at.LIGHT2]:"#E7E6E6",[at.HYPERLINK]:"#0563C1",[at.FOLLOWED_HYPERLINK]:"#954F72"}};class En{static rgbColorToHexValue(e){return`#${((1<<24)+(e.getRed()<<16)+(e.getGreen()<<8)+e.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(e){e?e.indexOf("#")>-1&&(e=e.substring(1)):e="#000000";let t=+`0x${e[0]}${e[1]}`,s=+`0x${e[2]}${e[3]}`,r=+`0x${e[4]}${e[5]}`;return new ur().setRgbColor(`rgb(${t},${s},${r})`).asRgbColor()}static hexToRgbString(e){const t=/^#?([a-f\d])([a-f\d])([a-f\d])$/i;e=e.replace(t,(o,i,a,c)=>i+i+a+a+c+c);const s=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(e);let r=null;if(s){const o=parseInt(s[1],16),i=parseInt(s[2],16),a=parseInt(s[3],16);r=`rgba(${o},${i},${a})`}return r}constructor(e){this._builder=e}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new En(this._builder)}equals(e){return!1}}class Gc{constructor(e){const t=e.getRed()/255,s=e.getGreen()/255,r=e.getBlue()/255,o=e.getAlpha()/255,i=Math.min(t,Math.min(s,r)),a=Math.max(t,Math.max(s,r)),c=a-i;if(a===i){this._hue=0,this._saturation=0,this._lightness=a;return}this._lightness=(i+a)/2,this._lightness<.5?this._saturation=c/(a+i):this._saturation=c/(2-a-i),t===a&&(this._hue=(s-r)/c),s===a&&(this._hue=2+(r-t)/c),r===a&&(this._hue=4+(t-s)/c),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=o}asRgbColor(){const e=new ur;if(this._saturation===0)return e.setRgbColor(`rgba(${this._lightness*255},${this._lightness*255},${this._lightness*255},${this._alpha*255})`),e.asRgbColor();let t;this._lightness<.5?t=this._lightness*(1+this._saturation):t=this._lightness+this._saturation-this._lightness*this._saturation;const s=2*this._lightness-t,r=this._hue/360,o=r+1/3,i=this.setColor(t,s,o),a=this.setColor(t,s,r),c=r-1/3,l=this.setColor(t,s,c);return e.setRgbColor(`rgba(${Math.round(i*255)},${Math.round(a*255)},${Math.round(l*255)},${this._alpha*255})`),e.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(e,t,s){s<0&&(s+=1),s>1&&(s-=1);let r;return 6*s<1?r=t+(e-t)*6*s:2*s<1?r=e:3*s<2?r=t+(e-t)*(2/3-s)*6:r=t,r}setLightness(e){this._lightness=e}}const Jt=class extends En{constructor(n,e){super(e);let t=n.match(Jt.RGBA_EXTRACT);if(t){const s=+t[1],r=+t[2],o=+t[3],i=+t[4];this._cssString=n,this._red=s,this._green=r,this._blue=o,this._alpha=i;return}if(t=n.match(Jt.RGB_EXTRACT),t){const s=+t[1],r=+t[2],o=+t[3];this._cssString=n,this._red=s,this._green=r,this._blue=o,this._alpha=1;return}throw new Error("Invalid rgba or rgb color")}asHexString(){return En.rgbColorToHexValue(this)}getRed(){let n=this._red+Jt.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getGreen(){let n=this._green+Jt.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getBlue(){let n=this._blue+Jt.RGB_COLOR_AMT;return n>255?n=255:n<0&&(n=0),n}getAlpha(){return this._alpha}getColorType(){return Tt.RGB}clone(){return new Jt(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(n){return n instanceof Jt?n._red===this._red&&n._blue===this._blue&&n._green===this._green&&n._alpha===this._alpha:!1}getCssString(){return this._cssString}};let hr=Jt;hr.RGB_COLOR_AMT=0;hr.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*");hr.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const Mn=class extends En{constructor(n,e,t,s){super(s),this._themeColorType=n,this._themeTint=e,this._themeColors=t}lumValue(n,e){if(n==null)return e;let t;return n<0?t=e*(1+n):t=e*(1-n)+(255-255*(1-n)),t}asRgbColor(){const n=Vc[this._themeColors];if(n==null)throw new Error("not find themeColors type");const e=n.get(this._themeColorType);if(e==null)throw new Error("not find themeColors value");let t;if(Mn._cacheThemeColor.has(this._themeColors)){if(t=Mn._cacheThemeColor.get(this._themeColors),t.has(this._themeColorType))return t.get(this._themeColorType)}else t=new Map,Mn._cacheThemeColor.set(this._themeColors,t);const s=new Gc(En.hexValueToRgbColor(e));s.setLightness(this.lumValue(this._themeTint,s.getLightness()*255)/255);const r=s.asRgbColor();return t.set(this._themeColorType,r),r}clone(){return new Mn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(n){return n instanceof Mn?n._themeColorType===this._themeColorType:!1}getColorType(){return Tt.THEME}getThemeColorType(){return this._themeColorType}};let Da=Mn;Da._cacheThemeColor=new Map;var I=(n=>(n.INSERT_ROW_DATA_ACTION="InsertRowDataAction",n.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",n.INSERT_ROW_ACTION="InsertRowAction",n.REMOVE_ROW_ACTION="RemoveRowAction",n.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",n.SET_RANGE_FORMULA_ACTION="SetRangeFormulaAction",n.SET_RANGE_FORMAT_ACTION="SetRangeFormatAction",n.SET_SELECTION_ACTION="SetSelectionActivateAction",n.SET_RANGE_DATA_ACTION="SetRangeDataAction",n.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",n.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",n.DELETE_RANGE_ACTION="DeleteRangeAction",n.INSERT_SHEET_ACTION="InsertSheetAction",n.REMOVE_SHEET_ACTION="RemoveSheetAction",n.CLEAR_RANGE_ACTION="ClearRangeAction",n.INSERT_RANGE_ACTION="InsertRangeAction",n.SET_TAB_COLOR_ACTION="SetTabColorAction",n.HIDE_SHEET_ACTION="SetWorkSheetHideAction",n.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",n.INSERT_COLUMN_ACTION="InsertColumnAction",n.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",n.REMOVE_COLUMN_ACTION="RemoveColumnAction",n.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",n.SET_HIDE_ROW_ACTION="SetRowHideAction",n.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",n.SET_SHOW_ROW_ACTION="SetRowShowAction",n.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",n.ADD_MERGE_ACTION="AddMergeAction",n.REMOVE_MERGE_ACTION="RemoveMergeAction",n.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",n.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",n.SET_BORDER_ACTION="SetBorderAction",n.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",n.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",n.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",n.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",n.DELETE_BANDING_ACTION="DeleteBandingAction",n.SET_BANDING_ACTION="SetBandingAction",n.ADD_BANDING_ACTION="AddBandingAction",n.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",n.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",n.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",n.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",n.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",n.SET_FROZEN_COLUMNS_ACTION="",n.SET_FROZEN_ROWS_ACTION="",n))(I||{});const $c={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};L.FALSE,It.EN;const yr={type:Ge.GRID,name:"",id:"sheet-01",tabColor:"",hidden:L.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:L.FALSE,showGridlines:L.TRUE,rowTitle:{width:46,hidden:L.FALSE},columnTitle:{height:20,hidden:L.FALSE},selections:["A1"],rightToLeft:L.FALSE,pluginMeta:{}},Ps={ff:"Times New Roman",fs:14,it:L.FALSE,bl:L.FALSE,ul:{s:L.FALSE},st:{s:L.FALSE},ol:{s:L.FALSE},tr:{a:0,v:L.FALSE},td:Ra.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Ye.UNSPECIFIED,vt:Vt.UNSPECIFIED,tb:Bt.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Yc={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}},$o={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var dt=(n=>(n.BASE_COMPONENT="baseComponent",n.BASE_RENDER="renderEngine",n.SPREADSHEET="spreadsheet",n.DOCUMENT="document",n.SLIDE="slide",n))(dt||{});class Xc{constructor(e,t){this._workSheet=e,this._columnData=new Ee(t)}getColumnData(){return this._columnData}getColumnDatas(e,t){const s=new Ee;for(let r=e;r<e+t;r++){const o=this.getColumnOrCreate(r);s.push(o)}return s}getSize(){return this._columnData.getLength()}getColumnWidth(...e){const{_workSheet:t}=this,{_columnData:s}=this,r=t.getConfig();let o=0;if(e.length===1)o=s.obtain(e[0],{hd:L.FALSE,w:r.defaultColumnWidth}).w;else if(e.length===2)for(let i=e[0];i<e[0]+e[1];i++)o+=s.obtain(i,{hd:L.FALSE,w:r.defaultColumnWidth}).w;return o}setColumnWidth(e,t){const s=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),o={sheetId:this._workSheet.getSheetId(),actionName:I.SET_COLUMN_WIDTH_ACTION,columnIndex:e,columnWidth:t},i=new Y({WorkBookUnit:s.getWorkBook()},o);r.invoke(i)}getColumn(e){const t=this._columnData.get(e);if(t)return t}getColumnOrCreate(e){const{_workSheet:t}=this,{_columnData:s}=this,r=t.getConfig(),o=s.get(e);if(o)return o;const i={w:r.defaultColumnWidth,hd:L.FALSE};return this._columnData.set(e,i),i}}function Ia(n,e){let t=[];for(let s=0;s<e.length;s++)n.add(e[s]);return t}function ya(n,e){let t=[];for(let s=0;s<e.length;s++)t=t.concat(n.remove(e[s]));return t}class jc extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,rectangles:this.do()},this.validate()}do(){const e=this.getWorkSheet();return Ia(e.getMerges(),this._doActionData.rectangles)}redo(){this.do()}undo(){const e=this.getWorkSheet();ya(e.getMerges(),this._doActionData.rectangles)}validate(){return!1}}function Aa(n,e){n.push(e)}function Sa(n,e){return n.find((t,s)=>t.namedRangeId===e?(n.splice(s,1),t):null)}class Kc extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={actionName:I.DELETE_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRangeId:e.namedRange.namedRangeId},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),Aa(t,e)}redo(){this.do()}undo(){const{namedRangeId:e,sheetId:t}=this._oldActionData,s=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:I.ADD_NAMED_RANGE_ACTION,sheetId:t,namedRange:Sa(s,e)}}validate(){return!1}}function qc(n,e,t){const{startRow:s,endRow:r,startColumn:o,endColumn:i}=t,a=new ee;for(let c=s;c<=r;c++)for(let l=o;l<=i;l++){const u=n.getValue(c,l);a.setValue(c,l,S.deepClone(u)),u&&(e.formatOnly&&delete u.s,e.contentsOnly&&(u.v="",u.m=""),n.setValue(c,l,S.deepClone(u)))}return a.getData()}function Oa(n,e,t,s){const{startRow:r,endRow:o,startColumn:i,endColumn:a}=s,c=o-r+1,l=a-i+1,u=n.rowCount,h=n.columnCount,d=new ee;if(t===wn.ROWS)for(let f=r;f<=u;f++)for(let g=i;g<=a;g++){if(f<=o){const p=e.getValue(f,g);d.setValue(f,g,p)}const b=e.getValue(f+c,g);b?e.setValue(f,g,S.deepClone(b)):e.getValue(f,g)&&(e.deleteValue(f,g),g--)}else if(t===wn.COLUMNS)for(let f=r;f<=o;f++)for(let g=i;g<=h;g++){if(g<=a){const p=e.getValue(f,g);d.setValue(f,g,p)}else for(let p=0;p<=a;p++){const v=e.getValue(f,g);d.setValue(f,g+p,v)}const b=e.getValue(f,g+l);if(b)e.setValue(f,g,S.deepClone(b));else if(e.getValue(f,g)){for(let v=0;v<=a;v++)e.deleteValue(f,g);break}}return d.getData()}function Yo(n,e){const t=n.getConfig(),s=t.hidden;return t.hidden=e,s}function xa(n=0,e=1,t){new Ee(t).inserts(n,new Ee(e))}function Na(n,e,t){new ee(t).insertColumns(n,new ee(e))}function Ma(n,e,t){new ee(t).insertRows(n,new ee(e))}function ka(n,e,t,s,r){const{startRow:o,endRow:i,startColumn:a,endColumn:c}=s,l=i-o+1,u=c-a+1,h=n.rowCount,d=n.columnCount;if(t===wn.ROWS){for(let f=h;f>=o;f--)for(let g=a;g<=c;g++){const b=e.getValue(f,g);e.setValue(f+l,g,b)}for(let f=i;f>=o;f--)for(let g=a;g<=c;g++)e.setValue(f,g,r[f-o][g-a])}else if(t===wn.COLUMNS){for(let f=o;f<=i;f++)for(let g=d;g>=a;g--){const b=e.getValue(f,g);e.setValue(f,g+u,b)}for(let f=o;f<=i;f++)for(let g=c;g>=a;g--)e.setValue(f,g,r[f-o][g-a])}}function Ba(n=0,e=1,t){new Ee(t).inserts(n,new Ee(e))}function La(n,e,t){const s=n.getWorksheets(),r=n.getConfig(),{sheets:o,sheetOrder:i}=r;if(o[t.id])throw new Error(`Insert Sheet fail ${t.id} is already exist`);return o[t.id]=t,i.splice(e,0,t.id),s.set(t.id,new Un(n.getContext(),t)),t.id}function Fa(n,e,t){const s=new Ee(t),r=new Ee,o=n,i=n+e;for(let a=o;a<i;a++){const c=s.splice(n,1);c.getLength()&&r.set(a,c.first())}return r.getLength()}function Ha(n,e,t){return new ee(t).spliceColumns(n,e).toJSON()}function Pa(n,e,t){const s=new Ee(t),r=new Ee,o=n,i=n+e;for(let a=o;a<i;a++){const c=s.splice(n,1);c.getLength()&&r.set(a,c.first())}return r.getLength()}function za(n,e,t){return new ee(t).spliceRows(n,e).toJSON()}function Ua(n,e){const t=n.getWorksheets(),s=n.getConfig(),{sheets:r}=s;if(r[e]==null)throw new Error(`Remove Sheet fail ${e} is not exist`);const o=r[e],i=s.sheetOrder.findIndex(a=>a===e);return delete r[e],i!==s.sheetOrder.length-1?r[s.sheetOrder[i+1]].status=1:r[s.sheetOrder[i-1]].status=1,s.sheetOrder.splice(i,1),t.delete(e),{index:i,sheet:o}}function Xo(n,e,t){const s=new ee(t),r=new ee;return s.forValue((o,i,a)=>{const c=n.getValue(o,i);if(c){const l=e.get(c.s);l&&r.setValue(o,i,l),c.s=e.setValue(a)}}),r.toJSON()}function Wa(n=0,e,t){for(let s=n;s<n+e;s++){const r=t.getColumnOrCreate(s);r.hd=1}}function Va(n=0,e,t){for(let s=n;s<n+e;s++){const r=t.getColumn(s);r&&(r.hd=0)}}function jo(n=0,e,t){const s=[];for(let r=n;r<n+e.length;r++){const o=t.getColumnOrCreate(r);s[r-n]=o.w,o.w=e[r-n]}return s}function Ko(n,e){const t=n.getConfig(),s=t.showGridlines===0;return e?t.showGridlines=0:t.showGridlines=1,s}function Ga(n=0,e,t){for(let s=n;s<n+e;s++){const r=t.getRowOrCreate(s);r&&(r.hd=1)}}function qo(n,e){return n.find((t,s)=>t.namedRangeId===e.namedRangeId?(n[s]=e,t):null)}function Zo(n,e,t,s){const{startRow:r,endRow:o,startColumn:i,endColumn:a}=t,c=new ee;for(let l=r;l<=o;l++)for(let u=i;u<=a;u++){const h=n.getValue(l,u)||{},d=s.getStyleByCell(h);d==null&&delete h.s;const f=lo(d,e[l-r][u-i]);f&&S.removeNull(f),S.isEmptyObject(f)?delete h.s:h.s=s.setValue(f),h.p&&Qc(h.p,e[l-r][u-i]),n.setValue(l,u,h),c.setValue(l-r,u-i,$a(d,e[l-r][u-i]))}return c.getData()}function $a(n,e){return Zc(n,e)}function Zc(n,e){if(!e||!Object.keys(e).length)return n;const t=S.deepClone(n)||{};for(const s in e)s==="bd"?t[s]=Jc(t[s]||{},e[s]):s in t||(t[s]=null);return t}function Jc(n,e){if(!e||!Object.keys(e).length)return n;for(const t in e)t in n||(n[t]=null);return n}function lo(n,e,t=!1){if(e===null)return e;if(e===void 0)return n;const s=S.deepClone(n)||{};for(const r in e)t&&["bd","tr","td","ht","vt","tb","pd"].includes(r)||(r in s&&r==="bd"?s[r]=Object.assign(s[r],e[r]):(s[r]=e[r],"cl"in s&&["ul","ol","st"].includes(r)&&(s[r].cl=s.cl)));return s}function Qc(n,e){var t;(t=n.body)==null||t.blockElementOrder.forEach(s=>{var r,o;if(((r=n.body)==null?void 0:r.blockElements[s].blockType)===0){const i=(o=n.body)==null?void 0:o.blockElements[s].paragraph;i==null||i.elementOrder.forEach(({elementId:a,paragraphElementType:c})=>{i.elements[a].tr||(i.elements[a].tr={});const l=i.elements[a].tr;l.ts||(l.ts={});const u=l.ts,h=lo(u,e,!0);h&&S.removeNull(h),S.isEmptyObject(h)?delete l.ts:l.ts=h})}})}function $r(n,e,t,s){let r=new ee(e);const o=new ee;return s?(r.forValue((i,a,c)=>{const l=n.getValue(i,a),u={};s.contentsOnly&&(u.m=l==null?void 0:l.m,u.v=l==null?void 0:l.v),s.formatOnly&&(u.v=l==null?void 0:l.v,u.m=l==null?void 0:l.m),o.setValue(i,a,u||{}),n.setValue(i,a,c||{})}),o.getData()):(r.forValue((i,a,c)=>{const l=n.getValue(i,a)||{};if(!c)n.setValue(i,a,c),o.setValue(i,a,l);else{const u=t.getStyleByCell(l),h=$a(u,c==null?void 0:c.s),d=S.deepClone(l);d.s=h,o.setValue(i,a,d),u==null&&delete l.s;const f=lo(u,c==null?void 0:c.s);f&&S.removeNull(f),S.isEmptyObject(f)?delete l.s:l.s=t.setValue(f),c.v!=null&&(l.v=c.v),c.m!=null?l.m=c.m:l.m=String(l.v),c.t!=null&&(l.t=c.t),n.setValue(i,a,l)}}),o.getData())}function Jo(n,e,t){const s=new ee(e),r=new ee;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=s.getValue(o,i);if(a){JSON.parse(a);const c=n.getValue(o,i),l=S.deepClone(c||{});n.setValue(o,i,l||{})}else{const c=n.getValue(o,i),l=S.deepClone(c||{});n.setValue(o,i,l||{})}}return r.getData()}function Qo(n,e,t){const s=new ee(e),r=new ee;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=s.getValue(o,i),c=n.getValue(o,i),l=S.deepClone(c||{});l.f=a,n.setValue(o,i,l||{})}return r.getData()}function ei(n,e,t){const s=new ee(e),r=new ee;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=s.getValue(o,i),c=n.getValue(o,i),l=S.deepClone(c||{});l.n=a,n.setValue(o,i,l||{})}return r.getData()}function ti(n,e,t){const s=new ee(e),r=new ee;for(let o=t.startRow;o<=t.endRow;o++)for(let i=t.startColumn;i<=t.endColumn;i++){const a=s.getValue(o,i),c=n.getValue(o,i);r.setValue(o,i,c&&c.v||"");const l=S.deepClone(c||{});l.v=a,l.m=`${a}`,n.setValue(o,i,l||{})}return r.getData()}function ni(n,e){const t=n.getConfig(),s=t.rightToLeft;return t.rightToLeft=e,s}function si(n=0,e,t){const s=[];for(let r=n;r<n+e.length;r++){const o=t.getRowOrCreate(r);s[r-n]=o.h,o.h=e[r-n]}return s}function ri(n,e,t,s){var c,l,u;const r=n.getSelection(),o=(c=r.getActiveRangeList())==null?void 0:c.getRangeList(),i=(l=r.getActiveRange())==null?void 0:l.getRangeData(),a=(u=r.getCurrentCell())==null?void 0:u.getRangeData();return r.setRanges(e,t,s),{activeRangeList:o,activeRange:i,currentCell:a}}function oi(n,e,t){const s=n.getConfig(),r=s.sheetOrder.findIndex(i=>i===e),o=s.sheetOrder.filter(i=>i!==e);return o.splice(t,0,e),s.sheetOrder=o,r}function Ya(n=0,e,t){for(let s=n;s<n+e;s++){const r=t.getRow(s);r&&(r.hd=0)}}function ii(n,e){const t=n.getConfig(),s=t.tabColor;return t.tabColor=e,s}function ai(n,e){const t=n.getContext().getWorkBook().getActiveSheet();let s="";const r=L.FALSE;t&&(s=t.getSheetId());const o=n.getContext().getWorkBook().getSheets(),i=n.getSheetId();return o.forEach(a=>{a.getSheetId()===i?a.getConfig().status=L.TRUE:a.getConfig().status=L.FALSE}),{oldSheetId:s,status:r}}function li(n,e){const t=n.getConfig(),s=t.name;return t.name=e,s}function ci(n,e){const t=n.getConfig(),s=t.status;return t.status=e,s}function ui(n,e,t){const s=n.getSheetBySheetId(e);if(s){const r=s.getConfig().zoomRatio;return s.getConfig().zoomRatio=t,r}return 1}class eu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=qc(e.getCellMatrix(),this._doActionData.options,this._doActionData.rangeData);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do()}}undo(){const e=this.getWorkSheet(),{cellValue:t}=this._oldActionData,s=this._workbook.getStyles();e&&($r(e.getCellMatrix(),t,s),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class tu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={actionName:I.ADD_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRangeId:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),Sa(t,e)}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:I.ADD_BANDING_ACTION,namedRange:this.do()}}undo(){const{namedRange:e}=this._oldActionData,t=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),Aa(t,e)}validate(){return!1}}class Xa extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Oa({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t,shiftDimension:s}=this._doActionData;this._oldActionData={sheetId:e,actionName:I.INSERT_RANGE_ACTION,shiftDimension:s,rangeData:t,cellValue:this.do()}}undo(){const e=this.getWorkSheet(),{shiftDimension:t,rangeData:s,cellValue:r}=this._oldActionData;e&&(ka({rowCount:e.getConfig().rowCount,columnCount:e.getConfig().columnCount},e.getCellMatrix(),t,s,r),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class ja extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const t=this.getWorkSheet().getColumnManager();xa(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),Fa(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON())}validate(){return!1}}class nu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e,columnCount:Ee.getMaxLength(e.columnData[0])},this.validate()}do(){const e=this.getWorkSheet();Na(this._doActionData.columnIndex,this._doActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ha(this._oldActionData.columnIndex,this._oldActionData.columnCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class su extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();e&&(ka({rowCount:e.getLastRow(),columnCount:e.getLastColumn()},e.getCellMatrix(),this._doActionData.shiftDimension,this._doActionData.rangeData,this._doActionData.cellValue),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:e,sheetId:t,shiftDimension:s}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:I.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:Oa({rowCount:r.getLastRow(),columnCount:r.getLastColumn()},r.getCellMatrix(),s,e),rangeData:e,shiftDimension:s},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Ka extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const t=this.getWorkSheet().getRowManager();Ba(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),Pa(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON())}validate(){return!1}}class ru extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e,rowCount:Ee.getMaxLength(e.rowData[0])},this.validate()}do(){const e=this.getWorkSheet();Ma(this._doActionData.rowIndex,this._doActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();za(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class ou extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,sheetId:this.do()}}do(){const e=this.getWorkBook(),t=La(e,this._doActionData.index,this._doActionData.sheet);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){const e=this.getWorkBook();Ua(e,this._oldActionData.sheetId),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}class qa extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,columnCount:this.do()},this.validate()}do(){const t=this.getWorkSheet().getColumnManager(),s=Fa(this._doActionData.columnIndex,this._doActionData.columnCount,t.getColumnData().toJSON());return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),s}redo(){this.do()}undo(){const t=this.getWorkSheet().getColumnManager();xa(this._oldActionData.columnIndex,this._oldActionData.columnCount,t.getColumnData().toJSON()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class iu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,columnData:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Ha(this._doActionData.columnIndex,this._doActionData.columnCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();Na(this._oldActionData.columnIndex,this._oldActionData.columnData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class au extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,rectangles:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ya(e.getMerges(),this._doActionData.rectangles);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();Ia(e.getMerges(),this._doActionData.rectangles),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Za extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,rowCount:this.do()},this.validate()}do(){const t=this.getWorkSheet().getRowManager(),s=Pa(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowData().toJSON());return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),s}redo(){this.do()}undo(){const t=this.getWorkSheet().getRowManager();Ba(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowData().toJSON()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class lu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,rowData:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=za(this._doActionData.rowIndex,this._doActionData.rowCount,e.getCellMatrix().toJSON());return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet();Ma(this._oldActionData.rowIndex,this._oldActionData.rowData,e.getCellMatrix().toJSON()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class cu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,...this.do()}}do(){return this.redo()}redo(){const e=this.getWorkBook(),t=Ua(e,this._doActionData.sheetId);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}undo(){const e=this.getWorkBook();this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),La(e,this._oldActionData.index,this._oldActionData.sheet)}validate(){throw new Error("Method not implemented.")}}class uu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,styles:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=e.getCellMatrix(),o=e.getContext().getWorkBook().getStyles(),i=Xo(t,o,this._doActionData.styles);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),i}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=e.getCellMatrix(),o=e.getContext().getWorkBook().getStyles();Xo(t,o,this._oldActionData.styles),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class hu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();Wa(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Va(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class du extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();Va(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Wa(this._doActionData.columnIndex,this._doActionData.columnCount,e.getColumnManager()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class fu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,columnWidth:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=jo(this._doActionData.columnIndex,this._doActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=jo(this._oldActionData.columnIndex,this._oldActionData.columnWidth,e.getColumnManager());return this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class gu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,hideGridlines:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Ko(e,this._doActionData.hideGridlines);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();Ko(e,this._oldActionData.hideGridlines),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class mu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={actionName:I.SET_NAMED_RANGE_ACTION,sheetId:e.sheetId,namedRange:this.do()},this.validate()}do(){const{namedRange:e}=this._doActionData,t=this._workbook.getConfig().namedRanges;return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),qo(t,e)}redo(){const{sheetId:e,namedRange:t}=this._doActionData;this._oldActionData={actionName:I.SET_NAMED_RANGE_ACTION,sheetId:e,namedRange:this.do()}}undo(){const{namedRange:e,sheetId:t}=this._oldActionData,s=this._workbook.getConfig().namedRanges;this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:I.SET_NAMED_RANGE_ACTION,sheetId:t,namedRange:qo(s,e)}}validate(){return!1}}class _u extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=this._workbook.getStyles(),s=$r(e.getCellMatrix(),this._doActionData.cellValue,t,this._doActionData.options);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),s}redo(){const{sheetId:e,options:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),options:t}}undo(){const{sheetId:e,cellValue:t,options:s}=this._oldActionData,r=this.getWorkSheet(),o=this._workbook.getStyles();r&&(this._doActionData={actionName:I.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:$r(r.getCellMatrix(),t,o),options:s},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class bu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellFormat:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Jo(e.getCellMatrix(),this._doActionData.cellFormat,this._doActionData.rangeData);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_FORMAT_ACTION,sheetId:e,cellFormat:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormat:s}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:I.SET_RANGE_FORMAT_ACTION,sheetId:t,cellFormat:Jo(r.getCellMatrix(),s,e),rangeData:e},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class pu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellFormula:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Qo(e.getCellMatrix(),this._doActionData.cellFormula,this._doActionData.rangeData);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_FORMULA_ACTION,sheetId:e,cellFormula:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellFormula:s}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:I.SET_RANGE_FORMULA_ACTION,sheetId:t,cellFormula:Qo(r.getCellMatrix(),s,e),rangeData:e},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class vu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellNote:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ei(e.getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_NOTE_ACTION,sheetId:e,cellNote:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellNote:s}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:I.SET_RANGE_NOTE_ACTION,sheetId:t,cellNote:ei(r.getCellMatrix(),s,e),rangeData:e},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Cu extends pe{constructor(e,t,s){super(e,t,s),this._oldActionData={...e,value:this.do()},this.validate()}do(){const{value:e,rangeData:t}=this._doActionData,s=this._workbook.getStyles(),r=this.getWorkSheet().getCellMatrix(),o=Zo(r,e,t,s);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),o}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_STYLE_ACTION,sheetId:e,value:this.do(),rangeData:t}}undo(){const{value:e,rangeData:t,sheetId:s}=this._oldActionData,r=this._workbook.getStyles(),o=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:I.SET_RANGE_STYLE_ACTION,sheetId:s,value:Zo(o,e,t,r),rangeData:t},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class wu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,cellValue:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ti(e.getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e,rangeData:t}=this._doActionData;this._oldActionData={actionName:I.SET_RANGE_DATA_ACTION,sheetId:e,cellValue:this.do(),rangeData:t}}undo(){const{rangeData:e,sheetId:t,cellValue:s}=this._oldActionData,r=this.getWorkSheet();r&&(this._doActionData={actionName:I.SET_RANGE_DATA_ACTION,sheetId:t,cellValue:ti(r.getCellMatrix(),s,e),rangeData:e},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}class Eu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,rightToLeft:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ni(e,this._doActionData.rightToLeft);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;const e=this.getWorkSheet();ni(e,this._oldActionData.rightToLeft),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Tu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,rowHeight:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=si(this._doActionData.rowIndex,this._doActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const e=this.getWorkSheet(),t=si(this._oldActionData.rowIndex,this._oldActionData.rowHeight,e.getRowManager());return this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}class Ru extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();Ga(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ya(this._oldActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Du extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do(),this._oldActionData={...e},this.validate()}do(){const e=this.getWorkSheet();Ya(this._doActionData.rowIndex,this._doActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const e=this.getWorkSheet();Ga(this._oldActionData.rowIndex,this._oldActionData.rowCount,e.getRowManager()),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Iu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e};const{activeRangeList:r,activeRange:o,currentCell:i}=this.do();this._oldActionData={...e,activeRangeList:r,activeRange:o,currentCell:i},this.validate()}do(){const{activeRangeList:e,activeRange:t,currentCell:s}=this._doActionData,r=this.getWorkSheet(),o=ri(r,e,t,s);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),o}redo(){const{sheetId:e}=this._doActionData,{activeRangeList:t,activeRange:s,currentCell:r}=this.do();this._oldActionData={actionName:I.SET_SELECTION_ACTION,sheetId:e,activeRangeList:t,activeRange:s,currentCell:r}}undo(){const{activeRangeList:e,activeRange:t,currentCell:s,sheetId:r}=this._oldActionData,o=this.getWorkSheet(),i=ri(o,e,t,s);this._doActionData={actionName:I.SET_SELECTION_ACTION,sheetId:r,activeRangeList:i.activeRangeList,activeRange:i.activeRange,currentCell:i.currentCell},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ja extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,order:this.do()},this.validate()}do(){const s=this.getWorkSheet().getContext().getWorkBook(),r=oi(s,this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),r}redo(){this.do()}undo(){const s=this.getWorkSheet().getContext().getWorkBook();oi(s,this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class yu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,color:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ii(e,this._doActionData.color);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:I.SET_TAB_COLOR_ACTION,color:this.do()}}undo(){const{color:e,sheetId:t}=this._oldActionData,s=this.getWorkSheet();this._doActionData={actionName:I.SET_TAB_COLOR_ACTION,sheetId:t,color:ii(s,e)},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Au extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e};const{oldSheetId:r,status:o}=this.do();this._oldActionData={...e,sheetId:r,status:o},this.validate(),this.removeOperation(Ea.SERVER_ACTION)}do(){const{sheetId:e,status:t}=this._doActionData,s=this._workbook.getSheetBySheetId(e),r=ai(s);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),r}redo(){const{oldSheetId:e,status:t}=this.do();this._oldActionData={actionName:I.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:e,status:t}}undo(){const{sheetId:e}=this._oldActionData;this._oldActionData.status;const t=this._workbook.getSheetBySheetId(e);if(t){const{oldSheetId:s,status:r}=ai(t);this._doActionData={actionName:I.SET_WORKSHEET_ACTIVATE_ACTION,sheetId:s,status:r},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}}class Su extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,hidden:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=Yo(e,this._doActionData.hidden);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:I.HIDE_SHEET_ACTION,hidden:this.do()}}undo(){const{hidden:e,sheetId:t}=this._oldActionData,s=this.getWorkSheet();this._doActionData={actionName:I.HIDE_SHEET_ACTION,sheetId:t,hidden:Yo(s,e)},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Ou extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,sheetName:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=li(e,this._doActionData.sheetName);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:I.SET_WORKSHEET_NAME_ACTION,sheetName:this.do()}}undo(){const{sheetName:e,sheetId:t}=this._oldActionData,s=this.getWorkSheet();this._doActionData={actionName:I.SET_WORKSHEET_NAME_ACTION,sheetId:t,sheetName:li(s,e)},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class xu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,sheetStatus:this.do()},this.validate()}do(){const e=this.getWorkSheet(),t=ci(e,this._doActionData.sheetStatus);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:e}=this._doActionData;this._oldActionData={sheetId:e,actionName:I.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:e,sheetId:t}=this._oldActionData,s=this.getWorkSheet();this._doActionData={actionName:I.SET_WORKSHEET_STATUS_ACTION,sheetId:t,sheetStatus:ci(s,e)},this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class Nu extends pe{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this._oldActionData={...e,zoom:this.do()},this.validate()}redo(){const e=ui(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this}),e}do(){return this.redo()}undo(){ui(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:j.REDO,data:this._oldActionData,action:this})}validate(){return!1}}class lt{constructor(...e){if(S.hasLength(e,0)){this.startRow=0,this.startColumn=0,this.endRow=0,this.endColumn=0;return}if(S.hasLength(e,1)){const t=e[0];this.startRow=t.startRow,this.startColumn=t.startColumn,this.endRow=t.endRow,this.endColumn=t.endColumn;return}if(S.hasLength(e,4)){const t=e[0],s=e[1],r=e[2],o=e[3];this.startRow=t,this.startColumn=s,this.endRow=r,this.endColumn=o}}intersects(e){const t=this.startRow,s=this.endRow,r=this.startColumn,o=this.endColumn,i=e.startRow,a=e.endRow,c=e.startColumn,l=e.endColumn,u=Math.abs(r+o-c-l),h=Math.abs(r-o)+Math.abs(c-l),d=Math.abs(t+s-i-a),f=Math.abs(t-s)+Math.abs(i-a);return u<=h&&d<=f}union(e){const{startRow:t,startColumn:s,endRow:r,endColumn:o}=this;return new lt(e.startRow<this.startRow?e.startRow:t,e.startColumn<s?e.startColumn:s,e.endRow>r?e.endRow:r,e.endColumn>o?e.endColumn:o)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(e){return this.endRow===e.endRow&&this.endColumn===e.endColumn&&this.startRow===e.startRow&&this.startColumn===e.startColumn}}const kn=class{static checkup(n,...e){if(n.length!==e.length)return!1;const t=n.length;for(let s=0;s<t;s++){const r=n[s],o=e[s];switch(o){case kn.BOOLEAN_TYPE:{if(!S.isBoolean(r))return!1;break}case kn.NUMBER_TYPE:{if(!S.isNumber(r))return!1;break}case kn.STRING_TYPE:{if(!S.isString(r))return!1;break}case kn.FUNCTION_TYPE:{if(!S.isFunction(r))return!1;break}case kn.OBJECT_TYPE:{if(!S.isPlainObject(r))return!1;break}default:{if(!S.isAssignableFrom(r,o))return!1;break}}}return!0}};let Ie=kn;Ie.STRING_TYPE=1;Ie.NUMBER_TYPE=2;Ie.BOOLEAN_TYPE=3;Ie.FUNCTION_TYPE=4;Ie.OBJECT_TYPE=5;class Mu{constructor(e,t){this._worksheet=e,this._rectangleList=t,ce.getCommandInjectorObservers().add(s=>{let r=s.include(Ka),o=s.include(ja),i=s.include(Za),a=s.include(qa),c=s.include(Xa);if(r){const l=r.getDoActionData();if(l.sheetId===this._worksheet.getSheetId()){const u=S.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],f=l.rowCount;l.rowIndex>d.endRow||(l.rowIndex>=d.startRow&&l.rowIndex<=d.endRow||(d.startRow+=f),d.endRow+=f)}this.modifyMerge(this._rectangleList,u)}}if(o){const l=o.getDoActionData();if(l.sheetId===this._worksheet.getSheetId()){const u=S.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],f=l.columnCount;l.columnIndex>d.endColumn||(l.columnIndex>=d.startColumn&&l.columnIndex<=d.endColumn||(d.startColumn+=f),d.endColumn+=f)}this.modifyMerge(this._rectangleList,u)}}if(i){const l=i.getDoActionData();if(l.sheetId===this._worksheet.getSheetId()&&l.sheetId===this._worksheet.getSheetId()){const u=S.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],f=l.rowCount;l.rowIndex>d.endRow||(l.rowIndex>=d.startRow&&l.rowIndex<=d.endRow||(d.startRow-=f),d.endRow-=f)}this.modifyMerge(this._rectangleList,u)}}if(a){const l=a.getDoActionData();if(l.sheetId===this._worksheet.getSheetId()&&l.sheetId===this._worksheet.getSheetId()){const u=S.deepClone(this._rectangleList);for(let h=0;h<u.length;h++){const d=u[h],f=l.columnCount;l.columnIndex>d.endColumn||(l.columnIndex>=d.startColumn&&l.columnIndex<=d.endColumn||(d.startColumn-=f),d.endColumn-=f)}this.modifyMerge(this._rectangleList,u)}}if(c){const l=c.getDoActionData();if(l.sheetId===this._worksheet.getSheetId()){const u=S.deepClone(this._rectangleList),h=this.getByRowColumn(l.rangeData.startRow,l.rangeData.endRow,l.rangeData.startColumn,l.rangeData.endColumn);if(h&&h.forEach(d=>{const f=new lt(d);for(let g=0;g<u.length;g++){const b=u[g];f.intersects(new lt(b))&&u.splice(g,1)}}),l.shiftDimension)for(let d=0;d<u.length;d++){const f=u[d];if(f.endRow>=l.rangeData.startRow){if(f.endColumn<l.rangeData.startColumn)continue;if(f.startColumn>l.rangeData.endColumn)continue;if(f.startColumn>=l.rangeData.startColumn&&f.endColumn<=l.rangeData.endColumn){const g=l.rangeData.endRow-l.rangeData.startRow;f.startRow-=g,f.endRow-=g}else return}}else for(let d=0;d<u.length;d++){const f=u[d];if(f.startColumn>l.rangeData.endColumn){if(f.endRow<l.rangeData.startRow)continue;if(f.startRow>l.rangeData.endRow)continue;if(f.startRow>=l.rangeData.startRow&&f.endRow<=l.rangeData.endRow){const g=l.rangeData.endColumn-l.rangeData.startColumn;f.startColumn-=g,f.endColumn-=g}else return}}this.modifyMerge(this._rectangleList,u)}}})}getMergeData(){return this._rectangleList}getByRowColumn(...e){const{_rectangleList:t}=this;let s;Ie.checkup(e,Ie.NUMBER_TYPE,Ie.NUMBER_TYPE,Ie.NUMBER_TYPE,Ie.NUMBER_TYPE)?s=new lt(e[0],e[2],e[1],e[3]):Ie.checkup(e,Ie.NUMBER_TYPE,Ie.NUMBER_TYPE)&&(s=new lt(e[0],e[1],e[0],e[1]));const r=[];for(let o=0;o<t.length;o++){const i=t[o];s.intersects(new lt(i))&&r.push(i)}return r.length?r:null}remove(e){const{_rectangleList:t}=this,{length:s}=t,r=new lt(e),o=[],i=[];for(let a=0;a<s;a++){const c=t[a];if(r.intersects(new lt(c))){i.push(c);continue}o.push(c)}return this._rectangleList=o,i}size(){return this._rectangleList.length}add(e){const t=this.remove(e);return this._rectangleList.push(e),t}union(e){const{_rectangleList:t}=this,{length:s}=t;let r=new lt(e);for(let o=0;o<s;o++){const i=t[o];r=r.union(new lt(i))}return r.getData()}getMergedRanges(e){const{_rectangleList:t}=this,{length:s}=t,r=[];for(let o=0;o<s;o++){const i=t[o];new lt(e).intersects(new lt(i))&&r.push(i)}return r}modifyMerge(e,t){const s=this._worksheet.getCommandManager(),r=this._worksheet.getContext(),o={actionName:I.REMOVE_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:e},i={actionName:I.ADD_MERGE_ACTION,sheetId:this._worksheet.getSheetId(),rectangles:t},a=new Y({WorkBookUnit:r.getWorkBook()},o,i);s.invoke(a)}}var tr=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:typeof global!="undefined"?global:typeof self!="undefined"?self:{},Qa={exports:{}};(function(n,e){(function(t,s){n.exports=s()})(tr,function(){var t=1e3,s=6e4,r=36e5,o="millisecond",i="second",a="minute",c="hour",l="day",u="week",h="month",d="quarter",f="year",g="date",b="Invalid Date",p=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,v=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,C={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(T){var y=["th","st","nd","rd"],O=T%100;return"["+T+(y[(O-20)%10]||y[O]||y[0])+"]"}},w=function(T,y,O){var U=String(T);return!U||U.length>=y?T:""+Array(y+1-U.length).join(O)+T},x={s:w,z:function(T){var y=-T.utcOffset(),O=Math.abs(y),U=Math.floor(O/60),B=O%60;return(y<=0?"+":"-")+w(U,2,"0")+":"+w(B,2,"0")},m:function T(y,O){if(y.date()<O.date())return-T(O,y);var U=12*(O.year()-y.year())+(O.month()-y.month()),B=y.clone().add(U,h),X=O-B<0,J=y.clone().add(U+(X?-1:1),h);return+(-(U+(O-B)/(X?B-J:J-B))||0)},a:function(T){return T<0?Math.ceil(T)||0:Math.floor(T)},p:function(T){return{M:h,y:f,w:u,d:l,D:g,h:c,m:a,s:i,ms:o,Q:d}[T]||String(T||"").toLowerCase().replace(/s$/,"")},u:function(T){return T===void 0}},A="en",z={};z[A]=C;var R=function(T){return T instanceof P},E=function T(y,O,U){var B;if(!y)return A;if(typeof y=="string"){var X=y.toLowerCase();z[X]&&(B=X),O&&(z[X]=O,B=X);var J=y.split("-");if(!B&&J.length>1)return T(J[0])}else{var $=y.name;z[$]=y,B=$}return!U&&B&&(A=B),B||!U&&A},D=function(T,y){if(R(T))return T.clone();var O=typeof y=="object"?y:{};return O.date=T,O.args=arguments,new P(O)},M=x;M.l=E,M.i=R,M.w=function(T,y){return D(T,{locale:y.$L,utc:y.$u,x:y.$x,$offset:y.$offset})};var P=function(){function T(O){this.$L=E(O.locale,null,!0),this.parse(O)}var y=T.prototype;return y.parse=function(O){this.$d=function(U){var B=U.date,X=U.utc;if(B===null)return new Date(NaN);if(M.u(B))return new Date;if(B instanceof Date)return new Date(B);if(typeof B=="string"&&!/Z$/i.test(B)){var J=B.match(p);if(J){var $=J[2]-1||0,te=(J[7]||"0").substring(0,3);return X?new Date(Date.UTC(J[1],$,J[3]||1,J[4]||0,J[5]||0,J[6]||0,te)):new Date(J[1],$,J[3]||1,J[4]||0,J[5]||0,J[6]||0,te)}}return new Date(B)}(O),this.$x=O.x||{},this.init()},y.init=function(){var O=this.$d;this.$y=O.getFullYear(),this.$M=O.getMonth(),this.$D=O.getDate(),this.$W=O.getDay(),this.$H=O.getHours(),this.$m=O.getMinutes(),this.$s=O.getSeconds(),this.$ms=O.getMilliseconds()},y.$utils=function(){return M},y.isValid=function(){return this.$d.toString()!==b},y.isSame=function(O,U){var B=D(O);return this.startOf(U)<=B&&B<=this.endOf(U)},y.isAfter=function(O,U){return D(O)<this.startOf(U)},y.isBefore=function(O,U){return this.endOf(U)<D(O)},y.$g=function(O,U,B){return M.u(O)?this[U]:this.set(B,O)},y.unix=function(){return Math.floor(this.valueOf()/1e3)},y.valueOf=function(){return this.$d.getTime()},y.startOf=function(O,U){var B=this,X=!!M.u(U)||U,J=M.p(O),$=function(Re,ue){var be=M.w(B.$u?Date.UTC(B.$y,ue,Re):new Date(B.$y,ue,Re),B);return X?be:be.endOf(l)},te=function(Re,ue){return M.w(B.toDate()[Re].apply(B.toDate("s"),(X?[0,0,0,0]:[23,59,59,999]).slice(ue)),B)},re=this.$W,Te=this.$M,_e=this.$D,Z="set"+(this.$u?"UTC":"");switch(J){case f:return X?$(1,0):$(31,11);case h:return X?$(1,Te):$(0,Te+1);case u:var ne=this.$locale().weekStart||0,oe=(re<ne?re+7:re)-ne;return $(X?_e-oe:_e+(6-oe),Te);case l:case g:return te(Z+"Hours",0);case c:return te(Z+"Minutes",1);case a:return te(Z+"Seconds",2);case i:return te(Z+"Milliseconds",3);default:return this.clone()}},y.endOf=function(O){return this.startOf(O,!1)},y.$set=function(O,U){var B,X=M.p(O),J="set"+(this.$u?"UTC":""),$=(B={},B[l]=J+"Date",B[g]=J+"Date",B[h]=J+"Month",B[f]=J+"FullYear",B[c]=J+"Hours",B[a]=J+"Minutes",B[i]=J+"Seconds",B[o]=J+"Milliseconds",B)[X],te=X===l?this.$D+(U-this.$W):U;if(X===h||X===f){var re=this.clone().set(g,1);re.$d[$](te),re.init(),this.$d=re.set(g,Math.min(this.$D,re.daysInMonth())).$d}else $&&this.$d[$](te);return this.init(),this},y.set=function(O,U){return this.clone().$set(O,U)},y.get=function(O){return this[M.p(O)]()},y.add=function(O,U){var B,X=this;O=Number(O);var J=M.p(U),$=function(Te){var _e=D(X);return M.w(_e.date(_e.date()+Math.round(Te*O)),X)};if(J===h)return this.set(h,this.$M+O);if(J===f)return this.set(f,this.$y+O);if(J===l)return $(1);if(J===u)return $(7);var te=(B={},B[a]=s,B[c]=r,B[i]=t,B)[J]||1,re=this.$d.getTime()+O*te;return M.w(re,this)},y.subtract=function(O,U){return this.add(-1*O,U)},y.format=function(O){var U=this,B=this.$locale();if(!this.isValid())return B.invalidDate||b;var X=O||"YYYY-MM-DDTHH:mm:ssZ",J=M.z(this),$=this.$H,te=this.$m,re=this.$M,Te=B.weekdays,_e=B.months,Z=function(ue,be,Ae,Ne){return ue&&(ue[be]||ue(U,X))||Ae[be].slice(0,Ne)},ne=function(ue){return M.s($%12||12,ue,"0")},oe=B.meridiem||function(ue,be,Ae){var Ne=ue<12?"AM":"PM";return Ae?Ne.toLowerCase():Ne},Re={YY:String(this.$y).slice(-2),YYYY:this.$y,M:re+1,MM:M.s(re+1,2,"0"),MMM:Z(B.monthsShort,re,_e,3),MMMM:Z(_e,re),D:this.$D,DD:M.s(this.$D,2,"0"),d:String(this.$W),dd:Z(B.weekdaysMin,this.$W,Te,2),ddd:Z(B.weekdaysShort,this.$W,Te,3),dddd:Te[this.$W],H:String($),HH:M.s($,2,"0"),h:ne(1),hh:ne(2),a:oe($,te,!0),A:oe($,te,!1),m:String(te),mm:M.s(te,2,"0"),s:String(this.$s),ss:M.s(this.$s,2,"0"),SSS:M.s(this.$ms,3,"0"),Z:J};return X.replace(v,function(ue,be){return be||Re[ue]||J.replace(":","")})},y.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},y.diff=function(O,U,B){var X,J=M.p(U),$=D(O),te=($.utcOffset()-this.utcOffset())*s,re=this-$,Te=M.m(this,$);return Te=(X={},X[f]=Te/12,X[h]=Te,X[d]=Te/3,X[u]=(re-te)/6048e5,X[l]=(re-te)/864e5,X[c]=re/r,X[a]=re/s,X[i]=re/t,X)[J]||re,B?Te:M.a(Te)},y.daysInMonth=function(){return this.endOf(h).$D},y.$locale=function(){return z[this.$L]},y.locale=function(O,U){if(!O)return this.$L;var B=this.clone(),X=E(O,U,!0);return X&&(B.$L=X),B},y.clone=function(){return M.w(this.$d,this)},y.toDate=function(){return new Date(this.valueOf())},y.toJSON=function(){return this.isValid()?this.toISOString():null},y.toISOString=function(){return this.$d.toISOString()},y.toString=function(){return this.$d.toUTCString()},T}(),G=P.prototype;return D.prototype=G,[["$ms",o],["$s",i],["$m",a],["$H",c],["$W",l],["$M",h],["$y",f],["$D",g]].forEach(function(T){G[T[1]]=function(y){return this.$g(y,T[0],T[1])}}),D.extend=function(T,y){return T.$i||(T(y,P,D),T.$i=!0),D},D.locale=E,D.isDayjs=R,D.unix=function(T){return D(1e3*T)},D.en=z[A],D.Ls=z,D.p={},D})})(Qa);var W=Qa.exports,el={exports:{}};/*! @preserve
 * numeral.js
 * version : 2.0.6
 * author : Adam Draper
 * license : MIT
 * http://adamwdraper.github.com/Numeral-js/
 */(function(n){(function(e,t){n.exports?n.exports=t():e.numeral=t()})(tr,function(){var e,t,s="2.0.6",r={},o={},i={currentLocale:"en",zeroFormat:null,nullFormat:null,defaultFormat:"0,0",scalePercentBy100:!0},a={currentLocale:i.currentLocale,zeroFormat:i.zeroFormat,nullFormat:i.nullFormat,defaultFormat:i.defaultFormat,scalePercentBy100:i.scalePercentBy100};function c(l,u){this._input=l,this._value=u}return e=function(l){var u,h,d,f;if(e.isNumeral(l))u=l.value();else if(l===0||typeof l=="undefined")u=0;else if(l===null||t.isNaN(l))u=null;else if(typeof l=="string")if(a.zeroFormat&&l===a.zeroFormat)u=0;else if(a.nullFormat&&l===a.nullFormat||!l.replace(/[^0-9]+/g,"").length)u=null;else{for(h in r)if(f=typeof r[h].regexps.unformat=="function"?r[h].regexps.unformat():r[h].regexps.unformat,f&&l.match(f)){d=r[h].unformat;break}d=d||e._.stringToNumber,u=d(l)}else u=Number(l)||null;return new c(l,u)},e.version=s,e.isNumeral=function(l){return l instanceof c},e._=t={numberToFormat:function(l,u,h){var d=o[e.options.currentLocale],f=!1,g=!1,b=0,p="",v=1e12,C=1e9,w=1e6,x=1e3,A="",z=!1,R,E,D,M,P,G,T;if(l=l||0,E=Math.abs(l),e._.includes(u,"(")?(f=!0,u=u.replace(/[\(|\)]/g,"")):(e._.includes(u,"+")||e._.includes(u,"-"))&&(P=e._.includes(u,"+")?u.indexOf("+"):l<0?u.indexOf("-"):-1,u=u.replace(/[\+|\-]/g,"")),e._.includes(u,"a")&&(R=u.match(/a(k|m|b|t)?/),R=R?R[1]:!1,e._.includes(u," a")&&(p=" "),u=u.replace(new RegExp(p+"a[kmbt]?"),""),E>=v&&!R||R==="t"?(p+=d.abbreviations.trillion,l=l/v):E<v&&E>=C&&!R||R==="b"?(p+=d.abbreviations.billion,l=l/C):E<C&&E>=w&&!R||R==="m"?(p+=d.abbreviations.million,l=l/w):(E<w&&E>=x&&!R||R==="k")&&(p+=d.abbreviations.thousand,l=l/x)),e._.includes(u,"[.]")&&(g=!0,u=u.replace("[.]",".")),D=l.toString().split(".")[0],M=u.split(".")[1],G=u.indexOf(","),b=(u.split(".")[0].split(",")[0].match(/0/g)||[]).length,M?(e._.includes(M,"[")?(M=M.replace("]",""),M=M.split("["),A=e._.toFixed(l,M[0].length+M[1].length,h,M[1].length)):A=e._.toFixed(l,M.length,h),D=A.split(".")[0],e._.includes(A,".")?A=d.delimiters.decimal+A.split(".")[1]:A="",g&&Number(A.slice(1))===0&&(A="")):D=e._.toFixed(l,0,h),p&&!R&&Number(D)>=1e3&&p!==d.abbreviations.trillion)switch(D=String(Number(D)/1e3),p){case d.abbreviations.thousand:p=d.abbreviations.million;break;case d.abbreviations.million:p=d.abbreviations.billion;break;case d.abbreviations.billion:p=d.abbreviations.trillion;break}if(e._.includes(D,"-")&&(D=D.slice(1),z=!0),D.length<b)for(var y=b-D.length;y>0;y--)D="0"+D;return G>-1&&(D=D.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+d.delimiters.thousands)),u.indexOf(".")===0&&(D=""),T=D+A+(p||""),f?T=(f&&z?"(":"")+T+(f&&z?")":""):P>=0?T=P===0?(z?"-":"+")+T:T+(z?"-":"+"):z&&(T="-"+T),T},stringToNumber:function(l){var u=o[a.currentLocale],h=l,d={thousand:3,million:6,billion:9,trillion:12},f,g,b;if(a.zeroFormat&&l===a.zeroFormat)g=0;else if(a.nullFormat&&l===a.nullFormat||!l.replace(/[^0-9]+/g,"").length)g=null;else{g=1,u.delimiters.decimal!=="."&&(l=l.replace(/\./g,"").replace(u.delimiters.decimal,"."));for(f in d)if(b=new RegExp("[^a-zA-Z]"+u.abbreviations[f]+"(?:\\)|(\\"+u.currency.symbol+")?(?:\\))?)?$"),h.match(b)){g*=Math.pow(10,d[f]);break}g*=(l.split("-").length+Math.min(l.split("(").length-1,l.split(")").length-1))%2?1:-1,l=l.replace(/[^0-9\.]+/g,""),g*=Number(l)}return g},isNaN:function(l){return typeof l=="number"&&isNaN(l)},includes:function(l,u){return l.indexOf(u)!==-1},insert:function(l,u,h){return l.slice(0,h)+u+l.slice(h)},reduce:function(l,u){if(this===null)throw new TypeError("Array.prototype.reduce called on null or undefined");if(typeof u!="function")throw new TypeError(u+" is not a function");var h=Object(l),d=h.length>>>0,f=0,g;if(arguments.length===3)g=arguments[2];else{for(;f<d&&!(f in h);)f++;if(f>=d)throw new TypeError("Reduce of empty array with no initial value");g=h[f++]}for(;f<d;f++)f in h&&(g=u(g,h[f],f,h));return g},multiplier:function(l){var u=l.toString().split(".");return u.length<2?1:Math.pow(10,u[1].length)},correctionFactor:function(){var l=Array.prototype.slice.call(arguments);return l.reduce(function(u,h){var d=t.multiplier(h);return u>d?u:d},1)},toFixed:function(l,u,h,d){var f=l.toString().split("."),g=u-(d||0),b,p,v,C;return f.length===2?b=Math.min(Math.max(f[1].length,g),u):b=g,v=Math.pow(10,b),C=(h(l+"e+"+b)/v).toFixed(b),d>u-b&&(p=new RegExp("\\.?0{1,"+(d-(u-b))+"}$"),C=C.replace(p,"")),C}},e.options=a,e.formats=r,e.locales=o,e.locale=function(l){return l&&(a.currentLocale=l.toLowerCase()),a.currentLocale},e.localeData=function(l){if(!l)return o[a.currentLocale];if(l=l.toLowerCase(),!o[l])throw new Error("Unknown locale : "+l);return o[l]},e.reset=function(){for(var l in i)a[l]=i[l]},e.zeroFormat=function(l){a.zeroFormat=typeof l=="string"?l:null},e.nullFormat=function(l){a.nullFormat=typeof l=="string"?l:null},e.defaultFormat=function(l){a.defaultFormat=typeof l=="string"?l:"0.0"},e.register=function(l,u,h){if(u=u.toLowerCase(),this[l+"s"][u])throw new TypeError(u+" "+l+" already registered.");return this[l+"s"][u]=h,h},e.validate=function(l,u){var h,d,f,g,b,p,v,C;if(typeof l!="string"&&(l+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",l)),l=l.trim(),l.match(/^\d+$/))return!0;if(l==="")return!1;try{v=e.localeData(u)}catch{v=e.localeData(e.locale())}return f=v.currency.symbol,b=v.abbreviations,h=v.delimiters.decimal,v.delimiters.thousands==="."?d="\\.":d=v.delimiters.thousands,C=l.match(/^[^\d]+/),C!==null&&(l=l.substr(1),C[0]!==f)||(C=l.match(/[^\d]+$/),C!==null&&(l=l.slice(0,-1),C[0]!==b.thousand&&C[0]!==b.million&&C[0]!==b.billion&&C[0]!==b.trillion))?!1:(p=new RegExp(d+"{2}"),l.match(/[^\d.,]/g)?!1:(g=l.split(h),g.length>2?!1:g.length<2?!!g[0].match(/^\d+.*\d$/)&&!g[0].match(p):g[0].length===1?!!g[0].match(/^\d+$/)&&!g[0].match(p)&&!!g[1].match(/^\d+$/):!!g[0].match(/^\d+.*\d$/)&&!g[0].match(p)&&!!g[1].match(/^\d+$/)))},e.fn=c.prototype={clone:function(){return e(this)},format:function(l,u){var h=this._value,d=l||a.defaultFormat,f,g,b;if(u=u||Math.round,h===0&&a.zeroFormat!==null)g=a.zeroFormat;else if(h===null&&a.nullFormat!==null)g=a.nullFormat;else{for(f in r)if(d.match(r[f].regexps.format)){b=r[f].format;break}b=b||e._.numberToFormat,g=b(h,d,u)}return g},value:function(){return this._value},input:function(){return this._input},set:function(l){return this._value=Number(l),this},add:function(l){var u=t.correctionFactor.call(null,this._value,l);function h(d,f,g,b){return d+Math.round(u*f)}return this._value=t.reduce([this._value,l],h,0)/u,this},subtract:function(l){var u=t.correctionFactor.call(null,this._value,l);function h(d,f,g,b){return d-Math.round(u*f)}return this._value=t.reduce([l],h,Math.round(this._value*u))/u,this},multiply:function(l){function u(h,d,f,g){var b=t.correctionFactor(h,d);return Math.round(h*b)*Math.round(d*b)/Math.round(b*b)}return this._value=t.reduce([this._value,l],u,1),this},divide:function(l){function u(h,d,f,g){var b=t.correctionFactor(h,d);return Math.round(h*b)/Math.round(d*b)}return this._value=t.reduce([this._value,l],u),this},difference:function(l){return Math.abs(e(this._value).subtract(l).value())}},e.register("locale","en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(l){var u=l%10;return~~(l%100/10)===1?"th":u===1?"st":u===2?"nd":u===3?"rd":"th"},currency:{symbol:"$"}}),function(){e.register("format","bps",{regexps:{format:/(BPS)/,unformat:/(BPS)/},format:function(l,u,h){var d=e._.includes(u," BPS")?" ":"",f;return l=l*1e4,u=u.replace(/\s?BPS/,""),f=e._.numberToFormat(l,u,h),e._.includes(f,")")?(f=f.split(""),f.splice(-1,0,d+"BPS"),f=f.join("")):f=f+d+"BPS",f},unformat:function(l){return+(e._.stringToNumber(l)*1e-4).toFixed(15)}})}(),function(){var l={base:1e3,suffixes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]},u={base:1024,suffixes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},h=l.suffixes.concat(u.suffixes.filter(function(f){return l.suffixes.indexOf(f)<0})),d=h.join("|");d="("+d.replace("B","B(?!PS)")+")",e.register("format","bytes",{regexps:{format:/([0\s]i?b)/,unformat:new RegExp(d)},format:function(f,g,b){var p,v=e._.includes(g,"ib")?u:l,C=e._.includes(g," b")||e._.includes(g," ib")?" ":"",w,x,A;for(g=g.replace(/\s?i?b/,""),w=0;w<=v.suffixes.length;w++)if(x=Math.pow(v.base,w),A=Math.pow(v.base,w+1),f===null||f===0||f>=x&&f<A){C+=v.suffixes[w],x>0&&(f=f/x);break}return p=e._.numberToFormat(f,g,b),p+C},unformat:function(f){var g=e._.stringToNumber(f),b,p;if(g){for(b=l.suffixes.length-1;b>=0;b--){if(e._.includes(f,l.suffixes[b])){p=Math.pow(l.base,b);break}if(e._.includes(f,u.suffixes[b])){p=Math.pow(u.base,b);break}}g*=p||1}return g}})}(),function(){e.register("format","currency",{regexps:{format:/(\$)/},format:function(l,u,h){var d=e.locales[e.options.currentLocale],f={before:u.match(/^([\+|\-|\(|\s|\$]*)/)[0],after:u.match(/([\+|\-|\)|\s|\$]*)$/)[0]},g,b,p;for(u=u.replace(/\s?\$\s?/,""),g=e._.numberToFormat(l,u,h),l>=0?(f.before=f.before.replace(/[\-\(]/,""),f.after=f.after.replace(/[\-\)]/,"")):l<0&&!e._.includes(f.before,"-")&&!e._.includes(f.before,"(")&&(f.before="-"+f.before),p=0;p<f.before.length;p++)switch(b=f.before[p],b){case"$":g=e._.insert(g,d.currency.symbol,p);break;case" ":g=e._.insert(g," ",p+d.currency.symbol.length-1);break}for(p=f.after.length-1;p>=0;p--)switch(b=f.after[p],b){case"$":g=p===f.after.length-1?g+d.currency.symbol:e._.insert(g,d.currency.symbol,-(f.after.length-(1+p)));break;case" ":g=p===f.after.length-1?g+" ":e._.insert(g," ",-(f.after.length-(1+p)+d.currency.symbol.length-1));break}return g}})}(),function(){e.register("format","exponential",{regexps:{format:/(e\+|e-)/,unformat:/(e\+|e-)/},format:function(l,u,h){var d,f=typeof l=="number"&&!e._.isNaN(l)?l.toExponential():"0e+0",g=f.split("e");return u=u.replace(/e[\+|\-]{1}0/,""),d=e._.numberToFormat(Number(g[0]),u,h),d+"e"+g[1]},unformat:function(l){var u=e._.includes(l,"e+")?l.split("e+"):l.split("e-"),h=Number(u[0]),d=Number(u[1]);d=e._.includes(l,"e-")?d*=-1:d;function f(g,b,p,v){var C=e._.correctionFactor(g,b),w=g*C*(b*C)/(C*C);return w}return e._.reduce([h,Math.pow(10,d)],f,1)}})}(),function(){e.register("format","ordinal",{regexps:{format:/(o)/},format:function(l,u,h){var d=e.locales[e.options.currentLocale],f,g=e._.includes(u," o")?" ":"";return u=u.replace(/\s?o/,""),g+=d.ordinal(l),f=e._.numberToFormat(l,u,h),f+g}})}(),function(){e.register("format","percentage",{regexps:{format:/(%)/,unformat:/(%)/},format:function(l,u,h){var d=e._.includes(u," %")?" ":"",f;return e.options.scalePercentBy100&&(l=l*100),u=u.replace(/\s?\%/,""),f=e._.numberToFormat(l,u,h),e._.includes(f,")")?(f=f.split(""),f.splice(-1,0,d+"%"),f=f.join("")):f=f+d+"%",f},unformat:function(l){var u=e._.stringToNumber(l);return e.options.scalePercentBy100?u*.01:u}})}(),function(){e.register("format","time",{regexps:{format:/(:)/,unformat:/(:)/},format:function(l,u,h){var d=Math.floor(l/60/60),f=Math.floor((l-d*60*60)/60),g=Math.round(l-d*60*60-f*60);return d+":"+(f<10?"0"+f:f)+":"+(g<10?"0"+g:g)},unformat:function(l){var u=l.split(":"),h=0;return u.length===3?(h=h+Number(u[0])*60*60,h=h+Number(u[1])*60,h=h+Number(u[2])):u.length===2&&(h=h+Number(u[0])*60,h=h+Number(u[1])),Number(h)}})}(),e})})(el);var un=el.exports;const hi={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function ku(n){let e=!1;for(const t in hi)if(n===hi[t]){e=!0;break}return e}function In(n){return n===null||n.toString().replace(/\s/g,"")===""||typeof n=="boolean"?!1:!Number.isNaN(n)}function Bu(n){if(n===null||n.toString().length<5)return!1;if(e(n))return!0;return!1;function e(t){const s=/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/,r=/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/;if(!s.test(t)&&!r.test(t))return!1;const o=RegExp.$1,i=RegExp.$2,a=RegExp.$3;return!(o<1900||i>12||a>31||i===2&&(new Date(o,1,29).getDate()===29&&a>29||new Date(o,1,29).getDate()!==29&&a>28))}}let nr=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(nr.getFullYear())&&(nr=new Date("2/19/17"));const Lu=nr.getFullYear()===2017;function Fu(n,e){const t=new Date(n);if(Lu)return e>0?t.setTime(t.getTime()+t.getTimezoneOffset()*60*1e3):e<0&&t.setTime(t.getTime()-t.getTimezoneOffset()*60*1e3),t;if(n instanceof Date)return n;if(nr.getFullYear()===1917&&!Number.isNaN(t.getFullYear())){const o=t.getFullYear();return n.indexOf(`${o}`)>-1||t.setFullYear(t.getFullYear()+100),t}const s=n.match(/\d+/g)||["2017","2","19","0","0","0"];let r=new Date(+s[0],+s[1]-1,+s[2],+s[3]||0,+s[4]||0,+s[5]||0);return n.indexOf("Z")>-1&&(r=new Date(r.getTime()-r.getTimezoneOffset()*60*1e3)),r}const Hu=new Date(1900,2,1,0,0,0);function Pu(n,e){let t=Date.UTC(n.getFullYear(),n.getMonth(),n.getDate(),n.getHours(),n.getMinutes(),n.getSeconds());const s=Date.UTC(1899,11,31,0,0,0);return e?t-=1461*24*60*60*1e3:n>=Hu&&(t+=24*60*60*1e3),(t-s)/(24*60*60*1e3)}function tt(n){let e=null,t={},s=n;if(n===null)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(n)){e=n,s=Number(n.split(".")[0].replace(",",""));let r="#,##0";if(n.split(".")[1]){r="#,##0.";for(let o=0;o<n.split(".")[1].length;o++)r+=0}t={fa:r,t:"n"}}else if(n.toString().substr(0,1)==="'")e=n.toString().substr(1),t={fa:"@",t:"s"};else if(n.toString().toUpperCase()==="TRUE")e="TRUE",t={fa:"General",t:"b"},s=!0;else if(n.toString().toUpperCase()==="FALSE")e="FALSE",t={fa:"General",t:"b"},s=!1;else if(ku(n))e=n.toString(),t={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(n))e=n.toString(),t={fa:"@",t:"s"};else if(In(n)&&Math.abs(parseFloat(n))>0&&(Math.abs(parseFloat(n))>=1e11||Math.abs(parseFloat(n))<1e-9)){s=un(n).value();const r=s.toExponential();if(r.indexOf(".")>-1){let o=r.split(".")[1].split("e")[0].length;o>5&&(o=5),t={fa:`#0.${new Array(o+1).join("0")}E+00`,t:"n"}}else t={fa:"#0.E+00",t:"n"};e=jt.format(t.fa,s)}else if(n.toString().indexOf("%")>-1){const r=n.toString().indexOf("%");let o=n.toString().substr(0,r);const i=o.replace(/,/g,"");if(r===n.toString().length-1&&In(i))if(o.indexOf(".")>-1)if(o.indexOf(".")===o.lastIndexOf(".")){const a=o.split(".")[0];let l=o.split(".")[1].length;if(l>9&&(l=9),a.indexOf(",")>-1){let u=!0,h=a.split(",");for(let d=1;d<h.length;d++)if(h[d].length<3){u=!1;break}u?(t={fa:`#,##0.${new Array(l+1).join("0")}%`,t:"n"},s=un(n).value(),e=jt.format(t.fa,s)):(e=n.toString(),t={fa:"@",t:"s"})}else t={fa:`0.${new Array(l+1).join("0")}%`,t:"n"},s=un(n).value(),e=jt.format(t.fa,s)}else e=n.toString(),t={fa:"@",t:"s"};else if(o.indexOf(",")>-1){let a=!0,c=o.split(",");for(let l=1;l<c.length;l++)if(c[l].length<3){a=!1;break}a?(t={fa:"#,##0%",t:"n"},s=un(n).value(),e=jt.format(t.fa,s)):(e=n.toString(),t={fa:"@",t:"s"})}else t={fa:"0%",t:"n"},s=un(n).value(),e=jt.format(t.fa,s);else e=n.toString(),t={fa:"@",t:"s"}}else if(n.toString().indexOf(".")>-1)if(n.toString().indexOf(".")===n.toString().lastIndexOf(".")){const r=n.toString().split(".")[0];let o=n.toString().split(".")[1],i=o.length;if(i>9&&(i=9),r.indexOf(",")>-1){let a=!0,c=r.split(",");for(let l=1;l<c.length;l++)if(!In(c[l])||c[l].length<3){a=!1;break}a?(t={fa:`#,##0.${new Array(i+1).join("0")}`,t:"n"},s=un(n).value(),e=jt.format(t.fa,s)):(e=n.toString(),t={fa:"@",t:"s"})}else In(r)&&In(o)?(t={fa:`0.${new Array(i+1).join("0")}`,t:"n"},s=un(n).value(),e=jt.format(t.fa,s)):(e=n.toString(),t={fa:"@",t:"s"})}else e=n.toString(),t={fa:"@",t:"s"};else In(n)?(e=n.toString(),t={fa:"General",t:"n"},s=parseFloat(n)):Bu(n)&&(n.toString().indexOf(".")>-1||n.toString().indexOf(":")>-1||n.toString().length<16)?(s=Pu(Fu(n.toString().replace(/-/g,"/"))),s.toString().indexOf(".")>-1?n.toString().length>18?t.fa="yyyy-MM-dd hh:mm:ss":n.toString().length>11?t.fa="yyyy-MM-dd hh:mm":t.fa="yyyy-MM-dd":t.fa="yyyy-MM-dd",t.t="d",e=jt.format(t.fa,s)):(e=n,t.fa="General",t.t="g");return[e,t,s]}const jt={format(n,e){}},yn=(n,e)=>{};class Bs{static getApplyData(e,t,s,r,o){const i=this,a=[];i.applyType=r,i.direction=o;const c=Math.floor(s/t),l=s%t,u=e.number,h=[];if(u)for(let E=0;E<u.length;E++){const D=i.getLenS(u[E].index,l),M=u[E].index.length*c+D;let P;r===1?P=i.getDataByType(u[E].data,M,o,r,"number"):r==="2"?P=i.getDataByType(u[E].data,M,o,r):P=i.getDataByType(u[E].data,M,o,"0");const G=i.getDataIndex(t,s,u[E].index);h.push({data:P,index:G})}const d=e.extendNumber,f=[];if(d)for(let E=0;E<d.length;E++){const D=i.getLenS(d[E].index,l),M=d[E].index.length*c+D;let P;r==="1"||r==="3"?P=i.getDataByType(d[E].data,M,o,r,"extendNumber"):r==="2"?P=i.getDataByType(d[E].data,M,o,r):P=i.getDataByType(d[E].data,M,o,"0");const G=i.getDataIndex(t,s,d[E].index);f.push({data:P,index:G})}const g=e.date,b=[];if(g)for(let E=0;E<g.length;E++){const D=i.getLenS(g[E].index,l),M=g[E].index.length*c+D;let P;r==="1"||r==="3"?P=i.getDataByType(g[E].data,M,o,r,"date"):r==="8"?P=i.getDataByType(g[E].data,M,o,"0"):P=i.getDataByType(g[E].data,M,o,r);const G=i.getDataIndex(t,s,g[E].index);b.push({data:P,index:G})}const p=e.chnNumber,v=[];if(p)for(let E=0;E<p.length;E++){const D=i.getLenS(p[E].index,l),M=p[E].index.length*c+D;let P;r==="1"||r==="3"?P=i.getDataByType(p[E].data,M,o,r,"chnNumber"):r==="2"||r==="8"?P=i.getDataByType(p[E].data,M,o,r):P=i.getDataByType(p[E].data,M,o,"0");const G=i.getDataIndex(t,s,p[E].index);v.push({data:P,index:G})}const C=e.chnWeek2,w=[];if(C)for(let E=0;E<C.length;E++){const D=i.getLenS(C[E].index,l),M=C[E].index.length*c+D;let P;r==="1"||r==="3"?P=i.getDataByType(C[E].data,M,o,r,"chnWeek2"):r==="2"?P=i.getDataByType(C[E].data,M,o,r):P=i.getDataByType(C[E].data,M,o,"0");const G=i.getDataIndex(t,s,C[E].index);w.push({data:P,index:G})}const x=e.chnWeek3,A=[];if(x)for(let E=0;E<x.length;E++){const D=i.getLenS(x[E].index,l),M=x[E].index.length*c+D;let P;r==="1"||r==="3"?P=i.getDataByType(x[E].data,M,o,r,"chnWeek3"):r==="2"?P=i.getDataByType(x[E].data,M,o,r):P=i.getDataByType(x[E].data,M,o,"0");const G=i.getDataIndex(t,s,x[E].index);A.push({data:P,index:G})}const z=e.other,R=[];if(z)for(let E=0;E<z.length;E++){const D=i.getLenS(z[E].index,l),M=z[E].index.length*c+D;let P;r==="2"||r==="3"?P=i.getDataByType(z[E].data,M,o,r):P=i.getDataByType(z[E].data,M,o,"0");const G=i.getDataIndex(t,s,z[E].index);R.push({data:P,index:G})}for(let E=1;E<=s;E++){if(h.length>0)for(let D=0;D<h.length;D++)E in h[D].index&&a.push(h[D].data[h[D].index[E]]);if(f.length>0)for(let D=0;D<f.length;D++)E in f[D].index&&a.push(f[D].data[f[D].index[E]]);if(b.length>0)for(let D=0;D<b.length;D++)E in b[D].index&&a.push(b[D].data[b[D].index[E]]);if(v.length>0)for(let D=0;D<v.length;D++)E in v[D].index&&a.push(v[D].data[v[D].index[E]]);if(w.length>0)for(let D=0;D<w.length;D++)E in w[D].index&&a.push(w[D].data[w[D].index[E]]);if(A.length>0)for(let D=0;D<A.length;D++)E in A[D].index&&a.push(A[D].data[A[D].index[E]]);if(R.length>0)for(let D=0;D<R.length;D++)E in R[D].index&&a.push(R[D].data[R[D].index[E]])}return a}static getCopyData(e,t,s,r,o,i){const a=this,c=[];let l=0,u=0,h=0,d=0;i===k.BOTTOM||i===k.TOP?(l=r,u=o,h=t,d=s):(i===k.RIGHT||i===k.LEFT)&&(l=t,u=s,h=r,d=o);for(let f=l;f<=u;f++){const g={};let b=[],p=[],v="",C=null,w=null,x=!0;for(let A=h,z=0;A<=d;A++,z++){const R=e[z];let E;if(!!R&&!!R.v&&!R.f)if(!!R.fm&&R.fm.t===Gr.NUMBER)E="number",C=null,w=null;else if(!!R.fm&&R.fm.t===Gr.DATE)E="date",C=null,w=null;else if(a.isExtendNumber(R.m)[0]){E="extendNumber";const D=a.isExtendNumber(R.m);C===null||w===null?(x=!0,C=D[2],w=D[3]):D[2]!==C||D[3]!==w?(x=!1,C=D[2],w=D[3]):x=!0}else a.isChnNumber(R.m)?(E="chnNumber",C=null,w=null):a.isChnWeek2(R.m)?(E="chnWeek2",C=null,w=null):a.isChnWeek3(R.m)?(E="chnWeek3",C=null,w=null):(E="other",C=null,w=null);else E="other",C=null,w=null;E==="extendNumber"?A===h?h===d?(v=E,b.push(R),p.push(A-h+1),g[v]=[],g[v].push({data:b,index:p})):(v=E,b.push(R),p.push(A-h+1)):A===d?v===E&&x?(b.push(R),p.push(A-h+1),v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p}))):(v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p})),v=E,b=[],b.push(R),p=[],p.push(A-h+1),v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p}))):v===E&&x?(b.push(R),p.push(A-h+1)):(v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p})),v=E,b=[],b.push(R),p=[],p.push(A-h+1)):A===h?h===d?(v=E,b.push(R),p.push(A-h+1),g[v]=[],g[v].push({data:b,index:p})):(v=E,b.push(R),p.push(A-h+1)):A===d?v===E?(b.push(R),p.push(A-h+1),v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p}))):(v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p})),v=E,b=[],b.push(R),p=[],p.push(A-h+1),v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p}))):v===E?(b.push(R),p.push(A-h+1)):(v in g?g[v].push({data:b,index:p}):(g[v]=[],g[v].push({data:b,index:p})),v=E,b=[],b.push(R),p=[],p.push(A-h+1))}c.push(g)}return c}static ChineseToNumber(e){const t=this;let s=0,r=0,o=0,i=!1;const a=e.split("");for(let c=0;c<a.length;c++){const l=t.chnNumChar[a[c]];if(typeof l!="undefined")o=l,c===a.length-1&&(r+=o);else{const u=t.chnNameValue[a[c]].value;i=t.chnNameValue[a[c]].secUnit,i?(r=(r+o)*u,s+=r,r=0):r+=o*u,o=0}}return s+r}static NumberToChinese(e){const t=this;let s=0,r="",o="",i=!1;if(e===0)return t.chnNumChar2[0];for(;e>0;){const a=e%1e4;i&&(o=t.chnNumChar2[0]+o),r=t.SectionToChinese(a),r+=a!==0?t.chnUnitSection[s]:t.chnUnitSection[0],o=r+o,i=a<1e3&&a>0,e=Math.floor(e/1e4),s++}return o}static SectionToChinese(e){const t=this;let s="",r="",o=0,i=!0;for(;e>0;){const a=e%10;a===0?i||(i=!0,r=t.chnNumChar2[a]+r):(i=!1,s=t.chnNumChar2[a],s+=t.chnUnitChar[o],r=s+r),o++,e=Math.floor(e/10)}return r}static getLenS(e,t){let s=0;for(let r=0;r<e.length&&e[r]<=t;r++)s++;return s}static getDataByType(e,t,s,r,o){const i=this;let a=[];if(r===Vr.ALTERNATE_SERIES)(s===k.TOP||s===k.LEFT)&&e.reverse(),a=i.FillCopy(e,t);else if(r===Vr.DEFAULT_SERIES)if(o==="number")a=i.FillSeries(e,t,s);else if(o==="extendNumber")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillExtendNumber(e,t,c)}else{const c=[];for(let l=0;l<e.length;l++){const u=e[l].m;c.push(Number(i.isExtendNumber(u)[1]))}if((s===k.TOP||s===k.LEFT)&&(e.reverse(),c.reverse()),i.isEqualDiff(c)){const l=c[1]-c[0];a=i.FillExtendNumber(e,t,l)}else a=i.FillCopy(e,t)}else if(o==="date")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillDays(e,t,c)}else{(s===k.TOP||s===k.LEFT)&&e.reverse();const c=i.judgeDate(e);if(c[0]&&c[3]){const l=W(e[1].m).diff(W(e[0].m),"months");a=i.FillMonths(e,t,l)}else if(!c[0]&&c[2]){const l=W(e[1].m).diff(W(e[0].m),"days");a=i.FillDays(e,t,l)}else a=i.FillCopy(e,t)}else if(o==="chnNumber")if(e.length===1)if(e[0].m==="\u65E5"||i.ChineseToNumber(e[0].m)<7){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillChnWeek(e,t,c)}else{let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillChnNumber(e,t,c)}else{let c=!1;for(let h=0;h<e.length;h++)if(e[h].m==="\u65E5"){c=!0;break}const l=[];let u=0;for(let h=0;h<e.length;h++)e[h].m==="\u65E5"?h===0?l.push(0):(u++,l.push(u*7)):c&&i.ChineseToNumber(e[h].m)>0&&i.ChineseToNumber(e[h].m)<7?l.push(i.ChineseToNumber(e[h].m)+u*7):l.push(i.ChineseToNumber(e[h].m));if((s===k.TOP||s===k.LEFT)&&(e.reverse(),l.reverse()),i.isEqualDiff(l))if(c||l[l.length-1]<6&&l[0]>0||l[0]<6&&l[l.length-1]>0){const h=l[1]-l[0];a=i.FillChnWeek(e,t,h)}else{const h=l[1]-l[0];a=i.FillChnNumber(e,t,h)}else a=i.FillCopy(e,t)}else if(o==="chnWeek2")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillChnWeek2(e,t,c)}else{const c=[];let l=0;for(let u=0;u<e.length;u++){const h=e[u].m.substr(e[u].m.length-1,1);e[u].m==="\u5468\u65E5"?u===0?c.push(0):(l++,c.push(l*7)):c.push(i.ChineseToNumber(h)+l*7)}if((s===k.TOP||s===k.LEFT)&&(e.reverse(),c.reverse()),i.isEqualDiff(c)){const u=c[1]-c[0];a=i.FillChnWeek2(e,t,u)}else a=i.FillCopy(e,t)}else if(o==="chnWeek3")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillChnWeek3(e,t,c)}else{const c=[];let l=0;for(let u=0;u<e.length;u++){const h=e[u].m.substr(e[u].m.length-1,1);e[u].m==="\u661F\u671F\u65E5"?u===0?c.push(0):(l++,c.push(l*7)):c.push(i.ChineseToNumber(h)+l*7)}if((s===k.TOP||s===k.LEFT)&&(e.reverse(),c.reverse()),i.isEqualDiff(c)){const u=c[1]-c[0];a=i.FillChnWeek3(e,t,u)}else a=i.FillCopy(e,t)}else(s===k.TOP||s===k.LEFT)&&e.reverse(),a=i.FillCopy(e,t);else if(r==="2")(s===k.TOP||s===k.LEFT)&&e.reverse(),a=i.FillOnlyFormat(e,t);else if(r==="3"){const c=i.getDataByType(e,t,s,"1",o);a=i.FillWithoutFormat(c)}else if(r==="4")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillDays(e,t,c)}else if(e.length===2){(s===k.TOP||s===k.LEFT)&&e.reverse();const c=W(e[1].m).diff(W(e[0].m),"days");a=i.FillDays(e,t,c)}else{(s===k.TOP||s===k.LEFT)&&e.reverse();const c=i.judgeDate(e);if(c[0]&&c[3]){const l=W(e[1].m).diff(W(e[0].m),"months");a=i.FillMonths(e,t,l)}else if(!c[0]&&c[2]){const l=W(e[1].m).diff(W(e[0].m),"days");a=i.FillDays(e,t,l)}else a=i.FillCopy(e,t)}else if(r==="5")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1);const l=Math.round(t*1.5);for(let u=1;u<=l;u++){const h={...e[u]},d=W(h.m).add(u,"days").day();if(d===0||d===6)continue;const f=W(h.m).add(c*u,"days").format("YYYY-MM-DD");if(h.m=f,h.v=tt(f)[2],a.push(h),a.length===t)break}}else if(e.length===2)if(W(e[1].m).date()===W(e[0].m).date()&&W(e[1].m).diff(W(e[0].m),"months")!==0){(s===k.TOP||s===k.LEFT)&&e.reverse();const c=W(e[1].m).diff(W(e[0].m),"months");for(let l=1;l<=t;l++){const u=(l-1)%e.length,h={...e[u]},d=W(e[e.length-1]).add(c*l,"months").day();let f;d===0?f=W(e[e.length-1]).add(c*l,"months").subtract(2,"days").format("YYYY-MM-DD"):d===6?f=W(e[e.length-1]).add(c*l,"months").subtract(1,"days").format("YYYY-MM-DD"):f=W(e[e.length-1]).add(c*l,"months").format("YYYY-MM-DD"),h.m=f,h.v=tt(f)[2],a.push(h)}}else if(Math.abs(W(e[1].m).diff(W(e[0].m)))>7){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1,e.reverse());let l=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},f=Math.ceil(u/e.length);h===0&&(l=W(d.m).add(c*f,"months").diff(W(d.m),"days"));const g=W(d.m).add(l,"days").day();let b;g===0?b=W(d.m).add(l,"days").subtract(2,"days").format("YYYY-MM-DD"):g===6?b=W(d.m).add(l,"days").subtract(1,"days").format("YYYY-MM-DD"):b=W(d.m).add(l,"days").format("YYYY-MM-DD"),d.m=b,d.v=tt(b)[2],a.push(d)}}else{let c=0;s===k.BOTTOM||s===k.RIGHT?c=7:(s===k.TOP||s===k.LEFT)&&(c=-7,e.reverse());let l=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},f=Math.ceil(u/e.length);h===0&&(l=W(d.m).add(c*f,"days").diff(W(d.m),"days"));const g=W(d.m).add(l,"days").day();let b;g===0?b=W(d.m).add(l,"days").subtract(2,"days").format("YYYY-MM-DD"):g===6?b=W(d.m).add(l,"days").subtract(1,"days").format("YYYY-MM-DD"):b=W(d.m).add(l,"days").format("YYYY-MM-DD"),d.m=b,d.v=tt(b)[2],a.push(d)}}else{const c=i.judgeDate(e);if(c[0]&&c[3]){(s===k.TOP||s===k.LEFT)&&e.reverse();const l=W(e[1].m).diff(W(e[0].m),"months");for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},f=W(e[e.length-1].m).add(l*u,"months").day();let g;f===0?g=W(e[e.length-1].m).add(l*u,"months").subtract(2,"days").format("YYYY-MM-DD"):f===6?g=W(e[e.length-1].m).add(l*u,"months").subtract(1,"days").format("YYYY-MM-DD"):g=W(e[e.length-1].m).add(l*u,"months").format("YYYY-MM-DD"),d.m=g,d.v=tt(g)[2],a.push(d)}}else if(!c[0]&&c[2])if(Math.abs(W(e[1].m).diff(W(e[0].m)))>7){let l=0;s===k.BOTTOM||s===k.RIGHT?l=1:(s===k.TOP||s===k.LEFT)&&(l=-1,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,f={...e[d]},g=Math.ceil(h/e.length);d===0&&(u=W(f.m).add(l*g,"months").diff(W(f.m),"days"));const b=W(f.m).add(u,"days").day();let p;b===0?p=W(f.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):b===6?p=W(f.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):p=W(f.m).add(u,"days").format("YYYY-MM-DD"),f.m=p,f.v=tt(p)[2],a.push(f)}}else{let l=0;s===k.BOTTOM||s===k.RIGHT?l=7:(s===k.TOP||s===k.LEFT)&&(l=-7,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,f={...e[d]},g=Math.ceil(h/e.length);d===0&&(u=W(f.m).add(l*g,"days").diff(W(f.m),"days"));const b=W(f.m).add(u,"days").day();let p;b===0?p=W(f.m).add(u,"days").subtract(2,"days").format("YYYY-MM-DD"):b===6?p=W(f.m).add(u,"days").subtract(1,"days").format("YYYY-MM-DD"):p=W(f.m).add(u,"days").format("YYYY-MM-DD"),f.m=p,f.v=tt(p)[2],a.push(f)}}else(s===k.TOP||s===k.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(r==="6")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillMonths(e,t,c)}else if(e.length===2)if(W(e[1].m).date()===W(e[0].m).date()&&W(e[1].m).diff(W(e[0].m),"months")!==0){(s===k.TOP||s===k.LEFT)&&e.reverse();const c=W(e[1].m).diff(W(e[0].m),"months");a=i.FillMonths(e,t,c)}else{let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1,e.reverse());let l=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},f=Math.ceil(u/e.length);h===0&&(l=W(d.m).add(c*f,"months").diff(W(d.m),"days"));const g=W(d.m).add(l,"days").format("YYYY-MM-DD");d.m=g,d.v=tt(g)[2],a.push(d)}}else{const c=i.judgeDate(e);if(c[0]&&c[3]){(s===k.TOP||s===k.LEFT)&&e.reverse();const l=W(e[1].m).diff(W(e[0].m),"months");a=i.FillMonths(e,t,l)}else if(!c[0]&&c[2]){let l=0;s===k.BOTTOM||s===k.RIGHT?l=1:(s===k.TOP||s===k.LEFT)&&(l=-1,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,f={...e[d]},g=Math.ceil(h/e.length);d===0&&(u=W(f.m).add(l*g,"months").diff(W(f.m),"days"));const b=W(f.m).add(u,"days").format("YYYY-MM-DD");f.m=b,f.v=tt(b)[2],a.push(f)}}else(s===k.TOP||s===k.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(r==="7")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillYears(e,t,c)}else if(e.length===2)if(W(e[1].m).date()===W(e[0].m).date()&&W(e[1].m).month()===W(e[0].m).month()&&W(e[1].m).diff(W(e[0].m),"years")!==0){(s===k.TOP||s===k.LEFT)&&e.reverse();const c=W(e[1].m).diff(W(e[0].m),"years");a=i.FillYears(e,t,c)}else{let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1,e.reverse());let l=0;for(let u=1;u<=t;u++){const h=(u-1)%e.length,d={...e[h]},f=Math.ceil(u/e.length);h===0&&(l=W(d.m).add(c*f,"years").diff(W(d.m),"days"));const g=W(d.m).add(l,"days").format("YYYY-MM-DD");d.m=g,d.v=tt(g)[2],a.push(d)}}else{const c=i.judgeDate(e);if(c[0]&&c[1]&&c[4]){(s===k.TOP||s===k.LEFT)&&e.reverse();const l=W(e[1].m).diff(W(e[0].m),"years");a=i.FillYears(e,t,l)}else if(c[0]&&c[3]||c[2]){let l=0;s===k.BOTTOM||s===k.RIGHT?l=1:(s===k.TOP||s===k.LEFT)&&(l=-1,e.reverse());let u=0;for(let h=1;h<=t;h++){const d=(h-1)%e.length,f={...e[d]},g=Math.ceil(h/e.length);d===0&&(u=W(f.m).add(l*g,"years").diff(W(f.m),"days"));const b=W(f.m).add(u,"days").format("YYYY-MM-DD");f.m=b,f.v=tt(b)[2],a.push(f)}}else(s===k.TOP||s===k.LEFT)&&e.reverse(),a=i.FillCopy(e,t)}else if(r==="8")if(e.length===1){let c=0;s===k.BOTTOM||s===k.RIGHT?c=1:(s===k.TOP||s===k.LEFT)&&(c=-1),a=i.FillChnNumber(e,t,c)}else{const c=[];for(let l=0;l<e.length;l++)c.push(i.ChineseToNumber(e[l].m));if((s===k.TOP||s===k.LEFT)&&(e.reverse(),c.reverse()),i.isEqualDiff(c)){const l=c[1]-c[0];a=i.FillChnNumber(e,t,l)}else a=i.FillCopy(e,t)}return a}static getDataIndex(e,t,s){const r={},o=Math.floor(t/e),i=t%e;let a=0;if(o>0){for(let c=1;c<=o;c++)for(let l=0;l<s.length;l++)r[s[l]+(c-1)*e]=a,a++;for(let c=0;c<s.length&&s[c]<=i;c++)r[s[c]+e*o]=a,a++}else for(let c=0;c<s.length&&s[c]<=i;c++)r[s[c]]=a,a++;return r}static FillCopy(e,t){const s=[];for(let r=1;r<=t;r++){const o=(r-1)%e.length,i={...e[o]};s.push(i)}return s}static FillSeries(e,t,s){const r=this,o=[],i=[];for(let a=0;a<e.length;a++)i.push(Number(e[a].v));if(e.length>2&&r.isEqualRatio(i))for(let a=1;a<=t;a++){const c=(a-1)%e.length,l={...e[c]};let u;s===k.BOTTOM||s===k.RIGHT?u=Number(e[e.length-1].v)*(Number(e[1].v)/Number(e[0].v))**a:(s===k.TOP||s===k.LEFT)&&(u=Number(e[0].v)/(Number(e[1].v)/Number(e[0].v))**a),l.v=u,l.m=u,o.push(l)}else{const a=r.getXArr(e.length);for(let c=1;c<=t;c++){const l=(c-1)%e.length,u={...e[l]};let h;s===k.BOTTOM||s===k.RIGHT?h=r.forecast(e.length+c,i,a):(s===k.TOP||s===k.LEFT)&&(h=r.forecast(1-c,i,a)),u.v=h,u.m=h,o.push(u)}}return o}static FillExtendNumber(e,t,s){const r=[],o=/0|([1-9]+[0-9]*)/g;for(let i=1;i<=t;i++){const a=(i-1)%e.length,c={...e[a]},l=e[e.length-1].m,u=l.match(o),h=u[u.length-1],d=Math.abs(Number(h)+s*i),f=l.lastIndexOf(h),g=l.substr(0,f)+d.toString()+l.substr(f+h.length);c.v=g,c.m=g,r.push(c)}return r}static FillOnlyFormat(e,t){const s=[];for(let r=1;r<=t;r++){const o=(r-1)%e.length,i={...e[o]};delete i.f,delete i.m,delete i.v,s.push(i)}return s}static FillWithoutFormat(e){const t=[];for(let s=0;s<e.length;s++){const r={...e[s]};let o;r.f===null?o={m:r.v.toString(),v:r.v}:o={f:r.f,m:r.v.toString(),v:r.v},t.push(o)}return t}static FillDays(e,t,s){const r=[];for(let o=1;o<=t;o++){const i=(o-1)%e.length,a={...e[i]};let c=yn("yyyy-MM-dd",a.v);c=W(c).add(s*o,"days").format("YYYY-MM-DD"),a.v=tt(c)[2],a.m=yn(a.fm.f,a.v),r.push(a)}return r}static FillMonths(e,t,s){const r=[];for(let o=1;o<=t;o++){const i=(o-1)%e.length,a={...e[i]};let c=yn("yyyy-MM-dd",a.v);c=W(c).add(s*o,"months").format("YYYY-MM-DD"),a.v=tt(c)[2],a.m=yn(a.fm.f,a.v),r.push(a)}return r}static FillYears(e,t,s){const r=[];for(let o=1;o<=t;o++){const i=(o-1)%e.length,a={...e[i]};let c=yn("yyyy-MM-dd",a.v);c=W(c).add(s*o,"years").format("YYYY-MM-DD"),a.v=tt(c)[2],a.m=yn(a.fm.t,a.v),r.push(a)}return r}static FillChnWeek(e,t,s){const r=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,c={...e[a]};let l;e[e.length-1].m==="\u65E5"?l=7+s*i:l=r.ChineseToNumber(e[e.length-1].m)+s*i,l<0&&(l=Math.ceil(Math.abs(l)/7)*7+l);const u=l%7;u===0?(c.m="\u65E5",c.v="\u65E5"):u===1?(c.m="\u4E00",c.v="\u4E00"):u===2?(c.m="\u4E8C",c.v="\u4E8C"):u===3?(c.m="\u4E09",c.v="\u4E09"):u===4?(c.m="\u56DB",c.v="\u56DB"):u===5?(c.m="\u4E94",c.v="\u4E94"):u===6&&(c.m="\u516D",c.v="\u516D"),o.push(c)}return o}static FillChnWeek2(e,t,s){const r=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,c={...e[a]};let l;if(e[e.length-1].m==="\u5468\u65E5")l=7+s*i;else{const h=e[e.length-1].m,d=h.substr(h.length-1,1);l=r.ChineseToNumber(d)+s*i}l<0&&(l=Math.ceil(Math.abs(l)/7)*7+l);const u=l%7;u===0?(c.m="\u5468\u65E5",c.v="\u5468\u65E5"):u===1?(c.m="\u5468\u4E00",c.v="\u5468\u4E00"):u===2?(c.m="\u5468\u4E8C",c.v="\u5468\u4E8C"):u===3?(c.m="\u5468\u4E09",c.v="\u5468\u4E09"):u===4?(c.m="\u5468\u56DB",c.v="\u5468\u56DB"):u===5?(c.m="\u5468\u4E94",c.v="\u5468\u4E94"):u===6&&(c.m="\u5468\u516D",c.v="\u5468\u516D"),o.push(c)}return o}static FillChnWeek3(e,t,s){const r=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,c={...e[a]};let l;if(e[e.length-1].m==="\u661F\u671F\u65E5")l=7+s*i;else{const h=e[e.length-1].m,d=h.substr(h.length-1,1);l=r.ChineseToNumber(d)+s*i}l<0&&(l=Math.ceil(Math.abs(l)/7)*7+l);const u=l%7;u===0?(c.m="\u661F\u671F\u65E5",c.v="\u661F\u671F\u65E5"):u===1?(c.m="\u661F\u671F\u4E00",c.v="\u661F\u671F\u4E00"):u===2?(c.m="\u661F\u671F\u4E8C",c.v="\u661F\u671F\u4E8C"):u===3?(c.m="\u661F\u671F\u4E09",c.v="\u661F\u671F\u4E09"):u===4?(c.m="\u661F\u671F\u56DB",c.v="\u661F\u671F\u56DB"):u===5?(c.m="\u661F\u671F\u4E94",c.v="\u661F\u671F\u4E94"):u===6&&(c.m="\u661F\u671F\u516D",c.v="\u661F\u671F\u516D"),o.push(c)}return o}static FillChnNumber(e,t,s){const r=this,o=[];for(let i=1;i<=t;i++){const a=(i-1)%e.length,c={...e[a]},l=r.ChineseToNumber(e[e.length-1].m)+s*i;let u;l<=0?u="\u96F6":u=r.NumberToChinese(l),c.v=u,c.m=u.toString(),o.push(c)}return o}static isEqualDiff(e){let t=!0;const s=e[1]-e[0];for(let r=1;r<e.length;r++)if(e[r]-e[r-1]!==s){t=!1;break}return t}static isChnNumber(e){const t=this;let s=!0;if(e.length===1)e==="\u65E5"||e in t.chnNumChar?s=!0:s=!1;else{const r=e.split("");for(let o=0;o<r.length;o++)if(!(r[o]in t.chnNumChar||r[o]in t.chnNameValue)){s=!1;break}}return s}static isExtendNumber(e){const t=/0|([1-9]+[0-9]*)/g,s=t.test(e);if(s){const r=e.match(t),o=r[r.length-1],i=e.lastIndexOf(o),a=e.substr(0,i),c=e.substr(i+o.length);return[s,Number(o),a,c]}return[s]}static isChnWeek1(e){const t=this;let s;return e.length===1&&(e==="\u65E5"||t.ChineseToNumber(e)<7)?s=!0:s=!1,s}static isChnWeek2(e){let t;return e.length===2&&(e==="\u5468\u4E00"||e==="\u5468\u4E8C"||e==="\u5468\u4E09"||e==="\u5468\u56DB"||e==="\u5468\u4E94"||e==="\u5468\u516D"||e==="\u5468\u65E5")?t=!0:t=!1,t}static isChnWeek3(e){let t;return e.length===3&&(e==="\u661F\u671F\u4E00"||e==="\u661F\u671F\u4E8C"||e==="\u661F\u671F\u4E09"||e==="\u661F\u671F\u56DB"||e==="\u661F\u671F\u4E94"||e==="\u661F\u671F\u516D"||e==="\u661F\u671F\u65E5")?t=!0:t=!1,t}static isEqualRatio(e){let t=!0;const s=e[1]/e[0];for(let r=1;r<e.length;r++)if(e[r]/e[r-1]!==s){t=!1;break}return t}static getXArr(e){const t=[];for(let s=1;s<=e;s++)t.push(s);return t}static forecast(e,t,s){function r(h){let d=0;for(let f=0;f<h.length;f++)d+=h[f];return d/h.length}const o=r(s),i=r(t);let a=0,c=0;for(let h=0;h<s.length;h++)a+=(s[h]-o)*(t[h]-i),c+=(s[h]-o)*(s[h]-o);let l;c===0?l=1:l=a/c;const u=i-l*o;return Math.round((u+l*e)*1e5)/1e5}static judgeDate(e){let t=!0,s=!0,r=!0,o=!0,i=!0;const a=W(e[0].m).date(),c=W(e[0].m).month(),l=W(e[1].m).diff(W(e[0].m),"days"),u=W(e[1].m).diff(W(e[0].m),"months"),h=W(e[1].m).diff(W(e[0].m),"years");for(let d=1;d<e.length;d++)W(e[d].m).date()!==a&&(t=!1),W(e[d].m).month()!==c&&(s=!1),W(e[d].m).diff(W(e[d-1].m),"days")!==l&&(r=!1),W(e[d].m).diff(W(e[d-1].m),"months")!==u&&(o=!1),W(e[d].m).diff(W(e[d-1].m),"years")!==h&&(i=!1);return l===0&&(r=!1),u===0&&(o=!1),h===0&&(i=!1),[t,s,r,o,i]}}let ms=(n=21)=>crypto.getRandomValues(new Uint8Array(n)).reduce((e,t)=>(t&=63,t<36?e+=t.toString(36):t<62?e+=(t-26).toString(36).toUpperCase():t>62?e+="-":e+="_",e),"");class zu{constructor(e,t){this._context=e.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=e,this._rangeList=[],t.forEach(s=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(s).rangeData)}),this._rangeList[0].startRow===-1&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return this._rangeList[0].startRow===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(e){let{_rangeList:t,_context:s,_commandManager:r,_worksheet:o}=this;const i=t.map(c=>{let{startRow:l,startColumn:u,endRow:h,endColumn:d}=c,f=new ee;for(let b=l;b<=h;b++)for(let p=u;p<=d;p++)f.setValue(l,u,{m:`${e}`,v:e});return{sheetId:o.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:f.getData()}});let a=new Y({WorkBookUnit:s.getWorkBook()},...i);return r.invoke(a),this}clear(...e){const{_context:t,_worksheet:s,_commandManager:r,_rangeList:o}=this;let i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0};Ie.checkup(e,Ie.OBJECT_TYPE)&&(i=e[0]);const a=o.map(l=>({sheetId:s.getSheetId(),actionName:I.CLEAR_RANGE_ACTION,options:i,rangeData:l}));let c=new Y({WorkBookUnit:t.getWorkBook()},...a);return r.invoke(c),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}_setStyle(e,t){let{_rangeList:s,_context:r,_commandManager:o,_worksheet:i}=this;const a=s.map(l=>{let{startRow:u,startColumn:h,endRow:d,endColumn:f}=l;const g={[t]:e},b=S.fillObjectMatrix(d-u+1,f-h+1,g);return{sheetId:i.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:b,rangeData:l}});let c=new Y({WorkBookUnit:r.getWorkBook()},...a);return o.invoke(c),this}setBackground(e){let{_rangeList:t,_context:s,_commandManager:r,_worksheet:o}=this;const i=t.map(c=>{let{startRow:l,startColumn:u,endRow:h,endColumn:d}=c;const f={bg:{rgb:e}},g=S.fillObjectMatrix(h-l+1,d-u+1,f);return{sheetId:o.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:g,rangeData:c}});let a=new Y({WorkBookUnit:s.getWorkBook()},...i);return r.invoke(a),this}setBackgroundRGB(e,t,s){const r=`RGB(${e},${t},${s})`;let{_rangeList:o,_context:i,_commandManager:a,_worksheet:c}=this;const l=o.map(h=>{let{startRow:d,startColumn:f,endRow:g,endColumn:b}=h;const p={bg:{rgb:r}},v=S.fillObjectMatrix(g-d+1,b-f+1,p);return{sheetId:c.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:v,rangeData:h}});let u=new Y({WorkBookUnit:i.getWorkBook()},...l);return a.invoke(u),this}setFontColor(e){let{_rangeList:t,_context:s,_commandManager:r,_worksheet:o}=this;const i=t.map(c=>{let{startRow:l,startColumn:u,endRow:h,endColumn:d}=c;const f={cl:{rgb:e}},g=S.fillObjectMatrix(h-l+1,d-u+1,f);return{sheetId:o.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:g,rangeData:c}});let a=new Y({WorkBookUnit:s.getWorkBook()},...i);return r.invoke(a),this}setFontFamily(e){return this._setStyle(e,"ff")}setUnderline(e){const t={s:e?L.TRUE:L.FALSE};return this._setStyle(t,"ul")}setOverline(e){const t={s:e?L.TRUE:L.FALSE};return this._setStyle(t,"ol")}setStrikeThrough(e){const t={s:e?L.TRUE:L.FALSE};return this._setStyle(t,"st")}setFontSize(e){return this._setStyle(e,"fs")}setFontStyle(e){const t=e?L.TRUE:L.FALSE;return this._setStyle(t,"it")}setFontWeight(e){const t=e?L.TRUE:L.FALSE;return this._setStyle(t,"bl")}setFormula(e){let{_rangeList:t,_context:s,_commandManager:r,_worksheet:o}=this;const i=t.map(c=>{let{startRow:l,startColumn:u,endRow:h,endColumn:d}=c,f=new ee;for(let b=l;b<=h;b++)for(let p=u;p<=d;p++)f.setValue(b,p,e);return{sheetId:o.getSheetId(),actionName:I.SET_RANGE_FORMULA_ACTION,cellFormula:f.getData(),rangeData:c}});let a=new Y({WorkBookUnit:s.getWorkBook()},...i);return r.invoke(a),this}setHorizontalAlignment(e){return this._setStyle(e,"ht")}setTextDirection(e){return this._setStyle(e,"td")}setTextRotation(e){let{_rangeList:t,_context:s,_commandManager:r,_worksheet:o}=this;const i=t.map(c=>{let{startRow:l,startColumn:u,endRow:h,endColumn:d}=c;const f={tr:{v:0,a:Number(e)}},g=S.fillObjectMatrix(h-l+1,d-u+1,f);return{sheetId:o.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:g,rangeData:c}});let a=new Y({WorkBookUnit:s.getWorkBook()},...i);return r.invoke(a),this}setVerticalAlignment(e){return this._setStyle(e,"vt"),this}setVerticalText(e){let{_rangeList:t,_context:s,_commandManager:r,_worksheet:o}=this;const i=t.map(c=>{let{startRow:l,startColumn:u,endRow:h,endColumn:d}=c;const f={tr:{v:e,a:0}},g=S.fillObjectMatrix(h-l+1,d-u+1,f);return{sheetId:o.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:g,rangeData:c}});let a=new Y({WorkBookUnit:s.getWorkBook()},...i);return r.invoke(a),this}setWrap(e){return this._setStyle(e,"tb")}setWrapStrategy(e){return this._setStyle(e,"tb")}trimWhitespace(){let{_rangeList:e,_context:t,_commandManager:s,_worksheet:r}=this;const o=e.map(a=>{let{startRow:c,startColumn:l,endRow:u,endColumn:h}=a;const d=this._worksheet.getCellMatrix(),f=/\s+/g;let g=new ee;for(let p=c;p<u+1;p++)for(let v=l;v<h+1;v++){const w=d.getValue(p,v).m.replace(f,"");g.setValue(p,v,w||"")}return{sheetId:r.getSheetId(),actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:g.getData(),rangeData:a}});let i=new Y({WorkBookUnit:t.getWorkBook()},...o);return s.invoke(i),this}}class Uu{constructor(e,t){this._workSheet=e,this._rowData=new Ee(t)}getRowData(){return this._rowData}getRowDatas(e,t){const s=new Ee;for(let r=e;r<e+t;r++){const o=this.getRowOrCreate(r);s.push(o)}return s}getRowHeight(...e){const{_workSheet:t}=this,{_rowData:s}=this,r=t.getConfig();let o=0;if(e.length===1)o=s.obtain(e[0],{hd:L.FALSE,h:r.defaultRowHeight}).h;else if(e.length===2)for(let i=e[0];i<e[0]+e[1];i++)o+=s.obtain(i,{hd:L.FALSE,h:r.defaultRowHeight}).h;return o}setRowHeight(e,t){const s=this._workSheet.getContext(),r=this._workSheet.getCommandManager(),o={sheetId:this._workSheet.getSheetId(),actionName:I.SET_ROW_HEIGHT_ACTION,rowIndex:e,rowHeight:t},i=new Y({WorkBookUnit:s.getWorkBook()},o);r.invoke(i)}getRow(e){const{_rowData:t}=this;return t.get(e)}getSize(){return this._rowData.getLength()}getRowOrCreate(e){const{_workSheet:t}=this,{_rowData:s}=this,r=s.get(e);if(r)return r;const o=t.getConfig(),i={hd:L.FALSE,h:o.defaultRowHeight};return s.set(e,i),i}}class Un{_initialize(){this._merges=new Mu(this,this._config.mergeData)}constructor(...e){var t;if(S.hasLength(e,1)){const s=e[0],r=S.commonExtend({},yr);e=[s,r]}if(S.hasLength(e,2)){this._context=e[0],this._config=S.commonExtend1(yr,e[1]);const{columnData:s,rowData:r,cellData:o}=this._config;this._sheetId=(t=this._config.id)!=null?t:ms(6),this._initialized=!1,this._cellData=new ee(o),this._commandManager=this._context.getCommandManager(),this._rowManager=new Uu(this,r),this._columnManager=new Xc(this,s),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===L.TRUE)return this;const{_context:e,_commandManager:t}=this,s=e.getContextObserver("onBeforeChangeActiveSheetObservable"),r=e.getContextObserver("onAfterChangeActiveSheetObservable"),o={sheetId:this._sheetId,actionName:I.SET_WORKSHEET_ACTIVATE_ACTION,status:L.TRUE},i=new Y({WorkBookUnit:e.getWorkBook()},o);return s.notifyObservers({sheet:this}),t.invoke(i),r.notifyObservers({sheet:this}),this}setConfig(e){return this._config=S.commonExtend(yr,e),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(e){const{_context:t,_commandManager:s,_sheetId:r}=this,o=t.getContextObserver("onBeforeChangeSheetNameObservable"),i=t.getContextObserver("onAfterChangeSheetNameObservable"),a={actionName:I.SET_WORKSHEET_NAME_ACTION,sheetName:e,sheetId:r},l=t.getWorkBook().getSheets();for(let h=0;h<l.length;h++){const d=l[h];if(d!==this&&d.getName()===e)return console.warn("Duplicate name"),this}o.notifyObservers();const u=new Y({WorkBookUnit:t.getWorkBook()},a);return s.invoke(u),i.notifyObservers({name:e,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:e,_context:t}=this,s=S.deepClone(e);return new Un(t,s)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._commandManager}getSheetData(){return[]}getRange(...e){if(S.hasLength(e,1))return new ke(this,e[0]);if(S.hasLength(e,2))return new ke(this,{row:[e[0],e[0]],column:[e[1],e[1]]});if(S.hasLength(e,3))return new ke(this,{row:[e[0],e[2]],column:[e[1],e[1]]});if(S.hasLength(e,4))return new ke(this,{row:[e[0],e[2]],column:[e[1],e[3]]})}getRangeList(e){return new zu(this,e)}getStatus(){const{_config:e}=this;return e.status}setStatus(e){const{_context:t,_commandManager:s,_sheetId:r}=this,o={actionName:I.SET_WORKSHEET_STATUS_ACTION,sheetId:r,sheetStatus:e},i=new Y({WorkBookUnit:t.getWorkBook()},o);return s.invoke(i),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(e){const{_context:t,_sheetId:s,_commandManager:r}=this,o={actionName:I.SET_ZOOM_RATIO_ACTION,sheetId:s,zoom:e},i=new Y({WorkBookUnit:t.getWorkBook()},o);r.invoke(i),t.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:e})}getSelection(){return this._selection}copy(e){const{_config:t,_context:s}=this,r=S.deepClone(t);return r.name=e,r.status=L.FALSE,r.id=ms(),new Un(s,r)}getConfig(){return this._config}insertRows(...e){let t=0,s=1;S.hasLength(e,1)&&(t=e[0]),S.hasLength(e,2)&&(t=e[0],s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new ee(new Ee(s)).toJSON()},c={actionName:I.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:s},l=new Y({WorkBookUnit:r.getWorkBook()},a,c);return o.invoke(l),this}insertRowAfter(...e){let t=0,s=1;S.hasLength(e,1)&&(t=e[0]+1),S.hasLength(e,2)&&(t=e[0]+1,s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new ee(new Ee(s)).toJSON()},c={actionName:I.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:s},l=new Y({WorkBookUnit:r.getWorkBook()},a,c);return o.invoke(l),this}insertRowBefore(...e){let t=0,s=1;S.hasLength(e,1)&&(t=e[0]-1),S.hasLength(e,2)&&(t=e[0]-1,s=e[1]),t<0&&(t=0);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.INSERT_ROW_DATA_ACTION,sheetId:i,rowIndex:t,rowData:new ee(new Ee(s)).toJSON()},c={actionName:I.INSERT_ROW_ACTION,sheetId:i,rowIndex:t,rowCount:s},l=new Y({WorkBookUnit:r.getWorkBook()},a,c);return o.invoke(l),this}insertColumns(...e){let t=0,s=1;S.hasLength(e,1)&&(t=e[0]),S.hasLength(e,2)&&(t=e[0],s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a=new ee;this._cellData.forEach(h=>{for(let d=t;d<t+s;d++)a.setValue(h,d-t,{})});const c={actionName:I.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},l={actionName:I.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:s},u=new Y({WorkBookUnit:r.getWorkBook()},l,c);return o.invoke(u),this}insertColumnBefore(...e){let t=0,s=1;S.hasLength(e,1)&&(t=e[0]-1),S.hasLength(e,2)&&(t=e[0]-1,s=e[1]),t<0&&(t=0);const{_context:r,_commandManager:o,_sheetId:i}=this,a=new ee;this._cellData.forEach(h=>{for(let d=t;d<t+s;d++)a.setValue(h,d-t,{})});const c={actionName:I.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},l={actionName:I.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:s},u=new Y({WorkBookUnit:r.getWorkBook()},l,c);return o.invoke(u),this}insertColumnAfter(...e){let t=0,s=1;S.hasLength(e,1)&&(t=e[0]+1),S.hasLength(e,2)&&(t=e[0]+1,s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a=new ee;this._cellData.forEach(h=>{for(let d=t;d<t+s;d++)a.setValue(h,d-t,{})});const c={actionName:I.INSERT_COLUMN_DATA_ACTION,sheetId:i,columnIndex:t,columnData:a.toJSON()},l={actionName:I.INSERT_COLUMN_ACTION,sheetId:i,columnIndex:t,columnCount:s},u=new Y({WorkBookUnit:r.getWorkBook()},c,l);return o.invoke(u),this}clear(...e){const{_context:t,_commandManager:s}=this,r={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let o={formatOnly:!0,contentsOnly:!0};Ie.checkup(e,Ie.OBJECT_TYPE)&&(o=e[0]);const i={sheetId:this._sheetId,actionName:I.CLEAR_RANGE_ACTION,options:o,rangeData:r},a=new Y({WorkBookUnit:t.getWorkBook()},i);return s.invoke(a),this}setTabColor(e){const{_context:t,_commandManager:s}=this,r=t.getContextObserver("onSheetTabColorChangeObservable"),o={sheetId:this._sheetId,actionName:I.SET_TAB_COLOR_ACTION,color:e},i=new Y({WorkBookUnit:t.getWorkBook()},o);return s.invoke(i),r.notifyObservers(),this}hideSheet(){const{_context:e,_commandManager:t}=this,s=e.getWorkBook();if(!this._config.hidden){const r=e.getContextObserver("onHideSheetObservable"),o={sheetId:this._sheetId,actionName:I.HIDE_SHEET_ACTION,hidden:L.TRUE},i=new Y({WorkBookUnit:e.getWorkBook()},o);if(t.invoke(i),this.getStatus()===L.TRUE){const c=s.getSheetIndex(this),l=s.nextSheet(c);l&&l.activate()}r.notifyObservers({sheet:this})}return this}showSheet(){if(!this._config.hidden)return this;const{_context:e,_commandManager:t}=this,s={sheetId:this._sheetId,actionName:I.HIDE_SHEET_ACTION,hidden:L.FALSE},r=new Y({WorkBookUnit:e.getWorkBook()},s);return t.invoke(r),e.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setCommandManager(e){return this._commandManager=e,this}setActiveSelection(...e){const t=e[0];return t?this._selection.setSelection({selection:t}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:e}=this,{columnCount:t}=e;return t}getMaxRows(){const{_config:e}=this,{rowCount:t}=e;return t}getType(){const{_config:e}=this,{type:t}=e;return t}clearContents(){const{_config:e}=this,{rowCount:t,columnCount:s}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:s}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:e}=this,{rowCount:t,columnCount:s}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:s}).clear({formatOnly:!0}),this}clearNotes(){const{_config:e}=this,{rowCount:t,columnCount:s}=e;return this.getRange({startRow:0,endRow:t,startColumn:0,endColumn:s}).clear({commentsOnly:!0}),this}deleteColumn(e){const{_context:t,_commandManager:s,_sheetId:r}=this,o={actionName:I.REMOVE_COLUMN_DATA_ACTION,sheetId:r,columnCount:1,columnIndex:e},i={actionName:I.REMOVE_COLUMN_ACTION,sheetId:r,columnCount:1,columnIndex:e},a=new Y({WorkBookUnit:t.getWorkBook()},o,i);return s.invoke(a),this}deleteColumns(e,t){const{_context:s,_commandManager:r,_sheetId:o}=this,i={actionName:I.REMOVE_COLUMN_DATA_ACTION,sheetId:o,columnCount:t,columnIndex:e},a={actionName:I.REMOVE_COLUMN_ACTION,sheetId:o,columnCount:t,columnIndex:e},c=new Y({WorkBookUnit:s.getWorkBook()},i,a);return r.invoke(c),this}deleteRow(e){const{_context:t,_commandManager:s,_sheetId:r}=this,o={actionName:I.REMOVE_ROW_DATA_ACTION,sheetId:r,rowCount:1,rowIndex:e},i={actionName:I.REMOVE_ROW_ACTION,sheetId:r,rowCount:1,rowIndex:e},a=new Y({WorkBookUnit:t.getWorkBook()},o,i);return s.invoke(a),this}deleteRows(e,t){const{_context:s,_commandManager:r,_sheetId:o}=this,i={actionName:I.REMOVE_ROW_DATA_ACTION,sheetId:o,rowCount:t,rowIndex:e},a={actionName:I.REMOVE_ROW_ACTION,sheetId:o,rowCount:t,rowIndex:e},c=new Y({WorkBookUnit:s.getWorkBook()},i,a);return r.invoke(c),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(e,t,s){const{_commandManager:r,_sheetId:o}=this,i=this.getContext(),a=this.getCellMatrix(),c=i.getWorkBook(),l=c.getStyles(),u=this.getRange({startRow:e.startRow-1,startColumn:e.startColumn,endRow:e.startRow-1,endColumn:e.endColumn}),h=this.getRange({startRow:e.startRow,startColumn:e.startColumn-1,endRow:e.startRow,endColumn:e.endColumn-1}),d=this.getRange({startRow:e.endRow+1,startColumn:e.startColumn,endRow:e.endRow+1,endColumn:e.endColumn}),f=this.getRange({startRow:e.startRow,startColumn:e.endColumn+1,endRow:e.startRow,endColumn:e.endColumn+1}),g=this.getRange(e),b=new ee,p=new ee,v=new ee,C=new ee,w=new ee;u.forEach((R,E)=>{const D=a.getValue(R,E);if(D){const M=l.getStyleByCell(D);if(M){const P=S.deepClone(M);P.bd&&delete P.bd.b,b.setValue(R,E,P)}}}),d.forEach((R,E)=>{const D=a.getValue(R,E);if(D){const M=l.getStyleByCell(D);if(M){const P=S.deepClone(M);P.bd&&delete P.bd.t,v.setValue(R,E,P)}}}),h.forEach((R,E)=>{const D=a.getValue(R,E);if(D){const M=l.getStyleByCell(D);if(M){const P=S.deepClone(M);P.bd&&delete P.bd.r,p.setValue(R,E,P)}}}),f.forEach((R,E)=>{const D=a.getValue(R,E);if(D){const M=l.getStyleByCell(D);if(M){const P=S.deepClone(M);P.bd&&delete P.bd.l,C.setValue(R,E,P)}}}),g.forEach((R,E)=>{w.setValue(R,E,t)});const x=[];if(s.includes(k.TOP)){const R={sheetId:o,actionName:I.SET_BORDER_ACTION,styles:v.toJSON()};x.push(R)}if(s.includes(k.BOTTOM)){const R={sheetId:o,actionName:I.SET_BORDER_ACTION,styles:b.toJSON()};x.push(R)}if(s.includes(k.LEFT)){const R={sheetId:o,actionName:I.SET_BORDER_ACTION,styles:C.toJSON()};x.push(R)}if(s.includes(k.RIGHT)){const R={sheetId:o,actionName:I.SET_BORDER_ACTION,styles:p.toJSON()};x.push(R)}const A={sheetId:o,actionName:I.SET_BORDER_ACTION,styles:w.toJSON()};x.push(A);const z=new Y({WorkBookUnit:c},...x);return r.invoke(z),this}setCurrentCell(e){return e.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex(s=>s&&s.getSheetId()===this._sheetId);return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(e){return this.getSelection().setSelection(e)}setActiveRangeList(e){const t=this.getSelection();return t.setSelection(e),t.getActiveRangeList()}hideRow(e){const t=e.getRangeData(),s=t.startRow,r=t.endRow-t.startRow+1,{_context:o,_commandManager:i,_sheetId:a}=this,c={actionName:I.SET_HIDE_ROW_ACTION,sheetId:a,rowCount:r,rowIndex:s},l=new Y({WorkBookUnit:o.getWorkBook()},c);return i.invoke(l),this}hideRows(...e){const t=--e[0];let s=1;e[1]&&(s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.SET_HIDE_ROW_ACTION,sheetId:i,rowCount:s,rowIndex:t},c=new Y({WorkBookUnit:r.getWorkBook()},a);return o.invoke(c),this}hideColumn(e){const t=e.getRangeData(),s=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:o,_commandManager:i,_sheetId:a}=this,c={actionName:I.SET_HIDE_COLUMN_ACTION,sheetId:a,columnCount:r,columnIndex:s},l=new Y({WorkBookUnit:o.getWorkBook()},c);return i.invoke(l),this}hideColumns(...e){const t=e[0];let s=1;e[1]&&(s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.SET_HIDE_COLUMN_ACTION,sheetId:i,columnCount:s,columnIndex:t},c=new Y({WorkBookUnit:r.getWorkBook()},a);return o.invoke(c),this}unhideRow(e){const t=e.getRangeData(),s=t.startRow,r=t.endRow-t.startRow+1,{_context:o,_commandManager:i,_sheetId:a}=this,c={actionName:I.SET_SHOW_ROW_ACTION,sheetId:a,rowCount:r,rowIndex:s},l=new Y({WorkBookUnit:o.getWorkBook()},c);return i.invoke(l),this}unhideColumn(e){const t=e.getRangeData(),s=t.startColumn,r=t.endColumn-t.startColumn+1,{_context:o,_commandManager:i,_sheetId:a}=this,c={actionName:I.SET_SHOW_COLUMN_ACTION,sheetId:a,columnCount:r,columnIndex:s},l=new Y({WorkBookUnit:o.getWorkBook()},c);return i.invoke(l),this}showColumns(...e){const t=e[0];let s=1;e[1]&&(s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.SET_SHOW_COLUMN_ACTION,sheetId:i,columnCount:s,columnIndex:t},c=new Y({WorkBookUnit:r.getWorkBook()},a);return o.invoke(c),this}showRows(...e){const t=--e[0];let s=1;e[1]&&(s=e[1]);const{_context:r,_commandManager:o,_sheetId:i}=this,a={actionName:I.SET_SHOW_ROW_ACTION,sheetId:i,rowCount:s,rowIndex:t},c=new Y({WorkBookUnit:r.getWorkBook()},a);return o.invoke(c),this}hasHiddenGridlines(){const{_config:e}=this,{showGridlines:t}=e;return t===0}getTabColor(){const{_config:e}=this,{tabColor:t}=e;return t}getColumnWidth(e){return this.getColumnManager().getColumnWidth(e)}getRowHeight(e){return this.getRowManager().getRowHeight(e)}setColumnWidth(...e){let t,s=[];if(S.hasLength(e,2)&&(t=e[0],s=[e[1]]),S.hasLength(e,3)){t=e[0];for(let r=0;r<e[1];r++)s.push(e[2])}return this.getColumnManager().setColumnWidth(t,s),this}setRowHeights(e,t,s){const r=[];for(let o=0;o<t;o++)r.push(s);return this.getRowManager().setRowHeight(e,r),this}setRowHeight(e,t){const s=[t];return this.getRowManager().setRowHeight(e,s),this}setHiddenGridlines(e){const{_context:t,_commandManager:s,_sheetId:r}=this,o={actionName:I.SET_HIDDEN_GRIDLINES_ACTION,hideGridlines:e,sheetId:r},i=new Y({WorkBookUnit:t.getWorkBook()},o);return s.invoke(i),this}isRightToLeft(){const{_config:e}=this,{rightToLeft:t}=e;return t}setRightToLeft(e){const{_context:t,_commandManager:s,_sheetId:r}=this,o={actionName:I.SET_RIGHT_TO_LEFT_ACTION,rightToLeft:e,sheetId:r},i=new Y({WorkBookUnit:t.getWorkBook()},o);return s.invoke(i),this}getPluginMeta(e){return this._config.pluginMeta[e]}setPluginMeta(e,t){this._config.pluginMeta[e]=t}copyTo(e){const t=this._context.getWorkBook().getSheets()[e];if(!t)return this;const s=S.deepClone(this._config);return s.sheetId=t.getConfig().id,t.setConfig(s),t}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(e,t,s,r){return new ke(this,{startRow:e,startColumn:t,endRow:e+s-1,endColumn:t+r-1}).getValues()}getDataRange(){return new ke(this,this._cellData.getRange())}moveRows(e,t){const{startRow:s}=e.getRangeData(),{endRow:r}=e.getRangeData(),o=this._cellData.spliceRows(s,r-s+1);return this._cellData.insertRows(t,o),this}moveColumns(e,t){const s=e.getRangeData().startColumn,r=e.getRangeData().endColumn,o=this._cellData.spliceColumns(s,r-s+1);return this._cellData.insertColumns(t,o),this}}class ke{static foreach(e,t){const{startRow:s,startColumn:r,endRow:o,endColumn:i}=e;for(let a=s;a<=o;a++)for(let c=r;c<=i;c++)t(a,c)}constructor(e,t){this._context=e.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(t).rangeData,this._worksheet=e,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:e,endRow:t,startColumn:s,endColumn:r}=this._rangeData,o=[];for(let i=e;i<=t;i++){const a=[];for(let c=s;c<=r;c++)a.push(this.getMatrix().getValue(i,c)||null);o.push(a)}return o}getMatrix(){const{startRow:e,endRow:t,startColumn:s,endColumn:r}=this._rangeData,o=this._worksheet.getCellMatrix(),i=new ee;for(let a=e;a<=t;a++)for(let c=s;c<=r;c++)i.setValue(a,c,o.getValue(a,c)||null);return i}getMatrixObject(){const{startRow:e,endRow:t,startColumn:s,endColumn:r}=this._rangeData,o=this._worksheet.getCellMatrix(),i=new ee;for(let a=e;a<=t;a++)for(let c=s;c<=r;c++)i.setValue(a-e,c-s,o.getValue(a,c)||{});return i}getDisplayValue(){const e=this.getValue();return e&&e.p?e.p:e&&e.m?e.m:""}getDisplayValues(){return this.getValues().map(e=>e.map(t=>t&&t.p?t.p:t&&t.m?t.m:""))}getA1Notation(){const{startRow:e,endRow:t,startColumn:s,endColumn:r}=this._rangeData;let o,i;return s<r?(o=S.numToWord(s+1)+(e+1),i=S.numToWord(r+1)+(t+1)):(o=S.numToWord(r+1)+(t+1),i=S.numToWord(s+1)+(e+1)),o===i?`${o}`:`${o}:${i}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map(e=>e.map(t=>{var o,i,a;const s=this._context.getWorkBook().getStyles();let r=(o=Ps.bg)==null?void 0:o.rgb;return r=(a=(i=s.getStyleByCell(t))==null?void 0:i.bg)==null?void 0:a.rgb,r}))}getCell(e,t){const{startRow:s,endRow:r,startColumn:o,endColumn:i}=this._rangeData,a={startRow:s+e,endRow:s+e,startColumn:o+t,endColumn:o+t};return new ke(this._worksheet,a)}getColumn(){return this._rangeData.startColumn}getObjectValue(e={}){return this.getObjectValues(e)[0][0]}getObjectValues(e={}){const{startRow:t,endRow:s,startColumn:r,endColumn:o}=this._rangeData,i=this._worksheet.getCellMatrix().getFragments(t,s,r,o).getData();if(e.isIncludeStyle){const a=this._context.getWorkBook().getStyles();for(let c=0;c<=s-t;c++)for(let l=0;l<=o-r;l++){if(!i[c][l])continue;const u=i[c][l].s;u&&(i[c][l].s=a.get(u))}}return i}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map(e=>e.map(t=>{var o,i;const r=this._context.getWorkBook().getStyles().getStyleByCell(t);return((o=r==null?void 0:r.cl)==null?void 0:o.rgb)||((i=Ps.cl)==null?void 0:i.rgb)}))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}_getStyles(e){return this.getValues().map(t=>t.map(s=>{const r=this._context.getWorkBook().getStyles(),o=r&&r.getStyleByCell(s);return o&&o[e]||Ps[e]}))}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:e,_worksheet:t}=this,{startRow:s,endRow:r}=e;let o=0;for(let i=0;i<=r-s;i++)o+=t.getRowHeight(i);return o}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:e,endRow:t,startColumn:s,endColumn:r}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:e,endRow:t,startColumn:s,endColumn:r}).map(o=>new ke(this._worksheet,o))}getNextDataCell(e){const{_worksheet:t}=this,{startRow:s,endRow:r,startColumn:o,endColumn:i}=this._rangeData,a=t.getMaxRows(),c=t.getMaxColumns();if(e===k.BOTTOM){for(let l=0;l<a-o;l++)this._worksheet.getCellMatrix().getValue(s+l,o)&&t.getRange(s+l,o,s+l,o);return t.getRange(a,o,a,o)}if(e===k.TOP){for(let l=0;l<s;l++)this._worksheet.getCellMatrix().getValue(s-l,o)&&t.getRange(s-l,o,s-l,s);return t.getRange(0,o,0,o)}if(e===k.RIGHT){for(let l=0;l<c-o;l++)this._worksheet.getCellMatrix().getValue(s,o+l)&&t.getRange(s,o+l,s,o+l);return t.getRange(s,c,s,c)}if(e===k.LEFT){for(let l=0;l<a-o;l++)this._worksheet.getCellMatrix().getValue(s,o-l)&&t.getRange(s,o-l,s,o-l);return t.getRange(s,0,s,0)}return t.getRange($c)}getNumColumns(){const{startColumn:e,endColumn:t}=this._rangeData;return t-e+1}getNumRows(){const{startRow:e,endRow:t}=this._rangeData;return t-e+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map(e=>e.map(t=>(t==null?void 0:t.p)||""))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map(e=>e.map(t=>this._context.getWorkBook().getStyles().getStyleByCell(t)))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:e,_worksheet:t}=this,{startColumn:s,endColumn:r}=e;let o=0;for(let i=0;i<=r-s;i++)o+=t.getColumnWidth(i);return o}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some(t=>t.some(s=>(s==null?void 0:s.m)===""))}isPartOfMerge(){const{startRow:e,endRow:t,startColumn:s,endColumn:r}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(e,t,s,r)}_setStyle(e,t){const{_context:s,_worksheet:r,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:c,endColumn:l}=this._rangeData,u={[t]:e},h=S.fillObjectMatrix(a-i+1,l-c+1,u),d={sheetId:r.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},f=new Y({WorkBookUnit:s.getWorkBook()},d);return o.invoke(f),this}_setStyles(e,t){const{_context:s,_worksheet:r,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:c,endColumn:l}=this._rangeData,u=new ee;for(let f=0;f<a-i+1;f++)for(let g=0;g<l-c+1;g++)u.setValue(f,g,{[t]:e[f][g]});const h={sheetId:r.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u.getData(),rangeData:this._rangeData},d=new Y({WorkBookUnit:s.getWorkBook()},h);return o.invoke(d),this}setBackground(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={bg:{rgb:e}},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setBackgrounds(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l=new ee;for(let d=0;d<i-o+1;d++)for(let f=0;f<c-a+1;f++)l.setValue(d,f,{bg:{rgb:e[d][f]}});const u={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},h=new Y({WorkBookUnit:t.getWorkBook()},u);return r.invoke(h),this}setBackgroundRGB(e,t,s){const{_context:r,_worksheet:o,_commandManager:i}=this,{startRow:a,endRow:c,startColumn:l,endColumn:u}=this._rangeData,d={bg:{rgb:`RGB(${e},${t},${s})`}},f=S.fillObjectMatrix(c-a+1,u-l+1,d),g={sheetId:o.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:f,rangeData:this._rangeData},b=new Y({WorkBookUnit:r.getWorkBook()},g);return i.invoke(b),this}setFontColors(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l=new ee;for(let d=0;d<i-o+1;d++)for(let f=0;f<c-a+1;f++)l.setValue(d,f,{cl:{rgb:e[d][f]}});const u={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},h=new Y({WorkBookUnit:t.getWorkBook()},u);return r.invoke(h),this}setFontFamilies(e){return this._setStyles(e,"ff"),this}setUnderline(e){return this._setStyle(e,"ul"),this}setOverline(e){return this._setStyle(e,"ol"),this}setStrikeThrough(e){return this._setStyle(e,"st"),this}setUnderlines(e){return this._setStyles(e,"ul"),this}setOverlines(e){return this._setStyles(e,"ol"),this}setStrikeThroughs(e){return this._setStyles(e,"st"),this}setFontSizes(e){return this._setStyles(e,"fs"),this}setFontStyle(e){return this._setStyle(e,"it"),this}setFontStyles(e){return this._setStyles(e,"it"),this}setFontWeight(e){return this._setStyle(e,"bl"),this}setFontWeights(e){return this._setStyles(e,"bl"),this}setFormula(e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,{startRow:i,startColumn:a,endRow:c,endColumn:l}=t,u=new ee;for(let f=i;f<=c;f++)for(let g=a;g<=l;g++)u.setValue(f,g,e);const h={sheetId:o.getSheetId(),actionName:I.SET_RANGE_FORMULA_ACTION,cellFormula:u.getData(),rangeData:this._rangeData},d=new Y({WorkBookUnit:s.getWorkBook()},h);return r.invoke(d),this}setFormulas(e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,{startRow:i,startColumn:a,endRow:c,endColumn:l}=t,u=new ee;for(let f=0;f<=c-i;f++)for(let g=0;g<=l-a;g++)u.setValue(f+i,g+a,e[f][g]);const h={sheetId:o.getSheetId(),actionName:I.SET_RANGE_FORMULA_ACTION,cellFormula:u.getData(),rangeData:this._rangeData},d=new Y({WorkBookUnit:s.getWorkBook()},h);return r.invoke(d),this}setHorizontalAlignments(e){return this._setStyles(e,"ht"),this}setTextDirections(e){return this._setStyles(e,"td"),this}setTextRotation(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={tr:{v:0,a:Number(e)}},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setTextRotations(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l=new ee;for(let d=0;d<i-o+1;d++)for(let f=0;f<c-a+1;f++)l.setValue(d,f,{tr:{v:0,a:e[d][f]}});l.getData();const u={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},h=new Y({WorkBookUnit:t.getWorkBook()},u);return r.invoke(h),this}setTextStyle(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={...e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setTextStyles(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l=new ee;for(let d=0;d<i-o+1;d++)for(let f=0;f<c-a+1;f++)l.setValue(d,f,{...e[d][f]});const u={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},h=new Y({WorkBookUnit:t.getWorkBook()},u);return r.invoke(h),this}setVerticalAlignments(e){return this._setStyles(e,"vt"),this}setVerticalText(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={tr:{v:e,a:90}},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setWrap(e){return this._setStyle(e,"tb"),this}setWrapStrategies(e){return this._setStyles(e,"tb"),this}setWraps(e){return this._setStyles(e,"tb"),this}autoFill(e,t){const{_worksheet:s,_context:r,_commandManager:o}=this,{startRow:i,endRow:a,startColumn:c,endColumn:l}=this._rangeData,{startRow:u,endRow:h,startColumn:d,endColumn:f}=e._rangeData;let g=k.BOTTOM,b=0,p=0;const v=i,C=a,w=c,x=l,A=u,z=h,R=d,E=f,D=new ee;if(R===w&&E===x?z>C?g=k.BOTTOM:g=k.TOP:E>x?g=k.RIGHT:g=k.LEFT,g===k.BOTTOM||g===k.TOP){b=C-v+1,p=z-A+1;for(let G=0;G<=l-c;G++){const T=this.getColumnMatrix(G).toArray();Bs.getCopyData(T,v,C,w,x,g).forEach(O=>{Bs.getApplyData(O,b,p,t,g).forEach((B,X)=>{D.setValue(X,G,B)})})}}else if(g===k.RIGHT||g===k.LEFT){p=E-R,b=x-w;for(let G=0;G<=a-i;G++){const T=this.getRowMatrix(G).toArray();Bs.getCopyData(T,v,C,w,x,g).forEach(O=>{Bs.getApplyData(O,b,p,t,g)})}}const M={sheetId:s.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:D.getData()},P=new Y({WorkBookUnit:r.getWorkBook()},M);return o.invoke(P),this}getDataRegion(...e){const{startRow:t,endRow:s,startColumn:r,endColumn:o}=this._rangeData;let i,a;const c=this._worksheet.getCellMatrix();if(S.isNumber(e[0])){const l=e[0];if(l===wn.COLUMNS){let u=t,h=t;const d=this._worksheet.getRowCount();for(let g=1;g<t;g++)if(!c.getValue(t-g,r)){u=t-g+1;break}const f=0;for(;f<d-t;)if(!c.getValue(t+f,r)){h=t-f-1;break}return a=u-h,i=0,this._worksheet.getRange(t,u,i,a)}if(l===wn.ROWS){let u=t,h=t;const d=this._worksheet.getColumnCount();for(let g=1;g<t;g++)if(!c.getValue(t,r-g)){u=t-g+1;break}const f=0;for(;f<d-r;)if(!c.getValue(t,r+f)){h=t-f-1;break}return a=0,i=u-h,this._worksheet.getRange(u,r,i,a)}}else{let l=t,u=t;const h=this._worksheet.getRowCount();for(let v=1;v<t;v++)if(!c.getValue(t-v,r)){l=t-v+1;break}const d=0;for(;d<h-t;)if(!c.getValue(t+d,r)){u=t-d-1;break}let f=t,g=t;const b=this._worksheet.getColumnCount();for(let v=1;v<t;v++)if(!c.getValue(t,r-v)){f=t-v+1;break}const p=0;for(;p<b-r;)if(!c.getValue(t,r+p)){g=t-p-1;break}return a=f-g,a=l-u,i=t,this._worksheet.getRange(l,f,i,a)}return this}trimWhitespace(){var f;const{_context:e,_worksheet:t,_commandManager:s}=this,{startRow:r,endRow:o,startColumn:i,endColumn:a}=this._rangeData,c=this._worksheet.getCellMatrix(),l=/\s+/g,u=new ee;for(let g=0;g<=o-r;g++)for(let b=0;b<=a-i;b++){const p=(f=c.getValue(g,b).m)==null?void 0:f.replace(l,"");u.setValue(g+r,b+i,p||"")}const h={sheetId:t.getSheetId(),actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:this._rangeData},d=new Y({WorkBookUnit:e.getWorkBook()},h);return s.invoke(d),this}activate(){var e;return((e=this._rangeData)==null?void 0:e.startRow)===-1?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(e){const t=this._rangeData.startRow,s=this._rangeData.endRow,r=this._rangeData.startColumn,o=this._rangeData.endColumn,i=e.getRangeData().startRow,a=e.getRangeData().endRow,c=e.getRangeData().startColumn,l=e.getRangeData().endColumn,u=Math.abs(r+o-c-l),h=Math.abs(r-o)+Math.abs(c-l),d=Math.abs(t+s-i-a),f=Math.abs(t-s)+Math.abs(i-a);return u<=h&&d<=f}setFontColor(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={cl:{rgb:e}},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}copyTo(...e){const{_context:t,_worksheet:s,_commandManager:r}=this,o=e[0],[i,a]=this._handleCopyRange(this,o),{startRow:c,startColumn:l,endRow:u,endColumn:h}=a;if(Ie.checkup(e,ke,Ie.BOOLEAN_TYPE)){const d=e[1];if(e[2],d===ts.PASTE_NORMAL){const f=new ee;i.forEach((p,v)=>p.forEach((C,w)=>{C=C,f.setValue(v+c,w+l,C||{})}));const g={sheetId:s.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:f.getData()},b=new Y({WorkBookUnit:t.getWorkBook()},g);r.invoke(b)}else if(d===ts.PASTE_FORMAT){const f=t.getWorkBook().getStyles(),g=new ee;i.map((v,C)=>v.forEach((w,x)=>{w=w,g.setValue(C,x,f.getStyleByCell(w)||{})}));const b={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:g.getData(),rangeData:a},p=new Y({WorkBookUnit:t.getWorkBook()},b);r.invoke(p)}else if(d===ts.PASTE_VALUES){const f=new ee;i.forEach((p,v)=>p.forEach((C,w)=>{C=C,f.setValue(v+c,w+l,(C==null?void 0:C.v)||"")}));const g={sheetId:s.getSheetId(),actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:f.getData(),rangeData:a},b=new Y({WorkBookUnit:t.getWorkBook()},g);r.invoke(b)}else if(d===ts.PASTE_COLUMN_WIDTHS){const f=this._rangeData.startColumn;for(let g=0;g<h-f;g++){const b=s.getColumnWidth(f+g);s.setColumnWidth(f+g,b)}}}else if(Ie.checkup(e,ke,Ie.OBJECT_TYPE)){const d=e[1],f=new ee;i.forEach((p,v)=>p.forEach((C,w)=>{C=C,f.setValue(v+c,w+l,C||{})}));const g={sheetId:s.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:f.getData(),options:d},b=new Y({WorkBookUnit:t.getWorkBook()},g);r.invoke(b)}else if(Ie.checkup(e,ke)){const d=new ee;i.forEach((b,p)=>b.forEach((v,C)=>{v=v,d.setValue(p+c,C+l,v||{})}));const f={sheetId:s.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:d.getData()},g=new Y({WorkBookUnit:t.getWorkBook()},f);r.invoke(g)}}copyFormatToRange(...e){const{_context:t,_commandManager:s}=this,r=e[1],o=e[2],i=e[3],a=e[4],c=S.isAssignableFrom(e[0],Un)?e[0].getSheetId():e[0],[l,u]=this._handleCopyRange(this,{startRow:r,endRow:o,startColumn:i,endColumn:a}),h=t.getWorkBook().getStyles(),d=new ee;l.map((b,p)=>b.map((v,C)=>(v=v,d.setValue(p,C,h.getStyleByCell(v)||{}),h.getStyleByCell(v)||{})));const f={sheetId:c,actionName:I.SET_RANGE_STYLE_ACTION,value:d.getData(),rangeData:u},g=new Y({WorkBookUnit:t.getWorkBook()},f);s.invoke(g)}copyValuesToRange(...e){const{_context:t,_commandManager:s}=this,r=e[1],o=e[2],i=e[3],a=e[4],c=S.isAssignableFrom(e[0],Un)?e[0].getSheetId():e[0],[l,u]=this._handleCopyRange(this,{startRow:r,endRow:o,startColumn:i,endColumn:a}),h=new ee;l.forEach((g,b)=>g.forEach((p,v)=>{p=p,h.setValue(b+u.startRow,v+u.startColumn,(p==null?void 0:p.v)||"")}));const d={sheetId:c,actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:u},f=new Y({WorkBookUnit:t.getWorkBook()},d);s.invoke(f)}moveTo(e){const{_context:t,_worksheet:s,_commandManager:r,_rangeData:o}=this,i={formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},a={sheetId:s.getSheetId(),actionName:I.CLEAR_RANGE_ACTION,options:i,rangeData:o},c=this.getMatrix(),{startRow:l,endRow:u,startColumn:h,endColumn:d}=this._rangeData,{startRow:f,startColumn:g}=e.getRangeData(),b=new ee;for(let C=l;C<=u;C++)for(let w=h;w<=d;w++)b.setValue(f+(C-l),g+(w-h),c.getValue(C,w)||{});const p={sheetId:s.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:b.getData()},v=new Y({WorkBookUnit:t.getWorkBook()},a,p);r.invoke(v)}offset(...e){const{startRow:t,endRow:s,startColumn:r,endColumn:o}=this._rangeData,i=e[0],a=e[1],c=e[2],l=e[3],u={startRow:t+i,endRow:s+i,startColumn:r+a,endColumn:o+a};return S.isNumber(c)&&(u.endRow=u.startRow+c-1),S.isNumber(l)&&(u.endColumn=u.endColumn+l-1),new ke(this._worksheet,u)}setBorder(...e){const t=e[0],s=e[1],r=e[2],o=e[3],i=e[4],a=e[5],c=e[6]?e[6]:"black",l=e[7]?e[7]:_.DASH_DOT,{_context:u,_worksheet:h,_commandManager:d}=this,f=u.getWorkBook(),g=this._rangeData,b=h.getSheetId(),p={startRow:g.startRow-1,startColumn:g.startColumn,endRow:g.startRow-1,endColumn:g.endColumn},v={startRow:g.startRow,startColumn:g.startColumn-1,endRow:g.endRow,endColumn:g.startColumn-1},C={startRow:g.endRow+1,startColumn:g.startColumn,endRow:g.endRow+1,endColumn:g.endColumn},w={startRow:g.startRow,startColumn:g.endColumn+1,endRow:g.endRow,endColumn:g.endColumn+1},x={startRow:g.startRow,startColumn:g.startColumn,endRow:g.startRow,endColumn:g.endColumn},A={startRow:g.startRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.startColumn},z={startRow:g.endRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.endColumn},R={startRow:g.startRow,startColumn:g.endColumn,endRow:g.endRow,endColumn:g.endColumn},E=new ke(h,p),D=new ke(h,v),M=new ke(h,C),P=new ke(h,w),G=new ke(h,x),T=new ke(h,A),y=new ke(h,z),O=new ke(h,R),U=new ee,B=new ee,X=new ee,J=new ee,$=new ee,te=[],re={s:l,cl:{rgb:c}};if(t===!0||t===!1){if(E.isValid()){E.forEach((ne,oe)=>{U.setValue(ne,oe,{bd:{b:null}})});const Z={sheetId:b,actionName:I.SET_RANGE_STYLE_ACTION,value:U.getArrayData(),rangeData:p};te.push(Z)}G.forEach((Z,ne)=>{if(t===!0){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{t:S.deepClone(re)}});$.setValue(Z,ne,oe)}else if(t===!1){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{t:null}});$.setValue(Z,ne,oe)}})}if(r===!0||r===!1){if(M.isValid()){M.forEach((ne,oe)=>{X.setValue(ne,oe,{bd:{t:null}})});const Z={sheetId:b,actionName:I.SET_RANGE_STYLE_ACTION,value:X.getArrayData(),rangeData:C};te.push(Z)}y.forEach((Z,ne)=>{if(r===!0){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{b:S.deepClone(re)}});$.setValue(Z,ne,oe)}else if(r===!1){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{b:null}});$.setValue(Z,ne,oe)}})}if(s===!0||s===!1){if(D.isValid()){D.forEach((ne,oe)=>{B.setValue(ne,oe,{bd:{r:null}})});const Z={sheetId:b,actionName:I.SET_RANGE_STYLE_ACTION,value:B.getArrayData(),rangeData:v};te.push(Z)}T.forEach((Z,ne)=>{if(s===!0){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{l:S.deepClone(re)}});$.setValue(Z,ne,oe)}else if(s===!1){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{l:null}});$.setValue(Z,ne,oe)}})}if(o===!0||o===!1){if(P.isValid()){P.forEach((ne,oe)=>{J.setValue(ne,oe,{bd:{l:null}})});const Z={sheetId:b,actionName:I.SET_RANGE_STYLE_ACTION,value:J.getArrayData(),rangeData:w};te.push(Z)}O.forEach((Z,ne)=>{if(o===!0){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{r:S.deepClone(re)}});$.setValue(Z,ne,oe)}else if(o===!1){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{r:null}});$.setValue(Z,ne,oe)}})}(i===!0||i===!1)&&this.forEach((Z,ne)=>{if(ne!==g.endColumn){if(i===!0){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{r:S.deepClone(re)}});$.setValue(Z,ne,oe)}else if(i===!1){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{r:null}});$.setValue(Z,ne,oe)}}if(ne!==g.startColumn){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{l:null}});$.setValue(Z,ne,oe)}}),(a===!0||a===!1)&&this.forEach((Z,ne)=>{if(Z!==g.endRow){if(a===!0){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{b:S.deepClone(re)}});$.setValue(Z,ne,oe)}else if(a===!1){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{b:null}});$.setValue(Z,ne,oe)}}if(Z!==g.startRow){const oe=S.deepMerge($.getValue(Z,ne)||{},{bd:{t:null}});$.setValue(Z,ne,oe)}});const Te={sheetId:b,actionName:I.SET_RANGE_STYLE_ACTION,value:$.getArrayData(),rangeData:$.getDataRange()};te.push(Te);const _e=new Y({WorkBookUnit:f},...te);return d.invoke(_e),this}setBorderByType(e,t,s){let r=null,o=null,i=null,a=null,c=null,l=null;switch(e){case vt.TOP:r=!0;break;case vt.BOTTOM:i=!0;break;case vt.LEFT:o=!0;break;case vt.RIGHT:a=!0;break;case vt.NONE:r=!1,o=!1,i=!1,a=!1,c=!1,l=!1;break;case vt.ALL:r=!0,o=!0,i=!0,a=!0,c=!0,l=!0;break;case vt.OUTSIDE:r=!0,o=!0,i=!0,a=!0;break;case vt.INSIDE:c=!0,l=!0;break;case vt.HORIZONTAL:l=!0;break;case vt.VERTICAL:c=!0;break}this.setBorder(r,o,i,a,c,l,t,s)}setFontFamily(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={ff:e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setFontSize(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={fs:e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setHorizontalAlignment(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={ht:e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setVerticalAlignment(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={vt:e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setTextDirection(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={td:e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setWrapStrategy(e){const{_context:t,_worksheet:s,_commandManager:r}=this,{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l={tb:e},u=S.fillObjectMatrix(i-o+1,c-a+1,l),h={sheetId:s.getSheetId(),actionName:I.SET_RANGE_STYLE_ACTION,value:u,rangeData:this._rangeData},d=new Y({WorkBookUnit:t.getWorkBook()},h);return r.invoke(d),this}setValue(e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,{startRow:i,startColumn:a,endRow:c,endColumn:l}=t,u=new ee;for(let f=i;f<=c;f++)for(let g=a;g<=l;g++)u.setValue(f,g,e);const h={sheetId:o.getSheetId(),actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:u.getData(),rangeData:this._rangeData},d=new Y({WorkBookUnit:s.getWorkBook()},h);return r.invoke(d),this}setValues(...e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,i=e[0];if(Ie.checkup(e,Array)){const{startRow:a,startColumn:c,endRow:l,endColumn:u}=t,h=new ee;for(let g=0;g<=l-a;g++)for(let b=0;b<=u-c;b++)h.setValue(g+a,b+c,i[g][b]);const d={sheetId:o.getSheetId(),actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},f=new Y({WorkBookUnit:s.getWorkBook()},d);r.invoke(f)}else if(Ie.checkup(e,ee)){const a={sheetId:o.getSheetId(),actionName:I.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:i,rangeData:this._rangeData},c=new Y({WorkBookUnit:s.getWorkBook()},a);r.invoke(c)}return this}setRangeData(e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,{startRow:i,startColumn:a}=t,c={sheetId:o.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:{[i]:{[a]:e}}},l=new Y({WorkBookUnit:s.getWorkBook()},c);return r.invoke(l),this}setRangeDatas(...e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,i=e[0];if(Ie.checkup(e,Array)){const{startRow:a,startColumn:c,endRow:l,endColumn:u}=t,h=new ee;for(let g=0;g<=l-a;g++)for(let b=0;b<=u-c;b++)h.setValue(g+a,b+c,i[g][b]);const d={sheetId:o.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:h.getData()},f=new Y({WorkBookUnit:s.getWorkBook()},d);r.invoke(f)}else if(Ie.checkup(e,ee)){const a={sheetId:o.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:i},c=new Y({WorkBookUnit:s.getWorkBook()},a);r.invoke(c)}return this}clear(...e){const{_context:t,_worksheet:s,_commandManager:r,_rangeData:o}=this;let i={formatOnly:!0,contentsOnly:!0};Ie.checkup(e,Ie.OBJECT_TYPE)&&(i=e[0]);const a={sheetId:s.getSheetId(),actionName:I.CLEAR_RANGE_ACTION,options:i,rangeData:o},c=new Y({WorkBookUnit:t.getWorkBook()},a);return r.invoke(c),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}deleteCells(e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this,i={sheetId:o.getSheetId(),actionName:I.DELETE_RANGE_ACTION,shiftDimension:e,rangeData:t},a=new Y({WorkBookUnit:s.getWorkBook()},i);r.invoke(a)}insertCells(...e){const t=e[0],s=e[1],{_rangeData:r,_context:o,_commandManager:i,_worksheet:a}=this,{startRow:c,endRow:l,startColumn:u,endColumn:h}=this._rangeData;let d=this._rangeData,f=new ee;if(s){f=s.getMatrixObject();const p=s.getRangeData();d={startRow:c,endRow:c+p.endRow-p.startRow,startColumn:u,endColumn:c+p.endColumn-p.startColumn}}else for(let p=c;p<=l;p++)for(let v=u;v<=h;v++)f.setValue(p,v,{m:"",v:""});const g={sheetId:a.getSheetId(),actionName:I.INSERT_RANGE_ACTION,shiftDimension:t,rangeData:d,cellValue:f.getData()},b=new Y({WorkBookUnit:o.getWorkBook()},g);return i.invoke(b),this}merge(){const{_worksheet:e}=this,t=e.getContext(),s=e.getSheetId(),r=e.getCommandManager(),o={actionName:I.ADD_MERGE_ACTION,sheetId:s,rectangles:[this._rangeData]},i=new Y({WorkBookUnit:t.getWorkBook()},o);return r.invoke(i),this}mergeAcross(){const{_worksheet:e}=this,t=e.getCommandManager(),s=e.getContext(),r=e.getSheetId(),{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l=[];for(let d=o;d<=i;d++){const f={startRow:d,endRow:d,startColumn:a,endColumn:c};l.push(f)}const u={actionName:I.ADD_MERGE_ACTION,sheetId:r,rectangles:l},h=new Y({WorkBookUnit:s.getWorkBook()},u);return t.invoke(h),this}mergeVertically(){const{_worksheet:e}=this,t=e.getCommandManager(),s=e.getContext(),r=e.getSheetId(),{startRow:o,endRow:i,startColumn:a,endColumn:c}=this._rangeData,l=[];for(let d=a;d<=c;d++){const f={startRow:o,endRow:i,startColumn:d,endColumn:d};l.push(f)}const u={actionName:I.ADD_MERGE_ACTION,sheetId:r,rectangles:l},h=new Y({WorkBookUnit:s.getWorkBook()},u);return t.invoke(h),this}breakApart(){const{_worksheet:e}=this,t=e.getCommandManager(),s=e.getContext(),r=e.getSheetId(),o=this._worksheet.getMerges().getMergedRanges(this._rangeData),i={actionName:I.REMOVE_MERGE_ACTION,sheetId:r,rectangles:o},a=new Y({WorkBookUnit:s.getWorkBook()},i);return t.invoke(a),this}removeDuplicates(...e){const{_rangeData:t,_context:s,_commandManager:r,_worksheet:o}=this;Array.isArray(e[0])&&e[0];const i=this.getMatrix().getData(),a=[];for(let d=0;d<=t.endColumn-t.startColumn;d++){const f=[],g={},b=this.getColumnMatrix(d).getData();for(const p in b){const v=b[p][d].m;g.hasOwnProperty(v)||(g[v]=1,f.push(d))}a.push(f)}const c=Array.from(new Set(a.flat())),l={};c.forEach((d,f)=>{l[f]=i[d]});const u=[{sheetId:o.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:l}],h=new Y({WorkBookUnit:s.getWorkBook()},...u);return r.invoke(h),this}getRowMatrix(e){const{startColumn:t,endColumn:s}=this._rangeData,r=this._worksheet.getCellMatrix(),o=new ee;for(let i=e;i<=e;i++)for(let a=t;a<=s;a++)o.setValue(i,a,r.getValue(i,a)||{});return o}getColumnMatrix(e){const{startRow:t,endRow:s}=this._rangeData,r=this._worksheet.getCellMatrix(),o=new ee;for(let i=t;i<=s;i++)for(let a=e;a<=e;a++)o.setValue(i,a,r.getValue(i,a)||{});return o}_handleCopyRange(...e){const t=e[0];let s=e[1];s=Ie.checkup(e,ke,ke)?s.getRangeData():s;const r=t._worksheet.getCellMatrix(),{startRow:o,endRow:i,startColumn:a,endColumn:c}=t.getRangeData();let{startRow:l,endRow:u,startColumn:h,endColumn:d}=s;const f=i-o+1,g=c-a+1,b=u-l+1,p=d-h+1;let v=[],C;if(b%f===0&&p%g===0){for(let w=0;w<b;w++){const x=[];for(let A=0;A<p;A++){const z=r.getValue((w+o)%f,(A+a)%g)||{};x.push(z)}v.push(x)}C=s}else v=r.getFragments(o,i,a,c).getData(),u+=f-b,d+=g-p,C={startRow:l,endRow:u,startColumn:h,endColumn:d};return[v,C]}forEach(e){ke.foreach(this._rangeData,e)}randomize(){const{_context:e,_worksheet:t,_commandManager:s,_rangeData:r}=this,{startRow:o,startColumn:i}=r,a=new ee;S.randSort(this.getMatrix().toArray()).forEach((h,d)=>h.forEach((f,g)=>{f=f,a.setValue(d+o,g+i,f||{})}));const l={sheetId:t.getSheetId(),actionName:I.SET_RANGE_DATA_ACTION,cellValue:a.getData()},u=new Y({WorkBookUnit:e.getWorkBook()},l);s.invoke(u)}isValid(){return!Object.values(this._rangeData).includes(-1)}}function bn(n){if(n){if(n.rgb)return n.rgb;if(n.th)return new ur().setThemeColor(n.th).asThemeColor().asRgbColor().getCssString()}return null}function Wu(n,...e){for(const t of e)if(t)for(const s in t)t.hasOwnProperty(s)&&Vu(t[s])&&(n[s]=t[s]);return n}function Vu(n){return n!=null}function Gu(n){return Object.prototype.toString.apply(n)==="[object String]"}function $u(n){return n?Object.getPrototypeOf(n)===Object.getPrototypeOf({}):!1}function Yu(n){return Object.prototype.toString.apply(n)==="[object Array]"}function di(n){return n instanceof FormData}const Ar=()=>{},fi=n=>n,Xu={type:"POST",url:"",async:!0,header:{},dataType:"json",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:Ar,beforeSend:fi,dataFilter:fi,success:Ar,complete:Ar};function gi(n){return new Promise((e,t)=>{const s=Wu({},Xu,n),r=new XMLHttpRequest;switch(s.beforeSend(s),r.responseType=s.dataType,r.timeout=s.timeout,r.addEventListener("readystatechange",o=>{if(r.readyState===4)if(r.status===200){const i=s.dataFilter(r.response);s.success(i),s.complete(),e(i)}else s.error(o),t(o)}),r.addEventListener("timeout",o=>{s.error(o)}),r.open(s.type,s.url,s.async,s.username,s.password),Object.keys(s.header).forEach(o=>{const i=s.header[o];r.setRequestHeader(o,i)}),di(s.data)?r.setRequestHeader("Content-Type","multipart/form-data"):s.contentType&&r.setRequestHeader("Content-Type",s.contentType),s.type){case"DELETE":case"GET":{r.send();break}case"POST":case"PUT":{if($u(s.data)){r.send(JSON.stringify(s.data));return}if(Gu(s.data)){r.send(s.data);return}if(Yu(s.data)){r.send(JSON.stringify(s.data));return}di(s.data)&&r.send(s.data);break}}})}function ju(n){return n==null}function Ku(n){return ju(n)||n.toString()===""}var gn=(n=>(n.MESSAGE="message",n.OPEN="open",n.CLOSE="close",n.ERROR="error",n.RETRY="retry",n.DESTROY="destroy",n))(gn||{});const qu={url:"",heartbeatTime:1e3*30},Zu="heart_beat_message";class Ju{constructor(e){const t=Object.assign(qu,e);if(Ku(t.url))throw new Error("url must be input");this._listens=new Map,this._timer=-1,this._config=t}_create(){const{_config:e}=this;this._socket=new WebSocket(e.url)}_bind(){this._socket.addEventListener("message",this._message.bind(this)),this._socket.addEventListener("open",this._open.bind(this)),this._socket.addEventListener("close",this._close.bind(this)),this._socket.addEventListener("error",this._error.bind(this))}_message(e){const t=this._listens.get("message");t&&t(e)}_open(e){const t=this._listens.get("open");t&&(t(e),this._heartbeat())}_error(e){const t=this._listens.get("error");t&&(t(e),this._retry())}_close(e){const t=this._listens.get("close");t&&(t(e),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener("message",this._message.bind(this)),this._socket.removeEventListener("open",this._open.bind(this)),this._socket.removeEventListener("close",this._close.bind(this)),this._socket.removeEventListener("error",this._error.bind(this))}_heartbeat(){const{_socket:e,_config:t}=this,{heartbeatTime:s}=t;function r(){e.send(Zu)}this._timer=setInterval(r,s)}_retry(){const e=this._listens.get("retry");e&&e(),this._clear(),this._create(),this._bind()}link(){this._create(),this._bind()}send(e){this._socket.send(e)}destroy(){const e=this._listens.get("destroy");e&&e(),this._clear(),this._listens.clear()}on(e,t){this._listens.set(e,t)}}Object.keys($o).reduce((n,e)=>[...n,...$o[e]],[]);const Qu={},eh={};class sr{initialize(e){this.options={currentLocale:e||["zh","zh-CN"].includes(S.getLanguage())?It.ZH:It.EN,locales:{zh:Qu,en:eh}}}get(e){if(e){const{locales:t,currentLocale:s}=this.options;return sr.getValue(t[s],e)||""}return String()}getObject(e){const{locales:t,currentLocale:s}=this.options;return sr.getValue(t[s],e)}load(e){S.deepMerge(this.options.locales,e)}change(e){this.options.currentLocale=e}static getValue(e,t){try{return e[t]?e[t]:t.split(".").reduce((s,r)=>s[r],e)}catch{console.error("Key %s not found",t)}}}class co{static log(...e){console&&console.log(...e)}static info(...e){console&&console.info(...e)}static error(...e){console&&console.error(...e)}static warn(...e){console&&console.warn(...e)}static br(){co.info(`
`)}static capsule(e,t,s="",r=""){console&&console.log(`%c${s}%c${e}%c${t}%c${r}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}const rr="A".charCodeAt(0),tl="Z".charCodeAt(0),th="a".charCodeAt(0);function nh(n){const e=tl-rr+1;let t="";for(;n>=0;)t=String.fromCharCode(n%e+rr)+t,n=Math.floor(n/e)-1;return t}function sh(n,e){let t="";for(;e>0;)t+=n,e--;return t}function nl(n,e=!1){const t=tl-rr+1;let s=th;e&&(s=rr);const r=String.fromCharCode(n%t+s);let o=Math.floor(n/t)+1;return sh(r,o)}class _s{static fromSequence(e){if(S.isObject(e)&&_s.requiredNewInstance(this))return this.newInstance(e);if(S.isArray(e)&&_s.requiredNewInstance(this)){const t=this;return e.map(s=>t.newInstance(s))}return[]}toSequence(){return{className:S.getClassName(this)}}}(n=>{function e(t){if(S.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")}n.requiredNewInstance=e})(_s||(_s={}));function rt(n,e){return n.zIndex>e.zIndex?1:n.zIndex===e.zIndex?0:-1}function mi(n,e){return n.zIndex>e.zIndex?-1:n.zIndex===e.zIndex?0:1}class _i{constructor(e,t,s){this.path=e,this.namespace=t,this.observable=s}}class rh{constructor(){this._observableArray=[]}hasObserver(e,t){return this.getObserver(e,t)!=null}getObserver(...e){if(e.length===1){const t=e[0],s=this._observableArray.find(r=>r.path===t);return s?s.observable:null}if(e.length===2){const t=e[0],s=e[1],r=this._observableArray.find(o=>o.path===t&&o.namespace===s);return r?r.observable:null}}requiredObserver(...e){if(S.hasLength(e,1)){const t=e[0],s=this.getObserver(t);if(s==null)throw new Error(`not found observable ${t}`);return s}if(S.hasLength(e,2)){const t=e[0],s=e[1],r=this.getObserver(t,s);if(r==null)throw new Error(`not found observable ${t}`);return r}throw new Error("requiredObserver arguments error")}removeObserver(...e){if(S.hasLength(e,1)){const t=e[0],s=this._observableArray.findIndex(r=>r.path===t);s>-1&&this._observableArray.splice(s,1);return}if(S.hasLength(e,2)){const t=e[0],s=e[1],r=this._observableArray.findIndex(o=>o.path===t&&o.namespace===s);r>-1&&this._observableArray.splice(r,1)}}addObserver(...e){if(e.length===1){const t=e[0],s=e[1];this.hasObserver(t,t)&&this.removeObserver(t),this._observableArray.push(new _i(t,t,s));return}if(e.length===3){const t=e[0],s=e[1],r=e[2];this.hasObserver(t,t)&&this.removeObserver(t,s),this._observableArray.push(new _i(t,s,r))}}}var j=(n=>(n[n.REDO=0]="REDO",n[n.UNDO=1]="UNDO",n))(j||{});class oh extends me{}class uo{constructor(){this._data=[]}add(e){this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new uo}}const ih=uo.create();class ah{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...e){this._actionExtensionFactoryList.push(...e),this._actionExtensionFactoryList.sort(rt)}delete(e){const t=this._actionExtensionFactoryList.indexOf(e);this._actionExtensionFactoryList.splice(t,1)}_initExtensions(){this._actionExtensionFactoryList.push(...ih.getData().sort(rt))}}class lh{getRegister(){return this._register}constructor(){this._register=new ah,this._register.initialize()}handle(e){var s;const t=(s=this._register)==null?void 0:s.actionExtensionFactoryList;!t||(this._actionExtensionFactoryList=t,e.length!==0&&this._checkExtension(e))}_checkExtension(e){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach(t=>{const s=t.check(e);s!==!1&&s.execute()})}}class ch extends me{}class uh extends me{}class ce{getActionExtensionManager(){return this._actionExtensionManager}constructor(e){this._undoManager=e.getUndoManager(),this._actionExtensionManager=new lh}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new oh,this._commandObservers=new ch,this._commandInjectorObservers=new uh}static getAction(e){return this._actionClass[e]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(e,t){this._actionClass[e]=t}static getCommandInjectorObservers(){return this._commandInjectorObservers}undo(){const{_undoManager:e}=this,t=e.undo();t&&t.undo()}redo(){const{_undoManager:e}=this,t=e.redo();t&&t.redo()}invoke(e){const{_undoManager:t}=this,{_actionDataList:s,_unit:r,_actionList:o}=e;this._actionExtensionManager.handle(s),s.forEach(i=>{const a=ce.getAction(i.actionName),c=ce.getActionObservers(),l=new a(i,r,c);o.push(l)}),e.invoke(),t.push(e)}}ce.staticInitialize();class Y{constructor(e,...t){this._unit=e,this._actionDataList=t,this._actionList=[]}getDoData(){return this._actionList.map(e=>e.getDoActionData())}getOldData(){return this._actionList.map(e=>e.getOldActionDaa())}getInjector(){const e=this;return new class{injectAction(t){e._actionList.push(t)}getActions(){return e._actionList.concat([])}include(t){for(let s=0;s<e._actionList.length;s++)if(e._actionList[s]instanceof t)return e._actionList[s];return null}}}redo(){this._actionList.forEach(e=>e.redo()),ce.getCommandObservers().notifyObservers({type:j.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach(e=>e.undo()),ce.getCommandObservers().notifyObservers({type:j.UNDO,actions:this._actionList})}invoke(){ce.getCommandInjectorObservers().notifyObservers(this.getInjector()),ce.getCommandObservers().notifyObservers({type:j.REDO,actions:this._actionList})}}class hh{constructor(){this._undoStack=[],this._redoStack=[]}push(e){this._redoStack.push(e)}undo(){const e=this._redoStack.pop();if(e)return this._undoStack.push(e),e}redo(){const e=this._undoStack.pop();if(e)return this._redoStack.push(e),e}}var ho=(n=>(n.INSERT_TEXT_ACTION_NAME="InsertTextAction",n.DELETE_TEXT_ACTION_NAME="DeleteTextAction",n))(ho||{});class sl extends Ta{constructor(e,t,s){if(super(e,s),t.DocumentUnit==null)throw new Error("action document domain can not be null!");this._document=t.DocumentUnit}getDocument(){return this._document}}var je=(n=>(n[n.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",n[n.NONE=1]="NONE",n[n.DECIMAL=2]="DECIMAL",n[n.ZERO_DECIMAL=3]="ZERO_DECIMAL",n[n.UPPER_ALPHA=4]="UPPER_ALPHA",n[n.ALPHA=5]="ALPHA",n[n.UPPER_ROMAN=6]="UPPER_ROMAN",n[n.ROMAN=7]="ROMAN",n))(je||{}),Fe=(n=>(n[n.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",n[n.START=1]="START",n[n.CENTER=2]="CENTER",n[n.END=3]="END",n))(Fe||{}),De=(n=>(n[n.PARAGRAPH=0]="PARAGRAPH",n[n.TABLE=1]="TABLE",n[n.SECTION_BREAK=2]="SECTION_BREAK",n[n.CUSTOM=3]="CUSTOM",n))(De||{}),ht=(n=>(n[n.DEFAULT=0]="DEFAULT",n[n.LINES=1]="LINES",n[n.LINES_AND_CHARS=2]="LINES_AND_CHARS",n[n.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",n))(ht||{}),cs=(n=>(n[n.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",n[n.CONTINUOUS=1]="CONTINUOUS",n[n.NEXT_PAGE=2]="NEXT_PAGE",n[n.EVEN_PAGE=3]="EVEN_PAGE",n[n.ODD_PAGE=4]="ODD_PAGE",n))(cs||{}),Tn=(n=>(n[n.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",n[n.NONE=1]="NONE",n[n.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",n))(Tn||{}),F=(n=>(n[n.TEXT_RUN=0]="TEXT_RUN",n[n.AUTO_TEXT=1]="AUTO_TEXT",n[n.PAGE_BREAK=2]="PAGE_BREAK",n[n.COLUMN_BREAK=3]="COLUMN_BREAK",n[n.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",n[n.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",n[n.EQUATION=6]="EQUATION",n[n.DRAWING=7]="DRAWING",n[n.PERSON=8]="PERSON",n[n.RICH_LINK=9]="RICH_LINK",n))(F||{}),an=(n=>(n[n.BOTH_SIDES=0]="BOTH_SIDES",n[n.LEFT=1]="LEFT",n[n.RIGHT=2]="RIGHT",n[n.LARGEST=3]="LARGEST",n))(an||{}),pt=(n=>(n[n.INLINE=0]="INLINE",n[n.WRAP_NONE=1]="WRAP_NONE",n[n.WRAP_POLYGON=2]="WRAP_POLYGON",n[n.WRAP_SQUARE=3]="WRAP_SQUARE",n[n.WRAP_THROUGH=4]="WRAP_THROUGH",n[n.WRAP_TIGHT=5]="WRAP_TIGHT",n[n.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",n))(pt||{}),fo=(n=>(n[n.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",n[n.NORMAL_TEXT=1]="NORMAL_TEXT",n[n.TITLE=2]="TITLE",n[n.SUBTITLE=3]="SUBTITLE",n[n.HEADING_1=4]="HEADING_1",n[n.HEADING_2=5]="HEADING_2",n[n.HEADING_3=6]="HEADING_3",n[n.HEADING_4=7]="HEADING_4",n[n.HEADING_5=8]="HEADING_5",n[n.HEADING_6=9]="HEADING_6",n))(fo||{}),bs=(n=>(n[n.AUTO=0]="AUTO",n[n.AT_LEAST=1]="AT_LEAST",n[n.EXACT=2]="EXACT",n))(bs||{}),ns=(n=>(n.NORMAL="normal",n.BOLD="bold",n.ITALIC="italic",n))(ns||{}),Se=(n=>(n[n.CHARACTER=0]="CHARACTER",n[n.COLUMN=1]="COLUMN",n[n.INSIDE_MARGIN=2]="INSIDE_MARGIN",n[n.LEFT_MARGIN=3]="LEFT_MARGIN",n[n.MARGIN=4]="MARGIN",n[n.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",n[n.PAGE=6]="PAGE",n[n.RIGHT_MARGIN=7]="RIGHT_MARGIN",n))(Se||{}),xe=(n=>(n[n.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",n[n.INSIDE_MARGIN=1]="INSIDE_MARGIN",n[n.LINE=2]="LINE",n[n.MARGIN=3]="MARGIN",n[n.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",n[n.PAGE=5]="PAGE",n[n.PARAGRAPH=6]="PARAGRAPH",n[n.TOP_MARGIN=7]="TOP_MARGIN",n))(xe||{}),rl=(n=>(n[n.POINT=0]="POINT",n[n.LINE=1]="LINE",n[n.CHARACTER=2]="CHARACTER",n))(rl||{}),Qt=(n=>(n[n.CENTER=0]="CENTER",n[n.INSIDE=1]="INSIDE",n[n.LEFT=2]="LEFT",n[n.OUTSIDE=3]="OUTSIDE",n[n.RIGHT=4]="RIGHT",n))(Qt||{}),Bn=(n=>(n[n.BOTTOM=0]="BOTTOM",n[n.CENTER=1]="CENTER",n[n.INSIDE=2]="INSIDE",n[n.OUTSIDE=3]="OUTSIDE",n[n.TOP=4]="TOP",n))(Bn||{}),dr=(n=>(n[n.PORTRAIT=0]="PORTRAIT",n[n.LANDSCAPE=1]="LANDSCAPE",n))(dr||{});function ol(n){let e=n-1;return e=e<0?0:e,e}function dh(n,e,t){return n.slice(0,e)+t+n.slice(e)}function fh(n,e,t){const s=e-t<0?0:e-t;return n.slice(0,s)+n.slice(e)}function il(n,e=0){n!=null&&(n.st+=e,n.ed+=e)}function al(n,e=0){n!=null&&(n.st+=e,n.ed+=e)}function ll(n,e){const t=n.getSnapshot(),{text:s,start:r,length:o,segmentId:i}=e,a=ol(r);let c=t.body;if(o===0)return;if(i){const{headers:d,footers:f}=t;d!=null&&d[i]?c=d[i].body:f!=null&&f[i]&&(c=f[i].body)}if(c==null)throw new Error("no body has changed");const{blockElements:l,blockElementOrder:u}=c;let h=!1;for(let d of u){const f=l[d];if(f==null)continue;const{blockType:g}=f;switch(g){case De.PARAGRAPH:h=gh(s,r,a,o,f,f.paragraph,h)}}}function gh(n,e,t,s,r,o,i=!1){i&&al(r,s);const{st:a,ed:c}=r;let l=!1;if(t>c||o==null)return l;const{elements:u,elementOrder:h}=o;for(let d of h){const{elementId:f,paragraphElementType:g}=d,b=u[f];if(g===F.DRAWING)continue;const{st:p,ed:v,tr:C}=b;if((l||i)&&t>v&&il(b,s),C!=null&&!(t<p||t>v||i)&&(console.log("paragraphApply",t,p,v,i,b,t<p||t>v||i),g===F.TEXT_RUN)){let w=t-p+1;if(e===0&&(w=0),l=!0,C.tab===L.TRUE)continue;const x=dh(C.ct||"",w,n);C.ct=x,b.ed+=s}}return l===!0&&i===!1&&(r.ed+=s),i?!0:l}function cl(n,e){const t=n.getSnapshot(),{start:s,length:r,segmentId:o}=e,i=ol(s);let a=t.body;if(r===0)return;if(o){const{headers:h,footers:d}=t;h!=null&&h[o]?a=h[o].body:d!=null&&d[o]&&(a=d[o].body)}if(a==null)throw new Error("no body has changed");const{blockElements:c,blockElementOrder:l}=a;let u=!1;for(let h of l){const d=c[h];if(d==null)continue;const{blockType:f}=d;switch(f){case De.PARAGRAPH:u=mh(s,i,r,d,d.paragraph,u)}}}function mh(n,e,t,s,r,o=!1){o&&al(s,-t);const{st:i,ed:a}=s;let c=!1;if(e>a||r==null)return c;const{elements:l,elementOrder:u}=r;for(let h of u){const{elementId:d,paragraphElementType:f}=h,g=l[d];if(f===F.DRAWING)continue;const{st:b,ed:p,tr:v}=g;if((c||o)&&e>p&&il(g,-t),v!=null&&!(e<b||e>p||o)&&f===F.TEXT_RUN){let C=e-b+1;if(n===0&&(C=0),c=!0,v.tab===L.TRUE)continue;const w=fh(v.ct||"",C,t);v.ct=w,g.ed-=t}}return c===!0&&o===!1&&(s.ed-=t),o?!0:c}class _h extends sl{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do();const{length:r,start:o}=e;this._oldActionData={...e,start:o+r}}redo(){this.do()}do(){const e=this.getDoActionData(),t=this.getDocument(),{text:s,start:r,length:o,segmentId:i}=e;ll(t,{text:s,start:r,length:o,segmentId:i}),this._observers.notifyObservers({type:j.REDO,data:this._doActionData,action:this})}undo(){const e=this.getOldActionDaa(),t=this.getDocument(),{length:s,start:r,segmentId:o}=e;cl(t,{length:s,start:r,segmentId:o}),this._observers.notifyObservers({type:j.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}class bh extends sl{constructor(e,t,s){super(e,t,s),this._doActionData={...e},this.do();const{length:r,start:o}=e;this._oldActionData={...e,start:o-r}}redo(){this.do()}do(){const e=this.getDoActionData(),t=this.getDocument(),{length:s,start:r}=e;cl(t,{length:s,start:r})}undo(){const e=this.getOldActionDaa(),t=this.getDocument(),{text:s,start:r,length:o}=e;ll(t,{text:s,start:r,length:o})}validate(){return!1}}ce.register(I.INSERT_ROW_DATA_ACTION,ru);ce.register(I.INSERT_ROW_ACTION,Ka);ce.register(I.REMOVE_ROW_DATA_ACTION,lu);ce.register(I.REMOVE_ROW_ACTION,Za);ce.register(I.SET_RANGE_STYLE_ACTION,Cu);ce.register(I.SET_WORKSHEET_STATUS_ACTION,xu);ce.register(I.SET_SELECTION_ACTION,Iu);ce.register(I.SET_RANGE_DATA_ACTION,_u);ce.register(I.SET_RANGE_FORMATTED_VALUE_ACTION,wu);ce.register(I.DELETE_RANGE_ACTION,Xa);ce.register(I.CLEAR_RANGE_ACTION,eu);ce.register(I.INSERT_RANGE_ACTION,su);ce.register(I.SET_TAB_COLOR_ACTION,yu);ce.register(I.HIDE_SHEET_ACTION,Su);ce.register(I.SET_WORKSHEET_ACTIVATE_ACTION,Au);ce.register(I.SET_HIDE_ROW_ACTION,Ru);ce.register(I.SET_SHOW_ROW_ACTION,Du);ce.register(I.SET_HIDE_COLUMN_ACTION,hu);ce.register(I.SET_SHOW_COLUMN_ACTION,du);ce.register(I.ADD_MERGE_ACTION,jc);ce.register(I.REMOVE_MERGE_ACTION,au);ce.register(I.SET_WORKSHEET_NAME_ACTION,Ou);ce.register(I.SET_HIDDEN_GRIDLINES_ACTION,gu);ce.register(I.SET_COLUMN_WIDTH_ACTION,fu);ce.register(I.SET_ROW_HEIGHT_ACTION,Tu);ce.register(I.SET_BORDER_ACTION,uu);ce.register(I.SET_RIGHT_TO_LEFT_ACTION,Eu);ce.register(I.INSERT_COLUMN_DATA_ACTION,nu);ce.register(I.REMOVE_COLUMN_DATA_ACTION,iu);ce.register(I.INSERT_COLUMN_ACTION,ja);ce.register(I.REMOVE_COLUMN_ACTION,qa);ce.register(I.DELETE_NAMED_RANGE_ACTION,tu);ce.register(I.SET_NAMED_RANGE_ACTION,mu);ce.register(I.ADD_NAMED_RANGE_ACTION,Kc);ce.register(I.SET_RANGE_FORMAT_ACTION,bu);ce.register(I.SET_RANGE_FORMULA_ACTION,pu);ce.register(I.SET_RANGE_NOTE_ACTION,vu);ce.register(I.INSERT_SHEET_ACTION,ou);ce.register(I.REMOVE_SHEET_ACTION,cu);ce.register(I.SET_SHEET_ORDER_ACTION,Ja);ce.register(I.SET_SHEET_ORDER_ACTION,Ja);ce.register(I.SET_ZOOM_RATIO_ACTION,Nu);ce.register(ho.INSERT_TEXT_ACTION_NAME,_h);ce.register(ho.DELETE_TEXT_ACTION_NAME,bh);class fr{constructor(e){this._name=e,this._observeNames=[]}onCreate(e){this.context=e}load(e){}save(){return Object()}onMounted(e){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getObserver(e){return this.context.getObserverManager().getObserver(e,this._name)}getPluginByName(e){return this.context.getPluginManager().getPluginByName(e)}pushToObserve(...e){const t=this.context.getObserverManager();e.forEach(s=>{this._observeNames.includes(s)||this._observeNames.push(s),t.addObserver(s,this._name,new me)})}deleteObserve(...e){const t=this.context.getObserverManager();e.forEach(s=>{t.removeObserver(s,this._name)})}}class ph{_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach(e=>{e.onCreate(this._context),e.onMounted(this._context)}))}constructor(e,t=[]){this._context=e,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(t),this._initialize()}install(e){const{_plugins:t}=this;t.push(e),e.onCreate(this._context),e.onMounted(this._context)}uninstall(e){const{_plugins:t}=this,s=t.findIndex(r=>r.getPluginName()===e);if(s>-1){const r=t.splice(s,1)[0];r&&r.onDestroy()}}setContext(e){this._context=e}getRequirePluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];throw new Error(`not found plugin ${e}`)}getPlugins(){return this._plugins}getPluginByName(e){for(let t=0;t<this._plugins.length;t++)if(this._plugins[t].getPluginName()===e)return this._plugins[t];return null}}class vh{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class Ch{constructor(){this._undoManager=new hh,this._commandManager=new ce(this),this._environment=new vh,this._hooksManager=new zc,this._locale=new sr,this._pluginManager=new ph(this),this._observerManager=new rh}onUniver(e){this._univer=e}getHook(e){return this._hooksManager.getHooks(e)}getLocale(){return this._locale}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}}class ln{constructor(){this._data=[]}add(e){this._data.indexOf(e)>-1||this._data.push(e)}delete(e){const t=this._data.indexOf(e);this._data.splice(t,1)}getData(){return this._data}static create(){return new ln}}var go=(n=>(n[n.SLIDE=0]="SLIDE",n[n.MASTER=1]="MASTER",n[n.LAYOUT=2]="LAYOUT",n[n.HANDOUT_MASTER=3]="HANDOUT_MASTER",n[n.NOTES_MASTER=4]="NOTES_MASTER",n))(go||{}),Nt=(n=>(n[n.SHAPE=0]="SHAPE",n[n.IMAGE=1]="IMAGE",n[n.TEXT=2]="TEXT",n))(Nt||{});class wh{constructor(e,t){var s;this._context=t,this._snapshot={...Yc,...e},this._unitId=(s=this._snapshot.id)!=null?s:ms(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var e;return(e=this._snapshot.body)==null?void 0:e.pages}getPageOrder(){var e;return(e=this._snapshot.body)==null?void 0:e.pageOrder}getPage(e){const t=this.getPages();return t==null?void 0:t[e]}getElementsByPage(e){var t;return(t=this.getPage(e))==null?void 0:t.pageElements}getElement(e,t){var s;return(s=this.getElementsByPage(e))==null?void 0:s[t]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:go.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}}class Eh extends Ch{constructor(e={}){super(),this._locale.initialize(e.locale),this._slide=new wh(e,this)}_setObserver(){}getSlide(){return this._slide}}const Th="@univer/core",Rh="0.0.1",Dh="",Ih="",yh="./src/index.ts",Ah="./src/index.ts",Sh="./src/Types/index.d.ts",Oh={main:"./lib/univer-core.js",module:"./lib/univer-core.mjs",types:"./lib/index.d.ts"},xh={".":"./src/index.ts","./*":"./src/*"},Nh=["lib"],Mh={lib:"lib"},kh={test:"cross-env NODE_ENV=--experimental-vm-modules jest --config=jest.config.js",dev:"vite",build:"tsc && vite build",watch:"vite build",link:"pnpm link ./",api:"node ./api.js",tsc:"tsc",serve:"node test/Server/server.js"},Bh="MIT",Lh={dayjs:"^1.11.5","es6-proxy-polyfill":"^2.1.1",nanoid:"4.0.0",numeral:"^2.0.6","reflect-metadata":"^0.1.13"},Fh={"@types/jest":"^28.1.8","@types/node":"^18.7.12","@typescript-eslint/eslint-plugin":"^5.34.0","@typescript-eslint/parser":"^5.34.0",debug:"^4.3.4",jest:"29.0.0","jest-dev-server":"^6.1.1","jest-environment-jsdom":"^29.0.3",less:"^4.1.3","ts-jest":"29.0.1","ts-node":"^10.9.1",typescript:"^4.7.4",vite:"^3.0.9","vite-plugin-external":"1.2.3"};var Hh={name:Th,version:Rh,description:Dh,author:Ih,main:yh,module:Ah,types:Sh,publishConfig:Oh,exports:xh,files:Nh,directories:Mh,scripts:kh,license:Bh,dependencies:Lh,devDependencies:Fh};const Ph="dev",zh=Hh.version;class mo{constructor(e={}){this.UniverSlideConfig=e,this._context=new Eh(e)}static newInstance(e={}){return co.capsule(Ph,zh,"powered by :: UniverSlide :: "),new mo(e)}static get(e){return gi({...e,type:"GET"})}static post(e){return gi({...e,type:"POST"})}static newColor(){return new ur}get context(){return this._context}installPlugin(e){this._context.getPluginManager().install(e)}uninstallPlugin(e){this._context.getPluginManager().uninstall(e)}}/*! *****************************************************************************
Copyright (C) Microsoft. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */var bi;(function(n){(function(e){var t=typeof tr=="object"?tr:typeof self=="object"?self:typeof this=="object"?this:Function("return this;")(),s=r(n);typeof t.Reflect=="undefined"?t.Reflect=n:s=r(t.Reflect,s),e(s);function r(o,i){return function(a,c){typeof o[a]!="function"&&Object.defineProperty(o,a,{configurable:!0,writable:!0,value:c}),i&&i(a,c)}}})(function(e){var t=Object.prototype.hasOwnProperty,s=typeof Symbol=="function",r=s&&typeof Symbol.toPrimitive!="undefined"?Symbol.toPrimitive:"@@toPrimitive",o=s&&typeof Symbol.iterator!="undefined"?Symbol.iterator:"@@iterator",i=typeof Object.create=="function",a={__proto__:[]}instanceof Array,c=!i&&!a,l={create:i?function(){return St(Object.create(null))}:a?function(){return St({__proto__:null})}:function(){return St({})},has:c?function(N,H){return t.call(N,H)}:function(N,H){return H in N},get:c?function(N,H){return t.call(N,H)?N[H]:void 0}:function(N,H){return N[H]}},u=Object.getPrototypeOf(Function),h=typeof process=="object"&&process.env&&process.env.REFLECT_METADATA_USE_MAP_POLYFILL==="true",d=!h&&typeof Map=="function"&&typeof Map.prototype.entries=="function"?Map:cn(),f=!h&&typeof Set=="function"&&typeof Set.prototype.entries=="function"?Set:_t(),g=!h&&typeof WeakMap=="function"?WeakMap:$t(),b=new g;function p(N,H,V,K){if(te(V)){if(!be(N))throw new TypeError;if(!Ne(H))throw new TypeError;return M(N,H)}else{if(!be(N))throw new TypeError;if(!_e(H))throw new TypeError;if(!_e(K)&&!te(K)&&!re(K))throw new TypeError;return re(K)&&(K=void 0),V=ue(V),P(N,H,V,K)}}e("decorate",p);function v(N,H){function V(K,ie){if(!_e(K))throw new TypeError;if(!te(ie)&&!Xe(ie))throw new TypeError;B(N,H,K,ie)}return V}e("metadata",v);function C(N,H,V,K){if(!_e(V))throw new TypeError;return te(K)||(K=ue(K)),B(N,H,V,K)}e("defineMetadata",C);function w(N,H,V){if(!_e(H))throw new TypeError;return te(V)||(V=ue(V)),T(N,H,V)}e("hasMetadata",w);function x(N,H,V){if(!_e(H))throw new TypeError;return te(V)||(V=ue(V)),y(N,H,V)}e("hasOwnMetadata",x);function A(N,H,V){if(!_e(H))throw new TypeError;return te(V)||(V=ue(V)),O(N,H,V)}e("getMetadata",A);function z(N,H,V){if(!_e(H))throw new TypeError;return te(V)||(V=ue(V)),U(N,H,V)}e("getOwnMetadata",z);function R(N,H){if(!_e(N))throw new TypeError;return te(H)||(H=ue(H)),X(N,H)}e("getMetadataKeys",R);function E(N,H){if(!_e(N))throw new TypeError;return te(H)||(H=ue(H)),J(N,H)}e("getOwnMetadataKeys",E);function D(N,H,V){if(!_e(H))throw new TypeError;te(V)||(V=ue(V));var K=G(H,V,!1);if(te(K)||!K.delete(N))return!1;if(K.size>0)return!0;var ie=b.get(H);return ie.delete(V),ie.size>0||b.delete(H),!0}e("deleteMetadata",D);function M(N,H){for(var V=N.length-1;V>=0;--V){var K=N[V],ie=K(H);if(!te(ie)&&!re(ie)){if(!Ne(ie))throw new TypeError;H=ie}}return H}function P(N,H,V,K){for(var ie=N.length-1;ie>=0;--ie){var Me=N[ie],he=Me(H,V,K);if(!te(he)&&!re(he)){if(!_e(he))throw new TypeError;K=he}}return K}function G(N,H,V){var K=b.get(N);if(te(K)){if(!V)return;K=new d,b.set(N,K)}var ie=K.get(H);if(te(ie)){if(!V)return;ie=new d,K.set(H,ie)}return ie}function T(N,H,V){var K=y(N,H,V);if(K)return!0;var ie=At(H);return re(ie)?!1:T(N,ie,V)}function y(N,H,V){var K=G(H,V,!1);return te(K)?!1:oe(K.has(N))}function O(N,H,V){var K=y(N,H,V);if(K)return U(N,H,V);var ie=At(H);if(!re(ie))return O(N,ie,V)}function U(N,H,V){var K=G(H,V,!1);if(!te(K))return K.get(N)}function B(N,H,V,K){var ie=G(V,K,!0);ie.set(N,H)}function X(N,H){var V=J(N,H),K=At(N);if(K===null)return V;var ie=X(K,H);if(ie.length<=0)return V;if(V.length<=0)return ie;for(var Me=new f,he=[],de=0,ae=V;de<ae.length;de++){var Ce=ae[de],we=Me.has(Ce);we||(Me.add(Ce),he.push(Ce))}for(var et=0,Yt=ie;et<Yt.length;et++){var Ce=Yt[et],we=Me.has(Ce);we||(Me.add(Ce),he.push(Ce))}return he}function J(N,H){var V=[],K=G(N,H,!1);if(te(K))return V;for(var ie=K.keys(),Me=gt(ie),he=0;;){var de=Ve(Me);if(!de)return V.length=he,V;var ae=Gt(de);try{V[he]=ae}catch(Ce){try{mt(Me)}finally{throw Ce}}he++}}function $(N){if(N===null)return 1;switch(typeof N){case"undefined":return 0;case"boolean":return 2;case"string":return 3;case"symbol":return 4;case"number":return 5;case"object":return N===null?1:6;default:return 6}}function te(N){return N===void 0}function re(N){return N===null}function Te(N){return typeof N=="symbol"}function _e(N){return typeof N=="object"?N!==null:typeof N=="function"}function Z(N,H){switch($(N)){case 0:return N;case 1:return N;case 2:return N;case 3:return N;case 4:return N;case 5:return N}var V=H===3?"string":H===5?"number":"default",K=We(N,r);if(K!==void 0){var ie=K.call(N,V);if(_e(ie))throw new TypeError;return ie}return ne(N,V==="default"?"number":V)}function ne(N,H){if(H==="string"){var V=N.toString;if(Ae(V)){var K=V.call(N);if(!_e(K))return K}var ie=N.valueOf;if(Ae(ie)){var K=ie.call(N);if(!_e(K))return K}}else{var ie=N.valueOf;if(Ae(ie)){var K=ie.call(N);if(!_e(K))return K}var Me=N.toString;if(Ae(Me)){var K=Me.call(N);if(!_e(K))return K}}throw new TypeError}function oe(N){return!!N}function Re(N){return""+N}function ue(N){var H=Z(N,3);return Te(H)?H:Re(H)}function be(N){return Array.isArray?Array.isArray(N):N instanceof Object?N instanceof Array:Object.prototype.toString.call(N)==="[object Array]"}function Ae(N){return typeof N=="function"}function Ne(N){return typeof N=="function"}function Xe(N){switch($(N)){case 3:return!0;case 4:return!0;default:return!1}}function We(N,H){var V=N[H];if(V!=null){if(!Ae(V))throw new TypeError;return V}}function gt(N){var H=We(N,o);if(!Ae(H))throw new TypeError;var V=H.call(N);if(!_e(V))throw new TypeError;return V}function Gt(N){return N.value}function Ve(N){var H=N.next();return H.done?!1:H}function mt(N){var H=N.return;H&&H.call(N)}function At(N){var H=Object.getPrototypeOf(N);if(typeof N!="function"||N===u||H!==u)return H;var V=N.prototype,K=V&&Object.getPrototypeOf(V);if(K==null||K===Object.prototype)return H;var ie=K.constructor;return typeof ie!="function"||ie===N?H:ie}function cn(){var N={},H=[],V=function(){function he(de,ae,Ce){this._index=0,this._keys=de,this._values=ae,this._selector=Ce}return he.prototype["@@iterator"]=function(){return this},he.prototype[o]=function(){return this},he.prototype.next=function(){var de=this._index;if(de>=0&&de<this._keys.length){var ae=this._selector(this._keys[de],this._values[de]);return de+1>=this._keys.length?(this._index=-1,this._keys=H,this._values=H):this._index++,{value:ae,done:!1}}return{value:void 0,done:!0}},he.prototype.throw=function(de){throw this._index>=0&&(this._index=-1,this._keys=H,this._values=H),de},he.prototype.return=function(de){return this._index>=0&&(this._index=-1,this._keys=H,this._values=H),{value:de,done:!0}},he}();return function(){function he(){this._keys=[],this._values=[],this._cacheKey=N,this._cacheIndex=-2}return Object.defineProperty(he.prototype,"size",{get:function(){return this._keys.length},enumerable:!0,configurable:!0}),he.prototype.has=function(de){return this._find(de,!1)>=0},he.prototype.get=function(de){var ae=this._find(de,!1);return ae>=0?this._values[ae]:void 0},he.prototype.set=function(de,ae){var Ce=this._find(de,!0);return this._values[Ce]=ae,this},he.prototype.delete=function(de){var ae=this._find(de,!1);if(ae>=0){for(var Ce=this._keys.length,we=ae+1;we<Ce;we++)this._keys[we-1]=this._keys[we],this._values[we-1]=this._values[we];return this._keys.length--,this._values.length--,de===this._cacheKey&&(this._cacheKey=N,this._cacheIndex=-2),!0}return!1},he.prototype.clear=function(){this._keys.length=0,this._values.length=0,this._cacheKey=N,this._cacheIndex=-2},he.prototype.keys=function(){return new V(this._keys,this._values,K)},he.prototype.values=function(){return new V(this._keys,this._values,ie)},he.prototype.entries=function(){return new V(this._keys,this._values,Me)},he.prototype["@@iterator"]=function(){return this.entries()},he.prototype[o]=function(){return this.entries()},he.prototype._find=function(de,ae){return this._cacheKey!==de&&(this._cacheIndex=this._keys.indexOf(this._cacheKey=de)),this._cacheIndex<0&&ae&&(this._cacheIndex=this._keys.length,this._keys.push(de),this._values.push(void 0)),this._cacheIndex},he}();function K(he,de){return he}function ie(he,de){return de}function Me(he,de){return[he,de]}}function _t(){return function(){function N(){this._map=new d}return Object.defineProperty(N.prototype,"size",{get:function(){return this._map.size},enumerable:!0,configurable:!0}),N.prototype.has=function(H){return this._map.has(H)},N.prototype.add=function(H){return this._map.set(H,H),this},N.prototype.delete=function(H){return this._map.delete(H)},N.prototype.clear=function(){this._map.clear()},N.prototype.keys=function(){return this._map.keys()},N.prototype.values=function(){return this._map.values()},N.prototype.entries=function(){return this._map.entries()},N.prototype["@@iterator"]=function(){return this.keys()},N.prototype[o]=function(){return this.keys()},N}()}function $t(){var N=16,H=l.create(),V=K();return function(){function ae(){this._key=K()}return ae.prototype.has=function(Ce){var we=ie(Ce,!1);return we!==void 0?l.has(we,this._key):!1},ae.prototype.get=function(Ce){var we=ie(Ce,!1);return we!==void 0?l.get(we,this._key):void 0},ae.prototype.set=function(Ce,we){var et=ie(Ce,!0);return et[this._key]=we,this},ae.prototype.delete=function(Ce){var we=ie(Ce,!1);return we!==void 0?delete we[this._key]:!1},ae.prototype.clear=function(){this._key=K()},ae}();function K(){var ae;do ae="@@WeakMap@@"+de();while(l.has(H,ae));return H[ae]=!0,ae}function ie(ae,Ce){if(!t.call(ae,V)){if(!Ce)return;Object.defineProperty(ae,V,{value:l.create()})}return ae[V]}function Me(ae,Ce){for(var we=0;we<Ce;++we)ae[we]=Math.random()*255|0;return ae}function he(ae){return typeof Uint8Array=="function"?typeof crypto!="undefined"?crypto.getRandomValues(new Uint8Array(ae)):typeof msCrypto!="undefined"?msCrypto.getRandomValues(new Uint8Array(ae)):Me(new Uint8Array(ae),ae):Me(new Array(ae),ae)}function de(){var ae=he(N);ae[6]=ae[6]&79|64,ae[8]=ae[8]&191|128;for(var Ce="",we=0;we<N;++we){var et=ae[we];(we===4||we===6||we===8)&&(Ce+="-"),et<16&&(Ce+="0"),Ce+=et.toString(16).toLowerCase()}return Ce}}function St(N){return N.__=void 0,delete N.__,N}})})(bi||(bi={}));const zs=class{static register(n,e){let t=zs.sMap.get(n);t?t.push(e):(t=new Array,t.push(e),zs.sMap.set(n,t))}static getTable(n){var s;let e=new Array,t=n;for(;t!=null;){const r=(s=zs.sMap.get(t))!=null?s:[];e=e.concat(r),t=Object.getPrototypeOf(t)}return e}};let _o=zs;_o.sMap=new Map;function Uh(){return(n,e,t)=>{_o.register(n,e),Reflect.defineMetadata("PostConstruct",t,n,e)}}function Wh(){return(n,e)=>{_o.register(n,e),Reflect.defineMetadata("AttributeValue",{},n,e)}}const pi="MessageQueue";class Vh{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(e){this._messages.push(e),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const e=JSON.stringify(this._messages);localStorage.setItem(pi,e)}load(){const e=localStorage.getItem(pi);e&&(this._messages=JSON.parse(e))}}class Gh{static isMessageResponseReceive(e){return e.type==="message_response"}packMessage(e){return{changed:e,version:S.generateRandomId()}}}var $h=Object.defineProperty,Yh=Object.getOwnPropertyDescriptor,ul=(n,e,t,s)=>{for(var r=s>1?void 0:s?Yh(e,t):e,o=n.length-1,i;o>=0;o--)(i=n[o])&&(r=(s?i(e,t,r):i(r))||r);return s&&r&&$h(e,t,r),r};const hl=class extends Gh{initialize(){this.messageQueue=new Vh,this.status="wait",this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Ju({url:this.config.socketUrl}),this.socket.on(gn.MESSAGE,n=>{this.checkupReceiveMessage(n.data)}),this.socket.on(gn.ERROR,()=>{}),this.socket.on(gn.OPEN,()=>{}),this.socket.on(gn.CLOSE,()=>{}),this.socket.on(gn.RETRY,()=>{}),this.socket.on(gn.DESTROY,()=>{}),this.socket.link())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var e;const n=this.getTopMessage();return(e=JSON.stringify(n))!=null?e:""}checkupReceiveMessage(n){hl.isMessageResponseReceive(n)&&this.getTopMessage().version===n.message.version&&(this.popTopMessage(),this.globalSendResolve())}pushMessageQueue(n){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(n)),this.sendMessageQueue())}async sendTopMessage(){const n=this.serializeTopMessage();return this.socket.send(n),new Promise(e=>this.globalSendResolve=e)}async sendMessageQueue(){const{messageQueue:n,status:e}=this;if(e==="wait"){for(this.status="work";n.hasMessage();)await this.sendTopMessage();this.status="wait"}return this.status}};let dl=hl;ul([Wh()],dl.prototype,"config",2);ul([Uh()],dl.prototype,"initialize",1);var Xh={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","\u5FAE\u8F6F\u96C5\u9ED1","\u5B8B\u4F53","\u9ED1\u4F53","\u6977\u4F53","\u4EFF\u5B8B","\u65B0\u5B8B\u4F53","\u534E\u6587\u65B0\u9B4F","\u534E\u6587\u884C\u6977","\u534E\u6587\u96B6\u4E66"],defaultFontSize:14,unit:"pt"}},jh={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const nn={aliceBlue:[240,248,255],antiqueWhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blancheAlmond:[255,235,205],blue:[0,0,255],blueViolet:[138,43,226],brown:[165,42,42],burlyWood:[222,184,135],cadetBlue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornFlowerBlue:[100,149,237],cornSilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkCyan:[0,139,139],darkGoldenrod:[184,132,11],darkGray:[169,169,169],darkGreen:[0,100,0],darkGrey:[169,169,169],darkKhaki:[189,183,107],darkMagenta:[139,0,139],darkOliveGreen:[85,107,47],darkOrange:[255,140,0],darkOrchid:[153,50,204],darkRed:[139,0,0],darkSalmon:[233,150,122],darkSeaGreen:[143,188,143],darkSlateBlue:[72,61,139],darkSlateGray:[47,79,79],darkSlateGrey:[47,79,79],darkTurquoise:[0,206,209],darkViolet:[148,0,211],deepPink:[255,20,147],deepSkyBlue:[0,191,255],dimGray:[105,105,105],dimGrey:[105,105,105],dodgerBlue:[30,144,255],firebrick:[178,34,34],floralWhite:[255,255,240],forestGreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostWhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],green:[0,128,0],greenYellow:[173,255,47],grey:[128,128,128],honeydew:[240,255,240],hotPink:[255,105,180],indianRed:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderBlush:[255,240,245],lawnGreen:[124,252,0],lemonChiffon:[255,250,205],lightblue:[173,216,230],lightCoral:[240,128,128],lightCyan:[224,255,255],lightGoldenrodYellow:[250,250,210],lightGray:[211,211,211],lightGreen:[144,238,144],lightGrey:[211,211,211],lightPink:[255,182,193],lightSalmon:[255,160,122],lightSeaGreen:[32,178,170],lightSkyBlue:[135,206,250],lightSlateGray:[119,136,153],lightSlateGrey:[119,136,153],lightSteelBlue:[176,196,222],lightYellow:[255,255,224],lime:[0,255,0],limeGreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumAquamarine:[102,205,170],mediumBlue:[0,0,205],mediumOrchid:[186,85,211],mediumPurple:[147,112,219],mediumSeaGreen:[60,179,113],mediumSlateBlue:[123,104,238],mediumSpringGreen:[0,250,154],mediumTurquoise:[72,209,204],mediumVioletRed:[199,21,133],midBightBlue:[25,25,112],mintCream:[245,255,250],mistyRose:[255,228,225],moccasin:[255,228,181],navajoWhite:[255,222,173],navy:[0,0,128],oldLace:[253,245,230],olive:[128,128,0],oliveDrab:[107,142,35],orange:[255,165,0],orangeRed:[255,69,0],orchid:[218,112,214],paleGoldenrod:[238,232,170],paleGreen:[152,251,152],paleTurquoise:[175,238,238],paleVioletRed:[219,112,147],papayaWhip:[255,239,213],peachPuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,203],powderBlue:[176,224,230],purple:[128,0,128],rebeccaPurple:[102,51,153],red:[255,0,0],rosyBrown:[188,143,143],royalBlue:[65,105,225],saddleBrown:[139,69,19],salmon:[250,128,114],sandyBrown:[244,164,96],seaGreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyBlue:[135,206,235],slateBlue:[106,90,205],slateGray:[119,128,144],slateGrey:[119,128,144],snow:[255,255,250],springGreen:[0,255,127],steelBlue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],transparent:[255,255,255,0],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whiteSmoke:[245,245,245],yellow:[255,255,0],yellowGreen:[154,205,5]};var nt=(n=>(n.PointerMove="PointerMove",n.PointerDown="PointerDown",n.PointerUp="PointerUp",n.PointerOut="PointerOut",n.PointerLeave="PointerLeave",n.PointerOver="PointerOver",n.PointerEnter="PointerEnter",n.wheel="MouseWheel",n.KeyDown="KeyDown",n.KeyUp="KeyUp",n))(nt||{});const fl=1,Kh='"Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif',qh="0",vi=1,Zh=14;var ze=(n=>(n.DEFAULT="default",n.AUTO="auto",n.CROSSHAIR="crosshair",n.POINTER="pointer",n.MOVE="move",n.EAST_RESIZE="e-resize",n.NORTH_EAST_RESIZE="ne-resize",n.NORTH_WEST_RESIZE="nw-resize",n.NORTH_RESIZE="n-resize",n.SOUTH_EAST_RESIZE="se-resize",n.SOUTH_WEST_RESIZE="sw-resize",n.SOUTH_RESIZE="s-resize",n.WEST_RESIZE="w-resize",n.TEXT="text",n.WAIT="wait",n.HELP="help",n.CELL="cell",n.NONE="none",n.VERTICAL_TEXT="vertical-text",n.NO_DROP="no-drop",n.GRAB="grab",n.GRABBING="grabbing",n.ALL_SCROLL="all-scroll",n.COLUMN_RESIZE="col-resize",n.ROW_RESIZE="row-resize",n.PROGRESS="progress",n.NOT_ALLOWED="not-allowed",n.ZOOM_IN="zoom-in",n.ZOOM_OUT="zoom-out",n))(ze||{});const pn="rgb(0,0,0)";var ut=(n=>(n.TOP="t",n.BOTTOM="b",n.LEFT="l",n.RIGHT="r",n))(ut||{}),or=(n=>(n[n.UP=0]="UP",n[n.DOWN=1]="DOWN",n))(or||{}),fe=(n=>(n.ENGINE="Engine",n.SCENE="Scene",n.BASE_OBJECT="BaseObject",n.SCENE_VIEWER="SceneViewer",n.CANVAS="Canvas",n.VIEWPORT="Viewport",n.LAYER="Layer",n.GROUP="Group",n))(fe||{});const Ci=n=>({sbr:.5,sbo:n,spr:.5,spo:n});class jn{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(e,t,s){this._globalFontMeasureCache.has(e)||(this._globalFontMeasureCache[e]=new Map),this._globalFontMeasureCache[e][t]=s}static clearFontMeasureCache(e){var s;const t=e.split("/");if(t.length===1){const r=t[0];this._globalFontMeasureCache.delete(r)}else if(t.length===2){const r=t[0],o=t[1];(s=this._globalFontMeasureCache.get(r))==null||s.delete(o)}else return!1;return!0}static getFontMeasureCache(e,t){var s;return(s=this._globalFontMeasureCache[e])==null?void 0:s[t]}static autoCleanFontMeasureCache(e=1e6){let t=0,s=!1;for(let r of this._globalFontMeasureCache){const[,o]=r;if(t+=o.size,t>e){s=!0;break}}if(s){let r=0;for(let o of this._globalFontMeasureCache){const[i,a]=o;if(r+=a.size,r>e/2){const c=r-e/2;this._clearMeasureCache(c,a);break}this._globalFontMeasureCache.delete(i)}return!0}return!1}static getBaselineOffsetInfo(e,t){if(this._fontDataMap.size===0)return Ci(t);const s=e.split(",");for(let r of s){r=r.replace(/'/g,"");const o=this._fontDataMap.get(r);if(!o)continue;const{subscriptSizeRatio:i,subscriptOffset:a,superscriptSizeRatio:c,superscriptOffset:l}=o;return{sbr:i,sbo:a*t,spr:c,spo:l*t}}return Ci(t)}static _clearMeasureCache(e,t){let s=0;for(let r of t){const[o]=r;if(s>e)break;t.delete(o),s++}return!0}static getTextSizeByDom(e,t){if(t in this._getTextHeightCache)return this._getTextHeightCache[t];let s=document.getElementById("universheetTextSizeTest");const r="float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;";s||(s=document.createElement("span"),s.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(s)),s.style.cssText+=`${r};${t}`,s.innerText=e;const o=s.getBoundingClientRect(),i={width:o.width,height:o.height};return this._getTextHeightCache[t]=i,i}static _getBoundingBoxByFont(e,t=28,s=""){const r=this._fontDataMap.get(e);if(!r)return;const{notDefWidth:o,ascender:i,descender:a,typoAscender:c,typoDescender:l,strikeoutPosition:u,subscriptSizeRatio:h,subscriptOffset:d,superscriptSizeRatio:f,superscriptOffset:g,hdmxData:b,glyphHorizonMap:p}=r,v=b==null?void 0:b.indexOf(Math.floor(t)),C=p.get(s.charCodeAt(0));let w=o;if(C){const{width:x,pixelsPerEm:A=[]}=C;v?w=A[v]:w=x}return{width:w*t,ba:i*t,bd:a*t,aba:c*t,abd:l*t,sp:u*t,sbr:h,sbo:d*t,spr:f,spo:g*t}}static _calculateBoundingBoxByMeasureText(e,t){const{width:s,fontBoundingBoxAscent:r,fontBoundingBoxDescent:o,actualBoundingBoxAscent:i,actualBoundingBoxDescent:a}=e;return{width:s,ba:r,bd:o,aba:i,abd:a,sp:(r+o)/2,sbr:.5,sbo:t,spr:.5,spo:t}}static getTextSize(e,t){const{fontString:s,fontSize:r,fontFamily:o}=t;let i=this._getBoundingBoxByFont(o,r);if(!i){const a=this.getMeasureText(e,s);i=this._calculateBoundingBoxByMeasureText(a,r)}return i}static getMeasureText(e,t){if(!this._context){const d=document.createElement("canvas");this._context=d.getContext("2d")}const s=this._context,r=this.getFontMeasureCache(t,e);if(r!=null)return r;s.font=t;const o=s.measureText(e),{width:i,fontBoundingBoxAscent:a,fontBoundingBoxDescent:c,actualBoundingBoxAscent:l,actualBoundingBoxDescent:u}=o,h={width:i,fontBoundingBoxAscent:a,fontBoundingBoxDescent:c,actualBoundingBoxAscent:l,actualBoundingBoxDescent:u};if(a==null||c==null||Number.isNaN(a)||Number.isNaN(c)){let d=this.getTextSizeByDom(qh,t)[1];s.textBaseline==="top"?(h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d,h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0):s.textBaseline==="middle"?(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=d/2,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d/2):(h.fontBoundingBoxDescent=h.actualBoundingBoxDescent=0,h.fontBoundingBoxAscent=h.actualBoundingBoxAscent=d)}return this.setFontMeasureCache(t,e,h),h}}jn._globalFontMeasureCache=new Map;jn._getTextHeightCache={};jn._fontDataMap=new Map;var ps=(n=>(n[n.SECTION=0]="SECTION",n[n.PAGE=1]="PAGE",n[n.COLUMN=2]="COLUMN",n))(ps||{}),ir=(n=>(n[n.PARAGRAPH=0]="PARAGRAPH",n[n.BLOCK=1]="BLOCK",n))(ir||{}),ft=(n=>(n[n.LETTER=0]="LETTER",n[n.WORD=1]="WORD",n[n.LIST=2]="LIST",n[n.TAB=3]="TAB",n[n.IMAGE=4]="IMAGE",n[n.AT=5]="AT",n[n.MATH=6]="MATH",n[n.MULTI_LINE=7]="MULTI_LINE",n[n.CUSTOM=8]="CUSTOM",n))(ft||{}),zt=(n=>(n[n.VERTICAL=0]="VERTICAL",n[n.HORIZONTAL=1]="HORIZONTAL",n[n.AUTO=2]="AUTO",n))(zt||{}),bt=(n=>(n[n.Generic=0]="Generic",n[n.Keyboard=1]="Keyboard",n[n.Mouse=2]="Mouse",n[n.Touch=3]="Touch",n))(bt||{}),se=(n=>(n[n.Horizontal=0]="Horizontal",n[n.Vertical=1]="Vertical",n[n.LeftClick=2]="LeftClick",n[n.MiddleClick=3]="MiddleClick",n[n.RightClick=4]="RightClick",n[n.BrowserBack=5]="BrowserBack",n[n.BrowserForward=6]="BrowserForward",n[n.MouseWheelX=7]="MouseWheelX",n[n.MouseWheelY=8]="MouseWheelY",n[n.MouseWheelZ=9]="MouseWheelZ",n[n.DeltaHorizontal=10]="DeltaHorizontal",n[n.DeltaVertical=11]="DeltaVertical",n[n.FakeMove=12]="FakeMove",n))(se||{}),qe=(n=>(n[n.translate=0]="translate",n[n.resize=1]="resize",n[n.scale=2]="scale",n[n.skew=3]="skew",n[n.flip=4]="flip",n[n.all=5]="all",n))(qe||{});class Jh{constructor(e=30){this._enabled=!0,this._rollingFrameTime=new Qh(e)}sampleFrame(e=this.Now()){if(!!this._enabled){if(this._lastFrameTimeMs!=null){let t=e-this._lastFrameTimeMs;this._rollingFrameTime.add(t)}this._lastFrameTimeMs=e}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let e=this._rollingFrameTime.history(0);return e===0?0:1e3/e}get isSaturated(){return this._rollingFrameTime.isSaturated()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}get isEnabled(){return this._enabled}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class Qh{constructor(e){this._samples=new Array(e),this.reset()}add(e){let t;if(this.isSaturated()){let s=this._samples[this._pos];t=s-this.average,this.average-=t/(this._sampleCount-1),this._m2-=t*(s-this.average)}else this._sampleCount++;t=e-this.average,this.average+=t/this._sampleCount,this._m2+=t*(e-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=e,this._pos++,this._pos%=this._samples.length}history(e){if(e>=this._sampleCount||e>=this._samples.length)return 0;let t=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(t-e)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(e){let t=this._samples.length;return(e%t+t)%t}}class Q{constructor(e=0,t=0){this.x=e,this.y=t}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let e=this.x|0;return e=e*397^(this.y|0),e}toArray(e,t=0){return e[t]=this.x,e[t+1]=this.y,this}fromArray(e,t=0){return Q.FromArrayToRef(e,t,this),this}asArray(){let e=new Array;return this.toArray(e,0),e}copyFrom(e){return this.x=e.x,this.y=e.y,this}copyFromFloats(e,t){return this.x=e,this.y=t,this}set(e,t){return this.copyFromFloats(e,t)}add(e){return new Q(this.x+e.x,this.y+e.y)}addToRef(e,t){return t.x=this.x+e.x,t.y=this.y+e.y,this}addByPoint(e,t){return new Q(this.x+e,this.y+t)}addInPlace(e){return this.x+=e.x,this.y+=e.y,this}subtract(e){return new Q(this.x-e.x,this.y-e.y)}subtractByPoint(e,t){return new Q(this.x-e,this.y-t)}subtractToRef(e,t){return t.x=this.x-e.x,t.y=this.y-e.y,this}subtractInPlace(e){return this.x-=e.x,this.y-=e.y,this}multiplyInPlace(e){return this.x*=e.x,this.y*=e.y,this}multiply(e){return new Q(this.x*e.x,this.y*e.y)}multiplyToRef(e,t){return t.x=this.x*e.x,t.y=this.y*e.y,this}multiplyByFloats(e,t){return new Q(this.x*e,this.y*t)}divide(e){return new Q(this.x/e.x,this.y/e.y)}divideToRef(e,t){return t.x=this.x/e.x,t.y=this.y/e.y,this}divideInPlace(e){return this.divideToRef(e,this)}negate(){return new Q(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(e){return e.copyFromFloats(this.x*-1,this.y*-1)}scaleInPlace(e){return this.x*=e,this.y*=e,this}scale(e){let t=new Q(0,0);return this.scaleToRef(e,t),t}scaleToRef(e,t){return t.x=this.x*e,t.y=this.y*e,this}scaleAndAddToRef(e,t){return t.x+=this.x*e,t.y+=this.y*e,this}equals(e){return e&&this.x===e.x&&this.y===e.y}floor(){return new Q(Math.floor(this.x),Math.floor(this.y))}fract(){return new Q(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(e){const t=Math.cos(e),s=Math.sin(e),r=t*this.x-s*this.y,o=s*this.x+t*this.y;return this.x=r,this.y=o,this}rotateToRef(e,t){const s=Math.cos(e),r=Math.sin(e);return t.x=s*this.x-r*this.y,t.y=r*this.x+s*this.y,this}rotateByPoint(e,t=Q.create(0,0)){const s=Math.cos(e),r=Math.sin(e),o=t.x+(this.x-t.x)*s-(this.y-t.y)*r,i=t.y+(this.x-t.x)*r+(this.y-t.y)*s;return this.x=o,this.y=i,this}transformCoordinateOnRotate(e){const t=Math.sqrt(this.x**2+this.y**2),s=Math.atan2(this.y,this.x),r=-e+s;return this.x=t*Math.cos(r),this.y=t*Math.sin(r),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return Q.NormalizeToRef(this,this),this}clone(){return new Q(this.x,this.y)}static Zero(){return new Q(0,0)}static One(){return new Q(1,1)}static FromArray(e,t=0){return new Q(e[t],e[t+1])}static FromArrayToRef(e,t,s){s.x=e[t],s.y=e[t+1]}static CatmullRom(e,t,s,r,o){let i=o*o,a=o*i,c=.5*(2*t.x+(-e.x+s.x)*o+(2*e.x-5*t.x+4*s.x-r.x)*i+(-e.x+3*t.x-3*s.x+r.x)*a),l=.5*(2*t.y+(-e.y+s.y)*o+(2*e.y-5*t.y+4*s.y-r.y)*i+(-e.y+3*t.y-3*s.y+r.y)*a);return new Q(c,l)}static Clamp(e,t,s){let r=e.x;r=r>s.x?s.x:r,r=r<t.x?t.x:r;let o=e.y;return o=o>s.y?s.y:o,o=o<t.y?t.y:o,new Q(r,o)}static Hermite(e,t,s,r,o){let i=o*o,a=o*i,c=2*a-3*i+1,l=-2*a+3*i,u=a-2*i+o,h=a-i,d=e.x*c+s.x*l+t.x*u+r.x*h,f=e.y*c+s.y*l+t.y*u+r.y*h;return new Q(d,f)}static Hermite1stDerivative(e,t,s,r,o){let i=Q.Zero();return this.Hermite1stDerivativeToRef(e,t,s,r,o,i),i}static Hermite1stDerivativeToRef(e,t,s,r,o,i){const a=o*o;i.x=(a-o)*6*e.x+(3*a-4*o+1)*t.x+(-a+o)*6*s.x+(3*a-2*o)*r.x,i.y=(a-o)*6*e.y+(3*a-4*o+1)*t.y+(-a+o)*6*s.y+(3*a-2*o)*r.y}static Lerp(e,t,s){let r=e.x+(t.x-e.x)*s,o=e.y+(t.y-e.y)*s;return new Q(r,o)}static Dot(e,t){return e.x*t.x+e.y*t.y}static Normalize(e){let t=Q.Zero();return this.NormalizeToRef(e,t),t}static NormalizeToRef(e,t){let s=e.length();s!==0&&(t.x=e.x/s,t.y=e.y/s)}static Minimize(e,t){let s=e.x<t.x?e.x:t.x,r=e.y<t.y?e.y:t.y;return new Q(s,r)}static Maximize(e,t){let s=e.x>t.x?e.x:t.x,r=e.y>t.y?e.y:t.y;return new Q(s,r)}static Transform(e,t,s=!1){const r=t,o=e;return s?new Q(r[0]*o.x+r[2]*o.y,r[1]*o.x+r[3]*o.y):new Q(r[0]*o.x+r[2]*o.y+r[4],r[1]*o.x+r[3]*o.y+r[5])}static PointInTriangle(e,t,s,r){let o=.5*(-s.y*r.x+t.y*(-s.x+r.x)+t.x*(s.y-r.y)+s.x*r.y),i=o<0?-1:1,a=(t.y*r.x-t.x*r.y+(r.y-t.y)*e.x+(t.x-r.x)*e.y)*i,c=(t.x*s.y-t.y*s.x+(t.y-s.y)*e.x+(s.x-t.x)*e.y)*i;return a>0&&c>0&&a+c<2*o*i}static Distance(e,t){return Math.sqrt(Q.DistanceSquared(e,t))}static DistanceSquared(e,t){let s=e.x-t.x,r=e.y-t.y;return s*s+r*r}static Center(e,t){return Q.CenterToRef(e,t,Q.Zero())}static CenterToRef(e,t,s){return s.copyFromFloats((e.x+t.x)/2,(e.y+t.y)/2)}static DistanceOfPointFromSegment(e,t,s){let r=Q.DistanceSquared(t,s);if(r===0)return Q.Distance(e,t);let o=s.subtract(t),i=Math.max(0,Math.min(1,Q.Dot(e.subtract(t),o)/r)),a=t.add(o.multiplyByFloats(i,i));return Q.Distance(e,a)}static create(e,t){return new Q(e,t)}}const Sr=[1,0,0,1,0,0];class $e{constructor(e=Sr){this.dirty=!1,this._m=e&&e.slice()||Sr}static create(e=Sr){return new this(e)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new $e(this._m)}copyInto(e){e._m[0]=this._m[0],e._m[1]=this._m[1],e._m[2]=this._m[2],e._m[3]=this._m[3],e._m[4]=this._m[4],e._m[5]=this._m[5]}applyPoint(e,t=!1){const s=this._m;let r=s[0]*e.x+s[2]*e.y,o=s[1]*e.x+s[3]*e.y;return t?new Q(r,o):new Q(r+s[4],o+s[5])}translate(e,t){return this._m[4]+=this._m[0]*e+this._m[2]*t,this._m[5]+=this._m[1]*e+this._m[3]*t,this}scale(e,t){return this._m[0]*=e,this._m[1]*=e,this._m[2]*=t,this._m[3]*=t,this}rotate(e){const t=us(e);let s=Math.cos(t),r=Math.sin(t),o=this._m[0]*s+this._m[2]*r,i=this._m[1]*s+this._m[3]*r,a=this._m[0]*-r+this._m[2]*s,c=this._m[1]*-r+this._m[3]*s;return this._m[0]=o,this._m[1]=i,this._m[2]=a,this._m[3]=c,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(e,t){let s=this._m[0]+this._m[2]*t,r=this._m[1]+this._m[3]*t,o=this._m[2]+this._m[0]*e,i=this._m[3]+this._m[1]*e;return this._m[0]=s,this._m[1]=r,this._m[2]=o,this._m[3]=i,this}multiply(e){let t=this._m[0]*e._m[0]+this._m[2]*e._m[1],s=this._m[1]*e._m[0]+this._m[3]*e._m[1],r=this._m[0]*e._m[2]+this._m[2]*e._m[3],o=this._m[1]*e._m[2]+this._m[3]*e._m[3],i=this._m[0]*e._m[4]+this._m[2]*e._m[5]+this._m[4],a=this._m[1]*e._m[4]+this._m[3]*e._m[5]+this._m[5];return this._m[0]=t,this._m[1]=s,this._m[2]=r,this._m[3]=o,this._m[4]=i,this._m[5]=a,this}invert(){let e=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),t=this._m[3]*e,s=-this._m[1]*e,r=-this._m[2]*e,o=this._m[0]*e,i=e*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),a=e*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=t,this._m[1]=s,this._m[2]=r,this._m[3]=o,this._m[4]=i,this._m[5]=a,this}getMatrix(){return this._m}getMatrixByAccurate(e=3){return this._m.map(t=>Yr(t,e))}setAbsolutePosition(e){let t=this._m[0],s=this._m[1],r=this._m[2],o=this._m[3],i=this._m[4],a=this._m[5],c=(t*(e.y-a)-s*(e.x-i))/(t*o-s*r),l=(e.x-i-r*c)/t;return this.translate(l,c)}decompose(){let e=this._m[0],t=this._m[1],s=this._m[2],r=this._m[3],o=this._m[4],i=this._m[5],a=e*r-t*s,c={x:o,y:i,angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(e!==0||t!==0){let l=Math.sqrt(e*e+t*t);c.angle=t>0?Math.acos(e/l):-Math.acos(e/l),c.scaleX=l,c.scaleY=a/l,c.skewX=(e*s+t*r)/a,c.skewY=0}else if(s!==0||r!==0){let l=Math.sqrt(s*s+r*r);c.angle=Math.PI/2-(r>0?Math.acos(-s/l):-Math.acos(s/l)),c.scaleX=a/l,c.scaleY=l,c.skewX=0,c.skewY=(e*s+t*r)/a}return c.angle=l6(c.angle),c}makeBoundingBoxFromPoints(e){if(this)for(let u=0;u<e.length;u++)e[u]=this.applyPoint(e[u]);const t=[e[0].x,e[1].x,e[2].x,e[3].x],s=Math.min(...t),o=Math.max(...t)-s,i=[e[0].y,e[1].y,e[2].y,e[3].y],a=Math.min(...i),l=Math.max(...i)-a;return{left:s,top:a,width:o,height:l,points:e}}composeMatrix(e){const t=new $e([1,0,0,1,e.left||0,e.top||0]);return e.angle&&t.rotate(e.angle),(e.scaleX!==1||e.scaleY!==1||e.skewX||e.skewY||e.flipX||e.flipY)&&t.multiply(this._calcDimensionsMatrix(e)),this._m=t.getMatrix(),this}_calcDimensionsMatrix(e){var o,i;const t=(o=e.scaleX)!=null?o:1,s=(i=e.scaleY)!=null?i:1,r=new $e([e.flipX?-t:t,0,0,e.flipY?-s:s,0,0]);return e.skewX&&r.multiply(new $e([1,0,Math.tan(us(e.skewX)),1,0,0])),e.skewY&&r.multiply(new $e([1,Math.tan(us(e.skewY)),0,1,0,0])),r}clone(){return new $e([...this._m])}}function gl(n,e,t){let s=0,r=0,o=0,i=0;const{startX:a,startY:c,endX:l,endY:u}=t;e===ut.TOP?(s=a,r=c,o=l,i=c):e===ut.BOTTOM?(s=a,r=u,o=l,i=u):e===ut.LEFT?(s=a,r=c,o=a,i=u):e===ut.RIGHT&&(s=l,r=c,o=l,i=u),n.beginPath(),n.moveTo(s,r),n.lineTo(o,i),n.stroke()}function ml(n,e){e===_.HAIR?n.setLineDash([1,2]):e===_.DASH_DOT_DOT||e===_.MEDIUM_DASH_DOT_DOT?n.setLineDash([2,2,5,2,2]):e===_.DASH_DOT||e===_.MEDIUM_DASH_DOT||e===_.SLANT_DASH_DOT?n.setLineDash([2,5,2]):e===_.DOTTED?n.setLineDash([2]):e===_.DASHED||e===_.MEDIUM_DASHED?n.setLineDash([3]):n.setLineDash([0])}function _l(n){let e=1;return n===_.MEDIUM||n===_.MEDIUM_DASH_DOT||n===_.MEDIUM_DASHED||n===_.MEDIUM_DASH_DOT_DOT?e=2:n===_.THICK&&(e=3),e}function en(n,e,t,s,r=Q.create(0,0)){const o=n.add(e).rotateByPoint(s),i=o.subtract(e),a=s-t;return i.rotateByPoint(a,o).add(r).transformCoordinateOnRotate(a)}function e6(n){return n>0?or.DOWN:or.UP}function t6(n,e,t){const s=[];let r=0,o=0,i=0,a=0,c=0;const l=e6(t),u=n.length;t=Math.abs(t);const h=Math.tan(t),d=Math.sin(t),f=Math.cos(t);if(l===or.UP){let g=0;for(let b=0;b<u;b++){const p=n[b],{lineHeight:v=0}=p;g+=b===0?0:v;const C=(v/h+e)*d;s.push(g/h),C>o&&(o=C),b===0&&(i+=v*d,c+=v*f)}i+=g/d+e*f,c-=o}else{let g=0,b=-1;const p=[];for(let w=u-1;w>=0;w--){const x=n[w],{lineHeight:A=0}=x,z=A/h,R=(e+z)*d;p.unshift(A/h),R>o&&(o=R,g=z,b=w),w===0?i+=A*d:w===u-1?i+=e*f+A/d:i+=A/d}let v=n[b].lineHeight||0,C=0;for(let w=b+1;w<=u-1;w++){const x=n[w],{lineHeight:A=0}=x;v+=A,C+=p[w]||0,s[w]=-C}C=0;for(let w=b-1;w>=0;w--){const x=n[w],{lineHeight:A=0}=x;C+=p[w+1]||0,s[w]=C,r+=A}s[b]=0,u===1&&(i+=e*f),a=v/d-g*f}return{rotateTranslateXList:s,rotatedHeight:o,rotatedWidth:i,fixOffsetX:a,fixOffsetY:c,rotateTranslateY:r}}const n6=[new Q(0,0),new Q(1,1)];class s6{constructor(e=n6){this._lines=e}intersection(e){if(this._lines.length<1||e.length<1)return;const t=[];for(let s=1;s<this._lines.length;s++){const r=this._lines[s-1],o=this._lines[s];for(let i=1;i<e.length;i++){const a=this._lines[s-1],c=this._lines[s],l=this._intersection({from:r,to:o},{from:a,to:c});l&&t.push(l)}}return t}_intersection(e,t){const s=e.from,r=e.to,o=t.from,i=t.to;let a=(s.x-o.x)*(r.y-o.y)-(s.y-o.y)*(r.x-o.x),c=(s.x-i.x)*(r.y-i.y)-(s.y-i.y)*(r.x-i.x);if(a*c>=0)return!1;let l=(o.x-s.x)*(i.y-s.y)-(o.y-s.y)*(i.x-s.x),u=l+a-c;if(l*u>=0)return!1;let h=l/(c-a),d=h*(r.x-s.x),f=h*(r.y-s.y);return new Q(s.x+d,s.y+f)}}const r6=Math.PI/180,o6=180/Math.PI,wi="rgb(",i6="rgba(",Ke=(n,e)=>n?e!=null?`${i6+n.join(",")},${e})`:`${wi+n.join(",")})`:`${wi}0,0,0)`,sn=(n,e)=>{if(S.isNumber(n))return n;if(e&&n&&S.isString(n)&&n.substr(n.length-1,1)==="%"){const t=parseFloat(n)/100;return e*t}return 0},ar=(n,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(n):e.requestAnimationFrame?e.requestAnimationFrame(n):e.msRequestAnimationFrame?e.msRequestAnimationFrame(n):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(n):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(n):e.oRequestAnimationFrame?e.oRequestAnimationFrame(n):window.setTimeout(n,16)),a6=(n,e)=>(e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(n):e.requestAnimationFrame?e.cancelAnimationFrame(n):e.msRequestAnimationFrame?e.msCancelAnimationFrame(n):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(n):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(n):e.oRequestAnimationFrame?e.oCancelAnimationFrame(n):window.clearTimeout(n)),bl=()=>{let n=document.createElement("canvas");try{n.style=n.style||{}}catch(e){console.error(e)}return n},l6=n=>n*o6,us=n=>n*r6,Ei=()=>{let n="pointer";return typeof window!="undefined"&&!window.PointerEvent&&typeof navigator!="undefined"&&!navigator.pointerEnabled&&(n="mouse"),S.isTablet()&&!S.isIPhone()&&!(document&&"ontouchend"in document)&&(n="mouse"),n},c6=()=>S.getBrowserType()==="safari",u6=(n="obj",e=4)=>{let t=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),s="";for(let o=0;o<e;o++)s+=t[Math.round(Math.random()*(t.length-1))];let r=new Date().getTime();return`${n}_${s}_${r}`};function pl(n){return Object.prototype.toString.apply(n)}function h6(n){return pl(n)==="[object Function]"}function Ti(n){return pl(n)==="[object String]"}function Yr(n,e){return e=10**e,Math.round(n*e)/e}function ve(n,e){return Math.round(n*e)/e}function vl(n,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:t,defaultFontSize:s}=e;if(!n)return{fontString:`${s}px  ${t[0]}`,fontSize:s,fontFamily:t[0]};let r=ns.ITALIC;(n.it===0||n.it===void 0)&&(r=ns.NORMAL);let o=ns.BOLD;(n.bl===0||n.bl===void 0)&&(o=ns.NORMAL);let i=s;n.fs&&(i=Math.ceil(n.fs));let a=t[0];if(n.ff){let u=n.ff;u=u.replace(/"/g,"").replace(/'/g,""),u.indexOf(" ")>-1&&(u=`"${u}"`),u==null&&(u=t[0]),a=u}const{va:c}=n;if(c===Dt.SUBSCRIPT||c===Dt.SUPERSCRIPT){const u=jn.getBaselineOffsetInfo(a,i),{sbr:h,spr:d}=u;i*=c===Dt.SUBSCRIPT?h:d}return{fontString:`${r} ${o} ${i}px ${a}, ${Kh} `,fontSize:i,fontFamily:a}}function Cl(n){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(n)}function wl(n){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(n)}function El(n){return!!/[\u0180-\u024F]/gi.exec(n)}function bo(n){const{scaleX:e=1,scaleY:t=1}=n;return Math.max(e,t)}function d6(n,e,t,s){const r=n-1,o=e-1;let i=t[r]||0,a=t[n],c=s[o]||0,l=s[e];return{startY:i,endY:a,startX:c,endX:l}}function f6(n,e,t,s,r){let{startY:o,endY:i,startX:a,endX:c}=d6(n,e,t,s);const{isMerged:l,isMergedMainCell:u,newEndRow:h,newEndColumn:d,mergeRow:f,mergeColumn:g}=g6(n,e,r);let b={startRow:f,startColumn:g,endRow:h,endColumn:d,startY:0,endY:0,startX:0,endX:0};if(l&&f!==-1&&g!==-1){let p=t[f-1]||0,v=t[h],C=s[g-1]||0,w=s[d];b={...b,startY:p,endY:v,startX:C,endX:w}}else!l&&h!==-1&&d!==-1&&(i=t[h]||0,c=s[d]||0);return{isMerged:l,isMergedMainCell:u,row:n,column:e,startY:o,endY:i,startX:a,endX:c,mergeInfo:b}}function g6(n,e,t){let s=!1,r=!1,o=-1,i=-1,a=-1,c=-1;return t==null||t.forEach((l,u)=>{let h=!1;if(u==null||u.forEach((d,f)=>{const{startRow:g,endRow:b,startColumn:p,endColumn:v}=f;if(n===g&&e===p)return o=b,i=v,a=g,c=p,h=!0,r=!0,!1;if(n>=g&&n<=b&&e>=p&&e<=v)return o=b,i=v,a=g,c=p,h=!0,s=!0,!1}),h)return!1}),{isMergedMainCell:r,isMerged:s,newEndRow:o,newEndColumn:i,mergeRow:a,mergeColumn:c}}function m6(n){const e=document.createElement("style");document.head.appendChild(e);const t=e.sheet;for(let s of n)t==null||t.insertRule(s,t.cssRules.length)}function _6(n){for(let e=0,t=document.head.childNodes.length;e<t;e++){const s=document.head.childNodes[e];if(s.nodeName==="STYLE"&&s.textContent&&s.textContent.indexOf(n)>-1)return!0}return!1}function An(n){return Number(n.replace(/px/gi,""))}function b6(n){const e=getComputedStyle(n),{borderTopWidth:t,borderLeftWidth:s,borderRightWidth:r,borderBottomWidth:o,width:i,height:a}=e;return{top:An(t),left:An(s),right:An(r),bottom:An(o),width:An(i),height:An(a)}}const p6="documentCustomBlock",v6="documentCustomBullet";function C6(n,e,t,s,r,o){if(!o)return[];const i=o.getPluginManager().getPluginByName(p6);return i?i.dealWidthCustomBlock(n,e,t,s,r):[]}function w6(n,e,t,s){if(!s)return"";const r=s.getPluginManager().getPluginByName(v6);return r?r.dealWidthCustomBulletOrderedSymbol(n,e,t):""}const Xr=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class Kn{constructor(e){this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new $e,this._dirty=!0,this._cursor=ze.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this.isInGroup=!1,this.onTransformChangeObservable=new me,this.onPointerDownObserver=new me,this.onPointerMoveObserver=new me,this.onPointerUpObserver=new me,this.onDblclickObserver=new me,this.onMouseWheelObserver=new me,this.onPointerOutObserver=new me,this.onPointerLeaveObserver=new me,this.onPointerOverObserver=new me,this.onPointerEnterObserver=new me,this.onIsAddedToParentObserver=new me,this.onDisposeObserver=new me,e?this._oKey=e:this._oKey=u6()}makeDirty(e=!0){return this._dirty=e,e&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout(()=>{var t;(t=this.parent)==null||t.makeDirty(e)},0)),this}makeDirtyNoDebounce(e=!0){var t;return this._dirty=e,e&&((t=this.parent)==null||t.makeDirty(e)),this}isDirty(){return this._dirty}get transform(){return this._transform}set transform(e){this._transform=e}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return fe.BASE_OBJECT}translate(e,t){const s=this.top;t!==void 0&&(this.top=t);const r=this.left;return e!==void 0&&(this.left=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.translate,value:{top:this._top,left:this._left},preValue:{top:s,left:r}}),this}resize(e,t){const s=this.width;e!==void 0&&(this.width=e);const r=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.resize,value:{width:this._width,height:this._height},preValue:{width:s,height:r}}),this}scale(e,t){const s=this.scaleX;e!==void 0&&(this.scaleX=e);const r=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:s,scaleY:r}}),this}skew(e,t){const s=e;e!==void 0&&(this.skewX=e);const r=t;return t!==void 0&&(this.skewY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:s,skewY:r}}),this}flip(e,t){const s=e;e!==void 0&&(this.flipX=e);const r=t;return t!==void 0&&(this.flipY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:s,flipY:r}}),this}transformByState(e){const t=Object.keys(e),s={};if(t.length!==0)return t.forEach(r=>{e[r]!==void 0&&(s[r]=this[r],this[r]=e[r])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.all,value:e,preValue:s}),this}isRender(e){return this._forceRender?!1:e&&!this.isInGroup}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}_setTransForm(){const e=$e.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=e,this._makeDirtyMix()}get top(){return this._top}set top(e){var t;this._topOrigin=e,this._top=sn(e,(t=this._parent)==null?void 0:t.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=sn(e,(t=this._parent)==null?void 0:t.width)}get width(){return this._width}set width(e){var t;this._widthOrigin=e,this._width=sn(e,(t=this._parent)==null?void 0:t.width)}get height(){return this._height}set height(e){var t;this._heightOrigin=e,this._height=sn(e,(t=this._parent)==null?void 0:t.height)}get strokeWidth(){return this._strokeWidth}set strokeWidth(e){this._strokeWidth=e}get angle(){return this._angle}set angle(e){this._angle=e}get scaleX(){return this._scaleX}set scaleX(e){this._scaleX=e}get scaleY(){return this._scaleY}set scaleY(e){this._scaleY=e}get ancestorScaleX(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=((t=this.getParent())==null?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}set skewX(e){this._skewX=e}get skewY(){return this._skewY}set skewY(e){this._skewY=e}get flipX(){return this._flipX}set flipX(e){this._flipX=e}get flipY(){return this._flipY}set flipY(e){this._flipY=e}get parent(){return this._parent}set parent(e){this._parent=e}getParent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}set zIndex(e){this._zIndex=e}get evented(){return this._evented}set evented(e){this._evented=e}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}set debounceParentDirty(e){this._debounceParentDirty=e}get isTransformer(){return this._isTransformer}set isTransformer(e){this._isTransformer=e}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(e,t){}isHit(e){const t=this._getInverseCoord(e);return t.x>=-this.strokeWidth/2&&t.x<=this.width+this.strokeWidth/2&&t.y>=-this.strokeWidth/2&&t.y<=this.height+this.strokeWidth/2}_getInverseCoord(e){return this._transform.clone().invert().applyPoint(e)}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}clear(e){this[`on${e}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(e){var t,s;return(t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerPointerMove(e),!1)}triggerPointerDown(e){var t,s;return(t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerPointerDown(e),!1)}triggerPointerUp(e){var t,s;return(t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerPointerUp(e),!1)}triggerDblclick(e){var t,s;return(t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerDblclick(e),!1)}triggerMouseWheel(e){var t,s;return(t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerMouseWheel(e),!1)}triggerPointerOut(e){var t,s;return(t=this.onPointerOutObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerPointerOut(e),!1)}triggerPointerLeave(e){var t,s;return(t=this.onPointerLeaveObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerPointerLeave(e),!1)}triggerPointerOver(e){var t;return this.onPointerOverObserver.notifyObservers(e)?!0:((t=this._parent)==null||t.triggerPointerOver(e),!1)}triggerPointerEnter(e){var t,s;return(t=this.onPointerEnterObserver.notifyObservers(e))!=null&&t.stopPropagation?!0:((s=this._parent)==null||s.triggerPointerEnter(e),!1)}dispose(){var e;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),(e=this.parent)==null||e.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const e={};return Xr.forEach(t=>{this[t]&&(e[t]=this[t])}),e}getScene(){let e=this.parent;if(e!=null){if(e.classType===fe.SCENE)return e;for(;e;){if(e.classType===fe.SCENE)return e;e=e.getParent()}}}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(ze.DEFAULT)}setCursor(e){var t;this._cursor=e,(t=this.getScene())==null||t.setCursor(e)}getEngine(){let e=this.getParent();for(;e!=null;){if(e===fe.ENGINE)return e;e=e.getParent()}return null}}function Fn(n){const e=n.getScene(),t=n.getViewportByCoord(e);let s=0,r=0;if(!t)return{scrollX:s,scrollY:r};const o=t.getActualScroll(t.scrollX,t.scrollY);return{scrollX:o.x,scrollY:o.y}}function E6(n){let e=n.getBoundingClientRect(),t=document.body,s=document.documentElement,r=window.pageYOffset||s.scrollTop||t.scrollTop,o=window.pageXOffset||s.scrollLeft||t.scrollLeft,i=s.clientTop||t.clientTop,a=s.clientLeft||t.clientLeft,c=e.top+r-i,l=e.left+o-a;return{top:c,left:l}}function gr(n,e){const t=n.transform.clone().invert().applyPoint(e.tl),s=n.transform.clone().invert().applyPoint(e.tr),r=n.transform.clone().invert().applyPoint(e.bl),o=n.transform.clone().invert().applyPoint(e.br),i=[t.x,s.x,r.x,o.x],a=[t.y,s.y,r.y,o.y],c=Math.max(...i),l=Math.min(...i),u=Math.max(...a),h=Math.min(...a);return{minX:l,maxX:c,minY:h,maxY:u}}function Tl(){let n=1,t=bl().getContext("2d");return n=(()=>{let s=window.devicePixelRatio||1,r=t.webkitBackingStorePixelRatio||t.mozBackingStorePixelRatio||t.msBackingStorePixelRatio||t.oBackingStorePixelRatio||t.backingStorePixelRatio||1;return s/r})(),n<1?1:Math.ceil(n*10)/10}class ys{constructor(e){this._pixelRatio=1,this._width=0,this._height=0,this.isCache=!1,e=e||{},this._canvasEle=bl(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(e.width,e.height,e.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(e,t,s){this._pixelRatio=s||Tl(),e&&(this._width=e,this._canvasEle.width=e*this._pixelRatio,this._canvasEle.style.width=`${e}px`),t&&(this._height=t,this._canvasEle.height=t*this._pixelRatio,this._canvasEle.style.height=`${t}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(e){this._width===0||this._height===0||(e<1&&(e=1),this.setSize(this._width,this._height,e))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(e,t){try{return this._canvasEle.toDataURL(e,t)}catch{try{return this._canvasEle.toDataURL()}catch(r){const{message:o}=r;return console.error(`Unable to get data URL. ${o} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class Rl{constructor(e=100,t=100){this._canvas=new ys,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this.onInputChangedObservable=new me,this.renderEvenInBackground=!0,this._usingSafari=c6(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new Jh,this.onBeginFrameObservable=new me,this.onEndFrameObservable=new me,this.onTransformChangeObservable=new me,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=navigator.userAgent.indexOf("Firefox")!==-1,this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(e,t),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return fe.ENGINE}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(e){return this._scenes[e]}hasScene(e){return e in this._scenes}addScene(e){const t=e.sceneKey;return this.hasScene(t)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[t]=e,e}setActiveScene(e){const t=this.getScene(e);return t&&(this._activeScene=t),t}hasActiveScene(){return this._activeScene!=null}get activeScene(){return this._activeScene}setContainer(e){this._container=e,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:e,height:t}=b6(this._container);this.resizeBySize(e,t)}resizeBySize(e,t){const s=this.width,r=this.height;this._canvas.setSize(e,t),this.onTransformChangeObservable.notifyObservers({type:qe.resize,value:{width:e,height:t},preValue:{width:s,height:r}})}dispose(){const e=this.getScenes();Object.keys(e).forEach(r=>{e[r].dispose()});const s=Ei();this._canvasEle.removeEventListener(`${s}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${s}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${s}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(e){const t=this.getScenes();if(t[e]){const s=t[e];return delete t[e],s}}runRenderLoop(e){this._activeRenderLoops.indexOf(e)===-1&&(this._activeRenderLoops.push(e),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=ar(this._renderFunction)))}get requestNewFrameHandler(){return this._requestNewFrameHandler}_renderLoop(){let e=!0;this.renderEvenInBackground||(e=!1),e&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=ar(this._renderFunction):this._renderingQueueLaunched=!1}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}get frameId(){return this._frameId}getDeltaTime(){return this._deltaTime}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_renderFrame(){for(let e=0;e<this._activeRenderLoops.length;e++){let t=this._activeRenderLoops[e];t()}}_handleKeyboardAction(){const e=s=>{let r=s;r.deviceType=bt.Keyboard,r.inputIndex=s.keyCode,r.previousState=0,r.currentState=1,this.onInputChangedObservable.notifyObservers(r)},t=s=>{let r=s;r.deviceType=bt.Keyboard,r.inputIndex=s.keyCode,r.previousState=1,r.currentState=0,this.onInputChangedObservable.notifyObservers(r)};this._canvasEle.addEventListener("keydown",e),this._canvasEle.addEventListener("keyup",t)}_handlePointerAction(){const e=Ei();this._pointerMoveEvent=t=>{const s=this.__getPointerType(t),r=this.__pointer[se.Horizontal],o=this.__pointer[se.Vertical],i=this.__pointer[se.DeltaHorizontal],a=this.__pointer[se.DeltaVertical];this.__pointer[se.Horizontal]=t.clientX,this.__pointer[se.Vertical]=t.clientY,this.__pointer[se.DeltaHorizontal]=t.movementX,this.__pointer[se.DeltaVertical]=t.movementY;let c=t;c.deviceType=s,r!==t.clientX&&(c.inputIndex=se.Horizontal,c.previousState=r,c.currentState=this.__pointer[se.Horizontal],this.onInputChangedObservable.notifyObservers(c)),o!==t.clientY&&(c.inputIndex=se.Vertical,c.previousState=o,c.currentState=this.__pointer[se.Vertical],this.onInputChangedObservable.notifyObservers(c)),this.__pointer[se.DeltaHorizontal]!==0&&(c.inputIndex=se.DeltaHorizontal,c.previousState=i,c.currentState=this.__pointer[se.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(c)),this.__pointer[se.DeltaVertical]!==0&&(c.inputIndex=se.DeltaVertical,c.previousState=a,c.currentState=this.__pointer[se.DeltaVertical],this.onInputChangedObservable.notifyObservers(c)),!this._usingSafari&&t.button!==-1&&(c.inputIndex=t.button+2,c.previousState=this.__pointer[t.button+2],this.__pointer[t.button+2]=this.__pointer[t.button+2]?0:1,c.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(c))},this._pointerDownEvent=t=>{const s=this.__getPointerType(t),r=this.__pointer[se.Horizontal],o=this.__pointer[se.Vertical],i=this.__pointer[t.button+2];s===bt.Mouse?(this.__mouseId===-1&&(t.pointerId===void 0?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=t.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):t.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(t.pointerId),this.__pointer[se.Horizontal]=t.clientX,this.__pointer[se.Vertical]=t.clientY,this.__pointer[t.button+2]=1;let a=t;a.deviceType=s,r!==t.clientX&&(a.inputIndex=se.Horizontal,a.previousState=r,a.currentState=this.__pointer[se.Horizontal],this.onInputChangedObservable.notifyObservers(a)),o!==t.clientY&&(a.inputIndex=se.Vertical,a.previousState=o,a.currentState=this.__pointer[se.Vertical],this.onInputChangedObservable.notifyObservers(a)),a.inputIndex=t.button+2,a.previousState=i,a.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(a)},this._pointerUpEvent=t=>{const s=this.__getPointerType(t),r=this.__pointer[se.Horizontal],o=this.__pointer[se.Vertical],i=this.__pointer[t.button+2];this.__pointer[se.Horizontal]=t.clientX,this.__pointer[se.Vertical]=t.clientY,this.__pointer[t.button+2]=0;let a=t;a.deviceType=s,r!==t.clientX&&(a.inputIndex=se.Horizontal,a.previousState=r,a.currentState=this.__pointer[se.Horizontal],this.onInputChangedObservable.notifyObservers(a)),o!==t.clientY&&(a.inputIndex=se.Vertical,a.previousState=o,a.currentState=this.__pointer[se.Vertical],this.onInputChangedObservable.notifyObservers(a)),a.inputIndex=t.button+2,a.previousState=i,a.currentState=this.__pointer[t.button+2],s===bt.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):t.pointerId&&this._canvasEle.hasPointerCapture(t.pointerId)&&this._canvasEle.releasePointerCapture(t.pointerId),this.onInputChangedObservable.notifyObservers(a),s!==bt.Mouse&&(this.__pointer={})},this._pointerBlurEvent=t=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=t=>{const s=bt.Mouse;let r=this.__pointer[se.MouseWheelX],o=this.__pointer[se.MouseWheelY],i=this.__pointer[se.MouseWheelZ];this.__pointer[se.MouseWheelX]=t.deltaX||0,this.__pointer[se.MouseWheelY]=t.deltaY||t.wheelDelta||0,this.__pointer[se.MouseWheelZ]=t.deltaZ||0;let a=t;a.deviceType=s,this.__pointer[se.MouseWheelX]!==0&&(a.inputIndex=se.MouseWheelX,a.previousState=r,a.currentState=this.__pointer[se.MouseWheelX],this.onInputChangedObservable.notifyObservers(a)),this.__pointer[se.MouseWheelY]!==0&&(a.inputIndex=se.MouseWheelY,a.previousState=o,a.currentState=this.__pointer[se.MouseWheelY],this.onInputChangedObservable.notifyObservers(a)),this.__pointer[se.MouseWheelZ]!==0&&(a.inputIndex=se.MouseWheelZ,a.previousState=i,a.currentState=this.__pointer[se.MouseWheelZ],this.onInputChangedObservable.notifyObservers(a))},this._canvasEle.addEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,this._getPassive()?{passive:!1}:!1)}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":document.onmousewheel!==void 0?"mousewheel":"DOMMouseScroll"}_getPassive(){let e=!1;const t=()=>{};try{const s={passive:{get(){e=!0}}};this._canvasEle.addEventListener("test",t,s),this._canvasEle.removeEventListener("test",t,s)}catch{}return e}__getPointerType(e){let t=bt.Mouse;return(e.pointerType==="touch"||e.pointerType==="pen"||e.touches)&&(t=bt.Touch),t}}class T6{constructor(e,t=[],s=1){this._scene=e,this._zIndex=s,this._objects=[],this.addObjects(t)}static create(e,t=[],s=1e3){return new this(e,t,s)}get scene(){return this._scene}get zIndex(){return this._zIndex}getObjectsByOrder(){const e=[];this._objects.sort(rt);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjectsByOrderForPick(){const e=[];this._objects.sort(rt);for(let t of this._objects)t.classType!==fe.GROUP&&t.visible&&e.push(t);return e}getObjects(){return this._objects}addObject(e){if(e.classType===fe.GROUP){const t=e.getObjects();for(let s of t)this.scene.getObject(s.oKey)||(this._objects.push(s),this.scene.setObjectBehavior(s))}return this._objects.push(e),this.scene.setObjectBehavior(e),this.scene.applyTransformer(e),this}removeObject(e){const t=this.getObjects(),s=t.length;if(e instanceof Kn){for(let r=0;r<s;r++)if(t[r]===e){t.splice(r,1);return}}else for(let r=0;r<s;r++)if(t[r].oKey===e){t.splice(r,1);return}}addObjects(e){return e.forEach(t=>{this.addObject(t)}),this}clear(){this._objects=[]}dispose(){this.getObjects().forEach(e=>{e.dispose()}),this.clear()}}const Us=class{constructor(n){this._alreadyAttached=!1,this._startingPosition=new Q(1/0,1/0),this._doubleClickOccurred=0,this._scene=n}_getCurrentObject(n,e){var t;return(t=this._scene)==null?void 0:t.pick(Q.FromArray([n,e]))}_checkDirectSceneEventTrigger(n,e){let t=!1;e==null&&(t=!0);let s=!0;if(e&&e.classType===fe.BASE_OBJECT){const r=e.getScene();r&&(s=r.getParent().classType!==fe.SCENE_VIEWER)}return!this._scene.evented&&n&&s||t}mouseLeaveEnterHandler(n,e){var t;if(n==null)(t=this._currentMouseEnterPicked)==null||t.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(n!==this._currentMouseEnterPicked){const s=this._currentMouseEnterPicked;this._currentMouseEnterPicked=n,s==null||s.triggerPointerLeave(e),n==null||n.triggerPointerEnter(e)}}attachControl(n=!0,e=!0,t=!0,s=!0){const r=this._scene.getEngine();!r||(this._onPointerMove=o=>{o.pointerId===void 0&&(o.pointerId=0);const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerPointerMove(o);this.mouseLeaveEnterHandler(i,o),this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(o)},this._onPointerDown=o=>{o.pointerId===void 0&&(o.pointerId=0);const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerPointerDown(o);this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(o)},this._onPointerUp=o=>{o.pointerId===void 0&&(o.pointerId=0);const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerPointerUp(o);this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(o),this._prePointerDoubleClick(o)},this._onMouseWheel=o=>{const i=this._getCurrentObject(o.offsetX,o.offsetY),a=i==null?void 0:i.triggerMouseWheel(o);this._scene.getViewports().forEach(c=>{c.onMouseWheelObserver.hasObservers()&&c.onMouseWheelObserver.notifyObservers(o)}),this._checkDirectSceneEventTrigger(!a,i)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(o)},this._onKeyDown=o=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(o)},this._onKeyUp=o=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(o)},this._onInputObserver=r.onInputChangedObservable.add(o=>{const i=o;o.deviceType===bt.Keyboard&&(o.currentState===1&&this._onKeyDown(i),o.currentState===0&&this._onKeyUp(i)),(o.deviceType===bt.Mouse||o.deviceType===bt.Touch)&&(n&&o.inputIndex>=se.LeftClick&&o.inputIndex<=se.RightClick&&o.currentState===1&&this._onPointerDown(i),e&&o.inputIndex>=se.LeftClick&&o.inputIndex<=se.RightClick&&o.currentState===0&&this._onPointerUp(i),t&&(o.inputIndex===se.Horizontal||o.inputIndex===se.Vertical||o.inputIndex===se.DeltaHorizontal||o.inputIndex===se.DeltaVertical)?this._onPointerMove(i):s&&(o.inputIndex===se.MouseWheelX||o.inputIndex===se.MouseWheelY||o.inputIndex===se.MouseWheelZ)&&this._onMouseWheel(i))}),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const n=this._scene.getEngine();!n||(n.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_isPointerSwiping(n,e){return Math.abs(this._startingPosition.x-n)>Us.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>Us.DragMovementThreshold}_prePointerDoubleClick(n){var r,o;const{clientX:e,clientY:t}=n;if(this._doubleClickOccurred===0&&(this._startingPosition.x=e,this._startingPosition.y=t),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout(()=>{this._resetDoubleClickParam()},Us.DoubleClickDelay),this._doubleClickOccurred<2)return;if(this._isPointerSwiping(e,t)){this._resetDoubleClickParam();return}(o=(r=this._scene)==null?void 0:r.pick(Q.FromArray([n.offsetX,n.offsetY])))==null||o.triggerDblclick(n),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(n),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",n)}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let As=Us;As.DragMovementThreshold=10;As.LongPressDelay=500;As.DoubleClickDelay=300;As.ExclusiveDoubleClickMode=!1;class R6 extends Kn{constructor(e,...t){super(e),this._objects=[],this.addObjects(...t)}set cursor(e){this.setCursor(e)}get classType(){return fe.GROUP}addObjects(...e){for(const t of e)this.addObject(t)}addObject(e){let t=e;if(Ti(e)){const s=this.getScene();if(t=s==null?void 0:s.getObject(e),!t){console.info("No object be added");return}t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}else e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}removeObject(e){const t=this.getObjects(),s=t.length;if(Ti(e))for(let r=0;r<s;r++){const o=t[r];if(o.oKey===e){t.splice(r,1),this.parent.removeObject(o);return}}else for(let r=0;r<s;r++){const o=t[r];if(o===e){t.splice(r,1),this.parent.removeObject(o);return}}}getObjectsByOrder(){const e=[];this._objects.sort(rt);for(let t of this._objects)!t.isInGroup&&t.visible&&e.push(t);return e}getObjects(){return this._objects}render(e,t){e.save();const s=this.transform.getMatrix();e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._objects.sort(rt);for(let r of this._objects)r.render(e,this._transformBounds(t));e.restore()}resize(e,t){return this}scale(e,t){return this}skew(e,t){return this}flip(e,t){return this}_transformBounds(e){return e}isHit(e){return!0}pick(e){}dispose(){this.getObjects().forEach(e=>{e.dispose()}),super.dispose()}}class vs{constructor(e,t,s=.05,r=.05){this._scene=e,this._padding=t,this._smoothRatioX=s,this._smoothRatioY=r,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:20})}startScroll(e,t){this._offsetX=e,this._offsetY=t,this._moveX=e,this._moveY=t,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(e){const t=(e==null?void 0:e.top)||0,s=t+((e==null?void 0:e.height)||0),r=(e==null?void 0:e.left)||0,o=r+((e==null?void 0:e.width)||0),{t:i=0,b:a=0,r:c=0,l=0}=this._padding;let u=0,h=0;this._moveX<r+l&&(u=(this._moveX-r-l)*this._smoothRatioX),this._moveX>o-c&&(u=(this._moveX-o+c)*this._smoothRatioX),this._moveY<t+i&&(h=(this._moveY-t-i)*this._smoothRatioY),this._moveY>s-a&&(h=(this._moveY-s+a)*this._smoothRatioY);const d=e==null?void 0:e.scrollBy({x:u,y:h}),f=e==null?void 0:e.getActualScroll(u,h);if(this._scrollX=(f==null?void 0:f.x)||0,this._scrollY=(f==null?void 0:f.y)||0,d){const g=this._findAncestorScene(e==null?void 0:e.scene),b=this.getViewportByCoord(g);b&&this._scroll(b)}}scrolling(e,t,s){this._moveX=e,this._moveY=t,this._scrollFunction=s}stopScroll(){a6(this._requestNewFrameNumber)}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=ar(this._runRenderLoop.bind(this))}_findAncestorScene(e){let t=e==null?void 0:e.getParent();for(;t;){if(t.classType===fe.SCENE)return t;t=(t==null?void 0:t.getParent)&&(t==null?void 0:t.getParent())}}getViewportByCoord(e){const t=e==null?void 0:e.getViewports();return t==null?void 0:t.find(s=>s.isHit(Q.FromArray([this._offsetX,this._offsetY])))}getScene(){return this._scene}static create(e,t){return new vs(e,t)}}const D6=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class po extends Kn{constructor(e,t){super(e),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new ys,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._initialProps(t)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:r,maxX:o,minY:i,maxY:a}=gr(this,t);if(this.width+this.strokeWidth<r||o<0||this.height+this.strokeWidth<i||a<0)return this}const s=this.transform.getMatrix();if(e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._allowCache){if(this.isDirty()){const r=this._cacheCanvas.getContext();this._cacheCanvas.clear(),r.save(),r.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(r),r.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_draw(e){}_initialProps(e){if(!e)return;const t=Object.keys(e);if(t.length===0)return;const s={};let r=!1;t.forEach(o=>{if(e[o]===void 0)return!0;Xr.indexOf(o)>-1?(s[o]=e[o],r=!0):this[`_${o}`]=e[o]}),r&&this.transformByState(s),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(s=>{if(e[s]===void 0)return!0;Xr.indexOf(s)===-1&&(this[`_${s}`]=e[s])}),this.makeDirty(!0),this}resizeCacheCanvas(){var e;(e=this._cacheCanvas)==null||e.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var s,r,o;let e=((s=this.getParent())==null?void 0:s.ancestorScaleX)||1,t=((r=this.getParent())==null?void 0:r.ancestorScaleX)||1;(o=this._cacheCanvas)==null||o.setPixelRatio(Math.max(e,t)*Tl()),this.makeDirty(!0)}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),s=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,s,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}static _renderPaintInOrder(e,t){t.paintFirst==="stroke"?(this._renderStroke(e,t),this._renderFill(e,t)):(this._renderFill(e,t),this._renderStroke(e,t))}static _renderFill(e,t){!t.fill||(e.save(),this.__setFillStyles(e,t),t.fillRule==="evenodd"?e.fill("evenodd"):e.fill(),e.restore())}static _renderStroke(e,t){let{stroke:s,strokeWidth:r,shadowEnabled:o,shadowForStrokeEnabled:i,strokeScaleEnabled:a,scaleX:c,scaleY:l,parent:u}=t;if(!(!s||r===0)){if(o&&!i&&this.__removeShadow(e),e.save(),a&&u){let h=this.__getObjectScaling();e.scale(1/h.scaleX,1/h.scaleY)}else a&&(c=c!=null?c:1,l=l!=null?l:1,e.scale(1/c,1/l));this.__setLineDash(e),this.__setStrokeStyles(e,t),e.stroke(),e.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(e){}static __setFillStyles(e,t){e.fillStyle=t.fill}static __setStrokeStyles(e,t){const{strokeWidth:s,strokeLineCap:r,strokeDashOffset:o,strokeLineJoin:i,strokeMiterLimit:a,stroke:c}=t;e.lineWidth=s,e.lineCap=r,e.lineDashOffset=o,e.lineJoin=i,e.miterLimit=a,e.strokeStyle=c}static __setLineDash(e){}static drawWith(e,t){}toJson(){const e={};return D6.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const I6=["radius"];class Ze extends po{constructor(e,t){super(e,t),t!=null&&t.radius&&(this._radius=t==null?void 0:t.radius)}get radius(){return this._radius}_draw(e){Ze.drawWith(e,this)}static drawWith(e,t){let{radius:s,width:r,height:o}=t;if(s=s!=null?s:0,r=r!=null?r:30,o=o!=null?o:30,e.beginPath(),t.strokeDashArray&&e.setLineDash(t.strokeDashArray),!s)e.rect(0,0,r,o);else{let i=0,a=0,c=0,l=0;i=a=c=l=Math.min(s,r/2,o/2),e.moveTo(i,0),e.lineTo(r-a,0),e.arc(r-a,a,a,Math.PI*3/2,0,!1),e.lineTo(r,o-l),e.arc(r-l,o-l,l,0,Math.PI/2,!1),e.lineTo(c,o),e.arc(c,o-c,c,Math.PI/2,Math.PI,!1),e.lineTo(0,i),e.arc(i,i,i,Math.PI,Math.PI*3/2,!1)}e.closePath(),this._renderPaintInOrder(e,t)}toJson(){const e={};return I6.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const y6=["pointsGroup"];class vo extends po{constructor(e,t){super(e,t),this._pointsGroup=(t==null?void 0:t.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add(s=>{const{type:r,value:o,preValue:i}=s;(r===qe.resize||r===qe.all)&&this.resizePolygon(i)})}get pointsGroup(){return this._pointsGroup}_draw(e){vo.drawWith(e,this)}static drawWith(e,t){let{pointsGroup:s}=t;s=s!=null?s:[[]],t.strokeDashArray&&e.setLineDash(t.strokeDashArray),e.beginPath();for(let r of s){e.moveTo(r[0].x,r[0].y);for(let o=1;o<r.length;o++){const i=r[o];e.lineTo(i.x,i.y)}}e.closePath(),this._renderPaintInOrder(e,t)}updatePointGroup(e){this._pointsGroup=e,this._setFixBoundingBox()}resizePolygon(e){const{left:t,top:s,width:r,height:o}=this._getSelfRect(),{width:i,height:a}=e;let c,l;i?c=this.width-i:c=0,a?l=this.height-a:l=0;const u=c/r,h=l/o;this.scaleX+=u,this.scaleY+=h,this.left=this.left-t*u,this.top=this.top-s*h,this._setTransForm()}toJson(){const e={};return y6.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}getState(){const{left:e,top:t,width:s,height:r}=this.getRect();return{left:e,top:t,width:s,height:r,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:e,top:t,width:s,height:r}=this._getSelfRect();return{left:e*this.scaleX+this.left,top:t*this.scaleY+this.top,width:s*this.scaleX,height:r*this.scaleY}}_setFixBoundingBox(){const{width:e,height:t,left:s,top:r}=this._getSelfRect();this.left=this.left+s,this.top=this.top+r,this.width=e,this.height=t;const o=this.pointsGroup;for(let i of o)for(let a of i)a.x-=s,a.y-=r;this._setTransForm()}_getSelfRect(){const e=this.pointsGroup;let t=e[0][0].x,s=e[0][0].x,r=e[0][0].y,o=e[0][0].y;for(let i of e)for(let a of i)t=Math.min(t,a.x),s=Math.max(s,a.x),r=Math.min(r,a.y),o=Math.max(o,a.y);return{left:t,top:r,width:s-t,height:o-r}}}const Sn=17;class Co{constructor(e,t){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=Ke(nn.black,.2),this._thumbHoverBackgroundColor=Ke(nn.black,.35),this._thumbActiveBackgroundColor=Ke(nn.black,.4),this._barSize=14,this._barBackgroundColor=Ke(nn.white),this._barBorder=1,this._barBorderColor=Ke([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,e||console.warn("Missing viewport"),this._view=e,this.setProps(t),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}setProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(s=>{e[s]!==void 0&&(this[`_${s}`]=e[s])})}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new Ze("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new Ze("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new Ze("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new Ze("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new Ze("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const e=this._mainScene||this._view.scene,t=(s,r)=>(o,i)=>{if(this._isHorizonMove||this._isVerticalMove)return;r.setProps({fill:s}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(nt.PointerEnter,t(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(nt.PointerLeave,t(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(nt.PointerDown,(s,r)=>{const o=s;this._view.scrollTo({x:o.offsetX-this._view.left-this._horizontalThumbWidth/2}),r.stopPropagation()}),this._horizonThumbRect.on(nt.PointerDown,(s,r)=>{const o=s;this._isHorizonMove=!0,this._lastX=o.offsetX,this._lastY=o.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),e.disableEvent(),r.stopPropagation()}),e.on(nt.PointerMove,(s,r)=>{const o=s;!this._isHorizonMove||(this._view.scrollBy({x:o.offsetX-this._lastX}),this._lastX=o.offsetX)}),e.on(nt.PointerUp,(s,r)=>{const o=this._horizonThumbRect;this._isHorizonMove=!1,e.enableEvent(),o.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})),this._enableVertical&&(this._verticalThumbRect.on(nt.PointerEnter,t(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(nt.PointerLeave,t(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(nt.PointerDown,(s,r)=>{const o=s;this._view.scrollTo({y:o.offsetY-this._view.top-this._verticalThumbHeight/2}),r.stopPropagation()}),this._verticalThumbRect.on(nt.PointerDown,(s,r)=>{const o=s,i=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=o.offsetX,this._lastY=o.offsetY,i.setProps({fill:this._thumbActiveBackgroundColor}),e.disableEvent(),this.makeViewDirty(!0),r.stopPropagation()}),e.on(nt.PointerMove,(s,r)=>{const o=s;!this._isVerticalMove||(this._view.scrollBy({y:o.offsetY-this._lastY}),this._lastY=o.offsetY)}),e.on(nt.PointerUp,(s,r)=>{const o=this._verticalThumbRect;this._isVerticalMove=!1,e.enableEvent(),o.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))}render(e,t=0,s=0){let{scrollX:r,scrollY:o}=this._view;e.save();const a=new $e([1,0,0,1,t,s]).getMatrix();e.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this._horizonBarRect.render(e),this._horizonThumbRect.translate(r).render(e),this._verticalBarRect.render(e),this._verticalThumbRect.translate(void 0,o).render(e),this._placeholderBarRect.render(e),e.restore()}resize(e=0,t=0,s=0,r=0){var o,i,a,c,l,u,h,d,f,g,b;e===0&&e===0||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=e-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/s*this._thumbLengthRatio,this._horizontalThumbWidth<Sn&&(this._horizontalMinusMiniThumb=Sn-this._horizontalThumbWidth,this._horizontalThumbWidth=Sn),(o=this._horizonBarRect)==null||o.transformByState({left:0,top:t-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=e?(i=this._horizonThumbRect)==null||i.setProps({visible:!1}):((a=this._horizonThumbRect)!=null&&a.visible||(c=this._horizonThumbRect)==null||c.setProps({visible:!0}),(l=this._horizonThumbRect)==null||l.transformByState({left:this._view.scrollX,top:t-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-this._thumbMargin*2}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=t-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/r*this._thumbLengthRatio,this._verticalThumbHeight<Sn&&(this._verticalMinusMiniThumb=Sn-this._verticalThumbHeight,this._verticalThumbHeight=Sn),(u=this._verticalBarRect)==null||u.transformByState({left:e-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=t?(h=this._verticalThumbRect)==null||h.setProps({visible:!1}):((d=this._verticalThumbRect)!=null&&d.visible||(f=this._verticalThumbRect)==null||f.setProps({visible:!0}),(g=this._verticalThumbRect)==null||g.transformByState({left:e-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-this._thumbMargin*2,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&((b=this._placeholderBarRect)==null||b.transformByState({left:e-this._barSize,top:t-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}get ratioScrollX(){return this._horizontalThumbWidth===void 0||this._horizontalBarWidth===void 0?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return this._verticalThumbHeight===void 0||this._verticalBarHeight===void 0?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}makeDirty(e){var t,s,r,o,i;(t=this._horizonBarRect)==null||t.makeDirty(e),(s=this._horizonThumbRect)==null||s.makeDirty(e),(r=this._verticalBarRect)==null||r.makeDirty(e),(o=this._verticalThumbRect)==null||o.makeDirty(e),(i=this._placeholderBarRect)==null||i.makeDirty(e),this.makeViewDirty(e)}makeViewDirty(e){this._view.makeDirty(e);const t=this._view.scene.getParent();t.classType===fe.SCENE_VIEWER&&t.makeDirty(!0)}pick(e){var t,s,r,o;return(t=this._horizonThumbRect)!=null&&t.isHit(e)?this._horizonThumbRect:(s=this._verticalThumbRect)!=null&&s.isHit(e)?this._verticalThumbRect:(r=this._horizonBarRect)!=null&&r.isHit(e)?this._horizonBarRect:(o=this._verticalBarRect)!=null&&o.isHit(e)?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}static attachTo(e,t){return new Co(e,t)}}class Cs extends po{constructor(e,t){super(e,t),this._props={autoWidth:!1,autoHeight:!1,...t},t.image?(this._native=t.image,this._init()):t.url&&(this._native=document.createElement("img"),this._native.src=t.url,this._native.onload=()=>{var s;(s=t.success)==null||s.call(t),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{t.fail?t.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(e,t){if(t._native.complete){const{width:s,height:r}=t;try{e.drawImage(t._native,0,0,s,r)}catch(o){console.error(o)}}}static create(e,t,s){return new Cs(e,{url:t,success:s})}_draw(e){Cs.drawWith(e,this)}_init(){this._props.autoWidth&&this.resize(this._native.width),this._props.autoHeight&&this.resize(void 0,this._native.height)}}class A6{constructor(e){this._dirty=!0,this._context=e,this._localeInitial()}get dirty(){return this._dirty}_localeInitial(){if(!this._context)return;const e=this._context.getLocale(),t=e.getObject("renderFont");t||e.load({en:jh,zh:Xh}),this._fontLocale=t}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(e){this._dirty=e}}class Dl{constructor(){this.translateX=0,this.translateY=0}draw(e,t,s){}clearCache(){}_getScale(e){return bo(e)}}const mr=ln.create(),S6=ln.create(),O6=ln.create(),Ss=ln.create();class x6 extends Kn{constructor(){super(...arguments),this._extensions=new Map}register(...e){for(let t of e)t.parent=this,this._extensions.set(t.uKey,t)}unRegister(...e){for(let t of e)this._extensions.delete(t)}getExtensionsByOrder(){const e=Array.from(this._extensions.values());return e.sort(rt),e}getExtensionByKey(e){return this._extensions.get(e)}get extensions(){return this._extensions}draw(e,t){}}function N6(n,e,t,s,r=0,o=0,i=!1,a,c,l){const{lineHeight:u=15.6,lineTop:h=0,contentHeight:d=0,paddingLeft:f=0,paddingRight:g=0,paddingTop:b=0,paddingBottom:p=0,marginTop:v=0,spaceBelowApply:C=0}=t,w=P6(e,n);w.lineIndex=r,w.paragraphStart=wo(o,i),w.contentHeight=d,w.top=h,w.lineHeight=u,w.paddingTop=b,w.paddingBottom=p,w.marginTop=v,w.spaceBelowApply=C,w.divides=k6(u,h,s,f,g,a,c,l);for(let x of w.divides)x.parent=w;return w}function M6(n=15.6,e=0,t=0,s,r,o){let i=e;return r==null||r.forEach(a=>{const c=Or(a,n,e);c&&(i=Math.max(i,c))}),o==null||o.forEach(a=>{const c=Or(a,n,e);c&&(i=Math.max(i,c))}),s==null||s.forEach(a=>{const c=Or(a,n,e);c&&(i=Math.max(i,c))}),i}function Or(n,e,t,s){const{aTop:r,height:o,aLeft:i,width:a,angle:c=0,drawingOrigin:l}=n,{layoutType:u,distT:h=0,distB:d=0}=l;if(u!==pt.WRAP_TOP_AND_BOTTOM)return;if(c===0){const b=r-h,p=o+d;return b+p<t||b>e+t?void 0:b+o}let{top:f=0,height:g=0}=Il(c,i,a,r,o);if(f-=h,g+=d,!(f+g<t||f>e+t))return f+g}function k6(n,e,t,s,r,o,i,a){const c=[];return c.push({left:0,width:s},{left:t-r,width:r}),i==null||i.forEach((l,u)=>{const h=xr(l,n,e,t);h&&c.push(h)}),a==null||a.forEach((l,u)=>{const h=xr(l,n,e,t);h&&c.push(h)}),o==null||o.forEach((l,u)=>{const h=xr(l,n,e,t);h&&c.push(h)}),H6(t,c)}function B6(n,e){n.isFull=e}function xr(n,e,t,s){const{aTop:r,height:o,aLeft:i,width:a,angle:c=0,drawingOrigin:l}=n,{layoutType:u}=l;if(u===pt.WRAP_NONE||u===pt.WRAP_TOP_AND_BOTTOM)return;if(u===pt.WRAP_POLYGON){const{start:d=[0,0],lineTo:f}=l;if(!f)return;let g=[];g.push(new Q(d[0],d[1]));for(let b=0;b<f.length;b++){const p=f[b];g.push(new Q(p[0],p[1]))}if(c!==0){const b=new $e().rotate(c);for(let p=0;p<g.length;p++){const v=g[p];g[p]=b.applyPoint(v)}}return Ri(g,t,e,s)}if(c===0)return Di(r,o,i,a,t,e,s,l);const h=Il(c,i,a,r,o);if(u===pt.WRAP_SQUARE){const{left:d,width:f,top:g,height:b}=h;return Di(g,b,d,f,t,e,s,l)}return Ri(h.points,t,e,s)}function Il(n,e,t,s,r){const o=new $e().rotate(n),i=new Q(e,s),a=new Q(e,s+r),c=new Q(e+t,s),l=new Q(e+t,s+r);return o.makeBoundingBoxFromPoints([i,a,c,l])}function Ri(n,e,t,s){const r=new s6(n),o=r.intersection([new Q(0,e),new Q(s,e)]),i=r.intersection([new Q(0,e+t),new Q(s,e+t)]);if(!o&&!i)return;const a=L6([...n,...o||[],...i||[]]);return{left:a.min,width:a.max}}function L6(n,e=0){const t=[];for(let s=0;s<n.length;s++){const r=n[s];e===0?t.push(r.x):t.push(r.y)}return{max:Math.max(...t),min:Math.min(...t)}}function Di(n,e,t,s,r,o,i,a){const{layoutType:c,wrapText:l=an.BOTH_SIDES,distL:u=0,distR:h=0,distT:d=0,distB:f=0}=a,g=n-(c===pt.WRAP_SQUARE?d:0),b=e+(c===pt.WRAP_SQUARE?f:0);if(g+b<r||g>o+r)return;let p=t-u,v=s+h,C=F6(l,p,v,i);return C===1?v=i-p:C===2&&(p=0,v=t+s+h),{left:p,width:v}}function F6(n,e,t,s){let r=0;return n===an.LEFT?r=1:n===an.RIGHT?r=2:n===an.LARGEST&&(e>s-e-t?r=1:r=2),r}function H6(n,e){e.sort((o,i)=>o.left>i.left?1:-1);const t=[];let s=0;const r=e.length;for(let o=0;o<r;o++){const i=e[o],{left:a,width:c}=i;if(a>s){let l=a-s;l=l<n?l:n-s;const u=Ii(s,l);t.push(u)}if(s=Math.max(a+c,s),o===r-1&&a+c<n){const l=Ii(a+c,n-a-c);t.push(l)}}return t}function Ii(n,e){return{spanGroup:[],width:e,left:n,paddingLeft:0,isFull:!1,st:0,ed:0}}function P6(n,e){return{blockId:e,type:n,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}function wo(n,e){return n===0&&e===!0}function z6(n,e,t,s){if(!!s)if(s.has(n)){const r=s.get(n);r==null||r.elements.push(e)}else s.set(n,{elements:[e],blockId:n,top:t})}function yl(n=[],e=Tn.NONE,t=0,s=0,r=1/0,o=1/0){const i=[];let a=0,c=0;if(n.length===0)i.push(Nr(s,r,0,Tn.NONE));else for(let u=0;u<n.length;u++){const{width:h,paddingEnd:d}=n[u];c=d,a=h,i.push(Nr(s,a,c,e)),s+=a+c,u===n.length-1&&(a=r!==1/0?r-a:h,c=0,i.push(Nr(s,a,c,e)))}const l={columns:i,colCount:(n==null?void 0:n.length)||1,height:o,top:t,st:0,ed:0};return i.forEach(u=>{u.parent=l}),l}function _r(n,e){n.isFull=e}function Nr(n,e,t,s){return{lines:[],left:n,width:e,height:0,spaceWidth:t,separator:s,st:0,ed:0,drawingLRIds:[],isFull:!1}}function U6(n,e,t,s){return t in je?W6(n,e,t):w6(n,e,t,s)}function W6(n,e,t){return t===je.DECIMAL?yi(n,e):t===je.ZERO_DECIMAL?V6(n,e):t===je.UPPER_ALPHA?G6(n,e):t===je.ALPHA?$6(n,e):t===je.UPPER_ROMAN?Y6(n,e):t===je.ROMAN?X6(n,e):yi(n,e)}function yi(n,e){return(n+e).toString()}function V6(n,e){const t=n+e;return t<10?`0${t}`:t.toString()}function G6(n,e){return nl(n+e-1,!0)}function $6(n,e){return nl(n+e-1,!1)}function Y6(n,e){return Al(n+e,!0)}function X6(n,e){return Al(n+e,!1)}function Al(n,e=!1){const t={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1};let r={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(r=t);let o="";for(let i in r)for(;n>=r[i];)o+=i,n-=r[i];return o}function j6(n,e,t,s,r){var h,d;if(!n||!e)return;const{listId:o,nestingLevel:i=0,textStyle:a}=n,c=e[o];return!c||!c.nestingLevel?Ai(o,(h=t==null?void 0:t[i])==null?void 0:h.startIndexItem,s):c.nestingLevel[i]?K6(o,i,c.nestingLevel,t,a,s,r):Ai(o,(d=t==null?void 0:t[i])==null?void 0:d.startIndexItem,s)}function Ai(n,e=1,t){return{listId:n,symbol:"\u25CF",ts:{ff:(t==null?void 0:t.fontList[0])||"Arial",fs:(t==null?void 0:t.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function K6(n,e,t,s,r,o,i){var z,R;const a=t[e],{bulletAlignment:c,glyphFormat:l,textStyle:u,startNumber:h,glyphType:d,glyphSymbol:f,indentFirstLine:g,hanging:b,indentStart:p}=a,v={...r,...u},C=vl(v,o);let w;f?w=f:w=q6(l,e,t,s,i);const x=jn.getTextSize(w,C),A=(R=(z=s==null?void 0:s[e])==null?void 0:z.startIndexItem)!=null?R:1;return{listId:n,symbol:w,ts:v,fontStyle:C,startIndexItem:A+1,bBox:x,nestingLevel:a,bulletAlign:c,bulletType:f?!1:!!d,indentFirstLine:g,hanging:b,indentStart:p}}function q6(n,e,t,s,r){var c;const o=n.split("%"),a=[o[0]];for(let l=1;l<o.length;l++){const u=o[l],{level:h,suffix:d}=J6(u);let f=((c=s==null?void 0:s[h])==null?void 0:c.startIndexItem)||1;h!==e&&(s==null?void 0:s[h])!==null&&(f-=1);const g=Z6(f,t[h],r);a.push(g,d)}return a.join("")}function Z6(n=1,e,t){const{startNumber:s,glyphType:r,glyphSymbol:o}=e;return o||(r?U6(n,s,r,t):"\u25CF")}function J6(n){if(n==="")return{level:0,suffix:""};const e=n.split("");let t="",s="",r=!1;const o=/[0-9]/g;return e.forEach(i=>{!r&&o.test(`${t}${i}`)?t+=i:(r=!0,s+=i)}),{level:parseInt(t)-1,suffix:s}}function Q6(n,e,t,s,r,o){return[]}function e3(n,e,t,s){if(wl(n))return n3(n,e,t,s);if(El(n))return s3(n,e,t,s);if(!Cl(n))return t3(n,e,t,s)}function t3(n,e,t,s){const{pageWidth:r=1/0}=s,o=jr(n,s),i=[o];let a=o.width,c=e;for(let l=e+1;l<t.length;l++){const u=t[l];if(Cl(u))break;{const h=jr(u,s),d=h.width;if(a+d>r)break;i.push(h),a+=d,c=l}}return{charIndex:c,spanGroup:i}}function n3(n,e,t,s){const r=[n];let o=e;for(let i=e+1;i<t.length;i++){const a=t[i];if(wl(a))r.unshift(a),o=i;else break}return{charIndex:o,spanGroup:[jr(r.join(""),s)]}}function s3(n,e,t,s){const r=[n];let o=e;for(let i=e+1;i<t.length;i++){const a=t[i];if(El(a))r.push(a),o=i;else break}return{charIndex:o,spanGroup:[Ml(r.join(""),s)]}}function Wn(n){return n==null?void 0:n[n.length-1]}function br(n){var e;return(e=n==null?void 0:n.sections)==null?void 0:e[n.sections.length-1]}function r3(n){var t;const e=(t=lr(n))==null?void 0:t.column.lines;return e==null?void 0:e[e.length-1]}function o3(n){return n.lines[n.lines.length-1]}function i3(n){const{width:e,marginLeft:t,marginRight:s}=n;return e-t-s}function a3(n){var t;const e=(t=n.parent)==null?void 0:t.parent;if(e)return e}function lr(n){const e=br(n);for(let t=0;t<e.columns.length;t++){const s=e.columns[t];if(!s.isFull)return{column:s,isLast:t===e.columns.length-1,index:t}}}function l3(n){const e=r3(n);if(!!e)for(let t=0;t<e.divides.length;t++){const s=e.divides[t];if(!s.isFull)return{divide:s,isLast:t===e.divides.length-1,index:t}}}function c3(n){const e=br(n),t=e.columns.length;for(let s=0;s<t;s++)if(!e.columns[s].isFull)return!1;return!0}function u3(n){if(n.sections.length>1)return!1;const e=br(n),t=e.columns.length;for(let s=0;s<t;s++){const r=e.columns[s];if(!Sl(r))return!1}return!0}function Sl(n){const e=n.lines;if(e.length>1)return!1;const t=e[e.length-1];return h3(t)}function h3(n){if(!n)return!0;for(let e=0;e<n.divides.length;e++){const t=n.divides[e].spanGroup.length;if(t>1)return!1;if(t===1){const s=n.divides[e].spanGroup[0],{spanType:r}=s;if(r!==ft.TAB&&r!==ft.LIST)return!1}}return!0}function rn(n,e){if(n instanceof Object){const{v:t,u:s}=n;return s===rl.POINT?t:t*e}return n}function Eo(n=0,e,t=ht.LINES,s=L.TRUE){let r=1;return Ol(t,s)&&(r=n),r*=e,r}function Ol(n=ht.LINES,e=L.FALSE){return e===L.TRUE&&(n===ht.LINES_AND_CHARS||n===ht.SNAP_TO_CHARS)}function xl(n,e){const{paragraphStyle:t={}}=e,{linePitch:s=15.6,gridType:r=ht.LINES,paragraphLineGapDefault:o=0}=n,{lineSpacing:i=1,spacingRule:a=bs.AUTO,snapToGrid:c=L.TRUE}=t;return{paragraphLineGapDefault:o,linePitch:s,gridType:r,lineSpacing:i,spacingRule:a,snapToGrid:c}}function d3(n,e){const{paragraphStyle:t={}}=e,{charSpace:s=0,gridType:r=ht.LINES,defaultTabStop:o=36,documentTextStyle:i={}}=n,{fs:a=Zh}=i,{snapToGrid:c=L.TRUE}=t;return{charSpace:s,documentFontSize:a,defaultTabStop:o,gridType:r,snapToGrid:c}}function Nl(n,e=-1){n[0];let t=e;for(let s of n){const{sections:r}=s;let o=t,i=o,a=-1/0,c=0;for(let l of r){const{columns:u}=l;let h=i,d=h,f=-1/0;for(let g of u){const{lines:b}=g;let p=d,v=p,C=0,w=-1/0,x=null;for(let A of b){const{divides:z,lineHeight:R}=A;let E=v,D=E,M=0,P=0;C+=R;const G=z.length;for(let T=0;T<G;T++){const y=z[T],{spanGroup:O}=y;if(O.length===0)continue;let U=D,B=U;for(let X of O){B+=X.spanType===ft.LIST?0:X.count||1;const $=X.bBox,{ba:te}=$;P=Math.max(P,te),T===G-1&&y.width===1/0&&(M+=X.width)}T===G-1&&(y.width===1/0?y.width=M:M+=y.width,M+=y.left),y.st=U===0?0:U+1,y.ed=B>=y.st?B:y.st,D=y.ed}A.st=E===0?0:E+1,A.ed=D>=A.st?D:A.st,A.width=M,A.asc=P,w=Math.max(w,M),A.top=((x==null?void 0:x.top)||0)+((x==null?void 0:x.lineHeight)||0),x=A,v=A.ed}g.st=p===0?0:p+1,g.ed=v>=g.st?v:g.st,g.height=C,g.width===1/0&&(g.width=w),a=Math.max(a,w),f=Math.max(f,g.height),d=g.ed}l.st=h===0?0:h+1,l.ed=d>=l.st?d:l.st,l.height=f,c+=f,i=l.ed}s.st=o===0?0:o+1,s.ed=i>=s.st?i:s.st,s.height=c,s.width=a,t=s.ed}}function f3(n,e){for(let t of n){const{sections:s}=t;for(let r of s){const{columns:o}=r;for(let i of o){const{lines:a}=i;for(let c of a)e&&h6(e)&&e(c)}}}}function g3(n,e,t,s,r=!1){const{relativeFrom:o,align:i,posOffset:a,percent:c}=n;if(i!=null)if(i===Qt.INSIDE||i===Qt.OUTSIDE)o===Se.MARGIN||Se.PAGE;else{if(o===Se.COLUMN){const{width:l,left:u}=e;let h=0;return i===Qt.LEFT?h=u:i===Qt.RIGHT?h=u+l-s:i===Qt.CENTER&&(h=u+l/2-s/2),h}if(o!==Se.LEFT_MARGIN){if(o!==Se.MARGIN){if(o!==Se.RIGHT_MARGIN){if(o!==Se.INSIDE_MARGIN){if(o!==Se.OUTSIDE_MARGIN){if(o===Se.PAGE){const{width:l}=t;let u=0;return i===Qt.RIGHT?u=l-s:i===Qt.CENTER&&(u=l/2-s/2),u}}}}}}}else if(a){const{width:l,marginLeft:u,marginRight:h}=t,d=l-h;let f=0;return o===Se.COLUMN?f=(r?0:(e==null?void 0:e.left)||0)+a:o===Se.LEFT_MARGIN||(o===Se.MARGIN?f=a+u:o===Se.RIGHT_MARGIN||o===Se.INSIDE_MARGIN||o===Se.OUTSIDE_MARGIN||o===Se.PAGE&&(f=a)),f+s>d&&(f=d-s),f}else if(c){const{width:l,marginLeft:u,marginRight:h}=t;if(o!==Se.LEFT_MARGIN){if(o!==Se.MARGIN){if(o!==Se.RIGHT_MARGIN){if(o!==Se.INSIDE_MARGIN){if(o!==Se.OUTSIDE_MARGIN){if(o===Se.PAGE)return c*l}}}}}}}function m3(n,e,t,s,r,o,i=!1){const{relativeFrom:a,align:c,posOffset:l,percent:u}=n;if(c!=null){if(a===xe.LINE){let h=0;return c===Bn.BOTTOM?h=t+s-r:c===Bn.TOP?h=t:c===Bn.CENTER&&(h=t+s/2-r/2),h}if(a!==xe.TOP_MARGIN){if(a!==xe.MARGIN){if(a!==xe.BOTTOM_MARGIN){if(a!==xe.INSIDE_MARGIN){if(a!==xe.OUTSIDE_MARGIN){if(a===xe.PAGE){const{height:h}=e;let d=0;return c===Bn.BOTTOM?d=h-r:c===Bn.CENTER&&(d=h/2-r/2),d}}}}}}}else if(l){let h=0;return a===xe.LINE?h=t||0+l:a===xe.TOP_MARGIN||a===xe.MARGIN||a===xe.BOTTOM_MARGIN||a===xe.INSIDE_MARGIN||a===xe.OUTSIDE_MARGIN||(a===xe.PAGE?h=l:a===xe.PARAGRAPH&&(h=(i?0:o==null?t:o)+l)),h}else if(u){const{height:h,marginBottom:d,marginTop:f}=e;if(a!==xe.TOP_MARGIN){if(a!==xe.MARGIN){if(a!==xe.BOTTOM_MARGIN){if(a!==xe.INSIDE_MARGIN){if(a!==xe.OUTSIDE_MARGIN){if(a===xe.PAGE)return u*h}}}}}}}function _3(n){const e=n.spanGroup;let t=0;for(let s of e)t+=s.width;return t}function Ml(n,e,t){return To(ft.WORD,n,e,t)}function jr(n,e,t){return To(ft.LETTER,n,e,t)}function b3(n,e){return To(ft.TAB," ",n,e)}function To(n,e,t,s){const{fontStyle:r,textStyle:o,charSpace:i=1,gridType:a=ht.LINES,snapToGrid:c=L.FALSE}=t,l=jn.getTextSize(e,r),{width:u=0}=l;let h=s!=null?s:u,d=0;return Ol(a,c)&&(h=Math.ceil(u/i)*i,a===ht.LINES_AND_CHARS&&(d=(h-u)/2)),{content:e,ts:o,fontStyle:r,width:h,bBox:l,paddingLeft:d,left:0,spanType:n}}function p3(n,e,t){const{bBox:s,symbol:r,ts:o,fontStyle:i,bulletAlign:a=Fe.START,bulletType:c=!1}=e,l=s.width,u=Math.ceil(l/t);let h=(u<2?2:u)*t,d=0;c&&(a===Fe.CENTER?(d=-l/2,h-=d):a===Fe.END&&(d=-l,h-=d));const f=C3(n,e);return{content:r,ts:o,fontStyle:i,width:h,paddingLeft:0,bBox:f,left:d,spanType:ft.LIST}}function v3(n,e=0){const t=n.length;let s;for(let r=0;r<t;r++){const o=n[r];o.left=s?s.left+s.width:e,s=o}}function C3(n,e){const{ba:t,bd:s}=n.bBox,{ba:r,bd:o}=e.bBox;return t+s>r+o?n.bBox:e.bBox}function Si(n,e,t,s,r=0,o=!1){if(wo(r,o))if(s.bulletSkeleton){const{bulletSkeleton:i,paragraphStyle:a={}}=s,{gridType:c=ht.LINES,charSpace:l=0,defaultTabStop:u=1}=t,{snapToGrid:h=L.TRUE}=a,d=Eo(l,u,c,h);S3(a,i,d);const f=p3(n[0],i,d);Pn([f,...n],e,t,s,r,o)}else Pn(n,e,t,s,r,o);else hs(n,e,t,s,r,o);return[...e]}function hs(n,e,t,s,r=0,o=!1,i){var l,u;const a=Wn(e),c=l3(a);if(c){const h=I3(n),d=c.divide,f=(l=d==null?void 0:d.spanGroup)==null?void 0:l[d.spanGroup.length-1],g=(f==null?void 0:f.width)||0,b=(f==null?void 0:f.left)||0,p=i3(a);if(g+b+h>d.width){B6(d,!0);const v=a3(d);h>p?u3(a)?(d.spanGroup.push(...n),T3((u=v==null?void 0:v.parent)==null?void 0:u.columns)):Do(n,e,t,s,r,o,i):v&&h>v.width?(_r(v,!0),Sl(v)?(console.log(n),d.spanGroup.push(...n)):Ro(n,e,t,s,r,o,i)):c.isLast?Pn(n,e,t,s,r,o,i):hs(n,e,t,s,r,o,i)}else{const v=d.parent,C=y3(n);if(v&&C){const{paragraphLineGapDefault:w,linePitch:x,lineSpacing:A,spacingRule:z,snapToGrid:R,gridType:E}=xl(t,s),{boundingBoxAscent:D,boundingBoxDescent:M}=C,P=D+M,{contentHeight:G}=kl(P,w,x,E,A,z,R);if(v.contentHeight<G){const T=A3(v),y=T.length;let O=[],U=1;T[0].spanType===ft.LIST&&y>2?(O=[T[0],T[1]],U=2):O=[T[0]];const B=v.parent;B==null||B.lines.pop(),Pn(O,e,t,s,r,o,D+M);for(let X=U;X<T.length;X++)hs([T[X]],e,t,s,r,o);hs(n,e,t,s,r,o);return}}v3(n,g+b);for(let w of n)w.parent=d;d.spanGroup.push(...n)}}else Pn(n,e,t,s,r,o,i)}function Pn(n,e,t,s,r=0,o=!1,i){var Yt,Ft,Ns,Ms,ks;let a=Wn(e),c=lr(a);if((!c||!c.column)&&(Do(n,e,t,s,r),a=Wn(e),c=lr(a)),!c)return;const l=c.column,u=o3(l),{ba:h,bd:d}=n[0].bBox,f=i||h+d,{paragraphStyle:g={},paragraphAffectSkeDrawings:b,skeHeaders:p,skeFooters:v,blockAnchor:C,blockId:w}=s,{namedStyleType:x=fo.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:A=Ye.UNSPECIFIED,direction:z,spaceAbove:R=0,spaceBelow:E=0,borderBetween:D,borderTop:M,borderBottom:P,borderLeft:G,borderRight:T,indentFirstLine:y=0,hanging:O=0,indentStart:U=0,indentEnd:B=0,tabStops:X=[],keepLines:J=L.FALSE,keepNext:$=L.FALSE,wordWrap:te=L.FALSE,widowControl:re=L.FALSE,shading:Te}=g,{paragraphLineGapDefault:_e,linePitch:Z,lineSpacing:ne,spacingRule:oe,snapToGrid:Re,gridType:ue}=xl(t,s),be=wo(r,o),{paddingTop:Ae,paddingBottom:Ne,contentHeight:Xe,lineSpacingApply:We}=kl(f,_e,Z,ue,ne,oe,Re),{marginTop:gt,spaceBelowApply:Gt}=E3(We,R,E,be,u),Ve=gt+Ae+Xe+Ne;let mt=l.parent;mt||(mt=br(a));const At=(u==null?void 0:u.lineHeight)||0,cn=(u==null?void 0:u.top)||0,_t=At+cn,{width:$t,headerId:St,footerId:N}=a,H=(Ft=(Yt=p==null?void 0:p.get(St))==null?void 0:Yt.get($t))==null?void 0:Ft.skeDrawings,V=(Ms=(Ns=v==null?void 0:v.get(N))==null?void 0:Ns.get($t))==null?void 0:Ms.skeDrawings;R3(_t,Ve,l,(ks=C==null?void 0:C.get(w))==null?void 0:ks.top,b);const K=M6(Ve,_t,r,a.skeDrawings,H,V);if(Ve+K>mt.height&&l.lines.length>0&&a.sections.length>0){console.log("_lineOperator",{spanGroup:n,pages:e,lineHeight:Ve,newLineTop:K,sectionHeight:mt.height,lastPage:a}),_r(l,!0),Ro(n,e,t,s,r,o,i);return}const ie=u?u.lineIndex+1:0,{charSpace:Me,defaultTabStop:he}=d3(t,s),de=Eo(Me,he,ue,Re),{paddingLeft:ae,paddingRight:Ce,changeBulletWidth:we}=w3(n[0],y,O,U,B,de);we.state&&(n[0].width=we.hangingNumber);const et=N6(w,ir.PARAGRAPH,{lineHeight:Ve,contentHeight:Xe,lineTop:K,paddingLeft:ae,paddingRight:Ce,paddingTop:Ae,paddingBottom:Ne,marginTop:gt,spaceBelowApply:Gt},l.width,ie,r,o,a.skeDrawings,H,V);l.lines.push(et),et.parent=l,z6(w,et,_t,C),hs(n,e,t,s,r,o,i)}function Ro(n,e,t,s,r=0,o=!1,i){const a=Wn(e);c3(a)===!0?Do(n,e,t,s,r,o,i):Pn(n,e,t,s,r,o,i)}function Do(n,e,t,s,r=0,o=!1,i){const a=Wn(e),{skeHeaders:c,skeFooters:l}=s;e.push(ws(t,{skeHeaders:c,skeFooters:l},a==null?void 0:a.pageNumber)),Ro(n,e,t,s,r,o,i)}function w3(n,e=0,t=0,s=0,r=0,o){const{spanType:i=ft.LETTER,bBox:a}=n;let c=rn(e,o),l=rn(t,o),u=rn(s,o),h=rn(r,o),d=u,f=h,g={state:!1,hangingNumber:0};if(i===ft.LIST){const{width:b}=a;c>0?d+=c:l>0&&l>b&&(g.state=!0,g.hangingNumber=l)}else d+=l;return{paddingLeft:d,paddingRight:f,changeBulletWidth:g}}function E3(n=0,e=0,t=0,s,r){let o=0,i=0;if(!s)return{marginTop:o,spaceBelowApply:i};if(o=rn(e,n),i=rn(t,n),r){const{spaceBelowApply:a}=r;a>o&&(o=0,r.lineHeight+=a,r.marginBottom=a)}return{marginTop:o,spaceBelowApply:i}}function T3(n=[]){for(let e=0;e<n.length;e++){const t=n[e];_r(t,!0)}}function kl(n,e,t,s,r,o,i){let a=e,c=e;if(s===ht.DEFAULT||i===L.FALSE)return o===bs.AUTO?{paddingTop:a,paddingBottom:c,contentHeight:r*n,lineSpacingApply:n}:{paddingTop:a,paddingBottom:c,contentHeight:Math.max(r,n),lineSpacingApply:r};let l=0;return o===bs.AUTO?l=r*t:l=r,n+e*2<l&&(a=c=(l-n)/2),{paddingTop:a,paddingBottom:c,contentHeight:n,lineSpacingApply:l}}function R3(n,e,t,s,r){var c;if(!r)return;const o=(c=t.parent)==null?void 0:c.parent;if(!o)return;const i=new Map,a=D3(t);r.forEach(l=>{if(!l)return;const{initialState:u,drawingOrigin:h}=l;if(u||!h)return;const{objectProperties:d}=h,{positionH:f,positionV:g,size:b,angle:p}=d,{width:v=0,height:C=0}=b;l.aLeft=g3(f,t,o,v,a)||0,l.aTop=m3(g,o,n,e,C,s,a)||0,l.width=v,l.height=C,l.angle=p,l.initialState=!0,i.set(l.objectId,l)}),o.skeDrawings=new Map([...o.skeDrawings,...i])}function D3(n){const e=n.parent;if(!e)return!1;const t=e==null?void 0:e.columns;if(!t)return!1;const s=t.length;for(let r=s-1;r>=0;r--){const i=t[r].lines,a=i.length;if(!(a<=0)){for(let c=a-1;c>=0;c--)if(i[c].paragraphStart)return!1}}return!0}function I3(n){const e=n.length;let t=0;for(let s=0;s<e;s++)t+=n[s].width;return t}function y3(n){const e=n.length;let t=-1/0,s;for(let r=0;r<e;r++){const o=n[r],{ba:i,bd:a}=o.bBox;t<i+a&&(s={boundingBoxAscent:i,boundingBoxDescent:a}),t=i+a}return s}function A3(n){const e=n.divides,t=e.length,s=[];for(let r=0;r<t;r++){const o=e[r];s.push(...o.spanGroup)}return s}function S3(n,e,t){const{hanging:s,indentStart:r}=n,{hanging:o,indentStart:i}=e;s===void 0&&(n.hanging=o),r===void 0&&(n.indentStart=rn(i||0,t)-rn(o||0,t))}function O3(n,e,t,s,r,o){const{pageNumberStart:i,pageSize:a={w:1/0,h:1/0},marginRight:c=0,marginLeft:l=0,columnProperties:u=[],columnSeparatorType:h=Tn.NONE,contentDirection:d,sectionType:f,sectionTypeNext:g,textDirection:b,lists:p,drawings:v={},fontLocale:C}=s,{elements:w,elementOrder:x,paragraphStyle:A={},bullet:z}=e,{skeHeaders:R,skeFooters:E,skeListLevel:D,blockAnchor:M}=r,P={blockId:n,paragraphStyle:A,skeHeaders:R,skeFooters:E,blockAnchor:M},G=[t];let T=t;const y=new Map,O=x3(z,D),U=j6(z,p,O,C,o);return N3(z,U,D),P.bulletSkeleton=U,x.forEach((B,X)=>{const{elementId:J,paragraphElementType:$}=B;let te=[];if($===F.TEXT_RUN){const re=w[J],{tr:Te,st:_e,ed:Z}=re;if(!Te)return!1;te=B3(Te,X,s,T,{...P,paragraphAffectSkeDrawings:y},C)}else if($===F.DRAWING){const re=v[J];re.layoutType===pt.INLINE?te=Q6():y.set(J,M3(re))}else if($===F.PAGE_BREAK)te=[ws(s,r,Oi(T),ps.PAGE)],y.clear();else if($===F.COLUMN_BREAK){const re=lr(T);re&&!re.isLast?_r(re.column,!0):te=[ws(s,r,Oi(T),ps.COLUMN)]}T=k3(G,te)}),G}function x3(n,e){if(!n||!e)return;const{listId:t,nestingLevel:s}=n,r=e==null?void 0:e.get(t);let o=s;o<0&&(o=0);const i=[];for(let a=o;a>=0;a--){const c=r==null?void 0:r[a];i[a]=c||null}return i}function N3(n,e,t){if(!n||!e)return;const{listId:s,nestingLevel:r}=n,o=[...(t==null?void 0:t.get(s))||[]];o[r]=e,o.splice(r+1),t==null||t.set(s,o)}function M3(n){return{objectId:n.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:n}}function k3(n,e){const t=n.slice(-1)[0],s=e[0];if(t===s){if(e.length===1)return t;e.shift()}return n.push(...e),n.slice(-1)[0]}function Oi(n){return n.pageNumber+1}function B3(n,e=0,t,s,r,o){const{ct:i="",ts:a={},tab:c=!1}=n,l=vl(a,o),{paragraphStyle:u={}}=r,{gridType:h=ht.LINES,charSpace:d=0,documentTextStyle:f={},defaultTabStop:g=10.5,pageSize:b={width:1/0,height:1/0},marginLeft:p=0,marginRight:v=0}=t,{namedStyleType:C=fo.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:w=Ye.UNSPECIFIED,lineSpacing:x=1,spacingRule:A=bs.AUTO,snapToGrid:z=L.TRUE,direction:R,spaceAbove:E=0,spaceBelow:D=0,borderBetween:M,borderTop:P,borderBottom:G,borderLeft:T,borderRight:y,indentFirstLine:O=0,hanging:U=0,indentStart:B=0,indentEnd:X=0,tabStops:J=[],keepLines:$=L.FALSE,keepNext:te=L.FALSE,wordWrap:re=L.FALSE,widowControl:Te=L.FALSE,shading:_e}=u;let Z=[s];const ne=b.width||1/0-p-v,oe={...f,...a},Re={fontStyle:l,textStyle:oe,charSpace:d,gridType:h,snapToGrid:z,pageWidth:ne};if(c){const be=Eo(d,g,h,z),Ae=b3(Re,be);return Z=Si([Ae],Z,t,r,e,!0),Z}const ue=i.split("");for(let be=0;be<ue.length;be++){const Ae=ue[be],Ne=e3(Ae,be,ue,Re);let Xe=[];if(Ne){const{charIndex:We,spanGroup:gt}=Ne;be=We,Xe=gt}else{const We=Ml(Ae,Re);Xe.push(We)}Z=Si(Xe,Z,t,r,e,be===0)}return f3(Z,be=>{L3(be,w)}),Z}function L3(n,e){if(e===Ye.UNSPECIFIED||e===Ye.LEFT)return;const{divides:t}=n,s=t.length;for(let r=0;r<s;r++){const o=t[r],{width:i,spanGroup:a}=o,c=_3(o);i!==1/0&&(e===Ye.CENTER?o.paddingLeft=(i-c)/2:e===Ye.RIGHT?o.paddingLeft=i-c:Ye.JUSTIFIED)}}function F3(){return[]}function Bl(n,e,t,s,r,o){const i=[],a=new Map;for(let c of n){const{paragraph:l,table:u,tableOfContents:h,blockType:d,customBlock:f,blockId:g}=c;if(r!=null&&r.get(g))continue;let b=[],p=e;i.length>0&&(p=i[i.length-1]),d===De.PARAGRAPH&&l?b=O3(c.blockId,l,p,t,s,o):d===De.TABLE&&u||d===De.SECTION_BREAK&&h||d===De.CUSTOM&&(b=C6(c.blockId,f,p,t,s,o)),b.length===0&&(b=F3()),H3(i,b),a.set(g,!0)}return{pages:i,renderedBlockIdMap:a}}function H3(n,e){const t=n.length-1,s=n[t],r=e[0];s===r&&e.splice(0,1),n.push(...e)}function ws(n,e,t=1,s=ps.SECTION){var Ae,Ne,Xe,We;const r=P3(),{pageNumberStart:o=1,pageSize:i={width:1/0,height:1/0},pageOrient:a=dr.PORTRAIT,headerIds:c={},footerIds:l={},useFirstPageHeaderFooter:u,useEvenPageHeaderFooter:h,footers:d,headers:f,columnProperties:g=[],columnSeparatorType:b,marginTop:p=0,marginBottom:v=0,marginHeader:C=0,marginFooter:w=0,marginLeft:x=0,marginRight:A=0,renderConfig:z={}}=n,{skeHeaders:R,skeFooters:E}=e,{width:D=1/0,height:M=1/0}=i;r.pageNumber=t,r.pageNumberStart=o,r.renderConfig=z,r.marginLeft=x,r.marginRight=A,r.breakType=s,r.width=r.pageWidth=D,r.height=r.pageHeight=M,r.pageOrient=a;const{defaultHeaderId:P,evenPageHeaderId:G,firstPageHeaderId:T}=c,{defaultFooterId:y,evenPageFooterId:O,firstPageFooterId:U}=l;let B=P!=null?P:"",X=y!=null?y:"";t===o&&u?(B=T!=null?T:"",X=U!=null?U:""):t%2===0&&h&&(B=G!=null?G:"",X=O!=null?O:"");let J,$;B&&((Ae=R.get(B))!=null&&Ae.has(D)?J=(Ne=R.get(B))==null?void 0:Ne.get(D):f&&(J=xi(f[B],n,e),R.set(B,new Map([[D,J]]))),r.headerId=B),X&&((Xe=E.get(X))!=null&&Xe.has(D)?$=(We=E.get(X))==null?void 0:We.get(D):d&&($=xi(d[X],n,e),E.set(B,new Map([[D,$]]))),r.footerId=X),r.marginTop=Ni(p,C,J),r.marginBottom=Ni(v,w,$);const te=r.sections,re=te[te.length-1],{marginTop:Te,marginBottom:_e,marginLeft:Z,marginRight:ne}=r,oe=D-Z-ne,Re=M-Te-_e;let ue=0;re&&(ue=re.top+re.height);const be=yl(g,b,ue,0,oe,Re-ue);return be.parent=r,te.push(be),r}function P3(){return{sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:dr.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:ps.SECTION,st:0,ed:0,skeDrawings:new Map}}function xi(n,e,t,s=!0){const{body:r}=n,{lists:o,headers:i,footers:a,fontLocale:c,pageSize:l,marginLeft:u=0,marginRight:h=0,drawings:d,marginTop:f=0,marginBottom:g=0,marginHeader:b=0,marginFooter:p=0}=e,v=(l==null?void 0:l.width)||1/0,C={lists:o,headers:i,footers:a,pageSize:{width:v-u-h,height:1/0},fontLocale:c,drawings:d},{blockElements:w,blockElementOrder:x}=r,A=[];x.forEach(y=>{const O=w[y];A.push(O)});const z=ws(C,t),R=Bl(A,z,C,t).pages[0];Nl([R]);const E=R.sections[0].columns[0],D=E.height||0,{skeDrawings:M,st:P,ed:G}=R,T={lines:E.lines,skeDrawings:M,height:D,st:P,ed:G,marginLeft:u,marginRight:h};return s?{...T,marginTop:z3(f,b,D)}:{...T,marginBottom:U3(g,p,D)}}function Ni(n,e,t){return!t||t.lines.length===0?n:Math.max(n,e,(t==null?void 0:t.height)||0)}function z3(n,e,t){const s=Math.max(n,e);return t>s?0:s-t}function U3(n,e,t){const s=Math.max(n,e);return t>s?0:s-t}class Kr{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(e=0,t=0){this._translateX=e,this._translateY=t}translate(e=0,t=0){this._translateX+=e,this._translateY+=t}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const e=this._translateSaveList.pop();e&&(this._translateX=e.x,this._translateY=e.y)}translatePagePadding(e){const{marginTop:t=0,marginBottom:s=0,marginLeft:r=0,marginRight:o=0}=e;this.translate(r,t)}restorePagePadding(e){const{marginTop:t=0,marginBottom:s=0,marginLeft:r=0,marginRight:o=0}=e;this.translate(-r,-t)}translatePage(e,t=zt.VERTICAL,s=0,r=0,o=0,i=0){const{sections:a,marginTop:c=0,marginBottom:l=0,marginLeft:u=0,marginRight:h=0,pageWidth:d,pageHeight:f,width:g,height:b,pageNumber:p=1,renderConfig:v={}}=e;let C=0,w=0;return t===zt.VERTICAL?C=f+r:t===zt.HORIZONTAL&&(w=d+s),this.translate(w,C),{x:w,y:C}}translateSection(e){const{top:t=0}=e;return this.translate(0,t),{x:0,y:t}}translateColumn(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}translateLine(e){const{top:t,marginBottom:s=0,marginTop:r=0,paddingTop:o=0,paddingBottom:i=0}=e,a=t+r+o;return this.translate(0,a),{x:0,y:a}}translateDivide(e){const{left:t,paddingLeft:s}=e,r=t+s;return this.translate(r,0),{x:r,y:0}}translateSpan(e){const{left:t}=e;return this.translate(t,0),{x:t,y:0}}}class pr extends A6{constructor(e,t){super(t),this._renderedBlockIdMap=new Map,this.onRecalculateChangeObservable=new me,this._documentData=e}updateDrawing(e,t){const s=this._documentData.drawings;if(!s)return;const r=s[e];if(!r)return;const o=r.objectProperties;o.size.width=t.width,o.size.height=t.height,o.positionH.posOffset=t.left,o.positionV.posOffset=t.top}calculate(e){!this.dirty||(this._skeletonData=this._createSkeleton(e),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(e,t){const s=this._documentData.documentStyle;if(!s.pageSize){e=e!=null?e:1/0,t=t!=null?t:1/0,s.pageSize={width:e,height:t};return}e!==void 0&&(s.pageSize.width=e),t!==void 0&&(s.pageSize.height=t)}__getContentMapArr(){const{body:e}=this._documentData;if(!e)return[];const{blockElements:t,blockElementOrder:s}=e;if(!t||s.length===0)return[];const r=[];let o={blockElements:[],sectionBreak:void 0};return s.forEach(i=>{const a=t[i],{sectionBreak:c}=a;c?(o.sectionBreak=c,r.push(o),o={blockElements:[],sectionBreak:void 0}):o.blockElements.push(a)}),o.sectionBreak||(o.sectionBreak={columnProperties:[],columnSeparatorType:Tn.NONE,sectionType:cs.SECTION_TYPE_UNSPECIFIED},o.blockElements.length>0&&r.push(o)),r}_createSkeleton(e){var ne;const t=this.__getContentMapArr(),s={width:1/0,height:1/0},{documentStyle:r,footers:o,headers:i,lists:a,drawings:c}=this._documentData,{pageNumberStart:l=1,pageSize:u=s,pageOrient:h=dr.PORTRAIT,defaultHeaderId:d,defaultFooterId:f,evenPageHeaderId:g,evenPageFooterId:b,firstPageHeaderId:p,firstPageFooterId:v,useFirstPageHeaderFooter:C,useEvenPageHeaderFooter:w,marginTop:x=0,marginBottom:A=0,marginRight:z=0,marginLeft:R=0,marginHeader:E=0,marginFooter:D=0,charSpace:M=0,linePitch:P=15.6,gridType:G=ht.LINES,paragraphLineGapDefault:T=0,defaultTabStop:y=10.5,textStyle:O={fs:14},renderConfig:U={horizontalAlign:Ye.UNSPECIFIED,verticalAlign:Vt.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Bt.UNSPECIFIED}}=r,B=this.__getNullSke();if(t.length===0)return B;const X=this.getFontLocale(),J={footers:o,headers:i,lists:a,drawings:c,charSpace:M,linePitch:P,gridType:G,fontLocale:X,paragraphLineGapDefault:T,defaultTabStop:y,documentTextStyle:O},{skeHeaders:$,skeFooters:te,skeListLevel:re,blockAnchor:Te}=B,_e={skeHeaders:$,skeFooters:te,skeListLevel:re,blockAnchor:Te},Z=[];B.pages=Z;for(let oe=0;oe<t.length;oe++){const Re=t[oe];if(!Re.sectionBreak)continue;const{pageNumberStart:ue=l,pageSize:be=u,pageOrient:Ae=h,marginTop:Ne=x,marginBottom:Xe=A,marginRight:We=z,marginLeft:gt=R,marginHeader:Gt=E,marginFooter:Ve=D,defaultHeaderId:mt=d,defaultFooterId:At=f,evenPageHeaderId:cn=g,evenPageFooterId:_t=b,firstPageHeaderId:$t=p,firstPageFooterId:St=v,useFirstPageHeaderFooter:N=C,useEvenPageHeaderFooter:H=w,columnProperties:V=[],columnSeparatorType:K=Tn.NONE,contentDirection:ie,sectionType:Me,textDirection:he,renderConfig:de=U}=Re.sectionBreak,ae=t[oe+1],Ce=(ne=ae==null?void 0:ae.sectionBreak)==null?void 0:ne.sectionType,we={defaultHeaderId:mt,evenPageHeaderId:cn,firstPageHeaderId:$t},et={defaultFooterId:At,evenPageFooterId:_t,firstPageFooterId:St};be.width===null&&(be.width=1/0),be.height===null&&(be.height=1/0);const Yt={pageNumberStart:ue,pageSize:be,pageOrient:Ae,marginTop:Ne,marginBottom:Xe,marginRight:We,marginLeft:gt,marginHeader:Gt,marginFooter:Ve,headerIds:we,footerIds:et,useFirstPageHeaderFooter:N,useEvenPageHeaderFooter:H,columnProperties:V,columnSeparatorType:K,contentDirection:ie,sectionType:Me,sectionTypeNext:Ce,textDirection:he,renderConfig:de,...J};let Ft=Wn(Z);Me===cs.CONTINUOUS?this.__addNewSectionByContinuous(Ft,V,K):Ft=ws(Yt,_e,Ft==null?void 0:Ft.pageNumber);const Ns=this.getContext(),Ms=Bl(Re.blockElements,Ft,Yt,_e,this._renderedBlockIdMap,Ns);Ce===cs.CONTINUOUS&&V.length>0;const{pages:ks,renderedBlockIdMap:d5}=Ms;Z.push(...ks)}return Nl(Z),B}__addNewSectionByContinuous(e,t,s){const r=e.sections,o=r[r.length-1],{width:i,height:a,marginTop:c,marginBottom:l,marginLeft:u,marginRight:h}=e,d=i-u-h,f=a-c-l,g=((o==null?void 0:o.top)||0)+((o==null?void 0:o.height)||0),b=yl(t,s,g,d,f-g);b.parent=e,r.push(b)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}static create(e,t){return new pr(e,t)}}class W3 extends x6{constructor(e,t,s=!1){super(e),this._skeleton=t,this._allowCache=s,this._allowCache&&(this._cacheCanvas=new ys),this.onIsAddedToParentObserver.add(r=>{var o;(o=r==null?void 0:r.getEngine())==null||o.onTransformChangeObservable.add(i=>{this.resizeCacheCanvas()}),this.resizeCacheCanvas()})}getSkeleton(){return this._skeleton}setSkeleton(e){this._skeleton=e}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const s=this.transform.getMatrix();e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._draw(e,t),e.restore()}_getBounding(e){}_draw(e,t){}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:e=1,scaleY:t=1}=this.parent;return this.parent.classType===fe.SCENE&&(e=this.parent.ancestorScaleX||1,t=this.parent.ancestorScaleY||1),{scaleX:e,scaleY:t}}}var qr=(n=>(n[n.SPAN=0]="SPAN",n[n.LINE=1]="LINE",n))(qr||{});class vr extends Dl{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}const V3="DefaultDocsFontAndBaseLineExtension";class G3 extends vr{constructor(){super(...arguments),this.uKey=V3,this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(e,t,s){var f;if(!((f=s.parent)==null?void 0:f.parent))return;const{ts:o,content:i,fontStyle:a,bBox:c}=s;let{spanPointWithFont:l=Q.create(0,0)}=this.extensionOffset;if(!o){i!=null&&e.fillText(i,l.x,l.y);return}if(i==null)return;this._preFontString!==(a==null?void 0:a.fontString)&&(e.font=this._preFontString=(a==null?void 0:a.fontString)||"");const{cl:u,va:h}=o,d=bn(u)||pn;if(d&&this._preFontColor!==d&&(e.fillStyle=d),h===Dt.SUBSCRIPT||h===Dt.SUPERSCRIPT){let g=c.spo;h===Dt.SUPERSCRIPT&&(g=-c.sbo),l.y+=g}e.fillText(i,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}}Ss.add(new G3);const $3="DefaultDocsBackgroundExtension";class Y3 extends vr{constructor(){super(...arguments),this.uKey=$3,this.zIndex=10,this._preBackgroundColor=""}draw(e,t,s){var d;const r=(d=s.parent)==null?void 0:d.parent;if(!r)return;const{lineHeight:o=0}=r,{ts:i,width:a,content:c}=s;if(!i)return;const{bg:l}=i;if(!l)return;const u=bn(l),{spanStartPoint:h=Q.create(0,0)}=this.extensionOffset;u&&(e.fillStyle=u,e.fillRect(h.x-.5,h.y,a+1,o))}clearCache(){this._preBackgroundColor=""}}Ss.add(new Y3);const X3="DefaultDocsLineExtension";class j3 extends vr{constructor(){super(...arguments),this.uKey=X3,this.zIndex=40,this._preBackgroundColor=""}draw(e,t,s){var z;const r=(z=s.parent)==null?void 0:z.parent;if(!r)return;const{asc:o=0,lineHeight:i=0}=r,{ts:a,left:c,width:l,bBox:u}=s;if(!a)return;const{sp:h}=u,d=bo(t),{ul:f,st:g,ol:b}=a,{originTranslate:p=Q.create(0,0),centerPoint:v=Q.create(0,0),alignOffset:C=Q.create(0,0),renderConfig:w={}}=this.extensionOffset,{centerAngle:x=0,vertexAngle:A=0}=w;if(f){const{s:R,cl:E,t:D}=f;if(R===L.TRUE){e.beginPath();const M=bn(E)||pn;e.strokeStyle=M,this._setLineType(e,D||He.SINGLE);const P=ve(i+vi-.5,d),G=en(p.addByPoint(c,P),v,x,A,C),T=en(p.addByPoint(c+l,P),v,x,A,C);e.moveTo(G.x,G.y),e.lineTo(T.x,T.y),e.stroke()}}if(g){const{s:R,cl:E,t:D}=g;if(R===L.TRUE){e.beginPath();const M=bn(E)||pn;e.strokeStyle=M,this._setLineType(e,D||He.SINGLE);const P=ve(h-.5,d),G=en(p.addByPoint(c,P),v,x,A,C),T=en(p.addByPoint(c+l,P),v,x,A,C);e.moveTo(G.x,G.y),e.lineTo(T.x,T.y),e.stroke()}}if(b){const{s:R,cl:E,t:D}=b;if(R===L.TRUE){e.beginPath();const M=bn(E)||pn;e.strokeStyle=M,this._setLineType(e,D||He.SINGLE);const P=ve(-vi-.5,d),G=en(p.addByPoint(c,P),v,x,A,C),T=en(p.addByPoint(c+l,P),v,x,A,C);e.moveTo(G.x,G.y),e.lineTo(T.x,T.y),e.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(e,t){t===He.DASH_DOT_DOT_HEAVY||t===He.DOT_DOT_DASH?e.setLineDash([2,2,5,2,2]):t===He.DASH_DOT_HEAVY||t===He.DOT_DASH?e.setLineDash([2,5,2]):t===He.DOTTED||t===He.DOTTED_HEAVY?e.setLineDash([2]):t===He.DASH||t===He.DASHED_HEAVY?e.setLineDash([3]):t===He.DASH_LONG||t===He.DASH_LONG_HEAVY?e.setLineDash([6]):e.setLineDash([0])}_getLineWidth(e){let t=1;return e===He.WAVY_HEAVY||e===He.DASHED_HEAVY||e===He.DOTTED_HEAVY||e===He.DASH_DOT_HEAVY||e===He.DASH_LONG_HEAVY||e===He.DASH_DOT_DOT_HEAVY?t=2:e===He.THICK&&(t=3),t}}Ss.add(new j3);const K3="DefaultDocsBorderExtension";class q3 extends vr{constructor(){super(...arguments),this.uKey=K3,this.zIndex=30,this._preBorderColor=""}draw(e,t,s){var g;const r=(g=s.parent)==null?void 0:g.parent;if(!r)return;const{asc:o=0,lineHeight:i=0}=r,{ts:a,left:c,width:l}=s;if(!a)return;const{bd:u}=a;if(!u)return;const h=this._getScale(t),d=this._createBorderCache(u),{spanStartPoint:f=Q.create(0,0)}=this.extensionOffset;for(let b of d.keys()){const p=d.get(b);if(!p)continue;const{s:v,cl:C}=p,w=bn(C)||pn;v!==this._preBorderStyle&&(ml(e,v),e.lineWidth=_l(v)/h,this._preBorderStyle=v),w!==this._preBorderColor&&(e.strokeStyle=w||pn,this._preBorderColor=w),gl(e,b,{startX:f.x,startY:f.y,endX:f.x+l,endY:f.y+i})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(e){const{t,b:s,l:r,r:o}=e,i=new Map;return t&&i.set(ut.TOP,t),s&&i.set(ut.BOTTOM,s),r&&i.set(ut.LEFT,r),o&&i.set(ut.RIGHT,o),i}}Ss.add(new q3);var Ws=(n=>(n[n.page=0]="page",n[n.section=1]="section",n[n.column=2]="column",n[n.line=3]="line",n[n.divide=4]="divide",n[n.span=5]="span",n))(Ws||{});const On={page:0,section:1,column:2,line:3,divide:4,span:5},Z3="__TestSelectionRange__",J3="__TestSelectionAnchor__";class Mi{constructor(e,t,s){this._scene=e,this.startNodePosition=t,this.endNodePosition=s,this._current=!1,this._Liquid=new Kr,this._cursor=0,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(e,t){return e.page>t.page?!1:e.page<t.page?!0:e.section>t.section?!1:e.section<t.section?!0:e.column>t.column?!1:e.column<t.column?!0:e.line>t.line?!1:e.line<t.line?!0:e.divide>t.divide?!1:e.divide<t.divide?!0:e.span>t.span?!1:(e.span<t.span,!0)}_compareNodePosition(e,t){return this._compareNodePositionLogic(e,t)?{start:e,end:t}:{start:t,end:e}}_setNodePositionState(e=0,t,s,r){r===t?this._currentStartState[e]=1:this._currentStartState[e]=0,r===s?this._currentEndState[e]=2:this._currentEndState[e]=0}_checkPreviousNodePositionState(e,t=!0){let s=e,r;for(;s>=0;){const o=Ws[s];let i;if(t?i=this._currentStartState[o]:i=this._currentEndState[o],i===void 0)return;if(r===void 0&&(r=i),i!==r)return 0;s--}return r}_getSelectionRuler(e,t,s,r,o){let i=0,a=r;const c=Ws[e],l=Ws[e+1];if(l===null||c===null)return{start_nest:i,end_nest:a};const u=t[c],h=s[c];this._setNodePositionState(c,u,h,o);const d=this._checkPreviousNodePositionState(e),f=this._checkPreviousNodePositionState(e,!1);return d===1&&(i=t[l]),f===2&&(a=s[l]),{start_nest:i,end_nest:a}}_pushToPoints(e){const{startX:t,startY:s,endX:r,endY:o}=e,i=[];return i.push({x:t,y:s}),i.push({x:r,y:s}),i.push({x:r,y:o}),i.push({x:t,y:o}),i.push({x:t,y:s}),i}isSamePosition(){const e=this.startNodePosition,t=this.endNodePosition;if(e==null||t==null)return!1;const s=Object.keys(On);for(let r of s){const o=e[r],i=t[r];if(o!==i)return!1}return!0}_createAndUpdateRange(e,t,s){if(this._rangeShape){this._rangeShape.translate(t,s),this._rangeShape.updatePointGroup(e),this._rangeShape.show();return}const r=new vo(Z3+ms(6),{pointsGroup:e,fill:Ke(nn.black,.2),left:t,top:s,evented:!1});this._rangeShape=r,this._scene.addObject(r,2)}_getAnchorBounding(e){const t=e[0],s=t[0],r=t[2],{x:o,y:i}=s,{x:a,y:c}=r;return{left:o,top:i,width:a-o,height:c-i}}_createAndUpdateAnchor(e,t,s){const r=this._getAnchorBounding(e),{left:o,top:i,width:a,height:c}=r;if(this._anchorShape){this._anchorShape.transformByState({left:o+t,top:i+s,height:c}),this._anchorShape.show();return}const l=new Ze(J3+ms(6),{left:o+t,top:i+s,height:c,strokeWidth:1,stroke:Ke(nn.black),evented:!1});this._anchorShape=l,this._scene.addObject(l,2)}_getRangePointData(e,t,s){const r=[],o=[];if(e==null||t==null)return{pointGroup:r,cursorList:o};const{start:i,end:a}=this._compareNodePosition(e,t),c=i.isBack,l=a.isBack;return this._selectionIterator(i,a,s,(u,h,d,f)=>{var O;const{lineHeight:g}=f,{spanGroup:b,st:p}=d,{x:v,y:C}=this._Liquid;let w;const x=b[u],A=b[h],z=(x==null?void 0:x.left)||0,R=(x==null?void 0:x.width)||0,E=(A==null?void 0:A.left)||0,D=(A==null?void 0:A.width)||0;let M=(x==null?void 0:x.spanType)===ft.LIST,P=((O=b[0])==null?void 0:O.spanType)===ft.LIST,G=u+p,T=h+p;const y=i===a;if(u===0&&h===b.length-1)w={startX:v+z+(M?R:0),startY:C,endX:v+E+D,endY:C+g};else{const U=(c||u===0&&!y)&&!M,B=l&&h!==b.length-1;G+=U?0:1,G-=P?1:0,T+=B?0:1,T-=P?1:0,console.log("span",{hasList:P,isStartBackFin:U,isEndBackFin:B,firstSpan:x,lastSpan:A,start_sp:u,end_sp:h,isStartBack:c,isEndBack:l,cursorStart:G,cursorEnd:T,isCurrentList:M}),w={startX:v+z+(U?0:R),startY:C,endX:v+E+(B?0:D),endY:C+g}}r.push(this._pushToPoints(w)),o.push({cursorStart:G,cursorEnd:T,isCollapse:y})}),{pointGroup:r,cursorList:o}}_selectionIterator(e,t,s,r){if(!s)return[];this._Liquid.reset();const i=s.getSkeletonData().pages,{page:a}=e,{page:c}=t;this._resetCurrentNodePositionState();for(let l=a;l<=c;l++){const u=i[l],h=u.sections,{start_nest:d,end_nest:f}=this._getSelectionRuler(On.page,e,t,h.length-1,l);this._Liquid.translatePagePadding(u);for(let g=d;g<=f;g++){const b=h[g],p=b.columns,{start_nest:v,end_nest:C}=this._getSelectionRuler(On.section,e,t,p.length-1,g);this._Liquid.translateSection(b);for(let w=v;w<=C;w++){const x=p[w],A=x.lines,{start_nest:z,end_nest:R}=this._getSelectionRuler(On.column,e,t,A.length-1,w);this._Liquid.translateColumn(x);for(let E=z;E<=R;E++){const D=A[E],{divides:M,type:P,lineHeight:G=0}=D,{start_nest:T,end_nest:y}=this._getSelectionRuler(On.line,e,t,M.length-1,E);this._Liquid.translateSave(),this._Liquid.translateLine(D);for(let O=T;O<=y;O++){const U=M[O];this._Liquid.translateSave(),this._Liquid.translateDivide(U);const B=U.spanGroup,{start_nest:X,end_nest:J}=this._getSelectionRuler(On.divide,e,t,B.length-1,O);r&&r(X,J,U,D,x,b,u),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}}}_setCursor(e){if(e.length===0)return;const t=e[0];this._cursor=t.cursorStart,console.log("_setCursor",t.cursorStart,t)}getCursor(){return this._cursor}getAnchor(){return this._anchorShape}activeStatic(){var e;(e=this._anchorShape)==null||e.setProps({stroke:Ke(nn.black,1)})}deactivateStatic(){var e;(e=this._anchorShape)==null||e.setProps({stroke:Ke(nn.black,0)})}isActive(){return this._current===!0}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return this.startNodePosition==null&&this.endNodePosition==null}isCollapsed(){return!!(this.startNodePosition!=null&&this.endNodePosition==null||this.isSamePosition())}isRange(){const e=this.startNodePosition,t=this.endNodePosition;return!(e==null||t==null||this.isSamePosition())}dispose(){var e,t;(e=this._rangeShape)==null||e.dispose(),this._rangeShape=null,(t=this._anchorShape)==null||t.dispose(),this._anchorShape=null}isIntersection(e){return!1}refresh(e){var c,l;const t=e.getSkeleton();if(!t)return;const s=this.startNodePosition,r=this.endNodePosition;if((c=this._anchorShape)==null||c.hide(),(l=this._rangeShape)==null||l.hide(),this.isEmpty())return;if(this.isCollapsed()){const u=this._getRangePointData(s,s,t),{pointGroup:h,cursorList:d}=u;this._setCursor(d),h.length>0&&this._createAndUpdateAnchor(h,e.left,e.top);return}const o=this._getRangePointData(s,r,t),{pointGroup:i,cursorList:a}=o;this._setCursor(a),i.length>0&&this._createAndUpdateRange(i,e.left,e.top)}getStart(){if(this.startNodePosition==null)return this.endNodePosition;if(this.endNodePosition==null)return this.startNodePosition;const{start:e}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return e}}class Io{constructor(e){var t;this._documents=e,this._textSelectionList=[],this._viewPortObserverMap=new Map,this.onKeydownObservable=new me,this.onInputObservable=new me,this.onCompositionstartObservable=new me,this.onCompositionupdateObservable=new me,this.onCompositionendObservable=new me,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=(t=this._documents)==null?void 0:t.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}_initialDom(){const e=document.createElement("div");e.style.position="absolute",e.style.position="absolute",e.style.left="0px",e.style.top="0px";const t=document.createElement("div"),s=document.createElement("div"),r=document.createElement("div");t.appendChild(s),e.appendChild(t),e.appendChild(r),this._container=e,this._inputParent=t,this._input=s,this._cursor=r,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(e)}_initialInput(){this._inputParent.style.cssText=`
            position:absolute;
            height:1px;
            width:1px;
            overflow: hidden;
        `,this._input.contentEditable="true",this._input.style.cssText=`
            position: absolute; 
            overflow: hidden; 
            opacity: 1; 
            background: #000; 
            color: transparent; 
            outline: none; 
            z-index: -2; 
            caret-color: transparent; 
            white-space: pre-wrap; 
            user-select: text;
        `}_initialCursorDom(){this._cursor.style.cssText=`
            visibility: visible;
            position: absolute;
            background: #000;
            left: 0;
            top: 0;
            width: 1px;
            height: 20px;
            opacity: 0;
            z-index: 0;
            pointer-events: none;
            display: none
        `,_6("keyframes univer_cursor_blinkStyle")||m6([`
                @-webkit-keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }
                
                    100% {
                        opacity: 1;
                    }
                }
            `,`
                @keyframes univer_cursor_blinkStyle {
                    0% {
                        opacity: 1;
                    }
                
                    13% {
                        opacity: 0;
                    }

                    50% {
                        opacity: 0;
                    }

                    63% {
                        opacity: 1;
                    }
                
                    100% {
                        opacity: 1;
                    }
                }
            `])}_getSkeletonData(){var e,t;return(t=(e=this._documents)==null?void 0:e.getSkeleton())==null?void 0:t.getSkeletonData()}_getNodePosition(e){var i;if(e===!1)return;const{node:t,ratioX:s,ratioY:r}=e,o=(i=this._documents)==null?void 0:i.findPositionBySpan(t);if(o!=null)return{...o,isBack:s<.5}}_interactTextSelection(e){const t=[];let s=!1;this._textSelectionList.forEach(r=>{e.isIntersection(r)?(s=!0,r.dispose()):t.push(r)}),s&&(t.push(e),this._textSelectionList=t)}_deleteAllTextSelection(){this._textSelectionList.forEach(e=>{e.dispose()}),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach(e=>{e.deactivate()})}_addTextSelection(e){this._deactivateTextSelection(),e.activate(),this._textSelectionList.push(e)}_updateTextSelection(e){if(!this._documents)return;let t=this._textSelectionList.pop();t||(t=new Mi(this._documents.getScene(),e)),this._deleteAllTextSelection(),t.activate(),t.startNodePosition=e,t.endNodePosition=null,this._textSelectionList=[t]}_getActiveTextSelection(){const e=this._textSelectionList;for(let t of e)if(t.isActive())return t}_isEmptyTextSelection(){return this._textSelectionList.length===0}_getCanvasOffset(){var o,i;const e=(o=this._documents)==null?void 0:o.getEngine(),t=(i=e==null?void 0:e.getCanvas())==null?void 0:i.getCanvasEle();if(!t)return{left:0,top:0};const{top:s,left:r}=E6(t);return{left:r,top:s}}_syncDomToSelection(){var l;const e=this._getActiveTextSelection(),t=e==null?void 0:e.getAnchor();if(!t||t&&!t.visible)return;const{height:s,left:r,top:o}=t,i=(l=this._activeViewport)==null?void 0:l.getAbsoluteVector(Q.FromArray([r,o]));this._cursor.style.height=`${s}px`;let{left:a,top:c}=this._getCanvasOffset();a+=(i==null?void 0:i.x)||0,c+=(i==null?void 0:i.y)||0,this.active(a,c)}_moving(e,t,s){if(Fn(s),!this._documents)return;const r=this._documents.findNodeByCoord(e,t),o=this._getNodePosition(r);if(!o)return;const i=this._getActiveTextSelection();!i||(i.endNodePosition=o,i.refresh(this._documents),this._interactTextSelection(i))}_attachScrollEvent(e){if(!e)return;const t=e.viewPortKey;if(this._viewPortObserverMap.has(t))return;const s=e.onScrollBeforeObserver.add(o=>{if(!o.viewport)return;const a=this._getActiveTextSelection();a==null||a.activeStatic(),this._cursor.style.display="none"}),r=e.onScrollStopObserver.add(o=>{const i=o.viewport;if(!i)return;const a=i.getBounding(),c=this._getActiveTextSelection(),l=c==null?void 0:c.getAnchor();if(!(!l||l&&!l.visible)){if(a){const{minX:u,maxX:h,minY:d,maxY:f}=gr(l,a);if(l.strokeWidth<u||h<0||l.strokeWidth<d||f<0)return}this._syncDomToSelection(),c==null||c.deactivateStatic(),this._cursor.style.display="revert"}});this._viewPortObserverMap.set(t,{scrollBefore:s,scrollStop:r})}_attachInputEvent(){this._input.addEventListener("keydown",e=>{if(this._isIMEInputApply)return;const t=this._getActiveTextSelection();this._documents!=null&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:e,content:"",document:this._documents,selection:t}))}),this._input.addEventListener("input",e=>{if(this._isIMEInputApply)return;const t=this._input.textContent||"";this._input.innerHTML="";const s=this._getActiveTextSelection();this._documents!=null&&this.onInputObservable.notifyObservers({event:e,content:t,document:this._documents,selection:s})}),this._input.addEventListener("compositionstart",e=>{this._isIMEInputApply=!0;const t=this._input.textContent||"";this._input.innerHTML="";const s=this._getActiveTextSelection();this._documents!=null&&this.onCompositionstartObservable.notifyObservers({event:e,content:t,document:this._documents,selection:s})}),this._input.addEventListener("compositionend",e=>{this._isIMEInputApply=!1;const t=this._input.textContent||"";this._input.innerHTML="";const s=this._getActiveTextSelection();this._documents!=null&&this.onCompositionendObservable.notifyObservers({event:e,content:t,document:this._documents,selection:s})}),this._input.addEventListener("compositionupdate",e=>{const t=this._input.textContent||"";this._input.innerHTML="";const s=this._getActiveTextSelection();this._documents!=null&&this.onCompositionupdateObservable.notifyObservers({event:e,content:t,document:this._documents,selection:s})})}_attachSelectionEvent(e){this._moveInObserver=e.onPointerEnterObserver.add(()=>{e.cursor=ze.TEXT}),this._moveOutObserver=e.onPointerLeaveObserver.add(()=>{e.cursor=ze.DEFAULT,t.resetCursor()});const t=e.getScene();this._downObserver=e.onPointerDownObserver.add((s,r)=>{const{offsetX:o,offsetY:i}=s;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(o,i);const a=this._documents.findNodeByCoord(o,i),c=this._getNodePosition(a);if(console.log(a,o,i),!c){this._deleteAllTextSelection();return}if(s.ctrlKey||this._isEmptyTextSelection()){const d=new Mi(this._documents.getScene(),c);this._addTextSelection(d)}else this._updateTextSelection(c);this._activeSelectionRefresh(),this._syncDomToSelection(),t.disableEvent();const l=vs.create(t);l.startScroll(o,i);const{scrollX:u,scrollY:h}=Fn(l);this._viewportScrollX=u,this._viewportScrollY=h,this._moveObserver=t.onPointerMoveObserver.add(d=>{const{offsetX:f,offsetY:g}=d;this._moving(f,g,l),l.scrolling(f,g,()=>{this._moving(f,g,l)}),t.setCursor(ze.TEXT)}),this._upObserver=t.onPointerUpObserver.add(d=>{t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent(),l.stopScroll()})})}_detachEvent(e){var t;e.onPointerEnterObserver.remove(this._moveInObserver),e.onPointerLeaveObserver.remove(this._moveOutObserver),e.onPointerDownObserver.remove(this._downObserver),(t=e.getSkeleton())==null||t.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const e=this._getActiveTextSelection();e==null||e.refresh(this._documents)}add(e){this._addTextSelection(e)}remain(){const e=this._getActiveTextSelection();if(e==null)return;const t=this._textSelectionList.indexOf(e);return this._textSelectionList.splice(t,1)[0]}sync(){this._syncDomToSelection()}active(e,t){this._container.style.left=`${e}px`,this._container.style.top=`${t}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout(()=>{this._input.focus()},0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(e){var t;this._documents&&this._detachEvent(this._documents),this._documents=e,this._skeletonObserver=(t=e.getSkeleton())==null?void 0:t.onRecalculateChangeObservable.add(s=>{this._deleteAllTextSelection()}),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}set activeViewport(e){this._attachScrollEvent(e),this._activeViewport=e}static create(e){return new Io(e)}}class yo extends W3{constructor(e,t,s){super(e,t,s==null?void 0:s.allowCache),this._hasEditor=!1,this.isCalculateSkeleton=!0,this.onPageRenderObservable=new me,(s==null?void 0:s.pageMarginLeft)===void 0?this.pageMarginLeft=17:this.pageMarginLeft=s==null?void 0:s.pageMarginLeft,(s==null?void 0:s.pageMarginTop)===void 0?this.pageMarginTop=14:this.pageMarginTop=s==null?void 0:s.pageMarginTop,this.pageLayoutType=(s==null?void 0:s.pageLayoutType)||zt.VERTICAL,this._drawLiquid=new Kr,this._findLiquid=new Kr,this._hasEditor=(s==null?void 0:s.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(t),this.makeDirty(!0)}_draw(e,t){this.draw(e,t)}_horizontalHandler(e,t,s,r){let o=0;return r===Ye.CENTER?o=(this.width-e)/2:r===Ye.RIGHT?o=this.width-e-s:o=t,o}_verticalHandler(e,t,s,r){let o=0;return r===Vt.MIDDLE?o=(this.height-e)/2:r===Vt.BOTTOM?o=this.height-e-s:o=t,o}_startRotation(e,t){e.rotate(t||0)}_resetRotation(e,t){e.rotate(-t||0)}_initialDefaultExtension(){Ss.getData().forEach(e=>{this.register(e)})}_addSkeletonChangeObserver(e){!e||(this._skeletonObserver=e.onRecalculateChangeObservable.add(t=>{const s=t.pages;let r=0,o=0;for(let i=0,a=s.length;i<a;i++){const c=s[i],{pageWidth:l,pageHeight:u}=c;this.pageLayoutType===zt.VERTICAL?(o+=u,i!==a-1&&(o+=this.pageMarginTop),r=Math.max(r,l)):this.pageLayoutType===zt.HORIZONTAL&&(r+=l,i!==a-1&&(r+=this.pageMarginLeft),o=Math.max(o,u))}this.resize(r,o),this.calculatePagePosition()}))}_disposeSkeletonChangeObserver(e){!e||e.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(e){const{pageWidth:t,pageHeight:s}=e;let{x:r,y:o}=this._findLiquid,i=-1,a=-1;return this.pageLayoutType===zt.VERTICAL?(i=t,a=o+s):this.pageLayoutType===zt.HORIZONTAL&&(i=r+t,a=s),{startX:r,startY:o,endX:i,endY:a}}calculatePagePosition(){const e=this.getScene(),t=e==null?void 0:e.getEngine(),{width:s,height:r,pageMarginLeft:o,pageMarginTop:i}=this;if(t==null)return;const{width:a,height:c}=t;let l=0,u=0,h=0,d=0;a>s?(l=a/2-s/2,h=a-30):(l=o,h=s+o*2),c>r?(u=c/2-r/2,d=c-30):(u=i,d=r+i*2),e.resize(h,d+200),this.translate(l,u)}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(e,t){return this.getScene().getActiveViewportByCoord(Q.FromArray([e,t]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=Io.create(this),this._hasEditor=!0)}disableEditor(){var e;(e=this._editor)==null||e.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:s,onCompositionendObservable:r,onKeydownObservable:o}=this._editor;return{onInputObservable:e,onCompositionstartObservable:t,onCompositionupdateObservable:s,onCompositionendObservable:r,onKeydownObservable:o}}remainActiveSelection(){if(!!this._hasEditor)return this._editor.remain()}addSelection(e){if(!!this._hasEditor)return this._editor.add(e)}syncSelection(){if(!!this._hasEditor)return this._editor.sync()}get hasEditor(){return this._hasEditor}draw(e,t){const s=this.getSkeleton();if(!s)return;this._drawLiquid.reset();const r=s.getSkeletonData(),{pages:o}=r,i=this.getParentScale(),a=this.getExtensionsByOrder(),c=bo(i);for(let h of a)h.clearCache();let l=0,u=0;for(let h=0,d=o.length;h<d;h++){const f=o[h],{sections:g,marginTop:b=0,marginBottom:p=0,marginLeft:v=0,marginRight:C=0,width:w,height:x,renderConfig:A={}}=f,{verticalAlign:z=Vt.TOP,horizontalAlign:R=Ye.LEFT,centerAngle:E=0,vertexAngle:D=0,wrapStrategy:M=Bt.UNSPECIFIED,isRotateNonEastAsian:P=L.FALSE}=A,G=this._horizontalHandler(w,v,C,R),T=this._verticalHandler(x,b,p,z),y=Q.create(G,T),O=us(E),U=us(D),B=U-O;this.onPageRenderObservable.notifyObservers({page:f,pageLeft:u,pageTop:l,ctx:e}),this._startRotation(e,B);for(let $ of g){const{columns:te}=$;this._drawLiquid.translateSection($);for(let re of te){const{lines:Te,width:_e}=re;this._drawLiquid.translateColumn(re);const Z=Te.length;let ne,oe=null;if(U!==0){const{rotateTranslateXList:Re,rotatedHeight:ue,rotatedWidth:be,fixOffsetX:Ae,fixOffsetY:Ne,rotateTranslateY:Xe}=t6(Te,_e,U);let We=be;ue>this.height&&M!==Bt.WRAP&&(M===Bt.OVERFLOW||U>0)&&(We=this.height/Math.tan(Math.abs(U)));const gt=this._horizontalHandler(We,v,C,R);let Ve=this._verticalHandler(ue,b,p,z)-Ne;ue>this.height&&(U<0?Ve=this.height-(ue+Ne):Ve=-Ne),ne=Q.create(gt+Ae,Ve),this._drawLiquid.translate(0,-Xe),oe=Re}else ne=y;for(let Re=0;Re<Z;Re++){const ue=Te[Re],{divides:be,asc:Ae=0,type:Ne,lineHeight:Xe=0}=ue;let We=Ae;const gt=We*Math.sin(O),Gt=We*Math.cos(O);if(Ne===ir.BLOCK)for(let Ve of a)Ve.type===qr.LINE&&(Ve.extensionOffset={alignOffset:ne,renderConfig:A},Ve.draw(e,i,ue));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(ue),oe&&this._drawLiquid.translate(oe[Re]);const Ve=be.length;for(let mt=0;mt<Ve;mt++){const At=be[mt],{spanGroup:cn}=At;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(At);for(let _t of cn){if(!_t.content||_t.content.length===0)continue;const{width:$t,left:St}=_t,{x:N,y:H}=this._drawLiquid,V=Q.create(ve(N,c),ve(H,c)),K=Q.create(ve($t/2,c),ve(Xe/2,c)),ie=en(V.addByPoint(ve(St,c),0),K,O,U,ne),Me=en(V.addByPoint(ve(St+gt,c),ve(Gt,c)),K,O,U,ne),he={originTranslate:V,spanStartPoint:ie,spanPointWithFont:Me,centerPoint:K,alignOffset:ne,renderConfig:A};for(let de of a)de.type===qr.SPAN&&(de.extensionOffset=he,de.draw(e,i,_t))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(e,B);const{x:X,y:J}=this._drawLiquid.translatePage(f,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);u=X,l=J}}changeSkeleton(e){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(e),this._addSkeletonChangeObserver(e),this}findPositionBySpan(e){var g;const t=e.parent,s=t==null?void 0:t.parent,r=s==null?void 0:s.parent,o=r==null?void 0:r.parent,i=o==null?void 0:o.parent,a=(g=this.getSkeleton())==null?void 0:g.getSkeletonData();if(!t||!r||!o||!i||!a)return;let c=t.spanGroup.indexOf(e);const l=s.divides.indexOf(t),u=r.lines.indexOf(s),h=o.columns.indexOf(r),d=i.sections.indexOf(o),f=a.pages.indexOf(i);return{span:c,divide:l,line:u,column:h,section:d,page:f}}findNodeByCharIndex(e){const t=this.getSkeleton();if(!t)return;const r=t.getSkeletonData().pages;for(let o of r){const{sections:i,st:a,ed:c}=o;if(!(e<a||e>c))for(let l of i){const{columns:u,st:h,ed:d}=l;if(!(e<h||e>d))for(let f of u){const{lines:g,st:b,ed:p}=f;if(!(e<b||e>p))for(let v of g){const{divides:C,lineHeight:w,st:x,ed:A}=v,z=C.length;if(!(e<x||e>A))for(let R=0;R<z;R++){const E=C[R],{spanGroup:D,st:M,ed:P}=E;if(e<M||e>P)continue;const G=D[e-M];if(G)return G}}}}}}findNodeByCoord(e,t){const r=this.getScene().transformToSceneCoord(Q.FromArray([e,t]));if(!r)return!1;const o=this._getInverseCoord(r);let{x:i,y:a}=o;const c=this.getSkeleton();if(!c)return!1;this._findLiquid.reset();const u=c.getSkeletonData().pages;for(let h=0,d=u.length;h<d;h++){const f=u[h],{startX:g,startY:b,endX:p,endY:v}=this._getPageBoundingBox(f);if(!(i>=g&&i<=p&&a>=b&&a<=v))continue;this._findLiquid.translatePagePadding(f);const C=f.sections;for(let w of C){const{columns:x,height:A}=w;this._findLiquid.translateSection(w);const{y:z}=this._findLiquid;if(a>=z&&a<=z+A)for(let R of x){const{lines:E,width:D}=R;this._findLiquid.translateColumn(R);const{x:M}=this._findLiquid;if(!(i>=M&&i<=M+D))continue;const P=E.length;for(let G=0;G<P;G++){const T=E[G],{divides:y,type:O,lineHeight:U=0}=T;if(O!==ir.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(T);const{y:B}=this._findLiquid,X=B,J=B+U;if(!(a>=X&&a<=J)){this._findLiquid.translateRestore();continue}const $=y.length;for(let te=0;te<$;te++){const re=y[te],{spanGroup:Te,width:_e}=re;this._findLiquid.translateSave(),this._findLiquid.translateDivide(re);const{x:Z}=this._findLiquid;if(!(i>=Z&&i<=Z+_e)){this._findLiquid.translateRestore();continue}for(let ne of Te){if(!ne.content||ne.content.length===0)continue;const{width:oe,left:Re}=ne,ue=Z+Re,be=Z+Re+oe;if(i>=ue&&i<=be)return{node:ne,ratioX:i/(ue+be),ratioY:a/(X+J)}}this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(f),this._findLiquid.translatePage(f,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}return!1}static create(e,t,s){return new yo(e,t,s)}}class qn extends Dl{constructor(){super(...arguments),this.type=0}getCellIndex(e,t,s,r,o){return f6(e,t,s,r,o)}}const Q3="DefaultBackgroundExtension";class ed extends qn{constructor(){super(...arguments),this.uKey=Q3,this.zIndex=20}draw(e,t,s){const{rowTitleWidth:r,columnTitleHeight:o,dataMergeCache:i,stylesCache:a}=s,{background:c}=a;if(!s)return;const{rowHeightAccumulation:l,columnTotalWidth:u,columnWidthAccumulation:h,rowTotalHeight:d}=s;if(!l||!h||u===void 0||d===void 0)return;e.save();const{scaleX:f=1,scaleY:g=1}=t;c&&Object.keys(c).forEach(b=>{const p=c[b];e.fillStyle=b||Ke([255,255,255]),e.beginPath(),p.forEach((v,C)=>{C.forEach(w=>{let{isMerged:x,startY:A,endY:z,startX:R,endX:E}=this.getCellIndex(v,w,l,h,i);if(x)return!0;A=ve(A,g),z=ve(z,g),R=ve(R,f),E=ve(E,f),e.moveTo(R,A),e.lineTo(R,z),e.lineTo(E,z),e.lineTo(E,A)})}),e.closePath(),e.fill()}),e.restore()}}mr.add(new ed);const td="DefaultBorderExtension";class nd extends qn{constructor(){super(...arguments),this.uKey=td,this.zIndex=30}draw(e,t,s){const{rowColumnSegment:r,rowTitleWidth:o,columnTitleHeight:i,dataMergeCache:a,stylesCache:c,overflowCache:l}=s,{border:u}=c;if(!s)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:f,rowTotalHeight:g}=s;if(!h||!f||d===void 0||g===void 0)return;e.save();const{scaleX:b=1,scaleY:p=1}=t,v=this._getScale(t);let C,w;u==null||u.forEach((x,A)=>{A==null||A.forEach((z,R)=>{if(!R)return!0;let{isMerged:E,startY:D,endY:M,startX:P,endX:G}=this.getCellIndex(x,z,h,f,a);if(E)return!0;D=ve(D,p),M=ve(M,p),P=ve(P,b),G=ve(G,b);for(let T in R){const{type:y,style:O,color:U}=R[T];this._getOverflowExclusion(l,y,x,z)||(O!==C&&(ml(e,O),e.lineWidth=_l(O)/v,C=O),U!==w&&(e.strokeStyle=U||pn,w=U),gl(e,y,{startX:P,startY:D,endX:G,endY:M}))}})}),e.closePath(),e.restore()}_getOverflowExclusion(e,t,s,r){let o=!1;return t===ut.TOP||t===ut.BOTTOM||e&&e.forEach((i,a)=>{if(i!==s)return!0;a.forEach((c,l)=>{const{startColumn:u,endColumn:h}=l;if(t===ut.LEFT&&c>u&&c<=h||t===ut.RIGHT&&c>=u&&c<h)return o=!0,!1})}),o}}mr.add(new nd);const sd="DefaultBorderAuxiliaryExtension";class rd extends qn{constructor(){super(...arguments),this.uKey=sd,this.zIndex=10}draw(e,t,s){const{rowColumnSegment:r,rowTitleWidth:o=0,columnTitleHeight:i=0,dataMergeCache:a,overflowCache:c,stylesCache:l}=s,{startRow:u,endRow:h,startColumn:d,endColumn:f}=r;if(!s)return;const{rowHeightAccumulation:g,columnTotalWidth:b,columnWidthAccumulation:p,rowTotalHeight:v}=s;if(!g||!p||b===void 0||v===void 0)return;e.save();const C=this._getScale(t);e.beginPath(),e.lineWidth=1/C,e.strokeStyle=Ke([217,217,217]);let w=ve(b,C),x=ve(v,C);const A=p.length,z=g.length;for(let R=u-1;R<=h;R++){if(R<0||R>z-1)continue;const E=ve(g[R],C);e.moveTo(0,E),e.lineTo(w,E)}for(let R=d;R<=f;R++){if(R<0||R>A-1)continue;const E=ve(p[R],C);e.moveTo(E,0),e.lineTo(E,x)}e.stroke(),e.closePath(),this._clearRectangle(e,C,g,p,a),this._clearRectangle(e,C,g,p,c),e.restore()}_clearRectangle(e,t,s,r,o){o==null||o.forEach((i,a)=>{a==null||a.forEach((c,l)=>{const{startRow:u,endRow:h,startColumn:d,endColumn:f}=l,g=ve(s[u-1]||0,t),b=ve(s[h],t),p=ve(r[d-1]||0,t),v=ve(r[f],t);e.clearRect(p,g,v-p,b-g),e.beginPath(),e.moveTo(p,g),e.lineTo(v,g),e.lineTo(v,b),e.lineTo(p,b),e.lineTo(p,g),e.stroke(),e.closePath()})})}}mr.add(new rd);const od="DefaultFontExtension";class id extends qn{constructor(){super(...arguments),this.uKey=od,this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(e,t,s){this.changeFontColor.setValue(e,t,s)}draw(e,t,s){const{rowColumnSegment:r,rowTitleWidth:o,columnTitleHeight:i,stylesCache:a,dataMergeCache:c,overflowCache:l}=s,{font:u}=a;if(!s)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:f,rowTotalHeight:g}=s;if(!h||!f||d===void 0||g===void 0)return;e.save();const b=this._getScale(t),{scaleX:p=1,scaleY:v=1}=t;u&&Object.keys(u).forEach(C=>{u[C].forEach((x,A)=>{A.forEach((z,R)=>{let{isMerged:E,isMergedMainCell:D,startY:M,endY:P,startX:G,endX:T,mergeInfo:y}=this.getCellIndex(x,z,h,f,c);if(E)return!0;M=ve(M,v),P=ve(P,v),G=ve(G,p),T=ve(T,p);const O=T-G,U=P-M,B=l.getValue(x,z),{horizontalAlign:X}=R;if(e.save(),e.beginPath(),B){const{startColumn:J,startRow:$,endColumn:te,endRow:re}=B;J===te&&J===z?e.rect(G,M,O,U):X===Ye.CENTER?this._clipRectangle(e,$,re,J,te,b,h,f):X===Ye.RIGHT?this._clipRectangle(e,$,x,J,z,b,h,f):this._clipRectangle(e,x,re,z,te,b,h,f)}else e.rect(G,M,O,U);e.clip(),e.translate(G,M),this._renderDocuments(e,R,G,M,T,P,x,z),e.restore()})})}),e.restore()}_renderDocuments(e,t,s,r,o,i,a,c){const l=this.getDocuments(),{documentSkeleton:u,angle:h,verticalAlign:d,horizontalAlign:f,wrapStrategy:g,content:b}=t,p=o-s,v=i-r;g===Bt.WRAP&&h===0&&(u.updateDocumentDataPageSize(p),u.calculate()),u.makeDirty(!1),l.resize(p,v),l.changeSkeleton(u).render(e)}_clipRectangle(e,t,s,r,o,i,a,c){const l=ve(a[t-1]||0,i),u=ve(a[s],i),h=ve(c[r-1]||0,i),d=ve(c[o],i);e.rect(h,l,d-h,u-l)}}mr.add(new id);const ad="DefaultRowTitleLayoutExtension";class ld extends qn{constructor(){super(...arguments),this.uKey=ad,this.zIndex=10}draw(e,t,s){const{rowColumnSegment:r,rowTitleWidth:o=0,columnTitleHeight:i=0}=s,{startRow:a,endRow:c,startColumn:l,endColumn:u}=r;if(!s)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:f,rowTotalHeight:g}=s;if(!h||!f||d===void 0||g===void 0)return;const b=this._getScale(t);e.fillStyle=Ke([248,249,250]),e.fillRect(0,0,o,g),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Ke([0,0,0]),e.beginPath(),e.lineWidth=1/b,e.strokeStyle=Ke([217,217,217]);let p=0;const v=h.length;for(let C=a-1;C<=c;C++){if(C<0||C>v-1)continue;const w=ve(h[C],b);if(p===w)continue;e.moveTo(0,w),e.lineTo(o,w);const x=p+(w-p)/2;e.fillText(`${C+1}`,o/2,x+fl),p=w}e.moveTo(ve(o,b),0),e.lineTo(ve(o,b),g),e.stroke()}}S6.add(new ld);const cd="DefaultColumnTitleLayoutExtension";class ud extends qn{constructor(){super(...arguments),this.uKey=cd,this.zIndex=10}draw(e,t,s){const{rowColumnSegment:r,rowTitleWidth:o=0,columnTitleHeight:i=0}=s,{startRow:a,endRow:c,startColumn:l,endColumn:u}=r;if(!s)return;const{rowHeightAccumulation:h,columnTotalWidth:d,columnWidthAccumulation:f,rowTotalHeight:g}=s;if(!h||!f||d===void 0||g===void 0)return;const b=this._getScale(t);e.fillStyle=Ke([248,249,250]),e.fillRect(0,0,d,i),e.textAlign="center",e.textBaseline="middle",e.fillStyle=Ke([0,0,0]),e.beginPath(),e.lineWidth=1/b,e.strokeStyle=Ke([217,217,217]);let p=0;const v=f.length;for(let w=l-1;w<=u;w++){if(w<0||w>v-1)continue;const x=ve(f[w],b);if(p===x)continue;e.moveTo(x,0),e.lineTo(x,i);const A=p+(x-p)/2;e.fillText(nh(w),A,i/2+fl),p=x}const C=ve(i,b);e.moveTo(0,C),e.lineTo(d,C),e.stroke()}}O6.add(new ud);const ki=["text","richText"];class Ll extends Kn{constructor(e,t,s){super(t),this._allowCache=!1,s!=null&&s.richText?this._documentData=s.richText:s&&(this._fs=s.fs,this._ff=s.ff,this._it=s.it,this._bl=s.bl,this._ul=s.ul,this._st=s.st,this._ol=s.ol,this._bg=s.bg,this._bd=s.bd,this._cl=s.cl,this._documentData=this.convertToDocumentData(s.text||"")),this._allowCache&&(this._cacheCanvas=new ys,this.onTransformChangeObservable.add(()=>{this.resizeCacheCanvas()})),this._context=e,this._documentSkeleton=pr.create(this._documentData,this._context),this._documents=new yo(`${this.oKey}_DOCUMENTS`,this._documentSkeleton,{pageMarginLeft:0,pageMarginTop:0}),this._initialProps(s),this.onTransformChangeObservable.add(r=>{const{type:o,value:i,preValue:a}=r;if(o===qe.resize||o===qe.all){this._documentSkeleton.updateDocumentDataPageSize(this.width),this._documentSkeleton.makeDirty(!0),this._documentSkeleton.calculate();const c=this.getDocsSkeletonPageSize();this.height=(c==null?void 0:c.height)||this.height,this._setTransForm()}})}get documentData(){return this._documentData}getDocsSkeletonPageSize(){var i;const e=(i=this._documentSkeleton)==null?void 0:i.getSkeletonData();if(!e)return;const{pages:t}=e,s=t[t.length-1],{width:r,height:o}=s;return{width:r,height:o}}convertToDocumentData(e){const t=e.length;return{id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:t,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:t,et:F.TEXT_RUN,tr:{ct:e,ts:{fs:this._fs||14,ff:this._ff,it:this._it,bl:this._bl,ul:this._ul,st:this._st,ol:this._ol,bg:this._bg,bd:this._bd,cl:this._cl}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(e){this._documentSkeleton.updateDocumentDataPageSize(e==null?void 0:e.width,e==null?void 0:e.height),this._documentSkeleton.calculate();const t=this.getDocsSkeletonPageSize();this.transformByState({width:(t==null?void 0:t.width)||0,height:(t==null?void 0:t.height)||0,left:(e==null?void 0:e.left)||0,top:(e==null?void 0:e.top)||0,angle:e==null?void 0:e.angle}),this.setProps(e),this.makeDirty(!0)}setProps(e){if(!e)return;const t=Object.keys(e);if(t.length!==0)return t.forEach(s=>{if(e[s]===void 0)return!0;ki.indexOf(s)===-1&&(this[`_${s}`]=e[s])}),this.makeDirty(!0),this}_draw(e){this._documents.render(e)}render(e,t){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:r,maxX:o,minY:i,maxY:a}=gr(this,t);if(this.width+this.strokeWidth<r||o<0||this.height+this.strokeWidth<i||a<0)return this}const s=this.transform.getMatrix();if(e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),this._allowCache){if(this.isDirty()){const r=this._cacheCanvas.getContext();this._cacheCanvas.clear(),r.save(),r.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(r),r.restore()}this._applyCache(e)}else this._draw(e);return e.restore(),this.makeDirty(!1),this}_applyCache(e){if(!e||!this._cacheCanvas)return;const t=this._cacheCanvas.getPixelRatio(),s=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,s,r,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}getContext(){return this._context}toJson(){const e={};return ki.forEach(t=>{this[t]&&(e[t]=this[t])}),{...super.toJson(),...e}}}const hd=["__SpreadsheetTransformerResizeLT__","__SpreadsheetTransformerResizeCT__","__SpreadsheetTransformerResizeRT__","__SpreadsheetTransformerResizeLM__","__SpreadsheetTransformerResizeRM__","__SpreadsheetTransformerResizeLB__","__SpreadsheetTransformerResizeCB__","__SpreadsheetTransformerResizeRB__"];class dd{constructor(e,t){this._scene=e,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this.onChangeStartObservable=new me,this.onChangingObservable=new me,this.onChangeEndObservable=new me,this._initialProps(t)}_initialProps(e){if(!e)return;const t=Object.keys(e);t.length!==0&&t.forEach(s=>{if(e[s]===void 0)return!0;this[s]=e[s]})}_updateControlChildren(){this._updateControlIterator((e,t)=>{const{left:s,top:r,width:o,height:i,scaleX:a,scaleY:c}=t.getState();e.getObjects().forEach(u=>{const h=u.oKey,d=this._checkTransformerType(h);if(!d)return!0;if(d==="__SpreadsheetTransformerOutline__")u.transformByState(this._getOutlinePosition(o,i,a,c));else{const{left:f,top:g}=this._getRotateAnchorPosition(d,i,o,a,c);u.transformByState({left:f,top:g})}}),e.transformByState({left:s,top:r})})}_anchorMoving(e,t,s,r){const{scrollX:o,scrollY:i}=Fn(r),a=t-this._viewportScrollX+o,c=s-this._viewportScrollY+i,l=a-this._startOffsetX,u=c-this._startOffsetY;this._selectedObjectMap.forEach(h=>{const{left:d,top:f,width:g,height:b}=h,p={};switch(e){case"__SpreadsheetTransformerResizeLT__":p.left=d+l,p.top=f+u,p.width=g-l,p.height=b-u;break;case"__SpreadsheetTransformerResizeCT__":p.top=f+u,p.height=b-u;break;case"__SpreadsheetTransformerResizeRT__":p.top=f+u,p.width=g+l,p.height=b-u;break;case"__SpreadsheetTransformerResizeLM__":p.left=d+l,p.width=g-l;break;case"__SpreadsheetTransformerResizeRM__":p.width=l+g;break;case"__SpreadsheetTransformerResizeLB__":p.left=d+l,p.width=g-l,p.height=b+u;break;case"__SpreadsheetTransformerResizeCB__":p.height=u+b;break;case"__SpreadsheetTransformerResizeRB__":p.width=l+g,p.height=u+b;break}h.transformByState(p)}),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:u,type:1}),this._startOffsetX=a,this._startOffsetY=c}_attachEventToAnchor(e,t="__SpreadsheetTransformerResizeLT__"){e.onPointerDownObserver.add((s,r)=>{const{offsetX:o,offsetY:i}=s;this._startOffsetX=o,this._startOffsetY=i;const a=this._getTopScene();if(a==null)return;a.disableEvent();const c=vs.create(a);c.startScroll(o,i);const{scrollX:l,scrollY:u}=Fn(c);this._viewportScrollX=l,this._viewportScrollY=u;const h=this._getRotateAnchorCursor(t);this._moveObserver=a.onPointerMoveObserver.add(d=>{const{offsetX:f,offsetY:g}=d;this._anchorMoving(t,f,g,c),c.scrolling(f,g,()=>{this._anchorMoving(t,f,g,c)}),a.setCursor(h)}),this._upObserver=a.onPointerUpObserver.add(d=>{a.onPointerMoveObserver.remove(this._moveObserver),a.onPointerUpObserver.remove(this._upObserver),a.enableEvent(),a.resetCursor(),c.stopScroll()}),r.stopPropagation()})}_attachEventToRotate(e){e.onPointerDownObserver.add((t,s)=>{const{offsetX:r,offsetY:o}=t;this._startOffsetX=r,this._startOffsetY=o;const i=this._getTopScene();i!=null&&(i.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=i.onPointerMoveObserver.add(a=>{}),this._upObserver=i.onPointerUpObserver.add(a=>{i.onPointerMoveObserver.remove(this._moveObserver),i.onPointerUpObserver.remove(this._upObserver),i.enableEvent()}),s.stopPropagation())})}_getOutlinePosition(e,t,s,r){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:e+this.borderSpacing*2,height:t+this.borderSpacing*2}}_getRotateAnchorCursor(e){let t=ze.NORTH_WEST_RESIZE;switch(e){case"__SpreadsheetTransformerRotate__":t=ze.MOVE;break;case"__SpreadsheetTransformerRotateLine__":t=ze.MOVE;break;case"__SpreadsheetTransformerResizeLT__":break;case"__SpreadsheetTransformerResizeCT__":t=ze.NORTH_RESIZE;break;case"__SpreadsheetTransformerResizeRT__":t=ze.NORTH_EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLM__":t=ze.WEST_RESIZE;break;case"__SpreadsheetTransformerResizeRM__":t=ze.EAST_RESIZE;break;case"__SpreadsheetTransformerResizeLB__":t=ze.SOUTH_WEST_RESIZE;break;case"__SpreadsheetTransformerResizeCB__":t=ze.SOUTH_RESIZE;break;case"__SpreadsheetTransformerResizeRB__":t=ze.SOUTH_EAST_RESIZE;break}return t}_getRotateAnchorPosition(e,t,s,r,o){let i=-this.anchorSize/2,a=-this.anchorSize/2;switch(e){case"__SpreadsheetTransformerRotate__":i=s/2-this.rotateSize/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth*2-this.rotateSize;break;case"__SpreadsheetTransformerRotateLine__":i=s/2,a=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLT__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCT__":i+=s/2,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRT__":i+=s+this.borderSpacing-this.borderStrokeWidth,a+=-this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeLM__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeRM__":i+=s+this.borderSpacing-this.borderStrokeWidth,a+=t/2;break;case"__SpreadsheetTransformerResizeLB__":i+=-this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeCB__":i+=s/2,a+=t+this.borderSpacing-this.borderStrokeWidth;break;case"__SpreadsheetTransformerResizeRB__":i+=s+this.borderSpacing-this.borderStrokeWidth,a+=t+this.borderSpacing-this.borderStrokeWidth;break}return{left:i,top:a}}_createResizeAnchor(e,t,s){let{height:r,width:o,scaleX:i,scaleY:a}=t.getState();const{left:c,top:l}=this._getRotateAnchorPosition(e,r,o,i,a),u=this._getRotateAnchorCursor(e),h=new Ze(`${e}_${s}`,{zIndex:s-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:c,top:l});return this._attachHover(h,u,ze.DEFAULT),h}_checkTransformerType(e){if(e.indexOf("__SpreadsheetTransformerOutline__")>-1)return"__SpreadsheetTransformerOutline__";if(e.indexOf("__SpreadsheetTransformerRotate__")>-1)return"__SpreadsheetTransformerRotate__";if(e.indexOf("__SpreadsheetTransformerRotateLine__")>-1)return"__SpreadsheetTransformerRotateLine__";if(e.indexOf("__SpreadsheetTransformerResizeLT__")>-1)return"__SpreadsheetTransformerResizeLT__";if(e.indexOf("__SpreadsheetTransformerResizeCT__")>-1)return"__SpreadsheetTransformerResizeCT__";if(e.indexOf("__SpreadsheetTransformerResizeRT__")>-1)return"__SpreadsheetTransformerResizeRT__";if(e.indexOf("__SpreadsheetTransformerResizeLM__")>-1)return"__SpreadsheetTransformerResizeLM__";if(e.indexOf("__SpreadsheetTransformerResizeRM__")>-1)return"__SpreadsheetTransformerResizeRM__";if(e.indexOf("__SpreadsheetTransformerResizeLB__")>-1)return"__SpreadsheetTransformerResizeLB__";if(e.indexOf("__SpreadsheetTransformerResizeCB__")>-1)return"__SpreadsheetTransformerResizeCB__";if(e.indexOf("__SpreadsheetTransformerResizeRB__")>-1)return"__SpreadsheetTransformerResizeRB__"}_updateControlIterator(e){this._transformerControlMap.forEach((t,s)=>{const r=this._selectedObjectMap.get(s);if(!r)return!0;e(t,r)})}_updateControl(){this._updateControlIterator((e,t)=>{const{left:s,top:r}=t.getState();e.transformByState({left:s,top:r}),e.show(),e.makeDirty(!0)})}_hiddenControl(){this._transformerControlMap.forEach(e=>{e.hide(),e.makeDirty(!0)})}_attachHover(e,t,s){e.onPointerEnterObserver.add(()=>{e.cursor=t}),e.onPointerLeaveObserver.add(()=>{e.cursor=s})}_clearControl(){this._transformerControlMap.forEach(e=>{e.dispose()}),this._transformerControlMap.clear()}_createControl(e){let{left:t,top:s,height:r,width:o,angle:i,scaleX:a,scaleY:c,skewX:l,skewY:u,flipX:h,flipY:d}=e.getState();const f=e.oKey,g=this._selectedObjectMap.size,b=[];if(this.borderEnabled){const C=new Ze(`__SpreadsheetTransformerOutline___${g}`,{zIndex:g-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke,...this._getOutlinePosition(o,r,a,c)});b.push(C)}if(this.resizeEnabled){const{left:C,top:w}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotateLine__",r,o,a,c),x=new Ze(`__SpreadsheetTransformerRotateLine___${g}`,{zIndex:g-1,evented:!1,left:C,top:w,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:A,top:z}=this._getRotateAnchorPosition("__SpreadsheetTransformerRotate__",r,o,a,c),R=this._getRotateAnchorCursor("__SpreadsheetTransformerRotate__"),E=new Ze(`__SpreadsheetTransformerRotate___${g}`,{zIndex:g-1,left:A,top:z,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:this.borderStrokeWidth*2,stroke:this.borderStroke});this._attachEventToRotate(E),this._attachHover(E,R,ze.DEFAULT),b.push(x,E)}if(this.resizeEnabled)for(let C=0,w=this.enabledAnchors.length;C<w;C++){if(this.enabledAnchors[C]!==1)continue;const A=hd[C],z=this._createResizeAnchor(A,e,g);this._attachEventToAnchor(z,A),b.push(z)}const p=new R6(`__SpreadsheetTransformer___${g}`,...b);p.zIndex=g,p.evented=!1,p.transformByState({left:t,top:s});const v=this.getScene();return v.addObject(p,2),console.log(v,e),this._transformerControlMap.set(f,p),p}getScene(){return this._scene}_getTopScene(){var t;return(t=this.getScene().getEngine())==null?void 0:t.activeScene}_moving(e,t,s){const{scrollX:r,scrollY:o}=Fn(s),i=e-this._viewportScrollX+r,a=t-this._viewportScrollY+o,c=i-this._startOffsetX,l=a-this._startOffsetY;this._selectedObjectMap.forEach(u=>{u.translate(c+u.left,l+u.top)}),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:c,moveY:l,type:1}),this._startOffsetX=i,this._startOffsetY=a}_updateActiveObjectList(e,t){this._selectedObjectMap.has(e.oKey)||(t.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(e.oKey,e),this._createControl(e))}_addCancelObserver(e){e.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=e.onPointerDownObserver.add(t=>{this._selectedObjectMap.clear(),this._clearControl(),e.onPointerDownObserver.remove(this._cancelFocusObserver)})}attachTo(e){if(!!e.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&e.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&e.onPointerLeaveObserver.add(this.hoverLeaveFunc)),e.onPointerDownObserver.add((t,s)=>{const{offsetX:r,offsetY:o}=t;this._startOffsetX=r,this._startOffsetY=o;const i=this._getTopScene();if(!i)return;this._addCancelObserver(i),i.disableEvent();const a=vs.create(i);a.startScroll(r,o);const{scrollX:c,scrollY:l}=Fn(a);this._viewportScrollX=c,this._viewportScrollY=l,this._updateActiveObjectList(e,t),this._moveObserver=i.onPointerMoveObserver.add(u=>{const{offsetX:h,offsetY:d}=u;this._moving(h,d,a),this._hiddenControl(),a.scrolling(h,d,()=>{this._moving(h,d,a)})}),this._upObserver=i.onPointerUpObserver.add(u=>{i.onPointerMoveObserver.remove(this._moveObserver),i.onPointerUpObserver.remove(this._upObserver),i.enableEvent(),this._updateControl(),a.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})}),s.stopPropagation()}),e}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach(e=>{e.dispose()}),this._selectedObjectMap.forEach(e=>{e.dispose()}),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}}class Bi{constructor(e,t,s){var r;if(this._parent=t,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new $e,this._isFirstDirty=!0,this._evented=!0,this._cursor=ze.DEFAULT,this._transformerOpenState=!1,this.onPointerDownObserver=new me,this.onPointerMoveObserver=new me,this.onPointerUpObserver=new me,this.onDblclickObserver=new me,this.onMouseWheelObserver=new me,this.onKeyDownObservable=new me,this.onKeyUpObservable=new me,this.onTransformChangeObservable=new me,this._sceneKey=e,s&&this.transformByState(s),this._parent.classType===fe.ENGINE){const o=this._parent;o.addScene(this),o.hasActiveScene()||o.setActiveScene(e),this._inputManager=new As(this)}else this._parent.classType===fe.SCENE_VIEWER&&this._parent.addObject(this);(r=this._parent)==null||r.onTransformChangeObservable.add(o=>{this._resetViewportSize(),this._setTransForm()})}attachControl(e=!0,t=!0,s=!0,r=!0){var o;if(this._parent.classType===fe.ENGINE)return(o=this._inputManager)==null||o.attachControl(e,t,s,r),this}detachControl(){var e;return(e=this._inputManager)==null||e.detachControl(),this}makeDirty(e=!0){var t;return this._viewports.forEach(s=>{s.makeDirty(e)}),this._parent.classType===fe.SCENE_VIEWER&&((t=this._parent)==null||t.makeDirty(e)),this}makeDirtyNoParent(e=!0){return this._viewports.forEach(t=>{t.makeDirty(e)}),this}isDirty(){for(let e=0;e<this._viewports.length;e++)if(this._viewports[e].isDirty()===!0)return!0;return!1}get cursor(){return this._cursor}set cursor(e){this.setCursor(e)}resetCursor(){this.setCursor(ze.DEFAULT)}setCursor(e){this._cursor=e;const t=this.getEngine();if(!t)return;const s=t.getCanvas().getCanvasEle();s.style.cursor=e}get classType(){return fe.SCENE}get transform(){return this._transform}set transform(e){this._transform=e}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const e=this.getParent();let t=1;return e.classType===fe.SCENE_VIEWER&&(t=e.ancestorScaleX),this._scaleX*t}get ancestorScaleY(){const e=this.getParent();let t=1;return e.classType===fe.SCENE_VIEWER&&(t=e.ancestorScaleY),this._scaleY*t}set width(e){this._width=e}set height(e){this._height=e}set scaleX(e){this._scaleX=e}set scaleY(e){this._scaleY=e}resize(e,t){const s=this.width;e!==void 0&&(this.width=e);const r=this.height;return t!==void 0&&(this.height=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.resize,value:{width:this.width,height:this.height},preValue:{width:s,height:r}}),this}scale(e,t){const s=this.scaleX;e!==void 0&&(this.scaleX=e);const r=this.scaleY;return t!==void 0&&(this.scaleY=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:s,scaleY:r}}),this}scaleBy(e,t){const s=this.scaleX;e!==void 0&&(this.scaleX+=e);const r=this.scaleY;return t!==void 0&&(this.scaleY+=t),this.scaleX=Yr(this.scaleX,1),this.scaleY=Yr(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:s,scaleY:r}}),this}transformByState(e){const t=Object.keys(e),s={};t.length!==0&&(t.forEach(r=>{e[r]!==void 0&&(s[r]=this[r],this[r]=e[r])}),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:qe.all,value:e,preValue:s}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===fe.ENGINE)return this._parent;let e=this._parent;for(;e;){if(e.classType===fe.ENGINE)return e;e=e==null?void 0:e.getParent()}return null}getLayers(){return this._layers}getLayer(e=1){for(let t of this._layers)if(t.zIndex===e)return t;return this._createDefaultLayer(e)}_createDefaultLayer(e=1){const t=T6.create(this,[],e);return this.addLayer(t),t}getLayerMaxZIndex(){let e=Number.MIN_VALUE;for(let t=0;t<this._layers.length;t++){const s=this._layers[t];s.zIndex>=e&&(e=s.zIndex)}return e}addLayer(...e){this._layers.push(...e)}addObject(e,t=1){var s;return(s=this.getLayer(t))==null||s.addObject(e),this}setObjectBehavior(e){e.parent||(e.parent=this),this.onTransformChangeObservable.add(t=>{e.scaleCacheCanvas()}),e.onIsAddedToParentObserver.notifyObservers(this)}addObjects(e,t=1){var s;return(s=this.getLayer(t))==null||s.addObjects(e),this}removeObject(e){const t=this.getLayers();for(let s of t)s.removeObject(e);return this}getAllObjects(){const e=[];this._layers.sort(rt);for(let t of this._layers)e.push(...t.getObjectsByOrder());return e}getAllObjectsByOrder(e=!1){const t=[],s=e?mi:rt;this._layers.sort(s);for(let r of this._layers)t.push(...r.getObjectsByOrder().sort(s));return t}getAllObjectsByOrderForPick(e=!1){const t=[],s=e?mi:rt;this._layers.sort(s);for(let r of this._layers)t.push(...r.getObjectsByOrderForPick().sort(s));return t}getObject(e){for(let t of this._layers){const s=t.getObjectsByOrder();for(let r of s)if(r.oKey===e)return r}}fuzzyMathObjects(e){const t=[];for(let s of this._layers){const r=s.getObjectsByOrder();for(let o of r)o.oKey.indexOf(e)>-1&&r.push(o)}return t}addViewport(...e){return this._viewports.push(...e),this}removeViewport(){}getViewports(){return this._viewports}getViewport(e){for(let t of this._viewports)if(t.viewPortKey===e)return t}changeObjectOrder(){}get sceneKey(){return this._sceneKey}async requestRender(e){return new Promise((t,s)=>{this.render(e),ar(t)})}renderObjects(e,t){return this.getAllObjectsByOrder().forEach(s=>{s.render(e,t)}),this}render(e){var t,s;!this.isDirty()||(!e&&((t=this.getEngine())==null||t.getCanvas().clear()),(s=this.getViewports())==null||s.forEach(r=>r.render(e)))}_resetViewportSize(){this.getViewports().forEach(e=>{e.resetSize()})}_setTransForm(){const e=$e.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=e,this.getViewports().forEach(t=>{t.resizeScrollBar()}),this.makeDirty(!0)}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}get evented(){return this._evented}openTransformer(e){this._transformer||(this._transformer=new dd(this,e)),this._transformerOpenState=!0}closeTransformer(e=!1){e&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(e){var t;!this._transformerOpenState||(t=this._transformer)==null||t.attachTo(e)}getTransformer(){return this._transformer}getActiveViewportByCoord(e){return this._viewports.find(t=>t.isHit(e))}transformToSceneCoord(e){const t=this.getActiveViewportByCoord(e);return t==null?void 0:t.getRelativeVector(e)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var e;this.getLayers().forEach(t=>{t.dispose()}),this.getViewports().forEach(t=>{t.dispose()}),this.clearLayer(),this.clearViewports(),this.detachControl(),(e=this._transformer)==null||e.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(e){let t=this.getActiveViewportByCoord(e);if(t||(t=this._viewports[0]),!this._evented||!t)return;const s=t.pickScrollBar(e);if(s)return s;const r=t.getRelativeVector(e);let o=null;const i=this.getAllObjectsByOrderForPick().reverse(),a=i.length;for(let c=0;c<a;c++){const l=i[c];if(!l.visible||!l.evented||l.classType===fe.GROUP)continue;let u=r;if(l.isInGroup&&l.parent.classType===fe.GROUP){const{cumLeft:h,cumTop:d}=this._getGroupCumLeftRight(l);u=u.clone().add(Q.FromArray([-h,-d]))}if(l.isHit(u)){if(l.classType===fe.SCENE_VIEWER){const h=l.pick(u);h?o=h:o=l.scene}else o=l;break}else if(l.classType===fe.SCENE_VIEWER){const h=l.pick(u);if(h){o=h;break}}}return!o&&this._parent.classType===fe.ENGINE?this:o}_getGroupCumLeftRight(e){let t=e.parent,s=0,r=0;for(;t.classType===fe.GROUP;){const{left:o,top:i}=t;s+=o,r+=i,t=t.parent}return{cumLeft:s,cumTop:r}}on(e,t){return this[`on${e}Observer`].add(t.bind(this))}off(e,t){this[`on${e}Observer`].remove(t)}remove(e){this[`on${e}Observer`].clear()}triggerKeyDown(e){this.onKeyDownObservable.notifyObservers(e)}triggerKeyUp(e){this.onKeyUpObservable.notifyObservers(e)}triggerPointerUp(e){var t,s;return!((t=this.onPointerUpObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===fe.SCENE_VIEWER?((s=this._parent)==null||s.triggerPointerUp(e),!1):!0}triggerMouseWheel(e){var t,s;return!((t=this.onMouseWheelObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===fe.SCENE_VIEWER?((s=this._parent)==null||s.triggerMouseWheel(e),!1):!0}triggerPointerMove(e){var t,s;return!((t=this.onPointerMoveObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===fe.SCENE_VIEWER?((s=this._parent)==null||s.triggerPointerMove(e),!1):!0}triggerDblclick(e){var t,s;return!((t=this.onDblclickObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===fe.SCENE_VIEWER?((s=this._parent)==null||s.triggerDblclick(e),!1):!0}triggerPointerDown(e){var t,s;return!((t=this.onPointerDownObserver.notifyObservers(e))!=null&&t.stopPropagation)&&this._parent.classType===fe.SCENE_VIEWER?((s=this._parent)==null||s.triggerPointerDown(e),!1):!0}triggerPointerOut(e){var t;return this._parent.classType===fe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOut(e),!1):!0}triggerPointerLeave(e){var t;return this._parent.classType===fe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerLeave(e),!1):!0}triggerPointerOver(e){var t;return this._parent.classType===fe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerOver(e),!1):!0}triggerPointerEnter(e){var t;return this._parent.classType===fe.SCENE_VIEWER?((t=this._parent)==null||t.triggerPointerEnter(e),!1):!0}}class fd extends Kn{constructor(e,t){super(e),this._initialProps(t)}get scene(){return this._childrenScene}get classType(){return fe.SCENE_VIEWER}render(e,t){var r;if(!this.visible)return this.makeDirty(!1),this;if(t){const{minX:o,maxX:i,minY:a,maxY:c}=gr(this,t);if(this.width+this.strokeWidth<o||i<0||this.height+this.strokeWidth<a||c<0)return this}const s=this.transform.getMatrix();return e.save(),e.transform(s[0],s[1],s[2],s[3],s[4],s[5]),(r=this._childrenScene)==null||r.makeDirtyNoParent(!0).render(e),e.restore(),this.makeDirty(!1),this}addObject(e){this._childrenScene=e}pick(e){if(this._childrenScene===void 0)return;const s=this.transform.clone().invert().applyPoint(e);return this._childrenScene.pick(s)}_initialProps(e){if(!e)return;const t=Object.keys(e);if(t.length===0)return;const s={};let r=!1;t.forEach(o=>{if(e[o]===void 0)return!0;s[o]=e[o],r=!0}),r&&this.transformByState(s),this.makeDirty(!0)}dispose(){super.dispose(),this._childrenScene.dispose()}}class Li{constructor(e,t,s){var r;this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this.scrollX=0,this.scrollY=0,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this.onMouseWheelObserver=new me,this.onScrollAfterObserver=new me,this.onScrollBeforeObserver=new me,this.onScrollStopObserver=new me,this._viewPortKey=e,this._scene=t,this.top=(s==null?void 0:s.top)||0,this.left=(s==null?void 0:s.left)||0,this.bottom=(s==null?void 0:s.bottom)||0,this.right=(s==null?void 0:s.right)||0,s!=null&&s.width&&(this.width=s==null?void 0:s.width,this._widthOrigin=this.width),s!=null&&s.height&&(this.height=s==null?void 0:s.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new ys),this._isWheelPreventDefaultX=(s==null?void 0:s.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(s==null?void 0:s.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),(r=this._scene)==null||r.getParent().onTransformChangeObservable.add(()=>{this._resizeCacheCanvasAndScrollBar()})}get scene(){return this._scene}get width(){return this._width}set width(e){this._width=e}get height(){return this._height}set height(e){this._height=e}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}set top(e){var t,s;this._topOrigin=e,this._top=sn(e,(s=(t=this._scene)==null?void 0:t.getParent())==null?void 0:s.height)}get left(){return this._left}set left(e){var t;this._leftOrigin=e,this._left=sn(e,(t=this.scene.getParent())==null?void 0:t.width)}get bottom(){return this._bottom}set bottom(e){var t;this._bottomOrigin=e,this._bottom=sn(e,(t=this.scene.getParent())==null?void 0:t.height)}get right(){return this._right}set right(e){var t;this._rightOrigin=e,this._right=sn(e,(t=this.scene.getParent())==null?void 0:t.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(e){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=e,this._resizeCacheCanvasAndScrollBar()}resize(e){const t=Object.keys(e);t.length!==0&&(this._width=void 0,this._height=void 0,t.forEach(s=>{e[s]!==void 0&&(this[s]=e[s])}),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}_resizeCacheCanvasAndScrollBar(e=!1){var i;const{width:t,height:s}=this._getViewPortSize(e);this.width=t,this.height=s;const r=this._scene.width*this._scene.scaleX,o=this._scene.height*this._scene.scaleY;(i=this._scrollBar)==null||i.resize(t,s,r,o),this.makeDirty(!0)}_getViewPortSize(e=!1){var o;const t=(o=this._scene)==null?void 0:o.getParent();let s,r;if(!e&&this._widthOrigin!==void 0)s=this._widthOrigin;else{const i=t.width;s=(t.classType===fe.SCENE_VIEWER?i*t.scaleX:i)-(this._left+this._right)}if(!e&&this._heightOrigin!==void 0)r=this._heightOrigin;else{const i=t.height;r=(t.classType===fe.SCENE_VIEWER?i*t.scaleY:i)-(this._top+this._bottom)}return{width:s,height:r}}makeDirty(e=!0){this._dirty=e}isDirty(){return this._dirty}scrollTo(e){return this._scroll(0,e)}scrollBy(e){return this._scroll(1,e)}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var o,i;if(!this._scrollBar)return;const e=((o=this._scrollBar)==null?void 0:o.limitX)||1/0,t=((i=this._scrollBar)==null?void 0:i.limitY)||1/0;let s=!0,r=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>e?this.scrollX=e:s=!1,this.scrollY<0?this.scrollY=0:this.scrollY>t?this.scrollY=t:r=!1,{isLimitedX:s,isLimitedY:r}}_triggerScrollStop(e,t,s){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout(()=>{var r,o;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:t,y:s,actualScrollX:e.x,actualScrollY:e.y,limitX:(r=this._scrollBar)==null?void 0:r.limitX,limitY:(o=this._scrollBar)==null?void 0:o.limitY})},0)}_scroll(e,t){var a,c,l,u;const{x:s,y:r}=t;s!==void 0&&(e===1?this.scrollX+=s:this.scrollX=s),r!==void 0&&(e===1?this.scrollY+=r:this.scrollY=r);const o=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:s,y:r,limitX:(a=this._scrollBar)==null?void 0:a.limitX,limitY:(c=this._scrollBar)==null?void 0:c.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const i=this.transformScroll();return this.actualScrollX=i.x,this.actualScrollY=i.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:s,y:r,actualScrollX:i.x,actualScrollY:i.y,limitX:(l=this._scrollBar)==null?void 0:l.limitX,limitY:(u=this._scrollBar)==null?void 0:u.limitY}),this._triggerScrollStop(i,s,r),o}getBarScroll(e,t){let s=e,r=t;if(this._scrollBar){s*=this._scrollBar.ratioScrollX,r*=this._scrollBar.ratioScrollY;const{scaleX:o,scaleY:i}=this.scene;s=Math.round(s)*o,r=Math.round(r)*i}else this.scrollX!==void 0&&(s=this.scrollX),this.scrollY!==void 0&&(r=this.scrollY);return{x:s,y:r}}getActualScroll(e,t){let s=e,r=t;if(this._scrollBar){s/=this._scrollBar.ratioScrollX,r/=this._scrollBar.ratioScrollY;const{scaleX:o,scaleY:i}=this.scene;s=Math.round(s)/o,r=Math.round(r)/i}else this.actualScrollX!==void 0&&(s=this.actualScrollX),this.actualScrollY!==void 0&&(r=this.actualScrollY);return{x:s,y:r}}transformScroll(){let e=this.scrollX,t=this.scrollY;return this.getActualScroll(e,t)}getScrollBar(){return this._scrollBar}updateScroll(e){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:t,scrollY:s,actualScrollX:r,actualScrollY:o}=e;return t!==void 0&&(this.scrollX=t),s!==void 0&&(this.scrollY=s),r!==void 0&&(this.actualScrollX=r),o!==void 0&&(this.actualScrollY=o),this}getScrollBarTransForm(e=!1){const t=$e.create();return(e||!this._allowCache)&&t.multiply($e.create([1,0,0,1,this._left,this._top])),t}render(e){var c;const t=e||((c=this._scene.getEngine())==null?void 0:c.getCanvas().getContext());if(!this.isDirty()&&this._allowCache){this._applyCache(t);return}let s=this._scene.transform.clone();s.multiply($e.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let r=t;if(!r)return;const o=this._getApplyCanvasState();o&&(s.multiply($e.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),r=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const i=s.getMatrix(),a=this.getScrollBarTransForm().getMatrix();r.save(),!o&&this._renderClipState&&(r.beginPath(),r.rect(this.left,this.top,this.width||0,this.height||0),r.clip()),r.transform(i[0],i[1],i[2],i[3],i[4],i[5]),this._scene.renderObjects(r,this._calViewportRelativeBounding()),r.restore(),this._scrollBar&&(r.save(),r.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.drawScrollbar(r),r.restore()),o&&this._applyCache(t),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}_calViewportRelativeBounding(){var u,h,d,f;let e=(h=(u=this._scrollBar)==null?void 0:u.ratioScrollX)!=null?h:1,t=(f=(d=this._scrollBar)==null?void 0:d.ratioScrollY)!=null?f:1,s=this.left,r=(this.width||0)+this.left,o=this.top,i=(this.height||0)+this.top,a=0,c=0;this._preScrollX!=null&&(a=(this._preScrollX-this.scrollX)/e),this._preScrollY!=null&&(c=(this._preScrollY-this.scrollY)/t);const l={tl:Q.FromArray([s,o]),tr:Q.FromArray([r,o]),bl:Q.FromArray([s,i]),br:Q.FromArray([r,i]),dx:a,dy:c};return l.tl=this.getRelativeVector(l.tl),l.tr=this.getRelativeVector(l.tr),l.bl=this.getRelativeVector(l.bl),l.br=this.getRelativeVector(l.br),l}getRelativeVector(e){const t=this.scene.transform.clone().invert(),s=this.transformScroll();return t.applyPoint(e).add(Q.FromArray([s.x,s.y]))}getAbsoluteVector(e){const t=this.scene.transform.clone(),s=this.transformScroll();return t.applyPoint(e).subtract(Q.FromArray([s.x,s.y]))}drawScrollbar(e){if(!this._scrollBar)return;const t=this._scene.getParent();t.classType===fe.SCENE_VIEWER?this._scrollBar.render(e):t.classType===fe.ENGINE&&this._scrollBar.render(e)}_applyCache(e){if(!e)return;const t=this._cacheCanvas.getPixelRatio(),s=this._cacheCanvas.getWidth()*t,r=this._cacheCanvas.getHeight()*t;e.drawImage(this._cacheCanvas.getCanvasEle(),0,0,s,r,this.left,this.top,this.width||0,this.height||0)}onMouseWheel(e,t){if(!this._scrollBar)return;let s;if(e.inputIndex===se.MouseWheelX){const r=Math.abs(e.deltaX),o=this._scene.width;let a=(this.width||1)/o*r;e.deltaX>0?s=this.scrollBy({x:a}):s=this.scrollBy({x:-a}),this._scene.getParent().classType===fe.SCENE_VIEWER?s!=null&&s.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():s!=null&&s.isLimitedX||e.preventDefault()}if(e.inputIndex===se.MouseWheelY){const r=Math.abs(e.deltaY),o=this._scene.height;let a=(this.height||1)/o*r;e.shiftKey?(e.deltaY>0?s=this.scrollBy({x:a}):s=this.scrollBy({x:-a}),this._scene.getParent().classType===fe.SCENE_VIEWER?s!=null&&s.isLimitedX||t.stopPropagation():this._isWheelPreventDefaultX?e.preventDefault():s!=null&&s.isLimitedX||e.preventDefault()):(e.deltaY>0?s=this.scrollBy({y:a}):s=this.scrollBy({y:-a}),this._scene.getParent().classType===fe.SCENE_VIEWER?s!=null&&s.isLimitedY||t.stopPropagation():this._isWheelPreventDefaultY?e.preventDefault():s!=null&&s.isLimitedY||e.preventDefault())}e.inputIndex,se.MouseWheelZ}isHit(e){const{width:t,height:s}=this._getViewPortSize();return e.x>=this.left&&e.x<=this.left+t&&e.y>=this.top&&e.y<=this.top+s}pickScrollBar(e){if(!this._scrollBar)return;const s=this.getScrollBarTransForm(!0).invert().applyPoint(e);return this._scrollBar.pick(s)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var e;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),(e=this._scrollBar)==null||e.dispose()}}class Ao extends fr{constructor(){super(dt.BASE_RENDER),this._engine=new Rl}static create(){return new Ao}installTo(e){e.installPlugin(this)}getEngine(){return this._engine}}class gd{constructor(){this._clipboardExtensionFactoryList=[]}get clipboardExtensionFactoryList(){return this._clipboardExtensionFactoryList}add(...e){this._clipboardExtensionFactoryList.push(...e),this._clipboardExtensionFactoryList.sort(rt)}delete(e){const t=this._clipboardExtensionFactoryList.indexOf(e);this._clipboardExtensionFactoryList.splice(t,1)}}const Ct=class{static async writeText(n,e){var t;if(Ct.clipboard)return Ct.clipboard.writeText(n).then(()=>!0,s=>console.dir(s));(t=e==null?void 0:e.clipboardData)==null||t.setData("text/html",n)}static async write(n,e){var t,s,r;if(Ct.clipboard){const o=new Blob([n.data],{type:(t=n.type)!=null?t:"text/html"}),i=[new ClipboardItem({"text/html":o})];return Ct.clipboard.write(i).then(()=>!0,()=>!1)}(r=e==null?void 0:e.clipboardData)==null||r.setData((s=n.type)!=null?s:"text/html",n.data)}static async readText(){return Ct.clipboard?Ct.clipboard.readText().then(n=>n,()=>null):Ct.textArea?new Promise((n,e)=>{n(Ct.textArea.value)}).then(n=>n).then(()=>null):null}static async read(n){if(Ct.clipboard){const r=await Ct.clipboard.read(),o=[];for(const i of r)for(const a of i.types){const c=await i.getType(a),l=new FileReader;a==="image/png"?l.readAsDataURL(c):l.readAsText(c);const u=new Promise((h,d)=>{l.onload=f=>{const g={type:a,result:l.result};h(g)}}).then(h=>h,()=>null);o.push(u)}return Promise.all(o)}const e=[],t=n==null?void 0:n.clipboardData,s=t==null?void 0:t.types;if(!s)return null;for(let r=0;r<s.length;r++)e.push({type:s[r],result:t.getData(s[r])});return e}};let Fl=Ct;Fl.clipboard=window.navigator.clipboard;class md{getRegister(){return this._register}constructor(){this._register=new gd}handle(e){var r;const t=(r=this._register)==null?void 0:r.clipboardExtensionFactoryList;if(!t)return;this._clipboardExtensionFactoryList=t;const s=this._checkExtension(e);s&&s.execute()}_checkExtension(e){if(!this._clipboardExtensionFactoryList)return!1;let t=!1;for(let s=0;s<this._clipboardExtensionFactoryList.length&&(t=this._clipboardExtensionFactoryList[s].check(e),t===!1);s++);return t}pasteResolver(e){return new Promise((t,s)=>{Fl.read(e).then(r=>{var c,l;if(!r)return[];const o=r.findIndex((u,h)=>u&&u.type==="text/html"),i=r.findIndex((u,h)=>u&&u.type==="text/plain"),a={};if(o>-1){const u=(c=r[o])==null?void 0:c.result;a.html=u}if(i>-1){const u=(l=r[i])==null?void 0:l.result;a.plain=u}t(a)})})}}class _d{constructor(){this._DragAndDropExtensionFactoryList=[]}get DragAndDropExtensionFactoryList(){return this._DragAndDropExtensionFactoryList}add(...e){this._DragAndDropExtensionFactoryList.push(...e),this._DragAndDropExtensionFactoryList.sort(rt)}delete(e){const t=this._DragAndDropExtensionFactoryList.indexOf(e);this._DragAndDropExtensionFactoryList.splice(t,1)}}class bd{getRegister(){return this._register}constructor(){this._register=new _d}handle(e){var s;const t=(s=this._register)==null?void 0:s.DragAndDropExtensionFactoryList;!t||(this._DragAndDropExtensionFactoryList=t,this._checkExtension(e))}_checkExtension(e){if(!this._DragAndDropExtensionFactoryList)return!1;this._DragAndDropExtensionFactoryList.forEach(t=>{const s=t.check(e);s!==!1&&s.execute()})}dragResolver(e){return new Promise((t,s)=>{if(!e.dataTransfer)return;const r=[];e.dataTransfer.items?[...e.dataTransfer.items].forEach((o,i)=>{if(o.kind==="file"){const a=o.getAsFile();a&&r.push({kind:o.kind,type:o.type,file:a})}}):[...e.dataTransfer.files].forEach((o,i)=>{o&&r.push({kind:"file",type:o.type,file:o})}),t(r)})}}const So=wa({});var wt=(n=>(n.INPUT="input",n.COLOR="color",n.DOUBLE="double",n.JSX="jsx",n.INPUT_NUMBER="inputNumber",n))(wt||{}),Vs=(n=>(n.JSX="jsx",n.JSX_STRING="jsx_string",n.HTML="html",n.HTML_STRING="html_string",n.STRING="string",n.SINGLE="single",n.SELECT="select",n))(Vs||{}),Dn,Be,Mr,Fi,Vn=0,Hl=[],Gs=[],Hi=le.__b,Pi=le.__r,zi=le.diffed,Ui=le.__c,Wi=le.unmount;function Zn(n,e){le.__h&&le.__h(Be,n,Vn||e),Vn=0;var t=Be.__H||(Be.__H={__:[],__h:[]});return n>=t.__.length&&t.__.push({__V:Gs}),t.__[n]}function Os(n){return Vn=1,Pl(zl,n)}function Pl(n,e,t){var s=Zn(Dn++,2);if(s.t=n,!s.__c&&(s.__=[t?t(e):zl(void 0,e),function(o){var i=s.__N?s.__N[0]:s.__[0],a=s.t(i,o);i!==a&&(s.__N=[a,s.__[1]],s.__c.setState({}))}],s.__c=Be,!Be.u)){Be.u=!0;var r=Be.shouldComponentUpdate;Be.shouldComponentUpdate=function(o,i,a){if(!s.__c.__H)return!0;var c=s.__c.__H.__.filter(function(u){return u.__c});if(c.every(function(u){return!u.__N}))return!r||r.call(this,o,i,a);var l=!1;return c.forEach(function(u){if(u.__N){var h=u.__[0];u.__=u.__N,u.__N=void 0,h!==u.__[0]&&(l=!0)}}),!(!l&&s.__c.props===o)&&(!r||r.call(this,o,i,a))}}return s.__N||s.__}function Rn(n,e){var t=Zn(Dn++,3);!le.__s&&Oo(t.__H,e)&&(t.__=n,t.i=e,Be.__H.__h.push(t))}function xs(n,e){var t=Zn(Dn++,4);!le.__s&&Oo(t.__H,e)&&(t.__=n,t.i=e,Be.__h.push(t))}function Lt(n){return Vn=5,Cr(function(){return{current:n}},[])}function pd(n,e,t){Vn=6,xs(function(){return typeof n=="function"?(n(e()),function(){return n(null)}):n?(n.current=e(),function(){return n.current=null}):void 0},t==null?t:t.concat(n))}function Cr(n,e){var t=Zn(Dn++,7);return Oo(t.__H,e)?(t.__V=n(),t.i=e,t.__h=n,t.__V):t.__}function Gn(n,e){return Vn=8,Cr(function(){return n},e)}function vd(n){var e=Be.context[n.__c],t=Zn(Dn++,9);return t.c=n,e?(t.__==null&&(t.__=!0,e.sub(Be)),e.props.value):n.__}function Cd(n,e){le.useDebugValue&&le.useDebugValue(e?e(n):n)}function wd(){var n=Zn(Dn++,11);if(!n.__){for(var e=Be.__v;e!==null&&!e.__m&&e.__!==null;)e=e.__;var t=e.__m||(e.__m=[0,0]);n.__="P"+t[0]+"-"+t[1]++}return n.__}function Ed(){for(var n;n=Hl.shift();)if(n.__P&&n.__H)try{n.__H.__h.forEach($s),n.__H.__h.forEach(Zr),n.__H.__h=[]}catch(e){n.__H.__h=[],le.__e(e,n.__v)}}le.__b=function(n){Be=null,Hi&&Hi(n)},le.__r=function(n){Pi&&Pi(n),Dn=0;var e=(Be=n.__c).__H;e&&(Mr===Be?(e.__h=[],Be.__h=[],e.__.forEach(function(t){t.__N&&(t.__=t.__N),t.__V=Gs,t.__N=t.i=void 0})):(e.__h.forEach($s),e.__h.forEach(Zr),e.__h=[])),Mr=Be},le.diffed=function(n){zi&&zi(n);var e=n.__c;e&&e.__H&&(e.__H.__h.length&&(Hl.push(e)!==1&&Fi===le.requestAnimationFrame||((Fi=le.requestAnimationFrame)||Td)(Ed)),e.__H.__.forEach(function(t){t.i&&(t.__H=t.i),t.__V!==Gs&&(t.__=t.__V),t.i=void 0,t.__V=Gs})),Mr=Be=null},le.__c=function(n,e){e.some(function(t){try{t.__h.forEach($s),t.__h=t.__h.filter(function(s){return!s.__||Zr(s)})}catch(s){e.some(function(r){r.__h&&(r.__h=[])}),e=[],le.__e(s,t.__v)}}),Ui&&Ui(n,e)},le.unmount=function(n){Wi&&Wi(n);var e,t=n.__c;t&&t.__H&&(t.__H.__.forEach(function(s){try{$s(s)}catch(r){e=r}}),t.__H=void 0,e&&le.__e(e,t.__v))};var Vi=typeof requestAnimationFrame=="function";function Td(n){var e,t=function(){clearTimeout(s),Vi&&cancelAnimationFrame(e),setTimeout(n)},s=setTimeout(t,100);Vi&&(e=requestAnimationFrame(t))}function $s(n){var e=Be,t=n.__c;typeof t=="function"&&(n.__c=void 0,t()),Be=e}function Zr(n){var e=Be;n.__c=n.__(),Be=e}function Oo(n,e){return!n||n.length!==e.length||e.some(function(t,s){return t!==n[s]})}function zl(n,e){return typeof e=="function"?e(n):e}function Ul(n,e){for(var t in e)n[t]=e[t];return n}function Jr(n,e){for(var t in n)if(t!=="__source"&&!(t in e))return!0;for(var s in e)if(s!=="__source"&&n[s]!==e[s])return!0;return!1}function kr(n,e){return n===e&&(n!==0||1/n==1/e)||n!=n&&e!=e}function $n(n){this.props=n}function Rd(n,e){function t(r){var o=this.props.ref,i=o==r.ref;return!i&&o&&(o.call?o(null):o.current=null),e?!e(this.props,r)||!i:Jr(this.props,r)}function s(r){return this.shouldComponentUpdate=t,m(n,r)}return s.displayName="Memo("+(n.displayName||n.name)+")",s.prototype.isReactComponent=!0,s.__f=!0,s}($n.prototype=new Ue).isPureReactComponent=!0,$n.prototype.shouldComponentUpdate=function(n,e){return Jr(this.props,n)||Jr(this.state,e)};var Gi=le.__b;le.__b=function(n){n.type&&n.type.__f&&n.ref&&(n.props.ref=n.ref,n.ref=null),Gi&&Gi(n)};var Dd=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.forward_ref")||3911;function xo(n){function e(t){var s=Ul({},t);return delete s.ref,n(s,t.ref||null)}return e.$$typeof=Dd,e.render=e,e.prototype.isReactComponent=e.__f=!0,e.displayName="ForwardRef("+(n.displayName||n.name)+")",e}var $i=function(n,e){return n==null?null:kt(kt(n).map(e))},Id={map:$i,forEach:$i,count:function(n){return n?kt(n).length:0},only:function(n){var e=kt(n);if(e.length!==1)throw"Children.only";return e[0]},toArray:kt},yd=le.__e;le.__e=function(n,e,t,s){if(n.then){for(var r,o=e;o=o.__;)if((r=o.__c)&&r.__c)return e.__e==null&&(e.__e=t.__e,e.__k=t.__k),r.__c(n,e)}yd(n,e,t,s)};var Yi=le.unmount;function Wl(n,e,t){return n&&(n.__c&&n.__c.__H&&(n.__c.__H.__.forEach(function(s){typeof s.__c=="function"&&s.__c()}),n.__c.__H=null),(n=Ul({},n)).__c!=null&&(n.__c.__P===t&&(n.__c.__P=e),n.__c=null),n.__k=n.__k&&n.__k.map(function(s){return Wl(s,e,t)})),n}function Vl(n,e,t){return n&&(n.__v=null,n.__k=n.__k&&n.__k.map(function(s){return Vl(s,e,t)}),n.__c&&n.__c.__P===e&&(n.__e&&t.insertBefore(n.__e,n.__d),n.__c.__e=!0,n.__c.__P=t)),n}function Ys(){this.__u=0,this.t=null,this.__b=null}function Gl(n){var e=n.__.__c;return e&&e.__a&&e.__a(n)}function Ad(n){var e,t,s;function r(o){if(e||(e=n()).then(function(i){t=i.default||i},function(i){s=i}),s)throw s;if(!t)throw e;return m(t,o)}return r.displayName="Lazy",r.__f=!0,r}function ss(){this.u=null,this.o=null}le.unmount=function(n){var e=n.__c;e&&e.__R&&e.__R(),e&&n.__h===!0&&(n.type=null),Yi&&Yi(n)},(Ys.prototype=new Ue).__c=function(n,e){var t=e.__c,s=this;s.t==null&&(s.t=[]),s.t.push(t);var r=Gl(s.__v),o=!1,i=function(){o||(o=!0,t.__R=null,r?r(a):a())};t.__R=i;var a=function(){if(!--s.__u){if(s.state.__a){var l=s.state.__a;s.__v.__k[0]=Vl(l,l.__c.__P,l.__c.__O)}var u;for(s.setState({__a:s.__b=null});u=s.t.pop();)u.forceUpdate()}},c=e.__h===!0;s.__u++||c||s.setState({__a:s.__b=s.__v.__k[0]}),n.then(i,i)},Ys.prototype.componentWillUnmount=function(){this.t=[]},Ys.prototype.render=function(n,e){if(this.__b){if(this.__v.__k){var t=document.createElement("div"),s=this.__v.__k[0].__c;this.__v.__k[0]=Wl(this.__b,t,s.__O=s.__P)}this.__b=null}var r=e.__a&&m(Je,null,n.fallback);return r&&(r.__h=null),[m(Je,null,e.__a?null:n.children),r]};var Xi=function(n,e,t){if(++t[1]===t[0]&&n.o.delete(e),n.props.revealOrder&&(n.props.revealOrder[0]!=="t"||!n.o.size))for(t=n.u;t;){for(;t.length>3;)t.pop()();if(t[1]<t[0])break;n.u=t=t[2]}};function Sd(n){return this.getChildContext=function(){return n.context},n.children}function Od(n){var e=this,t=n.i;e.componentWillUnmount=function(){zn(null,e.l),e.l=null,e.i=null},e.i&&e.i!==t&&e.componentWillUnmount(),n.__v?(e.l||(e.i=t,e.l={nodeType:1,parentNode:t,childNodes:[],appendChild:function(s){this.childNodes.push(s),e.i.appendChild(s)},insertBefore:function(s,r){this.childNodes.push(s),e.i.appendChild(s)},removeChild:function(s){this.childNodes.splice(this.childNodes.indexOf(s)>>>1,1),e.i.removeChild(s)}}),zn(m(Sd,{context:e.context},n.__v),e.l)):e.l&&e.componentWillUnmount()}function xd(n,e){var t=m(Od,{__v:n,i:e});return t.containerInfo=e,t}(ss.prototype=new Ue).__a=function(n){var e=this,t=Gl(e.__v),s=e.o.get(n);return s[0]++,function(r){var o=function(){e.props.revealOrder?(s.push(r),Xi(e,n,s)):r()};t?t(o):o()}},ss.prototype.render=function(n){this.u=null,this.o=new Map;var e=kt(n.children);n.revealOrder&&n.revealOrder[0]==="b"&&e.reverse();for(var t=e.length;t--;)this.o.set(e[t],this.u=[1,0,this.u]);return n.children},ss.prototype.componentDidUpdate=ss.prototype.componentDidMount=function(){var n=this;this.o.forEach(function(e,t){Xi(n,t,e)})};var $l=typeof Symbol!="undefined"&&Symbol.for&&Symbol.for("react.element")||60103,Nd=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Md=typeof document!="undefined",kd=function(n){return(typeof Symbol!="undefined"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(n)};function Bd(n,e,t){return e.__k==null&&(e.textContent=""),zn(n,e),typeof t=="function"&&t(),n?n.__c:null}function Ld(n,e,t){return Ca(n,e),typeof t=="function"&&t(),n?n.__c:null}Ue.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(n){Object.defineProperty(Ue.prototype,n,{configurable:!0,get:function(){return this["UNSAFE_"+n]},set:function(e){Object.defineProperty(this,n,{configurable:!0,writable:!0,value:e})}})});var ji=le.event;function Fd(){}function Hd(){return this.cancelBubble}function Pd(){return this.defaultPrevented}le.event=function(n){return ji&&(n=ji(n)),n.persist=Fd,n.isPropagationStopped=Hd,n.isDefaultPrevented=Pd,n.nativeEvent=n};var Yl,Ki={configurable:!0,get:function(){return this.class}},qi=le.vnode;le.vnode=function(n){var e=n.type,t=n.props,s=t;if(typeof e=="string"){var r=e.indexOf("-")===-1;for(var o in s={},t){var i=t[o];Md&&o==="children"&&e==="noscript"||o==="value"&&"defaultValue"in t&&i==null||(o==="defaultValue"&&"value"in t&&t.value==null?o="value":o==="download"&&i===!0?i="":/ondoubleclick/i.test(o)?o="ondblclick":/^onchange(textarea|input)/i.test(o+e)&&!kd(t.type)?o="oninput":/^onfocus$/i.test(o)?o="onfocusin":/^onblur$/i.test(o)?o="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(o)?o=o.toLowerCase():r&&Nd.test(o)?o=o.replace(/[A-Z0-9]/g,"-$&").toLowerCase():i===null&&(i=void 0),/^oninput$/i.test(o)&&(o=o.toLowerCase(),s[o]&&(o="oninputCapture")),s[o]=i)}e=="select"&&s.multiple&&Array.isArray(s.value)&&(s.value=kt(t.children).forEach(function(a){a.props.selected=s.value.indexOf(a.props.value)!=-1})),e=="select"&&s.defaultValue!=null&&(s.value=kt(t.children).forEach(function(a){a.props.selected=s.multiple?s.defaultValue.indexOf(a.props.value)!=-1:s.defaultValue==a.props.value})),n.props=s,t.class!=t.className&&(Ki.enumerable="className"in t,t.className!=null&&(s.class=t.className),Object.defineProperty(s,"className",Ki))}n.$$typeof=$l,qi&&qi(n)};var Zi=le.__r;le.__r=function(n){Zi&&Zi(n),Yl=n.__c};var zd={ReactCurrentDispatcher:{current:{readContext:function(n){return Yl.__n[n.__c].props.value}}}};function Ud(n){return m.bind(null,n)}function Xl(n){return!!n&&n.$$typeof===$l}function Wd(n){return Xl(n)?er.apply(null,arguments):n}function Vd(n){return!!n.__k&&(zn(null,n),!0)}function Gd(n){return n&&(n.base||n.nodeType===1&&n)||null}var $d=function(n,e){return n(e)},Yd=function(n,e){return n(e)},Xd=Je;function jl(n){n()}function jd(n){return n}function Kd(){return[!1,jl]}var qd=xs;function Zd(n,e){var t=e(),s=Os({h:{__:t,v:e}}),r=s[0].h,o=s[1];return xs(function(){r.__=t,r.v=e,kr(r.__,e())||o({h:r})},[n,t,e]),Rn(function(){return kr(r.__,r.v())||o({h:r}),n(function(){kr(r.__,r.v())||o({h:r})})},[n]),t}var Le={useState:Os,useId:wd,useReducer:Pl,useEffect:Rn,useLayoutEffect:xs,useInsertionEffect:qd,useTransition:Kd,useDeferredValue:jd,useSyncExternalStore:Zd,startTransition:jl,useRef:Lt,useImperativeHandle:pd,useMemo:Cr,useCallback:Gn,useContext:vd,useDebugValue:Cd,version:"17.0.2",Children:Id,render:Bd,hydrate:Ld,unmountComponentAtNode:Vd,createPortal:xd,createElement:m,createContext:wa,createFactory:Ud,cloneElement:Wd,createRef:ge,Fragment:Je,isValidElement:Xl,findDOMNode:Gd,Component:Ue,PureComponent:$n,memo:Rd,forwardRef:xo,flushSync:Yd,unstable_batchedUpdates:$d,StrictMode:Xd,Suspense:Ys,SuspenseList:ss,lazy:Ad,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:zd};class ye extends Ue{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getPluginByName(e){return this._context.getPluginManager().getPluginByName(e)}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}ye.contextType=So;class Jd extends $n{constructor(e,t){super(e,t),this._context=t.coreContext,this.initialize(e)}initialize(e){}getContext(){return this._context}getComponentRender(){return this._context.getPluginManager().getPluginByName("ComponentSheet").getComponentRender()}}Jd.contextType=So;function Qd(n){return n instanceof Element||n instanceof HTMLDocument}const ef=typeof HTMLElement=="object"?function(n){return n instanceof HTMLElement}:function(n){return n&&typeof n=="object"&&n.nodeType===1&&typeof n.nodeName=="string"};function Qr(n){return n=n?`${n}-`:"",n+Math.random().toString(36).replace(/[^a-z]+/g,"").substr(2,10)}function tf(n){let e=[],t=n.getElementsByTagName("*");for(let s=0,r=t.length;s<r;++s){if(t[s].nodeType!==1)continue;let o=t[s].parentNode;o&&o.nodeType===1?o===n&&(e[e.length]=t[s]):o&&o.parentNode===n&&(e[e.length]=t[s])}return e}function ot(...n){if(!n.length)return;let e="";return n.forEach(t=>{if(t instanceof Object)for(let s in t)t[s]&&(e+=` ${s}`);else e+=` ${t}`}),e}function Xs(n,e){let t=null;return function(...s){clearTimeout(t),t=setTimeout(()=>{n(...s)},e)}}function nf(n){if(ef(n.current))return n.current;let e=n.current;return e?e==null?void 0:e.base:n.base}class sf{constructor(e){this._plugin=e,this.initialize()}initialize(){this.setClipboardExtensionManager(),this.setDragAndDropExtensionManager()}setClipboardExtensionManager(){this._clipboardExtensionManager=new md;const e=this._plugin.getContext().getObserverManager().getObserver("onKeyPasteObservable","core");e&&!e.hasObservers()&&e.add(t=>{this._clipboardExtensionManager.pasteResolver(t).then(s=>{this._clipboardExtensionManager.handle(s)})})}setDragAndDropExtensionManager(){this._dragAndDropExtensionManager=new bd;const e=this._plugin.getContext().getObserverManager().getObserver("onDropObservable","core");e&&!e.hasObservers()&&e.add(t=>{this._dragAndDropExtensionManager.dragResolver(t).then(s=>{s.length!==0&&this._dragAndDropExtensionManager.handle(s)})})}getClipboardExtensionManager(){return this._clipboardExtensionManager}getDragAndDropExtensionManager(){return this._dragAndDropExtensionManager}onMounted(){this.initialize()}onDestroy(){}}class No extends fr{constructor(){super(dt.BASE_COMPONENT)}static create(){return new No}installTo(e){e.installPlugin(this)}initialize(){this.getContext(),this.setRegisterManager()}setRegisterManager(){this._registerManager=new sf(this)}getRegisterManager(){return this._registerManager}onMounted(){this.initialize()}onDestroy(){}}const rf="univer-icon",of="univer-icon-icon",af="univer-icon-spin",lf="univer-loadingCircle";var Br={icon:rf,iconIcon:of,iconSpin:af,loadingCircle:lf};const q=n=>{const{spin:e,rotate:t,children:s,name:r,style:o,className:i}=n;let a;o?(a=o,a.transform=t?`rotate(${t}deg)`:""):a=t?{transform:`rotate(${t}deg)`}:{};const c=ot(Br.icon,{[`${Br.icon}-${r}`]:r,[`${Br.icon}-spin`]:e||r==="loading"},i);return m("span",{role:"img",className:c,style:{...a}},s)},Kl=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"loading",style:n.style},m("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"})));class cf{render(){return Kl}}const uf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"logo",style:n.style},m("svg",{class:"icon",viewBox:"0 0 4864 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8477",fill:"currentColor"},m("path",{d:"M1023.168 131.36c0 234.4-190.016 424.416-424.416 424.416 0-234.4 190.016-424.416 424.416-424.416zM131.36 1023.168c0-234.4 190.016-424.416 424.416-424.416 0 234.4-190.016 424.416-424.416 424.416zM929.696 929.696c-182.784 0-330.944-148.16-330.944-330.944 182.752 0 330.944 148.16 330.944 330.944z",fill:"#2D7FF9","p-id":"8478"}),m("path",{d:"M494.848 0H0v494.848h494.848z",fill:"#2D7FF9",opacity:".503","p-id":"8479"}),m("path",{d:"M558.016 81.376H81.376v476.64h476.64z",fill:"#2D7FF9",opacity:".551","p-id":"8480"}),m("path",{d:"M558.304 164.416H164.384v393.92h393.92z",fill:"#2D7FF9",opacity:".805","p-id":"8481"}),m("path",{d:"M1678.08 736v-64h-247.04V279.04H1356.8V736h321.28z m177.568 8.96c40.96 0 75.52-17.28 103.68-51.84V736h72.96V405.12h-72.96v202.24c-6.4 23.68-17.28 42.24-32 56.32-14.72 13.44-30.08 20.48-46.08 20.48-25.6 0-43.52-6.4-55.04-18.56-11.52-12.8-16.64-32-16.64-58.88v-201.6h-72.96v206.08c0 88.96 39.68 133.76 119.04 133.76z m407.936 0c42.88 0 77.44-10.88 103.04-32 26.24-21.76 43.52-55.04 51.2-99.84h-72.32c-5.76 48-32.64 72.32-81.28 72.32-28.16 0-49.28-10.24-63.36-30.08-15.36-20.48-22.4-49.28-22.4-85.76 0-35.84 7.68-64 23.04-83.84 15.36-20.48 36.48-30.08 63.36-30.08 21.76 0 39.68 5.12 53.12 15.36 12.8 10.24 21.76 25.6 26.24 46.72h72.32c-6.4-41.6-23.04-72.32-49.28-92.8-25.6-19.2-59.52-28.8-102.4-28.8-51.84 0-92.16 17.28-120.96 51.84-26.88 31.36-40.32 72.32-40.32 122.24 0 51.2 13.44 92.8 40.96 124.8 28.16 33.28 67.84 49.92 119.04 49.92z m292.128-8.96v-115.84l33.28-31.36 115.84 147.2h93.44l-159.36-193.92 146.56-136.96h-94.08l-135.68 131.2V270.08h-72.96V736h72.96z m404.096 126.72l179.2-457.6h-79.36l-83.84 235.52-87.68-235.52h-79.36l131.2 323.2-58.24 134.4h78.08z m357.408-117.76c99.2 0 149.12-35.2 149.12-105.6 0-29.44-13.44-53.12-39.68-69.76-17.92-12.16-46.08-22.4-83.2-31.36-33.28-8.32-55.04-14.72-65.92-19.2-17.92-7.68-26.24-17.28-26.24-27.52 0-12.8 5.12-21.76 16.64-27.52 9.6-5.76 24.32-8.32 43.52-8.32 22.4 0 39.04 3.2 49.92 10.24 10.24 6.4 17.92 18.56 23.04 35.2h71.04c-7.68-70.4-55.68-104.96-142.72-104.96-40.96 0-73.6 8.32-98.56 26.24-25.6 16.64-37.76 40.32-37.76 71.04 0 28.8 12.8 51.2 38.4 67.2 16 10.24 43.52 19.84 82.56 28.8 33.28 7.68 55.04 13.44 65.28 18.56 19.2 8.96 28.8 21.12 28.8 36.48 0 26.88-25.6 40.96-76.8 40.96-24.32 0-41.6-4.48-52.48-12.16-10.88-8.96-18.56-23.68-22.4-44.8h-71.04c7.04 77.44 56.32 116.48 148.48 116.48z m286.976-8.96v-184.96c0-28.16 6.4-50.56 19.84-68.48 12.8-17.92 30.72-26.88 53.76-26.88 24.96 0 43.52 7.68 56.32 23.68 10.88 14.72 16.64 36.48 16.64 64.64v192h72.96v-204.8c0-44.16-9.6-77.44-28.16-99.84-19.84-23.68-49.92-35.2-90.24-35.2-21.12 0-39.68 3.84-55.68 12.16-17.92 8.96-33.28 22.4-45.44 40.96v-179.2h-72.96V736h72.96z m447.648 8.96c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m285.088 209.28c44.16 0 80.64-12.8 110.08-37.76 23.04-20.48 38.4-46.72 46.08-77.44h-72.96c-8.96 18.56-18.56 32-29.44 40.32-14.08 10.24-32 15.36-54.4 15.36-26.24 0-46.72-8.32-60.8-24.32-14.08-16-22.4-39.68-24.96-70.4h247.68c0-59.52-13.44-106.24-39.68-139.52-28.8-37.12-70.4-55.04-124.8-55.04-49.28 0-88.32 16.64-116.48 50.56-29.44 33.28-43.52 74.24-43.52 123.52 0 55.04 15.36 97.92 46.08 129.28 28.8 30.08 67.84 45.44 117.12 45.44z m85.12-209.28h-170.24c4.48-26.24 13.44-46.08 26.88-59.52 14.08-14.08 32.64-20.48 56.96-20.48 51.2 0 80 26.24 86.4 80z m310.016 200.32v-60.16h-43.52c-7.68 0-12.8-1.92-16.64-5.76-3.84-4.48-5.12-10.24-5.12-17.92v-186.88h73.6v-60.16h-73.6V298.24l-72.96 30.08v76.8h-59.52v60.16h59.52v186.88c0 26.88 6.4 46.72 19.2 60.8 13.44 15.36 34.56 23.04 63.36 23.04h55.68z",fill:"#7C838C","p-id":"8482"})));class hf{render(){return uf}}const df=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6466",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M533.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6467"}),m("path",{d:"M682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0V640a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V640a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6468"}),m("path",{d:"M367.829333 799.701333l90.538667-90.538666L367.786667 618.666667l-30.165334 30.165333 37.76 37.802667H256v42.666666h121.898667l-40.234667 40.234667 30.165333 30.165333z","p-id":"6469"}),m("path",{d:"M490.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 1 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6470"}),m("path",{d:"M341.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6471"}))),ff=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6336",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M533.333333 448m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6337"}),m("path",{d:"M341.333333 789.333333m-42.666666 0a42.666667 42.666667 0 1 0 85.333333 0 42.666667 42.666667 0 1 0-85.333333 0Z","p-id":"6338"}),m("path",{d:"M346.496 394.368L256 303.786667 346.496 213.333333l30.165333 30.165334-37.717333 37.802666h119.424v42.666667H336.469333l40.192 40.234667-30.165333 30.165333z","p-id":"6339"}),m("path",{d:"M682.666667 213.333333a85.333333 85.333333 0 0 0-85.333334 85.333334v85.333333a85.333333 85.333333 0 1 0 170.666667 0V298.666667a85.333333 85.333333 0 0 0-85.333333-85.333334z m0 42.666667a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0V298.666667a42.666667 42.666667 0 0 1 42.666667-42.666667zM490.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667zM682.666667 554.666667a85.333333 85.333333 0 0 0-85.333334 85.333333v85.333333a85.333333 85.333333 0 1 0 170.666667 0v-85.333333a85.333333 85.333333 0 0 0-85.333333-85.333333z m0 42.666666a42.666667 42.666667 0 0 1 42.666666 42.666667v85.333333a42.666667 42.666667 0 0 1-85.333333 0v-85.333333a42.666667 42.666667 0 0 1 42.666667-42.666667z","p-id":"6340"}))),gf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6209",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M653.525333 213.333333l36.949334 21.333334-320 554.24-36.949334-21.333334L653.525333 213.333333zM682.666667 469.333333c71.68 0 128 67.626667 128 149.333334S754.346667 768 682.666667 768s-128-67.626667-128-149.333333 56.32-149.333333 128-149.333334z m0 42.666667c-46.165333 0-85.333333 46.976-85.333334 106.666667s39.168 106.666667 85.333334 106.666666c46.165333 0 85.333333-46.976 85.333333-106.666666s-39.168-106.666667-85.333333-106.666667zM341.333333 234.666667c71.68 0 128 67.626667 128 149.333333s-56.32 149.333333-128 149.333333S213.333333 465.706667 213.333333 384s56.32-149.333333 128-149.333333z m0 42.666666C295.168 277.333333 256 324.309333 256 384s39.168 106.666667 85.333333 106.666667c46.165333 0 85.333333-46.976 85.333334-106.666667s-39.168-106.666667-85.333334-106.666667z","p-id":"6210"}))),mf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6082",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M658.816 256l34.986667 24.490667-124.629334 177.92h119.04v42.666666h-149.333333v85.333334h149.333333v42.666666h-149.333333v128h-42.666667v-128h-149.333333v-42.666666h149.333333v-85.333334h-149.333333v-42.666666h119.04L341.333333 280.490667 376.32 256l141.226667 201.728L658.816 256z","p-id":"6083"}))),_f=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M771.072 391.253333a6.698667 6.698667 0 0 0-0.512-9.514666 6.997333 6.997333 0 0 0-4.48-1.749334h-61.354667c-1.962667 0-3.84 0.853333-5.12 2.346667l-103.893333 122.709333a6.698667 6.698667 0 0 1-11.392-1.621333l-53.674667-119.381333a6.656 6.656 0 0 0-6.144-4.010667H381.866667l0.853333-3.968 6.741333-35.712c8.874667-46.933333 32.085333-68.864 72.533334-68.864 15.658667 0 29.994667 1.450667 41.258666 4.010667l11.861334-56.490667a197.888 197.888 0 0 0-46.464-5.12c-87.296 0-132.224 37.418667-148.650667 124.458667l-7.978667 41.813333H229.632a6.698667 6.698667 0 0 0-6.613333 5.376l-9.130667 43.818667a6.826667 6.826667 0 0 0 6.570667 8.106666h79.786666l-75.264 363.52a6.826667 6.826667 0 0 0 6.570667 8.234667H287.573333c3.242667 0 5.973333-2.346667 6.570667-5.418667l75.861333-366.165333h114.773334l57.685333 117.546667a6.570667 6.570667 0 0 1-1.024 7.381333l-152.746667 171.690667a6.826667 6.826667 0 0 0 5.12 11.264h61.44c2.005333 0 3.882667-0.853333 5.162667-2.389334l104.576-123.989333a6.826667 6.826667 0 0 1 11.392 1.493333l55.594667 120.661334a6.741333 6.741333 0 0 0 6.186666 3.968h54.613334a6.784 6.784 0 0 0 6.101333-9.770667L618.325333 567.466667a6.698667 6.698667 0 0 1 1.066667-7.466667l151.722667-168.661333-0.042667-0.042667z","p-id":"5447"}))),bf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"}),m("path",{d:"M554.666667 213.333333v597.333334h-85.333334V213.333333z","p-id":"5320"}))),pf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333z","p-id":"5319"})));class vf{render(){return df}}class Cf{render(){return ff}}class wf{render(){return gf}}class Ef{render(){return mf}}class Tf{render(){return _f}}class Rf{render(){return bf}}class Df{render(){return pf}}const If=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),yf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),m("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),m("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),Af=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),m("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),m("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),Sf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),m("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),m("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),m("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),Of=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"})));class xf{render(){return If}}class Nf{render(){return yf}}class Mf{render(){return Af}}class kf{render(){return Sf}}class Bf{render(){return Of}}const Lf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),m("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),Ff=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),m("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),Hf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),m("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),m("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),Pf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),m("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),m("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),m("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),m("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),m("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),m("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),zf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),m("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),m("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),m("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),m("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),m("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),Uf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),m("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),m("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),m("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),m("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),m("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),m("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),Wf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),m("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),m("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),Vf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),m("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),m("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),m("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),Gf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),m("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),m("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),$f=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),m("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),Yf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),m("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),Xf=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),m("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"})));class jf{render(){return Lf}}class Kf{render(){return Ff}}class qf{render(){return Hf}}class Zf{render(){return Pf}}class Jf{render(){return zf}}class Qf{render(){return Uf}}class e1{render(){return Wf}}class t1{render(){return Vf}}class n1{render(){return Gf}}class s1{render(){return $f}}class r1{render(){return Yf}}class o1{render(){return Xf}}const i1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),a1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),l1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),c1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),u1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),h1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),d1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),f1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),g1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),m1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),_1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),b1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),p1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),m("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),m("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),v1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),m("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),C1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),m("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"})));class w1{render(){return i1}}class E1{render(){return a1}}class T1{render(){return l1}}class R1{render(){return c1}}class D1{render(){return u1}}class I1{render(){return h1}}class y1{render(){return d1}}class A1{render(){return f1}}class S1{render(){return g1}}class O1{render(){return m1}}class x1{render(){return _1}}class N1{render(){return b1}}class M1{render(){return p1}}class k1{render(){return v1}}class B1{render(){return C1}}const L1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8090",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z","p-id":"8091"}))),F1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7962",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M771.584 251.733333c-49.066667-51.2-132.266667-51.2-181.333333 0l-74.666667 76.8c-8.533333 8.533333-8.533333 23.466667 0 32 8.533333 8.533333 21.333333 8.533333 29.866667 0l74.666666-76.8c34.133333-34.133333 87.466667-34.133333 121.6 0 34.133333 34.133333 34.133333 89.6 0 123.733334l-121.6 123.733333c-34.133333 34.133333-87.466667 34.133333-121.6 0-8.533333-8.533333-21.333333-8.533333-29.866666 0-8.533333 8.533333-8.533333 23.466667 0 32 49.066667 51.2 132.266667 51.2 181.333333 0l121.6-123.733333c51.2-53.333333 51.2-136.533333 0-187.733334z","p-id":"7963"}),m("path",{d:"M477.184 663.466667l-74.666667 76.8c-34.133333 34.133333-87.466667 34.133333-121.6 0-34.133333-34.133333-34.133333-89.6 0-123.733334l121.6-123.733333c34.133333-34.133333 87.466667-34.133333 121.6 0 8.533333 8.533333 21.333333 8.533333 29.866667 0 8.533333-8.533333 8.533333-23.466667 0-32-49.066667-51.2-132.266667-51.2-181.333333 0l-121.6 123.733333c-51.2 51.2-49.066667 134.4 0 185.6 49.066667 51.2 132.266667 51.2 181.333333 0l74.666667-76.8c8.533333-8.533333 8.533333-23.466667 0-32-8.533333-6.4-21.333333-6.4-29.866667 2.133334z","p-id":"7964"}))),H1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7833",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M256 213.333333H213.333333v597.333334h597.333334v-42.666667H256z","p-id":"7834"}),m("path",{d:"M490.666667 343.466667V554.666667h185.6c-19.2 72.533333-85.333333 128-164.266667 128-93.866667 0-170.666667-76.8-170.666667-170.666667 0-87.466667 66.133333-157.866667 149.333334-168.533333M512 298.666667c-117.333333 0-213.333333 96-213.333333 213.333333s96 213.333333 213.333333 213.333333 213.333333-96 213.333333-213.333333h-192V298.666667H512z","p-id":"7835"}),m("path",{d:"M618.666667 260.266667c83.2 14.933333 134.4 74.666667 147.2 166.4H618.666667V260.266667m-42.666667-46.933334v256H810.666667c0-149.333333-85.333333-256-234.666667-256z","p-id":"7836"})));class P1{render(){return L1}}class z1{render(){return F1}}class U1{render(){return H1}}const ql=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),Zl=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),Jl=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5955",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M725.333333 213.333333v85.333334h85.333334v234.666666h-298.666667V597.333333h21.333333v213.333334h-85.333333v-213.333334h21.333333v-106.666666h298.666667V341.333333h-42.666667v85.333334H213.333333V213.333333h512z m-42.666666 42.666667H256v128h426.666667V256z","p-id":"5956"}))),Ql=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"nextIcon",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),ec=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"rightIcon",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),tc=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),m("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"}))),nc=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{width:"1em",height:"1em",fill:"currentColor",class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1732"},m("path",{d:"M224.45 538.68l575.11-346.21-0.05-68.75-575.03 345.61-0.03 69.35z","p-id":"1733"}),m("path",{d:"M224.45 538.68l575.08 356.96v-69.52L224.48 469.33l-0.03 69.35z","p-id":"1734"}))),Mo=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M330.965333 270.634667l422.4 422.4-60.330666 60.330666-422.4-422.4z","p-id":"5319"}),m("path",{d:"M753.365333 330.965333l-422.4 422.4-60.330666-60.330666 422.4-422.4z","p-id":"5320"}))),sc=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5446",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M213.333333 469.333333h597.333334v85.333334H213.333333zM213.333333 213.333333h597.333334v85.333334H213.333333zM213.333333 725.333333h597.333334v85.333334H213.333333z","p-id":"5447"}))),rc=n=>m(q,{spin:n.spin,rotate:n.rotate,className:n.className,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6513",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M512 219.428571c161.645714 0 307.931429 97.499429 438.857143 292.571429-130.925714 195.072-277.211429 292.571429-438.857143 292.571429S204.068571 707.072 73.142857 512c130.925714-195.072 277.211429-292.571429 438.857143-292.571429z m0 73.142858c-124.123429 0-241.225143 65.462857-365.714286 219.428571 119.661714 147.968 231.424 213.577143 365.714286 219.428571 124.196571 0 241.298286-65.462857 365.714286-219.428571-119.588571-147.968-231.350857-213.577143-365.714286-219.428571z","p-id":"6514"}),m("path",{d:"M818.614857 146.285714l51.712 51.712L197.997714 870.4 146.285714 818.688z","p-id":"6515"}),m("path",{d:"M512 365.714286a146.285714 146.285714 0 1 1 0 292.571428 146.285714 146.285714 0 0 1 0-292.571428z m0 73.142857a73.142857 73.142857 0 1 0 0 146.285714 73.142857 73.142857 0 0 0 0-146.285714z","p-id":"6516"})));var Es={BackIcon:ql,ForwardIcon:Zl,FormatIcon:Jl,NextIcon:Ql,RightIcon:ec,CorrectIcon:tc,LtIcon:nc,CloseIcon:Mo,MenuIcon:sc,HideIcon:rc};class W1{render(){return ql}}class V1{render(){return Zl}}class G1{render(){return Jl}}class $1{render(){return Ql}}class Y1{render(){return ec}}class X1{render(){return tc}}class j1{render(){return nc}}class K1{render(){return Mo}}class q1{render(){return Mo}}class Z1{render(){return sc}}class J1{render(){return rc}}const Q1=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7578",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M256 362.666667v298.666666l256 149.333334 256-149.333334v-298.666666L512 213.333333 256 362.666667zM725.333333 640l-213.333333 128-213.333333-128V384l213.333333-128 213.333333 128v256z m-189.354666 40.021333a18.645333 18.645333 0 0 1-18.645334 18.645334 18.304 18.304 0 0 1-18.688-18.645334V535.466667l-130.645333-75.349334a18.645333 18.645333 0 0 1 4.565333-34.133333 18.304 18.304 0 0 1 14.08 2.005333l130.688 74.666667 129.578667-74.666667a18.304 18.304 0 0 1 25.386667 6.698667 18.645333 18.645333 0 0 1-6.784 25.386667l-129.536 74.666666v145.237334z","p-id":"7579"}))),eg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7451",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M774.058667 213.333333v42.666667H310.784l236.288 256-236.330667 256h463.317334v42.666667H213.333333l275.669334-298.666667L213.333333 213.333333z","p-id":"7452"}))),tg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6675",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M704 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333zM512 384c11.776 0 21.333333 7.68 21.333333 17.194667v221.610666c0 9.514667-9.472 17.194667-21.333333 17.194667-11.776 0-21.333333-7.68-21.333333-17.194667V401.194667c0-4.565333 2.218667-8.96 6.186666-12.16A24.32 24.32 0 0 1 512 384zM320 256a21.333333 21.333333 0 0 1 21.333333 21.333333v469.333334a21.333333 21.333333 0 1 1-42.666666 0v-469.333334c0-11.776 9.472-21.333333 21.333333-21.333333z m283.562667 368.896a21.333333 21.333333 0 0 1 30.165333 30.165333l-106.666667 106.666667a21.333333 21.333333 0 0 1-30.165333 0l-106.666667-106.666667a21.333333 21.333333 0 0 1 30.165334-30.165333L512 716.501333l91.605333-91.562666z m0.298666-225.834667a21.333333 21.333333 0 0 0 30.165334-30.165333l-106.666667-106.666667a21.333333 21.333333 0 0 0-30.165333 0l-106.666667 106.666667a21.333333 21.333333 0 0 0 30.165333 30.165333l91.562667-91.562666 91.605333 91.562666z","p-id":"6676"}))),ng=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6548",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M430.848 666.197333H366.592V236.074667a6.656 6.656 0 0 0-6.741333-6.528h-47.36a6.656 6.656 0 0 0-6.741334 6.528v430.122666H241.493333c-5.674667 0-8.874667 6.314667-5.333333 10.538667l94.72 115.2a6.912 6.912 0 0 0 10.624 0l94.72-115.2c3.413333-4.224 0.298667-10.538667-5.376-10.538667zM582.442667 806.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 533.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 486.698667v-39.168h-124.288l124.288-203.093334V213.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6549"}))),sg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6294",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M430.848 357.76H366.592v430.165333a6.656 6.656 0 0 1-6.741333 6.485334h-47.36a6.656 6.656 0 0 1-6.741334-6.485334V357.76H241.493333c-5.674667 0-8.874667-6.314667-5.333333-10.538667l94.72-115.2a6.912 6.912 0 0 1 10.624 0l94.72 115.2c3.413333 4.224 0.298667 10.538667-5.376 10.538667zM582.442667 486.698667l20.992-61.098667h103.68l21.205333 61.098667h43.690667L672.64 213.333333h-34.688l-99.370667 273.365334h43.861334z m112.896-97.877334h-79.872l39.552-119.424h0.768l39.552 119.466667zM742.570667 806.698667v-39.168h-124.288l124.288-203.093334V533.333333h-169.685334v36.949334h119.04l-123.904 201.941333v34.474667z","p-id":"6295"}))),rg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6802",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6803"}))),og=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6929",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M736 213.333333H328.533333C288 213.333333 256 245.333333 256 285.866667c0 17.066667 6.4 34.133333 17.066667 46.933333 0 2.133333 2.133333 2.133333 2.133333 4.266667l160 160v168.533333c0 6.4 2.133333 10.666667 6.4 14.933333l145.066667 123.733334c4.266667 2.133333 8.533333 4.266667 12.8 4.266666 6.4 0 10.666667-2.133333 14.933333-6.4 4.266667-4.266667 4.266667-10.666667 4.266667-14.933333V503.466667l170.666666-166.4 2.133334-2.133334c10.666667-12.8 17.066667-29.866667 17.066666-46.933333 0-42.666667-32-74.666667-72.533333-74.666667z m23.466667 93.866667s-2.133333 2.133333 0 0l-172.8 172.8c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334l-162.133333-166.4-2.133333-2.133333c-6.4-6.4-8.533333-12.8-8.533334-21.333333 0-17.066667 14.933333-32 32-32h407.466667c17.066667 0 32 14.933333 32 32 0 8.533333-4.266667 14.933333-8.533333 21.333333z","p-id":"6930"}),m("path",{d:"M688.213333 378.410667l-101.546666 101.589333c-4.266667 4.266667-6.4 8.533333-6.4 14.933333v251.733334l-104.533334-87.466667V490.666667c0-6.4-2.133333-10.666667-6.4-14.933334L403.626667 408.32l284.586666-29.909333z","p-id":"6931"}))),ig=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7193",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M214.016 722.432h593.92v42.410667H214.016v-42.410667z m578.048-312.106667l-180.693333-181.077333A53.376 53.376 0 0 0 573.738667 213.333333a45.653333 45.653333 0 0 0-32.64 13.226667l-313.941334 314.965333c-18.56 18.602667-17.322667 50.261333 2.688 70.4l68.010667 68.096h298.24l198.698667-199.338666c18.56-18.602667 17.322667-50.261333-2.730667-70.357334z m-213.546667 227.242667H315.434667L259.84 581.888c-3.968-4.010667-4.053333-9.088-2.730667-10.453333L430.08 398.08l193.92 193.92-45.44 45.568z","p-id":"7194"}))),ag=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5912",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M764.330667 592.170667l30.165333 30.165333L734.165333 682.666667l60.330667 60.330666-30.165333 30.165334-60.330667-60.330667-60.330667 60.330667-30.165333-30.165334L673.834667 682.666667l-60.330667-60.330667 30.165333-30.165333 60.330667 60.330666 60.330667-60.330666zM725.333333 512v42.666667H256v128h256v42.666666H213.333333v-213.333333h512z m47.829334-209.664l30.165333 30.165333L682.666667 453.12l-30.165334 30.165333-90.496-90.453333 30.165334-30.208 60.330666 60.330667 120.661334-120.661334zM725.333333 256v42.666667H256v128h256v42.666666H213.333333V256h512z","p-id":"5913"})));class lg{render(){return Q1}}class cg{render(){return eg}}class ug{render(){return tg}}class hg{render(){return ng}}class dg{render(){return sg}}class fg{render(){return rg}}class gg{render(){return og}}class mg{render(){return ig}}class _g{render(){return ag}}const oc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7705",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M352 490.666667a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z m128 0a32 32 0 1 0 64 0 32 32 0 0 0-64 0z","p-id":"7706"}),m("path",{d:"M768 298.666667H256c-23.466667 0-42.666667 19.2-42.666667 42.666666v298.666667c0 23.466667 19.2 42.666667 42.666667 42.666667h106.666667v128l128-128H768c23.466667 0 42.666667-19.2 42.666667-42.666667V341.333333c0-23.466667-19.2-42.666667-42.666667-42.666666z m0 320c0 12.8-8.533333 21.333333-21.333333 21.333333H469.333333l-64 64V640h-128c-12.8 0-21.333333-8.533333-21.333333-21.333333v-256c0-12.8 8.533333-21.333333 21.333333-21.333334h469.333334c12.8 0 21.333333 8.533333 21.333333 21.333334v256z","p-id":"7707"})));class bg{render(){return oc}}const ic=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5448",width:"1em",height:"1em"},m("path",{d:"M256.426667 256.426667h255.317333v553.130666H256.426667z",fill:"#B5B8BD","p-id":"5449"}),m("path",{d:"M809.557333 213.930667v595.626666H213.930667V213.930667h595.626666z m-42.538666 42.538666H256.426667v510.549334h510.549333V256.426667z",fill:"#444D5A","p-id":"5450"}),m("path",{d:"M490.453333 256.426667h42.538667v510.592h-42.538667z",fill:"#444D5A","p-id":"5451"}),m("path",{d:"M256.426667 532.992v-42.538667h510.592v42.538667z",fill:"#444D5A","p-id":"5452"}),m("path",{d:"M256.384 226.261333l264.192 264.192-30.122667 30.08-264.192-264.192 30.122667-30.08z m-30.122667 317.184l30.122667-30.122666 264.192 264.192-30.122667 30.08-264.192-264.149334z",fill:"#444D5A","p-id":"5453"})));class pg{render(){return ic}}const ac=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6039",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 320h-106.666667V768H768v-234.666667z m-405.376 0h-106.666667V768h106.666667v-234.666667z m256.042667 86.784L445.482667 768H618.666667v-147.882667z m0-162.346666l-213.376 179.968v108.885333l213.376-179.072v-109.781333z m0-163.669334l-213.333334 179.029334v108.885333l213.333334-179.072V294.101333zM768 256h-103.936l-2.730667 2.304V490.666667H768V256zM362.666667 256H256v234.666667h106.666667V256z m235.008 0H405.333333v161.408L597.674667 256z","p-id":"6040"})));class vg{render(){return ac}}const lc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5501",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M544.896 389.717333h110.762667v46.933334c6.698667 6.613333 15.658667 6.613333 22.357333 0l84.949333-55.125334c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386666c-6.741333-6.613333-15.701333-6.613333-22.4 0v41.258666h-133.12l-89.429334 154.453334H343.722667v0.128h-22.698667c-11.178667 0-22.357333 11.050667-22.357333 22.058666 0 11.050667 11.178667 22.058667 22.357333 22.058667h134.101333l-0.085333-0.128h0.426667l89.386666-154.453333h0.042667z m133.12 198.954667a15.061333 15.061333 0 0 0-22.314667 0v43.690667h-66.133333l-67.029333-110.293334-22.357334 44.117334s62.592 103.68 67.072 110.293333h88.448V721.066667a15.061333 15.061333 0 0 0 22.314667 0l84.949333-55.168c6.698667-4.437333 6.698667-13.226667 0-19.84l-84.906666-57.386667h-0.042667z","p-id":"5502"})));class Cg{render(){return lc}}const cc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4859",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M768 430.933333H280.405333l-4.394666-0.554666c-5.461333-0.853333-6.570667-1.749333-12.885334-6.528l-2.986666-5.376c-6.4-11.946667-5.376-13.738667 2.986666-28.885334L440.618667 213.333333l34.218666 34.048-136.362666 135.424H768v48.170667z m-7.594667 163.242667L585.472 768l-34.261333-34.048 136.362666-135.424H258.048v-48.170667h484.096c10.453333 0 19.882667 6.272 23.893333 15.872a25.6 25.6 0 0 1-5.632 27.989334z","p-id":"4860"})));class wg{render(){return cc}}const uc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4732",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M664.832 634.624l128.554667 128.597333a21.333333 21.333333 0 1 1-30.165334 30.165334l-128.597333-128.597334a256 256 0 1 1 30.165333-30.165333zM469.333333 682.666667a213.333333 213.333333 0 1 0 0-426.666667 213.333333 213.333333 0 0 0 0 426.666667z","p-id":"4733"})));class Eg{render(){return uc}}const hc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4605",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334zM341.333333 383.872H256V768h85.333333V383.872z m426.666667 0H383.872V768H768V383.872z m-149.333333 21.461333a64 64 0 0 1 63.701333 57.856L682.666667 469.333333v64h42.666666v213.333334h-298.666666v-213.333334h42.666666V469.333333a64 64 0 0 1 57.856-63.701333L533.333333 405.333333h85.333334z m64 170.666667h-213.333334v128h213.333334v-128z m-106.666667 21.333333a21.333333 21.333333 0 0 1 21.333333 21.333334v42.666666a21.333333 21.333333 0 1 1-42.666666 0v-42.666666a21.333333 21.333333 0 0 1 21.333333-21.333334z m42.666667-149.333333h-85.333334a21.333333 21.333333 0 0 0-20.992 17.493333L512 469.333333v64h128V469.333333a21.333333 21.333333 0 0 0-13.909333-20.010666l-3.584-0.981334-3.84-0.341333zM768 256H383.872v85.290667L768 341.333333V256zM341.333333 256H256v85.333333l85.333333-0.042666V256z","p-id":"4606"})));class Tg{render(){return hc}}const dc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5579",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M618.666667 723.584V661.333333a21.333333 21.333333 0 1 1 42.666666 0v62.250667a128.128 128.128 0 0 0 104.917334-104.917333H704a21.333333 21.333333 0 1 1 0-42.666667h62.250667a128.128 128.128 0 0 0-104.917334-104.874667V533.333333a21.333333 21.333333 0 1 1-42.666666 0v-62.208a128.085333 128.085333 0 0 0-104.874667 104.874667H576a21.333333 21.333333 0 0 1 0 42.666667h-62.208a128.128 128.128 0 0 0 104.874667 104.917333z m149.333333-296.96a213.12 213.12 0 0 0-42.666667-24.874667V277.333333a21.333333 21.333333 0 0 0-21.333333-21.333333h-426.666667a21.333333 21.333333 0 0 0-21.333333 21.333333v341.333334a21.333333 21.333333 0 0 0 21.333333 21.333333h153.6c2.986667 14.848 7.594667 29.098667 13.482667 42.666667H256a42.666667 42.666667 0 0 1-42.666667-42.666667V256a42.666667 42.666667 0 0 1 42.666667-42.666667h469.333333a42.666667 42.666667 0 0 1 42.666667 42.666667v170.666667zM640 768a170.666667 170.666667 0 1 1 0-341.333333 170.666667 170.666667 0 0 1 0 341.333333z","p-id":"5580"})));class Rg{render(){return dc}}const fc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em"},m("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"5319"}),m("path",{d:"M256 512h256v42.666667H256zM554.666667 256v298.666667h-42.666667V256z","p-id":"5320"}),m("path",{d:"M405.333333 256v298.666667h-42.666666V256z","p-id":"5321"})));class Dg{render(){return fc}}const gc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5447",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M256 256h554.666667v42.666667H256z","p-id":"5448"}),m("path",{d:"M298.666667 256v554.666667H256V256zM810.666667 256v554.666667h-42.666667V256zM469.333333 256v554.666667h-42.666666V256zM640 256v554.666667h-42.666667V256z","p-id":"5449"}),m("path",{d:"M256 426.666667h554.666667v42.666666H256zM256 597.333333h554.666667v42.666667H256zM256 768h554.666667v42.666667H256z","p-id":"5450"})));class Ig{render(){return gc}}const mc=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5576",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M810.666667 213.333333v42.666667h-170.709334L640 768h170.666667v42.666667h-213.333334V213.333333h213.333334z m-384 0l-0.042667 554.666667H426.666667v42.666667H213.333333v-42.666667h170.624L384 256H213.333333V213.333333h213.333334z m106.666666 512v85.333334h-42.666666v-85.333334h42.666666z m0-170.666666v85.333333h-42.666666v-85.333333h42.666666z m0-170.666667v85.333333h-42.666666V384h42.666666z m0-170.666667v85.333334h-42.666666V213.333333h42.666666z","p-id":"5577"})));class yg{render(){return mc}}const _c=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6094",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M913.988 173.68H110.05c-25.671 0-46.676 21.007-46.676 46.679v665.897c0 25.651 20.987 46.638 46.637 46.638H913.95c25.671 0 46.676-21.004 46.676-46.676V220.32c0-25.651-20.988-46.64-46.638-46.64zM339.796 896.142c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V768.023c0-12.014 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.338-21.303-21.353V543.029c0-12.013 9.338-21.354 21.303-21.354h213.627c11.965 0 21.305 9.34 21.305 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.305 21.353H104.864c-11.965 0-21.303-9.337-21.303-21.353V319.596c0-12.013 9.338-21.353 21.303-21.353h213.627c11.965 0 21.305 9.34 21.305 21.353v128.118zM639.269 896.14c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V768.023c0-12.014 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.338-21.305-21.353V543.029c0-12.013 9.34-21.354 21.305-21.354h213.626c11.966 0 21.306 9.34 21.306 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.306 21.353H404.337c-11.966 0-21.305-9.337-21.305-21.353V319.596c0-12.013 9.34-21.353 21.305-21.353h213.626c11.966 0 21.306 9.34 21.306 21.353v128.118zM941.864 896.14c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V768.023c0-12.014 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z m0-224.995c0 12.015-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.338-21.304-21.353V543.029c0-12.013 9.338-21.354 21.304-21.354h213.626c11.966 0 21.304 9.34 21.304 21.354v128.117z m0-223.432c0 12.016-9.34 21.353-21.304 21.353H706.933c-11.966 0-21.304-9.337-21.304-21.353V319.596c0-12.013 9.338-21.353 21.304-21.353h213.626c11.966 0 21.304 9.34 21.304 21.353v128.118z","p-id":"6095"})));class Ag{render(){return _c}}var Sg={CommentIcon:oc,FreezeIcon:ic,conditionalFormatIcon:ac,DivideIcon:lc,ReplaceIcon:cc,SearchIcon:uc,LockIcon:hc,LocationIcon:dc,PageIcon:fc,RegularIcon:gc,LayoutIcon:mc,TableIcon:_c};const Og=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4476",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M743.125333 341.333333c35.669333 0 64.384 28.885333 67.285334 65.024l0.256 6.101334V682.666667h-149.76v-42.666667H768V412.458667c0-14.592-9.514667-26.154667-21.333333-28.16L743.168 384H280.874667c-12.16 0-22.784 10.24-24.576 24.149333l-0.298667 4.266667V640h127.36v42.666667H213.333333V412.458667c0-36.906667 26.794667-67.712 61.653334-70.826667L280.874667 341.333333h462.250666z","p-id":"4477"}),m("path",{d:"M682.666667 213.333333H341.333333v170.666667h341.333334V213.333333z m-42.666667 42.666667v85.333333H384V256h256zM682.666667 554.666667v256H341.333333v-256h341.333334z m-42.666667 42.666666H384v170.666667h256v-170.666667z","p-id":"4478"}),m("path",{d:"M341.333333 426.666667h128v42.666666H341.333333z","p-id":"4479"}))),xg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5374",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M590.848 567.04l-265.386667-306.645333a28.245333 28.245333 0 0 1 3.2-40.149334 29.141333 29.141333 0 0 1 40.789334 3.242667l267.946666 309.674667a124.885333 124.885333 0 0 1 144.213334 34.474666 125.141333 125.141333 0 0 1-16.042667 176.256 125.141333 125.141333 0 0 1-176.341333-14.805333 125.013333 125.013333 0 0 1 1.621333-162.048z m40.149333 18.133333c-18.602667 15.701333-29.312 38.826667-29.312 63.189334 0 45.909333 37.461333 83.157333 83.754667 83.157333a83.413333 83.413333 0 0 0 83.712-83.157333 83.413333 83.413333 0 0 0-83.712-83.114667c-15.189333 0-29.44 4.010667-41.685333 11.008a28.458667 28.458667 0 0 1-12.757334 8.96v-0.042667z m-150.698666-52.565333l-38.229334 44.16a29.653333 29.653333 0 0 1-0.768 0.810667 124.885333 124.885333 0 0 1-6.528 151.509333 125.141333 125.141333 0 0 1-176.341333 14.805333C205.226667 699.306667 198.101333 620.373333 242.346667 567.637333a124.928 124.928 0 0 1 156.416-28.544l38.528-44.501333c9.514667 17.237333 24.746667 30.634667 43.008 37.973333z m105.6-122.026667a85.632 85.632 0 0 0-43.818667-37.12l129.749333-150.016a29.141333 29.141333 0 0 1 40.789334-3.242666 28.245333 28.245333 0 0 1 3.2 40.149333l-129.92 150.186667z m-300.8 301.44c35.413333 29.738667 88.064 25.301333 117.546666-9.813333a83.413333 83.413333 0 0 0-10.666666-117.546667 83.456 83.456 0 0 0-117.589334 9.856 83.456 83.456 0 0 0 10.709334 117.504z","p-id":"5375"}))),Ng=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5706",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM362.666667 725.333333v42.666667h-128v-42.666667h128z m128 0v42.666667h-42.666667v-42.666667h42.666667z m301.696-143.957333a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2zM256 533.333333v128H213.333333v-128h42.666667z m411.477333 85.845334H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333zM768 362.666667v128h-42.666667v-128h42.666667z m-512-42.666667v128H213.333333v-128h42.666667zM768 213.333333v64h-42.666667V256h-64V213.333333H768zM362.666667 213.333333v42.666667H256v21.333333H213.333333V213.333333h149.333334z m213.333333 0v42.666667h-128V213.333333h128z","p-id":"5707"}))),Mg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5833",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M727.04 706.218667a11.946667 11.946667 0 0 1 8.704 3.754666 13.312 13.312 0 0 1 3.626667 9.130667V810.666667H583.253333v-91.52c0-3.413333 1.28-6.741333 3.626667-9.173334a11.946667 11.946667 0 0 1 8.661333-3.754666zM768 213.333333v277.333334h-42.666667V256H256v469.333333h234.666667v42.666667H213.333333V213.333333h554.666667z m24.362667 368.042667a18.773333 18.773333 0 0 1 18.304 19.2v117.205333c0 10.581333-8.277333 19.2-18.346667 19.2h-28.458667v-11.434666c-0.128-21.333333-16.554667-38.570667-36.778666-38.570667h-131.498667c-20.224 0-36.693333 17.237333-36.778667 38.570667v11.477333h-28.458666a18.858667 18.858667 0 0 1-18.346667-19.2v-117.248c0-10.581333 8.277333-19.2 18.346667-19.2z m-124.885334 37.802667H567.04a12.586667 12.586667 0 0 0-12.245333 12.8c0.042667 7.125333 5.546667 12.885333 12.245333 12.842666h100.394667a12.586667 12.586667 0 0 0 12.202666-12.8c0-7.082667-5.504-12.8-12.202666-12.8zM723.072 512a14.506667 14.506667 0 0 1 14.165333 14.805333v35.84H585.386667v-35.84a14.506667 14.506667 0 0 1 14.165333-14.805333z","p-id":"5834"}),m("path",{d:"M341.333333 341.333333h298.666667v42.666667H341.333333zM341.333333 426.666667h170.666667v42.666666H341.333333z",fill:"#444D5A","p-id":"5835"}))),kg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"foward",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5815",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 263.381334l-233.984 190.890666-118.613333-98.218666L256 704.64V768h512v-291.285333zM768 256H256v392.704l159.146667-134.954667 119.04 98.602667L768 421.674667V256zM384 341.333333a42.666667 42.666667 0 1 1 0 85.333334 42.666667 42.666667 0 0 1 0-85.333334z",fill:"#444D5A","p-id":"5816"})));class Bg{render(){return Og}}class Lg{render(){return xg}}class Fg{render(){return Ng}}class Hg{render(){return Mg}}class Pg{render(){return kg}}const zg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"logo",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"1214",width:"1em",height:"1em"},m("path",{d:"M840 288H688v-56c0-40-32-72-72-72h-208C368 160 336 192 336 232V288h-152c-12.8 0-24 11.2-24 24s11.2 24 24 24h656c12.8 0 24-11.2 24-24s-11.2-24-24-24zM384 288v-56c0-12.8 11.2-24 24-24h208c12.8 0 24 11.2 24 24V288H384zM758.4 384c-12.8 0-24 11.2-24 24v363.2c0 24-19.2 44.8-44.8 44.8H332.8c-24 0-44.8-19.2-44.8-44.8V408c0-12.8-11.2-24-24-24s-24 11.2-24 24v363.2c0 51.2 41.6 92.8 92.8 92.8h358.4c51.2 0 92.8-41.6 92.8-92.8V408c-1.6-12.8-12.8-24-25.6-24z","p-id":"1215"}),m("path",{d:"M444.8 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24zM627.2 744v-336c0-12.8-11.2-24-24-24s-24 11.2-24 24v336c0 12.8 11.2 24 24 24s24-11.2 24-24z","p-id":"1216"})));class Ug{render(){return zg}}const Wg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"logo",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4224",width:"1em",height:"1em",fill:"currentColor"},m("path",{d:"M119.808 180.053333l60.330667-60.245333 724.053333 724.053333-60.330667 60.330667z","p-id":"4225"}),m("path",{d:"M843.946667 119.808l60.245333 60.330667-724.053333 724.053333-60.330667-60.330667z","p-id":"4226"}))),Vg=n=>m(q,{spin:n.spin,rotate:n.rotate,name:"dropdown",style:n.style},m("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4519",width:"1em",height:"1em"},m("path",{d:"M149.930667 444.330667l60.330666-60.330667 362.069334 362.069333L512 806.4z",fill:"#B5B8BD","p-id":"4520"}),m("path",{d:"M813.738667 384l60.330666 60.330667L512 806.4l-60.330667-60.330667z",fill:"#B5B8BD","p-id":"4521"})));var bc={Close:Wg,DropDownIcon:Vg};const Gg={RightIcon:m(Es.RightIcon,null)},$g="univer-btn",Yg="univer-btn-lg",Xg="univer-btn-sm",jg="univer-btn-primary",Kg="univer-btn-danger",qg="univer-btn-text",Zg="univer-btn-round",Jg="univer-btn-circle",Qg="univer-btn-block",e0="univer-btn-loading";var hn={btn:$g,btnLg:Yg,btnSm:Xg,btnPrimary:jg,btnDanger:Kg,btnText:qg,btnRound:Zg,btnCircle:Jg,btnBlock:Qg,btnLoading:e0};const Rt=n=>{const{type:e,shape:t,size:s,htmlType:r="button",danger:o=!1,disabled:i,block:a=!1,loading:c=!1,active:l=!1,onClick:u,children:h,className:d="",style:f}=n,g=w=>{if(i){w.preventDefault();return}u&&u(w)};let b="";switch(s){case"large":b="lg";break;case"small":b="sm";break}const p=ot(hn.btn,{[`${hn.btn}-${e}`]:e,[`${hn.btn}-${t}`]:t,[`${hn.btn}-${b}`]:s,[`${hn.btn}-danger`]:!!o,[`${hn.btn}-block`]:a,[`${hn.btn}-loading`]:c},d);let v=f;return l&&(v=Object.assign(f||{},{background:"#eee"})),m("button",{type:r,onClick:g,className:p,disabled:i,style:{...v}},c?m(Kl,null):"",h)};class t0{render(){return Rt}}var n0={};class yt extends ye{constructor(){super(...arguments),this.canvasRef=ge()}componentDidMount(){this.drawLine()}drawLine(){const e=this.canvasRef;this.props.drawLine(e)}setLineDash(e,t,s,r,o,i,a){try{t==="Hair"?e.setLineDash([1,2]):t.indexOf("DashDotDot")>-1?e.setLineDash([2,2,5,2,2]):t.indexOf("DashDot")>-1?e.setLineDash([2,5,2]):t.indexOf("Dotted")>-1?e.setLineDash([2]):t.indexOf("Dashed")>-1?e.setLineDash([3]):e.setLineDash([0])}catch(c){console.log(c)}e.beginPath(),t.indexOf("Medium")>-1?(s==="h"?(e.moveTo(r,o-.5),e.lineTo(i,a-.5)):(e.moveTo(r-.5,o),e.lineTo(i-.5,a)),e.lineWidth=2):t==="Thick"?(e.moveTo(r,o),e.lineTo(i,a),e.lineWidth=3):(e.moveTo(r,o),e.lineTo(i,a),e.lineWidth=1)}render(){return m("canvas",{ref:this.canvasRef,className:n0.canvas,width:this.props.width,height:this.props.height})}}class s0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"Thin","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class r0{render(){return s0}}class o0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"Hair","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class i0{render(){return o0}}class a0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"Dotted","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class l0{render(){return a0}}class c0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"Dashed","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class u0{render(){return c0}}class h0 extends ye{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"DashDot","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class d0{render(){return h0}}class f0 extends ye{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"DashDotDot","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class g0{render(){return f0}}class m0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"Medium","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class _0{render(){return m0}}class b0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"MediumDashed","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class p0{render(){return b0}}class v0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"MediumDashDot","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class C0{render(){return v0}}class w0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"MediumDashDotDot","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class E0{render(){return w0}}class T0 extends Ue{constructor(){super(...arguments),this.ref=ge()}drawLine(e){let s=e.current.getContext("2d");this.ref.current.setLineDash(s,"Thick","h",0,5,100,5),s.stroke(),s.closePath()}render(){const{width:e="100",height:t="10"}=this.props;return m(yt,{ref:this.ref,width:e,height:t,drawLine:s=>this.drawLine(s)})}}class R0{render(){return T0}}const D0="univer-cell-range-modal",I0="univer-input",y0="univer-cell-modal-icon";var Ji={cellRangeModal:D0,input:I0,cellModalIcon:y0};class A0 extends ye{constructor(){super(...arguments),this.ref=ge(),this.state={modalData:[{name:"dataValidation.selectCellRange2",show:!1,group:[{name:"button.confirm",type:"primary",onClick:()=>this.handleOk()},{name:"button.cancel"}]}],placeholderState:{name:"dataValidation.selectCellRange2"},value:""},this.showModal=(e,t)=>{let{modalData:s}=this.state;const r=s.findIndex(o=>o.name===e);r>-1&&(s[r].show=t),this.setValue({modalData:s})},this.handleOk=()=>{const e=this.ref.current.getValue();this.showModal("dataValidation.selectCellRange2",!1),this.setValue({value:e})},this.setValue=(e,t)=>{this.setState(s=>({...e}),t)},this.changeRange=e=>{const t=e.target;this.setValue({value:t.value})},this.showRange=()=>{var e;this.showModal("dataValidation.selectCellRange2",!0),(e=this._context.getWorkBook().getActiveSheet())==null||e.getSelection().setSelection({selection:this.state.value})}}setLocale(){const e=this.context.locale;this.setState(t=>{let{modalData:s,placeholderState:r}=t;return s.forEach(o=>{o.title=e.get(o.locale),o.group&&o.group.length&&o.group.forEach(i=>{i.label=e.get(i.locale)})}),r.label=e.get(r.name),{modalData:s,placeholderState:r}})}componentWillReceiveProps(e){this.setValue({value:e.valueProps})}componentDidMount(){var e,t;this.setValue({value:this.props.valueProps}),this.setLocale(),this._context,this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()}),this._localeObserver1=(t=this._context.getObserverManager().getObserver("onAfterSetSelectionObservable","worksheet"))==null?void 0:t.add(s=>{console.dir(s)})}componentWillUnmount(){}render(e,t){const{modalData:s,placeholderState:r,value:o}=t,{placeholderProps:i}=e;return m("div",{className:Ji.cellRangeModal},m(Rs,{placeholder:i,value:o,onChange:a=>this.changeRange(a)}),m("span",{className:Ji.cellModalIcon,onClick:this.showRange},m(Sg.TableIcon,null)),s.map(a=>{if(!!a.show)return m(Lo,{title:a.title,visible:a.show,group:a.group,onCancel:a.onCancel},m(Rs,{readonly:!0,placeholder:r.label,value:o,ref:this.ref}))}))}}class S0{render(){return A0}}const O0="univer-checkbox-wrapper",x0="univer-check-box",N0="univer-checkbox-input",M0="univer-checkbox-inner",k0="univer-check-box-checked",B0="univer-check-box-disabled",L0="univer-checkbox-group";var Ht={checkboxWrapper:O0,checkBox:x0,checkboxInput:N0,checkboxInner:M0,checkBoxChecked:k0,checkBoxDisabled:B0,checkboxGroup:L0};class pc extends ye{constructor(){super(...arguments),this.state={classes:this.props.className?`${this.props.className} ${Ht.checkBox}`:Ht.checkBox,check:!0},this.handleStyle=(e,t)=>{let s=ot(Ht.checkBox,{[`${Ht.checkBox}-checked`]:e,[`${Ht.checkBox}-disabled`]:t});this.setState(r=>({classes:s,check:e}))},this.handleChange=e=>{var s,r;const t=e.target;this.handleStyle(t.checked,this.props.disabled),(r=(s=this.props).onChange)==null||r.call(s,e)}}componentWillMount(){this.handleStyle(this.props.checked,this.props.disabled)}componentWillReceiveProps(e){this.handleStyle(e.checked,e.disabled)}render(e,t){const{classes:s,check:r}=t,{value:o,name:i,disabled:a,children:c}=e;return m("label",{className:Ht.checkboxWrapper},m("span",{className:s},m("span",{className:Ht.checkboxInner}),m("input",{type:"checkbox",name:i,checked:r,disabled:a,className:Ht.checkboxInput,value:o,onChange:this.handleChange})),c&&m("span",null,c))}}class F0{render(){return pc}}const H0=n=>{let{options:e,onChange:t,disabled:s,name:r}=n,o=Lt(null);s&&e.forEach(a=>{a.disabled=!0}),r&&e.forEach(a=>{a.name=r});const i=()=>{var l;if(!t)return;let a=(l=o.current)==null?void 0:l.querySelectorAll("label input"),c=[];a==null||a.forEach(u=>{let h=u;h.checked&&c.push(h.value)}),t(c)};return m("div",{className:Ht.checkboxGroup,ref:o},e.map(a=>m(pc,{name:a.name,disabled:a.disabled,checked:a.checked,onChange:i,value:a.value},a.label)))};class P0{render(){return H0}}const z0="univer-panel-wrapper",U0="univer-panel-header",W0="univer-panel-header-icon",V0="univer-panel-header-icon-rotate",G0="univer-panel-body",$0="univer-active";var Pt={panelWrapper:z0,panelHeader:U0,panelHeaderIcon:W0,panelHeaderIconRotate:V0,panelBody:G0,active:$0};const Y0=n=>{const{header:e,children:t}=n;let[s,r]=Os(ot(Pt.panelBody));const o=()=>{s.includes("active")?r(ot(Pt.panelBody)):r(ot(Pt.panelBody,Pt.active))};return m("div",{className:Pt.panelWrapper},m("div",{className:Pt.panelHeader,onClick:()=>o()},e,m("span",{className:`${Pt.panelHeaderIcon} ${s.includes("active")?Pt.panelHeaderIconRotate:""}`},m(Es.NextIcon,null))),m("div",{className:s},t))},X0=n=>{const{children:e}=n;return m("div",{className:Pt.collapseWrapper},e)};class j0{render(){return X0}}class K0{render(){return Y0}}function Jn(){return(Jn=Object.assign||function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n}).apply(this,arguments)}function wr(n,e){if(n==null)return{};var t,s,r={},o=Object.keys(n);for(s=0;s<o.length;s++)e.indexOf(t=o[s])>=0||(r[t]=n[t]);return r}function Ts(n){var e=Lt(n),t=Lt(function(s){e.current&&e.current(s)});return e.current=n,t.current}var Yn=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=1),n>t?t:n<e?e:n},ds=function(n){return"touches"in n},eo=function(n){return n&&n.ownerDocument.defaultView||self},Qi=function(n,e,t){var s=n.getBoundingClientRect(),r=ds(e)?function(o,i){for(var a=0;a<o.length;a++)if(o[a].identifier===i)return o[a];return o[0]}(e.touches,t):e;return{left:Yn((r.pageX-(s.left+eo(n).pageXOffset))/s.width),top:Yn((r.pageY-(s.top+eo(n).pageYOffset))/s.height)}},ea=function(n){!ds(n)&&n.preventDefault()},ko=Le.memo(function(n){var e=n.onMove,t=n.onKey,s=wr(n,["onMove","onKey"]),r=Lt(null),o=Ts(e),i=Ts(t),a=Lt(null),c=Lt(!1),l=Cr(function(){var f=function(p){ea(p),(ds(p)?p.touches.length>0:p.buttons>0)&&r.current?o(Qi(r.current,p,a.current)):b(!1)},g=function(){return b(!1)};function b(p){var v=c.current,C=eo(r.current),w=p?C.addEventListener:C.removeEventListener;w(v?"touchmove":"mousemove",f),w(v?"touchend":"mouseup",g)}return[function(p){var v=p.nativeEvent,C=r.current;if(C&&(ea(v),!function(x,A){return A&&!ds(x)}(v,c.current)&&C)){if(ds(v)){c.current=!0;var w=v.changedTouches||[];w.length&&(a.current=w[0].identifier)}C.focus(),o(Qi(C,v,a.current)),b(!0)}},function(p){var v=p.which||p.keyCode;v<37||v>40||(p.preventDefault(),i({left:v===39?.05:v===37?-.05:0,top:v===40?.05:v===38?-.05:0}))},b]},[i,o]),u=l[0],h=l[1],d=l[2];return Rn(function(){return d},[d]),Le.createElement("div",Jn({},s,{onTouchStart:u,onMouseDown:u,className:"react-colorful__interactive",ref:r,onKeyDown:h,tabIndex:0,role:"slider"}))}),Er=function(n){return n.filter(Boolean).join(" ")},Bo=function(n){var e=n.color,t=n.left,s=n.top,r=s===void 0?.5:s,o=Er(["react-colorful__pointer",n.className]);return Le.createElement("div",{className:o,style:{top:100*r+"%",left:100*t+"%"}},Le.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:e}}))},Qe=function(n,e,t){return e===void 0&&(e=0),t===void 0&&(t=Math.pow(10,e)),Math.round(t*n)/t},vc=function(n){var e=n.s,t=n.v,s=n.a,r=(200-e)*t/100;return{h:Qe(n.h),s:Qe(r>0&&r<200?e*t/100/(r<=100?r:200-r)*100:0),l:Qe(r/2),a:Qe(s,2)}},to=function(n){var e=vc(n);return"hsl("+e.h+", "+e.s+"%, "+e.l+"%)"},Lr=function(n){var e=vc(n);return"hsla("+e.h+", "+e.s+"%, "+e.l+"%, "+e.a+")"},q0=function(n){var e=n.h,t=n.s,s=n.v,r=n.a;e=e/360*6,t/=100,s/=100;var o=Math.floor(e),i=s*(1-t),a=s*(1-(e-o)*t),c=s*(1-(1-e+o)*t),l=o%6;return{r:Qe(255*[s,a,i,i,c,s][l]),g:Qe(255*[c,s,s,a,i,i][l]),b:Qe(255*[i,i,c,s,s,a][l]),a:Qe(r,2)}},Z0=function(n){var e=/rgba?\(?\s*(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?[,\s]+(-?\d*\.?\d+)(%)?,?\s*[/\s]*(-?\d*\.?\d+)?(%)?\s*\)?/i.exec(n);return e?J0({r:Number(e[1])/(e[2]?100/255:1),g:Number(e[3])/(e[4]?100/255:1),b:Number(e[5])/(e[6]?100/255:1),a:e[7]===void 0?1:Number(e[7])/(e[8]?100:1)}):{h:0,s:0,v:0,a:1}},J0=function(n){var e=n.r,t=n.g,s=n.b,r=n.a,o=Math.max(e,t,s),i=o-Math.min(e,t,s),a=i?o===e?(t-s)/i:o===t?2+(s-e)/i:4+(e-t)/i:0;return{h:Qe(60*(a<0?a+6:a)),s:Qe(o?i/o*100:0),v:Qe(o/255*100),a:r}},Q0=Le.memo(function(n){var e=n.hue,t=n.onChange,s=Er(["react-colorful__hue",n.className]);return Le.createElement("div",{className:s},Le.createElement(ko,{onMove:function(r){t({h:360*r.left})},onKey:function(r){t({h:Yn(e+360*r.left,0,360)})},"aria-label":"Hue","aria-valuenow":Qe(e),"aria-valuemax":"360","aria-valuemin":"0"},Le.createElement(Bo,{className:"react-colorful__hue-pointer",left:e/360,color:to({h:e,s:100,v:100,a:1})})))}),em=Le.memo(function(n){var e=n.hsva,t=n.onChange,s={backgroundColor:to({h:e.h,s:100,v:100,a:1})};return Le.createElement("div",{className:"react-colorful__saturation",style:s},Le.createElement(ko,{onMove:function(r){t({s:100*r.left,v:100-100*r.top})},onKey:function(r){t({s:Yn(e.s+100*r.left,0,100),v:Yn(e.v-100*r.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+Qe(e.s)+"%, Brightness "+Qe(e.v)+"%"},Le.createElement(Bo,{className:"react-colorful__saturation-pointer",top:1-e.v/100,left:e.s/100,color:to(e)})))}),tm=function(n,e){if(n===e)return!0;for(var t in n)if(n[t]!==e[t])return!1;return!0},nm=function(n,e){return n.replace(/\s/g,"")===e.replace(/\s/g,"")};function sm(n,e,t){var s=Ts(t),r=Os(function(){return n.toHsva(e)}),o=r[0],i=r[1],a=Lt({color:e,hsva:o});Rn(function(){if(!n.equal(e,a.current.color)){var l=n.toHsva(e);a.current={hsva:l,color:e},i(l)}},[e,n]),Rn(function(){var l;tm(o,a.current.hsva)||n.equal(l=n.fromHsva(o),a.current.color)||(a.current={hsva:o,color:l},s(l))},[o,n,s]);var c=Gn(function(l){i(function(u){return Object.assign({},u,l)})},[]);return[o,c]}var rm=typeof window!="undefined"?xs:Rn,om=function(){return typeof __webpack_nonce__!="undefined"?__webpack_nonce__:void 0},ta=new Map,im=function(n){rm(function(){var e=n.current?n.current.ownerDocument:document;if(e!==void 0&&!ta.has(e)){var t=e.createElement("style");t.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,ta.set(e,t);var s=om();s&&t.setAttribute("nonce",s),e.head.appendChild(t)}},[])},am=function(n){var e=n.className,t=n.hsva,s=n.onChange,r={backgroundImage:"linear-gradient(90deg, "+Lr(Object.assign({},t,{a:0}))+", "+Lr(Object.assign({},t,{a:1}))+")"},o=Er(["react-colorful__alpha",e]),i=Qe(100*t.a);return Le.createElement("div",{className:o},Le.createElement("div",{className:"react-colorful__alpha-gradient",style:r}),Le.createElement(ko,{onMove:function(a){s({a:a.left})},onKey:function(a){s({a:Yn(t.a+a.left)})},"aria-label":"Alpha","aria-valuetext":i+"%","aria-valuenow":i,"aria-valuemin":"0","aria-valuemax":"100"},Le.createElement(Bo,{className:"react-colorful__alpha-pointer",left:t.a,color:Lr(t)})))},lm=function(n){var e=n.className,t=n.colorModel,s=n.color,r=s===void 0?t.defaultColor:s,o=n.onChange,i=wr(n,["className","colorModel","color","onChange"]),a=Lt(null);im(a);var c=sm(t,r,o),l=c[0],u=c[1],h=Er(["react-colorful",e]);return Le.createElement("div",Jn({},i,{ref:a,className:h}),Le.createElement(em,{hsva:l,onChange:u}),Le.createElement(Q0,{hue:l.h,onChange:u}),Le.createElement(am,{hsva:l,onChange:u,className:"react-colorful__last-control"}))},cm={defaultColor:"rgba(0, 0, 0, 1)",toHsva:Z0,fromHsva:function(n){var e=q0(n);return"rgba("+e.r+", "+e.g+", "+e.b+", "+e.a+")"},equal:nm},um=function(n){return Le.createElement(lm,Jn({},n,{colorModel:cm}))},hm=/^#?([0-9A-F]{3,8})$/i,dm=function(n){var e=n.color,t=e===void 0?"":e,s=n.onChange,r=n.onBlur,o=n.escape,i=n.validate,a=n.format,c=n.process,l=wr(n,["color","onChange","onBlur","escape","validate","format","process"]),u=Os(function(){return o(t)}),h=u[0],d=u[1],f=Ts(s),g=Ts(r),b=Gn(function(v){var C=o(v.target.value);d(C),i(C)&&f(c?c(C):C)},[o,c,i,f]),p=Gn(function(v){i(v.target.value)||d(o(t)),g(v)},[t,o,i,g]);return Rn(function(){d(o(t))},[t,o]),Le.createElement("input",Jn({},l,{value:a?a(h):h,spellCheck:"false",onChange:b,onBlur:p}))},na=function(n){return"#"+n},fm=function(n){var e=n.prefixed,t=n.alpha,s=wr(n,["prefixed","alpha"]),r=Gn(function(i){return i.replace(/([^0-9A-F]+)/gi,"").substring(0,t?8:6)},[t]),o=Gn(function(i){return function(a,c){var l=hm.exec(a),u=l?l[1].length:0;return u===3||u===6||!!c&&u===4||!!c&&u===8}(i,t)},[t]);return Le.createElement(dm,Jn({},s,{escape:r,format:e?na:void 0,process:na,validate:o}))};const gm="univer-input",mm="univer-input-focused",_m="univer-input-disabled",bm="univer-input-borderless",pm="univer-input-borderless-focused";var Fr={input:gm,inputFocused:mm,inputDisabled:_m,inputBorderless:bm,inputBorderlessFocused:pm};class Rs extends ye{constructor(){super(...arguments),this.ref=ge(),this.setValue=(e,t)=>{this.setState(s=>({value:e}),t)},this.handleChange=e=>{const{onChange:t}=this.props;if(!t)return;const s=e.target;this.setValue(s.value),t(e)},this.handleKeyUp=e=>{const{onKeyUp:t}=this.props;t==null||t(e)},this.onFocus=e=>{const{onFocus:t}=this.props;t==null||t(e)},this.onClick=e=>{const{onClick:t}=this.props;t==null||t(e)},this.onBlur=e=>{const{onBlur:t}=this.props;t==null||t(e)},this.getValue=()=>this.ref.current.value}initialize(e){this.state={value:e.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(e){e.value&&e.value!==this.state.value&&this.setValue(e.value)}render(e,t){const{id:s,disabled:r,type:o,placeholder:i,bordered:a=!0,className:c="",readonly:l}=e,{value:u}=t,h=ot(Fr.input,{[`${Fr.input}-disable`]:r,[`${Fr.input}-borderless`]:!a},c);return m("input",{type:o,onBlur:this.onBlur,onFocus:this.onFocus,className:h,placeholder:i,disabled:r,ref:this.ref,onChange:this.handleChange,value:u,onClick:this.onClick,readonly:l,id:s,onKeyUp:this.handleKeyUp})}}class vm{render(){return Rs}}const Cm=n=>{let{color:e}=n;if(!e)return null;let t;if(e.indexOf("#")>-1){if(e=En.hexToRgbString(e),!e)return null;t=e.replace("rgba(","").replace(")","").split(",")}else e.indexOf("rgba")>-1?t=e.replace("rgba(","").replace(")","").split(","):(t=e.replace("rgb(","").replace(")","").split(","),t.push("1"));let s=Lt(null);const r=()=>{n.onChange(s.current.base.value)};return m(Rs,{ref:s,type:"text",value:`rgba(${t})`,onChange:r})},wm="univer-color-picker-panel",Em="univer-color-picker-panel-setting",Tm="univer-panel-input",Rm="univer-panel-color";var Qn={colorPickerPanel:wm,colorPickerPanelSetting:Em,panelInput:Tm,panelColor:Rm};class Dm extends ye{initialize(e){this.state={color:e.color||"#000"}}setColor(e){this.setState({color:e}),this.props.onChange(e)}render(){return m("div",{className:Qn.colorPickerPanel,onClick:e=>e.stopPropagation()},m(um,{className:Qn.colorPicker,color:this.state.color,onChange:Xs(this.setColor.bind(this),500)}),m("div",{className:Qn.colorPickerPanelSetting},m("div",{className:Qn.panelInput},this.props.rgb?m(Cm,{color:this.state.color,onChange:Xs(this.setColor.bind(this),500)}):m(fm,{color:this.state.color,onChange:Xs(this.setColor.bind(this),500)})),m("div",{className:Qn.panelColor},m("div",{style:{background:this.state.color}}),m("div",{style:{background:this.props.color}}))))}}const Im="univer-color-picker-outer",ym="univer-color-picker",Am="univer-picker",Sm="univer-picker-swatches",Om="univer-picker-swatches-item",xm="univer-picker-swatch",Nm="univer-picker-swatch-btn",Mm="univer-colorful-warp",km="univer-color-btn",Bm="univer-color-picker-slot";var Kt={colorPickerOuter:Im,colorPicker:ym,picker:Am,pickerSwatches:Sm,pickerSwatchesItem:Om,pickerSwatch:xm,pickerSwatchBtn:Nm,colorfulWarp:Mm,colorBtn:km,colorPickerSlot:Bm};let Lm=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class Xn extends ye{constructor(){super(...arguments),this.ulRef=ge(),this.onChange=e=>{this.props.onChange&&this.props.onChange(e),this.setState({afterColor:e})},this.onClick=(e,t)=>{this.props.onClick&&this.props.onClick(e,t)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=e=>{e&&this.ulRef.current.contains(e.target)||(this.setState(t=>({styles:{display:"none"}})),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=e=>{this.setState(t=>({styles:{display:"block"}})),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(e,t)=>{const s=e.getBoundingClientRect(),r=this.ulRef.current.getBoundingClientRect(),o=document.documentElement.clientWidth||document.body.clientWidth,i=document.documentElement.clientHeight||document.body.clientHeight;let a=0,c=0;return c=s.top+r.height>i?s.top-r.height:s.top+s.height,a=s.left+r.width>o?o-r.width:s.left,{left:a,top:c}},this.onSwitch=e=>{e.stopImmediatePropagation(),new Promise((t,s)=>{this.setState({setting:!this.state.setting}),t("end")}).then(()=>{if(this.state.root){const{top:t,left:s}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${s}px`,this.ulRef.current.style.top=`${t}px`}})}}initialize(e){this.state={presetColors:Lm,defaultColor:e.color||"#000",afterColor:e.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}render(){var t;const e=Object.assign(this.state.styles||{},this.props.style);return this.props.lang=(t=this.props.lang)!=null?t:{collapse:"",customColor:"",confirmColor:"",cancelColor:"",change:""},m("div",{className:`${Kt.colorPickerOuter} ${this.props.className}`,ref:this.ulRef,style:{...e}},m("div",{className:Kt.colorPicker,onClick:s=>{}},m("div",{className:Kt.picker},m("div",{className:Kt.pickerSwatches},this.state.presetColors.map(s=>m("div",{className:Kt.pickerSwatchesItem},s.map(r=>m("span",{className:Kt.pickerSwatch,style:{background:r}},m(tn,{title:r,placement:"top"},m("button",{key:r,className:Kt.pickerSwatchBtn,style:{background:r},onClick:o=>{this.props.onClick&&this.props.onClick(r,o)}}))))))),m("div",null,m(Rt,{onClick:this.onSwitch},this.state.setting?this.props.lang.collapse:this.props.lang.customColor))),this.state.setting?m("div",{className:Kt.colorfulWarp},m(Dm,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),m("div",null,m(Rt,{type:"primary",onClick:s=>{var r;(r=this.onClick)==null||r.call(this,this.state.afterColor,s)}},this.props.lang.confirmColor),m(Rt,{danger:!0,onClick:s=>{this.onCancel()}},this.props.lang.cancelColor),m(Rt,{onClick:s=>{s.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.props.lang.change))):null))}}class Fm{render(){return Xn}}const Hm="univer-color-picker-circle-button",Pm="univer-color-select-circle",zm="univer-vertical-middle";var Ls={colorPickerCircleButton:Hm,colorSelectCircle:Pm,verticalMiddle:zm};class Um extends ye{constructor(){super(...arguments),this.ref=ge(),this.colorRef=ge(),this.handleColorSelectButtonClick=e=>{e.stopImmediatePropagation(),this.colorRef.current.showSelect(this.ref.current)}}render(e){const{color:t,onClick:s,onCancel:r,style:o,colorPickerStyle:i}=e,a=this.getComponentRender().renderFunction("NextIcon");return m("div",{style:o,className:Ls.colorPickerCircleButton,ref:this.ref,onClick:this.handleColorSelectButtonClick},m("span",{className:`${Ls.colorSelectCircle} ${Ls.verticalMiddle}`,style:{backgroundColor:t}}),m(a,{className:Ls.verticalMiddle}),m(Xn,{color:t,onClick:s,onCancel:r,style:i,ref:this.colorRef}))}}class Wm{render(){return Um}}const js=xo((n,e)=>{const{children:t,style:s,className:r,onClick:o}=n;return m("div",{ref:e,style:s,className:r,onClick:o},t)});class Vm{render(){return js}}const Gm="univer-format-modal",$m="univer-cols-menu",Ym="univer-cols-menuitem",Xm="univer-cols-menuitem-content";var jm={formatModal:Gm,colsMenu:$m,colsMenuitem:Ym,colsMenuitemContent:Xm};class Km extends ye{constructor(){super(...arguments),this.refs=[],this.ModalRefs=[],this.setValue=(e,t)=>{this.setState(s=>({...e}),t)},this.showModal=(e,t)=>{let s=this.state.data,r=s.findIndex(o=>o.name===e);r>-1&&(s[r].show=t,this.setValue({data:s},()=>({data:s})))}}initialize(e){this.state={data:[{name:"format.titleCurrency",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleCurrency",!1)},{name:"format.titleDateTime",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleDateTime",!1)},{name:"format.titleNumber",show:!1,group:[{locale:"button.confirm",type:"primary"},{locale:"button.cancel"}],onCancel:()=>this.showModal("format.titleNumber",!1)}]}}setLocale(){const e=this.context.locale;let t=this.state.data;t.forEach(s=>{var r;s.title=e.get(s.name),s.name==="format.titleCurrency"?s.children=e.get("currencyDetail").map(o=>({label:o.name,icon:o.value})):s.name==="format.titleDateTime"?s.children=e.get("dateFmtList").map(o=>({label:o.name,icon:o.value})):s.name==="format.titleNumber"&&(s.children=e.get("numFmtList").map(o=>({label:o.name,icon:o.value}))),(r=s.group)!=null&&r.length&&s.group.forEach(o=>{o.label=e.get(o.locale)})}),this.setState(s=>({data:t}))}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}render(e,t){const{data:s}=t;return m(Je,null,s.map((r,o)=>r.show?m(Lo,{title:r.title,className:jm.formatModal,group:r.group,visible:r.show,onCancel:r.onCancel},r.label,m(Cn,{show:!0,children:r.children,ref:i=>this.refs[o]=i})):m(Je,null)))}}class qm{render(){return Km}}const Zm="univer-layout-wrapper",Jm="univer-layout-wrapper-has-sider",Qm="univer-header-wrapper",e2="univer-footer-wrapper",t2="univer-content-wrapper",n2="univer-sider-wrapper";var vn={layoutWrapper:Zm,layoutWrapperHasSider:Jm,headerWrapper:Qm,footerWrapper:e2,contentWrapper:t2,siderWrapper:n2};class Ks extends ye{constructor(){super(...arguments),this.ref=ge(),this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let e=tf(this.ref.current);const t=e instanceof Array?e:[e];for(const s of t)s.tagName==="ASIDE"&&this.setState({isAside:!0})}}render(e,t){const{children:s,style:r,className:o=""}=e,{isAside:i}=t;return m("section",{style:r,ref:this.ref,className:i?`${vn.layoutWrapper} ${vn.layoutWrapperHasSider} ${o}`:`${vn.layoutWrapper} ${o}`},s)}}const Cc=n=>{const{children:e,style:t,className:s=""}=n;return m("header",{style:t,className:`${vn.headerWrapper} ${s}`},e)},wc=n=>{const{children:e,style:t,className:s=""}=n;return m("footer",{style:t,className:`${vn.footerWrapper} ${s}`},e)},Ec=xo((n,e)=>{const{children:t,style:s,className:r=""}=n;return m("main",{ref:e,style:s,className:`${vn.contentWrapper} ${r}`},t)}),rs=n=>{const{children:e,style:t,className:s=""}=n;return m("aside",{style:t,className:`${vn.siderWrapper} ${s}`},e)};class s2{render(){return Ks}}class r2{render(){return Cc}}class o2{render(){return wc}}class i2{render(){return Ec}}class a2{render(){return rs}}const l2="univer-cols-menu",c2="univer-cols-menuitem",u2="univer-cols-menuitem-line",h2="univer-cols-menuitem-disabled";var Fs={colsMenu:l2,colsMenuitem:c2,colsMenuitemLine:u2,colsMenuitemDisabled:h2};class Tr extends ye{constructor(){super(...arguments),this._MenuRef=ge(),this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(e,t,s)=>{var o,i;const{deep:r=0}=this.props;(o=t.onClick)==null||o.call(null,e,t.value,s,r),(i=this.props.onClick)==null||i.call(null,e,t.value,s,r),this.showMenu(!1)},this.showMenu=e=>{this.setState(t=>({show:e}),()=>{this.getStyle()})},this.mouseEnter=(e,t)=>{const{menu:s=[]}=this.props;s[t].children&&this._refs[t].showMenu(!0)},this.mouseLeave=(e,t)=>{const{menu:s=[]}=this.props;s[t].children&&this._refs[t].showMenu(!1)},this.getStyle=()=>{var a;const e=this._MenuRef.current;if(!e)return;let t={};const s=e.getBoundingClientRect();let r;const{dom:o,parent:i}=this.props;if(r={left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},i){e.style.position="fixed";let c=(a=e.parentElement)==null?void 0:a.getBoundingClientRect();if(!c)return;c.right+s.width>r.right?(t.left=`${c.left-s.width}px`,t.top=`${c.top}px`):(t.left=`${c.right}px`,t.top=`${c.top}px`),this.setState({posStyle:t})}}}initialize(){this.state={show:!1,posStyle:{}}}render(){const{className:e="",style:t="",menu:s,deep:r=0}=this.props,{show:o,posStyle:i}=this.state;return m("ul",{className:ot(Fs.colsMenu,e),style:{...t,...i,display:o?"block":"none"},ref:this._MenuRef},s==null?void 0:s.map((a,c)=>{var l,u;if(!a.hide)return m(Je,null,m("li",{className:ot(Fs.colsMenuitem,(l=a.className)!=null?l:"",a.disabled?Fs.colsMenuitemDisabled:""),style:(u=a.style)!=null?u:"",onClick:h=>this.handleClick(h,a,c),onMouseEnter:h=>{this.mouseEnter(h,c)},onMouseLeave:h=>{this.mouseLeave(h,c)}},a.label,a.children?m(Tr,{ref:h=>this._refs[c]=h,menu:a.children,onClick:a.onClick,className:a.className,style:a.style,parent:this,deep:r+1}):m(Je,null)),a.border?m("div",{className:Fs.colsMenuitemLine}):"")}))}}class d2{render(){return Tr}}const f2="univer-drag",g2="univer-drag-top",m2="univer-drag-bottom",_2="univer-drag-left",b2="univer-drag-right";var p2={drag:f2,dragTop:g2,dragBottom:m2,dragLeft:_2,dragRight:b2};class v2 extends ye{constructor(){super(...arguments),this.root=ge(),this.onMouseMove=e=>{let t=this.state.offsetX,s=this.state.offsetY,r=e.x,o=e.y,i=`${r-t}px`,a=`${o-s}px`;this.setState({top:a,left:i})}}initialize(){this.state={left:"",top:"",width:0,height:0,rootW:0,rootH:0,rootL:0,rootT:0,offsetX:0,offsetY:0}}onMouseUp(e){window.removeEventListener("mousemove",this.onMouseMove)}onMouseDown(e){window.addEventListener("mousemove",this.onMouseMove);let t=e.offsetX,s=e.offsetY;this.setState({offsetX:t,offsetY:s})}getWindowRect(){const e=window.innerWidth||document.documentElement.clientWidth||document.body.clientWidth,t=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight,s=this.root.current.offsetWidth,r=this.root.current.offsetHeight,o=this.root.current.offsetLeft,i=this.root.current.offsetTop,a=`${(t-r)/2}px`,c=`${(e-s)/2}px`;this.setState({width:e,height:t,rootW:s,rootH:r,rootL:o,rootT:i,top:a,left:c})}componentDidMount(){this.props.isDrag&&this.getWindowRect()}render(){const{isDrag:e}=this.props;return m(Je,null,e?m("div",{ref:this.root,className:p2.drag,style:{top:this.state.top,left:this.state.left},onMouseUp:this.onMouseUp.bind(this),onMouseDown:this.onMouseDown.bind(this)},this.props.children):this.props.children)}}const C2="univer-modal-mask",w2="univer-modal-wrapper",E2="univer-modal-darg-wrapper",T2="univer-modal-header",R2="univer-modal-close",D2="univer-modal-body",I2="univer-modal-footer";var dn={modalMask:C2,modalWrapper:w2,modalDargWrapper:E2,modalHeader:T2,modalClose:R2,modalBody:D2,modalFooter:I2};class Lo extends ye{constructor(){super(...arguments),this.handleClickCancel=e=>{e&&e()},this.showModal=e=>{this.setState(t=>({visible:e}))},this.handleClick=e=>{this.showModal(!1),e&&e()}}initialize(){var e;this.state={visible:(e=this.props.visible)!=null?e:!1}}componentWillReceiveProps(e){e.visible!==this.state.visible&&this.setState({visible:e.visible})}render(){const{title:e,width:t=500,top:s=0,style:r,children:o,className:i="",group:a=[],isDrag:c=!1,mask:l=!0,footer:u=!0}=this.props,{visible:h}=this.state;return m(Je,null,h?m("div",{className:i},l?m("div",{className:dn.modalMask,onClick:d=>{var f,g;(g=(f=this.props).onCancel)==null||g.call(f,d),this.showModal(!1)}}):null,m(v2,{isDrag:c},m("div",{className:`${c?dn.modalDargWrapper:dn.modalWrapper}`,style:{width:`${t}px`,...r}},m("div",{className:dn.modalHeader},m("span",null,e),m("span",{className:dn.modalClose,onClick:d=>{var f,g;(g=(f=this.props).onCancel)==null||g.call(f,d),this.showModal(!1)}},m(bc.Close,null))),m("div",{className:dn.modalBody},o),u?m("div",{className:dn.modalFooter},a.map(d=>m(Rt,{type:d.type,onClick:()=>this.handleClick(d.onClick)},d.label))):null))):null)}}class y2{render(){return Lo}}const A2="univer-radio-group",S2="univer-radio-wrap",O2="univer-radio-left",x2="univer-circle",N2="univer-active",M2="univer-fork",k2="univer-label";var xn={radioGroup:A2,radioWrap:S2,radioLeft:O2,circle:x2,active:N2,fork:M2,label:k2};class Tc extends ye{render(){return m("div",{className:xn.radioWrap},m("div",{className:xn.radioLeft},m("div",{onClick:this.props.onClick.bind(this,this.props.value)},m("div",{className:`${xn.circle} ${this.props.active&&xn.active}`},m("div",{className:xn.fork})),m("div",{className:xn.label},this.props.label)),this.props.children))}}class B2{render(){return Tc}}class L2{render(){return Tc}}const F2="univer-select-button",H2="univer-select-button-inner",P2="univer-select-color",z2="univer-select-button-inner-label-icon",U2="univer-select-button-inner-label-string",W2="univer-select-input",V2="univer-select-line",G2="univer-btn",$2="univer-color-picker",Y2="univer-select-double-button",X2="univer-double-buttons";var Oe={selectButton:F2,selectButtonInner:H2,selectColor:P2,selectButtonInnerLabelIcon:z2,selectButtonInnerLabelString:U2,selectInput:W2,selectLine:V2,btn:G2,colorPicker:$2,selectDoubleButton:Y2,doubleButtons:X2};class j2 extends $n{constructor(e){super(e),this.ref=ge(),this.inputRef=ge(),this.colorBtn=ge(),this.showSelect=s=>{s.stopImmediatePropagation();const r=this.ref.current;r&&this.props.selectType===wt.COLOR?r.showSelect(this.colorBtn.current):r&&r.showSelect(),window.addEventListener("click",this.hide,!0)},this.hide=s=>{!this.ref.current||!this.ref.current.ulRef&&!this.ref.current.ulRef.current||this.ref.current.ulRef.current.contains(s.target)||this.hideSelect(s)},this.hideSelect=s=>{this.ref.current.hideSelect(s),window.removeEventListener("click",this.hide,!0)},this.changeValue=s=>{this.setState(r=>({...s}))},this.update=s=>{const r=typeof this.props.label,o=this.state.children;let i;o==null||o.forEach((a,c)=>{a.value===s?(a.selected=!0,this.props.needChange&&(this.setState({label:r==="string"?a.label:a.icon}),i=a.label)):a.selected=!1}),this.setState({children:o}),this.props.selectType===wt.INPUT_NUMBER&&this.inputRef.current.setValue(i)},this.handleClick=(...s)=>{var l,u;const r=typeof this.props.label;this.hideSelect(s[0]);const{item:o,index:i}=s[1],a=this.state.children;a==null||a.forEach(h=>h.selected=!1),a[i].selected=!0;let c=a[i].label;if(this.setState({children:a}),this.props.needChange){this.setState({label:r==="string"?c:o.icon}),[wt.INPUT,wt.INPUT_NUMBER].includes(this.props.selectType)&&this.inputRef.current.setValue(c);const h=this.props.children;if(h[10]&&h[10].locale==="borderLine.borderColor"){let g=h[10].children[0].value,b=h[11].value;(l=this.props.onClick)==null||l.call(this,a[i].hasOwnProperty("value")?a[i].value:a[i].label,g,b);return}}(u=this.props.onClick)==null||u.call(this,a[i].hasOwnProperty("value")?a[i].value:a[i].label)},this.handleButtonClick=()=>{var i,a,c,l;const s=this.state.children,r=s==null?void 0:s.find(u=>u.selected===!0),o=this.props.children;if(this.props.selectType==="color")(i=this.props.onClick)==null||i.call(this,this.state.selectColor);else if(o&&o[10]&&o[10].locale==="borderLine.borderColor"){let d=o[10].children[0].value,f=o[11].value;r&&((a=this.props.onClick)==null||a.call(this,r.hasOwnProperty("value")?r.value:r.label,d,f));return}else if(o&&o[0]&&o[0].locale&&o[0].locale.indexOf("merge")>-1){(c=this.props.onClick)==null||c.call(this,"all");return}r&&((l=this.props.onClick)==null||l.call(this,r.hasOwnProperty("value")?r.value:r.label))},this.handleKeyUp=s=>{var r;if(s.key==="Enter"){this.props.selectType===wt.INPUT_NUMBER&&this.inputRef.current.base.blur();const o=s.currentTarget.value;this.update(o),this.hideSelect(s),(r=this.props.onKeyUp)==null||r.call(this,o)}},this.state={label:"",children:[],selectColor:"#000"};const{triggerUpdate:t}=e;t&&t(this.update.bind(this))}componentWillMount(){this.changeValue({label:this.props.label,children:this.props.children})}render(e){const{icon:t,tooltip:s,selectType:r,border:o,slot:i,style:a,onClick:c}=e;return this.state.label,r===wt.INPUT||r===wt.INPUT_NUMBER?m("div",{className:Oe.selectButton},m("div",{className:Oe.selectInput},m(Rs,{type:r===wt.INPUT_NUMBER?"number":"text",value:this.state.label,onClick:this.showSelect,ref:this.inputRef,bordered:!1,onKeyUp:this.handleKeyUp}),m("span",{onClick:this.showSelect},t)),o?m("div",{className:Oe.selectLine}):"",m(Cn,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):r===wt.DOUBLE?m("div",{className:`${Oe.selectButton} ${Oe.selectDoubleButton}`},m("div",{style:{display:"flex",alignItems:"center"}},m(tn,{title:s,placement:"bottom"},m(Rt,{type:"text",onClick:this.handleButtonClick},m("div",{className:Oe.selectButtonInner},m("div",{className:typeof this.state.label=="string"?Oe.selectButtonInnerLabelString:Oe.selectButtonInnerLabelIcon},this.state.label)))),m(tn,{title:this.props.tooltipRight,placement:"bottom"},m(Rt,{type:"text",onClick:this.showSelect,className:Oe.doubleButtons},m("div",{className:Oe.selectButtonInner},t)))),o?m("div",{className:Oe.selectLine}):"",m(Cn,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a})):r===wt.COLOR?m("div",{className:`${Oe.selectButton} ${Oe.selectDoubleButton}`,ref:this.colorBtn},m("div",{style:{display:"flex",alignItems:"center"}},m(tn,{title:s,placement:"bottom"},m(Rt,{type:"text",onClick:this.handleButtonClick},m("div",{className:Oe.selectButtonInner},m("div",{className:typeof this.state.label=="string"?Oe.selectButtonInnerLabelString:Oe.selectButtonInnerLabelIcon},this.state.label),m("div",{className:Oe.selectColor,style:{backgroundColor:this.state.selectColor}})))),m(tn,{title:this.props.tooltipRight,placement:"bottom"},m(Rt,{type:"text",onClick:this.showSelect,className:Oe.doubleButtons},m("div",{className:Oe.selectButtonInner},t)))),o?m("div",{className:Oe.selectLine}):"",m(Xn,{color:"#000",onClick:l=>{this.setState({selectColor:l},()=>{c&&c(this.state.selectColor)})},slot:i,ref:this.ref})):m("div",{className:Oe.selectButton},m(tn,{title:s,placement:"bottom"},m(Rt,{type:"text",onClick:this.showSelect},m("div",{className:Oe.selectButtonInner},m("div",{className:typeof this.state.label=="string"?Oe.selectButtonInnerLabelString:Oe.selectButtonInnerLabelIcon},this.state.label),t))),o?m("div",{className:Oe.selectLine}):"",m(Cn,{children:this.state.children,onClick:this.handleClick,ref:this.ref,style:a}))}}class K2{render(){return j2}}const q2="univer-dropdown",Z2="univer-drop-content",J2="univer-drop-icon";var Hr={dropdown:q2,dropContent:Z2,dropIcon:J2};class mn extends ye{constructor(){super(...arguments),this.MenuRef=ge(),this.DropRef=ge(),this.IconRef=ge(),this.handleClick=e=>{var s,r,o;(r=(s=this.props).onClick)==null||r.call(s);const{icon:t}=this.props;t||(o=this.MenuRef.current)==null||o.showMenu(!0)},this.handleSubClick=()=>{var e;(e=this.MenuRef.current)==null||e.showMenu(!0)},this.hideMenu=e=>{var t,s;(!this.DropRef.current||!((t=this.DropRef.current)!=null&&t.contains(e.target)))&&((s=this.MenuRef.current)==null||s.showMenu(!1))}}initialize(){this.state={menuStyle:{}}}componentDidMount(){const{placement:e}=this.props;let t={position:"absolute"};!e||e==="Bottom"?(t.left=0,t.top="100%"):e==="Top"?(t.left=0,t.top="-100%"):e==="Left"?(t.left="-100%",t.top=0):(t.left="100%",t.top=0),this.setState({menuStyle:t}),window.addEventListener("click",this.hideMenu)}componentWillUnmount(){window.removeEventListener("click",this.hideMenu)}render(){const{children:e,menu:t,showArrow:s,icon:r,tooltip:o}=this.props,{menuStyle:i}=this.state;return m("div",{className:Hr.dropdown,ref:this.DropRef},m(tn,{title:o,placement:"bottom"},m("div",{className:Hr.dropContent,onClick:this.handleClick},e,s?m(Es.NextIcon,null):"")),r?m("div",{ref:this.IconRef,className:Hr.dropIcon,onClick:this.handleSubClick},r):"",m(Tr,{onClick:t.onClick,ref:this.MenuRef,menu:t.menu,className:t.className,style:{...t.style,...i}}))}}class Q2{render(){return mn}}const e_="univer-sider-modal",t_="univer-sider-modal-header",n_="univer-sider-modal-title",s_="univer-sider-modal-close",r_="univer-sider-modal-body",o_="univer-sider-modal-body-inner",i_="univer-sider-modal-footer";var fn={siderModal:e_,siderModalHeader:t_,siderModalTitle:n_,siderModalClose:s_,siderModalBody:r_,siderModalBodyInner:o_,siderModalFooter:i_};class a_ extends ye{initialize(e){this.state={}}close(){this._context.getPluginManager().getPluginByName("spreadsheet").showSiderByName(this.props.pluginName,!1),this.props.closeSide&&this.props.closeSide()}render(e){const{className:t="",style:s}=e;return m("div",{className:`${fn.siderModal} ${t}`,style:{...s}},m("div",{className:fn.siderModalHeader},m("h3",{className:fn.siderModalTitle},this.props.title),m("span",{className:fn.siderModalClose,onClick:()=>this.close()},m(bc.Close,null))),m("div",{className:fn.siderModalBody},m("div",{className:fn.siderModalBodyInner},this.props.children)),m("div",{className:fn.siderModalFooter},this.props.footer))}}class l_{render(){return a_}}const c_="univer-slider",u_="univer-sr-only";var Nn={slider:c_,srOnly:u_};class h_ extends ye{constructor(){super(...arguments),this.ref=ge(),this.onInput=(e,t)=>{var o;const r=t.target.value;this.changeInputValue(e,r),(o=this.props.onChange)==null||o.call(this,t)},this.onClick=(e,t)=>{var u;const{min:s=0,max:r=100,step:o=1}=this.props,i=t.currentTarget;let a=t.offsetX;const c=i.offsetWidth;if(a<0||a>c)return;let l=a/this.width*(r-s);l%o&&(l+=o-l%o),this.changeInputValue(e,l),(u=this.props.onClick)==null||u.call(this,t,l)},this.changeInputValue=(e,t)=>{let s=this.ref.current,o=s.getElementsByTagName("input")[e].id;s.style.setProperty(`--${o}`,t),e?this.setValue({valueNext:t}):this.setValue({valuePrev:t})},this.setValue=(e,t)=>{this.setState(s=>({...e}),t)}}initialize(e){this.state={valuePrev:0,valueNext:0}}componentWillMount(){this.idPrev=Qr("slider"),this.idNext=Qr("slider")}componentDidMount(){const{min:e=0,max:t=100,range:s}=this.props;let r=t-e,o=this.ref.current;if(this.width=o.offsetWidth,o.style.cssText+=`--${this.idPrev}: ${this.state.valuePrev}; --${this.idNext}: ${this.state.valueNext}`,document.styleSheets[0].addRule(`.${Nn.slider}::after`,`margin-left: calc((var(--${this.idNext}) - ${e})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${Nn.slider}::after {margin-left: calc((var(--${this.idNext}) - ${e})/${r}*100%); width: calc((var(--${this.idPrev}) - var(--${this.idNext}))/${r}*100%);}`,0),document.styleSheets[0].addRule(`.${Nn.slider}::before`,`margin-left: calc((var(--${this.idPrev}) - ${e})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);`),document.styleSheets[0].insertRule(`.${Nn.slider}::before {margin-left: calc((var(--${this.idPrev}) - ${e})/${r}*100%);width: calc((var(--${this.idNext}) - var(--${this.idPrev}))/${r}*100%);}`,0),s){let{value:i}=this.props;i=i||[0,0],this.setValue({valuePrev:i[0],valueNext:i[1]})}else{let{value:i}=this.props;i=i||0,this.changeInputValue(0,i)}}render(e,t){const{valuePrev:s,valueNext:r}=t,{step:o=1,min:i=0,max:a=100,range:c=!1}=e;return c?m("div",{className:Nn.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":a},ref:this.ref},m("label",{class:"sr-only",for:this.idPrev}),m("input",{id:this.idPrev,type:"range",min:i,value:s,max:a,step:o,onInput:l=>this.onInput(0,l)}),m("label",{class:"sr-only",for:this.idNext}),m("input",{id:this.idNext,type:"range",min:i,value:r,max:a,step:o,onInput:l=>this.onInput(1,l)})):m("div",{className:Nn.slider,role:"group","aria-labelledby":"multi-lbl",style:{"--min":i,"--max":a},ref:this.ref,onClick:l=>this.onClick(0,l)},m("label",{class:"sr-only",for:this.idPrev}),m("input",{id:this.idPrev,type:"range",min:i,value:s,max:a,step:o,onInput:l=>this.onInput(0,l)}))}}class d_{render(){return h_}}const f_="univer-tabs",g_="univer-tabs-nav",m_="univer-tabs-nav-wrap",__="univer-tabs-nav-list",b_="univer-tabs-tab",p_="univer-tabs-tab-active",v_="univer-tabs-content",C_="univer-tabs-panel",w_="univer-tabs-panel-active",E_="univer-tabs-card";var Et={tabs:f_,tabsNav:g_,tabsNavWrap:m_,tabsNavList:__,tabsTab:b_,tabsTabActive:p_,tabsContent:v_,tabsPanel:C_,tabsPanelActive:w_,tabsCard:E_};class T_ extends $n{constructor(){super(...arguments),this.state={active:""},this.setValue=(e,t)=>{this.setState(s=>({...e}),t)},this.parseNavList=()=>{const{active:e}=this.state;return kt(this.props.children).map(t=>{const{tab:s,keys:r}=t.props,o=`${Qr("tab")}-${r}`;return e===r?m("div",{id:o,onClick:this.handleClick,className:ot(Et.tabsTab,Et.tabsTabActive)},s):m("div",{id:o,onClick:this.handleClick,className:Et.tabsTab},s)})},this.handleClick=e=>{var o,i;const t=e.target.id,s=t.lastIndexOf("-"),r=t.slice(s+1);this.setValue({active:r}),(i=(o=this.props).onTabClick)==null||i.call(o,r,e)}}componentWillMount(){this.setValue({active:this.props.activeKey,children:this.props.children})}render(e,t){const{children:s,type:r="line",className:o=""}=e,i=ot(Et.tabs,{[`${Et.tabs}-card`]:r==="card"},o);return m("div",{className:i},m("div",{className:Et.tabsNav},m("div",{className:Et.tabsNavWrap},m("div",{className:Et.tabsNavList},this.parseNavList()))),m("div",{className:Et.tabsContent},s.map(a=>m(Rc,{keys:a.props.keys,active:a.props.keys===this.state.active},a.props.children))))}}const Rc=n=>{const{id:e,keys:t,style:s,children:r,active:o}=n;return m("div",{id:e&&`${e}-panel-${t}`,role:"tabpanel",style:{...s},className:ot(Et.tabsPanel,o&&Et.tabsPanelActive)},o&&r)};class R_{render(){return T_}}class D_{render(){return Rc}}const I_="univer-tooltip-Group",y_="univer-tooltip-title",A_="univer-tooltip-body",S_="univer-tooltip-ss",O_="univer-top",x_="univer-tooltip-triangle",N_="univer-right",M_="univer-bottom",k_="univer-left";var on={tooltipGroup:I_,tooltipTitle:y_,tooltipBody:A_,tooltipSs:S_,top:O_,tooltipTriangle:x_,right:N_,bottom:M_,left:k_};const B_={top:on.top,bottom:on.bottom,left:on.left,right:on.right};class tn extends ye{constructor(){super(...arguments),this.tooltip=ge()}initialize(e){this.state={placement:e.placement||"top",placementClassName:ot(on.tooltipTitle,B_[e.placement||"top"]),top:"",left:""}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let e=this.tooltip.current.getBoundingClientRect(),t=e.height,s=e.width;this.state.placement==="bottom"?this.setState({top:t+10,left:s/2}):this.state.placement==="left"?this.setState({top:t/2,left:s+5}):this.state.placement==="right"?this.setState({top:t/2,left:-s-10}):this.setState({top:-t-20,left:s/2})}}render(){return m("div",{ref:this.tooltip,className:on.tooltipGroup,style:this.props.styles},m("div",{className:on.tooltipBody,onMouseEnter:this.handleMouseOver.bind(this)},this.props.children),this.props.title?m("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`}},this.props.title,m("span",{className:on.tooltipTriangle})):null)}}class L_{render(){return tn}}const F_="univer-cols-menu",H_="univer-cols-menu-jsx",P_="univer-cols-menuitem",z_="univer-line",U_="univer-cols-menuitem-content",W_="univer-ul-icon",V_="univer-submenu-arrow",G_="univer-icon-rightIcon";var xt={colsMenu:F_,colsMenuJsx:H_,colsMenuitem:P_,line:z_,colsMenuitemContent:U_,ulIcon:W_,submenuArrow:V_,iconRightIcon:G_};class Cn extends ye{constructor(){super(...arguments),this.refs=[],this.ulRef=ge(),this.filterChildren=e=>{let t;return Array.from(e.children).forEach(s=>{s.nodeName==="UL"&&(t=!0)}),t},this.mouseOver=(e,t)=>{this.refs.forEach(r=>{r.hideSelect()});const s=e.currentTarget;!this.filterChildren(s)||this.refs[t].showSelect()},this.mouseLeave=(e,t)=>{(this.refs[t]?this.refs[t].props.children[0].selectType:"")!=="jsx"&&this.refs.forEach(r=>{r.hideSelect()})},this.handleClick=(e,{item:t,index:s,ref:r},o)=>{e.stopImmediatePropagation(),o==null||o.call(this,e,{item:t,index:s,ref:r})},this.handleKeyUp=(e,{item:t,index:s,ref:r},o)=>{e.stopImmediatePropagation(),o==null||o.call(this,e,{item:t,index:s,ref:r})},this.sendParent=()=>this,this.hideSelect=()=>{var e;window.removeEventListener("resize",this.resizeUl),((e=this.state.style)==null?void 0:e.display)!=="none"&&(this.refs.forEach(t=>{t.hideSelect()}),this.setState(t=>({style:{display:"none"}})))},this.showSelect=()=>{window.addEventListener("resize",this.resizeUl),this.setState(e=>({style:{display:"inline-block"}}),()=>{this.getStyle()})},this.getStyle=()=>{var u;const e=(u=this.ulRef.current)==null?void 0:u.parentElement,t=this.ulRef.current;let s={},r;if(!t||!e)return;const o=t.getBoundingClientRect();let i=e==null?void 0:e.getBoundingClientRect();r=this.getContext().getPluginManager().getPluginByName("spreadsheet").getSheetContainerControl().getContentRef().current.getBoundingClientRect(),!(!r||!i)&&((e==null?void 0:e.nodeName)==="LI"?(t.style.position="fixed",i=e==null?void 0:e.getBoundingClientRect(),i.right+o.width>r.right?(s.left=`${i.left-o.width}px`,s.top=`${i.top}px`):(s.left=`${i.right}px`,s.top=`${i.top}px`)):(e==null?void 0:e.nodeName)==="DIV"&&(i.right+o.width>r.right||i.right+o.width>document.documentElement.clientWidth?(s.right="0",s.left="auto"):(s.left="0",s.right="auto"),o.top>=r.bottom&&(s.top="auto",s.bottom="100%")),this.setState(h=>({posStyle:s})))},this.showIcon=e=>"selected"in e||"hidden"in e?e.selected?m("span",{className:xt.ulIcon},m(Es.CorrectIcon,{style:{fontSize:"13px"}})):e.hidden?m("span",{className:xt.ulIcon},m(Es.HideIcon,{style:{fontSize:"13px"}})):m("span",{className:xt.ulIcon}):"",this.getIcon=e=>{let t=e;return typeof t=="string"&&/Icon$/.test(t)&&(t=Gg[t]),m("span",{className:xt.submenuArrow},t)},this.getParent=()=>{var e;return(e=this.props.getParent())!=null?e:null}}initialize(e){this.state={style:{display:"none"},posStyle:{}},this.resizeUl=Xs(this.getStyle,200)}componentWillMount(){const{show:e=!1}=this.props;e&&this.setState(t=>({style:{display:"inline-block"}}))}render(e,t){var l;const{children:s,onClick:r,style:o,onKeyUp:i}=e,{posStyle:a}=t,c=Object.assign((l=this.state.style)!=null?l:{},a,o||{});return s!=null&&s.length?(s.some((u,h)=>u.selected?(s.forEach((d,f)=>{h!==f&&(d.selected=!1)}),!0):!1),m("ul",{className:s[0].selectType==="jsx"?xt.colsMenuJsx:xt.colsMenu,style:{...c},ref:this.ulRef},s==null?void 0:s.map((u,h)=>{var f;let d=u.className?`${xt.colsMenuitem} ${u.className}`:xt.colsMenuitem;if(!u.hideLi)return m("li",{className:d,style:{...u.style},onClick:g=>{g.stopPropagation(),this.handleClick(g,{item:u,index:h,ref:this},u.onClick?u.onClick:r)},onMouseEnter:g=>{this.mouseOver(g,h)},onMouseLeave:g=>{this.mouseLeave(g,h)},onKeyUp:g=>{this.handleKeyUp(g,{item:u,index:h,ref:this},u.onKeyUp?u.onKeyUp:i)}},m("div",{className:u.selectType==="jsx"?"":xt.colsMenuitemContent},this.showIcon(u),m("div",null,u.selectType==="jsx"?m("span",null,er(u.label,{onChange:this.getStyle})):m("span",null,u.label),u.icon?this.getIcon(u.icon):"")),(f=u.children)!=null&&f.length?m(Cn,{children:u.children,onClick:u.onClick,ref:g=>this.refs[h]=g,getParent:this.sendParent}):m(Je,null),u.border?m("div",{className:xt.line}):"")}))):m(Je,null)}}class $_{render(){return Cn}}class Y_ extends fr{constructor(){super("ComponentSheet")}getComponentRender(){return new X_(this.getComponentFactory())}getComponentFactory(){return new j_}}class X_{constructor(e){this._componentFactory=e}renderForwardFn(e){return this._componentFactory.createComponent(e).render()}renderClass(e){return this._componentFactory.createComponent(e).render()}renderFunction(e){return this._componentFactory.createComponent(e).render()}}class j_{createComponent(e){switch(e){case"Button":return new t0;case"Select":return new K2;case"Container":return new Vm;case"CellRangeModal":return new S0;case"Modal":return new y2;case"SiderModal":return new l_;case"Layout":return new s2;case"Header":return new r2;case"Footer":return new o2;case"Content":return new i2;case"Sider":return new a2;case"Checkbox":return new F0;case"CheckboxGroup":return new P0;case"ColorPicker":return new Fm;case"ColorPickerCircleButton":return new Wm;case"Input":return new vm;case"Radio":return new B2;case"RadioGroup":return new L2;case"Tab":return new R_;case"TabPane":return new D_;case"Tooltip":return new L_;case"Ul":return new $_;case"Collapse":return new j0;case"Panel":return new K0;case"FormatModal":return new qm;case"Menu":return new d2;case"Dropdown":return new Q2;case"NextIcon":return new $1;case"RightIcon":return new Y1;case"OrderIcon":return new ug;case"CommentIcon":return new bg;case"ConditionalFormatIcon":return new vg;case"ScreenshotIcon":return new Lg;case"CheckIcon":return new _g;case"SearchIcon":return new Eg;case"ReplaceIcon":return new wg;case"FreezeIcon":return new pg;case"PivotableIcon":return new lg;case"FillColorIcon":return new jf;case"BoldIcon":return new xf;case"FullBorderIcon":return new Kf;case"TopBorderIcon":return new qf;case"BottomBorderIcon":return new Zf;case"LeftBorderIcon":return new Jf;case"RightBorderIcon":return new Qf;case"NoneBorderIcon":return new e1;case"OuterBorderIcon":return new t1;case"InnerBorderIcon":return new n1;case"StripingBorderIcon":return new s1;case"VerticalBorderIcon":return new r1;case"MergeIcon":return new o1;case"SumIcon":return new cg;case"OrderDESCIcon":return new hg;case"OrderASCIcon":return new dg;case"FilterIcon":return new fg;case"FilterRankIcon":return new gg;case"CleanIcon":return new mg;case"DeleteIcon":return new Ug;case"DeleteLineIcon":return new Mf;case"UnderLineIcon":return new kf;case"ItalicIcon":return new Nf;case"TextColorIcon":return new Bf;case"BackIcon":return new W1;case"ForwardIcon":return new V1;case"FormatIcon":return new G1;case"CorrectIcon":return new X1;case"LtIcon":return new j1;case"CloseIcon":return new K1;case"DropDownIcon":return new q1;case"MenuIcon":return new Z1;case"HideIcon":return new J1;case"PhotoIcon":return new P1;case"LinkIcon":return new z1;case"ChartIcon":return new U1;case"LoadingIcon":return new cf;case"LogoIcon":return new hf;case"AddNumIcon":return new vf;case"ReduceNumIcon":return new Cf;case"PercentIcon":return new wf;case"MoneyIcon":return new Ef;case"FxIcon":return new Tf;case"AddIcon":return new Rf;case"ReduceIcon":return new Df;case"DivideIcon":return new Cg;case"LockIcon":return new Tg;case"LocationIcon":return new Rg;case"PageIcon":return new Dg;case"RegularIcon":return new Ig;case"LayoutIcon":return new yg;case"TableIcon":return new Ag;case"ImageIcon":return new Pg;case"LeftAlignIcon":return new w1;case"CenterAlignIcon":return new E1;case"RightAlignIcon":return new T1;case"TopVerticalIcon":return new R1;case"CenterVerticalIcon":return new D1;case"BottomVerticalIcon":return new I1;case"TextRotateIcon":return new y1;case"TextRotateAngleUpIcon":return new A1;case"TextRotateAngleDownIcon":return new S1;case"TextRotateVerticalIcon":return new O1;case"TextRotateRotationUpIcon":return new x1;case"TextRotateRotationDownIcon":return new N1;case"BrIcon":return new M1;case"OverflowIcon":return new k1;case"CutIcon":return new B1;case"PrintIcon":return new Bg;case"PrintAreaIcon":return new Fg;case"PrintTitleIcon":return new Hg;case"BorderDashDot":return new d0;case"BorderDashDotDot":return new g0;case"BorderDashed":return new u0;case"BorderDotted":return new l0;case"BorderHair":return new i0;case"BorderMedium":return new _0;case"BorderMediumDashDot":return new C0;case"BorderMediumDashDotDot":return new E0;case"BorderMediumDashed":return new p0;case"BorderThick":return new R0;case"BorderThin":return new r0;case"Slider":return new d_}throw new Error("Not Found Component")}}var K_={spreadsheetLabel:"\u63D2\u4EF6",spreadsheetRightLabel:"\u66F4\u591A Sheets",spreadsheet:{one:"\u4E00",two:"\u4E8C",three:"\u4E09"},toolbar:{undo:"\u64A4\u9500",redo:"\u91CD\u505A",paintFormat:"\u683C\u5F0F\u5237",currencyFormat:"\u8D27\u5E01\u683C\u5F0F",percentageFormat:"\u767E\u5206\u6BD4\u683C\u5F0F",numberDecrease:"\u51CF\u5C11\u5C0F\u6570\u4F4D\u6570",numberIncrease:"\u589E\u52A0\u5C0F\u6570\u4F4D\u6570",moreFormats:"\u66F4\u591A\u683C\u5F0F",font:"\u5B57\u4F53",fontSize:"\u5B57\u53F7\u5927\u5C0F",bold:"\u7C97\u4F53 (Ctrl+B)",italic:"\u659C\u4F53 (Ctrl+I)",strikethrough:"\u5220\u9664\u7EBF (Alt+Shift+5)",underline:"\u4E0B\u5212\u7EBF",textColor:{main:"\u6587\u672C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},resetColor:"\u91CD\u7F6E\u989C\u8272",customColor:"\u81EA\u5B9A\u4E49",alternatingColors:"\u4EA4\u66FF\u989C\u8272",confirmColor:"\u786E\u5B9A\u989C\u8272",cancelColor:"\u53D6\u6D88",collapse:"\u6536\u8D77",fillColor:{main:"\u5355\u5143\u683C\u989C\u8272",right:"\u989C\u8272\u9009\u62E9"},border:{main:"\u8FB9\u6846",right:"\u8FB9\u6846\u7C7B\u578B"},mergeCell:{main:"\u5408\u5E76\u5355\u5143\u683C",right:"\u9009\u62E9\u5408\u5E76\u7C7B\u578B"},horizontalAlignMode:{main:"\u6C34\u5E73\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},verticalAlignMode:{main:"\u5782\u76F4\u5BF9\u9F50",right:"\u5BF9\u9F50\u65B9\u5F0F"},textWrapMode:{main:"\u6587\u672C\u6362\u884C",right:"\u6362\u884C\u65B9\u5F0F"},textRotateMode:{main:"\u6587\u672C\u65CB\u8F6C",right:"\u65CB\u8F6C\u65B9\u5F0F"},freezeTopRow:"\u51BB\u7ED3\u9996\u884C",sortAndFilter:"\u6392\u5E8F\u548C\u7B5B\u9009",findAndReplace:"\u67E5\u627E\u66FF\u6362",sum:"\u6C42\u548C",autoSum:"\u81EA\u52A8\u6C42\u548C",moreFunction:"\u66F4\u591A\u51FD\u6570",conditionalalFormat:"\u6761\u4EF6\u683C\u5F0F",comment:"\u6279\u6CE8",pivotTable:"\u6570\u636E\u900F\u89C6\u8868",chart:"\u56FE\u8868",screenshot:"\u622A\u56FE",splitColumn:"\u5206\u5217",insertImage:"\u63D2\u5165\u56FE\u7247",insertLink:"\u63D2\u5165\u94FE\u63A5",dataValidation:"\u6570\u636E\u9A8C\u8BC1",protection:"\u4FDD\u62A4\u5DE5\u4F5C\u8868\u5185\u5BB9",clearText:"\u6E05\u9664\u989C\u8272\u9009\u62E9",noColorSelectedText:"\u6CA1\u6709\u989C\u8272\u88AB\u9009\u62E9",toolMore:"\u66F4\u591A",toolLess:"\u5C11\u4E8E",toolClose:"\u6536\u8D77",toolMoreTip:"\u66F4\u591A\u529F\u80FD",moreOptions:"\u66F4\u591A\u9009\u9879",cellFormat:"\u8BBE\u7F6E\u5355\u5143\u683C\u683C\u5F0F",print:"\u6253\u5370",borderMethod:{top:"\u4E0A\u6846\u7EBF",bottom:"\u4E0B\u6846\u7EBF",left:"\u5DE6\u6846\u7EBF",right:"\u53F3\u6846\u7EBF"},more:"\u66F4\u591A"},defaultFmt:{Automatic:{text:"\u81EA\u52A8",value:"General",example:""},Number:{text:"\u6570\u5B57",value:"##0.00",example:"1000.12"},Percent:{text:"\u767E\u5206\u6BD4",value:"#0.00%",example:"12.21%"},PlainText:{text:"\u7EAF\u6587\u672C",value:"@",example:""},Scientific:{text:"\u79D1\u5B66\u8BA1\u6570",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"\u4F1A\u8BA1",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"\u4E07\u5143",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"\u8D27\u5E01",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"\u65E5\u671F",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"\u65F6\u95F4",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"\u65F6\u95F424H",value:"hh:mm",example:"15:00"},DateTime:{text:"\u65E5\u671F\u65F6\u95F4",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"\u65E5\u671F\u65F6\u95F424H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"\u81EA\u5B9A\u4E49\u683C\u5F0F",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"\u66F4\u591A\u8D27\u5E01\u683C\u5F0F",moreDateTime:"\u66F4\u591A\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",moreNumber:"\u66F4\u591A\u6570\u5B57\u683C\u5F0F",titleCurrency:"\u8D27\u5E01\u683C\u5F0F",decimalPlaces:"\u5C0F\u6570\u4F4D\u6570",titleDateTime:"\u65E5\u671F\u4E0E\u65F6\u95F4\u683C\u5F0F",titleNumber:"\u6570\u5B57\u683C\u5F0F"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"\u5FAE\u8F6F\u96C5\u9ED1",SimSun:"\u5B8B\u4F53",SimHei:"\u9ED1\u4F53",Kaiti:"\u6977\u4F53",FangSong:"\u4EFF\u5B8B",NSimSun:"\u65B0\u5B8B\u4F53",STXinwei:"\u534E\u6587\u65B0\u9B4F",STXingkai:"\u534E\u6587\u884C\u6977",STLiti:"\u534E\u6587\u96B6\u4E66",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"\u5E38\u89C4\u89C6\u56FE",layoutBtn:"\u9875\u9762\u5E03\u5C40",pageBtn:"\u5206\u9875\u9884\u89C8",menuItemPrint:"\u6253\u5370(Ctrl+P)",menuItemAreas:"\u6253\u5370\u533A\u57DF",menuItemRows:"\u6253\u5370\u6807\u9898\u884C",menuItemColumns:"\u6253\u5370\u6807\u9898\u5217"},align:{left:"\u5DE6\u5BF9\u9F50",center:"\u4E2D\u95F4\u5BF9\u9F50",right:"\u53F3\u5BF9\u9F50",top:"\u9876\u90E8\u5BF9\u9F50",middle:"\u5C45\u4E2D\u5BF9\u9F50",bottom:"\u5E95\u90E8\u5BF9\u9F50"},button:{confirm:"\u786E\u5B9A",cancel:"\u53D6\u6D88",close:"\u5173\u95ED",update:"Update",delete:"Delete",insert:"\u65B0\u5EFA",prevPage:"\u4E0A\u4E00\u9875",nextPage:"\u4E0B\u4E00\u9875",total:"\u603B\u5171\uFF1A"},punctuation:{tab:"Tab \u952E",semicolon:"\u5206\u53F7",comma:"\u9017\u53F7",space:"\u7A7A\u683C"},colorPicker:{collapse:"\u6536\u8D77",customColor:"\u81EA\u5B9A\u4E49",change:"\u5207\u6362",confirmColor:"\u786E\u5B9A",cancelColor:"\u53D6\u6D88"},borderLine:{borderTop:"\u4E0A\u6846\u7EBF",borderBottom:"\u4E0B\u6846\u7EBF",borderLeft:"\u5DE6\u6846\u7EBF",borderRight:"\u53F3\u6846\u7EBF",borderNone:"\u65E0",borderAll:"\u6240\u6709",borderOutside:"\u5916\u4FA7",borderInside:"\u5185\u4FA7",borderHorizontal:"\u5185\u4FA7\u6A2A\u7EBF",borderVertical:"\u5185\u4FA7\u7AD6\u7EBF",borderColor:"\u8FB9\u6846\u989C\u8272",borderSize:"\u8FB9\u6846\u7C97\u7EC6"},merge:{all:"\u5168\u90E8\u5408\u5E76",vertical:"\u5782\u76F4\u5408\u5E76",horizontal:"\u6C34\u5E73\u5408\u5E76",cancel:"\u53D6\u6D88\u5408\u5E76",overlappingError:"\u4E0D\u80FD\u5408\u5E76\u91CD\u53E0\u533A\u57DF",partiallyError:"\u65E0\u6CD5\u5BF9\u90E8\u5206\u5408\u5E76\u5355\u5143\u683C\u6267\u884C\u6B64\u64CD\u4F5C"},textWrap:{overflow:"\u6EA2\u51FA",wrap:"\u81EA\u52A8\u6362\u884C",clip:"\u622A\u65AD"},textRotate:{none:"\u65E0\u65CB\u8F6C",angleUp:"\u5411\u4E0A\u503E\u659C",angleDown:"\u5411\u4E0B\u503E\u659C",vertical:"\u7AD6\u6392\u6587\u5B57",rotationUp:"\u5411\u4E0A90\xB0",rotationDown:"\u5411\u4E0B90\xB0"},sheetConfig:{delete:"\u5220\u9664",copy:"\u590D\u5236",rename:"\u91CD\u547D\u540D",changeColor:"\u66F4\u6539\u989C\u8272",hide:"\u9690\u85CF",unhide:"\u53D6\u6D88\u9690\u85CF",moveLeft:"\u5411\u5DE6\u79FB",moveRight:"\u5411\u53F3\u79FB",resetColor:"\u91CD\u7F6E\u989C\u8272",cancelText:"\u53D6\u6D88",chooseText:"\u786E\u5B9A\u989C\u8272",tipNameRepeat:"\u6807\u7B7E\u9875\u7684\u540D\u79F0\u4E0D\u80FD\u91CD\u590D\uFF01\u8BF7\u91CD\u65B0\u4FEE\u6539",noMoreSheet:"\u5DE5\u4F5C\u8584\u5185\u81F3\u5C11\u542B\u6709\u4E00\u5F20\u53EF\u89C6\u5DE5\u4F5C\u8868\u3002\u82E5\u9700\u5220\u9664\u9009\u5B9A\u7684\u5DE5\u4F5C\u8868\uFF0C\u8BF7\u5148\u63D2\u5165\u4E00\u5F20\u65B0\u5DE5\u4F5C\u8868\u6216\u663E\u793A\u4E00\u5F20\u9690\u85CF\u7684\u5DE5\u4F5C\u8868\u3002",confirmDelete:"\u662F\u5426\u5220\u9664",redoDelete:"\u53EF\u4EE5\u901A\u8FC7Ctrl+Z\u64A4\u9500\u5220\u9664",noHide:"\u4E0D\u80FD\u9690\u85CF, \u81F3\u5C11\u4FDD\u7559\u4E00\u4E2Asheet\u6807\u7B7E",chartEditNoOpt:"\u56FE\u8868\u7F16\u8F91\u6A21\u5F0F\u4E0B\u4E0D\u5141\u8BB8\u8BE5\u64CD\u4F5C\uFF01",sheetNameSpecCharError:`\u540D\u79F0\u4E0D\u80FD\u8D85\u8FC731\u4E2A\u5B57\u7B26\uFF0C\u9996\u5C3E\u4E0D\u80FD\u662F' \u4E14\u540D\u79F0\u4E0D\u80FD\u5305\u542B:\r
[ ] : \\ ? * /`,sheetNameCannotIsEmptyError:"\u540D\u79F0\u4E0D\u80FD\u4E3A\u7A7A!"},rightClick:{copy:"\u590D\u5236",copyAs:"\u590D\u5236\u4E3A",paste:"\u7C98\u8D34",insert:"\u63D2\u5165",delete:"\u5220\u9664",deleteCell:"\u5220\u9664\u5355\u5143\u683C",deleteSelected:"\u5220\u9664\u9009\u4E2D",hide:"\u9690\u85CF",hideSelected:"\u9690\u85CF\u9009\u4E2D",showHide:"\u663E\u793A\u9690\u85CF",to:"\u5411",left:"\u5DE6",right:"\u53F3",top:"\u4E0A",bottom:"\u4E0B",moveLeft:"\u5DE6\u79FB",moveUp:"\u4E0A\u79FB",add:"\u589E\u52A0",row:"\u884C",column:"\u5217",width:"\u5BBD",height:"\u9AD8",number:"\u6570\u5B57",confirm:"\u786E\u8BA4",orderAZ:"A-Z\u987A\u5E8F\u6392\u5217",orderZA:"Z-A\u964D\u5E8F\u6392\u5217",clearContent:"\u6E05\u9664\u5185\u5BB9",matrix:"\u77E9\u9635\u64CD\u4F5C\u9009\u533A",sortSelection:"\u6392\u5E8F\u9009\u533A",filterSelection:"\u7B5B\u9009\u9009\u533A",chartGeneration:"\u56FE\u8868\u751F\u6210",firstLineTitle:"\u9996\u884C\u4E3A\u6807\u9898",untitled:"\u65E0\u6807\u9898",array1:"\u4E00\u7EF4\u6570\u7EC4",array2:"\u4E8C\u7EF4\u6570\u7EC4",array3:"\u591A\u7EF4\u6570\u7EC4",diagonal:"\u5BF9\u89D2\u7EBF",antiDiagonal:"\u53CD\u5BF9\u89D2\u7EBF",diagonalOffset:"\u5BF9\u89D2\u504F\u79FB",offset:"\u504F\u79FB\u91CF",boolean:"\u5E03\u5C14\u503C",flip:"\u7FFB\u8F6C",upAndDown:"\u4E0A\u4E0B",leftAndRight:"\u5DE6\u53F3",clockwise:"\u987A\u65F6\u9488",counterclockwise:"\u9006\u65F6\u9488",transpose:"\u8F6C\u7F6E",matrixCalculation:"\u77E9\u9635\u8BA1\u7B97",plus:"\u52A0",minus:"\u51CF",multiply:"\u4E58",divided:"\u9664",power:"\u6B21\u65B9",root:"\u6B21\u65B9\u6839",log:"log",delete0:"\u5220\u9664\u4E24\u7AEF0\u503C",removeDuplicate:"\u5220\u9664\u91CD\u590D\u503C",byRow:"\u6309\u884C",byCol:"\u6309\u5217",generateNewMatrix:"\u751F\u6210\u65B0\u77E9\u9635"},info:{detailUpdate:"\u65B0\u6253\u5F00",detailSave:"\u5DF2\u6062\u590D\u672C\u5730\u7F13\u5B58",row:"\u884C",column:"\u5217",loading:"\u6E32\u67D3\u4E2D\xB7\xB7\xB7",copy:"\u526F\u672C",return:"\u8FD4\u56DE",rename:"\u91CD\u547D\u540D",tips:"\u91CD\u547D\u540D",noName:"\u65E0\u6807\u9898\u7684\u7535\u5B50\u8868\u683C",wait:"\u5F85\u66F4\u65B0",add:"\u6DFB\u52A0",addLast:"\u5728\u5E95\u90E8\u6DFB\u52A0",backTop:"\u56DE\u5230\u9876\u90E8",pageInfo:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5F53\u524D\u5DF2\u663E\u793A${currentPage}\u9875",nextPage:"\u4E0B\u4E00\u9875",tipInputNumber:"\u8BF7\u8F93\u5165\u6570\u5B57",tipInputNumberLimit:"\u589E\u52A0\u8303\u56F4\u9650\u5236\u57281-100",tipRowHeightLimit:"\u884C\u9AD8\u5FC5\u987B\u57280 ~ 545\u4E4B\u95F4",tipColumnWidthLimit:"\u5217\u5BBD\u5FC5\u987B\u57280 ~ 2038\u4E4B\u95F4",pageInfoFull:"\u5171${total}\u6761\uFF0C${totalPage}\u9875\uFF0C\u5DF2\u663E\u793A\u5168\u90E8\u6570\u636E"}},q_={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"\xA5(0.00)",example:"\xA5(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1\u4EBF2000\u4E072500"},Currency:{text:"Currency",value:"\xA50.00",example:"\xA51200.09"},Digit:{text:"\u4E07\u51432\u4F4D\u5C0F\u6570",value:"w0.00",example:"2\u4E072500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page\u2002break\u2002preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:`The name cannot contain:[ ] :  ? * / ' "`,sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}\uFF0C${totalPage} page\uFF0Ccurrent ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}\uFF0C${totalPage} page\uFF0CAll data displayed"}};function Z_(n){n.pushToObserve("onAfterChangeFontFamilyObservable"),n.pushToObserve("onAfterChangeFontSizeObservable"),n.pushToObserve("onAfterChangeFontWeightObservable"),n.pushToObserve("onAfterChangeFontItalicObservable"),n.pushToObserve("onAfterChangeFontStrikethroughObservable"),n.pushToObserve("onAfterChangeFontUnderlineObservable"),n.pushToObserve("onAfterChangeFontBackgroundObservable"),n.pushToObserve("onAfterChangeFontColorObservable"),n.pushToObserve("onDragAndDropStartObserver"),n.pushToObserve("onDragAndDroppingObserver"),n.pushToObserve("onDragAndDropEndEndObserver"),n.pushToObserve("onFillStartObserver"),n.pushToObserve("onFillingObserver"),n.pushToObserve("onFillEndObserver"),n.pushToObserve("onChangeCurrentSheetObserver"),n.pushToObserve("onToolBarDidMountObservable"),n.pushToObserve("onSlideBarMousedownObservable"),n.pushToObserve("onSheetBarDidMountObservable"),n.pushToObserve("onCountBarDidMountObservable"),n.pushToObserve("onInfoBarDidMountObservable"),n.pushToObserve("onSlideBarDidMountObservable"),n.pushToObserve("onRightMenuDidMountObservable"),n.pushToObserve("onSlideContainerDidMountObservable"),n.pushToObserve("onSpreadsheetKeyDownObservable"),n.pushToObserve("onSpreadsheetKeyUpObservable"),n.pushToObserve("onSpreadsheetKeyCopyObservable"),n.pushToObserve("onSpreadsheetKeyPasteObservable"),n.pushToObserve("onSpreadsheetKeyCutObservable"),n.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),n.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),n.pushToObserve("onSpreadsheetKeyCompositionEndObservable")}/*!
 * css-vars-ponyfill
 * v2.4.8
 * https://jhildenbiddle.github.io/css-vars-ponyfill/
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function st(){return st=Object.assign?Object.assign.bind():function(n){for(var e=1;e<arguments.length;e++){var t=arguments[e];for(var s in t)Object.prototype.hasOwnProperty.call(t,s)&&(n[s]=t[s])}return n},st.apply(this,arguments)}/*!
 * get-css-data
 * v2.1.0
 * https://github.com/jhildenbiddle/get-css-data
 * (c) 2018-2022 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function sa(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={mimeType:e.mimeType||null,onBeforeSend:e.onBeforeSend||Function.prototype,onSuccess:e.onSuccess||Function.prototype,onError:e.onError||Function.prototype,onComplete:e.onComplete||Function.prototype},s=Array.isArray(n)?n:[n],r=Array.apply(null,Array(s.length)).map(function(l){return null});function o(l){var u=typeof l=="string",h=u&&l.trim().charAt(0)==="<";return u&&!h}function i(l,u){t.onError(l,s[u],u)}function a(l,u){var h=t.onSuccess(l,s[u],u);l=h===!1?"":h||l,r[u]=l,r.indexOf(null)===-1&&t.onComplete(r)}var c=document.createElement("a");s.forEach(function(l,u){c.setAttribute("href",l),c.href=String(c.href);var h=Boolean(document.all&&!window.atob),d=h&&c.host.split(":")[0]!==location.host.split(":")[0];if(d){var f=c.protocol===location.protocol;if(f){var g=new XDomainRequest;g.open("GET",l),g.timeout=0,g.onprogress=Function.prototype,g.ontimeout=Function.prototype,g.onload=function(){var p=g.responseText;o(p)?a(p,u):i(g,u)},g.onerror=function(p){i(g,u)},setTimeout(function(){g.send()},0)}else console.warn("Internet Explorer 9 Cross-Origin (CORS) requests must use the same protocol (".concat(l,")")),i(null,u)}else{var b=new XMLHttpRequest;b.open("GET",l),t.mimeType&&b.overrideMimeType&&b.overrideMimeType(t.mimeType),t.onBeforeSend(b,l,u),b.onreadystatechange=function(){if(b.readyState===4){var p=b.responseText;b.status<400&&o(p)||b.status===0&&o(p)?a(p,u):i(b,u)}},b.send()}})}/**
 * Gets CSS data from <style> and <link> nodes (including @imports), then
 * returns data in order processed by DOM. Allows specifying nodes to
 * include/exclude and filtering CSS data using RegEx.
 *
 * @preserve
 * @param {object}   [options] The options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes.
 * @param {string}   [options.include] CSS selector matching <link> and <style>
 *                   nodes to include
 * @param {string}   [options.exclude] CSS selector matching <link> and <style>
 *                   nodes to exclude
 * @param {object}   [options.filter] Regular expression used to filter node CSS
 *                   data. Each block of CSS data is tested against the filter,
 *                   and only matching data is included.
 * @param {boolean}  [options.skipDisabled=true] Determines if disabled
 *                   stylesheets will be skipped while collecting CSS data.
 * @param {boolean}  [options.useCSSOM=false] Determines if CSS data will be
 *                   collected from a stylesheet's runtime values instead of its
 *                   text content. This is required to get accurate CSS data
 *                   when a stylesheet has been modified using the deleteRule()
 *                   or insertRule() methods because these modifications will
 *                   not be reflected in the stylesheet's text content.
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments.
 * @param {function} [options.onSuccess] Callback on each CSS node read. Passes
 *                   1) CSS text, 2) source node reference, and 3) the source
 *                   URL as arguments.
 * @param {function} [options.onError] Callback on each error. Passes 1) the XHR
 *                   object for inspection, 2) soure node reference, and 3) the
 *                   source URL that failed (either a <link> href or an @import)
 *                   as arguments
 * @param {function} [options.onComplete] Callback after all nodes have been
 *                   processed. Passes 1) concatenated CSS text, 2) an array of
 *                   CSS text in DOM order, and 3) an array of nodes in DOM
 *                   order as arguments.
 *
 * @example
 *
 *   getCssData({
 *     rootElement : document,
 *     include     : 'style,link[rel="stylesheet"]',
 *     exclude     : '[href="skip.css"]',
 *     filter      : /red/,
 *     skipDisabled: true,
 *     useCSSOM    : false,
 *     onBeforeSend(xhr, node, url) {
 *       // ...
 *     }
 *     onSuccess(cssText, node, url) {
 *       // ...
 *     }
 *     onError(xhr, node, url) {
 *       // ...
 *     },
 *     onComplete(cssText, cssArray, nodeArray) {
 *       // ...
 *     }
 *   });
 */function ra(n){var e={cssComments:/\/\*[\s\S]+?\*\//g,cssImports:/(?:@import\s*)(?:url\(\s*)?(?:['"])([^'"]*)(?:['"])(?:\s*\))?(?:[^;]*;)/g},t={rootElement:n.rootElement||document,include:n.include||'style,link[rel="stylesheet"]',exclude:n.exclude||null,filter:n.filter||null,skipDisabled:n.skipDisabled!==!1,useCSSOM:n.useCSSOM||!1,onBeforeSend:n.onBeforeSend||Function.prototype,onSuccess:n.onSuccess||Function.prototype,onError:n.onError||Function.prototype,onComplete:n.onComplete||Function.prototype},s=Array.apply(null,t.rootElement.querySelectorAll(t.include)).filter(function(l){return!J_(l,t.exclude)}),r=Array.apply(null,Array(s.length)).map(function(l){return null});function o(){var l=r.indexOf(null)===-1;if(l){r.reduce(function(h,d,f){return d===""&&h.push(f),h},[]).reverse().forEach(function(h){return[s,r].forEach(function(d){return d.splice(h,1)})});var u=r.join("");t.onComplete(u,r,s)}}function i(l,u,h,d){var f=t.onSuccess(l,h,d);l=f!==void 0&&Boolean(f)===!1?"":f||l,c(l,h,d,function(g,b){r[u]===null&&(b.forEach(function(p){return t.onError(p.xhr,h,p.url)}),!t.filter||t.filter.test(g)?r[u]=g:r[u]="",o())})}function a(l,u){var h=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],d={};return d.rules=(l.replace(e.cssComments,"").match(e.cssImports)||[]).filter(function(f){return h.indexOf(f)===-1}),d.urls=d.rules.map(function(f){return f.replace(e.cssImports,"$1")}),d.absoluteUrls=d.urls.map(function(f){return Pr(f,u)}),d.absoluteRules=d.rules.map(function(f,g){var b=d.urls[g],p=Pr(d.absoluteUrls[g],u);return f.replace(b,p)}),d}function c(l,u,h,d){var f=arguments.length>4&&arguments[4]!==void 0?arguments[4]:[],g=arguments.length>5&&arguments[5]!==void 0?arguments[5]:[],b=a(l,h,g);b.rules.length?sa(b.absoluteUrls,{onBeforeSend:function(v,C,w){t.onBeforeSend(v,u,C)},onSuccess:function(v,C,w){var x=t.onSuccess(v,u,C);v=x===!1?"":x||v;var A=a(v,C,g);return A.rules.forEach(function(z,R){v=v.replace(z,A.absoluteRules[R])}),v},onError:function(v,C,w){f.push({xhr:v,url:C}),g.push(b.rules[w]),c(l,u,h,d,f,g)},onComplete:function(v){v.forEach(function(C,w){l=l.replace(b.rules[w],C)}),c(l,u,h,d,f,g)}}):d(l,f)}s.length?s.forEach(function(l,u){var h=l.getAttribute("href"),d=l.getAttribute("rel"),f=l.nodeName.toLowerCase()==="link"&&h&&d&&d.toLowerCase().indexOf("stylesheet")!==-1,g=t.skipDisabled===!1?!1:l.disabled,b=l.nodeName.toLowerCase()==="style";if(f&&!g){var p=h.indexOf("data:text/css")!==-1;if(p){var v=decodeURIComponent(h.substring(h.indexOf(",")+1));t.useCSSOM&&(v=Array.apply(null,l.sheet.cssRules).map(function(w){return w.cssText}).join("")),i(v,u,l,location.href)}else sa(h,{mimeType:"text/css",onBeforeSend:function(x,A,z){t.onBeforeSend(x,l,A)},onSuccess:function(x,A,z){var R=Pr(h);i(x,u,l,R)},onError:function(x,A,z){r[u]="",t.onError(x,l,A),o()}})}else if(b&&!g){var C=l.textContent;t.useCSSOM&&(C=Array.apply(null,l.sheet.cssRules).map(function(w){return w.cssText}).join("")),i(C,u,l,location.href)}else r[u]="",o()}):t.onComplete("",[])}function Pr(n,e){var t=document.implementation.createHTMLDocument(""),s=t.createElement("base"),r=t.createElement("a");return t.head.appendChild(s),t.body.appendChild(r),s.href=e||document.baseURI||(document.querySelector("base")||{}).href||location.href,r.href=n,r.href}function J_(n,e){var t=n.matches||n.matchesSelector||n.webkitMatchesSelector||n.mozMatchesSelector||n.msMatchesSelector||n.oMatchesSelector;return t.call(n,e)}var Dc=Ic;function Ic(n,e,t){n instanceof RegExp&&(n=oa(n,t)),e instanceof RegExp&&(e=oa(e,t));var s=yc(n,e,t);return s&&{start:s[0],end:s[1],pre:t.slice(0,s[0]),body:t.slice(s[0]+n.length,s[1]),post:t.slice(s[1]+e.length)}}function oa(n,e){var t=e.match(n);return t?t[0]:null}Ic.range=yc;function yc(n,e,t){var s,r,o,i,a,c=t.indexOf(n),l=t.indexOf(e,c+1),u=c;if(c>=0&&l>0){if(n===e)return[c,l];for(s=[],o=t.length;u>=0&&!a;)u==c?(s.push(u),c=t.indexOf(n,u+1)):s.length==1?a=[s.pop(),l]:(r=s.pop(),r<o&&(o=r,i=l),l=t.indexOf(e,u+1)),u=c<l&&c>=0?c:l;s.length&&(a=[o,i])}return a}function Fo(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,removeComments:!1},s=st({},t,e),r=[];function o(T){throw new Error("CSS parse error: ".concat(T))}function i(T){var y=T.exec(n);if(y)return n=n.slice(y[0].length),y}function a(){return i(/^{\s*/)}function c(){return i(/^}/)}function l(){i(/^\s*/)}function u(){if(l(),!(n[0]!=="/"||n[1]!=="*")){for(var T=2;n[T]&&(n[T]!=="*"||n[T+1]!=="/");)T++;if(!n[T])return o("end of comment is missing");var y=n.slice(2,T);return n=n.slice(T+2),{type:"comment",comment:y}}}function h(){for(var T=[],y;y=u();)T.push(y);return s.removeComments?[]:T}function d(){for(l();n[0]==="}";)o("extra closing bracket");var T=i(/^(("(?:\\"|[^"])*"|'(?:\\'|[^'])*'|[^{])+)/);if(T){var y=T[0].trim(),O,U=/\/\*/.test(y);U&&(y=y.replace(/\/\*([^*]|[\r\n]|(\*+([^*/]|[\r\n])))*\*\/+/g,""));var B=/["']\w*,\w*["']/.test(y);B&&(y=y.replace(/"(?:\\"|[^"])*"|'(?:\\'|[^'])*'/g,function(J){return J.replace(/,/g,"\u200C")}));var X=/,/.test(y);return X?O=y.split(/\s*(?![^(]*\)),\s*/):O=[y],B&&(O=O.map(function(J){return J.replace(/\u200C/g,",")})),O}}function f(){if(n[0]==="@")return M();i(/^([;\s]*)+/);var T=/\/\*[^*]*\*+([^/*][^*]*\*+)*\//g,y=i(/^(\*?[-#/*\\\w.]+(\[[0-9a-z_-]+\])?)\s*/);if(!!y){if(y=y[0].trim(),!i(/^:\s*/))return o("property missing ':'");var O=i(/^((?:\/\*.*?\*\/|'(?:\\'|.)*?'|"(?:\\"|.)*?"|\((\s*'(?:\\'|.)*?'|"(?:\\"|.)*?"|[^)]*?)\s*\)|[^};])+)/),U={type:"declaration",property:y.replace(T,""),value:O?O[0].replace(T,"").trim():""};return i(/^[;\s]*/),U}}function g(){if(!a())return o("missing '{'");for(var T,y=h();T=f();)y.push(T),y=y.concat(h());return c()?y:o("missing '}'")}function b(){l();for(var T=[],y;y=i(/^((\d+\.\d+|\.\d+|\d+)%?|[a-z]+)\s*/);)T.push(y[1]),i(/^,\s*/);if(T.length)return{type:"keyframe",values:T,declarations:g()}}function p(){var T=i(/^@([-\w]+)?keyframes\s*/);if(!!T){var y=T[1];if(T=i(/^([-\w]+)\s*/),!T)return o("@keyframes missing name");var O=T[1];if(!a())return o("@keyframes missing '{'");for(var U,B=h();U=b();)B.push(U),B=B.concat(h());return c()?{type:"keyframes",name:O,vendor:y,keyframes:B}:o("@keyframes missing '}'")}}function v(){var T=i(/^@page */);if(T){var y=d()||[];return{type:"page",selectors:y,declarations:g()}}}function C(){var T=i(/@(top|bottom|left|right)-(left|center|right|top|middle|bottom)-?(corner)?\s*/);if(T){var y="".concat(T[1],"-").concat(T[2])+(T[3]?"-".concat(T[3]):"");return{type:"page-margin-box",name:y,declarations:g()}}}function w(){var T=i(/^@font-face\s*/);if(T)return{type:"font-face",declarations:g()}}function x(){var T=i(/^@supports *([^{]+)/);if(T)return{type:"supports",supports:T[1].trim(),rules:G()}}function A(){var T=i(/^@host\s*/);if(T)return{type:"host",rules:G()}}function z(){var T=i(/^@media([^{]+)*/);if(T)return{type:"media",media:(T[1]||"").trim(),rules:G()}}function R(){var T=i(/^@custom-media\s+(--[^\s]+)\s*([^{;]+);/);if(T)return{type:"custom-media",name:T[1].trim(),media:T[2].trim()}}function E(){var T=i(/^@([-\w]+)?document *([^{]+)/);if(T)return{type:"document",document:T[2].trim(),vendor:T[1]?T[1].trim():null,rules:G()}}function D(){var T=i(/^@(import|charset|namespace)\s*([^;]+);/);if(T)return{type:T[1],name:T[2].trim()}}function M(){if(l(),n[0]==="@"){var T=D()||w()||z()||p()||x()||E()||R()||A()||v()||C();if(T&&!s.preserveStatic){var y=!1;if(T.declarations)y=T.declarations.some(function(U){return/var\(/.test(U.value)});else{var O=T.keyframes||T.rules||[];y=O.some(function(U){return(U.declarations||[]).some(function(B){return/var\(/.test(B.value)})})}return y?T:{}}return T}}function P(){if(!s.preserveStatic){var T=Dc("{","}",n);if(T){var y=/:(?:root|host)(?![.:#(])/.test(T.pre)&&/--\S*\s*:/.test(T.body),O=/var\(/.test(T.body);if(!y&&!O)return n=n.slice(T.end+1),{}}}var U=d()||[],B=s.preserveStatic?g():g().filter(function(X){var J=U.some(function(te){return/:(?:root|host)(?![.:#(])/.test(te)})&&/^--\S/.test(X.property),$=/var\(/.test(X.value);return J||$});return U.length||o("selector missing"),{type:"rule",selectors:U,declarations:B}}function G(T){if(!T&&!a())return o("missing '{'");for(var y,O=h();n.length&&(T||n[0]!=="}")&&(y=M()||P());)y.type&&O.push(y),O=O.concat(h());return!T&&!c()?o("missing '}'"):O}return{type:"stylesheet",stylesheet:{rules:G(!0),errors:r}}}function ia(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={parseHost:!1,store:{},onWarning:function(){}},s=st({},t,e),r=new RegExp(":".concat(s.parseHost?"host":"root","$"));return typeof n=="string"&&(n=Fo(n,s)),n.stylesheet.rules.forEach(function(o){o.type!=="rule"||!o.selectors.some(function(i){return r.test(i)})||o.declarations.forEach(function(i,a){var c=i.property,l=i.value;c&&c.indexOf("--")===0&&(s.store[c]=l)})}),s.store}function Ac(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"",t=arguments.length>2?arguments[2]:void 0,s={charset:function(i){return"@charset "+i.name+";"},comment:function(i){return i.comment.indexOf("__CSSVARSPONYFILL")===0?"/*"+i.comment+"*/":""},"custom-media":function(i){return"@custom-media "+i.name+" "+i.media+";"},declaration:function(i){return i.property+":"+i.value+";"},document:function(i){return"@"+(i.vendor||"")+"document "+i.document+"{"+r(i.rules)+"}"},"font-face":function(i){return"@font-face{"+r(i.declarations)+"}"},host:function(i){return"@host{"+r(i.rules)+"}"},import:function(i){return"@import "+i.name+";"},keyframe:function(i){return i.values.join(",")+"{"+r(i.declarations)+"}"},keyframes:function(i){return"@"+(i.vendor||"")+"keyframes "+i.name+"{"+r(i.keyframes)+"}"},media:function(i){return"@media "+i.media+"{"+r(i.rules)+"}"},namespace:function(i){return"@namespace "+i.name+";"},page:function(i){return"@page "+(i.selectors.length?i.selectors.join(", "):"")+"{"+r(i.declarations)+"}"},"page-margin-box":function(i){return"@"+i.name+"{"+r(i.declarations)+"}"},rule:function(i){var a=i.declarations;if(a.length)return i.selectors.join(",")+"{"+r(a)+"}"},supports:function(i){return"@supports "+i.supports+"{"+r(i.rules)+"}"}};function r(o){for(var i="",a=0;a<o.length;a++){var c=o[a];t&&t(c);var l=s[c.type](c);l&&(i+=l,l.length&&c.selectors&&(i+=e))}return i}return r(n.stylesheet.rules)}function Sc(n,e){n.rules.forEach(function(t){if(t.rules){Sc(t,e);return}if(t.keyframes){t.keyframes.forEach(function(s){s.type==="keyframe"&&e(s.declarations,t)});return}!t.declarations||e(t.declarations,n)})}var Q_="--",eb="var";function tb(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t={preserveStatic:!0,preserveVars:!1,variables:{},onWarning:function(){}},s=st({},t,e);return typeof n=="string"&&(n=Fo(n,s)),Sc(n.stylesheet,function(r,o){for(var i=0;i<r.length;i++){var a=r[i],c=a.type,l=a.property,u=a.value;if(c==="declaration"){if(!s.preserveVars&&l&&l.indexOf(Q_)===0){r.splice(i,1),i--;continue}if(u.indexOf(eb+"(")!==-1){var h=os(u,s);h!==a.value&&(h=nb(h),s.preserveVars?(r.splice(i,0,{type:c,property:l,value:h}),i++):a.value=h)}}}}),Ac(n)}function nb(n){var e=/calc\(([^)]+)\)/g;return(n.match(e)||[]).forEach(function(t){var s="calc".concat(t.split("calc").join(""));n=n.replace(t,s)}),n}function os(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},t=arguments.length>2?arguments[2]:void 0;if(n.indexOf("var(")===-1)return n;var s=Dc("(",")",n);function r(i){var a=i.split(",")[0].replace(/[\s\n\t]/g,""),c=(i.match(/(?:\s*,\s*){1}(.*)?/)||[])[1],l=Object.prototype.hasOwnProperty.call(e.variables,a)?String(e.variables[a]):void 0,u=l||(c?String(c):void 0),h=t||i;return l||e.onWarning('variable "'.concat(a,'" is undefined')),u&&u!=="undefined"&&u.length>0?os(u,e,h):"var(".concat(h,")")}if(s)if(s.pre.slice(-3)==="var"){var o=s.body.trim().length===0;return o?(e.onWarning("var() must contain a non-whitespace string"),n):s.pre.slice(0,-3)+r(s.body)+os(s.post,e)}else return s.pre+"(".concat(os(s.body,e),")")+os(s.post,e);else return n.indexOf("var(")!==-1&&e.onWarning('missing closing ")" in the value "'.concat(n,'"')),n}var Rr=typeof window!="undefined",aa=Rr&&window.CSS&&window.CSS.supports&&window.CSS.supports("(--a: 0)"),_n={group:0,job:0},Hs={rootElement:Rr?document:null,shadowDOM:!1,include:"style,link[rel=stylesheet]",exclude:"",variables:{},onlyLegacy:!0,preserveStatic:!0,preserveVars:!1,silent:!1,updateDOM:!0,updateURLs:!0,watch:null,onBeforeSend:function(){},onError:function(){},onWarning:function(){},onSuccess:function(){},onComplete:function(){},onFinally:function(){}},Mt={cssComments:/\/\*[\s\S]+?\*\//g,cssKeyframes:/@(?:-\w*-)?keyframes/,cssMediaQueries:/@media[^{]+\{([\s\S]+?})\s*}/g,cssUrls:/url\((?!['"]?(?:data|http|\/\/):)['"]?([^'")]*)['"]?\)/g,cssVarDeclRules:/(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^}]*})/g,cssVarDecls:/(?:[\s;]*)(-{2}\w[\w-]*)(?:\s*:\s*)([^;]*);/g,cssVarFunc:/var\(\s*--[\w-]/,cssVars:/(?:(?::(?:root|host)(?![.:#(])[\s,]*[^{]*{\s*[^;]*;*\s*)|(?:var\(\s*))(--[^:)]+)(?:\s*[:)])/},Pe={dom:{},job:{},user:{}},qs=!1,ct=null,is=0,no=null,so=!1;/**
 * Fetches, parses, and transforms CSS custom properties from specified
 * <style> and <link> elements into static values, then appends a new <style>
 * element with static values to the DOM to provide CSS custom property
 * compatibility for legacy browsers. Also provides a single interface for
 * live updates of runtime values in both modern and legacy browsers.
 *
 * @preserve
 * @param {object}   [options] Options object
 * @param {object}   [options.rootElement=document] Root element to traverse for
 *                   <link> and <style> nodes
 * @param {boolean}  [options.shadowDOM=false] Determines if shadow DOM <link>
 *                   and <style> nodes will be processed.
 * @param {string}   [options.include="style,link[rel=stylesheet]"] CSS selector
 *                   matching <link re="stylesheet"> and <style> nodes to
 *                   process
 * @param {string}   [options.exclude] CSS selector matching <link
 *                   rel="stylehseet"> and <style> nodes to exclude from those
 *                   matches by options.include
 * @param {object}   [options.variables] A map of custom property name/value
 *                   pairs. Property names can omit or include the leading
 *                   double-hyphen (—), and values specified will override
 *                   previous values
 * @param {boolean}  [options.onlyLegacy=true] Determines if the ponyfill will
 *                   only generate legacy-compatible CSS in browsers that lack
 *                   native support (i.e., legacy browsers)
 * @param {boolean}  [options.preserveStatic=true] Determines if CSS
 *                   declarations that do not reference a custom property will
 *                   be preserved in the transformed CSS
 * @param {boolean}  [options.preserveVars=false] Determines if CSS custom
 *                   property declarations will be preserved in the transformed
 *                   CSS
 * @param {boolean}  [options.silent=false] Determines if warning and error
 *                   messages will be displayed on the console
 * @param {boolean}  [options.updateDOM=true] Determines if the ponyfill will
 *                   update the DOM after processing CSS custom properties
 * @param {boolean}  [options.updateURLs=true] Determines if relative url()
 *                   paths will be converted to absolute urls in external CSS
 * @param {boolean}  [options.watch=false] Determines if a MutationObserver will
 *                   be created that will execute the ponyfill when a <link> or
 *                   <style> DOM mutation is observed
 * @param {function} [options.onBeforeSend] Callback before XHR is sent. Passes
 *                   1) the XHR object, 2) source node reference, and 3) the
 *                   source URL as arguments
 * @param {function} [options.onError] Callback after a CSS parsing error has
 *                   occurred or an XHR request has failed. Passes 1) an error
 *                   message, and 2) source node reference, 3) xhr, and 4 url as
 *                   arguments.
 * @param {function} [options.onWarning] Callback after each CSS parsing warning
 *                   has occurred. Passes 1) a warning message as an argument.
 * @param {function} [options.onSuccess] Callback after CSS data has been
 *                   collected from each node and before CSS custom properties
 *                   have been transformed. Allows modifying the CSS data before
 *                   it is transformed by returning any string value (or false
 *                   to skip). Passes 1) CSS text, 2) source node reference, and
 *                   3) the source URL as arguments.
 * @param {function} [options.onComplete] Callback after all CSS has been
 *                   processed, legacy-compatible CSS has been generated, and
 *                   (optionally) the DOM has been updated. Passes 1) a CSS
 *                   string with CSS variable values resolved, 2) an array of
 *                   output <style> node references that have been appended to
 *                   the DOM, 3) an object containing all custom properies names
 *                   and values, and 4) the ponyfill execution time in
 *                   milliseconds.
 * @param {function} [options.onFinally] Callback in modern and legacy browsers
 *                   after the ponyfill has finished all tasks. Passes 1) a
 *                   boolean indicating if the last ponyfill call resulted in a
 *                   style change, 2) a boolean indicating if the current
 *                   browser provides native support for CSS custom properties,
 *                   and 3) the ponyfill execution time in milliseconds.
 * @example
 *
 *   cssVars({
 *     rootElement   : document,
 *     shadowDOM     : false,
 *     include       : 'style,link[rel="stylesheet"]',
 *     exclude       : '',
 *     variables     : {},
 *     onlyLegacy    : true,
 *     preserveStatic: true,
 *     preserveVars  : false,
 *     silent        : false,
 *     updateDOM     : true,
 *     updateURLs    : true,
 *     watch         : false,
 *     onBeforeSend(xhr, node, url) {},
 *     onError(message, node, xhr, url) {},
 *     onWarning(message) {},
 *     onSuccess(cssText, node, url) {},
 *     onComplete(cssText, styleNode, cssVariables, benchmark) {},
 *     onFinally(hasChanged, hasNativeSupport, benchmark)
 *   });
 */function Ut(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e="cssVars(): ",t=st({},Hs,n);function s(u,h,d,f){!t.silent&&window.console&&console.error("".concat(e).concat(u,`
`),h),t.onError(u,h,d,f)}function r(u){!t.silent&&window.console&&console.warn("".concat(e).concat(u)),t.onWarning(u)}function o(u){t.onFinally(Boolean(u),aa,zr()-t.__benchmark)}if(!!Rr){if(t.watch){t.watch=Hs.watch,sb(t),Ut(t);return}else t.watch===!1&&ct&&(ct.disconnect(),ct=null);if(!t.__benchmark){if(qs===t.rootElement){rb(n);return}var i=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])'));if(t.__benchmark=zr(),t.exclude=[ct?'[data-cssvars]:not([data-cssvars=""])':'[data-cssvars="out"]',"link[disabled]:not([data-cssvars])",t.exclude].filter(function(u){return u}).join(","),t.variables=ab(t.variables),i.forEach(function(u){var h=u.nodeName.toLowerCase()==="style"&&u.__cssVars.text,d=h&&u.textContent!==u.__cssVars.text;h&&d&&(u.sheet&&(u.sheet.disabled=!1),u.setAttribute("data-cssvars",""))}),!ct){var a=[].slice.call(t.rootElement.querySelectorAll('[data-cssvars="out"]'));a.forEach(function(u){var h=u.getAttribute("data-cssvars-group"),d=h?t.rootElement.querySelector('[data-cssvars="src"][data-cssvars-group="'.concat(h,'"]')):null;d||u.parentNode.removeChild(u)}),is&&i.length<is&&(is=i.length,Pe.dom={})}}if(document.readyState!=="loading")if(aa&&t.onlyLegacy){var c=!1;if(t.updateDOM){var l=t.rootElement.host||(t.rootElement===document?document.documentElement:t.rootElement);Object.keys(t.variables).forEach(function(u){var h=t.variables[u];c=c||h!==getComputedStyle(l).getPropertyValue(u),l.style.setProperty(u,h)})}o(c)}else!so&&(t.shadowDOM||t.rootElement.shadowRoot||t.rootElement.host)?ra({rootElement:Hs.rootElement,include:Hs.include,exclude:t.exclude,skipDisabled:!1,onSuccess:function(h,d,f){var g=(d.sheet||{}).disabled&&!d.__cssVars;return g?!1:(h=h.replace(Mt.cssComments,"").replace(Mt.cssMediaQueries,""),h=(h.match(Mt.cssVarDeclRules)||[]).join(""),h||!1)},onComplete:function(h,d,f){ia(h,{store:Pe.dom,onWarning:r}),so=!0,Ut(t)}}):(qs=t.rootElement,ra({rootElement:t.rootElement,include:t.include,exclude:t.exclude,skipDisabled:!1,onBeforeSend:t.onBeforeSend,onError:function(h,d,f){var g=h.responseURL||Oc(f,location.href),b=h.statusText?"(".concat(h.statusText,")"):"Unspecified Error"+(h.status===0?" (possibly CORS related)":""),p="CSS XHR Error: ".concat(g," ").concat(h.status," ").concat(b);s(p,d,h,g)},onSuccess:function(h,d,f){var g=(d.sheet||{}).disabled&&!d.__cssVars;if(g)return!1;var b=d.nodeName.toLowerCase()==="link",p=d.nodeName.toLowerCase()==="style"&&h!==d.textContent,v=t.onSuccess(h,d,f);return h=v!==void 0&&Boolean(v)===!1?"":v||h,t.updateURLs&&(b||p)&&(h=ib(h,f)),h},onComplete:function(h,d){var f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],g=st({},Pe.dom,Pe.user),b=!1;if(Pe.job={},f.forEach(function(R,E){var D=d[E];if(R.__cssVars=R.__cssVars||{},R.__cssVars.text=D,Mt.cssVars.test(D))try{var M=Fo(D,{preserveStatic:t.preserveStatic,removeComments:!0});ia(M,{parseHost:Boolean(t.rootElement.host),store:Pe.dom,onWarning:r}),R.__cssVars.tree=M}catch(P){s(P.message,R)}}),st(Pe.job,Pe.dom),t.updateDOM?(st(Pe.user,t.variables),st(Pe.job,Pe.user)):(st(Pe.job,Pe.user,t.variables),st(g,t.variables)),b=_n.job>0&&Boolean(Object.keys(Pe.job).length>Object.keys(g).length||Boolean(Object.keys(g).length&&Object.keys(Pe.job).some(function(R){return Pe.job[R]!==g[R]}))),b)ro(t.rootElement),Ut(t);else{var p=[],v=[],C=!1;if(t.updateDOM&&_n.job++,f.forEach(function(R,E){var D=!R.__cssVars.tree;if(R.__cssVars.tree)try{tb(R.__cssVars.tree,st({},t,{variables:Pe.job,onWarning:r}));var M=Ac(R.__cssVars.tree);if(t.updateDOM){var P=d[E],G=Mt.cssVarFunc.test(P);if(R.getAttribute("data-cssvars")||R.setAttribute("data-cssvars","src"),M.length&&G){var T=R.getAttribute("data-cssvars-group")||++_n.group,y=M.replace(/\s/g,""),O=t.rootElement.querySelector('[data-cssvars="out"][data-cssvars-group="'.concat(T,'"]'))||document.createElement("style");C=C||Mt.cssKeyframes.test(M),t.preserveStatic&&R.sheet&&(R.sheet.disabled=!0),O.hasAttribute("data-cssvars")||O.setAttribute("data-cssvars","out"),y===R.textContent.replace(/\s/g,"")?(D=!0,O&&O.parentNode&&(R.removeAttribute("data-cssvars-group"),O.parentNode.removeChild(O))):y!==O.textContent.replace(/\s/g,"")&&([R,O].forEach(function(U){U.setAttribute("data-cssvars-job",_n.job),U.setAttribute("data-cssvars-group",T)}),O.textContent=M,p.push(M),v.push(O),O.parentNode||R.parentNode.insertBefore(O,R.nextSibling))}}else R.textContent.replace(/\s/g,"")!==M&&p.push(M)}catch(U){s(U.message,R)}D&&R.setAttribute("data-cssvars","skip"),R.hasAttribute("data-cssvars-job")||R.setAttribute("data-cssvars-job",_n.job)}),is=t.rootElement.querySelectorAll('[data-cssvars]:not([data-cssvars="out"])').length,t.shadowDOM){for(var w=[].concat(t.rootElement).concat([].slice.call(t.rootElement.querySelectorAll("*"))),x=0,A;A=w[x];++x)if(A.shadowRoot&&A.shadowRoot.querySelector("style")){var z=st({},t,{rootElement:A.shadowRoot});Ut(z)}}t.updateDOM&&C&&ob(t.rootElement),qs=!1,t.onComplete(p.join(""),v,JSON.parse(JSON.stringify(Pe.job)),zr()-t.__benchmark),o(v.length)}}}));else document.addEventListener("DOMContentLoaded",function u(h){Ut(n),document.removeEventListener("DOMContentLoaded",u)})}}Ut.reset=function(){_n.job=0,_n.group=0,qs=!1,ct&&(ct.disconnect(),ct=null),is=0,no=null,so=!1;for(var n in Pe)Pe[n]={}};function sb(n){function e(c){var l=t(c)&&c.hasAttribute("disabled"),u=(c.sheet||{}).disabled;return l||u}function t(c){var l=c.nodeName.toLowerCase()==="link"&&(c.getAttribute("rel")||"").indexOf("stylesheet")!==-1;return l}function s(c){return c.nodeName.toLowerCase()==="style"}function r(c){var l=!1;if(c.type==="attributes"&&t(c.target)&&!e(c.target)){var u=c.attributeName==="disabled",h=c.attributeName==="href",d=c.target.getAttribute("data-cssvars")==="skip",f=c.target.getAttribute("data-cssvars")==="src";u?l=!d&&!f:h&&(d?c.target.setAttribute("data-cssvars",""):f&&ro(n.rootElement,!0),l=!0)}return l}function o(c){var l=!1;if(c.type==="childList"){var u=s(c.target),h=c.target.getAttribute("data-cssvars")==="out";l=u&&!h}return l}function i(c){var l=!1;return c.type==="childList"&&(l=[].slice.call(c.addedNodes).some(function(u){var h=u.nodeType===1,d=h&&u.hasAttribute("data-cssvars"),f=s(u)&&Mt.cssVars.test(u.textContent),g=!d&&(t(u)||f);return g&&!e(u)})),l}function a(c){var l=!1;return c.type==="childList"&&(l=[].slice.call(c.removedNodes).some(function(u){var h=u.nodeType===1,d=h&&u.getAttribute("data-cssvars")==="out",f=h&&u.getAttribute("data-cssvars")==="src",g=f;if(f||d){var b=u.getAttribute("data-cssvars-group"),p=n.rootElement.querySelector('[data-cssvars-group="'.concat(b,'"]'));f&&ro(n.rootElement,!0),p&&p.parentNode.removeChild(p)}return g})),l}!window.MutationObserver||(ct&&(ct.disconnect(),ct=null),ct=new MutationObserver(function(c){var l=c.some(function(u){return r(u)||o(u)||i(u)||a(u)});l&&Ut(n)}),ct.observe(document.documentElement,{attributes:!0,attributeFilter:["disabled","href"],childList:!0,subtree:!0}))}function rb(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:100;clearTimeout(no),no=setTimeout(function(){n.__benchmark=null,Ut(n)},e)}function ob(n){var e=["animation-name","-moz-animation-name","-webkit-animation-name"].filter(function(d){return getComputedStyle(document.body)[d]})[0];if(e){for(var t=[].slice.call(n.querySelectorAll("*")),s=[],r="__CSSVARSPONYFILL-KEYFRAMES__",o=0,i=t.length;o<i;o++){var a=t[o],c=getComputedStyle(a)[e];c!=="none"&&(a.style[e]+=r,s.push(a))}document.body.offsetHeight;for(var l=0,u=s.length;l<u;l++){var h=s[l].style;h[e]=h[e].replace(r,"")}}}function ib(n,e){var t=n.replace(Mt.cssComments,"").match(Mt.cssUrls)||[];return t.forEach(function(s){var r=s.replace(Mt.cssUrls,"$1"),o=Oc(r,e);n=n.replace(s,s.replace(r,o))}),n}function ab(){var n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=/^-{2}/;return Object.keys(n).reduce(function(t,s){var r=e.test(s)?s:"--".concat(s.replace(/^-+/,""));return t[r]=n[s],t},{})}function Oc(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:location.href,t=document.implementation.createHTMLDocument(""),s=t.createElement("base"),r=t.createElement("a");return t.head.appendChild(s),t.body.appendChild(r),s.href=e,r.href=n,r.href}function zr(){return Rr&&(window.performance||{}).now?window.performance.now():new Date().getTime()}function ro(n){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1,t=[].slice.call(n.querySelectorAll('[data-cssvars="skip"],[data-cssvars="src"]'));t.forEach(function(s){return s.setAttribute("data-cssvars","")}),e&&(Pe.dom={})}const lb="#52c41a",cb="#faad14",ub="#f5222d",hb="2px",db="1px",fb="solid",gb="1.5715",mb="400",_b="14px",bb="16px",pb="12px",vb="1em",Cb="1em",wb="#ffffff",Eb="#fafafa",Tb="#f5f5f5",Rb="#f0f0f0",Db="#d9d9d9",Ib="#bfbfbf",yb="#8c8c8c",Ab="#595959",Sb="#434343",Ob="#262626",xb="#1f1f1f",Nb="#141414",Mb="#000000",kb="#efefef",Bb="#e0e0e0",Lb="#ececec",Fb="#cbcbcb",Hb="#0188fb",Pb="#5391ff",zb="#1890ff",Ub="#fff",Wb="14px",Vb="#262626",Gb="#333",$b="#8c8c8c",Yb="#bfbfbf",Xb="#f5f5f5",jb="#d9d9d9",Kb="0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",qb="#bfbfbf";var Zb={successColor:lb,warningColor:cb,errorColor:ub,borderRadiusBase:hb,borderWidthBase:db,borderStyleBase:fb,lineHeightBase:gb,fontWeight:mb,fontSizeBase:_b,fontSizeLg:bb,fontSizeSm:pb,paddingBase:vb,marginBase:Cb,gray1:wb,gray2:Eb,gray3:Tb,gray4:Rb,gray5:Db,gray6:Ib,gray7:yb,gray8:Ab,gray9:Sb,gray10:Ob,gray11:xb,gray12:Nb,gray13:Mb,gray14:kb,gray15:Bb,gray16:Lb,gray17:Fb,primaryColor:Hb,primaryColorHover:Pb,linkColor:zb,bg:Ub,fontSize:Wb,headingColor:Vb,textColor:Gb,textColorSecondary:$b,disabledColor:Yb,disabledBg:Xb,borderColorBase:jb,boxShadowBase:Kb,borderColorBaseHover:qb};const Jb="#52c41a",Qb="#faad14",e4="#f5222d",t4="2px",n4="1px",s4="solid",r4="1.5715",o4="400",i4="14px",a4="16px",l4="12px",c4="1em",u4="1em",h4="#ffffff",d4="#fafafa",f4="#f5f5f5",g4="#f0f0f0",m4="#d9d9d9",_4="#bfbfbf",b4="#8c8c8c",p4="#595959",v4="#434343",C4="#262626",w4="#1f1f1f",E4="#141414",T4="#000000",R4="#efefef",D4="#e0e0e0",I4="#ececec",y4="#cbcbcb",A4="#0188fb",S4="#5391ff",O4="#1890ff",x4="#0d1117",N4="14px",M4="rgba(255, 255, 255, 0.85)",k4="#8b949e",B4="rgba(255, 255, 255, 0.45)",L4="rgba(255, 255, 255, 0.25)",F4="rgba(255, 255, 255, 0.04)",H4="rgba(255, 255, 255, 0.15)",P4="0 3px 6px -4px rgba(255, 255, 255, 0.12), 0 6px 16px 0 rgba(255, 255, 255, 0.08), 0 9px 28px 8px rgba(255, 255, 255, 0.05)",z4="#bfbfbf";var U4={successColor:Jb,warningColor:Qb,errorColor:e4,borderRadiusBase:t4,borderWidthBase:n4,borderStyleBase:s4,lineHeightBase:r4,fontWeight:o4,fontSizeBase:i4,fontSizeLg:a4,fontSizeSm:l4,paddingBase:c4,marginBase:u4,gray1:h4,gray2:d4,gray3:f4,gray4:g4,gray5:m4,gray6:_4,gray7:b4,gray8:p4,gray9:v4,gray10:C4,gray11:w4,gray12:E4,gray13:T4,gray14:R4,gray15:D4,gray16:I4,gray17:y4,primaryColor:A4,primaryColorHover:S4,linkColor:O4,bg:x4,fontSize:N4,headingColor:M4,textColor:k4,textColorSecondary:B4,disabledColor:L4,disabledBg:F4,borderColorBase:H4,boxShadowBase:P4,borderColorBaseHover:z4};const W4="#52c41a",V4="#faad14",G4="#f5222d",$4="2px",Y4="1px",X4="solid",j4="1.5715",K4="400",q4="14px",Z4="16px",J4="12px",Q4="1em",ep="1em",tp="#ffffff",np="#fafafa",sp="#f5f5f5",rp="#f0f0f0",op="#d9d9d9",ip="#bfbfbf",ap="#8c8c8c",lp="#595959",cp="#434343",up="#262626",hp="#1f1f1f",dp="#141414",fp="#000000",gp="#efefef",mp="#e0e0e0",_p="#ececec",bp="#cbcbcb",pp="#004b1c",vp="#0e5c2f",Cp="#217346",wp="#fff",Ep="14px",Tp="rgba(0, 0, 0, 0.85)",Rp="rgba(0, 0, 0, 0.65)",Dp="rgba(0, 0, 0, 0.45)",Ip="rgba(0, 0, 0, 0.25)",yp="rgba(0, 0, 0, 0.04)",Ap="rgba(0, 0, 0, 0.15)",Sp="0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",Op="#bfbfbf";var xp={successColor:W4,warningColor:V4,errorColor:G4,borderRadiusBase:$4,borderWidthBase:Y4,borderStyleBase:X4,lineHeightBase:j4,fontWeight:K4,fontSizeBase:q4,fontSizeLg:Z4,fontSizeSm:J4,paddingBase:Q4,marginBase:ep,gray1:tp,gray2:np,gray3:sp,gray4:rp,gray5:op,gray6:ip,gray7:ap,gray8:lp,gray9:cp,gray10:up,gray11:hp,gray12:dp,gray13:fp,gray14:gp,gray15:mp,gray16:_p,gray17:bp,primaryColor:pp,primaryColorHover:vp,linkColor:Cp,bg:wp,fontSize:Ep,headingColor:Tp,textColor:Rp,textColorSecondary:Dp,disabledColor:Ip,disabledBg:yp,borderColorBase:Ap,boxShadowBase:Sp,borderColorBaseHover:Op};const Np="univer-layout-container",Mp="univer-content-container-horizontal",kp="univer-content-inner-left-container",Bp="univer-hover-cursor",Lp="univer-content-inner-right-container",Fp="univer-content-container-vertical",Hp="univer-main-content",Pp="univer-outer-right-container";var qt={layoutContainer:Np,contentContainerHorizontal:Mp,contentInnerLeftContainer:kp,hoverCursor:Bp,contentInnerRightContainer:Lp,contentContainerVertical:Fp,mainContent:Hp,outerRightContainer:Pp};const zp="univer-text-button";var Up={textButton:zp};class Wp extends ye{constructor(){super(...arguments),this.handleClick=()=>{var t,s;const e=!this.state.active;(s=(t=this.props).onClick)==null||s.call(t,e),this.setState({active:e})}}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={active:this.props.active}}render(){const{label:e}=this.props,{active:t}=this.state,s=this.Render.renderFunction("Button");return m("div",{className:Up.textButton},m(s,{type:"text",active:t,onClick:this.handleClick},e))}}const Vp="univer-toolbar-warp",Gp="univer-single-button",$p="univer-more-hide",Yp="univer-more-show",Xp="univer-toolbar",jp="univer-select-button",Kp="univer-cols-menu",qp="univer-select-label-string",Zp="univer-drop-content",Jp="univer-select-color-picker-parent",Qp="univer-select-item-content",ev="univer-select-color-picker",tv="univer-select-item",nv="univer-double-button",sv="univer-color-bottom",rv="univer-double-button-right",ov="univer-double-button-right-popup",iv="univer-double-button-menu-item",av="univer-double-button-menu-item-icon",lv="univer-double-button-menu-item-content",cv="univer-more-button",uv="univer-more-tool",hv="univer-univericon-nextIcon";var Ln={toolbarWarp:Vp,singleButton:Gp,moreHide:$p,moreShow:Yp,toolbar:Xp,selectButton:jp,colsMenu:Kp,selectLabelString:qp,dropContent:Zp,selectColorPickerParent:Jp,selectItemContent:Qp,selectColorPicker:ev,selectItem:tv,doubleButton:nv,colorBottom:sv,doubleButtonRight:rv,doubleButtonRightPopup:ov,doubleButtonMenuItem:iv,doubleButtonMenuItemIcon:av,doubleButtonMenuItemContent:lv,moreButton:cv,moreTool:uv,univericonNextIcon:hv};const dv="univer-select-item",fv="univer-select-item-selected",gv="univer-select-item-content",mv="univer-select-item-suffix",_v="univer-select-disabled-item";var es={selectItem:dv,selectItemSelected:fv,selectItemContent:gv,selectItemSuffix:mv,selectDisabledItem:_v};class Ur extends ye{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender()}render(){const e=this.Render.renderFunction("CorrectIcon"),{selected:t,label:s,suffix:r,disabled:o}=this.props;return m("div",{className:ot(es.selectItem,o?es.selectDisabledItem:"")},t?m("span",{className:es.selectItemSelected},m(e,null)):"",m("span",{className:es.selectItemContent},s),r?m("span",{className:es.selectItemSuffix},r):"")}}const bv="univer-select-component",pv="univer-select-button",vv="univer-select-single",Cv="univer-select-input",wv="univer-select-color",Ev="univer-cols-menu",Tv="univer-cols-menuitem",Rv="univer-select-item",Dv="univer-select-double",Iv="univer-dropdown",yv="univer-drop-content",Av="univer-select-line",Sv="univer-drop-icon",Ov="univer-select-label";var it={selectComponent:bv,selectButton:pv,selectSingle:vv,selectInput:Cv,selectColor:wv,colsMenu:Ev,colsMenuitem:Tv,selectItem:Rv,selectDouble:Dv,dropdown:Iv,dropContent:yv,selectLine:Av,dropIcon:Sv,selectLabel:Ov};class xv extends ye{constructor(){super(...arguments),this.handleSelected=e=>{const{children:t=[],hideSelectedIcon:s}=this.props;return t.length&&(t.forEach(o=>{o.selected=!1}),e!==null&&(t[e].selected=!0)),this.resetMenu(t,s)},this.getSingle=()=>{const{content:e,menu:t}=this.state,{selectClassName:s="",tooltip:r}=this.props,o=this.Render.renderFunction("Button");return m("div",{className:`${it.selectSingle} ${s}`},m(o,{type:"text"},m(mn,{tooltip:r,menu:{menu:t,onClick:this.onClick},showArrow:!0},m("div",null,e))))},this.getInput=()=>{const{content:e,menu:t}=this.state,{selectClassName:s="",tooltip:r}=this.props,o=this.Render.renderFunction("Input"),i=this.Render.renderFunction("Button");return m("div",{className:`${it.selectInput} ${s}`},m(i,{type:"text"},m(mn,{tooltip:r,menu:{menu:t,onClick:this.onClick},showArrow:!0},m(o,{onKeyUp:this.onKeyUp,type:"number",value:e}))))},this.getColor=()=>{const{label:e,selectClassName:t="",tooltip:s}=this.props,{color:r,menu:o}=this.state,i=this.Render.renderFunction("Button"),a=this.Render.renderFunction("NextIcon");return m("div",{className:`${it.selectColor} ${it.selectDouble} ${t}`},m(i,{type:"text"},m(mn,{tooltip:s,onClick:this.onClick,menu:{menu:o,onClick:this.onClick},icon:m(a,null)},m("div",{className:it.selectLabel},e),m("div",{className:it.selectLine,style:{background:r}}))))},this.getDouble=()=>{const{content:e,menu:t}=this.state,{selectClassName:s="",tooltip:r}=this.props,o=this.Render.renderFunction("NextIcon"),i=this.Render.renderFunction("Button");return m("div",{className:`${it.selectDouble} ${s}`},m(i,{type:"text"},m(mn,{tooltip:r,menu:{menu:t,onClick:this.onClick},icon:m(o,null)},m("div",{className:it.selectLabel},e))))},this.getFix=()=>{const{label:e,selectClassName:t="",tooltip:s}=this.props,{menu:r}=this.state,o=this.Render.renderFunction("Button");return m("div",{className:`${it.selectDouble} ${t}`},m(o,{type:"text"},m(mn,{tooltip:s,menu:{menu:r,onClick:this.onClick},showArrow:!0},m("div",{className:it.selectLabel},e))))},this.getDoubleFix=()=>{const{label:e,selectClassName:t="",tooltip:s}=this.props,{menu:r}=this.state,o=this.Render.renderFunction("Button"),i=this.Render.renderFunction("NextIcon");return m("div",{className:`${it.selectDouble} ${t}`},m(o,{type:"text"},m(mn,{tooltip:s,onClick:this.onClick,menu:{menu:r,onClick:this.onClick},icon:m(i,null)},m("div",{className:it.selectLabel},e))))}}initialize(){var o;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender();const{children:t=[],hideSelectedIcon:s}=this.props,r=this.resetMenu(t,s);this.state={menu:r,color:(o=this.props.defaultColor)!=null?o:"#000",content:"",value:""}}getType(e){switch(e){case 0:return this.getSingle();case 1:return this.getInput();case 2:return this.getColor();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}componentDidMount(){const{type:e,display:t,children:s=[],label:r}=this.props;if(e===0||e===3){if(!s.length)return;let o=s.findIndex(c=>c.selected);o<0&&(o=0);const i=this.handleSelected(o),a=s[o];t===1?this.setState({content:a.suffix,menu:i}):this.setState({content:a.label,menu:i}),this.onClick=(...c)=>{var h,d;const l=s[c[2]];if((d=(h=this.props).onClick)==null||d.call(h,c[1],c[2],c[3]),l.unSelectable)return;const u=this.handleSelected(c[2]);t===1?this.setState({content:s[c[2]].suffix,menu:u}):this.setState({content:s[c[2]].label,menu:u})}}else if(e===1){if(!s.length)return;const o=i=>{if(i!==null){if(i==="")return;let a=s.findIndex(l=>i===l.label),c=this.handleSelected(a<0?null:a);this.setState({content:i,menu:c})}else{let a=s.findIndex(u=>u.selected);a<0&&(a=0);let c=this.handleSelected(a);const l=s[a];this.setState({content:l.label,menu:c})}};o(r),this.onClick=(...i)=>{var c,l;(l=(c=this.props).onClick)==null||l.call(c,i[1],i[2],i[3]);const a=this.handleSelected(i[2]);this.setState({content:s[i[2]].label,menu:a})},this.onKeyUp=i=>{var c,l;const a=i.currentTarget.value;(l=(c=this.props).onKeyUp)==null||l.call(c,a),o(a)}}else if(e===2){const o=this.handleSelected(null);this.setState({menu:o}),this.onClick=()=>{var a,c;const{color:i}=this.state;(c=(a=this.props).onClick)==null||c.call(a,i)}}else if(e===4||e===5){if(!s.length)return;let o=s.findIndex(c=>c.selected);o<0&&(o=0);const i=s[o],a=this.handleSelected(o);this.setState({menu:a,value:i.value}),this.onClick=(...c)=>{var l,u,h,d;if(c.length){(u=(l=this.props).onClick)==null||u.call(l,c[1],c[2],c[3]);const f=this.handleSelected(c[2]);this.setState({menu:f,value:s[c[2]].value})}else(d=(h=this.props).onClick)==null||d.call(h,this.state.value)}}}resetMenu(e,t){var r;const s=[];for(let o=0;o<e.length;o++){let i=!1;t||(i=(r=e[o].selected)!=null?r:!1),s[o]={label:""},s[o].label=m(Ur,{disabled:e[o].disabled,border:e[o].border,selected:i,label:e[o].label,suffix:e[o].suffix}),s[o].disabled=e[o].disabled,s[o].style=e[o].style,s[o].value=e[o].value,s[o].className=e[o].className,s[o].onClick=e[o].onClick,e[o].children&&(s[o].children=this.getChildren(e[o].children))}return this.props.type===2&&(s[0]={label:m(Ur,{label:m(Xn,{style:{display:"block"},ref:o=>this.ColorRef=o,color:"#000",onClick:o=>{this.ColorRef.hideSelect(),this.setState({color:o},()=>{this.onClick()})}})})}),s}getChildren(e){return e.map(s=>{const r=this.props.hideSelectedIcon?!1:s.selected;return s.label=m(Ur,{disabled:s.disabled,border:s.border,selected:r,label:s.label,suffix:s.suffix}),s.children&&(s.children=this.getChildren(s.children)),s})}render(){const{type:e=0}=this.props;return m("div",{className:it.selectComponent},this.getType(e))}}class Nv extends ye{constructor(){super(...arguments),this.toolbarWarp=ge(),this.toolbarRef=ge(),this.moreBtn=ge(),this.moreToolRef=ge(),this.SelectRef=ge(),this.moreTool=()=>{let e=this.state.more;this.setState({more:!e}),e||document.addEventListener("click",this.hide,!0)},this.hide=e=>{this.moreToolRef.current.contains(e.target)||(e.stopImmediatePropagation(),this.setState({more:!1}),document.removeEventListener("click",this.hide,!0))},this.resetLabel=e=>{var s,r;const t=this._context.getPluginManager().getPluginByName(dt.SLIDE);for(let o=0;o<e.length;o++){const i=e[o];if(i.customLabel){const a=t==null?void 0:t.getRegisterComponent(i.customLabel.name);if(a){const c=(s=i.customLabel.props)!=null?s:{};i.label=m(a,{...c})}}if(i.customSuffix){const a=t==null?void 0:t.getRegisterComponent(i.customSuffix.name);if(a){const c=(r=i.customSuffix.props)!=null?r:{};i.suffix=m(a,{...c})}}i.children&&(i.children=this.resetLabel(i.children))}return e},this.setToolBar=e=>{e=this.resetLabel(e),this.setState({toolList:e})}}initialize(e){const t=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=t.getComponentRender(),this.state={more:!1,toolList:[],defaultToolList:[],moreToolList:[],index:0,toolbarListWidths:[],moreText:""}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onToolBarDidMountObservable"))==null||e.notifyObservers(this)}render(e,t){const{toolList:s}=t,r=this.Render.renderFunction("Button"),o=this.Render.renderFunction("Container"),i=this.Render.renderFunction("Tooltip");return m(o,{style:{position:"relative"}},m("div",{className:Ln.toolbarWarp,ref:this.toolbarWarp},m("div",{className:Ln.toolbar,ref:this.toolbarRef},s.map(a=>a.toolbarType?m(i,{title:a.tooltip,placement:"bottom"},m(Wp,{label:a.label,onClick:a.onClick})):m(xv,{tooltip:a.tooltip,type:a.type,display:a.display,children:a.children,customLabel:a.customLabel,customSuffix:a.customSuffix,label:a.label,onClick:a.onClick,onKeyUp:a.onKeyUp,defaultColor:a.defaultColor,hideSelectedIcon:a.hideSelectedIcon,selectClassName:a.selectClassName}))),this.state.moreToolList.length===0?null:m("div",{ref:this.moreBtn,className:Ln.singleButton},m(i,{title:this.state.moreText,placement:"bottom"},m(r,{type:"text",onClick:this.moreTool},m("div",{style:{fontSize:"14px"}},this.state.moreText))))),m("div",{className:`${Ln.moreTool} ${this.state.more?Ln.moreShow:null}`,ref:this.moreToolRef}))}}class Mv extends ye{initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={infoList:null}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onInfoBarDidMountObservable",dt.SLIDE))==null||e.notifyObservers(this)}setInfoList(e){this.setState({infoList:e})}render(){if(!this.state.infoList)return;const e=this.Render.renderFunction("Button"),t=this.Render.renderFunction("Container"),s=this.Render.renderFunction("Input"),r=this.Render.renderFunction("Tooltip"),o=this.Render.renderFunction("DropDownIcon");this.Render.renderFunction("LogoIcon");const{back:i,sheet:a,update:c,save:l,rename:u}=this.state.infoList;return m(t,{className:"universheet-info-detail"},m("div",{style:{marginRight:"18px"}},m(r,{title:i.label,placement:"bottom"},m(e,{className:"universheet-info-return",type:"text"},m(o,{rotate:90})))),m("div",{className:"sheet-name"},m(r,{title:u.label,placement:"bottom"},m(s,{bordered:!1,value:a.label,onBlur:a.onBlur}))),m("div",{id:"universheet-info-detail-update",className:"universheet-info-detail-update"},c.label),m("div",{id:"universheet-info-detail-save",className:"universheet-info-detail-save"},l.label))}}const kv="univer-slide-bar",Bv="univer-slide-bar-content",Lv="univer-slide-bar-item",Fv="univer-slide-bar-box",Hv="univer-slide-bar-item-active",Pv="univer-slide-add-button";var Zt={slideBar:kv,slideBarContent:Bv,slideBarItem:Lv,slideBarBox:Fv,slideBarItemActive:Hv,slideAddButton:Pv};class zv extends ye{constructor(){super(...arguments),this.slideBarRef=ge()}initialize(){const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this._render=e.getComponentRender(),this.state={slideList:[]}}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onSlideBarDidMountObservable",dt.SLIDE))==null||e.notifyObservers(this)}setSlide(e){this.setState({slideList:e})}handleClick(e,t){var r,o;const s=(r=this.slideBarRef.current)==null?void 0:r.querySelectorAll(`.${Zt.slideBarItem}`);if(s!=null){for(let i=0;i<s.length;i++)s[i].classList.remove(Zt.slideBarItemActive);s[t].classList.add(Zt.slideBarItemActive),(o=this._context.getObserverManager().getObserver("onSlideBarMousedownObservable",dt.SLIDE))==null||o.notifyObservers(e)}}render(){const e=this._render.renderFunction("Button"),{addSlide:t}=this.props,{slideList:s}=this.state;return m("div",{className:Zt.slideBar,ref:this.slideBarRef},m("div",{className:Zt.slideBarContent},s.map((r,o)=>m("div",{className:Zt.slideBarItem,onClick:()=>this.handleClick(r.id,o)},m("span",null,o+1),m("div",{className:Zt.slideBarBox})))),m("div",{className:Zt.slideAddButton},m(e,{type:"text",onClick:t},"+")))}}const Ds={outerLeft:!1,outerRight:!0,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!0,frozenHeaderRT:!0,frozenHeaderLM:!0,frozenContent:!0,infoBar:!0,toolBar:!0,toolBarConfig:{undoRedo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,mergeCell:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,image:!0,link:!0,chart:!0,comment:!0,pivotTable:!0,function:!0,frozenMode:!0,sortAndFilter:!0,conditionalFormat:!0,dataValidation:!0,splitColumn:!0,screenshot:!0,findAndReplace:!0,protection:!0,print:!0},contentSplit:!1};class Uv extends ye{constructor(e){super(e,{coreContext:e.config.context}),this.splitLeftRef=ge(),this.rightRef=ge(),this.menuRef=ge(),this.cellRightRef=ge(),this.btnRef=ge(),this.contentRef=ge(),this.layoutContainerRef=ge(),this.containerRef=ge(),this.refMap={},this.resizeSplitContent=()=>{},this.handleSplitBarMouseDown=h=>{var f,g,b,p,v;this.leftContentLeft=(f=this.splitLeftRef.current)==null?void 0:f.getBoundingClientRect().left,this.leftContentTop=(g=this.splitLeftRef.current)==null?void 0:g.getBoundingClientRect().top;const d=(b=this.splitLeftRef.current)==null?void 0:b.parentElement;this.rightBorderX=(p=d==null?void 0:d.getBoundingClientRect())==null?void 0:p.width,this.rightBorderY=(v=d==null?void 0:d.getBoundingClientRect())==null?void 0:v.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=h=>{h=h||window.event;let d=h.clientX-this.leftContentLeft,f=h.clientY-this.leftContentTop;d=d>=this.rightBorderX?this.rightBorderX:d,f=f>=this.rightBorderY?this.rightBorderY:f,this.state.layout.contentSplit==="vertical"?this.splitLeftRef.current.style.height=`${f}px`:this.splitLeftRef.current.style.width=`${d}px`},this.handleSplitBarMouseUp=h=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleContentClick=h=>{};const{container:t,skin:s,layout:r,context:o,addSider:i,addMain:a,showSiderByName:c,showMainByName:l}=e.config;i(this.addSider.bind(this)),a(this.addMain.bind(this)),c(this.showSiderByName.bind(this)),l(this.showMainByName.bind(this));const u=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=u.getComponentRender(),this.setSkin(t,s),this.state={layout:r==="auto"?S.deepClone(Ds):S.deepMerge(Ds,r),currentLocale:o.getLocale().options.currentLocale,currentSkin:s,printVisible:!0,isCellEditorVisible:!1,siderPanelList:[],mainList:[],showSider:!1,renderState:0}}setSkin(e,t){let s=document.documentElement,o={default:Zb,dark:U4,green:xp}[t];o=Object.fromEntries(Object.keys(o).map(c=>[`--${c.replace(/([A-Z])/g,"-$1").toLowerCase()}`,o[c]])),S.isIEBrowser()?Ut({rootElement:s,variables:o}):i(e.id).insertRule(`#${e.id} ${JSON.stringify(o).replace(/"/g,"").replace(/,(?=--)/g,";")}`);function i(c){const l="universheet-skin-style";for(let d=0;d<document.styleSheets.length;d++)if(document.styleSheets[d].title===l)return a(document.styleSheets[d],c),document.styleSheets[d];const u=document.head||document.getElementsByTagName("head")[0],h=document.createElement("style");return h.title=l,u.appendChild(h),document.styleSheets[document.styleSheets.length-1]}function a(c,l){let u=0;for(let h=0;h<c.cssRules.length;h++){const d=c.cssRules[h];if(d instanceof CSSStyleRule&&d.selectorText===`#${l}`){u=h,c.deleteRule(u);break}}}}addSider(e){return new Promise(t=>{this.setState(s=>{const r=Object.assign(e,{show:!1,zIndex:s.siderPanelList.length+1});return{siderPanelList:[...s.siderPanelList,r]}},()=>{t()})})}addMain(e){return new Promise(t=>{this.setState(s=>{const r=Object.assign(e,{show:!1,zIndex:s.mainList.length+1});return{mainList:[...s.mainList,r]}},()=>{t()})})}showSiderByName(e,t){return new Promise(s=>{this.setState(r=>{let o=!1,i=0,a=r.siderPanelList.map(l=>(l.name===e&&(i=l.zIndex),l.zIndex));return{siderPanelList:r.siderPanelList.map(l=>(l.name===e?(l.show=t,l.zIndex=Math.max(...a)):l.zIndex>i&&l.zIndex--,l.show&&(o=!0),l)),showSider:o}},()=>{s()})})}showMainByName(e,t){return new Promise(s=>{this.setState(r=>({mainList:r.mainList.map(i=>(i.name===e&&(i.show=t),i))}),()=>{s()})})}componentWillUnmount(){}componentDidMount(){this.props.config.getSplitLeftRef(this.splitLeftRef),this.props.config.getContentRef(this.contentRef),this.props.config.onDidMount(),this.setState(e=>({...e,renderState:1}),()=>{var e;(e=this.getContext().getPluginManager().getRequirePluginByName(dt.SLIDE).getObserver("onSlideContainerDidMountObservable"))==null||e.notifyObservers(this)})}addSlide(){this.getContext().getPluginManager().getRequirePluginByName(dt.SLIDE).getSlideBarControl().addSlide()}render(){const{addButton:e,context:t}=this.props.config,{layout:s,currentLocale:r,currentSkin:o,siderPanelList:i,mainList:a,showSider:c,renderState:l}=this.state;return m(So.Provider,{value:{locale:t.getLocale(),currentLocale:t.getLocale().options.currentLocale,coreContext:t}},m(js,{ref:this.layoutContainerRef,className:qt.layoutContainer},m(Ks,null,m(rs,{style:{display:s.outerLeft?"block":"none"}}),m(Ks,{className:qt.mainContent,style:{position:"relative"}},m(Cc,{style:{display:s.header?"block":"none"}},s.infoBar&&m(Mv,null),s.toolBar&&m(Nv,{toolList:[]})),m(Ks,null,m(rs,{style:{width:"300px",display:s.innerLeft?"block":"none"}},m(zv,{addSlide:this.addSlide.bind(this)})),m(Ec,{className:s.contentSplit==="vertical"?qt.contentContainerVertical:qt.contentContainerHorizontal},a.map((u,h)=>{if(u.type===Vs.JSX)return er(u.content,{style:{display:u.show?"":"none"}});if(u.type===Vs.JSX_STRING){const d=this.Render.renderFunction(u.content);return this.refMap[u.name]=ge(),m(d,{ref:this.refMap[u.name],style:{display:u.show?"":"none"}})}return u}),!!s.contentSplit&&m(js,{ref:this.splitLeftRef,className:qt.contentInnerLeftContainer},m("div",{className:qt.hoverCursor,onMouseDown:this.handleSplitBarMouseDown})),m(js,{ref:this.contentRef,className:qt.contentInnerRightContainer,onClick:this.handleContentClick})),m(rs,{style:{display:s.innerRight?"block":"none"}})),m(wc,{style:{display:s.footer?"block":"none"}})),m(rs,{style:{display:s.outerRight&&c?"block":"none"},className:qt.outerRightContainer},i.map((u,h)=>u.type===Vs.JSX?er(u.label,{style:{display:u.show?"":"none",zIndex:u.zIndex}}):u)))))}}const Wv=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],Vv=[{locale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{locale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{locale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{locale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{locale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"\u5FAE\u8F6F\u96C5\u9ED1"},value:"\u5FAE\u8F6F\u96C5\u9ED1"},{locale:"fontFamily.SimSun",style:{"font-family":"\u5B8B\u4F53"},value:"\u5B8B\u4F53"},{locale:"fontFamily.SimHei",style:{"font-family":"\u9ED1\u4F53"},value:"\u9ED1\u4F53"},{locale:"fontFamily.Kaiti",style:{"font-family":"\u6977\u4F53"},value:"\u6977\u4F53"},{locale:"fontFamily.FangSong",style:{"font-family":"\u4EFF\u5B8B"},value:"\u4EFF\u5B8B"},{locale:"fontFamily.NSimSun",style:{"font-family":"\u65B0\u5B8B\u4F53"},value:"\u65B0\u5B8B\u4F53"},{locale:"fontFamily.STXinwei",style:{"font-family":"\u534E\u6587\u65B0\u9B4F"},value:"\u534E\u6587\u65B0\u9B4F"},{locale:"fontFamily.STXingkai",style:{"font-family":"\u534E\u6587\u884C\u6977"},value:"\u534E\u6587\u884C\u6977"},{locale:"fontFamily.STLiti",style:{"font-family":"\u534E\u6587\u96B6\u4E66"},value:"\u534E\u6587\u96B6\u4E66"},{locale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{locale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{locale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}];class la extends ye{initialize(){var t;const e=this._context.getPluginManager().getPluginByName("ComponentSheet");this.Render=e.getComponentRender(),this.state={locale:"",color:(t=this.props.color)!=null?t:"#000"}}componentWillMount(){var e;this.setLocale(),this._localeObserver=(e=this._context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null?void 0:e.add(()=>{this.setLocale()})}componentWillUnmount(){}componentDidMount(){var e;(e=this._context.getObserverManager().getObserver("onLineColorDidMountObservable"))==null||e.notifyObservers(this)}setLocale(){const e=this.context.locale;this.setState({locale:e.get("borderLine.borderColor")})}setColor(e){this.setState({color:e})}render(){const e=this.Render.renderFunction("RightIcon"),{locale:t,color:s}=this.state;return m("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},m("span",{style:{display:"inline-block",borderBottom:`3px solid ${s}`}},t),m(e,null))}}class Gv{get config(){return this._config}get toolList(){return this._toolList}set config(e){this._config=e}set toolList(e){this._toolList=e}}class $v{constructor(e){this._plugin=e,this._plugin.getPluginName(),this._initRegisterComponent();const t=this._plugin.config.layout==="auto"?S.deepClone(Ds.toolBarConfig):S.deepMerge(Ds.toolBarConfig,this._plugin.config.layout.toolBarConfig);this._borderInfo={color:"#000",width:"1"},this._toolList=[{toolbarType:1,tooltipLocale:"toolbar.undo",customLabel:{name:"ForwardIcon"},show:t.undoRedo,onClick:()=>{this.setUndo()}},{toolbarType:1,tooltipLocale:"toolbar.redo",customLabel:{name:"BackIcon"},show:t.undoRedo,onClick:()=>{this.setRedo()}},{type:0,tooltipLocale:"toolbar.font",selectClassName:Ln.selectLabelString,show:t.font,border:!0,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||r.notifyObservers(s)},children:Vv},{type:1,tooltipLocale:"toolbar.fontSize",label:String(Ps.fs),show:t.fontSize,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||r.notifyObservers(s)},onKeyUp:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||r.notifyObservers(s)},children:Wv},{toolbarType:1,tooltipLocale:"toolbar.bold",customLabel:{name:"BoldIcon"},show:t.bold,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||r.notifyObservers(s)}},{toolbarType:1,tooltipLocale:"toolbar.italic",customLabel:{name:"ItalicIcon"},show:t.italic,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||r.notifyObservers(s)}},{toolbarType:1,tooltipLocale:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},show:t.strikethrough,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||r.notifyObservers(s)}},{toolbarType:1,tooltipLocale:"toolbar.underline",customLabel:{name:"UnderLineIcon"},show:t.underline,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||r.notifyObservers(s)}},{type:2,tooltipLocale:"toolbar.textColor.main",customLabel:{name:"TextColorIcon"},show:t.textColor,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||r.notifyObservers(s)}},{type:2,tooltipLocale:"toolbar.fillColor.main",customLabel:{name:"FillColorIcon"},show:t.fillColor,onClick:s=>{var r;(r=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||r.notifyObservers(s)}}],this._toolBarModel=new Gv,this._toolBarModel.config=t,this._toolBarModel.toolList=this._toolList,this.init()}init(){var e,t,s,r,o,i,a,c,l,u;(e=this._plugin.getObserver("onAfterChangeFontFamilyObservable"))==null||e.add(h=>{this.setFontFamily(h)}),(t=this._plugin.getObserver("onAfterChangeFontSizeObservable"))==null||t.add(h=>{this.setFontSize(h)}),(s=this._plugin.getObserver("onAfterChangeFontWeightObservable"))==null||s.add(h=>{this.setFontWeight(h)}),(r=this._plugin.getObserver("onAfterChangeFontItalicObservable"))==null||r.add(h=>{this.setFontStyle(h)}),(o=this._plugin.getObserver("onAfterChangeFontStrikethroughObservable"))==null||o.add(h=>{this.setStrikeThrough(h)}),(i=this._plugin.getObserver("onAfterChangeFontUnderlineObservable"))==null||i.add(h=>{this.setUnderline(h)}),(a=this._plugin.getObserver("onAfterChangeFontColorObservable"))==null||a.add(h=>{this.setFontColor(h)}),(c=this._plugin.getObserver("onAfterChangeFontBackgroundObservable"))==null||c.add(h=>{this.setBackground(h)}),(l=this._plugin.getObserver("onToolBarDidMountObservable"))==null||l.add(h=>{this._toolBarComponent=h,this.resetToolBarList()}),(u=this._plugin.context.getObserverManager().getObserver("onAfterChangeUILocaleObservable","workbook"))==null||u.add(()=>{})}_initRegisterComponent(){const e=this._plugin.context.getPluginManager().getPluginByName("ComponentSheet"),t=this._plugin.getPluginName();this.Render=e.getComponentRender();const s={ForwardIcon:this.Render.renderFunction("ForwardIcon"),BackIcon:this.Render.renderFunction("BackIcon"),BoldIcon:this.Render.renderFunction("BoldIcon"),ItalicIcon:this.Render.renderFunction("ItalicIcon"),DeleteLineIcon:this.Render.renderFunction("DeleteLineIcon"),UnderLineIcon:this.Render.renderFunction("UnderLineIcon"),TextColorIcon:this.Render.renderFunction("TextColorIcon"),FillColorIcon:this.Render.renderFunction("FillColorIcon"),MergeIcon:this.Render.renderFunction("MergeIcon"),TopBorderIcon:this.Render.renderFunction("TopBorderIcon"),BottomBorderIcon:this.Render.renderFunction("BottomBorderIcon"),LeftBorderIcon:this.Render.renderFunction("LeftBorderIcon"),RightBorderIcon:this.Render.renderFunction("RightBorderIcon"),NoneBorderIcon:this.Render.renderFunction("NoneBorderIcon"),FullBorderIcon:this.Render.renderFunction("FullBorderIcon"),OuterBorderIcon:this.Render.renderFunction("OuterBorderIcon"),InnerBorderIcon:this.Render.renderFunction("InnerBorderIcon"),StripingBorderIcon:this.Render.renderFunction("StripingBorderIcon"),VerticalBorderIcon:this.Render.renderFunction("VerticalBorderIcon"),LeftAlignIcon:this.Render.renderFunction("LeftAlignIcon"),CenterAlignIcon:this.Render.renderFunction("CenterAlignIcon"),RightAlignIcon:this.Render.renderFunction("RightAlignIcon"),TopVerticalIcon:this.Render.renderFunction("TopVerticalIcon"),CenterVerticalIcon:this.Render.renderFunction("CenterVerticalIcon"),BottomVerticalIcon:this.Render.renderFunction("BottomVerticalIcon"),OverflowIcon:this.Render.renderFunction("OverflowIcon"),BrIcon:this.Render.renderFunction("BrIcon"),CutIcon:this.Render.renderFunction("CutIcon"),TextRotateIcon:this.Render.renderFunction("TextRotateIcon"),TextRotateAngleUpIcon:this.Render.renderFunction("TextRotateAngleUpIcon"),TextRotateAngleDownIcon:this.Render.renderFunction("TextRotateAngleDownIcon"),TextRotateVerticalIcon:this.Render.renderFunction("TextRotateVerticalIcon"),TextRotateRotationUpIcon:this.Render.renderFunction("TextRotateRotationUpIcon"),TextRotateRotationDownIcon:this.Render.renderFunction("TextRotateRotationDownIcon")};this._plugin.registerComponent(t+la.name,la),this._plugin.registerComponent(t+Xn.name,Xn);for(let r in s)this._plugin.registerComponent(r,s[r])}resetLocale(e){const t=this._plugin.context.getLocale();for(let s=0;s<e.length;s++){const r=e[s];r.tooltipLocale&&(r.tooltip=t.get(r.tooltipLocale)),r.locale&&(r.label=t.get(r.locale)),r.suffixLocale&&(r.suffix=t.get(r.suffixLocale)),r.children&&(r.children=this.resetLocale(r.children))}return e}resetToolBarList(){const e=this.resetLocale(this._toolList);this._toolBarComponent.setToolBar(e)}setRedo(){this._plugin.getContext().getCommandManager().redo()}setUndo(){this._plugin.getContext().getCommandManager().undo()}setFontColor(e){}setBackground(e){}setFontSize(e){}setFontFamily(e){}setFontWeight(e){}setFontStyle(e){}setStrikeThrough(e){}setUnderline(e){}}class Yv{constructor(e){this._plugin=e,this._initialize()}_initialize(){}}class Xv{constructor(e){this._name=e}get name(){return this._name}setName(e){this._name=e}}class jv{constructor(e){this._plugin=e;const t="UniverSlide Demo";this._infoBarModel=new Xv(t),this._infoList={back:{locale:"info.return"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},rename:{locale:"info.tips"},sheet:{label:t,onBlur:s=>{this.setSlideName(s)}}},this._initialize()}_initialize(){this._plugin.context.getObserverManager().requiredObserver("onInfoBarDidMountObservable",dt.SLIDE).add(s=>{this._infoBar=s,this.resetInfoList(this._infoList)})}resetInfoList(e){const t=this._plugin.context.getLocale();for(let s in e)e[s].locale&&(e[s].label=t.get(e[s].locale));this._infoBar.setInfoList(e)}setSlideName(e){const s=e.target.value;this._infoBarModel.setName(s)}}class Kv{constructor(e){this._pages=[],this._plugin=e,this._init()}_init(){const t=this._plugin.context.getObserverManager();this._generateModel(),t.requiredObserver("onSlideBarDidMountObservable",dt.SLIDE).add(s=>{var r;this._slideBar=s,this._slideBar.setSlide(this._pages),(r=this._plugin.getObserver("onSlideContainerDidMountObservable"))==null||r.add(()=>{this._getCanvasView().createSideThumb(this._slideBar,this._pages)})})}_getCanvasView(){return this._plugin.getCanvasView()}_generateModel(){const e=this._plugin.context.getSlide(),t=e.getPages(),s=e.getPageOrder();!t||!s||s.forEach(r=>{this._pages.push(t[r])})}addSlide(){const e=this._plugin.context.getSlide(),t=this._getCanvasView(),s=e.addPage();this._pages.push(s),this._slideBar.setSlide(this._pages),t.createSideThumb(this._slideBar,this._pages)}}class qv{constructor(){this.zIndex=0,this.viewKey=""}getScene(){return this._scene}getPlugin(){return this._plugin}getContext(){return this._plugin.getContext()}updateToSheet(){}_initialize(){}initialize(e,t){return this._scene=e,this._plugin=t,this._initialize(),this}}var fs=(n=>(n.MAIN_SCENE="mainScene",n.SLIDE_VIEW="slideView",n))(fs||{});const xc=ln.create(),Zv={documentId:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Se.COLUMN,posOffset:100},positionV:{relativeFrom:xe.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:pt.WRAP_SQUARE,behindDoc:L.FALSE,wrapText:an.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Fe.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Fe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Fe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Fe.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:je.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Fe.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:je.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Fe.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:je.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Dt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:F.DRAWING},{elementId:"smallSub",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},Jv={id:"d",body:{blockElements:{twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u795D\u8D3ABabylon\u4E2D\u6587\u7F51\u987A\u5229\u542F\u52A8\uFF01",ts:{fs:30,cl:{rgb:"rgb(196,62,28)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["twoParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};class Qv extends qv{constructor(){super(...arguments),this.zIndex=1,this.viewKey=fs.SLIDE_VIEW}_initialize(){const e=this.getScene();this.getContext().getSlide();const s=e.getEngine();if(!s)return;const r=1384,o=500,{width:i,height:a}=s,c=i/2-r/2,l=a/2-o/2,u=new Ze("canvas",{left:c,top:l,width:r,height:o,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),h=new Cs("picture",{url:"https://cnbabylon.com/assets/img/banner_doc_cnbabylon.jpg",top:l+68,left:c,width:1384,height:432,zIndex:13,isTransformer:!0}),d=new Ll(this.getContext(),"richText1",{richText:Jv,width:420,zIndex:20,left:i/2-210,top:l+10,isTransformer:!0});e.openTransformer(),e.addObjects([u,h,d])}getDocumentSkeleton(){return this._documentSkeleton}getDocs(){return this._documents}_buildSkeleton(){const e=this.getContext();return pr.create(Zv,e)}}xc.add(new Qv);class Ho{constructor(){this.zIndex=0}check(e){if(e===this.viewKey)return this}convert(e,t){}}const Dr=ln.create();class e5 extends Ho{constructor(){super(...arguments),this.zIndex=1,this.viewKey=Nt.IMAGE}check(e){if(e===this.viewKey)return this}convert(e){const{id:t,zIndex:s,left:r=0,top:o=0,width:i,height:a,angle:c,scaleX:l,scaleY:u,skewX:h,skewY:d,flipX:f,flipY:g,title:b,description:p,image:v={}}=e,{imageProperties:C,placeholder:w,link:x}=v,A=(C==null?void 0:C.contentUrl)||"";return new Cs(t,{url:A,top:o,left:r,width:i,height:a,zIndex:s,angle:c,scaleX:l,scaleY:u,skewX:h,skewY:d,flipX:f,flipY:g,isTransformer:!0,forceRender:!0})}}Dr.add(new e5);class t5 extends Ho{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Nt.TEXT}check(e){if(e===this.viewKey)return this}convert(e,t){if(t==null)return;const{id:s,zIndex:r,left:o=0,top:i=0,width:a,height:c,angle:l,scaleX:u,scaleY:h,skewX:d,skewY:f,flipX:g,flipY:b,title:p,description:v,richText:C={}}=e,{text:w,ff:x,fs:A,it:z,bl:R,ul:E,st:D,ol:M,bg:P,bd:G,cl:T,rich:y}=C;let O={top:i,left:o,width:a,height:c,zIndex:r,angle:l,scaleX:u,scaleY:h,skewX:d,skewY:f,flipX:g,flipY:b,isTransformer:!0,forceRender:!0},U=!1;if(w!=null?(O={...O,text:w,ff:x,fs:A,it:z,bl:R,ul:E,st:D,ol:M,bg:P,bd:G,cl:T},U=!0):y!=null&&(O={...O,richText:y},U=!0),U!==!1)return new Ll(t,s,O)}}Dr.add(new t5);class n5 extends Ho{constructor(){super(...arguments),this.zIndex=2,this.viewKey=Nt.SHAPE}check(e){if(e===this.viewKey)return this}convert(e){const{id:t,zIndex:s,left:r=0,top:o=0,width:i,height:a,angle:c,scaleX:l,scaleY:u,skewX:h,skewY:d,flipX:f,flipY:g,title:b,description:p}=e,{shapeType:v,text:C,shapeProperties:w,placeholder:x,link:A}=e.shape||{},z=w==null?"":bn(w.shapeBackgroundFill)||"";if(v===Hn.RECTANGLE)return new Ze(t,{fill:z,top:o,left:r,width:i,height:a,zIndex:s,angle:c,scaleX:l,scaleY:u,skewX:h,skewY:d,flipX:f,flipY:g,isTransformer:!0,forceRender:!0});if(v===Hn.ROUND_RECTANGLE){const R=(w==null?void 0:w.radius)||0;return new Ze(t,{fill:z,top:o,left:r,width:i,height:a,zIndex:s,angle:c,scaleX:l,scaleY:u,skewX:h,skewY:d,flipX:f,flipY:g,isTransformer:!0,forceRender:!0,radius:R})}else Hn.ELLIPSE}}Dr.add(new n5);class Po{constructor(){this._adaptors=[],this._adaptorLoader()}convertToRenderObjects(e,t){const s=Object.keys(e),r=[];return s.forEach(o=>{const i=e[o],a=this._executor(i,t);a!=null&&r.push(a)}),r}_executor(e,t){var o;const{id:s,type:r}=e;for(let i of this._adaptors){const a=(o=i.check(r))==null?void 0:o.convert(e,t);if(a!=null)return a}}_adaptorLoader(){Dr.getData().sort(rt).forEach(e=>{this._adaptors.push(e)})}static create(){return new Po}}class s5{constructor(e,t){this._engine=e,this._plugin=t,this._views=[],this._slideThumbEngine=new Map,this._ObjectProvider=new Po,this._pageScene=new Map,this._initialize()}getView(e){for(let t of this._views)if(t.viewKey===e)return t}getDocsView(){return this.getView(fs.SLIDE_VIEW)}createSideThumb(e,t){var c;const r=(c=e.slideBarRef.current)==null?void 0:c.childNodes[0].childNodes;if(r==null||r.length!==t.length)return;const o=this._plugin.context;for(var i=0,a=r.length;i<a;i++){const l=r[i].querySelector("div"),{id:u,pageElements:h}=t[i];if(this._slideThumbEngine.has(u)||!l)continue;const d=this._createThumb(l,u),f=this._ObjectProvider.convertToRenderObjects(h,o);d.addObjects(f),this._thumbSceneRender(d)}}_initialize(){const e=this._engine;this._plugin.getContext();const t=new Bi(fs.MAIN_SCENE,e,{width:2400,height:1800});this._scene=t;const s=new Li(fs.SLIDE_VIEW,t,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});t.addViewport(s).attachControl(),t.on(nt.wheel,(c,l)=>{const u=c;if(u.ctrlKey){const h=Math.abs(u.deltaX);let d=h<40?.2:h<80?.4:.2;d*=u.deltaY>0?-1:1,t.scaleX<1&&(d/=2),t.scaleX+d>4?t.scale(4,4):t.scaleX+d<.1?t.scale(.1,.1):(u.deltaY>0,u.preventDefault())}else s.onMouseWheel(u,l)}),Co.attachTo(s);const{left:r,top:o}=this._getCenterPositionViewPort(),{x:i,y:a}=s.getBarScroll(r,o);s.scrollTo({x:i,y:a}),this.activePage(),e.runRenderLoop(()=>{t.render();const c=document.getElementById("app");c&&(c.innerText=`fps:${Math.round(e.getFps()).toString()}`)})}activePage(e){const t=this._plugin.context.getSlide();let s;if(e)s=t.getPage(e);else{const p=t.getPages(),v=t.getPageOrder();if(v==null||p==null)return;s=p[v[0]],e=s.id}if(s==null)return;const r=this._scene,{width:o,height:i}=r,{id:a,pageElements:c}=s,l=t.getPageSize(),{width:u=100,height:h=100}=l,d=new fd(a,{left:(o-u)/2,top:(i-h)/2,width:u,height:h,zIndex:10}),f=this._createScene(a,d),g=this._ObjectProvider.convertToRenderObjects(c,this._plugin.context);f.openTransformer(),this._addBackgroundRect(f),f.addObjects(g);const b=r.getObject(this._activePageId);b==null||b.dispose(),r.addObject(d),this._activePageId=e}_addBackgroundRect(e){const s=this._plugin.context.getSlide().getPageSize(),{width:r=0,height:o=0}=s,i=new Ze("canvas",{left:0,top:0,width:r,height:o,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:0,evented:!1});e.addObject(i,0)}_getCenterPositionViewPort(){const{width:e,height:t}=this._scene,s=this._scene.getEngine(),r=(s==null?void 0:s.width)||0,o=(s==null?void 0:s.height)||0;return{left:(e-r)/2,top:(t-o)/2}}_thumbSceneRender(e){const s=this._plugin.context.getSlide().getPageSize(),{width:r,height:o}=e,{width:i=r,height:a=o}=s;e.scale(r/i,o/a),e.render()}_createThumb(e,t){const s=new Rl;return s.setContainer(e),this._slideThumbEngine.set(t,s),this._createScene(t,s)}_createScene(e,t,s,r){let{width:o,height:i}=t;s!=null&&(o=s),r!=null&&(i=r);const a=new Bi("Page_"+e,t,{width:o,height:i}),c=new Li("PageViewer_"+e,a,{left:0,top:0,bottom:0,right:0});return c.closeClip(),a.addViewport(c),a}_viewLoader(e,t){xc.getData().sort(rt).forEach(s=>{this._views.push(s.initialize(e,t))})}}const r5={container:"universlide",layout:Ds};class zo extends fr{constructor(e={}){super(dt.SLIDE),this._config=S.commonExtend(r5,e)}static create(e){return new zo(e)}installTo(e){e.installPlugin(this)}initialize(){var o;const e=this.getContext();(o=this.getObserver("onSlideContainerDidMountObservable"))==null||o.add(()=>{this._initializeRender()}),e.getLocale().load({en:q_,zh:K_}),this._componentList=new Map;const t=this._config.layout;t.toolBar&&(this._toolBarControl=new $v(this)),t.infoBar&&(this._infoBarControl=new jv(this)),this._slideBarControl=new Kv(this),this._SlideController=new Yv(this);const s=this._initContainer(this._config.container),r={skin:"default",layout:this._config.layout,container:s,context:e,getSplitLeftRef:i=>{this._splitLeftRef=i},getContentRef:i=>{this._contentRef=i},addButton:i=>{this._addButtonFunc=i},addSider:i=>{this._addSiderFunc=i},addMain:i=>{this._addMainFunc=i},showSiderByName:i=>{this._showSiderByNameFunc=i},showMainByName:i=>{this._showMainByNameFunc=i},onDidMount:()=>{}};zn(m(Uv,{config:r}),s)}_initContainer(e){let t=null;if(typeof e=="string"){const s=document.getElementById(e);s==null?(t=document.createElement("div"),t.id=e):t=s}else Qd(e)?t=e:(t=document.createElement("div"),t.id="universlide");return t}_initializeRender(){var t;const e=(t=this.getPluginByName(dt.BASE_RENDER))==null?void 0:t.getEngine();this.register(e)}register(e){let t=nf(this.getContentRef());this._canvasEngine=e,e.setContainer(t),this._canvasView=new s5(e,this),window.addEventListener("resize",()=>{e.resize()})}get config(){return this._config}getContentRef(){return this._contentRef}getToolBarControl(){return this._toolBarControl}getInfoBarControl(){return this._infoBarControl}getSlideBarControl(){return this._slideBarControl}getCanvasView(){return this._canvasView}onMounted(){Z_(this),this.initialize()}onDestroy(){}registerComponent(e,t){this._componentList.set(e,t)}getRegisterComponent(e){return this._componentList.get(e)}}const o5={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:100,height:400},positionH:{relativeFrom:Se.COLUMN,posOffset:100},positionV:{relativeFrom:xe.PARAGRAPH,posOffset:160},angle:0,imageProperties:{contentUrl:"https://cnbabylon.com/assets/img/agents.png"}},layoutType:pt.WRAP_SQUARE,behindDoc:L.FALSE,wrapText:an.BOTH_SIDES}},lists:{unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:Fe.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25CF",hanging:21,indentStart:21},{bulletAlignment:Fe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25A0",hanging:21,indentStart:42},{bulletAlignment:Fe.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"\u25C6",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:Fe.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:je.ROMAN,hanging:21,indentStart:21},{bulletAlignment:Fe.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:je.ROMAN,hanging:21,indentStart:42},{bulletAlignment:Fe.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:je.ROMAN,hanging:21,indentStart:63}]}},body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"smallSub",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Dt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"shapeTest1",paragraphElementType:F.DRAWING},{elementId:"smallSub",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},twoParagraph:{blockId:"twoParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u7EC6\u5316\u57CB\u70B9\u4E0A\u62A5\u94FE\u8DEF\u548C\u6307\u6807\u65B9\u6848\u68B3\u7406"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u76EE\u524D\u901A\u8FC7\u6BCF\u65E5\u5B9A\u65F6\u4EFB\u52A1\u53D1\u9001\u62A5\u544A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},threeParagraph:{blockId:"threeParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u81EA2018\u5E74\u9996\u5C4A\u8FDB\u535A\u4F1A\u4E3E\u529E\u4EE5\u6765\uFF0C\u8FDB\u535A\u4F1A\u5DF2\u7ECF\u6210\u4E3A\u5168\u7403\u65B0\u54C1\u7684\u9996\u53D1\u5730\u3001\u524D\u6CBF\u6280\u672F\u7684\u9996\u9009\u5730\u3001\u521B\u65B0\u670D\u52A1\u7684\u9996\u63A8\u5730\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u8FD9\u5341\u5E74\u201D\u5BF9\u5916\u5F00\u653E\u6210\u5C31\u5C55\u6E56\u5317\u5C55\u533A\u4E3B\u8981\u4EE5\u56FE\u6587\u3001\u56FE\u8868\u3001\u6570\u636E\u3001\u89C6\u9891\u3001\u4F01\u4E1A\u5C55\u54C1\u3001\u5B9E\u7269\u6A21\u578B\u3001\u5149\u7535\u79D1\u6280\u7B49\u4F53\u73B0\u6E56\u5317\u5341\u5E74\u5F00\u653E\u6210\u5C31\u3001\u91CD\u5927\u5F00\u653E\u5E73\u53F0\u53CA\u4EA7\u4E1A\u3002\u6E56\u5317\u7701\u5171\u8BA117\u5BB6\u4F01\u4E1A\u3001\u673A\u6784\u7684\u5C55\u54C1\u5C06\u5728\u8FD9\u4E00\u5C55\u533A\u5C55\u793A"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},fourParagraph:{blockId:"fourParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u56FD\u5BB6\u4E3B\u5E2D\u4E60\u8FD1\u5E73\u4EE5\u89C6\u9891\u65B9\u5F0F\u51FA\u5E2D\u5728\u4E0A\u6D77\u4E3E\u884C\u7684\u7B2C\u4E94\u5C4A\u4E2D\u56FD\u56FD\u9645\u8FDB\u53E3\u535A\u89C8\u4F1A\u5F00\u5E55\u5F0F\u5E76\u53D1\u8868\u9898\u4E3A\u300A\u5171\u521B\u5F00\u653E\u7E41\u8363\u7684\u7F8E\u597D\u672A\u6765\u300B\u7684\u81F4\u8F9E"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u5C06\u63A8\u52A8\u5404\u56FD\u5404\u65B9\u5171\u4EAB\u6DF1\u5316\u56FD\u9645\u5408\u4F5C\u673A\u9047\uFF0C\u5168\u9762\u6DF1\u5165\u53C2\u4E0E\u4E16\u754C\u8D38\u6613\u7EC4\u7EC7\u6539\u9769\u8C08\u5224"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}},fiveParagraph:{blockId:"fiveParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:2,textStyle:{fs:20}},elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E2D\u56FD\u7537\u6392\u4E24\u540D\u73B0\u5F79\u56FD\u624B\u5F6D\u4E16\u5764\u548C\u5F20\u79C9\u9F99\u5206\u522B\u6548\u529B\u7684\u4E09\u5F97\u5229\u592A\u9633\u9E1F\u548C\u4E1C\u4EAC\u5927\u718A\u672C\u8F6E\u906D\u9047\u3002"}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u53CC\u65B9\u7ECF\u8FC7\u6FC0\u6218\uFF0C\u4E3B\u573A\u4F5C\u6218\u7684\u536B\u5195\u51A0\u519B\u4E09\u5F97\u5229\u6280\u9AD8\u4E00\u7B793-2\u9006\u8F6C\u51FB\u8D25\u5BF9\u624B\uFF0C\u529B\u593A\u7B2C3\u573A\u80DC\u5229"}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["oneParagraph","twoParagraph","threeParagraph","fourParagraph","fiveParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},cr={id:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u5728\u201C\u7B2C1\u9898\u201D\u5DE5\u4F5C\u8868\u4E2D\u5B8C\u6210\u4EE5\u4E0B\u64CD\u4F5C",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},smallSub:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u4E0A\u6807",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Dt.SUPERSCRIPT}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u65E5\u671F\u5217\u5355\u5143\u683C\u6570\u636E\u9A8C\u8BC1\uFF0C\u9650\u5236\u53EA\u80FD\u8F93\u5165\u65E5\u671F\uFF08\u4ECB\u4E8E1949\u5E741\u67081\u65E5\u81F32099\u5E741\u67081\u65E5\uFF09",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"smallSub",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};It.EN,L.FALSE,_.MEDIUM_DASHED,_.MEDIUM_DASHED,_.THICK,_.THIN,Ye.RIGHT,Vt.TOP,Ye.RIGHT,Vt.MIDDLE,Bt.WRAP,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,Bt.WRAP,Ge.GRID,S.deepClone(cr),L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,Ge.GRID,Ge.GRID,Ge.GRID,Ge.GRID,Ge.GRID;It.EN,L.FALSE,_.MEDIUM_DASHED,_.MEDIUM_DASHED,_.THICK,_.THIN,Ye.RIGHT,Vt.TOP,Bt.WRAP,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,Ge.GRID,S.deepClone(cr),L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,L.FALSE,Ge.GRID;const i5={documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u2460Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},threeElement:{eId:"threeElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u2461Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fourElement:{eId:"fourElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u2462Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fiveElement:{eId:"fiveElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement",paragraphElementType:F.PAGE_BREAK},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement1",paragraphElementType:F.PAGE_BREAK},{elementId:"threeElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:F.PAGE_BREAK},{elementId:"fourElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:F.PAGE_BREAK},{elementId:"fiveElement",paragraphElementType:F.TEXT_RUN}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}},a5={documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};It.EN,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE;It.EN,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE;It.EN,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE;const l5={documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"Instructions:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u2460Project division - Fill in the specific division of labor after the project is disassembled:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},threeElement:{eId:"threeElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u2461Responsible Person - Enter the responsible person's name here:",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fourElement:{eId:"fourElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"\u2462Date-The specific execution time of the project (detailed to the date of a certain month), and the gray color block marks the planned real-time time of the division of labor of the project (for example,",ts:{cl:{rgb:"rgb(92,92,92)"}}}},fiveElement:{eId:"fiveElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"the specific execution time of [regional scene model arrangement and construction] is the 2 days marked in gray. ",ts:{cl:{rgb:"rgb(92,92,92)"}}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement",paragraphElementType:F.PAGE_BREAK},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement1",paragraphElementType:F.PAGE_BREAK},{elementId:"threeElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:F.PAGE_BREAK},{elementId:"fourElement",paragraphElementType:F.TEXT_RUN},{elementId:"breakElement2",paragraphElementType:F.PAGE_BREAK},{elementId:"fiveElement",paragraphElementType:F.TEXT_RUN}],paragraphStyle:{spaceAbove:10,lineSpacing:1.2}}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};It.EN,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE;const c5={documentId:"d",body:{blockElements:{oneParagraph:{blockId:"oneParagraph",st:0,ed:15,blockType:De.PARAGRAPH,paragraph:{elements:{oneElement:{eId:"oneElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"No.",ts:{cl:{rgb:"#000"},fs:20}}},twoElement:{eId:"twoElement",st:0,ed:15,et:F.TEXT_RUN,tr:{ct:"2824163",ts:{cl:{rgb:"rgb(255,0,0)"},fs:20}}}},elementOrder:[{elementId:"oneElement",paragraphElementType:F.TEXT_RUN},{elementId:"twoElement",paragraphElementType:F.TEXT_RUN}]}}},blockElementOrder:["oneParagraph"]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};It.EN,L.FALSE,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THICK,_.THICK,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THICK,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,_.THIN,Ge.GRID,L.FALSE,L.FALSE,L.FALSE,L.FALSE;Se.COLUMN,xe.PARAGRAPH,pt.WRAP_SQUARE,L.FALSE,an.BOTH_SIDES,Fe.START,Fe.START,Fe.START,Fe.START,je.ROMAN,Fe.START,je.ROMAN,Fe.START,je.ROMAN,De.PARAGRAPH,F.TEXT_RUN,F.TEXT_RUN,Dt.SUPERSCRIPT,F.TEXT_RUN,F.TEXT_RUN,F.DRAWING,F.TEXT_RUN,F.TEXT_RUN,De.PARAGRAPH,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,De.PARAGRAPH,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,De.PARAGRAPH,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,De.PARAGRAPH,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,F.TEXT_RUN,De.SECTION_BREAK,Tn.NONE,cs.SECTION_TYPE_UNSPECIFIED;const u5={id:"slide_test",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{cover_1:{id:"cover_1",pageType:go.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:Nt.IMAGE,image:{imageProperties:{contentUrl:"https://minio.cnbabylon.com/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:Nt.SHAPE,shape:{shapeType:Hn.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:Nt.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:Nt.SHAPE,shape:{shapeType:Hn.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:Nt.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:Nt.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}}},pageOrder:["cover_1"]}},h5={container:"universlide"},Ir=mo.newInstance(u5);Ir.installPlugin(new Ao);Ir.installPlugin(new Y_);Ir.installPlugin(new zo(h5));Ir.installPlugin(new No);
