var t,e,n=Object.defineProperty,i=Object.defineProperties,s=Object.getOwnPropertyDescriptors,o=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,l=(t,e,i)=>e in t?n(t,e,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[e]=i,h=(t,e)=>{for(var n in e||(e={}))r.call(e,n)&&l(t,n,e[n]);if(o)for(var n of o(e))a.call(e,n)&&l(t,n,e[n]);return t},c=(t,e)=>i(t,s(e));import{n as d,a as u,d as g,F as _,k as p,w as m,b as f,y as T,_ as v,O as E,H as b,c as I,e as C,f as S,B as A}from"./vendor.js";(e=t||(t={}))[e.OBSERVER_ACTION=1]="OBSERVER_ACTION",e[e.SERVER_ACTION=2]="SERVER_ACTION",e[e.UNDO_ACTION=3]="UNDO_ACTION",e[e.EXTENSION_ACTION=4]="EXTENSION_ACTION",e[e.DEFAULT_ACTION=7]="DEFAULT_ACTION";class w{constructor(t,e){this._doActionData=t,this._observers=e,this._operation=1}getDoActionData(){return this._doActionData}getOldActionData(){return this._oldActionData}hasOperation(t){return(this._operation&t)===t}addOperation(t){this._operation|=t}removeOperation(t){this._operation&=~t}}class R{constructor(t=!1){this.isStopPropagation=!1,this.initialize(t)}initialize(t=!1){return this.skipNextObservers=t,this}stopPropagation(){this.isStopPropagation=!0}}class N{constructor(t){this.callback=t,this._willBeUnregistered=!1,this.unregisterOnNextCall=!1}}class y{constructor(t){this._observers=new Array,this._eventState=new R,t&&(this._onObserverAdded=t)}get observers(){return this._observers}add(t,e=!1,n=!1){if(!t)return null;const i=new N(t);return i.unregisterOnNextCall=n,e?this._observers.unshift(i):this._observers.push(i),this._onObserverAdded&&this._onObserverAdded(i),i}addOnce(t){return this.add(t,void 0,!0)}remove(t){if(!t)return!1;return-1!==this._observers.indexOf(t)&&(this._deferUnregister(t),!0)}removeCallback(t){for(let e=0;e<this._observers.length;e++){const n=this._observers[e];if(!n._willBeUnregistered&&n.callback===t)return this._deferUnregister(n),!0}return!1}makeObserverTopPriority(t){this._remove(t),this._observers.unshift(t)}makeObserverBottomPriority(t){this._remove(t),this._observers.push(t)}notifyObservers(t){if(!this._observers.length)return null;const e=this._eventState;e.skipNextObservers=!1,e.lastReturnValue=t,e.isStopPropagation=!1;let n=!1;for(let i=0;i<this._observers.length;i++){const s=this._observers[i];if(!s._willBeUnregistered&&(e.lastReturnValue=s.callback(t,e),s.unregisterOnNextCall&&this._deferUnregister(s),e.isStopPropagation&&(n=!0),e.skipNextObservers))return{lastReturnValue:e.lastReturnValue,stopPropagation:n}}return{lastReturnValue:e.lastReturnValue,stopPropagation:n}}notifyObserversWithPromise(t){let e=Promise.resolve(t);if(!this._observers.length)return e;const n=this._eventState;n.skipNextObservers=!1;for(let i=0;i<this._observers.length;i++){const s=this._observers[i];n.skipNextObservers||(s._willBeUnregistered||(e=e.then((()=>s.callback(t,n))),s.unregisterOnNextCall&&this._deferUnregister(s)))}return e.then((()=>t))}notifyObserver(t,e){if(t._willBeUnregistered)return;const n=this._eventState;return n.skipNextObservers=!1,t.callback(e,n),t.unregisterOnNextCall&&this._deferUnregister(t),{lastReturnValue:n.lastReturnValue,stopPropagation:n.isStopPropagation}}hasObservers(){return this._observers.length>0}clear(){this._observers=new Array,this._onObserverAdded=null}clone(){const t=new y;return t._observers=this._observers.slice(0),t}_deferUnregister(t){t.unregisterOnNextCall=!1,t._willBeUnregistered=!0,setTimeout((()=>{this._remove(t)}),0)}_remove(t){if(!t)return!1;const e=this._observers.indexOf(t);return-1!==e&&(this._observers.splice(e,1),!0)}}class O{constructor(t,e){this.name=t,this.observableHooks=e}}class D{constructor(){this._observableHooksArray=new Array}addHooks(t,e){this._observableHooksArray.push(new O(t,e))}getHooks(t){const e=this._observableHooksArray.find((e=>e.name===t));return e?e.observableHooks:null}}function M(t,e){let n=t.length-1;return n=t.length<40||e<=t[20]||e>=t[n-20]?function(t,e){let n=0,i=0,s=0,o=-1,r=t.length-1;for(;n<t.length&&r>=0&&r>=n;){if(i=t[r],s=0===r?0:t[r-1],e>=s&&e<i){o=r;break}if(i=t[n],s=0===n?0:t[n-1],e>=s&&e<i){o=n;break}n++,r--}return o}(t,e):function(t,e){let n=0,i=t.length-1;for(;n<=i;){let s=Math.floor((i+n)/2);if(e<t[s]&&(0===s||e>=t[s-1]))return s;if(e>=t[s])n=s+1;else{if(!(e<t[s]))return-1;i=s-1}}return-1}(t,e),n}const x=t=>null!=t,L=t=>{let e=Object.keys(t),n=/^\d+$/,i=0;for(let s=0;s<e.length;s++){let t=e[s];if(!n.test(t))return-1;let o=parseInt(t)+1;o>i&&(i=o)}return i};class k{constructor(...t){switch(t.length){case 0:return this._array={},void(this._length=0);case 1:{if("number"==typeof t[0])return this._array={},void(this._length=t[0]);const e=L(t[0]);if(e>-1)return this._array=t[0],void(this._length=e);throw new Error(`create object array error ${JSON.stringify(t[0])}`)}case 2:if(L(t[0])>-1)return this._array=t[0],void(this._length=t[1]);throw new Error(`create object array error ${JSON.stringify(t[0])}`)}}static objectKeys(t){if(t){const e=Object.keys(t),n=e.indexOf("length");return n>-1&&e.splice(n,1),e}return[]}static getMaxLength(t){if(t){if(t.length)return t.length;const e=k.objectKeys(t);if(e.length)return Math.max(...e)+1}return 0}obtain(t,e){var n;return null!=(n=this._array[t])?n:e}getKeys(){return k.objectKeys(this._array)}get(t){return this._array[t]}set(t,e){if(x(e)){const n=this._length;this._array[t]=e,t>=n&&(this._length=t+1)}}pop(){const t=this._length,e=this._array;if(t>0){const n=t-1,i=e[n];return n>0&&(delete e[n],this._length--),i}return null}push(t){if(x(t)){let e=this._length;this._array[e++]=t,this._length=e}}first(){return this._array[0]}last(){const t=this._length-1;return this._array[t]}shift(){const t=this._length;if(t>0){const e=this._array[0],n=t-1;let i;for(let t=0;t<n;t++)i=this._array[t+1],x(i)&&(this._array[t]=i);return this._length--,delete this._array[n],e}return null}unshift(t){if(x(t)){const e=this._length,n=this._array,i=e+1;let s=n[0];for(let t=1;t<i;t++){const e=this._array[t];x(s)&&(n[t]=s),s=e}n[0]=t,this._length=i}}clear(){this._array={},this._length=0}getLength(){return this._length}getSizeOf(){const t=this._array;return Object.keys(t).length}toJSON(){return this._array}toArray(){const t=new Array,e=this._array,n=Object.keys(e),i=n.length;for(let s=0;s<i;s++){const i=+n[s];t[i]=e[i]}return t}forEach(t){const e=this._array,n=Object.keys(e),i=n.length;for(let s=0;s<i;s++){const i=+n[s];if(!1===t(i,e[i]))return this}return this}clone(t){const e=new k;return t?this.forEach(((n,i)=>{e.set(n,t(i))})):this.forEach(((t,n)=>{e.set(t,n)})),e}isEmpty(){const t=this._array;return 0===Object.keys(t).length}delete(t){this.splice(t,1)}includes(t){const e=this._array,n=Object.keys(e),i=n.length;for(let s=0;s<i;s++){if(e[+n[s]]===t)return!0}return!1}slice(t,e){const n=this._array;if(this._length>0){const i={};let s=0;for(let o=t;o<e;o++){const t=n[o];x(t)&&(i[s]=n[o],s++)}return new k(i,s)}return new k}concat(t){const e=this._array,n=Object.keys(e),i=n.length,s=t._array,o=Object.keys(s),r=o.length,a=new k(i+r),l=a._array;let h=0;for(let c=0;c<i;c++,h++){const t=n[c];l[h]=e[t]}for(let c=0;c<r;c++,h++){const t=o[c];l[h]=s[t]}return a}find(t){const e=this._array,n=Object.keys(e),i=n.length;for(let s=0;s<i;s++){const i=+n[s],o=e[i];if(!0===t(i,o))return o}return null}splice(t,e){const n=this._length;if(n>0){const i=t+e,s=this._array;let o=0;const r={};for(let e=t;e<i;e++){const t=s[e];x(t)&&(delete s[e],r[o]=t,o++)}const a=i-t,l=n;if(this._length-=a,this._length<=0)this._array={},this._length=0;else for(let t=i;t<l;t++){const e=s[t];x(e)&&(s[t-a]=s[t],delete s[t])}return new k(r,o)}return new k}findIndex(t){const e=this._array,n=Object.keys(e),i=n.length;for(let s=0;s<i;s++){const i=+n[s];if(!0===t(i,e[i]))return s}return-1}map(t){const e=this._array,n=Object.keys(e),i=n.length,s={};for(let o=0;o<i;o++){const i=e[+n[o]];s[o]=t(i)}return new k(s)}filter(t){const e=this._array,n=Object.keys(e),i=n.length,s={};let o=0;for(let r=0;r<i;r++){const i=+n[r],a=e[i];t(i,a)&&(s[o]=a,o++)}return new k(s,o)}insert(t,e){const n=this._length,i=this._array;for(let s=n-1;s>=t;s--)i[s+1]=i[s];return i[t]=e,this._length=n+1,this}inserts(t,e){const n=e._array,i=e._length,s=this._array;for(let o=this._length-1;o>=t;o--){const t=s[o];x(t)&&(delete s[o],s[o+i]=t)}for(let o=0;o<i;o++){const e=n[o];x(e)&&(s[o+t]=n[o])}return this._length+=i,this}[Symbol.iterator](){return new P(this)}}class P{constructor(t){this._array=t,this._keys=t.getKeys(),this._cursor=0}next(){const t=this._array,e=this._keys,n=this._cursor;if(n<e.length){const i=e[n],s=t.get(+i);return this._cursor++,{value:s,done:!1}}return{value:null,done:!0}}[Symbol.iterator](){return new P(this._array)}}class H{constructor(t={}){this._matrix=t,this._option=new k(t)}static MakeObjectMatrixSize(t){return new H({[t-1]:{}})}getMatrix(){return this._matrix}forEach(t){const e=this._option.getKeys();for(let n=0;n<e.length;n++){const i=+e[n];if(!1===t(i,this.getRow(i)))return this}return this}forValue(t){const e=this._option.getKeys();for(let n=0;n<e.length;n++){const i=+e[n],s=this.getRow(i),o=s.getKeys(),r=o.length;for(let e=0;e<r;e++){const n=+o[e];if(!1===t(i,n,s.get(n)))return this}}return this}swapRow(t,e){const n=this._option.get(t),i=this._option.get(e);this._option.set(e,n),this._option.set(t,i)}getRow(t){let e=this._option.get(t);if(e)return new k(e)}getRowOrCreate(t){let e=this.getRow(t);if(null==e){let e={};return this._option.set(t,e),new k(e)}return e}reset(){this._matrix={}}hasValue(){const t=this._option;for(const e of t)if(!new k(e).isEmpty())return!0;return!1}getValue(t,e){const n=this.getRow(t);return n?n.get(e):null}setValue(t,e,n){this.getRowOrCreate(t).set(e,n)}deleteValue(t,e){const n=this.getRow(t);n&&n.delete(e)}spliceRows(t,e){const n=this._option.splice(t,e);return new H(n.toJSON())}pushRow(t){this._option.push(t.toJSON())}insertRow(t,e){this._option.insert(t,e.toJSON())}insertRows(t,e){this._option.inserts(t,e._option),console.dir(this._option)}spliceColumns(t,e){const n=new H;return this._option.forEach(((i,s)=>{for(let r=t;r<t+e;r++)n.setValue(i,r-t,this.getValue(i,r));let o=this._option.get(i);o&&new k(o).splice(t,e)})),n}insertColumns(t,e){let n=0;e.forEach((t=>{const i=e.getRow(t);if(i)return n=i.getLength(),!1})),this.forEach(((i,s)=>{var o,r;for(let a=t;a<t+n;a++)null==(o=e.getRow(i))||o.get(a-t),s.insert(a,null==(r=e.getRow(i))?void 0:r.get(a-t))}))}getFragments(t,e,n,i){const s=new H;for(let o=t;o<=e;o++){const t=new k;for(let e=n;e<=i;e++){const n=this.getValue(o,e);t.push(n)}s.pushRow(t)}return s}getSizeOf(){return this._option.getSizeOf()}getLength(){return this._option.getLength()}getRange(){const t=this.getSizeOf();let e=0;const n=this.getLength();for(let i=0;i<n;i++){const t=this.getRow(i);if(t){const n=t.getSizeOf();t.getSizeOf()>e&&(e=n-1)}}return{startRow:0,startColumn:0,endRow:t,endColumn:e}}toArray(){return this._option.toArray().map((t=>new k(t).toArray()))}toJSON(){return this._matrix}getData(){const t=JSON.stringify(this);return JSON.parse(t)}getArrayData(){let t=0,e=0,n=!1,i=!1;const s=new H;return this.forEach(((o,r)=>{n||(n=!0,t=o),r.forEach(((n,r)=>{i?n<e&&(e=n):(i=!0,e=n);const a=this.getValue(o,n);s.setValue(o-t,n-e,a)}))})),s.getData()}getDataRange(){let t=0,e=0,n=0,i=!1,s=!1;this.forEach(((o,r)=>{i||(i=!0,t=o);const a=r.getLength()-1;a>n&&(n=a),r.forEach(((t,n)=>{s?t<e&&(e=t):(s=!0,e=t)}))}));const o=t+this.getSizeOf()-1;return{startRow:t,startColumn:e,endRow:o,endColumn:n}}}const B=/^-ms-/,F=/-([a-z])/g,U=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];class z{static stringAt(t){let e="",n=t;for(;n>=U.length;)n/=U.length,n-=1,e+=U[n%U.length];return e+=U[t%U.length],e}static getEnvironment(){const{appVersion:t}=navigator,e=this.getSystemType();return{app_version:t,os:e,os_version:e,device_id:"",platform:"web"}}static indexAt(t){let e=0;for(let n=0;n<t.length-1;n+=1){const i=t.charCodeAt(n)-65,s=t.length-1-n;e+=U.length**s+U.length*i}return e+=t.charCodeAt(t.length-1)-65,e}static deleteBlank(t){return z.isString(t)?t.replace(/\s/g,""):t}static getSystemType(){const t=navigator.userAgent,e="Win32"===navigator.platform||"Windows"===navigator.platform,n="Mac68K"===navigator.platform||"MacPPC"===navigator.platform||"Macintosh"===navigator.platform||"MacIntel"===navigator.platform;if(n)return"Mac";if("X11"===navigator.platform&&!e&&!n)return"Unix";if(String(navigator.platform).indexOf("Linux")>-1)return"Linux";if(e){if(t.indexOf("Windows NT 5.0")>-1||t.indexOf("Windows 2000")>-1)return"Windows 2000";if(t.indexOf("Windows NT 5.1")>-1||t.indexOf("Windows XP")>-1)return"Windows XP";if(t.indexOf("Windows NT 5.2")>-1||t.indexOf("Windows 2003")>-1)return"Windows 2003";if(t.indexOf("Windows NT 6.0")>-1||t.indexOf("Windows Vista")>-1)return"Windows Vista";if(t.indexOf("Windows NT 6.1")>-1||t.indexOf("Windows 7")>-1)return"Windows 7";if(t.indexOf("Windows NT 10")>-1||t.indexOf("Windows 10")>-1)return"Windows 10";if(t.indexOf("Windows NT 11")>-1||t.indexOf("Windows 11")>-1)return"Windows 11"}return"Unknown system"}static getBrowserType(){const t=navigator.userAgent,e=t.indexOf("Opera")>-1,n=t.indexOf("compatible")>-1&&t.indexOf("MSIE")>-1&&!e,i=t.indexOf("Trident")>-1&&t.indexOf("rv:11.0")>-1,s=t.indexOf("Edge")>-1,o=t.indexOf("Firefox")>-1,r=t.indexOf("Safari")>-1&&-1===t.indexOf("Chrome"),a=t.indexOf("Chrome")>-1&&t.indexOf("Safari")>-1;if(n){new RegExp("MSIE (\\d+\\.\\d+);").test(t);const e=parseFloat(RegExp.$1);return 7===e?"IE7":8===e?"IE8":9===e?"IE9":10===e?"IE10":"0"}return o?"FF":e?"Opera":r?"Safari":a?"Chrome":s?"Edge":i?"IE11":"Unknown browser"}static generateRandomId(t=21){return d(t)}static getClassName(t){return t.constructor.name}static deepMerge(t,...e){function n(t,e){t.forEach(((t,s)=>{var o,r;if(z.isArray(t)){const i=null!=(o=e[s])?o:[];return e[s]=i,void n(t,i)}if(z.isObject(t)){const n=null!=(r=e[s])?r:{};return e[s]=n,void i(t,n)}e[s]=t}))}function i(t,e){Object.keys(t).forEach((s=>{var o,r;const a=t[s];if(z.isObject(a)){const t=null!=(o=e[s])?o:{};return e[s]=t,void i(a,t)}if(z.isArray(a)){const t=null!=(r=e[s])?r:[];return e[s]=t,void n(a,t)}e[s]=a}))}return e.forEach((e=>e&&function(e){Object.keys(e).forEach((s=>{var o,r;const a=e[s];if(z.isArray(a)){const e=null!=(o=t[s])?o:[];return t[s]=e,void n(a,e)}if(z.isObject(a)){const e=null!=(r=t[s])?r:{};return t[s]=e,void i(a,e)}t[s]=a}))}(e))),t}static numberFixed(t,e){return Number(Number(t).toFixed(e))}static diffValue(t,e){function n(i,s){return z.getValueType(i)===z.getValueType(s)&&(z.isArray(i)?function(i,s){if(t.length!==e.length)return!1;for(let t=0,e=i.length;t<e;t++){if(!n(i[t],s[t]))return!1}return!0}(i,s):z.isObject(i)?function(t,e){const i=Object.keys(t),s=Object.keys(e);if(i.length!==s.length)return!1;for(const o of i){if(!s.includes(o))return!1;if(!n(t[o],e[o]))return!1}return!0}(i,s):z.isDate(i)?i.getTime()===s.getTime():z.isRegExp(i)?i.toString()===s.toString():i===s)}return n(t,e)}static deepClone(t){if(!this.isDefine(t))return t;if(this.isRegExp(t))return new RegExp(t);if(this.isDate(t))return new Date(t);if(this.isArray(t)){const e=[];return t.forEach(((t,n)=>{e[n]=z.deepClone(t)})),e}if(this.isObject(t)){const e={};return Object.keys(t).forEach((n=>{const i=t[n];e[n]=z.deepClone(i)})),Object.setPrototypeOf(e,Object.getPrototypeOf(t)),e}return t}static getLanguage(){const t="en-US";return globalThis.navigator&&(navigator.languages&&navigator.languages[0]||navigator.language)||t}static getValueType(t){return Object.prototype.toString.apply(t)}static isDefine(t){return null!=t}static isBlank(t){return!this.isDefine(t)||!!this.isString(t)&&""===t.trim()}static isAssignableFrom(t,e){return t instanceof e}static isBoolean(t){return"[object Boolean]"===this.getValueType(t)}static isPlainObject(t){return!!this.isDefine(t)&&Object.getPrototypeOf(t)===Object.getPrototypeOf({})}static isFunction(t){return"[object Function]"===this.getValueType(t)}static isDate(t){return"[object Date]"===this.getValueType(t)}static isRegExp(t){return"[object RegExp]"===this.getValueType(t)}static isArray(t){return"[object Array]"===this.getValueType(t)}static isString(t){return"[object String]"===this.getValueType(t)}static isNumber(t){return"[object Number]"===this.getValueType(t)}static isStringNumber(t){return!isNaN(parseFloat(t))&&isFinite(t)}static isObject(t){return"[object Object]"===this.getValueType(t)}static isEmptyObject(t){for(const e in t)return!1;return!0}static isMobile(){let t=0,e=0;return document.body.clientWidth&&(t=document.body.clientWidth),document.body.clientHeight&&(e=document.body.clientHeight),this.isAndroid()||this.isIPhone()||this.isTablet()||t<350&&e<500}static isTablet(){return/ipad|android|android 3.0|xoom|sch-i800|playbook|tablet|kindle/i.test(navigator.userAgent.toLowerCase())}static isWeChat(){const t=navigator.userAgent.toLowerCase();return"micromessenger"===String(t.match(/MicroMessenger/i))}static isAndroid(){const t=navigator.userAgent;return t.indexOf("Android")>-1||t.indexOf("Linux")>-1}static isIPhone(){return/iPhone/i.test(navigator.userAgent)}static isIEBrowser(){return this.getBrowserType().startsWith("IE")}static itCount(t){return e=>{for(let n=0;n<t;n++)e&&e()}}static hasLength(t,e){return!!z.isDefine(t)&&(z.isDefine(e)?t.length===e:t.length>0)}static capitalize(t){return t.charAt(0).toUpperCase()+t.slice(1)}static fCamelCase(t,e){return e.toUpperCase()}static camelCase(t){return t.replace(B,"ms-").replace(F,this.fCamelCase)}static removeNull(t){if(this.isObject(t)){const e={};return Object.keys(t).forEach((e=>{const n=t[e];null==n?delete t[e]:z.removeNull(n)})),e}return t}static fillTwoDimensionalArray(t,e,n){return new Array(t).fill(n).map((t=>new Array(e).fill(n)))}static fillObjectMatrix(t,e,n){const i=new H;for(let s=0;s<t;s++)for(let t=0;t<e;t++)i.setValue(s,t,n);return i.getData()}static numToWord(t){let e="";for(;t>0;){let n=t%26;n=0===n?n=26:n,e=String.fromCharCode(96+n)+e,t=(t-n)/26}return e.toLocaleUpperCase()}static ABCatNum(t){if(null==t||0===t.length)return NaN;const e=t.toLowerCase().split(""),n=e.length;let i=0,s=0;for(let o=0;o<n;o++)s=e[o].charCodeAt(0)-96,i+=s*26**(n-o-1);return 0===i?NaN:i-1}static chatAtABC(t){const e="a".charCodeAt(0),n="z".charCodeAt(0)-e+1;let i="";for(;t>=0;)i=String.fromCharCode(t%n+e)+i,t=Math.floor(t/n)-1;return i.toUpperCase()}static randSort(t){for(let e=0,n=t.length;e<n;e++){const i=parseInt((Math.random()*n).toString()),s=t[i];t[i]=t[e],t[e]=s}return t}static commonExtend(t,e){let n={};for(let i in t)n[i]=t[i];for(let i in e)null!=e[i]&&(n[i]=e[i]);return n}static commonExtend1(t,e){for(let n in t)null==e[n]&&(e[n]=t[n]);return e}static arrayToObject(t){const e={};return t.forEach(((t,n)=>{e[n]={},t.forEach(((t,i)=>{e[n][i]=t}))})),e}}var W,V,Y,G,X,j,K,$,Z,q,Q,J,tt,et,nt,it,st,ot,rt,at,lt,ht,ct,dt,ut,gt,_t,pt,mt,ft,Tt,vt,Et,bt,It,Ct,St,At,wt,Rt,Nt,yt,Ot,Dt,Mt,xt,Lt,kt,Pt,Ht,Bt,Ft,Ut,zt,Wt,Vt,Yt,Gt,Xt,jt,Kt,$t,Zt,qt,Qt,Jt,te,ee,ne,ie,se,oe,re,ae,le,he,ce,de,ue,ge,_e,pe,me,fe,Te,ve,Ee,be,Ie,Ce,Se,Ae,we,Re,Ne,ye,Oe,De,Me,xe,Le,ke,Pe,He,Be,Fe,Ue,ze,We,Ve,Ye,Ge,Xe,je,Ke,$e;(V=W||(W={}))[V.TAB=0]="TAB",V[V.SPACE=1]="SPACE",V[V.NOTHING=2]="NOTHING",(G=Y||(Y={}))[G.GLYPH_TYPE_UNSPECIFIED=0]="GLYPH_TYPE_UNSPECIFIED",G[G.NONE=1]="NONE",G[G.DECIMAL=2]="DECIMAL",G[G.ZERO_DECIMAL=3]="ZERO_DECIMAL",G[G.UPPER_ALPHA=4]="UPPER_ALPHA",G[G.ALPHA=5]="ALPHA",G[G.UPPER_ROMAN=6]="UPPER_ROMAN",G[G.ROMAN=7]="ROMAN",(j=X||(X={}))[j.BULLET_ALIGNMENT_UNSPECIFIED=0]="BULLET_ALIGNMENT_UNSPECIFIED",j[j.START=1]="START",j[j.CENTER=2]="CENTER",j[j.END=3]="END",($=K||(K={}))[$.PARAGRAPH=0]="PARAGRAPH",$[$.TABLE=1]="TABLE",$[$.SECTION_BREAK=2]="SECTION_BREAK",$[$.CUSTOM=3]="CUSTOM",(q=Z||(Z={}))[q.DEFAULT=0]="DEFAULT",q[q.LINES=1]="LINES",q[q.LINES_AND_CHARS=2]="LINES_AND_CHARS",q[q.SNAP_TO_CHARS=3]="SNAP_TO_CHARS",(J=Q||(Q={}))[J.SECTION_TYPE_UNSPECIFIED=0]="SECTION_TYPE_UNSPECIFIED",J[J.CONTINUOUS=1]="CONTINUOUS",J[J.NEXT_PAGE=2]="NEXT_PAGE",J[J.EVEN_PAGE=3]="EVEN_PAGE",J[J.ODD_PAGE=4]="ODD_PAGE",(et=tt||(tt={}))[et.COLUMN_SEPARATOR_STYLE_UNSPECIFIED=0]="COLUMN_SEPARATOR_STYLE_UNSPECIFIED",et[et.NONE=1]="NONE",et[et.BETWEEN_EACH_COLUMN=2]="BETWEEN_EACH_COLUMN",(it=nt||(nt={}))[it.NORMAL=0]="NORMAL",it[it.TBRL=1]="TBRL",it[it.LRTBV=2]="LRTBV",(ot=st||(st={}))[ot.TEXT_RUN=0]="TEXT_RUN",ot[ot.AUTO_TEXT=1]="AUTO_TEXT",ot[ot.PAGE_BREAK=2]="PAGE_BREAK",ot[ot.COLUMN_BREAK=3]="COLUMN_BREAK",ot[ot.FOOT_NOTE_REFERENCE=4]="FOOT_NOTE_REFERENCE",ot[ot.HORIZONTAL_RULE=5]="HORIZONTAL_RULE",ot[ot.EQUATION=6]="EQUATION",ot[ot.DRAWING=7]="DRAWING",ot[ot.PERSON=8]="PERSON",ot[ot.RICH_LINK=9]="RICH_LINK",(at=rt||(rt={}))[at.BOTH_SIDES=0]="BOTH_SIDES",at[at.LEFT=1]="LEFT",at[at.RIGHT=2]="RIGHT",at[at.LARGEST=3]="LARGEST",(ht=lt||(lt={}))[ht.INLINE=0]="INLINE",ht[ht.WRAP_NONE=1]="WRAP_NONE",ht[ht.WRAP_POLYGON=2]="WRAP_POLYGON",ht[ht.WRAP_SQUARE=3]="WRAP_SQUARE",ht[ht.WRAP_THROUGH=4]="WRAP_THROUGH",ht[ht.WRAP_TIGHT=5]="WRAP_TIGHT",ht[ht.WRAP_TOP_AND_BOTTOM=6]="WRAP_TOP_AND_BOTTOM",(dt=ct||(ct={}))[dt.NAMED_STYLE_TYPE_UNSPECIFIED=0]="NAMED_STYLE_TYPE_UNSPECIFIED",dt[dt.NORMAL_TEXT=1]="NORMAL_TEXT",dt[dt.TITLE=2]="TITLE",dt[dt.SUBTITLE=3]="SUBTITLE",dt[dt.HEADING_1=4]="HEADING_1",dt[dt.HEADING_2=5]="HEADING_2",dt[dt.HEADING_3=6]="HEADING_3",dt[dt.HEADING_4=7]="HEADING_4",dt[dt.HEADING_5=8]="HEADING_5",dt[dt.HEADING_6=9]="HEADING_6",(gt=ut||(ut={}))[gt.AUTO=0]="AUTO",gt[gt.AT_LEAST=1]="AT_LEAST",gt[gt.EXACT=2]="EXACT",(pt=_t||(_t={}))[pt.DASH_STYLE_UNSPECIFIED=0]="DASH_STYLE_UNSPECIFIED",pt[pt.SOLID=1]="SOLID",pt[pt.DOT=2]="DOT",pt[pt.DASH=3]="DASH",(ft=mt||(mt={}))[ft.TAB_STOP_ALIGNMENT_UNSPECIFIED=0]="TAB_STOP_ALIGNMENT_UNSPECIFIED",ft[ft.START=1]="START",ft[ft.CENTER=2]="CENTER",ft[ft.END=3]="END",(vt=Tt||(Tt={})).EVENLY_DISTRIBUTED="0",vt.FIXED_WIDTH="1",(bt=Et||(Et={}))[bt.CONTENT_ALIGNMENT_UNSPECIFIED=0]="CONTENT_ALIGNMENT_UNSPECIFIED",bt[bt.CONTENT_ALIGNMENT_UNSUPPORTED=1]="CONTENT_ALIGNMENT_UNSUPPORTED",bt[bt.TOP=2]="TOP",bt[bt.MIDDLE=3]="MIDDLE",bt[bt.BOTTOM=4]="BOTTOM",(Ct=It||(It={})).NORMAL="normal",Ct.BOLD="bold",Ct.ITALIC="italic",(At=St||(St={}))[At.CHARACTER=0]="CHARACTER",At[At.COLUMN=1]="COLUMN",At[At.INSIDE_MARGIN=2]="INSIDE_MARGIN",At[At.LEFT_MARGIN=3]="LEFT_MARGIN",At[At.MARGIN=4]="MARGIN",At[At.OUTSIDE_MARGIN=5]="OUTSIDE_MARGIN",At[At.PAGE=6]="PAGE",At[At.RIGHT_MARGIN=7]="RIGHT_MARGIN",(Rt=wt||(wt={}))[Rt.BOTTOM_MARGIN=0]="BOTTOM_MARGIN",Rt[Rt.INSIDE_MARGIN=1]="INSIDE_MARGIN",Rt[Rt.LINE=2]="LINE",Rt[Rt.MARGIN=3]="MARGIN",Rt[Rt.OUTSIDE_MARGIN=4]="OUTSIDE_MARGIN",Rt[Rt.PAGE=5]="PAGE",Rt[Rt.PARAGRAPH=6]="PARAGRAPH",Rt[Rt.TOP_MARGIN=7]="TOP_MARGIN",(yt=Nt||(Nt={}))[yt.POINT=0]="POINT",yt[yt.LINE=1]="LINE",yt[yt.CHARACTER=2]="CHARACTER",(Dt=Ot||(Ot={}))[Dt.CENTER=0]="CENTER",Dt[Dt.INSIDE=1]="INSIDE",Dt[Dt.LEFT=2]="LEFT",Dt[Dt.OUTSIDE=3]="OUTSIDE",Dt[Dt.RIGHT=4]="RIGHT",(xt=Mt||(Mt={}))[xt.BOTTOM=0]="BOTTOM",xt[xt.CENTER=1]="CENTER",xt[xt.INSIDE=2]="INSIDE",xt[xt.OUTSIDE=3]="OUTSIDE",xt[xt.TOP=4]="TOP",(kt=Lt||(Lt={}))[kt.compressPunctuation=0]="compressPunctuation",kt[kt.compressPunctuationAndJapaneseKana=1]="compressPunctuationAndJapaneseKana",kt[kt.doNotCompress=2]="doNotCompress",(Ht=Pt||(Pt={}))[Ht.PORTRAIT=0]="PORTRAIT",Ht[Ht.LANDSCAPE=1]="LANDSCAPE",(Ft=Bt||(Bt={})).INSERT_ROW_DATA_ACTION="InsertRowDataAction",Ft.REMOVE_ROW_DATA_ACTION="RemoveRowDataAction",Ft.INSERT_ROW_ACTION="InsertRowAction",Ft.REMOVE_ROW_ACTION="RemoveRowAction",Ft.SET_RANGE_STYLE_ACTION="SetRangeStyleAction",Ft.SET_SELECTION_ACTION="SetSelectionActivateAction",Ft.SET_RANGE_DATA_ACTION="SetRangeDataAction",Ft.SET_RANGE_FORMATTED_VALUE_ACTION="SetRangeFormattedValueAction",Ft.SET_RANGE_NOTE_ACTION="SetRangeNoteAction",Ft.DELETE_RANGE_ACTION="DeleteRangeAction",Ft.INSERT_SHEET_ACTION="InsertSheetAction",Ft.REMOVE_SHEET_ACTION="RemoveSheetAction",Ft.CLEAR_RANGE_ACTION="ClearRangeAction",Ft.INSERT_RANGE_ACTION="InsertRangeAction",Ft.SET_TAB_COLOR_ACTION="SetTabColorAction",Ft.HIDE_SHEET_ACTION="SetWorkSheetHideAction",Ft.SET_WORKSHEET_ACTIVATE_ACTION="SetWorkSheetActivateAction",Ft.INSERT_COLUMN_ACTION="InsertColumnAction",Ft.INSERT_COLUMN_DATA_ACTION="InsertColumnDataAction",Ft.REMOVE_COLUMN_ACTION="RemoveColumnAction",Ft.REMOVE_COLUMN_DATA_ACTION="RemoveColumnDataAction",Ft.SET_HIDE_ROW_ACTION="SetRowHideAction",Ft.SET_HIDE_COLUMN_ACTION="SetColumnHideAction",Ft.SET_SHOW_ROW_ACTION="SetRowShowAction",Ft.SET_SHOW_COLUMN_ACTION="SetColumnShowAction",Ft.ADD_MERGE_ACTION="AddMergeAction",Ft.REMOVE_MERGE_ACTION="RemoveMergeAction",Ft.SET_WORKSHEET_NAME_ACTION="SetWorkSheetNameAction",Ft.SET_WORKSHEET_STATUS_ACTION="SetWorkSheetStatusAction",Ft.SET_BORDER_ACTION="SetBorderAction",Ft.SET_COLUMN_WIDTH_ACTION="SetColumnWidthAction",Ft.SET_ROW_HEIGHT_ACTION="SetRowHeightAction",Ft.SET_HIDDEN_GRIDLINES_ACTION="SetHiddenGridlinesAction",Ft.SET_RIGHT_TO_LEFT_ACTION="SetRightToLeftAction",Ft.DELETE_BANDING_ACTION="DeleteBandingAction",Ft.SET_BANDING_ACTION="SetBandingAction",Ft.ADD_BANDING_ACTION="AddBandingAction",Ft.DELETE_NAMED_RANGE_ACTION="DeleteNamedRangeAction",Ft.SET_NAMED_RANGE_ACTION="SetNamedRangeAction",Ft.ADD_NAMED_RANGE_ACTION="AddNamedRangeAction",Ft.SET_SHEET_ORDER_ACTION="SetSheetOrderAction",Ft.SET_ZOOM_RATIO_ACTION="SetZoomRatioAction",Ft.SET_FROZEN_COLUMNS_ACTION="SetFrozenColumnsAction",Ft.SET_FROZEN_ROWS_ACTION="SetFrozenRowsAction",(zt=Ut||(Ut={}))[zt.DEFAULT_SERIES=0]="DEFAULT_SERIES",zt[zt.ALTERNATE_SERIES=1]="ALTERNATE_SERIES",(Vt=Wt||(Wt={})).CELL_EMPTY="CELL_EMPTY",Vt.CELL_NOT_EMPTY="CELL_NOT_EMPTY",Vt.DATE_AFTER="DATE_AFTER",Vt.DATE_BEFORE="DATE_BEFORE",Vt.DATE_EQUAL_TO="DATE_EQUAL_TO",Vt.DATE_NOT_EQUAL_TO="DATE_NOT_EQUAL_TO",Vt.DATE_AFTER_RELATIVE="DATE_AFTER_RELATIVE",Vt.DATE_BEFORE_RELATIVE="DATE_BEFORE_RELATIVE",Vt.DATE_EQUAL_TO_RELATIVE="DATE_EQUAL_TO_RELATIVE",Vt.NUMBER_BETWEEN="NUMBER_BETWEEN",Vt.NUMBER_EQUAL_TO="NUMBER_EQUAL_TO",Vt.NUMBER_GREATER_THAN="NUMBER_GREATER_THAN",Vt.NUMBER_GREATER_THAN_OR_EQUAL_TO="NUMBER_GREATER_THAN_OR_EQUAL_TO",Vt.NUMBER_LESS_THAN="NUMBER_LESS_THAN",Vt.NUMBER_LESS_THAN_OR_EQUAL_TO="NUMBER_LESS_THAN_OR_EQUAL_TO",Vt.NUMBER_NOT_BETWEEN="NUMBER_NOT_BETWEEN",Vt.NUMBER_NOT_EQUAL_TO="NUMBER_NOT_EQUAL_TO",Vt.TEXT_CONTAINS="TEXT_CONTAINS",Vt.TEXT_DOES_NOT_CONTAIN="TEXT_DOES_NOT_CONTAIN",Vt.TEXT_EQUAL_TO="TEXT_EQUAL_TO",Vt.TEXT_NOT_EQUAL_TO="TEXT_NOT_EQUAL_TO",Vt.TEXT_STARTS_WITH="TEXT_STARTS_WITH",Vt.TEXT_ENDS_WITH="TEXT_ENDS_WITH",Vt.CUSTOM_FORMULA="CUSTOM_FORMULA",(Gt=Yt||(Yt={}))[Gt.NONE=0]="NONE",Gt[Gt.THIN=1]="THIN",Gt[Gt.HAIR=2]="HAIR",Gt[Gt.DOTTED=3]="DOTTED",Gt[Gt.DASHED=4]="DASHED",Gt[Gt.DASH_DOT=5]="DASH_DOT",Gt[Gt.DASH_DOT_DOT=6]="DASH_DOT_DOT",Gt[Gt.DOUBLE=7]="DOUBLE",Gt[Gt.MEDIUM=8]="MEDIUM",Gt[Gt.MEDIUM_DASHED=9]="MEDIUM_DASHED",Gt[Gt.MEDIUM_DASH_DOT=10]="MEDIUM_DASH_DOT",Gt[Gt.MEDIUM_DASH_DOT_DOT=11]="MEDIUM_DASH_DOT_DOT",Gt[Gt.SLANT_DASH_DOT=12]="SLANT_DASH_DOT",Gt[Gt.THICK=13]="THICK",(jt=Xt||(Xt={})).TOP="top",jt.BOTTOM="bottom",jt.LEFT="left",jt.RIGHT="right",jt.NONE="none",jt.ALL="all",jt.OUTSIDE="outside",jt.INSIDE="inside",jt.HORIZONTAL="horizontal",jt.VERTICAL="vertical",($t=Kt||(Kt={}))[$t.UNSUPPORTED=0]="UNSUPPORTED",$t[$t.RGB=1]="RGB",$t[$t.HEX=2]="HEX",$t[$t.THEME=3]="THEME",(qt=Zt||(Zt={}))[qt.ON=0]="ON",qt[qt.OFF=1]="OFF",(Jt=Qt||(Qt={}))[Jt.CONDITION_TYPE_UNSPECIFIED=0]="CONDITION_TYPE_UNSPECIFIED",Jt[Jt.NUMNUMBER_BETWEENR_GREATER=1]="NUMNUMBER_BETWEENR_GREATER",Jt[Jt.NUMBER_GREATER_THAN_EQ=2]="NUMBER_GREATER_THAN_EQ",Jt[Jt.NUMBER_LESS=3]="NUMBER_LESS",Jt[Jt.NUMBER_LESS_THAN_EQ=4]="NUMBER_LESS_THAN_EQ",Jt[Jt.NUMBER_EQ=5]="NUMBER_EQ",Jt[Jt.NUMBER_NOT_EQ=6]="NUMBER_NOT_EQ",Jt[Jt.NUMBER_BETWEEN=7]="NUMBER_BETWEEN",Jt[Jt.NUMBER_NOT_BETWEEN=8]="NUMBER_NOT_BETWEEN",Jt[Jt.TEXT_CONTAINS=9]="TEXT_CONTAINS",Jt[Jt.TEXT_NOT_CONTAINS=10]="TEXT_NOT_CONTAINS",Jt[Jt.TEXT_STARTS_WITH=11]="TEXT_STARTS_WITH",Jt[Jt.TEXT_ENDS_WITH=12]="TEXT_ENDS_WITH",Jt[Jt.TEXT_EQ=13]="TEXT_EQ",Jt[Jt.TEXT_IS_EMAIL=14]="TEXT_IS_EMAIL",Jt[Jt.TEXT_IS_URL=15]="TEXT_IS_URL",Jt[Jt.DATE_EQ=16]="DATE_EQ",Jt[Jt.DATE_BEFORE=17]="DATE_BEFORE",Jt[Jt.DATE_AFTER=18]="DATE_AFTER",Jt[Jt.DATE_ON_OR_BEFORE=19]="DATE_ON_OR_BEFORE",Jt[Jt.DATE_ON_OR_AFTER=20]="DATE_ON_OR_AFTER",Jt[Jt.DATE_BETWEEN=21]="DATE_BETWEEN",Jt[Jt.DATE_NOT_BETWEEN=22]="DATE_NOT_BETWEEN",Jt[Jt.DATE_IS_VALID=23]="DATE_IS_VALID",Jt[Jt.ONE_OF_RANGE=24]="ONE_OF_RANGE",Jt[Jt.ONE_OF_LIST=25]="ONE_OF_LIST",Jt[Jt.BLANK=26]="BLANK",Jt[Jt.NOT_BLANK=27]="NOT_BLANK",Jt[Jt.CUSTOM_FORMULA=28]="CUSTOM_FORMULA",Jt[Jt.BOOLEAN=29]="BOOLEAN",Jt[Jt.TEXT_NOT_EQ=30]="TEXT_NOT_EQ",Jt[Jt.DATE_NOT_EQ=31]="DATE_NOT_EQ",(ee=te||(te={}))[ee.PASTE_NORMAL=0]="PASTE_NORMAL",ee[ee.PASTE_NO_BORDERS=1]="PASTE_NO_BORDERS",ee[ee.PASTE_FORMAT=2]="PASTE_FORMAT",ee[ee.PASTE_FORMULA=3]="PASTE_FORMULA",ee[ee.PASTE_DATA_VALIDATION=4]="PASTE_DATA_VALIDATION",ee[ee.PASTE_VALUES=5]="PASTE_VALUES",ee[ee.PASTE_CONDITIONAL_FORMATTING=6]="PASTE_CONDITIONAL_FORMATTING",ee[ee.PASTE_COLUMN_WIDTHS=7]="PASTE_COLUMN_WIDTHS",(ie=ne||(ne={}))[ie.DOCUMENT=0]="DOCUMENT",ie[ie.PROJECT=1]="PROJECT",(oe=se||(se={}))[oe.COLUMNS=0]="COLUMNS",oe[oe.ROWS=1]="ROWS",(ae=re||(re={}))[ae.LEFT=0]="LEFT",ae[ae.RIGHT=1]="RIGHT",ae[ae.TOP=2]="TOP",ae[ae.BOTTOM=3]="BOTTOM",(he=le||(le={}))[he.NUMBER_FORMAT_TYPE_UNSPECIFIED=0]="NUMBER_FORMAT_TYPE_UNSPECIFIED",he[he.TEXT=1]="TEXT",he[he.NUMBER=2]="NUMBER",he[he.PERCENT=3]="PERCENT",he[he.CURRENCY=4]="CURRENCY",he[he.DATE=5]="DATE",he[he.TIME=6]="TIME",he[he.DATE_TIME=7]="DATE_TIME",he[he.SCIENTIFIC=8]="SCIENTIFIC",(de=ce||(ce={}))[de.INTERPOLATION_POINT_TYPE_UNSPECIFIED=0]="INTERPOLATION_POINT_TYPE_UNSPECIFIED",de[de.MIN=1]="MIN",de[de.MAX=2]="MAX",de[de.NUMBER=3]="NUMBER",de[de.PERCENT=4]="PERCENT",de[de.PERCENTILE=5]="PERCENTILE",(ge=ue||(ue={}))[ge.BACKSPACE=8]="BACKSPACE",ge[ge.TAB=9]="TAB",ge[ge.ENTER=13]="ENTER",ge[ge.SHIFT=16]="SHIFT",ge[ge.CTRL=17]="CTRL",ge[ge.PAUSE=19]="PAUSE",ge[ge.CAPS_LOCK=20]="CAPS_LOCK",ge[ge.ESC=27]="ESC",ge[ge.SPACE=33]="SPACE",ge[ge.PAGE_UP=33]="PAGE_UP",ge[ge.PAGE_DOWN=34]="PAGE_DOWN",ge[ge.END=35]="END",ge[ge.HOME=36]="HOME",ge[ge.LEFT=37]="LEFT",ge[ge.UP=38]="UP",ge[ge.RIGHT=39]="RIGHT",ge[ge.DOWN=40]="DOWN",ge[ge.INSERT=45]="INSERT",ge[ge.DELETE=46]="DELETE",ge[ge.WIN=91]="WIN",ge[ge.WIN_R=92]="WIN_R",ge[ge.MENU=93]="MENU",ge[ge.F1=112]="F1",ge[ge.F2=113]="F2",ge[ge.F3=114]="F3",ge[ge.F4=115]="F4",ge[ge.F5=116]="F5",ge[ge.F6=117]="F6",ge[ge.F7=118]="F7",ge[ge.F8=119]="F8",ge[ge.F9=120]="F9",ge[ge.F10=121]="F10",ge[ge.F11=122]="F11",ge[ge.F12=123]="F12",ge[ge.NUM_LOCK=144]="NUM_LOCK",ge[ge.SCROLL_LOCK=145]="SCROLL_LOCK",(pe=_e||(_e={})).backspace="Backspace",pe.delete="Delete",(fe=me||(me={})).EN="en",fe.ZH="zh",(ve=Te||(Te={}))[ve.RANGE=0]="RANGE",ve[ve.SHEET=1]="SHEET",(be=Ee||(Ee={}))[be.RELATIVE_DATE_UNSPECIFIED=0]="RELATIVE_DATE_UNSPECIFIED",be[be.PAST_YEAR=1]="PAST_YEAR",be[be.PAST_MONTH=2]="PAST_MONTH",be[be.PAST_WEEK=3]="PAST_WEEK",be[be.YESTERDAY=4]="YESTERDAY",be[be.TODAY=5]="TODAY",be[be.TOMORROW=6]="TOMORROW",(Ce=Ie||(Ie={}))[Ce.GRID=0]="GRID",Ce[Ce.KANBAN=1]="KANBAN",Ce[Ce.GANTT=2]="GANTT",(Ae=Se||(Se={}))[Ae.UNSPECIFIED=0]="UNSPECIFIED",Ae[Ae.LEFT_TO_RIGHT=1]="LEFT_TO_RIGHT",Ae[Ae.RIGHT_TO_LEFT=2]="RIGHT_TO_LEFT",(Re=we||(we={}))[Re.DASH=0]="DASH",Re[Re.DASH_DOT_DOT_HEAVY=1]="DASH_DOT_DOT_HEAVY",Re[Re.DASH_DOT_HEAVY=2]="DASH_DOT_HEAVY",Re[Re.DASHED_HEAVY=3]="DASHED_HEAVY",Re[Re.DASH_LONG=4]="DASH_LONG",Re[Re.DASH_LONG_HEAVY=5]="DASH_LONG_HEAVY",Re[Re.DOT_DASH=6]="DOT_DASH",Re[Re.DOT_DOT_DASH=7]="DOT_DOT_DASH",Re[Re.DOTTED=8]="DOTTED",Re[Re.DOTTED_HEAVY=9]="DOTTED_HEAVY",Re[Re.DOUBLE=10]="DOUBLE",Re[Re.NONE=11]="NONE",Re[Re.SINGLE=12]="SINGLE",Re[Re.THICK=13]="THICK",Re[Re.WAVE=14]="WAVE",Re[Re.WAVY_DOUBLE=15]="WAVY_DOUBLE",Re[Re.WAVY_HEAVY=16]="WAVY_HEAVY",Re[Re.WORDS=17]="WORDS",(ye=Ne||(Ne={}))[ye.UNSPECIFIED=0]="UNSPECIFIED",ye[ye.LEFT=1]="LEFT",ye[ye.CENTER=2]="CENTER",ye[ye.RIGHT=3]="RIGHT",ye[ye.JUSTIFIED=4]="JUSTIFIED",(De=Oe||(Oe={}))[De.UNSPECIFIED=0]="UNSPECIFIED",De[De.TOP=1]="TOP",De[De.MIDDLE=2]="MIDDLE",De[De.BOTTOM=3]="BOTTOM",(xe=Me||(Me={}))[xe.UNSPECIFIED=0]="UNSPECIFIED",xe[xe.OVERFLOW=1]="OVERFLOW",xe[xe.CLIP=2]="CLIP",xe[xe.WRAP=3]="WRAP",(ke=Le||(Le={}))[ke.NORMAL=0]="NORMAL",ke[ke.ITALIC=1]="ITALIC",(He=Pe||(Pe={}))[He.NORMAL=0]="NORMAL",He[He.BOLD=1]="BOLD",(Fe=Be||(Be={}))[Fe.NORMAL=0]="NORMAL",Fe[Fe.SUBSCRIPT=1]="SUBSCRIPT",Fe[Fe.SUPERSCRIPT=2]="SUPERSCRIPT",(ze=Ue||(Ue={}))[ze.FALSE=0]="FALSE",ze[ze.TRUE=1]="TRUE",(Ve=We||(We={}))[Ve.STRING=0]="STRING",Ve[Ve.NUMBER=1]="NUMBER",Ve[Ve.BOOLEAN=2]="BOOLEAN",Ve[Ve.FORCE_STRING=3]="FORCE_STRING",(Ge=Ye||(Ye={}))[Ge.DARK1=0]="DARK1",Ge[Ge.LIGHT1=1]="LIGHT1",Ge[Ge.DARK2=2]="DARK2",Ge[Ge.LIGHT2=3]="LIGHT2",Ge[Ge.ACCENT1=4]="ACCENT1",Ge[Ge.ACCENT2=5]="ACCENT2",Ge[Ge.ACCENT3=6]="ACCENT3",Ge[Ge.ACCENT4=7]="ACCENT4",Ge[Ge.ACCENT5=8]="ACCENT5",Ge[Ge.ACCENT6=9]="ACCENT6",Ge[Ge.HYPERLINK=10]="HYPERLINK",Ge[Ge.FOLLOWED_HYPERLINK=11]="FOLLOWED_HYPERLINK",(je=Xe||(Xe={})).OFFICE="Office",je.OFFICE_2007_2010="Office 2007-2010",je.GRAYSCALE="Grayscale",je.BLUE_WARM="Blue Warm",je.BLUE="Blue",je.BLUE_II="Blue II",je.BLUE_GREEN="Blue Green",je.GREEN="Green",je.GREEN_YELLOW="Green Yellow",je.YELLOW="Yellow",je.YELLOW_ORANGE="Yellow Orange",je.ORANGE="Orange",je.ORANGE_RED="Orange Red",je.RED_ORANGE="Red Orange",je.RED="Red",je.RED_VIOLET="Red Violet",je.VIOLET="Violet",je.VIOLET_II="Violet II",je.MEDIAN="Median",je.PAPER="Paper",je.MARQUEE="Marquee",je.SLIPSTREAM="Slipstream",je.Aspect="Aspect",($e=Ke||(Ke={}))[$e.TYPE_UNSPECIFIED=0]="TYPE_UNSPECIFIED",$e[$e.TEXT_BOX=1]="TEXT_BOX",$e[$e.RECTANGLE=2]="RECTANGLE",$e[$e.ROUND_RECTANGLE=3]="ROUND_RECTANGLE",$e[$e.ELLIPSE=4]="ELLIPSE",$e[$e.ARC=5]="ARC",$e[$e.BENT_ARROW=6]="BENT_ARROW",$e[$e.BENT_UP_ARROW=7]="BENT_UP_ARROW",$e[$e.BEVEL=8]="BEVEL",$e[$e.BLOCK_ARC=9]="BLOCK_ARC",$e[$e.BRACE_PAIR=10]="BRACE_PAIR",$e[$e.BRACKET_PAIR=11]="BRACKET_PAIR",$e[$e.CAN=12]="CAN",$e[$e.CHEVRON=13]="CHEVRON",$e[$e.CHORD=14]="CHORD",$e[$e.CLOUD=15]="CLOUD",$e[$e.CORNER=16]="CORNER",$e[$e.CUBE=17]="CUBE",$e[$e.CURVED_DOWN_ARROW=18]="CURVED_DOWN_ARROW",$e[$e.CURVED_LEFT_ARROW=19]="CURVED_LEFT_ARROW",$e[$e.CURVED_RIGHT_ARROW=20]="CURVED_RIGHT_ARROW",$e[$e.CURVED_UP_ARROW=21]="CURVED_UP_ARROW",$e[$e.DECAGON=22]="DECAGON",$e[$e.DIAGONAL_STRIPE=23]="DIAGONAL_STRIPE",$e[$e.DIAMOND=24]="DIAMOND",$e[$e.DODECAGON=25]="DODECAGON",$e[$e.DONUT=26]="DONUT",$e[$e.DOUBLE_WAVE=27]="DOUBLE_WAVE",$e[$e.DOWN_ARROW=28]="DOWN_ARROW",$e[$e.DOWN_ARROW_CALLOUT=29]="DOWN_ARROW_CALLOUT",$e[$e.FOLDED_CORNER=30]="FOLDED_CORNER",$e[$e.FRAME=31]="FRAME",$e[$e.HALF_FRAME=32]="HALF_FRAME",$e[$e.HEART=33]="HEART",$e[$e.HEPTAGON=34]="HEPTAGON",$e[$e.HEXAGON=35]="HEXAGON",$e[$e.HOME_PLATE=36]="HOME_PLATE",$e[$e.HORIZONTAL_SCROLL=37]="HORIZONTAL_SCROLL",$e[$e.IRREGULAR_SEAL_1=38]="IRREGULAR_SEAL_1",$e[$e.IRREGULAR_SEAL_2=39]="IRREGULAR_SEAL_2",$e[$e.LEFT_ARROW=40]="LEFT_ARROW",$e[$e.LEFT_ARROW_CALLOUT=41]="LEFT_ARROW_CALLOUT",$e[$e.LEFT_BRACE=42]="LEFT_BRACE",$e[$e.LEFT_BRACKET=43]="LEFT_BRACKET",$e[$e.LEFT_RIGHT_ARROW=44]="LEFT_RIGHT_ARROW",$e[$e.LEFT_RIGHT_ARROW_CALLOUT=45]="LEFT_RIGHT_ARROW_CALLOUT",$e[$e.LEFT_RIGHT_UP_ARROW=46]="LEFT_RIGHT_UP_ARROW",$e[$e.LEFT_UP_ARROW=47]="LEFT_UP_ARROW",$e[$e.LIGHTNING_BOLT=48]="LIGHTNING_BOLT",$e[$e.MATH_DIVIDE=49]="MATH_DIVIDE",$e[$e.MATH_EQUAL=50]="MATH_EQUAL",$e[$e.MATH_MINUS=51]="MATH_MINUS",$e[$e.MATH_MULTIPLY=52]="MATH_MULTIPLY",$e[$e.MATH_NOT_EQUAL=53]="MATH_NOT_EQUAL",$e[$e.MATH_PLUS=54]="MATH_PLUS",$e[$e.MOON=55]="MOON",$e[$e.NO_SMOKING=56]="NO_SMOKING",$e[$e.NOTCHED_RIGHT_ARROW=57]="NOTCHED_RIGHT_ARROW",$e[$e.OCTAGON=58]="OCTAGON",$e[$e.PARALLELOGRAM=59]="PARALLELOGRAM",$e[$e.PENTAGON=60]="PENTAGON",$e[$e.PIE=61]="PIE",$e[$e.PLAQUE=62]="PLAQUE",$e[$e.PLUS=63]="PLUS",$e[$e.QUAD_ARROW=64]="QUAD_ARROW",$e[$e.QUAD_ARROW_CALLOUT=65]="QUAD_ARROW_CALLOUT",$e[$e.RIBBON=66]="RIBBON",$e[$e.RIBBON_2=67]="RIBBON_2",$e[$e.RIGHT_ARROW=68]="RIGHT_ARROW",$e[$e.RIGHT_ARROW_CALLOUT=69]="RIGHT_ARROW_CALLOUT",$e[$e.RIGHT_BRACE=70]="RIGHT_BRACE",$e[$e.RIGHT_BRACKET=71]="RIGHT_BRACKET",$e[$e.ROUND_1_RECTANGLE=72]="ROUND_1_RECTANGLE",$e[$e.ROUND_2_DIAGONAL_RECTANGLE=73]="ROUND_2_DIAGONAL_RECTANGLE",$e[$e.ROUND_2_SAME_RECTANGLE=74]="ROUND_2_SAME_RECTANGLE",$e[$e.RIGHT_TRIANGLE=75]="RIGHT_TRIANGLE",$e[$e.SMILEY_FACE=76]="SMILEY_FACE",$e[$e.SNIP_1_RECTANGLE=77]="SNIP_1_RECTANGLE",$e[$e.SNIP_2_DIAGONAL_RECTANGLE=78]="SNIP_2_DIAGONAL_RECTANGLE",$e[$e.SNIP_2_SAME_RECTANGLE=79]="SNIP_2_SAME_RECTANGLE",$e[$e.SNIP_ROUND_RECTANGLE=80]="SNIP_ROUND_RECTANGLE",$e[$e.STAR_10=81]="STAR_10",$e[$e.STAR_12=82]="STAR_12",$e[$e.STAR_16=83]="STAR_16",$e[$e.STAR_24=84]="STAR_24",$e[$e.STAR_32=85]="STAR_32",$e[$e.STAR_4=86]="STAR_4",$e[$e.STAR_5=87]="STAR_5",$e[$e.STAR_6=88]="STAR_6",$e[$e.STAR_7=89]="STAR_7",$e[$e.STAR_8=90]="STAR_8",$e[$e.STRIPED_RIGHT_ARROW=91]="STRIPED_RIGHT_ARROW",$e[$e.SUN=92]="SUN",$e[$e.TRAPEZOID=93]="TRAPEZOID",$e[$e.TRIANGLE=94]="TRIANGLE",$e[$e.UP_ARROW=95]="UP_ARROW",$e[$e.UP_ARROW_CALLOUT=96]="UP_ARROW_CALLOUT",$e[$e.UP_DOWN_ARROW=97]="UP_DOWN_ARROW",$e[$e.UTURN_ARROW=98]="UTURN_ARROW",$e[$e.VERTICAL_SCROLL=99]="VERTICAL_SCROLL",$e[$e.WAVE=100]="WAVE",$e[$e.WEDGE_ELLIPSE_CALLOUT=101]="WEDGE_ELLIPSE_CALLOUT",$e[$e.WEDGE_RECTANGLE_CALLOUT=102]="WEDGE_RECTANGLE_CALLOUT",$e[$e.WEDGE_ROUND_RECTANGLE_CALLOUT=103]="WEDGE_ROUND_RECTANGLE_CALLOUT",$e[$e.FLOW_CHART_ALTERNATE_PROCESS=104]="FLOW_CHART_ALTERNATE_PROCESS",$e[$e.FLOW_CHART_COLLATE=105]="FLOW_CHART_COLLATE",$e[$e.FLOW_CHART_CONNECTOR=106]="FLOW_CHART_CONNECTOR",$e[$e.FLOW_CHART_DECISION=107]="FLOW_CHART_DECISION",$e[$e.FLOW_CHART_DELAY=108]="FLOW_CHART_DELAY",$e[$e.FLOW_CHART_DISPLAY=109]="FLOW_CHART_DISPLAY",$e[$e.FLOW_CHART_DOCUMENT=110]="FLOW_CHART_DOCUMENT",$e[$e.FLOW_CHART_EXTRACT=111]="FLOW_CHART_EXTRACT",$e[$e.FLOW_CHART_INPUT_OUTPUT=112]="FLOW_CHART_INPUT_OUTPUT",$e[$e.FLOW_CHART_INTERNAL_STORAGE=113]="FLOW_CHART_INTERNAL_STORAGE",$e[$e.FLOW_CHART_MAGNETIC_DISK=114]="FLOW_CHART_MAGNETIC_DISK",$e[$e.FLOW_CHART_MAGNETIC_DRUM=115]="FLOW_CHART_MAGNETIC_DRUM",$e[$e.FLOW_CHART_MAGNETIC_TAPE=116]="FLOW_CHART_MAGNETIC_TAPE",$e[$e.FLOW_CHART_MANUAL_INPUT=117]="FLOW_CHART_MANUAL_INPUT",$e[$e.FLOW_CHART_MANUAL_OPERATION=118]="FLOW_CHART_MANUAL_OPERATION",$e[$e.FLOW_CHART_MERGE=119]="FLOW_CHART_MERGE",$e[$e.FLOW_CHART_MULTIDOCUMENT=120]="FLOW_CHART_MULTIDOCUMENT",$e[$e.FLOW_CHART_OFFLINE_STORAGE=121]="FLOW_CHART_OFFLINE_STORAGE",$e[$e.FLOW_CHART_OFFPAGE_CONNECTOR=122]="FLOW_CHART_OFFPAGE_CONNECTOR",$e[$e.FLOW_CHART_ONLINE_STORAGE=123]="FLOW_CHART_ONLINE_STORAGE",$e[$e.FLOW_CHART_OR=124]="FLOW_CHART_OR",$e[$e.FLOW_CHART_PREDEFINED_PROCESS=125]="FLOW_CHART_PREDEFINED_PROCESS",$e[$e.FLOW_CHART_PREPARATION=126]="FLOW_CHART_PREPARATION",$e[$e.FLOW_CHART_PROCESS=127]="FLOW_CHART_PROCESS",$e[$e.FLOW_CHART_PUNCHED_CARD=128]="FLOW_CHART_PUNCHED_CARD",$e[$e.FLOW_CHART_PUNCHED_TAPE=129]="FLOW_CHART_PUNCHED_TAPE",$e[$e.FLOW_CHART_SORT=130]="FLOW_CHART_SORT",$e[$e.FLOW_CHART_SUMMING_JUNCTION=131]="FLOW_CHART_SUMMING_JUNCTION",$e[$e.FLOW_CHART_TERMINATOR=132]="FLOW_CHART_TERMINATOR",$e[$e.ARROW_EAST=133]="ARROW_EAST",$e[$e.ARROW_NORTH_EAST=134]="ARROW_NORTH_EAST",$e[$e.ARROW_NORTH=135]="ARROW_NORTH",$e[$e.SPEECH=136]="SPEECH",$e[$e.STARBURST=137]="STARBURST",$e[$e.TEARDROP=138]="TEARDROP",$e[$e.ELLIPSE_RIBBON=139]="ELLIPSE_RIBBON",$e[$e.ELLIPSE_RIBBON_2=140]="ELLIPSE_RIBBON_2",$e[$e.CLOUD_CALLOUT=141]="CLOUD_CALLOUT",$e[$e.CUSTOM=142]="CUSTOM";const Ze={startRow:-1,startColumn:-1,endRow:-1,endColumn:-1};Ue.FALSE,me.EN;const qe={type:Ie.GRID,name:"Sheet1",id:"sheet-01",tabColor:"",hidden:Ue.FALSE,freezeColumn:-1,rowCount:1e3,columnCount:100,freezeRow:-1,zoomRatio:1,scrollTop:0,scrollLeft:0,defaultColumnWidth:73,defaultRowHeight:19,mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},status:Ue.FALSE,showGridlines:Ue.TRUE,rowTitle:{width:46,hidden:Ue.FALSE},columnTitle:{height:20,hidden:Ue.FALSE},selections:["A1"],rightToLeft:Ue.FALSE,pluginMeta:{}},Qe={ff:"Times New Roman",fs:14,it:Ue.FALSE,bl:Ue.FALSE,ul:{s:Ue.FALSE},st:{s:Ue.FALSE},ol:{s:Ue.FALSE},tr:{a:0,v:Ue.FALSE},td:Se.UNSPECIFIED,cl:{rgb:"#000"},bg:{rgb:"#fff"},ht:Ne.UNSPECIFIED,vt:Oe.UNSPECIFIED,tb:Me.UNSPECIFIED,pd:{t:0,r:0,b:0,l:0}},Je={id:"default_slide",title:"defaultSlide",pageSize:{width:300,height:300}};var tn,en;(en=tn||(tn={})).ARRAY_CONVERTOR="ARRAY_CONVERTOR",en.MATRIX_CONVERTOR="MATRIX_CONVERTOR";const nn={modifier:["Alt","AltGraph","CapsLock","Control","Fn","FnLock","Meta","NumLock","ScrollLock","Shift","Symbol","SymbolLock"],legacyModifier:["Hyper","Super"],whiteSpace:["Enter","Tab"],navigation:["ArrowDown","ArrowLeft","ArrowRight","ArrowUp","End","Home","PageDown","PageUp"],editing:["Backspace","Clear","Copy","CrSel","Cut","Delete","EraseEof","ExSel","Insert","Paste","Redo","Undo"],ui:["Accept","Again","Attn","Cancel","ContextMenu","Escape","Execute","Find","Help","Pause","Play","Props","Select","ZoomIn","ZoomOut"],device:["BrightnessDown","BrightnessUp","Eject","LogOff","Power","PowerOff","PrintScreen","Hibernate","Standby","WakeUp"],imeCompositionKeys:["AllCandidates","Alphanumeric","CodeInput","Compose","Convert","Dead","FinalMode","GroupFirst","GroupLast","GroupNext","GroupPrevious","ModeChange","NextCandidate","NonConvert","PreviousCandidate","Process","SingleCandidate"],koreanSpecific:["HangulMode","HanjaMode","JunjaMode"],japaneseSpecific:["Eisu","Hankaku","Hiragana","HiraganaKatakana","KanaMode","KanjiMode","Katakana","Romaji","Zenkaku","ZenkakuHankaku"],commonFunction:["F1","F2","F3","F4","F5","F6","F7","F8","F9","F10","F11","F12","Soft1","Soft2","Soft3","Soft4"],multimedia:["ChannelDown","ChannelUp","Close","MailForward","MailReply","MailSend","MediaClose","MediaFastForward","MediaPause","MediaPlay","MediaPlayPause","MediaRecord","MediaRewind","MediaStop","MediaTrackNext","MediaTrackPrevious","New","Open","Print","Save","SpellCheck"],multimediaNumpad:["Key11","Key12"],audio:["AudioBalanceLeft","AudioBalanceRight","AudioBassBoostDown","AudioBassBoostToggle","AudioBassBoostUp","AudioFaderFront","AudioFaderRear","AudioSurroundModeNext","AudioTrebleDown","AudioTrebleUp","AudioVolumeDown","AudioVolumeUp","AudioVolumeMute","MicrophoneToggle","MicrophoneVolumeDown","MicrophoneVolumeUp","MicrophoneVolumeMute"],speech:["SpeechCorrectionList","SpeechInputToggle"],application:["LaunchApplication1","LaunchApplication2","LaunchCalendar","LaunchContacts","LaunchMail","LaunchMediaPlayer","LaunchMusicPlayer","LaunchPhone","LaunchScreenSaver","LaunchSpreadsheet","LaunchWebBrowser","LaunchWebCam","LaunchWordProcessor"],browser:["BrowserBack","BrowserFavorites","BrowserForward","BrowserHome","BrowserRefresh","BrowserSearch","BrowserStop"],mobilePhone:["AppSwitch","Call","Camera","CameraFocus","EndCall","GoBack","GoHome","HeadsetHook","LastNumberRedial","Notification","MannerMode","VoiceDial"],tv:["TV","TV3DMode","TVAntennaCable","TVAudioDescription","TVAudioDescriptionMixDown","TVAudioDescriptionMixUp","TVContentsMenu","TVDataService","TVInput","TVInputComponent1","TVInputComponent2","TVInputComposite1","TVInputComposite2","TVInputHDMI1","TVInputHDMI2","TVInputHDMI3","TVInputHDMI4","TVInputVGA1","TVMediaContext","TVNetwork","TVNumberEntry","TVPower","TVRadioService","TVSatellite","TVSatelliteBS","TVSatelliteCS","TVSatelliteToggle","TVTerrestrialAnalog","TVTerrestrialDigital","TVTimer"],mediaControls:["AVRInput","AVRPower","ColorF0Red","ColorF1Green","ColorF2Yellow","ColorF3Blue","ColorF4Grey","ColorF5Brown","ClosedCaptionToggle","Dimmer","DisplaySwap","DVR","Exit","FavoriteClear0","FavoriteClear1","FavoriteClear2","FavoriteClear3","FavoriteRecall0","FavoriteRecall1","FavoriteRecall2","FavoriteRecall3","FavoriteStore0","FavoriteStore1","FavoriteStore2","FavoriteStore3","Guide","GuideNextDay","GuidePreviousDay","Info","InstantReplay","Link","ListProgram","LiveContent","Lock","MediaApps","MediaAudioTrack","MediaLast","MediaSkipBackward","MediaSkipForward","MediaStepBackward","MediaStepForward","MediaTopMenu","NavigateIn","NavigateNext","NavigateOut","NavigatePrevious","NextFavoriteChannel","NextUserProfile","OnDemand","Pairing","PinPDown","PinPMove","PinPToggle","PinPUp","PlaySpeedDown","PlaySpeedReset","PlaySpeedUp","RandomToggle","RcLowBattery","RecordSpeedNext","RfBypass","ScanChannelsToggle","ScreenModeNext","Settings","SplitScreenToggle","STBInput","STBPower","Subtitle","Teletext","VideoModeNext","Wink","ZoomToggle"]};var sn,on;(on=sn||(sn={})).BASE_COMPONENT="baseComponent",on.BASE_RENDER="renderEngine",on.BASE_UI="baseUI",on.SPREADSHEET="spreadsheet",on.DOCUMENT="document",on.SLIDE="slide";const rn={[Xe.OFFICE]:{[Ye.ACCENT1]:"#4472C4",[Ye.ACCENT2]:"#ED7D31",[Ye.ACCENT3]:"#A5A5A5",[Ye.ACCENT4]:"#70AD47",[Ye.ACCENT5]:"#5B9BD5",[Ye.ACCENT6]:"#70AD47",[Ye.DARK1]:"#000000",[Ye.DARK2]:"#44546A",[Ye.LIGHT1]:"#FFFFFF",[Ye.LIGHT2]:"#E7E6E6",[Ye.HYPERLINK]:"#0563C1",[Ye.FOLLOWED_HYPERLINK]:"#954F72"}};var an,ln,hn,cn,dn,un;(ln=an||(an={}))[ln.SLIDE=0]="SLIDE",ln[ln.MASTER=1]="MASTER",ln[ln.LAYOUT=2]="LAYOUT",ln[ln.HANDOUT_MASTER=3]="HANDOUT_MASTER",ln[ln.NOTES_MASTER=4]="NOTES_MASTER",(cn=hn||(hn={}))[cn.SHAPE=0]="SHAPE",cn[cn.IMAGE=1]="IMAGE",cn[cn.TEXT=2]="TEXT",cn[cn.SPREADSHEET=3]="SPREADSHEET",cn[cn.DOCUMENT=4]="DOCUMENT",cn[cn.SLIDE=5]="SLIDE",(un=dn||(dn={}))[un.RELATIVE_SLIDE_LINK_UNSPECIFIED=0]="RELATIVE_SLIDE_LINK_UNSPECIFIED",un[un.NEXT_SLIDE=1]="NEXT_SLIDE",un[un.PREVIOUS_SLIDE=2]="PREVIOUS_SLIDE",un[un.FIRST_SLIDE=3]="FIRST_SLIDE",un[un.LAST_SLIDE=4]="LAST_SLIDE";class gn{constructor(){this._colorType=Kt.UNSUPPORTED,this._themeColors=Xe.OFFICE,this._themeTint=0}asRgbColor(){return new fn(this._rgbValue,this)}asThemeColor(){return new vn(this._themeValue,this._themeTint,this._themeColors,this)}build(){switch(this._colorType){case Kt.THEME:return this.asThemeColor();case Kt.RGB:return this.asRgbColor();case Kt.UNSUPPORTED:throw Error("unsupported color type")}}setRgbColor(t){return this._colorType=Kt.RGB,this._rgbValue=t,this}setThemeColors(t){this._colorType=Kt.THEME,this._themeColors=t}setThemeTint(t){this._colorType=Kt.THEME,this._themeTint=t}setThemeColor(t){return this._colorType=Kt.THEME,this._themeValue=t,this}getColorType(){return this._colorType}}class _n{constructor(t){this._builder=t}static rgbColorToHexValue(t){return`#${((1<<24)+(t.getRed()<<16)+(t.getGreen()<<8)+t.getBlue()).toString(16).slice(1)}`}static hexValueToRgbColor(t){t?t.indexOf("#")>-1&&(t=t.substring(1)):t="#000000";let e=+`0x${t[0]}${t[1]}`,n=+`0x${t[2]}${t[3]}`,i=+`0x${t[4]}${t[5]}`;return(new gn).setRgbColor(`rgb(${e},${n},${i})`).asRgbColor()}static hexToRgbString(t){t=t.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,((t,e,n,i)=>e+e+n+n+i+i));const e=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);let n=null;if(e){n=`rgba(${parseInt(e[1],16)},${parseInt(e[2],16)},${parseInt(e[3],16)})`}return n}asRgbColor(){return this._builder.asRgbColor()}asThemeColor(){return this._builder.asThemeColor()}getColorType(){return this._builder.getColorType()}clone(){return new _n(this._builder)}equals(t){return!1}}class pn{constructor(t){const e=t.getRed()/255,n=t.getGreen()/255,i=t.getBlue()/255,s=t.getAlpha()/255,o=Math.min(e,Math.min(n,i)),r=Math.max(e,Math.max(n,i)),a=r-o;if(r===o)return this._hue=0,this._saturation=0,void(this._lightness=r);this._lightness=(o+r)/2,this._lightness<.5?this._saturation=a/(r+o):this._saturation=a/(2-r-o),e===r&&(this._hue=(n-i)/a),n===r&&(this._hue=2+(i-e)/a),i===r&&(this._hue=4+(e-n)/a),this._hue*=60,this._hue<0&&(this._hue+=360),this._alpha=s}asRgbColor(){const t=new gn;if(0===this._saturation)return t.setRgbColor(`rgba(${255*this._lightness},${255*this._lightness},${255*this._lightness},${255*this._alpha})`),t.asRgbColor();let e;e=this._lightness<.5?this._lightness*(1+this._saturation):this._lightness+this._saturation-this._lightness*this._saturation;const n=2*this._lightness-e,i=this._hue/360,s=i+1/3,o=this.setColor(e,n,s),r=this.setColor(e,n,i),a=i-1/3,l=this.setColor(e,n,a);return t.setRgbColor(`rgba(${Math.round(255*o)},${Math.round(255*r)},${Math.round(255*l)},${255*this._alpha})`),t.asRgbColor()}getLightness(){return this._lightness}getHue(){return this._hue}getSaturation(){return this._saturation}getAlpha(){return this._alpha}setColor(t,e,n){let i;return n<0&&(n+=1),n>1&&(n-=1),i=6*n<1?e+6*(t-e)*n:2*n<1?t:3*n<2?e+(t-e)*(2/3-n)*6:e,i}setLightness(t){this._lightness=t}}const mn=class extends _n{constructor(t,e){super(e);let n=t.match(mn.RGBA_EXTRACT);if(n){const e=+n[1],i=+n[2],s=+n[3],o=+n[4];return this._cssString=t,this._red=e,this._green=i,this._blue=s,void(this._alpha=o)}if(n=t.match(mn.RGB_EXTRACT),n){const e=+n[1],i=+n[2],s=+n[3];return this._cssString=t,this._red=e,this._green=i,this._blue=s,void(this._alpha=1)}throw new Error("Invalid rgba or rgb color")}asHexString(){return _n.rgbColorToHexValue(this)}getRed(){let t=this._red+mn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getGreen(){let t=this._green+mn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getBlue(){let t=this._blue+mn.RGB_COLOR_AMT;return t>255?t=255:t<0&&(t=0),t}getAlpha(){return this._alpha}getColorType(){return Kt.RGB}clone(){return new mn(this._cssString,this._builder)}asThemeColor(){throw new Error("rgb color not support to themeColor")}equals(t){return t instanceof mn&&(t._red===this._red&&t._blue===this._blue&&t._green===this._green&&t._alpha===this._alpha)}getCssString(){return this._cssString}};let fn=mn;fn.RGB_COLOR_AMT=0,fn.RGBA_EXTRACT=new RegExp("\\s*rgba\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d.\\d|\\d\\s*)\\)\\s*"),fn.RGB_EXTRACT=new RegExp("\\s*rgb\\s*\\((\\s*\\d+\\s*),(\\s*\\d+\\s*),(\\s*\\d+\\s*)\\)\\s*");const Tn=class extends _n{constructor(t,e,n,i){super(i),this._themeColorType=t,this._themeTint=e,this._themeColors=n}lumValue(t,e){if(null==t)return e;let n;return n=t<0?e*(1+t):e*(1-t)+(255-255*(1-t)),n}asRgbColor(){const t=rn[this._themeColors];if(null==t)throw new Error("not find themeColors type");const e=t.get(this._themeColorType);if(null==e)throw new Error("not find themeColors value");let n;if(Tn._cacheThemeColor.has(this._themeColors)){if(n=Tn._cacheThemeColor.get(this._themeColors),n.has(this._themeColorType))return n.get(this._themeColorType)}else n=new Map,Tn._cacheThemeColor.set(this._themeColors,n);const i=new pn(_n.hexValueToRgbColor(e));i.setLightness(this.lumValue(this._themeTint,255*i.getLightness())/255);const s=i.asRgbColor();return n.set(this._themeColorType,s),s}clone(){return new Tn(this._themeColorType,this._themeTint,this._themeColors,this._builder)}equals(t){return t instanceof Tn&&t._themeColorType===this._themeColorType}getColorType(){return Kt.THEME}getThemeColorType(){return this._themeColorType}};let vn=Tn;vn._cacheThemeColor=new Map;class En{constructor(t,e){this._workSheet=t,this._columnData=new k(e)}getColumnData(){return this._columnData}getColumnDatas(t,e){const n=new k;for(let i=t;i<t+e;i++){const t=this.getColumnOrCreate(i);n.push(t)}return n}getSize(){return this._columnData.getLength()}getColumnWidth(...t){const{_workSheet:e}=this,{_columnData:n}=this,i=e.getConfig();let s=0;if(1===t.length){s=n.obtain(t[0],{hd:Ue.FALSE,w:i.defaultColumnWidth}).w}else if(2===t.length)for(let o=t[0];o<t[0]+t[1];o++){s+=n.obtain(o,{hd:Ue.FALSE,w:i.defaultColumnWidth}).w}return s}setColumnWidth(t,e){const n=this._workSheet.getContext(),i=this._workSheet.getCommandManager(),s={sheetId:this._workSheet.getSheetId(),actionName:Bt.SET_COLUMN_WIDTH_ACTION,columnIndex:t,columnWidth:e},o=new Si({WorkBookUnit:n.getWorkBook()},s);i.invoke(o)}getColumn(t){const e=this._columnData.get(t);if(e)return e}getColumnOrCreate(t){const{_workSheet:e}=this,{_columnData:n}=this,i=e.getConfig(),s=n.get(t);if(s)return s;const o={w:i.defaultColumnWidth,hd:Ue.FALSE};return this._columnData.set(t,o),o}}class bn{constructor(t,e){this._worksheet=t,this._rectangleList=e,Ii.getCommandObservers().add((({actions:e})=>{if(!e||0===e.length)return;const n=e[0];try{n.getWorkBook()}catch(l){return}if(t.getContext().getWorkBook().getUnitId()!==n.getWorkBook().getUnitId())return;let i=e.find((t=>t instanceof Ms)),s=e.find((t=>t instanceof Os)),o=e.find((t=>t instanceof Bs)),r=e.find((t=>t instanceof ks)),a=e.find((t=>t instanceof ys));if(i){const t=i.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=z.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],s=t.rowCount;t.rowIndex>i.endRow||(t.rowIndex>=i.startRow&&t.rowIndex<=i.endRow||(i.startRow+=s),i.endRow+=s)}this.modifyMerge(this._rectangleList,e)}}if(s){const t=s.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=z.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],s=t.columnCount;t.columnIndex>i.endColumn||(t.columnIndex>=i.startColumn&&t.columnIndex<=i.endColumn||(i.startColumn+=s),i.endColumn+=s)}this.modifyMerge(this._rectangleList,e)}}if(o){const t=o.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=z.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],s=t.rowCount;t.rowIndex>i.endRow||(t.rowIndex>=i.startRow&&t.rowIndex<=i.endRow||(i.startRow-=s),i.endRow-=s)}this.modifyMerge(this._rectangleList,e)}}if(r){const t=r.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=z.deepClone(this._rectangleList);for(let n=0;n<e.length;n++){const i=e[n],s=t.columnCount;t.columnIndex>i.endColumn||(t.columnIndex>=i.startColumn&&t.columnIndex<=i.endColumn||(i.startColumn-=s),i.endColumn-=s)}this.modifyMerge(this._rectangleList,e)}}if(a){const t=a.getDoActionData();if(t.sheetId===this._worksheet.getSheetId()){const e=z.deepClone(this._rectangleList),n=this.getByRowColumn(t.rangeData.startRow,t.rangeData.endRow,t.rangeData.startColumn,t.rangeData.endColumn);if(n&&n.forEach((t=>{const n=new ii(t);for(let i=0;i<e.length;i++){const t=e[i];n.intersects(new ii(t))&&e.splice(i,1)}})),t.shiftDimension)for(let i=0;i<e.length;i++){const n=e[i];if(n.endRow>=t.rangeData.startRow){if(n.endColumn<t.rangeData.startColumn)continue;if(n.startColumn>t.rangeData.endColumn)continue;if(!(n.startColumn>=t.rangeData.startColumn&&n.endColumn<=t.rangeData.endColumn))return;{const e=t.rangeData.endRow-t.rangeData.startRow;n.startRow-=e,n.endRow-=e}}}else for(let i=0;i<e.length;i++){const n=e[i];if(n.startColumn>t.rangeData.endColumn){if(n.endRow<t.rangeData.startRow)continue;if(n.startRow>t.rangeData.endRow)continue;if(!(n.startRow>=t.rangeData.startRow&&n.endRow<=t.rangeData.endRow))return;{const e=t.rangeData.endColumn-t.rangeData.startColumn;n.startColumn-=e,n.endColumn-=e}}}this.modifyMerge(this._rectangleList,e)}}}))}getMergeData(){return this._rectangleList}getByRowColumn(...t){const{_rectangleList:e}=this;let n;gi.checkup(t,gi.NUMBER_TYPE,gi.NUMBER_TYPE,gi.NUMBER_TYPE,gi.NUMBER_TYPE)?n=new ii(t[0],t[2],t[1],t[3]):gi.checkup(t,gi.NUMBER_TYPE,gi.NUMBER_TYPE)&&(n=new ii(t[0],t[1],t[0],t[1]));const i=[];for(let s=0;s<e.length;s++){const t=e[s];n.intersects(new ii(t))&&i.push(t)}return i.length?i:null}remove(t){let e=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),i={actionName:Hs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},s=new Si({WorkBookUnit:n.getWorkBook()},i);e.invoke(s)}size(){return this._rectangleList.length}add(t){let e=this._worksheet.getCommandManager(),n=this._worksheet.getContext(),i={actionName:Hs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},s={actionName:vs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[t]},o=new Si({WorkBookUnit:n.getWorkBook()},i,s);e.invoke(o)}union(t){const{_rectangleList:e}=this,{length:n}=e;let i=new ii(t);for(let s=0;s<n;s++){const t=e[s];i=i.union(new ii(t))}return i.getData()}getMergedRanges(t){const{_rectangleList:e}=this,{length:n}=e,i=[];for(let s=0;s<n;s++){const n=e[s];new ii(t).intersects(new ii(n))&&i.push(n)}return i}modifyMerge(t,e){let n=this._worksheet.getCommandManager(),i=this._worksheet.getContext(),s={actionName:Hs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...t]},o={actionName:vs.NAME,sheetId:this._worksheet.getSheetId(),rectangles:[...e]},r=new Si({WorkBookUnit:i.getWorkBook()},s,o);n.invoke(r)}}const In={v:"#VALUE!",n:"#NAME?",na:"#N/A",r:"#REF!",d:"#DIV/0!",nm:"#NUM!",nl:"#NULL!",sp:"#SPILL!"};function Cn(t){return null!==t&&""!==t.toString().replace(/\s/g,"")&&("boolean"!=typeof t&&!Number.isNaN(t))}let Sn=new Date("2017-02-19T19:06:09.000Z");Number.isNaN(Sn.getFullYear())&&(Sn=new Date("2/19/17"));const An=2017===Sn.getFullYear();const wn=new Date(1900,2,1,0,0,0);function Rn(t){let e=null,n={},i=t;if(null===t)return null;if(/^-?[0-9]{1,}[,][0-9]{3}(.[0-9]{1,2})?$/.test(t)){e=t,i=Number(t.split(".")[0].replace(",",""));let s="#,##0";if(t.split(".")[1]){s="#,##0.";for(let e=0;e<t.split(".")[1].length;e++)s+=0}n={fa:s,t:"n"}}else if("'"===t.toString().substr(0,1))e=t.toString().substr(1),n={fa:"@",t:"s"};else if("TRUE"===t.toString().toUpperCase())e="TRUE",n={fa:"General",t:"b"},i=!0;else if("FALSE"===t.toString().toUpperCase())e="FALSE",n={fa:"General",t:"b"},i=!1;else if(function(t){let e=!1;for(const n in In)if(t===In[n]){e=!0;break}return e}(t))e=t.toString(),n={fa:"General",t:"e"};else if(/^\d{6}(18|19|20)?\d{2}(0[1-9]|1[12])(0[1-9]|[12]\d|3[01])\d{3}(\d|X)$/i.test(t))e=t.toString(),n={fa:"@",t:"s"};else if(Cn(t)&&Math.abs(parseFloat(t))>0&&(Math.abs(parseFloat(t))>=1e11||Math.abs(parseFloat(t))<1e-9)){i=u(t).value();const s=i.toExponential();if(s.indexOf(".")>-1){let t=s.split(".")[1].split("e")[0].length;t>5&&(t=5),n={fa:`#0.${new Array(t+1).join("0")}E+00`,t:"n"}}else n={fa:"#0.E+00",t:"n"};e=Nn.format(n.fa,i)}else if(t.toString().indexOf("%")>-1){const s=t.toString().indexOf("%");let o=t.toString().substr(0,s);const r=o.replace(/,/g,"");if(s===t.toString().length-1&&Cn(r))if(o.indexOf(".")>-1)if(o.indexOf(".")===o.lastIndexOf(".")){const s=o.split(".")[0];let r=o.split(".")[1].length;if(r>9&&(r=9),s.indexOf(",")>-1){let o=!0,a=s.split(",");for(let t=1;t<a.length;t++)if(a[t].length<3){o=!1;break}o?(n={fa:`#,##0.${new Array(r+1).join("0")}%`,t:"n"},i=u(t).value(),e=Nn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else n={fa:`0.${new Array(r+1).join("0")}%`,t:"n"},i=u(t).value(),e=Nn.format(n.fa,i)}else e=t.toString(),n={fa:"@",t:"s"};else if(o.indexOf(",")>-1){let s=!0,r=o.split(",");for(let t=1;t<r.length;t++)if(r[t].length<3){s=!1;break}s?(n={fa:"#,##0%",t:"n"},i=u(t).value(),e=Nn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else n={fa:"0%",t:"n"},i=u(t).value(),e=Nn.format(n.fa,i);else e=t.toString(),n={fa:"@",t:"s"}}else if(t.toString().indexOf(".")>-1)if(t.toString().indexOf(".")===t.toString().lastIndexOf(".")){const s=t.toString().split(".")[0];let o=t.toString().split(".")[1],r=o.length;if(r>9&&(r=9),s.indexOf(",")>-1){let o=!0,a=s.split(",");for(let t=1;t<a.length;t++)if(!Cn(a[t])||a[t].length<3){o=!1;break}o?(n={fa:`#,##0.${new Array(r+1).join("0")}`,t:"n"},i=u(t).value(),e=Nn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else Cn(s)&&Cn(o)?(n={fa:`0.${new Array(r+1).join("0")}`,t:"n"},i=u(t).value(),e=Nn.format(n.fa,i)):(e=t.toString(),n={fa:"@",t:"s"})}else e=t.toString(),n={fa:"@",t:"s"};else Cn(t)?(e=t.toString(),n={fa:"General",t:"n"},i=parseFloat(t)):null===(s=t)||s.toString().length<5||!function(t){if(!/^(\d{4})-(\d{1,2})-(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(t)&&!/^(\d{4})\/(\d{1,2})\/(\d{1,2})(\s(\d{1,2}):(\d{1,2})(:(\d{1,2}))?)?$/.test(t))return!1;const e=RegExp.$1,n=RegExp.$2,i=RegExp.$3;if(e<1900)return!1;if(n>12)return!1;if(i>31)return!1;if(2===n){if(29===new Date(e,1,29).getDate()&&i>29)return!1;if(29!==new Date(e,1,29).getDate()&&i>28)return!1}return!0}(s)||!(t.toString().indexOf(".")>-1||t.toString().indexOf(":")>-1||t.toString().length<16)?(e=t,n.fa="General",n.t="g"):(i=function(t,e){let n=Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds());const i=Date.UTC(1899,11,31,0,0,0);return e?n-=1262304e5:t>=wn&&(n+=864e5),(n-i)/864e5}(function(t,e){const n=new Date(t);if(An)return e>0?n.setTime(n.getTime()+60*n.getTimezoneOffset()*1e3):e<0&&n.setTime(n.getTime()-60*n.getTimezoneOffset()*1e3),n;if(t instanceof Date)return t;if(1917===Sn.getFullYear()&&!Number.isNaN(n.getFullYear())){const e=n.getFullYear();return t.indexOf(`${e}`)>-1||n.setFullYear(n.getFullYear()+100),n}const i=t.match(/\d+/g)||["2017","2","19","0","0","0"];let s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return t.indexOf("Z")>-1&&(s=new Date(s.getTime()-60*s.getTimezoneOffset()*1e3)),s}(t.toString().replace(/-/g,"/"))),i.toString().indexOf(".")>-1?t.toString().length>18?n.fa="yyyy-MM-dd hh:mm:ss":t.toString().length>11?n.fa="yyyy-MM-dd hh:mm":n.fa="yyyy-MM-dd":n.fa="yyyy-MM-dd",n.t="d",e=Nn.format(n.fa,i));var s;return[e,n,i]}const Nn={format(t,e){}};class yn{static getApplyData(t,e,n,i,s){const o=this,r=[];o.applyType=i,o.direction=s;const a=Math.floor(n/e),l=n%e,h=t.number,c=[];if(h)for(let C=0;C<h.length;C++){const t=o.getLenS(h[C].index,l),r=h[C].index.length*a+t;let d;d=1===i?o.getDataByType(h[C].data,r,s,i,"number"):"2"===i?o.getDataByType(h[C].data,r,s,i):o.getDataByType(h[C].data,r,s,"0");const u=o.getDataIndex(e,n,h[C].index);c.push({data:d,index:u})}const d=t.extendNumber,u=[];if(d)for(let C=0;C<d.length;C++){const t=o.getLenS(d[C].index,l),r=d[C].index.length*a+t;let h;h="1"===i||"3"===i?o.getDataByType(d[C].data,r,s,i,"extendNumber"):"2"===i?o.getDataByType(d[C].data,r,s,i):o.getDataByType(d[C].data,r,s,"0");const c=o.getDataIndex(e,n,d[C].index);u.push({data:h,index:c})}const g=t.date,_=[];if(g)for(let C=0;C<g.length;C++){const t=o.getLenS(g[C].index,l),r=g[C].index.length*a+t;let h;h="1"===i||"3"===i?o.getDataByType(g[C].data,r,s,i,"date"):"8"===i?o.getDataByType(g[C].data,r,s,"0"):o.getDataByType(g[C].data,r,s,i);const c=o.getDataIndex(e,n,g[C].index);_.push({data:h,index:c})}const p=t.chnNumber,m=[];if(p)for(let C=0;C<p.length;C++){const t=o.getLenS(p[C].index,l),r=p[C].index.length*a+t;let h;h="1"===i||"3"===i?o.getDataByType(p[C].data,r,s,i,"chnNumber"):"2"===i||"8"===i?o.getDataByType(p[C].data,r,s,i):o.getDataByType(p[C].data,r,s,"0");const c=o.getDataIndex(e,n,p[C].index);m.push({data:h,index:c})}const f=t.chnWeek2,T=[];if(f)for(let C=0;C<f.length;C++){const t=o.getLenS(f[C].index,l),r=f[C].index.length*a+t;let h;h="1"===i||"3"===i?o.getDataByType(f[C].data,r,s,i,"chnWeek2"):"2"===i?o.getDataByType(f[C].data,r,s,i):o.getDataByType(f[C].data,r,s,"0");const c=o.getDataIndex(e,n,f[C].index);T.push({data:h,index:c})}const v=t.chnWeek3,E=[];if(v)for(let C=0;C<v.length;C++){const t=o.getLenS(v[C].index,l),r=v[C].index.length*a+t;let h;h="1"===i||"3"===i?o.getDataByType(v[C].data,r,s,i,"chnWeek3"):"2"===i?o.getDataByType(v[C].data,r,s,i):o.getDataByType(v[C].data,r,s,"0");const c=o.getDataIndex(e,n,v[C].index);E.push({data:h,index:c})}const b=t.other,I=[];if(b)for(let C=0;C<b.length;C++){const t=o.getLenS(b[C].index,l),r=b[C].index.length*a+t;let h;h="2"===i||"3"===i?o.getDataByType(b[C].data,r,s,i):o.getDataByType(b[C].data,r,s,"0");const c=o.getDataIndex(e,n,b[C].index);I.push({data:h,index:c})}for(let C=1;C<=n;C++){if(c.length>0)for(let t=0;t<c.length;t++)C in c[t].index&&r.push(c[t].data[c[t].index[C]]);if(u.length>0)for(let t=0;t<u.length;t++)C in u[t].index&&r.push(u[t].data[u[t].index[C]]);if(_.length>0)for(let t=0;t<_.length;t++)C in _[t].index&&r.push(_[t].data[_[t].index[C]]);if(m.length>0)for(let t=0;t<m.length;t++)C in m[t].index&&r.push(m[t].data[m[t].index[C]]);if(T.length>0)for(let t=0;t<T.length;t++)C in T[t].index&&r.push(T[t].data[T[t].index[C]]);if(E.length>0)for(let t=0;t<E.length;t++)C in E[t].index&&r.push(E[t].data[E[t].index[C]]);if(I.length>0)for(let t=0;t<I.length;t++)C in I[t].index&&r.push(I[t].data[I[t].index[C]])}return r}static getCopyData(t,e,n,i,s,o){const r=this,a=[];let l=0,h=0,c=0,d=0;o===re.BOTTOM||o===re.TOP?(l=i,h=s,c=e,d=n):o!==re.RIGHT&&o!==re.LEFT||(l=e,h=n,c=i,d=s);for(let u=l;u<=h;u++){const e={};let n=[],i=[],s="",o=null,l=null,h=!0;for(let a=c,u=0;a<=d;a++,u++){const g=t[u];let _;if(g&&g.v&&!g.f)if(g.fm&&g.fm.t===le.NUMBER)_="number",o=null,l=null;else if(g.fm&&g.fm.t===le.DATE)_="date",o=null,l=null;else if(r.isExtendNumber(g.m)[0]){_="extendNumber";const t=r.isExtendNumber(g.m);null===o||null===l?(h=!0,o=t[2],l=t[3]):t[2]!==o||t[3]!==l?(h=!1,o=t[2],l=t[3]):h=!0}else r.isChnNumber(g.m)?(_="chnNumber",o=null,l=null):r.isChnWeek2(g.m)?(_="chnWeek2",o=null,l=null):r.isChnWeek3(g.m)?(_="chnWeek3",o=null,l=null):(_="other",o=null,l=null);else _="other",o=null,l=null;"extendNumber"===_?a===c?c===d?(s=_,n.push(g),i.push(a-c+1),e[s]=[],e[s].push({data:n,index:i})):(s=_,n.push(g),i.push(a-c+1)):a===d?s===_&&h?(n.push(g),i.push(a-c+1),s in e||(e[s]=[],e[s].push({data:n,index:i}))):(s in e||(e[s]=[]),e[s].push({data:n,index:i}),s=_,n=[],n.push(g),i=[],i.push(a-c+1),s in e||(e[s]=[]),e[s].push({data:n,index:i})):s===_&&h?(n.push(g),i.push(a-c+1)):(s in e||(e[s]=[]),e[s].push({data:n,index:i}),s=_,n=[],n.push(g),i=[],i.push(a-c+1)):a===c?c===d?(s=_,n.push(g),i.push(a-c+1),e[s]=[],e[s].push({data:n,index:i})):(s=_,n.push(g),i.push(a-c+1)):a===d?s===_?(n.push(g),i.push(a-c+1),s in e||(e[s]=[]),e[s].push({data:n,index:i})):(s in e||(e[s]=[]),e[s].push({data:n,index:i}),s=_,n=[],n.push(g),i=[],i.push(a-c+1),s in e||(e[s]=[]),e[s].push({data:n,index:i})):s===_?(n.push(g),i.push(a-c+1)):(s in e||(e[s]=[]),e[s].push({data:n,index:i}),s=_,n=[],n.push(g),i=[],i.push(a-c+1))}a.push(e)}return a}static ChineseToNumber(t){const e=this;let n=0,i=0,s=0,o=!1;const r=t.split("");for(let a=0;a<r.length;a++){const t=e.chnNumChar[r[a]];if(void 0!==t)s=t,a===r.length-1&&(i+=s);else{const t=e.chnNameValue[r[a]].value;o=e.chnNameValue[r[a]].secUnit,o?(i=(i+s)*t,n+=i,i=0):i+=s*t,s=0}}return n+i}static NumberToChinese(t){const e=this;let n=0,i="",s="",o=!1;if(0===t)return e.chnNumChar2[0];for(;t>0;){const r=t%1e4;o&&(s=e.chnNumChar2[0]+s),i=e.SectionToChinese(r),i+=0!==r?e.chnUnitSection[n]:e.chnUnitSection[0],s=i+s,o=r<1e3&&r>0,t=Math.floor(t/1e4),n++}return s}static SectionToChinese(t){const e=this;let n="",i="",s=0,o=!0;for(;t>0;){const r=t%10;0===r?o||(o=!0,i=e.chnNumChar2[r]+i):(o=!1,n=e.chnNumChar2[r],n+=e.chnUnitChar[s],i=n+i),s++,t=Math.floor(t/10)}return i}static getLenS(t,e){let n=0;for(let i=0;i<t.length&&t[i]<=e;i++)n++;return n}static getDataByType(t,e,n,i,s){const o=this;let r=[];if(i===Ut.ALTERNATE_SERIES)n!==re.TOP&&n!==re.LEFT||t.reverse(),r=o.FillCopy(t,e);else if(i===Ut.DEFAULT_SERIES)if("number"===s)r=o.FillSeries(t,e,n);else if("extendNumber"===s)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillExtendNumber(t,e,i)}else{const i=[];for(let e=0;e<t.length;e++){const n=t[e].m;i.push(Number(o.isExtendNumber(n)[1]))}if(n!==re.TOP&&n!==re.LEFT||(t.reverse(),i.reverse()),o.isEqualDiff(i)){const n=i[1]-i[0];r=o.FillExtendNumber(t,e,n)}else r=o.FillCopy(t,e)}else if("date"===s)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillDays(t,e,i)}else{n!==re.TOP&&n!==re.LEFT||t.reverse();const i=o.judgeDate(t);if(i[0]&&i[3]){const n=g(t[1].m).diff(g(t[0].m),"months");r=o.FillMonths(t,e,n)}else if(!i[0]&&i[2]){const n=g(t[1].m).diff(g(t[0].m),"days");r=o.FillDays(t,e,n)}else r=o.FillCopy(t,e)}else if("chnNumber"===s)if(1===t.length)if("日"===t[0].m||o.ChineseToNumber(t[0].m)<7){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillChnWeek(t,e,i)}else{let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillChnNumber(t,e,i)}else{let i=!1;for(let e=0;e<t.length;e++)if("日"===t[e].m){i=!0;break}const s=[];let a=0;for(let e=0;e<t.length;e++)"日"===t[e].m?0===e?s.push(0):(a++,s.push(7*a)):i&&o.ChineseToNumber(t[e].m)>0&&o.ChineseToNumber(t[e].m)<7?s.push(o.ChineseToNumber(t[e].m)+7*a):s.push(o.ChineseToNumber(t[e].m));if(n!==re.TOP&&n!==re.LEFT||(t.reverse(),s.reverse()),o.isEqualDiff(s))if(i||s[s.length-1]<6&&s[0]>0||s[0]<6&&s[s.length-1]>0){const n=s[1]-s[0];r=o.FillChnWeek(t,e,n)}else{const n=s[1]-s[0];r=o.FillChnNumber(t,e,n)}else r=o.FillCopy(t,e)}else if("chnWeek2"===s)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillChnWeek2(t,e,i)}else{const i=[];let s=0;for(let e=0;e<t.length;e++){const n=t[e].m.substr(t[e].m.length-1,1);"周日"===t[e].m?0===e?i.push(0):(s++,i.push(7*s)):i.push(o.ChineseToNumber(n)+7*s)}if(n!==re.TOP&&n!==re.LEFT||(t.reverse(),i.reverse()),o.isEqualDiff(i)){const n=i[1]-i[0];r=o.FillChnWeek2(t,e,n)}else r=o.FillCopy(t,e)}else if("chnWeek3"===s)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillChnWeek3(t,e,i)}else{const i=[];let s=0;for(let e=0;e<t.length;e++){const n=t[e].m.substr(t[e].m.length-1,1);"星期日"===t[e].m?0===e?i.push(0):(s++,i.push(7*s)):i.push(o.ChineseToNumber(n)+7*s)}if(n!==re.TOP&&n!==re.LEFT||(t.reverse(),i.reverse()),o.isEqualDiff(i)){const n=i[1]-i[0];r=o.FillChnWeek3(t,e,n)}else r=o.FillCopy(t,e)}else n!==re.TOP&&n!==re.LEFT||t.reverse(),r=o.FillCopy(t,e);else if("2"===i)n!==re.TOP&&n!==re.LEFT||t.reverse(),r=o.FillOnlyFormat(t,e);else if("3"===i){const i=o.getDataByType(t,e,n,"1",s);r=o.FillWithoutFormat(i)}else if("4"===i)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillDays(t,e,i)}else if(2===t.length){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"days");r=o.FillDays(t,e,i)}else{n!==re.TOP&&n!==re.LEFT||t.reverse();const i=o.judgeDate(t);if(i[0]&&i[3]){const n=g(t[1].m).diff(g(t[0].m),"months");r=o.FillMonths(t,e,n)}else if(!i[0]&&i[2]){const n=g(t[1].m).diff(g(t[0].m),"days");r=o.FillDays(t,e,n)}else r=o.FillCopy(t,e)}else if("5"===i)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1);const s=Math.round(1.5*e);for(let n=1;n<=s;n++){const s=h({},t[n]),o=g(s.m).add(n,"days").day();if(0===o||6===o)continue;const a=g(s.m).add(i*n,"days").format("YYYY-MM-DD");if(s.m=a,s.v=Rn(a)[2],r.push(s),r.length===e)break}}else if(2===t.length)if(g(t[1].m).date()===g(t[0].m).date()&&0!==g(t[1].m).diff(g(t[0].m),"months")){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),o=g(t[t.length-1]).add(i*n,"months").day();let a;a=0===o?g(t[t.length-1]).add(i*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===o?g(t[t.length-1]).add(i*n,"months").subtract(1,"days").format("YYYY-MM-DD"):g(t[t.length-1]).add(i*n,"months").format("YYYY-MM-DD"),s.m=a,s.v=Rn(a)[2],r.push(s)}}else if(Math.abs(g(t[1].m).diff(g(t[0].m)))>7){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"months").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").day();let c;c=0===l?g(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):g(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=Rn(c)[2],r.push(o)}}else{let i=0;n===re.BOTTOM||n===re.RIGHT?i=7:n!==re.TOP&&n!==re.LEFT||(i=-7,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"days").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").day();let c;c=0===l?g(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):g(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=Rn(c)[2],r.push(o)}}else{const i=o.judgeDate(t);if(i[0]&&i[3]){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");for(let n=1;n<=e;n++){const e=(n-1)%t.length,s=h({},t[e]),o=g(t[t.length-1].m).add(i*n,"months").day();let a;a=0===o?g(t[t.length-1].m).add(i*n,"months").subtract(2,"days").format("YYYY-MM-DD"):6===o?g(t[t.length-1].m).add(i*n,"months").subtract(1,"days").format("YYYY-MM-DD"):g(t[t.length-1].m).add(i*n,"months").format("YYYY-MM-DD"),s.m=a,s.v=Rn(a)[2],r.push(s)}}else if(!i[0]&&i[2])if(Math.abs(g(t[1].m).diff(g(t[0].m)))>7){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"months").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").day();let c;c=0===l?g(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):g(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=Rn(c)[2],r.push(o)}}else{let i=0;n===re.BOTTOM||n===re.RIGHT?i=7:n!==re.TOP&&n!==re.LEFT||(i=-7,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"days").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").day();let c;c=0===l?g(o.m).add(s,"days").subtract(2,"days").format("YYYY-MM-DD"):6===l?g(o.m).add(s,"days").subtract(1,"days").format("YYYY-MM-DD"):g(o.m).add(s,"days").format("YYYY-MM-DD"),o.m=c,o.v=Rn(c)[2],r.push(o)}}else n!==re.TOP&&n!==re.LEFT||t.reverse(),r=o.FillCopy(t,e)}else if("6"===i)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillMonths(t,e,i)}else if(2===t.length)if(g(t[1].m).date()===g(t[0].m).date()&&0!==g(t[1].m).diff(g(t[0].m),"months")){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");r=o.FillMonths(t,e,i)}else{let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"months").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=Rn(l)[2],r.push(o)}}else{const i=o.judgeDate(t);if(i[0]&&i[3]){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"months");r=o.FillMonths(t,e,i)}else if(!i[0]&&i[2]){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"months").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=Rn(l)[2],r.push(o)}}else n!==re.TOP&&n!==re.LEFT||t.reverse(),r=o.FillCopy(t,e)}else if("7"===i)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillYears(t,e,i)}else if(2===t.length)if(g(t[1].m).date()===g(t[0].m).date()&&g(t[1].m).month()===g(t[0].m).month()&&0!==g(t[1].m).diff(g(t[0].m),"years")){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"years");r=o.FillYears(t,e,i)}else{let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"years").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=Rn(l)[2],r.push(o)}}else{const i=o.judgeDate(t);if(i[0]&&i[1]&&i[4]){n!==re.TOP&&n!==re.LEFT||t.reverse();const i=g(t[1].m).diff(g(t[0].m),"years");r=o.FillYears(t,e,i)}else if(i[0]&&i[3]||i[2]){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1,t.reverse());let s=0;for(let n=1;n<=e;n++){const e=(n-1)%t.length,o=h({},t[e]),a=Math.ceil(n/t.length);0===e&&(s=g(o.m).add(i*a,"years").diff(g(o.m),"days"));const l=g(o.m).add(s,"days").format("YYYY-MM-DD");o.m=l,o.v=Rn(l)[2],r.push(o)}}else n!==re.TOP&&n!==re.LEFT||t.reverse(),r=o.FillCopy(t,e)}else if("8"===i)if(1===t.length){let i=0;n===re.BOTTOM||n===re.RIGHT?i=1:n!==re.TOP&&n!==re.LEFT||(i=-1),r=o.FillChnNumber(t,e,i)}else{const i=[];for(let e=0;e<t.length;e++)i.push(o.ChineseToNumber(t[e].m));if(n!==re.TOP&&n!==re.LEFT||(t.reverse(),i.reverse()),o.isEqualDiff(i)){const n=i[1]-i[0];r=o.FillChnNumber(t,e,n)}else r=o.FillCopy(t,e)}return r}static getDataIndex(t,e,n){const i={},s=Math.floor(e/t),o=e%t;let r=0;if(s>0){for(let e=1;e<=s;e++)for(let s=0;s<n.length;s++)i[n[s]+(e-1)*t]=r,r++;for(let e=0;e<n.length&&n[e]<=o;e++)i[n[e]+t*s]=r,r++}else for(let a=0;a<n.length&&n[a]<=o;a++)i[n[a]]=r,r++;return i}static FillCopy(t,e){const n=[];for(let i=1;i<=e;i++){const e=(i-1)%t.length,s=h({},t[e]);n.push(s)}return n}static FillSeries(t,e,n){const i=this,s=[],o=[];for(let r=0;r<t.length;r++)o.push(Number(t[r].v));if(t.length>2&&i.isEqualRatio(o))for(let r=1;r<=e;r++){const e=(r-1)%t.length,i=h({},t[e]);let o;n===re.BOTTOM||n===re.RIGHT?o=Number(t[t.length-1].v)*(Number(t[1].v)/Number(t[0].v))**r:n!==re.TOP&&n!==re.LEFT||(o=Number(t[0].v)/(Number(t[1].v)/Number(t[0].v))**r),i.v=o,i.m=o,s.push(i)}else{const r=i.getXArr(t.length);for(let a=1;a<=e;a++){const e=(a-1)%t.length,l=h({},t[e]);let c;n===re.BOTTOM||n===re.RIGHT?c=i.forecast(t.length+a,o,r):n!==re.TOP&&n!==re.LEFT||(c=i.forecast(1-a,o,r)),l.v=c,l.m=c,s.push(l)}}return s}static FillExtendNumber(t,e,n){const i=[],s=/0|([1-9]+[0-9]*)/g;for(let o=1;o<=e;o++){const e=(o-1)%t.length,r=h({},t[e]),a=t[t.length-1].m,l=a.match(s),c=l[l.length-1],d=Math.abs(Number(c)+n*o),u=a.lastIndexOf(c),g=a.substr(0,u)+d.toString()+a.substr(u+c.length);r.v=g,r.m=g,i.push(r)}return i}static FillOnlyFormat(t,e){const n=[];for(let i=1;i<=e;i++){const e=(i-1)%t.length,s=h({},t[e]);delete s.f,delete s.m,delete s.v,n.push(s)}return n}static FillWithoutFormat(t){const e=[];for(let n=0;n<t.length;n++){const i=h({},t[n]);let s;s=null===i.f?{m:i.v.toString(),v:i.v}:{f:i.f,m:i.v.toString(),v:i.v},e.push(s)}return e}static FillDays(t,e,n){const i=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,o=h({},t[e]);let r=void o.v;r=g(r).add(n*s,"days").format("YYYY-MM-DD"),o.v=Rn(r)[2],o.m=(o.fm.f,void o.v),i.push(o)}return i}static FillMonths(t,e,n){const i=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,o=h({},t[e]);let r=void o.v;r=g(r).add(n*s,"months").format("YYYY-MM-DD"),o.v=Rn(r)[2],o.m=(o.fm.f,void o.v),i.push(o)}return i}static FillYears(t,e,n){const i=[];for(let s=1;s<=e;s++){const e=(s-1)%t.length,o=h({},t[e]);let r=void o.v;r=g(r).add(n*s,"years").format("YYYY-MM-DD"),o.v=Rn(r)[2],o.m=(o.fm.t,void o.v),i.push(o)}return i}static FillChnWeek(t,e,n){const i=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,r=h({},t[e]);let a;a="日"===t[t.length-1].m?7+n*o:i.ChineseToNumber(t[t.length-1].m)+n*o,a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(r.m="日",r.v="日"):1===l?(r.m="一",r.v="一"):2===l?(r.m="二",r.v="二"):3===l?(r.m="三",r.v="三"):4===l?(r.m="四",r.v="四"):5===l?(r.m="五",r.v="五"):6===l&&(r.m="六",r.v="六"),s.push(r)}return s}static FillChnWeek2(t,e,n){const i=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,r=h({},t[e]);let a;if("周日"===t[t.length-1].m)a=7+n*o;else{const e=t[t.length-1].m,s=e.substr(e.length-1,1);a=i.ChineseToNumber(s)+n*o}a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(r.m="周日",r.v="周日"):1===l?(r.m="周一",r.v="周一"):2===l?(r.m="周二",r.v="周二"):3===l?(r.m="周三",r.v="周三"):4===l?(r.m="周四",r.v="周四"):5===l?(r.m="周五",r.v="周五"):6===l&&(r.m="周六",r.v="周六"),s.push(r)}return s}static FillChnWeek3(t,e,n){const i=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,r=h({},t[e]);let a;if("星期日"===t[t.length-1].m)a=7+n*o;else{const e=t[t.length-1].m,s=e.substr(e.length-1,1);a=i.ChineseToNumber(s)+n*o}a<0&&(a=7*Math.ceil(Math.abs(a)/7)+a);const l=a%7;0===l?(r.m="星期日",r.v="星期日"):1===l?(r.m="星期一",r.v="星期一"):2===l?(r.m="星期二",r.v="星期二"):3===l?(r.m="星期三",r.v="星期三"):4===l?(r.m="星期四",r.v="星期四"):5===l?(r.m="星期五",r.v="星期五"):6===l&&(r.m="星期六",r.v="星期六"),s.push(r)}return s}static FillChnNumber(t,e,n){const i=this,s=[];for(let o=1;o<=e;o++){const e=(o-1)%t.length,r=h({},t[e]),a=i.ChineseToNumber(t[t.length-1].m)+n*o;let l;l=a<=0?"零":i.NumberToChinese(a),r.v=l,r.m=l.toString(),s.push(r)}return s}static isEqualDiff(t){let e=!0;const n=t[1]-t[0];for(let i=1;i<t.length;i++)if(t[i]-t[i-1]!==n){e=!1;break}return e}static isChnNumber(t){const e=this;let n=!0;if(1===t.length)n="日"===t||t in e.chnNumChar;else{const i=t.split("");for(let t=0;t<i.length;t++)if(!(i[t]in e.chnNumChar)&&!(i[t]in e.chnNameValue)){n=!1;break}}return n}static isExtendNumber(t){const e=/0|([1-9]+[0-9]*)/g,n=e.test(t);if(n){const i=t.match(e),s=i[i.length-1],o=t.lastIndexOf(s),r=t.substr(0,o),a=t.substr(o+s.length);return[n,Number(s),r,a]}return[n]}static isChnWeek1(t){const e=this;let n;return n=1===t.length&&("日"===t||e.ChineseToNumber(t)<7),n}static isChnWeek2(t){let e;return e=2===t.length&&("周一"===t||"周二"===t||"周三"===t||"周四"===t||"周五"===t||"周六"===t||"周日"===t),e}static isChnWeek3(t){let e;return e=3===t.length&&("星期一"===t||"星期二"===t||"星期三"===t||"星期四"===t||"星期五"===t||"星期六"===t||"星期日"===t),e}static isEqualRatio(t){let e=!0;const n=t[1]/t[0];for(let i=1;i<t.length;i++)if(t[i]/t[i-1]!==n){e=!1;break}return e}static getXArr(t){const e=[];for(let n=1;n<=t;n++)e.push(n);return e}static forecast(t,e,n){function i(t){let e=0;for(let n=0;n<t.length;n++)e+=t[n];return e/t.length}const s=i(n),o=i(e);let r,a=0,l=0;for(let c=0;c<n.length;c++)a+=(n[c]-s)*(e[c]-o),l+=(n[c]-s)*(n[c]-s);r=0===l?1:a/l;const h=o-r*s;return Math.round(1e5*(h+r*t))/1e5}static judgeDate(t){let e=!0,n=!0,i=!0,s=!0,o=!0;const r=g(t[0].m).date(),a=g(t[0].m).month(),l=g(t[1].m).diff(g(t[0].m),"days"),h=g(t[1].m).diff(g(t[0].m),"months"),c=g(t[1].m).diff(g(t[0].m),"years");for(let d=1;d<t.length;d++)g(t[d].m).date()!==r&&(e=!1),g(t[d].m).month()!==a&&(n=!1),g(t[d].m).diff(g(t[d-1].m),"days")!==l&&(i=!1),g(t[d].m).diff(g(t[d-1].m),"months")!==h&&(s=!1),g(t[d].m).diff(g(t[d-1].m),"years")!==c&&(o=!1);return 0===l&&(i=!1),0===h&&(s=!1),0===c&&(o=!1),[e,n,i,s,o]}}class On{constructor(t,e){this._context=t.getContext(),this._workbook=this._context.getWorkBook(),this._commandManager=this._context.getCommandManager(),this._worksheet=t,this._rangeList=[],e.forEach((t=>{this._rangeList.push(this._context.getWorkBook().transformRangeType(t).rangeData)})),-1===this._rangeList[0].startRow&&console.error("Invalid range,default set startRow -1")}getRangeList(){return this._rangeList}activate(){return-1===this._rangeList[0].startRow?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this._rangeList}),this)}setValue(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:i,endRow:o,endColumn:r}=e,a=new H;for(let s=n;s<=o;s++)for(let e=i;e<=r;e++)a.setValue(n,i,{m:`${t}`,v:t});return{sheetId:s.getSheetId(),actionName:ws.NAME,cellValue:a.getData()}}));let r=new Si({WorkBookUnit:n.getWorkBook()},...o);return i.invoke(r),this}clear(...t){const{_context:e,_worksheet:n,_commandManager:i,_rangeList:s}=this;let o={formatOnly:!0,contentsOnly:!0};gi.checkup(t,gi.OBJECT_TYPE)&&(o=t[0]);const r=s.map((t=>({sheetId:n.getSheetId(),actionName:Rs.NAME,options:o,rangeData:t})));let a=new Si({WorkBookUnit:e.getWorkBook()},...r);return i.invoke(a),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}clearNote(){return this.clear({commentsOnly:!0})}setBackground(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:i,endRow:o,endColumn:r}=e;const a={bg:{rgb:t}},l=z.fillObjectMatrix(o-n+1,r-i+1,a);return{sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Si({WorkBookUnit:n.getWorkBook()},...o);return i.invoke(r),this}setBackgroundRGB(t,e,n){const i=`RGB(${t},${e},${n})`;let{_rangeList:s,_context:o,_commandManager:r,_worksheet:a}=this;const l=s.map((t=>{let{startRow:e,startColumn:n,endRow:s,endColumn:o}=t;const r={bg:{rgb:i}},l=z.fillObjectMatrix(s-e+1,o-n+1,r);return{sheetId:a.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l,rangeData:t}}));let h=new Si({WorkBookUnit:o.getWorkBook()},...l);return r.invoke(h),this}setFontColor(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:i,endRow:o,endColumn:r}=e;const a={cl:{rgb:t}},l=z.fillObjectMatrix(o-n+1,r-i+1,a);return{sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Si({WorkBookUnit:n.getWorkBook()},...o);return i.invoke(r),this}setFontFamily(t){return this._setStyle(t,"ff")}setUnderline(t){const e={s:t?Ue.TRUE:Ue.FALSE};return this._setStyle(e,"ul")}setOverline(t){const e={s:t?Ue.TRUE:Ue.FALSE};return this._setStyle(e,"ol")}setStrikeThrough(t){const e={s:t?Ue.TRUE:Ue.FALSE};return this._setStyle(e,"st")}setFontSize(t){return this._setStyle(t,"fs")}setFontStyle(t){const e=t?Ue.TRUE:Ue.FALSE;return this._setStyle(e,"it")}setFontWeight(t){const e=t?Ue.TRUE:Ue.FALSE;return this._setStyle(e,"bl")}setHorizontalAlignment(t){return this._setStyle(t,"ht")}setTextDirection(t){return this._setStyle(t,"td")}setTextRotation(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:i,endRow:o,endColumn:r}=e;const a={tr:{v:0,a:Number(t)}},l=z.fillObjectMatrix(o-n+1,r-i+1,a);return{sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Si({WorkBookUnit:n.getWorkBook()},...o);return i.invoke(r),this}setVerticalAlignment(t){return this._setStyle(t,"vt"),this}setVerticalText(t){let{_rangeList:e,_context:n,_commandManager:i,_worksheet:s}=this;const o=e.map((e=>{let{startRow:n,startColumn:i,endRow:o,endColumn:r}=e;const a={tr:{v:t,a:0}},l=z.fillObjectMatrix(o-n+1,r-i+1,a);return{sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l,rangeData:e}}));let r=new Si({WorkBookUnit:n.getWorkBook()},...o);return i.invoke(r),this}setWrap(t){return this._setStyle(t,"tb")}setWrapStrategy(t){return this._setStyle(t,"tb")}trimWhitespace(){let{_rangeList:t,_context:e,_commandManager:n,_worksheet:i}=this;const s=t.map((t=>{let{startRow:e,startColumn:n,endRow:s,endColumn:o}=t;const r=this._worksheet.getCellMatrix(),a=/\s+/g;let l=new H;for(let i=e;i<s+1;i++)for(let t=n;t<o+1;t++){const e=r.getValue(i,t).m.replace(a,"");l.setValue(i,t,e||"")}return{sheetId:i.getSheetId(),actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:l.getData(),rangeData:t}}));let o=new Si({WorkBookUnit:e.getWorkBook()},...s);return n.invoke(o),this}_setStyle(t,e){let{_rangeList:n,_context:i,_commandManager:s,_worksheet:o}=this;const r=n.map((n=>{let{startRow:i,startColumn:s,endRow:r,endColumn:a}=n;const l={[e]:t},h=z.fillObjectMatrix(r-i+1,a-s+1,l);return{sheetId:o.getSheetId(),value:h,rangeData:n,actionName:qs.NAME}}));let a=new Si({WorkBookUnit:i.getWorkBook()},...r);return s.invoke(a),this}}class Dn{constructor(t,e){this._workSheet=t,this._rowData=new k(e)}getRowData(){return this._rowData}getRowDatas(t,e){const n=new k;for(let i=t;i<t+e;i++){const t=this.getRowOrCreate(i);n.push(t)}return n}getRowHeight(...t){const{_workSheet:e}=this,{_rowData:n}=this,i=e.getConfig();let s=0;if(1===t.length){s=n.obtain(t[0],{hd:Ue.FALSE,h:i.defaultRowHeight}).h}else if(2===t.length)for(let o=t[0];o<t[0]+t[1];o++){s+=n.obtain(o,{hd:Ue.FALSE,h:i.defaultRowHeight}).h}return s}setRowHeight(t,e){const n=this._workSheet.getContext(),i=this._workSheet.getCommandManager(),s={sheetId:this._workSheet.getSheetId(),actionName:to.NAME,rowIndex:t,rowHeight:e},o=new Si({WorkBookUnit:n.getWorkBook()},s);i.invoke(o)}getRow(t){const{_rowData:e}=this;return e.get(t)}getSize(){return this._rowData.getLength()}getRowOrCreate(t){const{_workSheet:e}=this,{_rowData:n}=this,i=n.get(t);if(i)return i;const s=e.getConfig(),o={hd:Ue.FALSE,h:s.defaultRowHeight};return n.set(t,o),o}}class Mn{constructor(...t){var e;if(z.hasLength(t,1)){t=[t[0],c(h({},qe),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:Ue.FALSE},columnTitle:{height:20,hidden:Ue.FALSE},selections:["A1"],rightToLeft:Ue.FALSE,pluginMeta:{}})]}if(z.hasLength(t,2)){this._context=t[0],this._config=Object.assign(t[1],h(c(h({},qe),{mergeData:[],hideRow:[],hideColumn:[],cellData:{},rowData:{},columnData:{},rowTitle:{width:46,hidden:Ue.FALSE},columnTitle:{height:20,hidden:Ue.FALSE},selections:["A1"],rightToLeft:Ue.FALSE,pluginMeta:{}}),t[1]));const{columnData:n,rowData:i,cellData:s}=this._config;this._sheetId=null!=(e=this._config.id)?e:z.generateRandomId(6),this._initialized=!1,this._cellData=new H(s),this._rowManager=new Dn(this,i),this._columnManager=new En(this,n),this._initialize()}}getCellMatrix(){return this._cellData}activate(){if(this._config.status===Ue.TRUE)return this;const{_context:t}=this,e=this.getCommandManager(),n=t.getContextObserver("onBeforeChangeActiveSheetObservable"),i=t.getContextObserver("onAfterChangeActiveSheetObservable"),s={sheetId:this._sheetId,actionName:ho.NAME,status:Ue.TRUE},o=new Si({WorkBookUnit:t.getWorkBook()},s);return n.notifyObservers({sheet:this}),e.invoke(o),i.notifyObservers({sheet:this}),this}setConfig(t){return this._config=z.commonExtend(qe,t),this}getRowManager(){return this._rowManager}getSheetId(){return this._sheetId}getColumnManager(){return this._columnManager}setName(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s=e.getContextObserver("onBeforeChangeSheetNameObservable"),o=e.getContextObserver("onAfterChangeSheetNameObservable"),r={actionName:_o.NAME,sheetName:t,sheetId:n},a=e.getWorkBook().getSheets();for(let h=0;h<a.length;h++){const e=a[h];if(e!==this&&e.getName()===t)return console.warn("Duplicate name"),this}s.notifyObservers();const l=new Si({WorkBookUnit:e.getWorkBook()},r);return i.invoke(l),o.notifyObservers({name:t,sheet:this}),this}getName(){return this._config.name}clone(){const{_config:t,_context:e}=this,n=z.deepClone(t);return new Mn(e,n)}getContext(){return this._context}getMerges(){return this._merges}getCommandManager(){return this._context.getCommandManager()}getSheetData(){return[]}getRange(...t){return z.hasLength(t,1)?new xn(this,t[0]):z.hasLength(t,2)?new xn(this,{row:[t[0],t[0]],column:[t[1],t[1]]}):z.hasLength(t,3)?new xn(this,{row:[t[0],t[2]],column:[t[1],t[1]]}):z.hasLength(t,4)?new xn(this,{row:[t[0],t[2]],column:[t[1],t[3]]}):void 0}getRangeList(t){return new On(this,t)}getStatus(){const{_config:t}=this;return t.status}setStatus(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s={actionName:po.NAME,sheetId:n,sheetStatus:t},o=new Si({WorkBookUnit:e.getWorkBook()},s);return i.invoke(o),this}getZoomRatio(){return this._config.zoomRatio||1}setZoomRatio(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s={actionName:mo.NAME,zoom:t,sheetId:n},o=new Si({WorkBookUnit:e.getWorkBook()},s);i.invoke(o);e.getContextObserver("onZoomRatioSheetObservable").notifyObservers({zoomRatio:t})}getSelection(){return this._selection}copy(t){const{_config:e,_context:n}=this,i=z.deepClone(e);return i.name=t,i.status=Ue.FALSE,i.id=z.generateRandomId(),new Mn(n,i)}getConfig(){return this._config}insertRows(...t){let e=0,n=1;z.hasLength(t,1)&&(e=t[0]),z.hasLength(t,2)&&(e=t[0],n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:xs.NAME,sheetId:s,rowIndex:e,rowData:H.MakeObjectMatrixSize(n).toJSON()},a={actionName:Ms.NAME,sheetId:s,rowIndex:e,rowCount:n},l=new Si({WorkBookUnit:i.getWorkBook()},r,a);return o.invoke(l),this}insertRowAfter(...t){let e=0,n=1;z.hasLength(t,1)&&(e=t[0]+1),z.hasLength(t,2)&&(e=t[0]+1,n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:xs.NAME,sheetId:s,rowIndex:e,rowData:H.MakeObjectMatrixSize(n).toJSON()},a={actionName:Ms.NAME,sheetId:s,rowIndex:e,rowCount:n},l=new Si({WorkBookUnit:i.getWorkBook()},r,a);return o.invoke(l),this}insertRowBefore(...t){let e=0,n=1;z.hasLength(t,1)&&(e=t[0]-1),z.hasLength(t,2)&&(e=t[0]-1,n=t[1]),e<0&&(e=0);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:xs.NAME,sheetId:s,rowIndex:e,rowData:H.MakeObjectMatrixSize(n).toJSON()},a={actionName:Ms.NAME,sheetId:s,rowIndex:e,rowCount:n},l=new Si({WorkBookUnit:i.getWorkBook()},r,a);return o.invoke(l),this}insertColumns(...t){let e=0,n=1;z.hasLength(t,1)&&(e=t[0]),z.hasLength(t,2)&&(e=t[0],n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r=new H;this._cellData.forEach((t=>{for(let i=e;i<e+n;i++)r.setValue(t,i-e,{})}));const a={actionName:Ds.NAME,sheetId:s,columnIndex:e,columnData:r.toJSON()},l={actionName:Os.NAME,sheetId:s,columnIndex:e,columnCount:n},h=new Si({WorkBookUnit:i.getWorkBook()},l,a);return o.invoke(h),this}insertColumnBefore(...t){let e=0,n=1;z.hasLength(t,1)&&(e=t[0]-1),z.hasLength(t,2)&&(e=t[0]-1,n=t[1]),e<0&&(e=0);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r=new H;if(this._cellData.getLength())this._cellData.forEach((t=>{for(let i=e;i<e+n;i++)r.setValue(t,i-e,{})}));else for(let c=0;c<this._config.rowCount;c++)for(let t=e;t<e+n;t++)r.setValue(c,t-e,{});const a={actionName:Ds.NAME,sheetId:s,columnIndex:e,columnData:r.toJSON()},l={actionName:Os.NAME,sheetId:s,columnIndex:e,columnCount:n},h=new Si({WorkBookUnit:i.getWorkBook()},l,a);return o.invoke(h),this}insertColumnAfter(...t){let e=0,n=1;z.hasLength(t,1)&&(e=t[0]+1),z.hasLength(t,2)&&(e=t[0]+1,n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r=new H;this._cellData.forEach((t=>{for(let i=e;i<e+n;i++)r.setValue(t,i-e,{})}));const a={actionName:Ds.NAME,sheetId:s,columnIndex:e,columnData:r.toJSON()},l={actionName:Os.NAME,sheetId:s,columnIndex:e,columnCount:n},h=new Si({WorkBookUnit:i.getWorkBook()},a,l);return o.invoke(h),this}clear(...t){const{_context:e}=this,n=this.getCommandManager(),i={startRow:0,endRow:this.getConfig().rowCount-1,startColumn:0,endColumn:this.getConfig().columnCount-1};let s={formatOnly:!0,contentsOnly:!0};gi.checkup(t,gi.OBJECT_TYPE)&&(s=t[0]);const o={sheetId:this._sheetId,actionName:Rs.NAME,options:s,rangeData:i},r=new Si({WorkBookUnit:e.getWorkBook()},o);return n.invoke(r),this}setTabColor(t){const{_context:e}=this,n=this.getCommandManager(),i=e.getContextObserver("onSheetTabColorChangeObservable"),s={sheetId:this._sheetId,actionName:ao.NAME,color:t},o=new Si({WorkBookUnit:e.getWorkBook()},s);return n.invoke(o),i.notifyObservers(),this}hideSheet(){const{_context:t}=this,e=this.getCommandManager(),n=t.getWorkBook();if(!this._config.hidden){const i=t.getContextObserver("onHideSheetObservable"),s={hidden:Ue.TRUE,sheetId:this._sheetId,actionName:uo.NAME},o=new Si({WorkBookUnit:t.getWorkBook()},s);e.invoke(o),i.notifyObservers({sheet:this});const r=n.getSheetIndex(this);null!=r&&n.activateSheetByIndex(r)}return this}showSheet(){if(!this._config.hidden)return this;const{_context:t}=this,e=this.getCommandManager(),n={hidden:Ue.FALSE,sheetId:this._sheetId,actionName:uo.NAME},i=new Si({WorkBookUnit:t.getWorkBook()},n);return e.invoke(i),t.getContextObserver("onShowSheetObservable").notifyObservers({sheet:this}),this}setActiveSelection(...t){const e=t[0];return e?this._selection.setSelection({selection:e}):this._selection.setSelection()}getFrozenRows(){return this._config.freezeRow}getFrozenColumns(){return this._config.freezeColumn}getMaxColumns(){const{_config:t}=this,{columnCount:e}=t;return e}getMaxRows(){const{_config:t}=this,{rowCount:e}=t;return e}getType(){const{_config:t}=this,{type:e}=t;return e}clearContents(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({contentsOnly:!0}),this}clearFormats(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({formatOnly:!0}),this}clearNotes(){const{_config:t}=this,{rowCount:e,columnCount:n}=t;return this.getRange({startRow:0,endRow:e,startColumn:0,endColumn:n}).clear({commentsOnly:!0}),this}deleteColumn(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s={actionName:Ps.NAME,sheetId:n,columnCount:1,columnIndex:t},o={actionName:ks.NAME,sheetId:n,columnCount:1,columnIndex:t},r=new Si({WorkBookUnit:e.getWorkBook()},s,o);return i.invoke(r),this}deleteColumns(t,e){const{_context:n,_sheetId:i}=this,s=this.getCommandManager(),o={actionName:Ps.NAME,sheetId:i,columnCount:e,columnIndex:t},r={actionName:ks.NAME,sheetId:i,columnCount:e,columnIndex:t},a=new Si({WorkBookUnit:n.getWorkBook()},o,r);return s.invoke(a),this}deleteRow(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s={actionName:Fs.NAME,sheetId:n,rowCount:1,rowIndex:t},o={actionName:Bs.NAME,sheetId:n,rowCount:1,rowIndex:t},r=new Si({WorkBookUnit:e.getWorkBook()},s,o);return i.invoke(r),this}deleteRows(t,e){const{_context:n,_sheetId:i}=this,s=this.getCommandManager(),o={actionName:Fs.NAME,sheetId:i,rowCount:e,rowIndex:t},r={actionName:Bs.NAME,sheetId:i,rowCount:e,rowIndex:t},a=new Si({WorkBookUnit:n.getWorkBook()},o,r);return s.invoke(a),this}getRowCount(){return this._config.rowCount}getColumnCount(){return this._config.columnCount}setBorderStyle(t,e,n){const{_sheetId:i}=this,s=this.getCommandManager(),o=this.getContext(),r=this.getCellMatrix(),a=o.getWorkBook(),l=a.getStyles(),h=this.getRange({startRow:t.startRow-1,startColumn:t.startColumn,endRow:t.startRow-1,endColumn:t.endColumn}),c=this.getRange({startRow:t.startRow,startColumn:t.startColumn-1,endRow:t.startRow,endColumn:t.endColumn-1}),d=this.getRange({startRow:t.endRow+1,startColumn:t.startColumn,endRow:t.endRow+1,endColumn:t.endColumn}),u=this.getRange({startRow:t.startRow,startColumn:t.endColumn+1,endRow:t.startRow,endColumn:t.endColumn+1}),g=this.getRange(t),_=new H,p=new H,m=new H,f=new H,T=new H;h.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=z.deepClone(i);n.bd&&delete n.bd.b,_.setValue(t,e,n)}}})),d.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=z.deepClone(i);n.bd&&delete n.bd.t,m.setValue(t,e,n)}}})),c.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=z.deepClone(i);n.bd&&delete n.bd.r,p.setValue(t,e,n)}}})),u.forEach(((t,e)=>{const n=r.getValue(t,e);if(n){const i=l.getStyleByCell(n);if(i){const n=z.deepClone(i);n.bd&&delete n.bd.l,f.setValue(t,e,n)}}})),g.forEach(((t,n)=>{T.setValue(t,n,e)}));const v=[];if(n.includes(re.TOP)){const t={sheetId:i,actionName:zs.NAME,styles:m.toJSON()};v.push(t)}if(n.includes(re.BOTTOM)){const t={sheetId:i,actionName:zs.NAME,styles:_.toJSON()};v.push(t)}if(n.includes(re.LEFT)){const t={sheetId:i,actionName:zs.NAME,styles:f.toJSON()};v.push(t)}if(n.includes(re.RIGHT)){const t={sheetId:i,actionName:zs.NAME,styles:p.toJSON()};v.push(t)}const E={sheetId:i,actionName:zs.NAME,styles:T.toJSON()};v.push(E);const b=new Si({WorkBookUnit:a},...v);return s.invoke(b),this}setCurrentCell(t){return t.activateAsCurrentCell()}getActiveCell(){return this.getSelection().getCurrentCell()}getActiveRange(){return this.getSelection().getActiveRange()}getActiveRangeList(){return this.getSelection().getActiveRangeList()}getIndex(){const t=this._context.getWorkBook().getSheets().findIndex((t=>t&&t.getSheetId()===this._sheetId));return t>-1?t+1:null}getParent(){return this._context.getWorkBook()}isSheetHidden(){return this._config.hidden}setActiveRange(t){return this.getSelection().setSelection(t)}setActiveRangeList(t){const e=this.getSelection();return e.setSelection(t),e.getActiveRangeList()}hideRow(t){const e=t.getRangeData(),n=e.startRow,i=e.endRow-e.startRow+1,{_context:s,_sheetId:o}=this,r=this.getCommandManager(),a={actionName:eo.NAME,sheetId:o,rowCount:i,rowIndex:n},l=new Si({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}hideRows(...t){const e=--t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:eo.NAME,sheetId:s,rowCount:n,rowIndex:e},a=new Si({WorkBookUnit:i.getWorkBook()},r);return o.invoke(a),this}hideColumn(t){const e=t.getRangeData(),n=e.startColumn,i=e.endColumn-e.startColumn+1,{_context:s,_sheetId:o}=this,r=this.getCommandManager(),a={actionName:Ws.NAME,sheetId:o,columnCount:i,columnIndex:n},l=new Si({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}hideColumns(...t){const e=t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:Ws.NAME,sheetId:s,columnCount:n,columnIndex:e},a=new Si({WorkBookUnit:i.getWorkBook()},r);return o.invoke(a),this}unhideRow(t){const e=t.getRangeData(),n=e.startRow,i=e.endRow-e.startRow+1,{_context:s,_sheetId:o}=this,r=this.getCommandManager(),a={actionName:no.NAME,rowCount:i,rowIndex:n,sheetId:o},l=new Si({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}unhideColumn(t){const e=t.getRangeData(),n=e.startColumn,i=e.endColumn-e.startColumn+1,{_context:s,_sheetId:o}=this,r=this.getCommandManager(),a={actionName:Vs.NAME,sheetId:o,columnCount:i,columnIndex:n},l=new Si({WorkBookUnit:s.getWorkBook()},a);return r.invoke(l),this}showColumns(...t){const e=t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:Vs.NAME,sheetId:s,columnCount:n,columnIndex:e},a=new Si({WorkBookUnit:i.getWorkBook()},r);return o.invoke(a),this}showRows(...t){const e=--t[0];let n=1;t[1]&&(n=t[1]);const{_context:i,_sheetId:s}=this,o=this.getCommandManager(),r={actionName:no.NAME,sheetId:s,rowCount:n,rowIndex:e},a=new Si({WorkBookUnit:i.getWorkBook()},r);return o.invoke(a),this}hasHiddenGridlines(){const{_config:t}=this,{showGridlines:e}=t;return 0===e}getTabColor(){const{_config:t}=this,{tabColor:e}=t;return e}getColumnWidth(t){return this.getColumnManager().getColumnWidth(t)}getRowHeight(t){return this.getRowManager().getRowHeight(t)}setColumnWidth(...t){let e,n=[];if(z.hasLength(t,2)&&(e=t[0],n=[t[1]]),z.hasLength(t,3)){e=t[0];for(let e=0;e<t[1];e++)n.push(t[2])}return this.getColumnManager().setColumnWidth(e,n),this}setRowHeights(t,e,n){const i=[];for(let s=0;s<e;s++)i.push(n);return this.getRowManager().setRowHeight(t,i),this}setRowHeight(t,e){const n=[e];return this.getRowManager().setRowHeight(t,n),this}setHiddenGridlines(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s={actionName:Gs.NAME,hideGridlines:t,sheetId:n},o=new Si({WorkBookUnit:e.getWorkBook()},s);return i.invoke(o),this}isRightToLeft(){const{_config:t}=this,{rightToLeft:e}=t;return e}setRightToLeft(t){const{_context:e,_sheetId:n}=this,i=this.getCommandManager(),s={actionName:Js.NAME,rightToLeft:t,sheetId:n},o=new Si({WorkBookUnit:e.getWorkBook()},s);return i.invoke(o),this}getPluginMeta(t){return this._config.pluginMeta[t]}setPluginMeta(t,e){this._config.pluginMeta[t]=e}copyTo(t){const e=this._context.getWorkBook().getSheets()[t];if(!e)return this;const n=z.deepClone(this._config);return n.sheetId=e.getConfig().id,e.setConfig(n),e}getLastRow(){return this._cellData.getLength()}getLastColumn(){return this._cellData.getRange().endColumn}getSheetValues(t,e,n,i){return new xn(this,{startRow:t,startColumn:e,endRow:t+n-1,endColumn:e+i-1}).getValues()}getDataRange(){return new xn(this,this._cellData.getRange())}moveRows(t,e){const{startRow:n}=t.getRangeData(),{endRow:i}=t.getRangeData(),s=this._cellData.spliceRows(n,i-n+1);return this._cellData.insertRows(e,s),this}moveColumns(t,e){const n=t.getRangeData().startColumn,i=t.getRangeData().endColumn,s=this._cellData.spliceColumns(n,i-n+1);return this._cellData.insertColumns(e,s),this}_initialize(){this._merges=new bn(this,this._config.mergeData)}}class xn{constructor(t,e){this._context=t.getContext(),this._commandManager=this._context.getCommandManager(),this._rangeData=this._context.getWorkBook().transformRangeType(e).rangeData,this._worksheet=t,Object.values(this._rangeData).includes(-1)&&console.error("Invalid range,default set index -1")}static foreach(t,e){const{startRow:n,startColumn:i,endRow:s,endColumn:o}=t;for(let r=n;r<=s;r++)for(let t=i;t<=o;t++)e(r,t)}getRangeData(){return this._rangeData}getValue(){return this.getValues()[0][0]}getValues(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData,s=[];for(let o=t;o<=e;o++){const t=[];for(let e=n;e<=i;e++)t.push(this.getMatrix().getValue(o,e)||null);s.push(t)}return s}getMatrix(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new H;for(let r=t;r<=e;r++)for(let t=n;t<=i;t++)o.setValue(r,t,s.getValue(r,t)||null);return o}getMatrixObject(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData,s=this._worksheet.getCellMatrix(),o=new H;for(let r=t;r<=e;r++)for(let e=n;e<=i;e++)o.setValue(r-t,e-n,s.getValue(r,e)||{});return o}getDisplayValue(){const t=this.getValue();return t&&t.p?t.p:t&&t.m?t.m:""}getDisplayValues(){return this.getValues().map((t=>t.map((t=>t&&t.p?t.p:t&&t.m?t.m:""))))}getA1Notation(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData;let s,o;return n<i?(s=z.numToWord(n+1)+(t+1),o=z.numToWord(i+1)+(e+1)):(s=z.numToWord(i+1)+(e+1),o=z.numToWord(n+1)+(t+1)),s===o?`${s}`:`${s}:${o}`}getBackground(){return this.getBackgrounds()[0][0]}getBackgrounds(){return this.getValues().map((t=>t.map((t=>{var e,n,i;const s=this._context.getWorkBook().getStyles();let o=null==(e=Qe.bg)?void 0:e.rgb;return o=null==(i=null==(n=s.getStyleByCell(t))?void 0:n.bg)?void 0:i.rgb,o}))))}getCell(t,e){const{startRow:n,endRow:i,startColumn:s,endColumn:o}=this._rangeData,r={startRow:n+t,endRow:n+t,startColumn:s+e,endColumn:s+e};return new xn(this._worksheet,r)}getColumn(){return this._rangeData.startColumn}getObjectValue(t={}){return this.getObjectValues(t)[0][0]}getObjectValues(t={}){const{startRow:e,endRow:n,startColumn:i,endColumn:s}=this._rangeData,o=this._worksheet.getCellMatrix().getFragments(e,n,i,s).getData();if(t.isIncludeStyle){const t=this._context.getWorkBook().getStyles();for(let r=0;r<=n-e;r++)for(let e=0;e<=s-i;e++){if(!o[r][e])continue;const n=o[r][e].s;n&&(o[r][e].s=t.get(n))}}return o}getFontColor(){return this.getFontColors()[0][0]}getFontColors(){return this.getValues().map((t=>t.map((t=>{var e,n;const i=this._context.getWorkBook().getStyles().getStyleByCell(t);return(null==(e=null==i?void 0:i.cl)?void 0:e.rgb)||(null==(n=Qe.cl)?void 0:n.rgb)}))))}getFontFamilies(){return this._getStyles("ff")}getFontFamily(){return this.getFontFamilies()[0][0]}getUnderlines(){return this._getStyles("ul")}getUnderline(){return this.getUnderlines()[0][0]}getOverlines(){return this._getStyles("ol")}getOverline(){return this.getOverlines()[0][0]}getStrikeThroughs(){return this._getStyles("st")}getStrikeThrough(){return this.getStrikeThroughs()[0][0]}getFontSize(){return this.getFontSizes()[0][0]}getFontSizes(){return this._getStyles("fs")}getBorder(){return this.getBorders()[0][0]}getBorders(){return this._getStyles("bd")}getFontStyle(){return this.getFontStyles()[0][0]}getFontStyles(){return this._getStyles("it")}getFontWeight(){return this.getFontWeights()[0][0]}getFontWeights(){return this._getStyles("bl")}getGridId(){return this._worksheet.getSheetId()}getHeight(){const{_rangeData:t,_worksheet:e}=this,{startRow:n,endRow:i}=t;let s=0;for(let o=0;o<=i-n;o++){s+=e.getRowHeight(o)}return s}getHorizontalAlignment(){return this.getHorizontalAlignments()[0][0]}getHorizontalAlignments(){return this._getStyles("ht")}getLastColumn(){return this._rangeData.endColumn}getLastRow(){return this._rangeData.endRow}getMergedRanges(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData;return this._worksheet.getMerges().getMergedRanges({startRow:t,endRow:e,startColumn:n,endColumn:i}).map((t=>new xn(this._worksheet,t)))}getNextDataCell(t){const{_worksheet:e}=this,{startRow:n,endRow:i,startColumn:s,endColumn:o}=this._rangeData,r=e.getMaxRows(),a=e.getMaxColumns();if(t===re.BOTTOM){for(let t=0;t<r-s;t++){this._worksheet.getCellMatrix().getValue(n+t,s)&&e.getRange(n+t,s,n+t,s)}return e.getRange(r,s,r,s)}if(t===re.TOP){for(let t=0;t<n;t++){this._worksheet.getCellMatrix().getValue(n-t,s)&&e.getRange(n-t,s,n-t,n)}return e.getRange(0,s,0,s)}if(t===re.RIGHT){for(let t=0;t<a-s;t++){this._worksheet.getCellMatrix().getValue(n,s+t)&&e.getRange(n,s+t,n,s+t)}return e.getRange(n,a,n,a)}if(t===re.LEFT){for(let t=0;t<r-s;t++){this._worksheet.getCellMatrix().getValue(n,s-t)&&e.getRange(n,s-t,n,s-t)}return e.getRange(n,0,n,0)}return e.getRange(Ze)}getNumColumns(){const{startColumn:t,endColumn:e}=this._rangeData;return e-t+1}getNumRows(){const{startRow:t,endRow:e}=this._rangeData;return e-t+1}getRichTextValue(){return this.getRichTextValues()[0][0]}getRichTextValues(){return this.getValues().map((t=>t.map((t=>(null==t?void 0:t.p)||""))))}getRowIndex(){return this._rangeData.startRow}getSheet(){return this._worksheet}getTextDirection(){return this.getTextDirections()[0][0]}getTextDirections(){return this._getStyles("td")}getTextRotation(){return this.getTextRotations()[0][0]}getTextRotations(){return this._getStyles("tr")}getTextStyle(){return this.getTextStyles()[0][0]}getTextStyles(){return this.getValues().map((t=>t.map((t=>this._context.getWorkBook().getStyles().getStyleByCell(t)))))}getVerticalAlignment(){return this.getVerticalAlignments()[0][0]}getVerticalAlignments(){return this._getStyles("vt")}getWidth(){const{_rangeData:t,_worksheet:e}=this,{startColumn:n,endColumn:i}=t;let s=0;for(let o=0;o<=i-n;o++)s+=e.getColumnWidth(o);return s}getWrap(){return this.getWraps()[0][0]}getWraps(){return this._getStyles("tb")}getWrapStrategies(){return this._getStyles("tb")}getWrapStrategy(){return this.getWrapStrategies()[0][0]}isBlank(){return this.getValues().some((t=>t.some((t=>""===(null==t?void 0:t.m)))))}isPartOfMerge(){const{startRow:t,endRow:e,startColumn:n,endColumn:i}=this._rangeData;return!!this._worksheet.getMerges().getByRowColumn(t,e,n,i)}setBackground(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={bg:{rgb:t}},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setBackgrounds(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-r+1;e++)l.setValue(d,e,{bg:{rgb:t[d][e]}});const h={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Si({WorkBookUnit:e.getWorkBook()},h);return i.invoke(c),this}setBackgroundRGB(t,e,n){const{_context:i,_worksheet:s,_commandManager:o}=this,{startRow:r,endRow:a,startColumn:l,endColumn:h}=this._rangeData,c={bg:{rgb:`RGB(${t},${e},${n})`}},d=z.fillObjectMatrix(a-r+1,h-l+1,c),u={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:d,rangeData:this._rangeData},g=new Si({WorkBookUnit:i.getWorkBook()},u);return o.invoke(g),this}setFontColors(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-r+1;e++)l.setValue(d,e,{cl:{rgb:t[d][e]}});const h={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Si({WorkBookUnit:e.getWorkBook()},h);return i.invoke(c),this}setFontFamilies(t){return this._setStyles(t,"ff"),this}setUnderline(t){return this._setStyle(t,"ul"),this}setOverline(t){return this._setStyle(t,"ol"),this}setStrikeThrough(t){return this._setStyle(t,"st"),this}setUnderlines(t){return this._setStyles(t,"ul"),this}setOverlines(t){return this._setStyles(t,"ol"),this}setStrikeThroughs(t){return this._setStyles(t,"st"),this}setFontSizes(t){return this._setStyles(t,"fs"),this}setFontStyle(t){return this._setStyle(t,"it"),this}setFontStyles(t){return this._setStyles(t,"it"),this}setFontWeight(t){return this._setStyle(t,"bl"),this}setFontWeights(t){return this._setStyles(t,"bl"),this}setHorizontalAlignments(t){return this._setStyles(t,"ht"),this}setTextDirections(t){return this._setStyles(t,"td"),this}setTextRotation(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={tr:{v:0,a:Number(t)}},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setTextRotations(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let d=0;d<o-s+1;d++)for(let e=0;e<a-r+1;e++)l.setValue(d,e,{tr:{v:0,a:t[d][e]}});l.getData();const h={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},c=new Si({WorkBookUnit:e.getWorkBook()},h);return i.invoke(c),this}setTextStyle(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=h({},t),c=z.fillObjectMatrix(o-s+1,a-r+1,l),d={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:c,rangeData:this._rangeData},u=new Si({WorkBookUnit:e.getWorkBook()},d);return i.invoke(u),this}setTextStyles(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=new H;for(let u=0;u<o-s+1;u++)for(let e=0;e<a-r+1;e++)l.setValue(u,e,h({},t[u][e]));const c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:l.getData(),rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setVerticalAlignments(t){return this._setStyles(t,"vt"),this}setVerticalText(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={tr:{v:t,a:90}},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setWrap(t){return this._setStyle(t,"tb"),this}setWrapStrategies(t){return this._setStyles(t,"tb"),this}setWraps(t){return this._setStyles(t,"tb"),this}autoFill(t,e){const{_worksheet:n,_context:i,_commandManager:s}=this,{startRow:o,endRow:r,startColumn:a,endColumn:l}=this._rangeData,{startRow:h,endRow:c,startColumn:d,endColumn:u}=t._rangeData;let g=re.BOTTOM,_=0,p=0;const m=o,f=r,T=a,v=l,E=h,b=c,I=d,C=u,S=new H;if(g=I===T&&C===v?b>f?re.BOTTOM:re.TOP:C>v?re.RIGHT:re.LEFT,g===re.BOTTOM||g===re.TOP){_=f-m+1,p=b-E+1;for(let t=0;t<=l-a;t++){const n=this.getColumnMatrix(t).toArray();yn.getCopyData(n,m,f,T,v,g).forEach((n=>{yn.getApplyData(n,_,p,e,g).forEach(((e,n)=>{S.setValue(n,t,e)}))}))}}else if(g===re.RIGHT||g===re.LEFT){p=C-I,_=v-T;for(let t=0;t<=r-o;t++){const n=this.getRowMatrix(t).toArray();yn.getCopyData(n,m,f,T,v,g).forEach((t=>{yn.getApplyData(t,_,p,e,g)}))}}const A={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:S.getData()},w=new Si({WorkBookUnit:i.getWorkBook()},A);return s.invoke(w),this}getDataRegion(...t){const{startRow:e,endRow:n,startColumn:i,endColumn:s}=this._rangeData;let o,r;const a=this._worksheet.getCellMatrix();if(!z.isNumber(t[0])){let t=e,n=e;const s=this._worksheet.getRowCount();for(let o=1;o<e;o++){if(!a.getValue(e-o,i)){t=e-o+1;break}}const l=0;for(;l<s-e;){if(!a.getValue(e+l,i)){n=e-l-1;break}}let h=e,c=e;const d=this._worksheet.getColumnCount();for(let o=1;o<e;o++){if(!a.getValue(e,i-o)){h=e-o+1;break}}const u=0;for(;u<d-i;){if(!a.getValue(e,i+u)){c=e-u-1;break}}return r=h-c,r=t-n,o=e,this._worksheet.getRange(t,h,o,r)}{const n=t[0];if(n===se.COLUMNS){let t=e,n=e;const s=this._worksheet.getRowCount();for(let o=1;o<e;o++){if(!a.getValue(e-o,i)){t=e-o+1;break}}const l=0;for(;l<s-e;){if(!a.getValue(e+l,i)){n=e-l-1;break}}return r=t-n,o=0,this._worksheet.getRange(e,t,o,r)}if(n===se.ROWS){let t=e,n=e;const s=this._worksheet.getColumnCount();for(let o=1;o<e;o++){if(!a.getValue(e,i-o)){t=e-o+1;break}}const l=0;for(;l<s-i;){if(!a.getValue(e,i+l)){n=e-l-1;break}}return r=0,o=t-n,this._worksheet.getRange(t,i,o,r)}}return this}trimWhitespace(){var t;const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=this._worksheet.getCellMatrix(),h=/\s+/g,c=new H;for(let g=0;g<=o-s;g++)for(let e=0;e<=a-r;e++){const n=null==(t=l.getValue(g,e).m)?void 0:t.replace(h,"");c.setValue(g+s,e+r,n||"")}const d={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:this._rangeData},u=new Si({WorkBookUnit:e.getWorkBook()},d);return i.invoke(u),this}activate(){var t;return-1===(null==(t=this._rangeData)?void 0:t.startRow)?(console.error("Invalid range,default set startRow -1"),this):(this._worksheet.getSelection().setSelection({selection:this}),this)}activateAsCurrentCell(){return this._worksheet.getSelection().setCurrentCell(this),this}isIntersection(t){const e=this._rangeData.startRow,n=this._rangeData.endRow,i=this._rangeData.startColumn,s=this._rangeData.endColumn,o=t.getRangeData().startRow,r=t.getRangeData().endRow,a=t.getRangeData().startColumn,l=t.getRangeData().endColumn,h=Math.abs(i+s-a-l),c=Math.abs(i-s)+Math.abs(a-l),d=Math.abs(e+n-o-r),u=Math.abs(e-n)+Math.abs(o-r);return h<=c&&d<=u}setFontColor(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={cl:{rgb:t}},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}copyTo(...t){const{_context:e,_worksheet:n,_commandManager:i}=this,s=t[0],[o,r]=this._handleCopyRange(this,s),{startRow:a,startColumn:l,endRow:h,endColumn:c}=r;if(gi.checkup(t,xn,gi.BOOLEAN_TYPE)){const s=t[1];if(t[2],s===te.PASTE_NORMAL){const t=new H;o.forEach(((e,n)=>e.forEach(((e,i)=>{e=e,t.setValue(n+a,i+l,e||{})}))));const s={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:t.getData()},r=new Si({WorkBookUnit:e.getWorkBook()},s);i.invoke(r)}else if(s===te.PASTE_FORMAT){const t=e.getWorkBook().getStyles(),s=new H;o.map(((e,n)=>e.forEach(((e,i)=>{e=e,s.setValue(n,i,t.getStyleByCell(e)||{})}))));const a={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:s.getData(),rangeData:r},l=new Si({WorkBookUnit:e.getWorkBook()},a);i.invoke(l)}else if(s===te.PASTE_VALUES){const t=new H;o.forEach(((e,n)=>e.forEach(((e,i)=>{e=e,t.setValue(n+a,i+l,(null==e?void 0:e.v)||"")}))));const s={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:t.getData(),rangeData:r},h=new Si({WorkBookUnit:e.getWorkBook()},s);i.invoke(h)}else if(s===te.PASTE_COLUMN_WIDTHS){const t=this._rangeData.startColumn;for(let e=0;e<c-t;e++){const i=n.getColumnWidth(t+e);n.setColumnWidth(t+e,i)}}}else if(gi.checkup(t,xn,gi.OBJECT_TYPE)){const s=t[1],r=new H;o.forEach(((t,e)=>t.forEach(((t,n)=>{t=t,r.setValue(e+a,n+l,t||{})}))));const h={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:r.getData(),options:s},c=new Si({WorkBookUnit:e.getWorkBook()},h);i.invoke(c)}else if(gi.checkup(t,xn)){const t=new H;o.forEach(((e,n)=>e.forEach(((e,i)=>{e=e,t.setValue(n+a,i+l,e||{})}))));const s={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:t.getData()},r=new Si({WorkBookUnit:e.getWorkBook()},s);i.invoke(r)}}copyFormatToRange(...t){const{_context:e,_commandManager:n}=this,i=t[1],s=t[2],o=t[3],r=t[4],a=z.isAssignableFrom(t[0],Mn)?t[0].getSheetId():t[0],[l,h]=this._handleCopyRange(this,{startRow:i,endRow:s,startColumn:o,endColumn:r}),c=e.getWorkBook().getStyles(),d=new H;l.map(((t,e)=>t.map(((t,n)=>(t=t,d.setValue(e,n,c.getStyleByCell(t)||{}),c.getStyleByCell(t)||{})))));const u={sheetId:a,actionName:Bt.SET_RANGE_STYLE_ACTION,value:d.getData(),rangeData:h},g=new Si({WorkBookUnit:e.getWorkBook()},u);n.invoke(g)}copyValuesToRange(...t){const{_context:e,_commandManager:n}=this,i=t[1],s=t[2],o=t[3],r=t[4],a=z.isAssignableFrom(t[0],Mn)?t[0].getSheetId():t[0],[l,h]=this._handleCopyRange(this,{startRow:i,endRow:s,startColumn:o,endColumn:r}),c=new H;l.forEach(((t,e)=>t.forEach(((t,n)=>{t=t,c.setValue(e+h.startRow,n+h.startColumn,(null==t?void 0:t.v)||"")}))));const d={sheetId:a,actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:c.getData(),rangeData:h},u=new Si({WorkBookUnit:e.getWorkBook()},d);n.invoke(u)}moveTo(t){const{_context:e,_worksheet:n,_commandManager:i,_rangeData:s}=this,o={sheetId:n.getSheetId(),actionName:Bt.CLEAR_RANGE_ACTION,options:{formatOnly:!0,contentsOnly:!0,commentsOnly:!0,validationsOnly:!0,skipFilteredRows:!0},rangeData:s},r=this.getMatrix(),{startRow:a,endRow:l,startColumn:h,endColumn:c}=this._rangeData,{startRow:d,startColumn:u}=t.getRangeData(),g=new H;for(let m=a;m<=l;m++)for(let t=h;t<=c;t++)g.setValue(d+(m-a),u+(t-h),r.getValue(m,t)||{});const _={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:g.getData()},p=new Si({WorkBookUnit:e.getWorkBook()},o,_);i.invoke(p)}offset(...t){const{startRow:e,endRow:n,startColumn:i,endColumn:s}=this._rangeData,o=t[0],r=t[1],a=t[2],l=t[3],h={startRow:e+o,endRow:n+o,startColumn:i+r,endColumn:s+r};return z.isNumber(a)&&(h.endRow=h.startRow+a-1),z.isNumber(l)&&(h.endColumn=h.endColumn+l-1),new xn(this._worksheet,h)}setBorder(...t){const e=t[0],n=t[1],i=t[2],s=t[3],o=t[4],r=t[5],a=t[6]?t[6]:"black",l=t[7]?t[7]:Yt.DASH_DOT,{_context:h,_worksheet:c,_commandManager:d}=this,u=h.getWorkBook(),g=this._rangeData,_=c.getSheetId(),p={startRow:g.startRow-1,startColumn:g.startColumn,endRow:g.startRow-1,endColumn:g.endColumn},m={startRow:g.startRow,startColumn:g.startColumn-1,endRow:g.endRow,endColumn:g.startColumn-1},f={startRow:g.endRow+1,startColumn:g.startColumn,endRow:g.endRow+1,endColumn:g.endColumn},T={startRow:g.startRow,startColumn:g.endColumn+1,endRow:g.endRow,endColumn:g.endColumn+1},v={startRow:g.startRow,startColumn:g.startColumn,endRow:g.startRow,endColumn:g.endColumn},E={startRow:g.startRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.startColumn},b={startRow:g.endRow,startColumn:g.startColumn,endRow:g.endRow,endColumn:g.endColumn},I={startRow:g.startRow,startColumn:g.endColumn,endRow:g.endRow,endColumn:g.endColumn},C=new xn(c,p),S=new xn(c,m),A=new xn(c,f),w=new xn(c,T),R=new xn(c,v),N=new xn(c,E),y=new xn(c,b),O=new xn(c,I),D=new H,M=new H,x=new H,L=new H,k=new H,P=[],B={s:l,cl:{rgb:a}};if(!0===e||!1===e){if(C.isValid()){C.forEach(((t,e)=>{D.setValue(t,e,{bd:{b:null}})}));const t={sheetId:_,actionName:Bt.SET_RANGE_STYLE_ACTION,value:D.getArrayData(),rangeData:p};P.push(t)}R.forEach(((t,n)=>{if(!0===e){const e=z.deepMerge(k.getValue(t,n)||{},{bd:{t:z.deepClone(B)}});k.setValue(t,n,e)}else if(!1===e){const e=z.deepMerge(k.getValue(t,n)||{},{bd:{t:null}});k.setValue(t,n,e)}}))}if(!0===i||!1===i){if(A.isValid()){A.forEach(((t,e)=>{x.setValue(t,e,{bd:{t:null}})}));const t={sheetId:_,actionName:Bt.SET_RANGE_STYLE_ACTION,value:x.getArrayData(),rangeData:f};P.push(t)}y.forEach(((t,e)=>{if(!0===i){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{b:z.deepClone(B)}});k.setValue(t,e,n)}else if(!1===i){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{b:null}});k.setValue(t,e,n)}}))}if(!0===n||!1===n){if(S.isValid()){S.forEach(((t,e)=>{M.setValue(t,e,{bd:{r:null}})}));const t={sheetId:_,actionName:Bt.SET_RANGE_STYLE_ACTION,value:M.getArrayData(),rangeData:m};P.push(t)}N.forEach(((t,e)=>{if(!0===n){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{l:z.deepClone(B)}});k.setValue(t,e,n)}else if(!1===n){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{l:null}});k.setValue(t,e,n)}}))}if(!0===s||!1===s){if(w.isValid()){w.forEach(((t,e)=>{L.setValue(t,e,{bd:{l:null}})}));const t={sheetId:_,actionName:Bt.SET_RANGE_STYLE_ACTION,value:L.getArrayData(),rangeData:T};P.push(t)}O.forEach(((t,e)=>{if(!0===s){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{r:z.deepClone(B)}});k.setValue(t,e,n)}else if(!1===s){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{r:null}});k.setValue(t,e,n)}}))}!0!==o&&!1!==o||this.forEach(((t,e)=>{if(e!==g.endColumn)if(!0===o){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{r:z.deepClone(B)}});k.setValue(t,e,n)}else if(!1===o){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{r:null}});k.setValue(t,e,n)}if(e!==g.startColumn){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{l:null}});k.setValue(t,e,n)}})),!0!==r&&!1!==r||this.forEach(((t,e)=>{if(t!==g.endRow)if(!0===r){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{b:z.deepClone(B)}});k.setValue(t,e,n)}else if(!1===r){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{b:null}});k.setValue(t,e,n)}if(t!==g.startRow){const n=z.deepMerge(k.getValue(t,e)||{},{bd:{t:null}});k.setValue(t,e,n)}}));const F={sheetId:_,actionName:Bt.SET_RANGE_STYLE_ACTION,value:k.getArrayData(),rangeData:k.getDataRange()};P.push(F);const U=new Si({WorkBookUnit:u},...P);return d.invoke(U),this}setBorderByType(t,e,n){let i=null,s=null,o=null,r=null,a=null,l=null;switch(t){case Xt.TOP:i=!0;break;case Xt.BOTTOM:o=!0;break;case Xt.LEFT:s=!0;break;case Xt.RIGHT:r=!0;break;case Xt.NONE:i=!1,s=!1,o=!1,r=!1,a=!1,l=!1;break;case Xt.ALL:i=!0,s=!0,o=!0,r=!0,a=!0,l=!0;break;case Xt.OUTSIDE:i=!0,s=!0,o=!0,r=!0;break;case Xt.INSIDE:a=!0,l=!0;break;case Xt.HORIZONTAL:l=!0;break;case Xt.VERTICAL:a=!0}this.setBorder(i,s,o,r,a,l,e,n)}setFontFamily(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={ff:t},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setFontSize(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={fs:t},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setHorizontalAlignment(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={ht:t},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setVerticalAlignment(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={vt:t},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setTextDirection(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={td:t},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setWrapStrategy(t){const{_context:e,_worksheet:n,_commandManager:i}=this,{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l={tb:t},h=z.fillObjectMatrix(o-s+1,a-r+1,l),c={sheetId:n.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h,rangeData:this._rangeData},d=new Si({WorkBookUnit:e.getWorkBook()},c);return i.invoke(d),this}setValue(t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:s}=this,{startRow:o,startColumn:r,endRow:a,endColumn:l}=e,h=new H;for(let u=o;u<=a;u++)for(let e=r;e<=l;e++)h.setValue(u,e,t);const c={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Si({WorkBookUnit:n.getWorkBook()},c);return i.invoke(d),this}setValues(...t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:s}=this,o=t[0];if(gi.checkup(t,Array)){const{startRow:t,startColumn:r,endRow:a,endColumn:l}=e,h=new H;for(let e=0;e<=a-t;e++)for(let n=0;n<=l-r;n++)h.setValue(e+t,n+r,o[e][n]);const c={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:h.getData(),rangeData:this._rangeData},d=new Si({WorkBookUnit:n.getWorkBook()},c);i.invoke(d)}else if(gi.checkup(t,H)){const t={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_FORMATTED_VALUE_ACTION,cellValue:o,rangeData:this._rangeData},e=new Si({WorkBookUnit:n.getWorkBook()},t);i.invoke(e)}return this}setRangeData(t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:s}=this,{startRow:o,startColumn:r}=e,a={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:{[o]:{[r]:t}}},l=new Si({WorkBookUnit:n.getWorkBook()},a);return i.invoke(l),this}setRangeDatas(...t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:s}=this,o=t[0];if(gi.checkup(t,Array)){const{startRow:t,startColumn:r,endRow:a,endColumn:l}=e,h=new H;for(let e=0;e<=a-t;e++)for(let n=0;n<=l-r;n++)h.setValue(e+t,n+r,o[e][n]);const c={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:h.getData()},d=new Si({WorkBookUnit:n.getWorkBook()},c);i.invoke(d)}else if(gi.checkup(t,gi.OBJECT_TYPE)){const t={sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:o},e=new Si({WorkBookUnit:n.getWorkBook()},t);i.invoke(e)}return this}clear(...t){const{_context:e,_worksheet:n,_commandManager:i,_rangeData:s}=this;let o={formatOnly:!0,contentsOnly:!0};gi.checkup(t,gi.OBJECT_TYPE)&&(o=t[0]);const r={sheetId:n.getSheetId(),actionName:Bt.CLEAR_RANGE_ACTION,options:o,rangeData:s},a=new Si({WorkBookUnit:e.getWorkBook()},r);return i.invoke(a),this}clearFormat(){return this.clear({formatOnly:!0})}clearContent(){return this.clear({contentsOnly:!0})}deleteCells(t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:s}=this,o={sheetId:s.getSheetId(),actionName:Bt.DELETE_RANGE_ACTION,shiftDimension:t,rangeData:e},r=new Si({WorkBookUnit:n.getWorkBook()},o);i.invoke(r)}insertCells(...t){const e=t[0],n=t[1],{_rangeData:i,_context:s,_commandManager:o,_worksheet:r}=this,{startRow:a,endRow:l,startColumn:h,endColumn:c}=this._rangeData;let d=this._rangeData,u=new H;if(n){u=n.getMatrixObject();const t=n.getRangeData();d={startRow:a,endRow:a+t.endRow-t.startRow,startColumn:h,endColumn:a+t.endColumn-t.startColumn}}else for(let p=a;p<=l;p++)for(let t=h;t<=c;t++)u.setValue(p,t,{m:"",v:""});const g={sheetId:r.getSheetId(),actionName:Bt.INSERT_RANGE_ACTION,shiftDimension:e,rangeData:d,cellValue:u.getData()},_=new Si({WorkBookUnit:s.getWorkBook()},g);return o.invoke(_),this}merge(){const{_worksheet:t}=this;return t.getMerges().add(this._rangeData),this}mergeAcross(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),i=t.getSheetId(),{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=[];for(let d=s;d<=o;d++){const t={startRow:d,endRow:d,startColumn:r,endColumn:a};l.push(t)}const h={actionName:Bt.ADD_MERGE_ACTION,sheetId:i,rectangles:l},c=new Si({WorkBookUnit:n.getWorkBook()},h);return e.invoke(c),this}mergeVertically(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),i=t.getSheetId(),{startRow:s,endRow:o,startColumn:r,endColumn:a}=this._rangeData,l=[];for(let d=r;d<=a;d++){const t={startRow:s,endRow:o,startColumn:d,endColumn:d};l.push(t)}const h={actionName:Bt.ADD_MERGE_ACTION,sheetId:i,rectangles:l},c=new Si({WorkBookUnit:n.getWorkBook()},h);return e.invoke(c),this}breakApart(){const{_worksheet:t}=this,e=t.getCommandManager(),n=t.getContext(),i=t.getSheetId(),s=this._worksheet.getMerges().getMergedRanges(this._rangeData),o={actionName:Bt.REMOVE_MERGE_ACTION,sheetId:i,rectangles:s},r=new Si({WorkBookUnit:n.getWorkBook()},o);return e.invoke(r),this}removeDuplicates(...t){const{_rangeData:e,_context:n,_commandManager:i,_worksheet:s}=this;Array.isArray(t[0])&&t[0];const o=this.getMatrix().getData(),r=[];for(let d=0;d<=e.endColumn-e.startColumn;d++){const t=[],e={},n=this.getColumnMatrix(d).getData();for(const i in n){const s=n[i][d].m;e.hasOwnProperty(s)||(e[s]=1,t.push(d))}r.push(t)}const a=Array.from(new Set(r.flat())),l={};a.forEach(((t,e)=>{l[e]=o[t]}));const h=[{sheetId:s.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:l}],c=new Si({WorkBookUnit:n.getWorkBook()},...h);return i.invoke(c),this}getRowMatrix(t){const{startColumn:e,endColumn:n}=this._rangeData,i=this._worksheet.getCellMatrix(),s=new H;for(let o=t;o<=t;o++)for(let t=e;t<=n;t++)s.setValue(o,t,i.getValue(o,t)||{});return s}getColumnMatrix(t){const{startRow:e,endRow:n}=this._rangeData,i=this._worksheet.getCellMatrix(),s=new H;for(let o=e;o<=n;o++)for(let e=t;e<=t;e++)s.setValue(o,e,i.getValue(o,e)||{});return s}forEach(t){xn.foreach(this._rangeData,t)}randomize(){const{_context:t,_worksheet:e,_commandManager:n,_rangeData:i}=this,{startRow:s,startColumn:o}=i,r=new H;z.randSort(this.getMatrix().toArray()).forEach(((t,e)=>t.forEach(((t,n)=>{t=t,r.setValue(e+s,n+o,t||{})}))));const a={sheetId:e.getSheetId(),actionName:Bt.SET_RANGE_DATA_ACTION,cellValue:r.getData()},l=new Si({WorkBookUnit:t.getWorkBook()},a);n.invoke(l)}isValid(){return!Object.values(this._rangeData).includes(-1)}_handleCopyRange(...t){const e=t[0];let n=t[1];n=gi.checkup(t,xn,xn)?n.getRangeData():n;const i=e._worksheet.getCellMatrix(),{startRow:s,endRow:o,startColumn:r,endColumn:a}=e.getRangeData();let{startRow:l,endRow:h,startColumn:c,endColumn:d}=n;const u=o-s+1,g=a-r+1,_=h-l+1,p=d-c+1;let m,f=[];if(_%u==0&&p%g==0){for(let t=0;t<_;t++){const e=[];for(let n=0;n<p;n++){const o=i.getValue((t+s)%u,(n+r)%g)||{};e.push(o)}f.push(e)}m=n}else f=i.getFragments(s,o,r,a).getData(),h+=u-_,d+=g-p,m={startRow:l,endRow:h,startColumn:c,endColumn:d};return[f,m]}_getStyles(t){return this.getValues().map((e=>e.map((e=>{const n=this._context.getWorkBook().getStyles(),i=n&&n.getStyleByCell(e);return i&&i[t]||Qe[t]}))))}_setStyle(t,e){const{_context:n,_worksheet:i,_commandManager:s}=this,{startRow:o,endRow:r,startColumn:a,endColumn:l}=this._rangeData,h={[e]:t},c=z.fillObjectMatrix(r-o+1,l-a+1,h),d={sheetId:i.getSheetId(),actionName:qs.NAME,value:c,rangeData:this._rangeData},u=new Si({WorkBookUnit:n.getWorkBook()},d);return s.invoke(u),this}_setStyles(t,e){const{_context:n,_worksheet:i,_commandManager:s}=this,{startRow:o,endRow:r,startColumn:a,endColumn:l}=this._rangeData,h=new H;for(let u=0;u<r-o+1;u++)for(let n=0;n<l-a+1;n++)h.setValue(u,n,{[e]:t[u][n]});const c={sheetId:i.getSheetId(),actionName:Bt.SET_RANGE_STYLE_ACTION,value:h.getData(),rangeData:this._rangeData},d=new Si({WorkBookUnit:n.getWorkBook()},c);return s.invoke(d),this}}class Ln{constructor(t={}){this._styles=t}each(t){return Object.entries(this._styles).forEach(t),this}search(t){const{_styles:e}=this;for(const n in e)if(z.diffValue(e[n],t))return n;return"-1"}get(t){return"string"!=typeof(t=String(t))?t:this._styles[t]}add(t){const e=z.generateRandomId(6);return this._styles[e]=t,e}setValue(t){if(null==t)return;const e=this.search(t);return"-1"!==e?e:this.add(t)}toJSON(){return this._styles}getStyleByCell(t){let e;return e=t&&z.isObject(t.s)?t.s:(null==t?void 0:t.s)&&this.get(t.s),e}}function kn(t){if(!t)return;let{row:e,column:n,startY:i,endY:s,startX:o,endX:r,isMerged:a,mergeInfo:l}=t,h=e,c=n,d=e,u=n;if(a&&l){const{startRow:t,startColumn:e,endRow:n,endColumn:a,startY:g,endY:_,startX:p,endX:m}=l;h=t,c=e,d=n,u=a,i=g,s=_,o=p,r=m}return{startRow:h,startColumn:c,endRow:d,endColumn:u,startY:i,endY:s,startX:o,endX:r}}function Pn(t){if(!t)return!0;return 0===((null==t?void 0:t.m)||"").length&&!t.p}function Hn(t){if(t){if(t.rgb)return t.rgb;if(t.th)return(new gn).setThemeColor(t.th).asThemeColor().asRgbColor().getCssString()}return null}function Bn(t){return t instanceof FormData}const Fn=()=>{},Un=t=>t;var zn,Wn,Vn,Yn,Gn,Xn;(Wn=zn||(zn={})).POST="POST",Wn.GET="GET",Wn.PUT="PUT",Wn.DELETE="DELETE",(Yn=Vn||(Vn={}))[Yn.UNSENT=0]="UNSENT",Yn[Yn.OPENED=1]="OPENED",Yn[Yn.HEADERS_RECEIVED=2]="HEADERS_RECEIVED",Yn[Yn.LOADING=3]="LOADING",Yn[Yn.DONE=4]="DONE",(Xn=Gn||(Gn={})).ARRAY_BUFFER="arraybuffer",Xn.BLOB="blob",Xn.TEXT="text",Xn.DOCUMENT="document",Xn.JSON="json",Xn.STREAM="stream";const jn={type:zn.POST,url:"",async:!0,header:{},dataType:Gn.JSON,contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{},username:"",password:"",timeout:500,error:Fn,beforeSend:Un,dataFilter:Un,success:Fn,complete:Fn};function Kn(t){return new Promise(((e,n)=>{const i=function(t,...e){for(const n of e)if(n)for(const e in n)n.hasOwnProperty(e)&&null!=n[e]&&(t[e]=n[e]);return t}({},jn,t),s=new XMLHttpRequest;switch(i.beforeSend(i),s.responseType=i.dataType,s.timeout=i.timeout,s.addEventListener("readystatechange",(t=>{if(4===s.readyState)if(200===s.status){const t=i.dataFilter(s.response);i.success(t),i.complete(),e(t)}else i.error(t),n(t)})),s.addEventListener("timeout",(t=>{i.error(t)})),s.open(i.type,i.url,i.async,i.username,i.password),Object.keys(i.header).forEach((t=>{const e=i.header[t];s.setRequestHeader(t,e)})),Bn(i.data)?s.setRequestHeader("Content-Type","multipart/form-data"):i.contentType&&s.setRequestHeader("Content-Type",i.contentType),i.type){case zn.DELETE:case zn.GET:s.send();break;case zn.POST:case zn.PUT:if((o=i.data)&&Object.getPrototypeOf(o)===Object.getPrototypeOf({}))return void s.send(JSON.stringify(i.data));if(function(t){return"[object String]"===Object.prototype.toString.apply(t)}(i.data))return void s.send(i.data);if(function(t){return"[object Array]"===Object.prototype.toString.apply(t)}(i.data))return void s.send(JSON.stringify(i.data));Bn(i.data)&&s.send(i.data)}var o}))}var $n,Zn;(Zn=$n||($n={})).MESSAGE="message",Zn.OPEN="open",Zn.CLOSE="close",Zn.ERROR="error",Zn.RETRY="retry",Zn.DESTROY="destroy";const qn={url:"",heartbeatTime:3e4};class Qn{constructor(t){const e=Object.assign(qn,t);if(function(t){return null==t}(n=e.url)||""===n.toString())throw new Error("url must be input");var n;this._listens=new Map,this._timer=-1,this._config=e}link(){this._create(),this._bind()}send(t){this._socket.send(t)}destroy(){const t=this._listens.get($n.DESTROY);t&&t(),this._clear(),this._listens.clear()}on(t,e){this._listens.set(t,e)}close(){this._socket&&this._socket.close()}_create(){const{_config:t}=this;this._socket=new WebSocket(t.url)}_bind(){this._socket.addEventListener($n.MESSAGE,this._message.bind(this)),this._socket.addEventListener($n.OPEN,this._open.bind(this)),this._socket.addEventListener($n.CLOSE,this._close.bind(this)),this._socket.addEventListener($n.ERROR,this._error.bind(this))}_message(t){const e=this._listens.get($n.MESSAGE);e&&e(t)}_open(t){const e=this._listens.get($n.OPEN);e&&(e(t),this._heartbeat())}_error(t){const e=this._listens.get($n.ERROR);e&&(e(t),this._retry())}_close(t){const e=this._listens.get($n.CLOSE);e&&(e(t),this.destroy())}_clear(){this._timer>-1&&clearInterval(this._timer),this._timer=-1,this._socket.removeEventListener($n.MESSAGE,this._message.bind(this)),this._socket.removeEventListener($n.OPEN,this._open.bind(this)),this._socket.removeEventListener($n.CLOSE,this._close.bind(this)),this._socket.removeEventListener($n.ERROR,this._error.bind(this))}_heartbeat(){const{_socket:t,_config:e}=this,{heartbeatTime:n}=e;this._timer=setInterval((function(){t.send("heart_beat_message")}),n)}_retry(){const t=this._listens.get($n.RETRY);t&&t(),this._clear(),this._create(),this._bind()}}Object.keys(nn).reduce(((t,e)=>[...t,...nn[e]]),[]);const Jn={},ti={};class ei{static getValue(t,e){try{return t[e]?t[e]:e.split(".").reduce(((t,e)=>t[e]),t)}catch(n){console.error("Key %s not found",e)}}initialize(t){this.options={currentLocale:t||["zh","zh-CN"].includes(z.getLanguage())?me.ZH:me.EN,locales:{zh:Jn,en:ti}}}get(t){if(t){const{locales:e,currentLocale:n}=this.options;return ei.getValue(e[n],t)||t}return String()}getObject(t){const{locales:e,currentLocale:n}=this.options;return ei.getValue(e[n],t)}load(t){z.deepMerge(this.options.locales,t)}change(t){this.options.currentLocale=t}getCurrentLocale(){return this.options.currentLocale}}class ni{static log(...t){console&&console.log(...t)}static info(...t){console&&console.info(...t)}static error(...t){console&&console.error(...t)}static warn(...t){console&&console.warn(...t)}static br(){ni.info("\n")}static capsule(t,e,n="",i=""){console&&console.log(`%c${n}%c${t}%c${e}%c${i}`,"","padding:3px;color:white;background:#023047","padding:3px;color:white;background:#219EBC","")}}class ii{constructor(...t){if(z.hasLength(t,0))return this.startRow=0,this.startColumn=0,this.endRow=0,void(this.endColumn=0);if(z.hasLength(t,1)){const e=t[0];return this.startRow=e.startRow,this.startColumn=e.startColumn,this.endRow=e.endRow,void(this.endColumn=e.endColumn)}if(z.hasLength(t,4)){const e=t[0],n=t[1],i=t[2],s=t[3];this.startRow=e,this.startColumn=n,this.endRow=i,this.endColumn=s}}static equals(t,e){return t.endRow===e.endRow&&t.endColumn===e.endColumn&&t.startRow===e.startRow&&t.startColumn===e.startColumn}static intersects(t,e){const n=t.startRow,i=t.endRow,s=t.startColumn,o=t.endColumn,r=e.startRow,a=e.endRow,l=e.startColumn,h=e.endColumn,c=Math.abs(s+o-l-h),d=Math.abs(s-o)+Math.abs(l-h),u=Math.abs(n+i-r-a),g=Math.abs(n-i)+Math.abs(r-a);return c<=d&&u<=g}intersects(t){return ii.intersects(this,t)}union(t){const{startRow:e,startColumn:n,endRow:i,endColumn:s}=this;return new ii(t.startRow<this.startRow?t.startRow:e,t.startColumn<n?t.startColumn:n,t.endRow>i?t.endRow:i,t.endColumn>s?t.endColumn:s)}getData(){return{startRow:this.startRow,startColumn:this.startColumn,endRow:this.endRow,endColumn:this.endColumn}}equals(t){return ii.equals(this,t)}}const si="A".charCodeAt(0),oi="Z".charCodeAt(0),ri="a".charCodeAt(0);function ai(t){const e=oi-si+1;let n="";for(;t>=0;)n=String.fromCharCode(t%e+si)+n,t=Math.floor(t/e)-1;return n}function li(t,e=!1){const n=oi-si+1;let i=ri;e&&(i=si);return function(t,e){let n="";for(;e>0;)n+=t,e--;return n}(String.fromCharCode(t%n+i),Math.floor(t/n)+1)}class hi{static fromSequence(t){if(z.isObject(t)&&hi.requiredNewInstance(this)){return this.newInstance(t)}if(z.isArray(t)&&hi.requiredNewInstance(this)){const e=this;return t.map((t=>e.newInstance(t)))}return[]}toSequence(){return{className:z.getClassName(this)}}}function ci(t,e){return t.zIndex>e.zIndex?1:t.zIndex===e.zIndex?0:-1}function di(t,e){return t.zIndex>e.zIndex?-1:t.zIndex===e.zIndex?0:1}(hi||(hi={})).requiredNewInstance=function(t){if(z.isDefine(t.newInstance))return!0;throw new Error("sequence newInstance need subclass implement!")};const ui=class{static checkup(t,...e){if(t.length!==e.length)return!1;const n=t.length;for(let i=0;i<n;i++){const n=t[i],s=e[i];switch(s){case ui.BOOLEAN_TYPE:if(!z.isBoolean(n))return!1;break;case ui.NUMBER_TYPE:if(!z.isNumber(n))return!1;break;case ui.STRING_TYPE:if(!z.isString(n))return!1;break;case ui.FUNCTION_TYPE:if(!z.isFunction(n))return!1;break;case ui.OBJECT_TYPE:if(!z.isPlainObject(n))return!1;break;default:if(!z.isAssignableFrom(n,s))return!1}}return!0}};let gi=ui;function _i(t,e){return Object.prototype.toString.call(t)===Object.prototype.toString.call(e)&&("[object Object]"===Object.prototype.toString.call(t)||"[object Array]"===Object.prototype.toString.call(t)?Object.keys(t).length===Object.keys(e).length&&Object.keys(t).every((n=>_i(t[n],e[n]))):t===e)}gi.STRING_TYPE=1,gi.NUMBER_TYPE=2,gi.BOOLEAN_TYPE=3,gi.FUNCTION_TYPE=4,gi.OBJECT_TYPE=5;class pi{constructor(t,e,n){this.path=t,this.namespace=e,this.observable=n}}class mi{constructor(){this._observableArray=[]}hasObserver(t,e){return null!=this.getObserver(t,e)}getObserver(...t){if(1===t.length){const e=t[0],n=this._observableArray.find((t=>t.path===e));return n?n.observable:null}if(2===t.length){const e=t[0],n=t[1],i=this._observableArray.find((t=>t.path===e&&t.namespace===n));return i?i.observable:null}}requiredObserver(...t){if(z.hasLength(t,1)){const e=t[0],n=this.getObserver(e);if(null==n)throw new Error(`not found observable ${e}`);return n}if(z.hasLength(t,2)){const e=t[0],n=t[1],i=this.getObserver(e,n);if(null==i)throw new Error(`not found observable ${e}`);return i}throw new Error("requiredObserver arguments error")}removeObserver(...t){if(z.hasLength(t,1)){const e=t[0],n=this._observableArray.findIndex((t=>t.path===e));n>-1&&this._observableArray.splice(n,1)}else if(z.hasLength(t,2)){const e=t[0],n=t[1],i=this._observableArray.findIndex((t=>t.path===e&&t.namespace===n));i>-1&&this._observableArray.splice(i,1)}}addObserver(...t){if(1===t.length){const e=t[0],n=t[1];return this.hasObserver(e,e)&&this.removeObserver(e),void this._observableArray.push(new pi(e,e,n))}if(3===t.length){const e=t[0],n=t[1],i=t[2];this.hasObserver(e,e)&&this.removeObserver(e,n),this._observableArray.push(new pi(e,n,i))}}}var fi,Ti;(Ti=fi||(fi={}))[Ti.REDO=0]="REDO",Ti[Ti.UNDO=1]="UNDO";class vi extends y{}class Ei extends y{}class bi extends y{}class Ii{constructor(t){this._undoManager=t.getUndoManager(),this._actionExtensionManager=new wi}static staticInitialize(){this._actionClass=new Map,this._actionObservers=new vi,this._commandObservers=new bi,this._commandInjectorObservers=new Ei}static getAction(t){return this._actionClass[t]}static getActionObservers(){return this._actionObservers}static getCommandObservers(){return this._commandObservers}static register(t,e){this._actionClass[t]=e}static getCommandInjectorObservers(){return this._commandInjectorObservers}getActionExtensionManager(){return this._actionExtensionManager}undo(){const{_undoManager:t}=this,e=t.undo();e&&e.undo()}redo(){const{_undoManager:t}=this,e=t.redo();e&&e.redo()}invoke(t){const{_undoManager:e}=this,{_actionDataList:n,_unit:i,_actionList:s}=t;this._actionExtensionManager.handle(n),n.forEach((t=>{const e=Ii.getAction(t.actionName),n=Ii.getActionObservers(),o=new e(t,i,n);s.push(o)})),t.invoke(),e.push(t)}}Ii.staticInitialize();class Ci extends w{constructor(t,e,n){if(super(t,n),null==e.WorkBookUnit)throw new Error("action workbook domain can not be null!");this._commandUnit=e,this._workbook=e.WorkBookUnit}getWorkSheet(){const{_workbook:t,_doActionData:e}=this,{sheetId:n}=e;return t.getSheetBySheetId(n)}getWorkBook(){return this._workbook}}class Si{constructor(t,...e){this._unit=t,this._actionDataList=e,this._actionList=[]}getDoData(){return this._actionList.map((t=>t.getDoActionData()))}getOldData(){return this._actionList.map((t=>t.getOldActionData()))}getInjector(){const t=this;return new class{injectAction(e){t._actionList.push(e)}getActions(){return t._actionList.concat([])}include(e){for(let n=0;n<t._actionList.length;n++)if(t._actionList[n]instanceof e)return t._actionList[n];return null}}}redo(){this._actionList.forEach((t=>{Oi.hasUndo(t.getDoActionData())&&t.redo()})),Ii.getCommandObservers().notifyObservers({type:fi.REDO,actions:this._actionList})}undo(){this._actionList.reverse().forEach((t=>{Oi.hasUndo(t.getOldActionData())&&t.undo()})),Ii.getCommandObservers().notifyObservers({type:fi.UNDO,actions:this._actionList})}invoke(){Ii.getCommandInjectorObservers().notifyObservers(this.getInjector()),Ii.getCommandObservers().notifyObservers({type:fi.REDO,actions:this._actionList})}}class Ai{constructor(){this._undoStack=[],this._redoStack=[]}push(t){this._redoStack.push(t)}undo(){const t=this._redoStack.pop();if(t)return this._undoStack.push(t),t}redo(){const t=this._undoStack.pop();if(t)return this._redoStack.push(t),t}}class wi{constructor(){this._register=new yi,this._register.initialize()}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.actionExtensionFactoryList;n&&(this._actionExtensionFactoryList=n,0!==t.length&&this._checkExtension(t))}_checkExtension(t){if(!this._actionExtensionFactoryList)return!1;this._actionExtensionFactoryList.forEach((e=>{const n=e.check(t);!1!==n&&n.execute()}))}}class Ri{constructor(){this._data=[]}static create(){return new Ri}add(t){this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}const Ni=Ri.create();class yi{constructor(){this._actionExtensionFactoryList=[]}get actionExtensionFactoryList(){return this._actionExtensionFactoryList}initialize(){this._initExtensions()}add(...t){this._actionExtensionFactoryList.push(...t),this._actionExtensionFactoryList.sort(ci)}delete(t){const e=this._actionExtensionFactoryList.indexOf(t);this._actionExtensionFactoryList.splice(e,1)}_initExtensions(){this._actionExtensionFactoryList.push(...Ni.getData().sort(ci))}}class Oi{constructor(t){this._action=t}static hasObserver(e){return!e.operation||(e.operation&t.OBSERVER_ACTION)===t.OBSERVER_ACTION}static hasUndo(e){return!e.operation||(e.operation&t.UNDO_ACTION)===t.UNDO_ACTION}static hasCollaboration(e){return!e.operation||(e.operation&t.SERVER_ACTION)===t.SERVER_ACTION}static hasExtension(e){return!e.operation||(e.operation&t.EXTENSION_ACTION)===t.EXTENSION_ACTION}static make(e){return e.operation=t.DEFAULT_ACTION,new Oi(e)}removeObserver(){return this._action.operation&&(this._action.operation&=~t.OBSERVER_ACTION),this}removeUndo(){return this._action.operation&&(this._action.operation&=~t.UNDO_ACTION),this}removeCollaboration(){return this._action.operation&&(this._action.operation&=~t.SERVER_ACTION),this}removeExtension(){return this._action.operation&&(this._action.operation&=~t.EXTENSION_ACTION),this}getAction(){return this._action}}function Di(t,e){var n;let i=null==(n=null==t?void 0:t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId);if(i){let t=i.getConfig().mergeData,n=e.rectangles;for(let e=0;e<n.length;e++)t.push(n[e]);return n}return[]}function Mi(t,e){var n;const i=null==(n=t.WorkBookUnit)?void 0:n.getConfig().namedRanges;null==i||i.push(e.namedRange)}function xi(t,e){const n=t.WorkBookUnit,i=null==n?void 0:n.getConfig().namedRanges;return null==i?void 0:i.find(((t,n)=>t.namedRangeId===e.namedRangeId?(i.splice(n,1),t):null))}function Li(t,e){var n,i,s;const o=null==(n=t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId),r=null==o?void 0:o.getCellMatrix(),a={rowCount:null==o?void 0:o.getConfig().rowCount,columnCount:null==o?void 0:o.getConfig().columnCount},{startRow:l,endRow:h,startColumn:c,endColumn:d}=e.rangeData,u=h-l+1,g=d-c+1,_=null!=(i=a.rowCount)?i:0,p=null!=(s=a.columnCount)?s:0,m=new H;if(e.shiftDimension===se.ROWS)for(let f=l;f<=_;f++)for(let t=c;t<=d;t++){if(f<=h){const e=null==r?void 0:r.getValue(f,t);m.setValue(f,t,e)}const e=null==r?void 0:r.getValue(f+u,t);if(e)null==r||r.setValue(f,t,z.deepClone(e));else{(null==r?void 0:r.getValue(f,t))&&(null==r||r.deleteValue(f,t),t--)}}else if(e.shiftDimension===se.COLUMNS)for(let f=l;f<=h;f++)for(let t=c;t<=p;t++){if(t<=d){const e=null==r?void 0:r.getValue(f,t);m.setValue(f,t,e)}else for(let n=0;n<=d;n++){const e=null==r?void 0:r.getValue(f,t);m.setValue(f,t+n,e)}const e=null==r?void 0:r.getValue(f,t+g);if(e)null==r||r.setValue(f,t,z.deepClone(e));else{if(null==r?void 0:r.getValue(f,t)){for(let e=0;e<=d;e++)null==r||r.deleteValue(f,t);break}}}return m.getData()}function ki(t,e){const n=t.getConfig(),i=n.hidden;return n.hidden=e,i}function Pi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager().getColumnData().toJSON();new k(n).inserts(e.columnIndex,new k(e.columnCount))}function Hi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();new H(n).insertColumns(e.columnIndex,new H(e.columnData))}function Bi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();new H(n).insertRows(e.rowIndex,new H(e.rowData))}function Fi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=n.getLastRow(),s=n.getLastColumn(),o=n.getCellMatrix(),{startRow:r,endRow:a,startColumn:l,endColumn:h}=e.rangeData,c=a-r+1,d=h-l+1,u=i,g=s;if(e.shiftDimension===se.ROWS){for(let t=u;t>=r;t--)for(let e=l;e<=h;e++){const n=o.getValue(t,e);o.setValue(t+c,e,n)}for(let t=a;t>=r;t--)for(let n=l;n<=h;n++)o.setValue(t,n,e.cellValue[t-r][n-l])}else if(e.shiftDimension===se.COLUMNS){for(let t=r;t<=a;t++)for(let e=g;e>=l;e--){const n=o.getValue(t,e);o.setValue(t,e+d,n)}for(let t=r;t<=a;t++)for(let n=h;n>=l;n--)o.setValue(t,n,e.cellValue[t-r][n-l])}}function Ui(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getRowManager().getRowData().toJSON();new k(n).inserts(e.rowIndex,new k(e.rowCount))}function zi(t,e){t.WorkBookUnit.getSheetBySheetId(e.sheetId);const n=e.index,i=e.sheet,s=t.WorkBookUnit.getWorksheets(),o=t.WorkBookUnit.getConfig(),{sheets:r,sheetOrder:a}=o;if(r[i.id])throw new Error(`Insert Sheet fail ${i.id} is already exist`);return r[i.id]=i,a.splice(n,0,i.id),s.set(i.id,new Mn(t.WorkBookUnit.getContext(),i)),i.id}function Wi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager().getColumnData().toJSON(),i=new k(n),s=new k,o=e.columnIndex,r=e.columnIndex+e.columnCount;for(let a=o;a<r;a++){const t=i.splice(e.columnIndex,1);t.getLength()&&s.set(a,t.first())}return s.getLength()}function Vi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();return new H(n).spliceColumns(e.columnIndex,e.columnCount).toJSON()}function Yi(t,e){let n=t.WorkBookUnit.getSheetBySheetId(e.sheetId);if(n){let t=[],i=n.getConfig().mergeData,s=e.rectangles;for(let e=0;e<s.length;e++)for(let n=i.length-1;n>=0;n--){let o=i[n],r=s[e];ii.intersects(o,r)&&t.push(i.splice(n,1)[0])}return t}return[]}function Gi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getRowManager().getRowData().toJSON(),i=new k(n),s=new k,o=e.rowIndex,r=e.rowIndex+e.rowCount;for(let a=o;a<r;a++){const t=i.splice(e.rowIndex,1);t.getLength()&&s.set(a,t.first())}return s.getLength()}function Xi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getCellMatrix().toJSON();return new H(n).spliceRows(e.rowIndex,e.rowCount).toJSON()}function ji(t,e){let n=t.WorkBookUnit,i=e.sheetId;const s=n.getWorksheets(),o=n.getConfig(),{sheets:r}=o;if(null==r[i])throw new Error(`Remove Sheet fail ${i} is not exist`);const a=r[i],l=o.sheetOrder.findIndex((t=>t===i));return delete r[i],o.sheetOrder.splice(l,1),s.delete(i),{index:l,sheet:a}}function Ki(t,e){const n=t.WorkBookUnit,i=n.getSheetBySheetId(e.sheetId),s=n.getStyles(),o=i.getCellMatrix(),r=new H(e.styles),a=new H;return r.forValue(((t,e,n)=>{const i=o.getValue(t,e);if(i){const o=s.get(i.s);o&&a.setValue(t,e,o),i.s=s.setValue(n)}})),a.toJSON()}function $i(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=e.columnIndex,s=e.columnCount,o=n.getColumnManager();for(let r=i;r<i+s;r++){o.getColumnOrCreate(r).hd=1}}function Zi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId).getColumnManager();for(let i=0;i<0;i++){const t=n.getColumn(i);t&&(t.hd=0)}}function qi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=e.columnIndex,s=e.columnWidth,o=n.getColumnManager(),r=[];for(let a=i;a<i+s.length;a++){const t=o.getColumnOrCreate(a);r[a-i]=t.w,t.w=s[a-i]}return r}function Qi(t,e){const n=t.WorkBookUnit.getSheetBySheetId(e.sheetId),i=e.hideGridlines,s=n.getConfig(),o=0===s.showGridlines;return s.showGridlines=i?0:1,o}function Ji(t=0,e,n){for(let i=t;i<t+e;i++){const t=n.getRowOrCreate(i);t&&(t.hd=1)}}function ts(t,e){const n=t.WorkBookUnit;n.getSheetBySheetId(e.sheetId);const i=e.namedRange,s=n.getConfig().namedRanges;return s.find(((t,e)=>t.namedRangeId===i.namedRangeId?(s[e]=i,t):null))}function es(t,e,n,i){const{startRow:s,endRow:o,startColumn:r,endColumn:a}=n,l=new H;for(let h=s;h<=o;h++)for(let n=r;n<=a;n++){const o=t.getValue(h,n)||{},a=i.getStyleByCell(o);null==a&&delete o.s;const c=ss(a,e[h-s][n-r]);c&&z.removeNull(c),z.isEmptyObject(c)?delete o.s:o.s=i.setValue(c),o.p&&os(o.p,e[h-s][n-r]),t.setValue(h,n,o),l.setValue(h-s,n-r,ns(a,e[h-s][n-r]))}return l.getData()}function ns(t,e){return function(t,e){if(!e||!Object.keys(e).length)return t;const n=z.deepClone(t)||{};for(const i in e)"bd"===i?n[i]=is(n[i]||{},e[i]):i in n||(n[i]=null);return n}(t,e)}function is(t,e){if(!e||!Object.keys(e).length)return t;for(const n in e)n in t||(t[n]=null);return t}function ss(t,e,n=!1){if(null===e)return e;if(void 0===e)return t;const i=z.deepClone(t)||{};for(const s in e)n&&["bd","tr","td","ht","vt","tb","pd"].includes(s)||(s in i&&"bd"===s?i[s]=Object.assign(i[s],e[s]):(i[s]=e[s],"cl"in i&&["ul","ol","st"].includes(s)&&(i[s].cl=i.cl)));return i}function os(t,e){var n;null==(n=t.body)||n.blockElements.forEach((t=>{if(0===t.blockType){const n=t.paragraph;null==n||n.elements.forEach((t=>{t.tr||(t.tr={});const n=t.tr;n.ts||(n.ts={});const i=ss(n.ts,e,!0);i&&z.removeNull(i),z.isEmptyObject(i)?delete n.ts:n.ts=i}))}}))}function rs(t,e){const n=t.WorkBookUnit,i=n.getSheetBySheetId(e.sheetId).getCellMatrix(),s=e.options,o=e.cellValue,r=n.getStyles(),a=new H(o),l=new H;return s?(a.forValue(((t,e,n)=>{const o=i.getValue(t,e),r={};s.contentsOnly&&(r.m=null==o?void 0:o.m,r.v=null==o?void 0:o.v),s.formatOnly&&(r.v=null==o?void 0:o.v,r.m=null==o?void 0:o.m),l.setValue(t,e,r||{}),i.setValue(t,e,n||{})})),l.getData()):(a.forValue(((t,e,n)=>{const s=i.getValue(t,e)||{};if(n){const o=r.getStyleByCell(s),a=ns(o,null==n?void 0:n.s),h=z.deepClone(s);h.s=a,l.setValue(t,e,h),null==o&&delete s.s;const c=ss(o,null==n?void 0:n.s);c&&z.removeNull(c),z.isEmptyObject(c)?delete s.s:s.s=r.setValue(c),null!=n.v&&(s.v=n.v),null!=n.m?s.m=n.m:s.m=String(s.v),null!=n.t&&(s.t=n.t),i.setValue(t,e,s)}else i.setValue(t,e,n),l.setValue(t,e,s)})),l.getData())}function as(t,e,n){const i=new H(e),s=new H;for(let o=n.startRow;o<=n.endRow;o++)for(let e=n.startColumn;e<=n.endColumn;e++){const n=i.getValue(o,e),s=t.getValue(o,e),r=z.deepClone(s||{});r.n=n,t.setValue(o,e,r||{})}return s.getData()}function ls(t,e,n){const i=new H(e),s=new H;for(let o=n.startRow;o<=n.endRow;o++)for(let e=n.startColumn;e<=n.endColumn;e++){const n=i.getValue(o,e),r=t.getValue(o,e);s.setValue(o,e,r&&r.v||"");const a=z.deepClone(r||{});a.v=n,a.m=`${n}`,t.setValue(o,e,a||{})}return s.getData()}function hs(t,e){const n=t.getConfig(),i=n.rightToLeft;return n.rightToLeft=e,i}function cs(t=0,e,n){const i=[];for(let s=t;s<t+e.length;s++){const o=n.getRowOrCreate(s);i[s-t]=o.h,o.h=e[s-t]}return i}function ds(t,e,n,i){var s,o,r;const a=t.getSelection(),l=null==(s=a.getActiveRangeList())?void 0:s.getRangeList(),h=null==(o=a.getActiveRange())?void 0:o.getRangeData(),c=null==(r=a.getCurrentCell())?void 0:r.getRangeData();return a.setRanges(e,n,i),{activeRangeList:l,activeRange:h,currentCell:c}}function us(t,e,n){const i=t.getConfig(),s=i.sheetOrder.findIndex((t=>t===e)),o=i.sheetOrder.filter((t=>t!==e));return o.splice(n,0,e),i.sheetOrder=o,s}function gs(t=0,e,n){for(let i=t;i<t+e;i++){const t=n.getRow(i);t&&(t.hd=0)}}function _s(t,e){const n=t.getConfig(),i=n.tabColor;return n.tabColor=e,i}function ps(t,e){const n=t.getContext().getWorkBook().getActiveSheet();let i="";const s=Ue.FALSE;n&&(i=n.getSheetId());const o=t.getContext().getWorkBook().getSheets(),r=t.getSheetId();return o.forEach((t=>{const e=t.getSheetId();t.getConfig().status=e===r?Ue.TRUE:Ue.FALSE})),{oldSheetId:i,status:s}}function ms(t,e){const n=t.getConfig(),i=n.name;return n.name=e,i}function fs(t,e){const n=t.getConfig(),i=n.status;return n.status=e,i}function Ts(t,e,n){const i=t.getSheetBySheetId(e);if(i){const t=i.getConfig().zoomRatio;return i.getConfig().zoomRatio=n,t}return 1}class vs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rectangles:this.do()}),this.validate()}do(){return Di(this._commandUnit,this._doActionData)}redo(){this.do()}undo(){Yi(this._commandUnit,this._oldActionData)}validate(){return!1}}vs.NAME="AddMergeAction",Ii.register(vs.NAME,vs);class Es extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData={actionName:Is.NAME,sheetId:t.sheetId,namedRange:this.do()},this.validate()}do(){const t=xi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:Is.NAME,namedRange:this.do()}}undo(){Mi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Es.NAME="DeleteNamedRangeAction",Ii.register(Es.NAME,Es);const bs=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData={actionName:Es.NAME,sheetId:t.sheetId,namedRangeId:t.namedRange.namedRangeId},this.validate()}do(){Mi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const{sheetId:t}=this._oldActionData;this._doActionData={actionName:bs.NAME,sheetId:t,namedRange:xi(this._commandUnit,this._oldActionData)},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let Is=bs;var Cs,Ss;Is.NAME="AddNamedRangeAction",Ii.register(Is.NAME,Is),(Ss=Cs||(Cs={})).DEFAULT="default",Ss.PASTE="paste";const As=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=rs(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,options:e}=this._doActionData;this._oldActionData={actionName:As.NAME,sheetId:t,cellValue:this.do(),options:e}}undo(){const{sheetId:t,cellValue:e,options:n}=this._oldActionData,i=this.getWorkSheet();this._workbook.getStyles(),i&&(this._doActionData={actionName:As.NAME,sheetId:t,cellValue:rs(this._commandUnit,this._oldActionData),options:n},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let ws=As;ws.NAME="SetRangeDataAction",Ii.register(ws.NAME,ws);class Rs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=function(t,e){var n;const i=null==(n=t.WorkBookUnit)?void 0:n.getSheetBySheetId(e.sheetId),s=null==i?void 0:i.getCellMatrix(),{startRow:o,endRow:r,startColumn:a,endColumn:l}=e.rangeData,h=new H;for(let c=o;c<=r;c++)for(let t=a;t<=l;t++){const n=null==s?void 0:s.getValue(c,t);h.setValue(c,t,z.deepClone(n)),n&&(e.options.formatOnly&&delete n.s,e.options.contentsOnly&&(n.v="",n.m=""),null==s||s.setValue(c,t,z.deepClone(n)))}return h.getData()}(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={actionName:ws.NAME,sheetId:t,cellValue:this.do()}}undo(){this.getWorkSheet()&&(rs(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Rs.NAME="ClearRangeAction",Ii.register(Rs.NAME,Rs);class Ns extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){this.getWorkSheet()&&(Fi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}))}redo(){this.do()}undo(){const{rangeData:t,sheetId:e,shiftDimension:n}=this._oldActionData;this.getWorkSheet()&&(this._doActionData={actionName:ws.NAME,sheetId:e,cellValue:Li(this._commandUnit,this._oldActionData),rangeData:t,shiftDimension:n},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Ns.NAME="InsertRangeAction",Ii.register(Ns.NAME,Ns);class ys extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=Li(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e,shiftDimension:n}=this._doActionData;this._oldActionData={sheetId:t,actionName:Ns.NAME,shiftDimension:n,rangeData:e,cellValue:this.do()}}undo(){this.getWorkSheet()&&(Fi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}ys.NAME="DeleteRangeAction",Ii.register(ys.NAME,ys);class Os extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Pi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Wi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Os.NAME="InsertColumnAction",Ii.register(Os.NAME,Os);class Ds extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=c(h({},t),{columnCount:k.getMaxLength(t.columnData[0])}),this.validate()}do(){Hi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Vi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ds.NAME="InsertColumnDataAction",Ii.register(Ds.NAME,Ds);class Ms extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Ui(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Gi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ms.NAME="InsertRowAction",Ii.register(Ms.NAME,Ms);class xs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=c(h({},t),{rowCount:k.getMaxLength(t.rowData[0])}),this.validate()}do(){Bi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Xi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}xs.NAME="InsertRowDataAction",Ii.register(xs.NAME,xs);class Ls extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{sheetId:this.do()})}do(){const t=zi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.redo()}undo(){ji(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}Ls.NAME="InsertSheetAction",Ii.register(Ls.NAME,Ls);class ks extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{columnCount:this.do()}),this.validate()}do(){const t=Wi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Pi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}ks.NAME="RemoveColumnAction",Ii.register(ks.NAME,ks);class Ps extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{columnData:this.do()}),this.validate()}do(){const t=Vi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Hi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ps.NAME="RemoveColumnDataAction",Ii.register(Ps.NAME,Ps);class Hs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rectangles:this.do()}),this.validate()}do(){const t=Yi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Di(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Hs.NAME="RemoveMergeAction",Ii.register(Hs.NAME,Hs);class Bs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rowCount:this.do()}),this.validate()}do(){const t=Gi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Ui(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Bs.NAME="RemoveRowAction",Ii.register(Bs.NAME,Bs);class Fs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rowData:this.do()}),this.validate()}do(){const t=Xi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Bi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Fs.NAME="RemoveRowDataAction",Ii.register(Fs.NAME,Fs);class Us extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=h(h({},t),this.do())}do(){return this.redo()}redo(){const t=ji(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}undo(){this.getWorkBook(),zi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){throw new Error("Method not implemented.")}}Us.NAME="RemoveSheetAction",Ii.register(Us.NAME,Us);class zs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{styles:this.do()}),this.validate()}do(){const t=Ki(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Ki(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}zs.NAME="SetBorderAction",Ii.register(zs.NAME,zs);class Ws extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){$i(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){Zi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Ws.NAME="SetColumnHideAction",Ii.register(Ws.NAME,Ws);class Vs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){Zi(this._commandUnit,this._doActionData),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){$i(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Vs.NAME="SetColumnShowAction",Ii.register(Vs.NAME,Vs);class Ys extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{columnWidth:this.do()}),this.validate()}do(){const t=qi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){const t=qi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}),t}validate(){return!1}}Ys.NAME="SetColumnWidthAction",Ii.register(Ys.NAME,Ys);class Gs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{hideGridlines:this.do()}),this.validate()}do(){const t=Qi(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){Qi(this._commandUnit,this._oldActionData),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Gs.NAME="SetHiddenGridlinesAction",Ii.register(Gs.NAME,Gs);const Xs=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData={actionName:Xs.NAME,namedRange:this.do(),sheetId:t.sheetId},this.validate()}do(){const t=ts(this._commandUnit,this._doActionData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={actionName:Xs.NAME,sheetId:t,namedRange:this.do()}}undo(){const{sheetId:t}=this._oldActionData;this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}),this._doActionData={actionName:Xs.NAME,sheetId:t,namedRange:ts(this._commandUnit,this._oldActionData)}}validate(){return!1}};let js=Xs;js.NAME="SetNamedRangeAction",Ii.register(js.NAME,js);const Ks=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellNote:this.do()}),this.validate()}do(){const t=as(this.getWorkSheet().getCellMatrix(),this._doActionData.cellNote,this._doActionData.rangeData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:Ks.NAME,sheetId:t,cellNote:this.do(),rangeData:e}}undo(){const{rangeData:t,sheetId:e,cellNote:n}=this._oldActionData,i=this.getWorkSheet();i&&(this._doActionData={actionName:Ks.NAME,sheetId:e,cellNote:as(i.getCellMatrix(),n,t),rangeData:t},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}};let $s=Ks;$s.NAME="SetRangeNoteAction",Ii.register($s.NAME,$s);const Zs=class extends Ci{constructor(t,e,n){super(t,e,n),this._oldActionData=c(h({},t),{value:this.do()}),this.validate()}do(){const{value:t,rangeData:e}=this._doActionData,n=this._workbook.getStyles(),i=es(this.getWorkSheet().getCellMatrix(),t,e,n);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),i}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:Zs.NAME,sheetId:t,value:this.do(),rangeData:e}}undo(){const{value:t,rangeData:e,sheetId:n}=this._oldActionData,i=this._workbook.getStyles(),s=this.getWorkSheet().getCellMatrix();this._doActionData={actionName:Zs.NAME,sheetId:n,value:es(s,t,e,i),rangeData:e},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let qs=Zs;qs.NAME="SetRangeStyleAction",Ii.register(qs.NAME,qs);class Qs extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{cellValue:this.do()}),this.validate()}do(){const t=ls(this.getWorkSheet().getCellMatrix(),this._doActionData.cellValue,this._doActionData.rangeData);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t,rangeData:e}=this._doActionData;this._oldActionData={actionName:ws.NAME,sheetId:t,cellValue:this.do(),rangeData:e}}undo(){const{rangeData:t,sheetId:e,cellValue:n}=this._oldActionData,i=this.getWorkSheet();i&&(this._doActionData={actionName:ws.NAME,sheetId:e,cellValue:ls(i.getCellMatrix(),n,t),rangeData:t},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}))}validate(){return!1}}Qs.NAME="SetRangeFormattedValueAction",Ii.register(Qs.NAME,Qs);class Js extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rightToLeft:this.do()}),this.validate()}do(){const t=hs(this.getWorkSheet(),this._doActionData.rightToLeft);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){this._oldActionData;hs(this.getWorkSheet(),this._oldActionData.rightToLeft),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Js.NAME="SetRightToLeftAction",Ii.register(Js.NAME,Js);class to extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{rowHeight:this.do()}),this.validate()}do(){const t=this.getWorkSheet(),e=cs(this._doActionData.rowIndex,this._doActionData.rowHeight,t.getRowManager());return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),e}redo(){this.do()}undo(){const t=this.getWorkSheet(),e=cs(this._oldActionData.rowIndex,this._oldActionData.rowHeight,t.getRowManager());return this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this}),e}validate(){return!1}}to.NAME="SetRowHeightAction",Ii.register(to.NAME,to);class eo extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){const t=this.getWorkSheet();Ji(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet();gs(this._oldActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}eo.NAME="SetRowHideAction",Ii.register(eo.NAME,eo);class no extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t),this.validate()}do(){const t=this.getWorkSheet();gs(this._doActionData.rowIndex,this._doActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}redo(){this.do()}undo(){const t=this.getWorkSheet();Ji(this._oldActionData.rowIndex,this._oldActionData.rowCount,t.getRowManager()),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}no.NAME="SetRowShowAction",Ii.register(no.NAME,no);const io=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t);const{activeRangeList:i,activeRange:s,currentCell:o}=this.do();this._oldActionData=c(h({},t),{activeRangeList:i,activeRange:s,currentCell:o}),this.validate()}do(){const{activeRangeList:t,activeRange:e,currentCell:n}=this._doActionData,i=ds(this.getWorkSheet(),t,e,n);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),i}redo(){const{sheetId:t}=this._doActionData,{activeRangeList:e,activeRange:n,currentCell:i}=this.do();this._oldActionData={actionName:io.NAME,sheetId:t,activeRangeList:e,activeRange:n,currentCell:i}}undo(){const{activeRangeList:t,activeRange:e,currentCell:n,sheetId:i}=this._oldActionData,s=ds(this.getWorkSheet(),t,e,n);this._doActionData={actionName:io.NAME,sheetId:i,activeRangeList:s.activeRangeList,activeRange:s.activeRange,currentCell:s.currentCell},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let so=io;so.NAME="SetSelectionActivateAction",Ii.register(so.NAME,so);class oo extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{order:this.do()}),this.validate()}do(){const t=us(this.getWorkSheet().getContext().getWorkBook(),this._doActionData.sheetId,this._doActionData.order);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){this.do()}undo(){us(this.getWorkSheet().getContext().getWorkBook(),this._oldActionData.sheetId,this._oldActionData.order),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}oo.NAME="SetSheetOrderAction",Ii.register(oo.NAME,oo);const ro=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{color:this.do()}),this.validate()}do(){const t=_s(this.getWorkSheet(),this._doActionData.color);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:ro.NAME,color:this.do()}}undo(){const{color:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:ro.NAME,sheetId:e,color:_s(n,t)},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let ao=ro;ao.NAME="SetTabColorAction",Ii.register(ao.NAME,ao);const lo=class extends Ci{constructor(e,n,i){super(e,n,i),this._doActionData=h({},e);const{oldSheetId:s,status:o}=this.do();this._oldActionData=c(h({},e),{sheetId:s,status:o}),this.validate(),this.removeOperation(t.SERVER_ACTION)}do(){const{sheetId:t,status:e}=this._doActionData,n=ps(this._workbook.getSheetBySheetId(t));return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),n}redo(){const{oldSheetId:t,status:e}=this.do();this._oldActionData={actionName:lo.NAME,sheetId:t,status:e}}undo(){const{sheetId:t}=this._oldActionData;this._oldActionData.status;const e=this._workbook.getSheetBySheetId(t);if(e){const{oldSheetId:t,status:n}=ps(e);this._doActionData={actionName:lo.NAME,sheetId:t,status:n},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}}validate(){return!1}};let ho=lo;ho.NAME="SetWorkSheetActivateAction",Ii.register(ho.NAME,ho);const co=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{hidden:this.do()}),this.validate()}do(){const t=ki(this.getWorkSheet(),this._doActionData.hidden);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:co.NAME,hidden:this.do()}}undo(){const{hidden:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:co.NAME,sheetId:e,hidden:ki(n,t)},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let uo=co;uo.NAME="SetWorkSheetHideAction",Ii.register(uo.NAME,uo);const go=class extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{sheetName:this.do()}),this.validate()}do(){const t=ms(this.getWorkSheet(),this._doActionData.sheetName);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:go.NAME,sheetName:this.do()}}undo(){const{sheetName:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:go.NAME,sheetId:e,sheetName:ms(n,t)},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}};let _o=go;_o.NAME="SetWorkSheetNameAction",Ii.register(_o.NAME,_o);class po extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{sheetStatus:this.do()}),this.validate()}do(){const t=fs(this.getWorkSheet(),this._doActionData.sheetStatus);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}redo(){const{sheetId:t}=this._doActionData;this._oldActionData={sheetId:t,actionName:Bt.SET_WORKSHEET_STATUS_ACTION,sheetStatus:this.do()}}undo(){const{sheetStatus:t,sheetId:e}=this._oldActionData,n=this.getWorkSheet();this._doActionData={actionName:Bt.SET_WORKSHEET_STATUS_ACTION,sheetId:e,sheetStatus:fs(n,t)},this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}po.NAME="SetWorkSheetStatusAction",Ii.register(po.NAME,po);class mo extends Ci{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this._oldActionData=c(h({},t),{zoom:this.do()}),this.validate()}redo(){const t=Ts(this.getWorkBook(),this._doActionData.sheetId,this._doActionData.zoom);return this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this}),t}do(){return this.redo()}undo(){Ts(this.getWorkBook(),this._oldActionData.sheetId,this._oldActionData.zoom),this._observers.notifyObservers({type:fi.REDO,data:this._oldActionData,action:this})}validate(){return!1}}mo.NAME="SetZoomRatioAction",Ii.register(mo.NAME,mo);class fo extends w{constructor(t,e,n){if(super(t,n),null==e.DocumentUnit)throw new Error("action document domain can not be null!");this._document=e.DocumentUnit}getDocument(){return this._document}}function To(t,e=!1){return e?t-1:t}function vo(t,e,n){return t.slice(0,e)+n+t.slice(e)}function Eo(t,e){let n=t.body;if(e){const{headers:i,footers:s}=t;(null==i?void 0:i[e])?n=i[e].body:(null==s?void 0:s[e])&&(n=s[e].body)}return n}function bo(t,e){return!(!t.ts||!e.ts)&&_i(t.ts,e.ts)}function Io(t,e){if(bo(t,e))return t.ct+=e.ct||"",t}function Co(t,e,n){const i=t.getSnapshot(),{segmentId:s}=n,o=Eo(i,s);if(0===e.length)return;if(null==o)throw new Error("no body has changed");const{blockElements:r}=o;for(let a of r){if(null==a)continue;const{blockType:t}=a;switch(t){case K.PARAGRAPH:a.paragraph&&So(e,a,a.paragraph,n)}}}function So(t,e,n,i){const{st:s,ed:o}=e,{cursorStart:r,isStartBack:a,segmentId:l}=i,h=To(r,a);if(h>o||null==n)return;const{elements:c}=n;for(let d of c){const{et:e}=d;if(e===st.DRAWING)continue;const{st:n,ed:i,tr:s}=d;if(null!=s&&s.tab!==Ue.TRUE&&(!(h<n||h>i)&&(console.log("paragraphApply",h,n,i,d,h<n||h>i),e===st.TEXT_RUN))){let e=h-n+1;e<=0&&(e=0);const i=vo(s.ct||"",e,t);s.ct=i}}}function Ao(t,e){const n=t.getSnapshot(),{segmentId:i}=e,s=Eo(n,i);if(null==s)throw new Error("no body has changed");const{blockElements:o}=s;for(let r of o){if(null==r)continue;const{blockType:t}=r;switch(t){case K.PARAGRAPH:r.paragraph&&wo(r,r.paragraph,e)}}}function wo(t,e,n){var i,s;const{cursorStart:o,cursorEnd:r,isStartBack:a,isEndBack:l,isCollapse:h}=n,c=To(o,a),d=To(r,l),{st:u,ed:g}=t;if(o>g||r<u)return;const{elements:_}=e;let p=0;for(let v of _){const{et:t}=v;if(t===st.DRAWING){p++;continue}const{st:e,ed:n,tr:o}=v;if(null!=o&&o.tab!==Ue.TRUE)if(d<e||c>n)p++;else{if(t===st.TEXT_RUN){let t=c-e+1,i=d-e+1;t<=0&&(t=0),i>=n-e-1&&(t=n-e-1);const s=(m=o.ct||"",(f=t)>(T=i)?m:(f===T&&(f-=1),m.slice(0,f)+m.slice(T)));o.ct=s}if(0===(null==(i=o.ct)?void 0:i.length))_.splice(p,1);else{const t=null==(s=_[p-1])?void 0:s.tr;if(!t){p++;continue}Io(o,t)?_.splice(p,1):p++}}else p++}var m,f,T}var Ro,No;(No=Ro||(Ro={})).INSERT_TEXT_ACTION_NAME="InsertTextAction",No.DELETE_TEXT_ACTION_NAME="DeleteTextAction",No.CLEAR_TEXT_STYLE_ACTION_NAME="ClearTextStyleAction",No.DELETE_PARAGRAPH_ACTION_NAME="DeleteParagraphAction",No.INSERT_PARAGRAPH_ACTION_NAME="InsertParagraphAction",No.MERGE_PARAGRAPH_ACTION_NAME="MergeParagraphAction",No.MOVE_PARAGRAPH_ACTION_NAME="MoveParagraphAction",No.SET_TEXT_STYLE_ACTION_NAME="SetTextStyleAction",No.SPLIT_PARAGRAPH_ACTION_NAME="SplitParagraphAction",No.UPDATE_DOCUMENT_STYLE_ACTION_NAME="UpdateDocumentAction",No.UPDATE_PARAGRAPH_STYLE_ACTION_NAME="UpdateParagraphAction",No.UPDATE_SECTION_ACTION_NAME="UpdateSectionAction",No.DELETE_BULLET_ACTION_NAME="DeleteBulletAction",No.DELETE_PARAGRAPH_BULLET_ACTION_NAME="DeleteParagraphBulletAction",No.DELETE_SECTION_ACTION_NAME="DeleteSectionAction",No.INSERT_BULLET_ACTION_NAME="InsertBulletAction",No.INSERT_PARAGRAPH_BULLET_ACTION_NAME="InsertParagraphBulletAction",No.INSERT_SECTION_ACTION_NAME="InsertSectionAction",No.UPDATE_BULLET_ACTION_NAME="UpdateBulletAction",No.UPDATE_PARAGRAPH_BULLET_ACTION_NAME="UpdateParagraphBulletAction",No.TEXT_INDEX_ADJUST_ACTION_NAME="TextIndexAdjustAction";class yo extends fo{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do();const{cursorStart:i,isStartBack:s,text:o}=t;this._oldActionData=c(h({},t),{actionName:Ro.DELETE_TEXT_ACTION_NAME,cursorEnd:i+o.length,isEndBack:s,isCollapse:!0})}redo(){this.do()}do(){const t=this.getDoActionData(),e=this.getDocument(),{text:n,cursorStart:i,isStartBack:s,segmentId:o}=t;Co(e,n,{cursorStart:i,isStartBack:s,segmentId:o}),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}undo(){const t=this.getOldActionData();Ao(this.getDocument(),h({},t)),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}yo.NAME="InsertTextAction",Ii.register(yo.NAME,yo);class Oo extends fo{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do();const{text:i,cursorStart:s,isStartBack:o,segmentId:r}=t;this._oldActionData={actionName:Ro.INSERT_TEXT_ACTION_NAME,text:i,cursorStart:s,isStartBack:o,segmentId:r}}redo(){this.do()}do(){const t=this.getDoActionData(),e=this.getDocument(),{cursorStart:n,cursorEnd:i,isStartBack:s,isEndBack:o,isCollapse:r,segmentId:a}=t;Ao(e,{cursorStart:n,cursorEnd:i,isStartBack:s,isEndBack:o,isCollapse:r,segmentId:a})}undo(){const t=this.getOldActionData(),e=this.getDocument(),{text:n,cursorStart:i,isStartBack:s,segmentId:o}=t;Co(e,n,{cursorStart:i,isStartBack:s,segmentId:o})}validate(){return!1}}function Do(t,e){const{segmentId:n}=e;let i=Eo(t.getSnapshot(),n);if(null==i)throw new Error("no body has changed");const{blockElements:s}=i;let o=null;for(let r of s){if(null==r)continue;const{blockType:t}=r;switch(t){case K.PARAGRAPH:r.paragraph&&Mo(r,r.paragraph,e,o),o=r}}}function Mo(t,e,n,i){const{cursorStart:s,cursorEnd:o,isCollapse:r,isEndBack:a,isStartBack:l}=n,{st:h,ed:c}=t;if(s>c)return;const{elements:d}=e,u=i?i.ed:-1;if(o<h){const e=u-h+1;!function(t,e=0){null!=t&&(t.st+=e,t.ed+=e)}(t,e),xo(d,(t=>{!function(t,e=0){null!=t&&(t.st+=e,t.ed+=e)}(t,e)}))}else{let e=u+1,n=e;xo(d,(t=>{const{tr:e}=t,i=(null==e?void 0:e.ct)||"";t.st=n,t.ed=n+i.length-1,n=t.ed+1})),t.st=e,t.ed=n-1}}function xo(t,e){for(let n of t){const{et:t}=n;t!==st.DRAWING&&e(n)}}Oo.Name="DeleteTextAction",Ii.register(Oo.Name,Oo);class Lo extends fo{constructor(t,e,n){super(t,e,n),this._doActionData=h({},t),this.do(),this._oldActionData=h({},t)}redo(){this.do()}do(){const t=this.getDoActionData();Do(this.getDocument(),t),this._observers.notifyObservers({type:fi.REDO,data:this._doActionData,action:this})}undo(){const t=this.getOldActionData();Do(this.getDocument(),t),this._observers.notifyObservers({type:fi.UNDO,data:this._oldActionData,action:this})}validate(){return!1}}Lo.Name="TextIndexAdjustAction",Ii.register(Lo.Name,Lo);class ko{constructor(t){this._name=t,this._observeNames=[]}onCreate(t){this.context=t}load(t){}save(){return Object()}onMounted(t){}onDestroy(){this.deleteObserve(...this._observeNames)}getPluginName(){return this._name}getContext(){return this.context}getGlobalContext(){return this.context.getUniver().getGlobalContext()}getLocale(){return this.getGlobalContext().getLocale()}getUniver(){return this.context.getUniver()}getObserver(t){return this.context.getObserverManager().getObserver(t,this._name)}getPluginByName(t){return this.context.getPluginManager().getPluginByName(t)}pushToObserve(...t){const e=this.context.getObserverManager();t.forEach((t=>{this._observeNames.includes(t)||this._observeNames.push(t),e.addObserver(t,this._name,new y)}))}deleteObserve(...t){const e=this.context.getObserverManager();t.forEach((t=>{e.removeObserver(t,this._name)}))}}class Po{constructor(t,e=[]){this._context=t,this._plugins=[],this._initialized=!0,this._plugins=this._plugins.concat(e),this._initialize()}install(t){const{_plugins:e}=this;e.push(t),t.onCreate(this._context),t.onMounted(this._context)}uninstall(t){const{_plugins:e}=this,n=e.findIndex((e=>e.getPluginName()===t));if(n>-1){const t=e.splice(n,1)[0];t&&t.onDestroy()}}setContext(t){this._context=t}getRequirePluginByName(t){for(let e=0;e<this._plugins.length;e++)if(this._plugins[e].getPluginName()===t)return this._plugins[e];throw new Error(`not found plugin ${t}`)}getPlugins(){return this._plugins}getPluginByName(t){for(let e=0;e<this._plugins.length;e++)if(this._plugins[e].getPluginName()===t)return this._plugins[e];return null}_initialize(){this._initialized&&(this._initialized=!1,this._plugins.forEach((t=>{t.onCreate(this._context),t.onMounted(this._context)})))}}class Ho{constructor(){this.os="",this.app_version="",this.platform="",this.device_id="",this.os_version=""}}class Bo{constructor(){this._hooksManager=new D,this._pluginManager=new Po(this),this._environment=new Ho,this._observerManager=new mi,this._initialize()}onUniver(t){const e=t.getGlobalContext();this._univer=t,this._undoManager=e.getUndoManager(),this._commandManager=e.getCommandManager()}getHook(t){return this._hooksManager.getHooks(t)}getHooksManager(){return this._hooksManager}getObserverManager(){return this._observerManager}getPluginManager(){return this._pluginManager}getUndoManager(){return this._undoManager}getCommandManager(){return this._commandManager}getUniver(){return this._univer}_initialize(){this._undoManager=new Ai,this._commandManager=new Ii(this)}}class Fo extends Bo{constructor(t={}){super(),this._locale=new ei,this._locale.initialize(),null==t.id||0===t.id.length?this._univerId=z.generateRandomId(10):this._univerId=t.id}getLocale(){return this._locale}getUniverId(){return this._univerId}_setObserver(){}}class Uo{constructor(){this._data=[]}static create(){return new Uo}add(t){this._data.indexOf(t)>-1||this._data.push(t)}delete(t){const e=this._data.indexOf(t);this._data.splice(e,1)}getData(){return this._data}}class zo{constructor(t,e){var n;this._context=e,this._snapshot=h(h({},Je),t),this._unitId=null!=(n=this._snapshot.id)?n:z.generateRandomId(6)}getSnapshot(){return this._snapshot}getUnitId(){return this._unitId}getPages(){var t;return null==(t=this._snapshot.body)?void 0:t.pages}getPageOrder(){var t;return null==(t=this._snapshot.body)?void 0:t.pageOrder}getPage(t){const e=this.getPages();return null==e?void 0:e[t]}getElementsByPage(t){var e;return null==(e=this.getPage(t))?void 0:e.pageElements}getElement(t,e){var n;return null==(n=this.getElementsByPage(t))?void 0:n[e]}getPageSize(){return this._snapshot.pageSize}addPage(){return{id:"cover_1",pageType:an.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{}}}}class Wo extends Bo{constructor(t={}){super(),this._slide=new zo(t,this)}getSlide(){return this._slide}_setObserver(){}}const Vo="0.0.1";class Yo{constructor(t={}){this.UniverSlideConfig=t,this._context=new Wo(t)}get context(){return this._context}static newInstance(t={}){return ni.capsule("dev",Vo,"powered by :: UniverSlide :: "),new Yo(t)}static get(t){return Kn(c(h({},t),{type:"GET"}))}static post(t){return Kn(c(h({},t),{type:"POST"}))}static newColor(){return new gn}installPlugin(t){this._context.getPluginManager().install(t)}uninstallPlugin(t){this._context.getPluginManager().uninstall(t)}}const Go=class{static register(t,e){let n=Go.sMap.get(t);n?n.push(e):(n=new Array,n.push(e),Go.sMap.set(t,n))}static getTable(t){var e;let n=new Array,i=t;for(;null!=i;){const t=null!=(e=Go.sMap.get(i))?e:[];n=n.concat(t),i=Object.getPrototypeOf(i)}return n}};let Xo=Go;var jo,Ko;Xo.sMap=new Map,(Ko=jo||(jo={}))[Ko.singleton=0]="singleton",Ko[Ko.prototype=1]="prototype",Ko[Ko.nothing=2]="nothing";class $o{constructor(){this.load()}first(){return this._messages[0]}last(){return this._messages[this._messages.length-1]}size(){return this._messages.length}pop(){this._messages.shift(),this.save()}push(t){this._messages.push(t),this.save()}hasMessage(){return this._messages.length>0}isEmpty(){return!this.hasMessage()}save(){const t=JSON.stringify(this._messages);localStorage.setItem("MessageQueue",t)}load(){const t=localStorage.getItem("MessageQueue");t&&(this._messages=JSON.parse(t))}}var Zo;(Zo||(Zo={})).MESSAGE_RESPONSE="message_response";var qo,Qo,Jo=Object.defineProperty,tr=Object.getOwnPropertyDescriptor,er=(t,e,n,i)=>{for(var s,o=i>1?void 0:i?tr(e,n):e,r=t.length-1;r>=0;r--)(s=t[r])&&(o=(i?s(e,n,o):s(o))||o);return i&&o&&Jo(e,n,o),o};(Qo=qo||(qo={})).WAIT="wait",Qo.WORK="work";const nr=class extends class{static isMessageResponseReceive(t){return t.type===Zo.MESSAGE_RESPONSE}packMessage(t){return{changed:t,version:z.generateRandomId(6)}}}{initialize(){this.messageQueue=new $o,this.status=qo.WAIT,this.globalSendResolve=()=>{},this.config.socketEnable&&(this.socket=new Qn({url:this.config.socketUrl}),this.socket.on($n.MESSAGE,(t=>{this.checkupReceiveMessage(t.data)})),this.socket.on($n.ERROR,(()=>{})),this.socket.on($n.OPEN,(()=>{})),this.socket.on($n.CLOSE,(()=>{})),this.socket.on($n.RETRY,(()=>{})),this.socket.on($n.DESTROY,(()=>{})),this.socket.link())}pushMessageQueue(t){this.config.socketEnable&&(this.messageQueue.push(this.packMessage(t)),this.sendMessageQueue())}getTopMessage(){return this.messageQueue.first()}popTopMessage(){this.messageQueue.pop()}serializeTopMessage(){var t;const e=this.getTopMessage();return null!=(t=JSON.stringify(e))?t:""}checkupReceiveMessage(t){nr.isMessageResponseReceive(t)&&this.getTopMessage().version===t.message.version&&(this.popTopMessage(),this.globalSendResolve())}async sendTopMessage(){const t=this.serializeTopMessage();return this.socket.send(t),new Promise((t=>this.globalSendResolve=t))}async sendMessageQueue(){const{messageQueue:t,status:e}=this;if(e===qo.WAIT){for(this.status=qo.WORK;t.hasMessage();)await this.sendTopMessage();this.status=qo.WAIT}return this.status}};let ir=nr;er([(t,e)=>{Xo.register(t,e),Reflect.defineMetadata("AttributeValue",{},t,e)}],ir.prototype,"config",2),er([(t,e,n)=>{Xo.register(t,e),Reflect.defineMetadata("PostConstruct",n,t,e)}],ir.prototype,"initialize",1);var sr={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana","微软雅黑","宋体","黑体","楷体","仿宋","新宋体","华文新魏","华文行楷","华文隶书"],defaultFontSize:14,unit:"pt"}},or={renderFont:{defaultFont:"Times New Roman",fontList:["Times New Roman","Arial","Tahoma","Verdana"],defaultFontSize:9,unit:"pt"}};const rr=[0,0,0],ar=[255,255,255];var lr,hr,cr,dr,ur;(lr||(lr={})).rect="rect",(cr=hr||(hr={})).PointerMove="PointerMove",cr.PointerDown="PointerDown",cr.PointerUp="PointerUp",cr.PointerOut="PointerOut",cr.PointerLeave="PointerLeave",cr.PointerOver="PointerOver",cr.PointerEnter="PointerEnter",cr.wheel="MouseWheel",cr.KeyDown="KeyDown",cr.KeyUp="KeyUp",(ur=dr||(dr={}))[ur.XY=0]="XY",ur[ur.X=1]="X",ur[ur.Y=2]="Y";const gr=14;var _r,pr,mr,fr;(pr=_r||(_r={})).DEFAULT="default",pr.AUTO="auto",pr.CROSSHAIR="crosshair",pr.POINTER="pointer",pr.MOVE="move",pr.EAST_RESIZE="e-resize",pr.NORTH_EAST_RESIZE="ne-resize",pr.NORTH_WEST_RESIZE="nw-resize",pr.NORTH_RESIZE="n-resize",pr.SOUTH_EAST_RESIZE="se-resize",pr.SOUTH_WEST_RESIZE="sw-resize",pr.SOUTH_RESIZE="s-resize",pr.WEST_RESIZE="w-resize",pr.TEXT="text",pr.WAIT="wait",pr.HELP="help",pr.CELL="cell",pr.NONE="none",pr.VERTICAL_TEXT="vertical-text",pr.NO_DROP="no-drop",pr.GRAB="grab",pr.GRABBING="grabbing",pr.ALL_SCROLL="all-scroll",pr.COLUMN_RESIZE="col-resize",pr.ROW_RESIZE="row-resize",pr.PROGRESS="progress",pr.NOT_ALLOWED="not-allowed",pr.ZOOM_IN="zoom-in",pr.ZOOM_OUT="zoom-out",(fr=mr||(mr={}))[fr.noClip=0]="noClip",fr[fr.DOC_SIZE=1]="DOC_SIZE",fr[fr.CONTENT_SIZE_LEFT=2]="CONTENT_SIZE_LEFT",fr[fr.CONTENT_SIZE_CENTER=3]="CONTENT_SIZE_CENTER",fr[fr.CONTENT_SIZE_Right=4]="CONTENT_SIZE_Right";var Tr,vr,Er,br,Ir,Cr;(vr=Tr||(Tr={})).TOP="t",vr.BOTTOM="b",vr.LEFT="l",vr.RIGHT="r",(br=Er||(Er={}))[br.UP=0]="UP",br[br.DOWN=1]="DOWN",(Cr=Ir||(Ir={})).ENGINE="Engine",Cr.SCENE="Scene",Cr.BASE_OBJECT="BaseObject",Cr.SCENE_VIEWER="SceneViewer",Cr.CANVAS="Canvas",Cr.VIEWPORT="Viewport",Cr.LAYER="Layer",Cr.GROUP="Group";const Sr=t=>({sbr:.5,sbo:t,spr:.5,spo:t});class Ar{static get globalFontMeasureCache(){return this._globalFontMeasureCache}static setFontMeasureCache(t,e,n){this._globalFontMeasureCache.has(t)||(this._globalFontMeasureCache[t]=new Map),this._globalFontMeasureCache[t][e]=n}static clearFontMeasureCache(t){var e;const n=t.split("/");if(1===n.length){const t=n[0];this._globalFontMeasureCache.delete(t)}else{if(2!==n.length)return!1;{const t=n[0],i=n[1];null==(e=this._globalFontMeasureCache.get(t))||e.delete(i)}}return!0}static getFontMeasureCache(t,e){var n;return null==(n=this._globalFontMeasureCache[t])?void 0:n[e]}static autoCleanFontMeasureCache(t=1e6){let e=0,n=!1;for(let i of this._globalFontMeasureCache){const[,s]=i;if(e+=s.size,e>t){n=!0;break}}if(n){let e=0;for(let n of this._globalFontMeasureCache){const[i,s]=n;if(e+=s.size,e>t/2){const n=e-t/2;this._clearMeasureCache(n,s);break}this._globalFontMeasureCache.delete(i)}return!0}return!1}static getBaselineOffsetInfo(t,e){if(0===this._fontDataMap.size)return Sr(e);const n=t.split(",");for(let i of n){i=i.replace(/'/g,"");const t=this._fontDataMap.get(i);if(!t)continue;const{subscriptSizeRatio:n,subscriptOffset:s,superscriptSizeRatio:o,superscriptOffset:r}=t;return{sbr:n,sbo:s*e,spr:o,spo:r*e}}return Sr(e)}static getTextSizeByDom(t,e){if(e in this._getTextHeightCache)return this._getTextHeightCache[e];let n=document.getElementById("universheetTextSizeTest");n||(n=document.createElement("span"),n.id="universheetTextSizeTest",document.getElementsByTagName("body")[0].appendChild(n)),n.style.cssText+=`float:left;white-space:nowrap;visibility:hidden;margin:0;padding:0;;${e}`,n.innerText=t;const i=n.getBoundingClientRect(),s={width:i.width,height:i.height};return this._getTextHeightCache[e]=s,s}static getTextSize(t,e){const{fontString:n,fontSize:i,fontFamily:s}=e;let o=this._getBoundingBoxByFont(s,i);if(!o){const e=this.getMeasureText(t,n);o=this._calculateBoundingBoxByMeasureText(e,i)}return o}static getMeasureText(t,e){if(!this._context){const t=document.createElement("canvas");this._context=t.getContext("2d")}const n=this._context,i=this.getFontMeasureCache(e,t);if(null!=i)return i;n.font=e;const s=n.measureText(t),{width:o,fontBoundingBoxAscent:r,fontBoundingBoxDescent:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h}=s,c={width:o,fontBoundingBoxAscent:r,fontBoundingBoxDescent:a,actualBoundingBoxAscent:l,actualBoundingBoxDescent:h};if(null==r||null==a||Number.isNaN(r)||Number.isNaN(a)){let t=this.getTextSizeByDom("0",e)[1];"top"===n.textBaseline?(c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t,c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=0):"middle"===n.textBaseline?(c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=t/2,c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t/2):(c.fontBoundingBoxDescent=c.actualBoundingBoxDescent=0,c.fontBoundingBoxAscent=c.actualBoundingBoxAscent=t)}return this.setFontMeasureCache(e,t,c),c}static _clearMeasureCache(t,e){let n=0;for(let i of e){const[s]=i;if(n>t)break;e.delete(s),n++}return!0}static _getBoundingBoxByFont(t,e=28,n=""){const i=this._fontDataMap.get(t);if(!i)return;const{notDefWidth:s,ascender:o,descender:r,typoAscender:a,typoDescender:l,strikeoutPosition:h,subscriptSizeRatio:c,subscriptOffset:d,superscriptSizeRatio:u,superscriptOffset:g,hdmxData:_,glyphHorizonMap:p}=i,m=null==_?void 0:_.indexOf(Math.floor(e)),f=p.get(n.charCodeAt(0));let T=s;if(f){const{width:t,pixelsPerEm:e=[]}=f;T=m?e[m]:t}return{width:T*e,ba:o*e,bd:r*e,aba:a*e,abd:l*e,sp:h*e,sbr:c,sbo:d*e,spr:u,spo:g*e}}static _calculateBoundingBoxByMeasureText(t,e){const{width:n,fontBoundingBoxAscent:i,fontBoundingBoxDescent:s,actualBoundingBoxAscent:o,actualBoundingBoxDescent:r}=t;return{width:n,ba:i,bd:s,aba:o,abd:r,sp:(i+s)/2,sbr:.5,sbo:e,spr:.5,spo:e}}}var wr,Rr,Nr,yr,Or,Dr,Mr,xr,Lr,kr,Pr,Hr,Br,Fr,Ur,zr,Wr,Vr;Ar._getTextHeightCache={},Ar._fontDataMap=new Map,Ar._globalFontMeasureCache=new Map,(Rr=wr||(wr={}))[Rr.SPAN=0]="SPAN",Rr[Rr.DIVIDE=1]="DIVIDE",Rr[Rr.LINE=2]="LINE",Rr[Rr.COLUMN=3]="COLUMN",Rr[Rr.SECTION=4]="SECTION",Rr[Rr.PAGE=5]="PAGE",Rr[Rr.DRAWING=6]="DRAWING",Rr[Rr.BULLET=7]="BULLET",Rr[Rr.HEADER=8]="HEADER",Rr[Rr.FOOTER=9]="FOOTER",Rr[Rr.ALL=10]="ALL",(yr=Nr||(Nr={}))[yr.SECTION=0]="SECTION",yr[yr.PAGE=1]="PAGE",yr[yr.COLUMN=2]="COLUMN",(Dr=Or||(Or={}))[Dr.PARAGRAPH=0]="PARAGRAPH",Dr[Dr.BLOCK=1]="BLOCK",(xr=Mr||(Mr={}))[xr.LETTER=0]="LETTER",xr[xr.WORD=1]="WORD",xr[xr.LIST=2]="LIST",xr[xr.TAB=3]="TAB",xr[xr.IMAGE=4]="IMAGE",xr[xr.AT=5]="AT",xr[xr.MATH=6]="MATH",xr[xr.MULTI_LINE=7]="MULTI_LINE",xr[xr.CUSTOM=8]="CUSTOM",(kr=Lr||(Lr={}))[kr.VERTICAL=0]="VERTICAL",kr[kr.HORIZONTAL=1]="HORIZONTAL",kr[kr.AUTO=2]="AUTO",(Hr=Pr||(Pr={}))[Hr.PointerMove=0]="PointerMove",Hr[Hr.PointerDown=1]="PointerDown",Hr[Hr.PointerUp=2]="PointerUp",(Fr=Br||(Br={}))[Fr.Generic=0]="Generic",Fr[Fr.Keyboard=1]="Keyboard",Fr[Fr.Mouse=2]="Mouse",Fr[Fr.Touch=3]="Touch",(zr=Ur||(Ur={}))[zr.Horizontal=0]="Horizontal",zr[zr.Vertical=1]="Vertical",zr[zr.LeftClick=2]="LeftClick",zr[zr.MiddleClick=3]="MiddleClick",zr[zr.RightClick=4]="RightClick",zr[zr.BrowserBack=5]="BrowserBack",zr[zr.BrowserForward=6]="BrowserForward",zr[zr.MouseWheelX=7]="MouseWheelX",zr[zr.MouseWheelY=8]="MouseWheelY",zr[zr.MouseWheelZ=9]="MouseWheelZ",zr[zr.DeltaHorizontal=10]="DeltaHorizontal",zr[zr.DeltaVertical=11]="DeltaVertical",zr[zr.FakeMove=12]="FakeMove",(Vr=Wr||(Wr={}))[Vr.translate=0]="translate",Vr[Vr.resize=1]="resize",Vr[Vr.scale=2]="scale",Vr[Vr.skew=3]="skew",Vr[Vr.flip=4]="flip",Vr[Vr.all=5]="all";class Yr{constructor(t=30){this._enabled=!0,this._rollingFrameTime=new Gr(t)}get averageFrameTime(){return this._rollingFrameTime.average}get averageFrameTimeVariance(){return this._rollingFrameTime.variance}get instantaneousFrameTime(){return this._rollingFrameTime.history(0)}get averageFPS(){return 1e3/this._rollingFrameTime.average}get instantaneousFPS(){let t=this._rollingFrameTime.history(0);return 0===t?0:1e3/t}get isSaturated(){return this._rollingFrameTime.isSaturated()}get isEnabled(){return this._enabled}sampleFrame(t=this.Now()){if(this._enabled){if(null!=this._lastFrameTimeMs){let e=t-this._lastFrameTimeMs;this._rollingFrameTime.add(e)}this._lastFrameTimeMs=t}}Now(){return window.performance&&window.performance.now?window.performance.now():Date.now()}enable(){this._enabled=!0}disable(){this._enabled=!1,this._lastFrameTimeMs=null}reset(){this._lastFrameTimeMs=null,this._rollingFrameTime.reset()}}class Gr{constructor(t){this._samples=new Array(t),this.reset()}add(t){let e;if(this.isSaturated()){let t=this._samples[this._pos];e=t-this.average,this.average-=e/(this._sampleCount-1),this._m2-=e*(t-this.average)}else this._sampleCount++;e=t-this.average,this.average+=e/this._sampleCount,this._m2+=e*(t-this.average),this.variance=this._m2/(this._sampleCount-1),this._samples[this._pos]=t,this._pos++,this._pos%=this._samples.length}history(t){if(t>=this._sampleCount||t>=this._samples.length)return 0;let e=this._wrapPosition(this._pos-1);return this._samples[this._wrapPosition(e-t)]}isSaturated(){return this._sampleCount>=this._samples.length}reset(){this.average=0,this.variance=0,this._sampleCount=0,this._pos=0,this._m2=0}_wrapPosition(t){let e=this._samples.length;return(t%e+e)%e}}const Xr=Math.PI/180,jr=180/Math.PI,Kr=(t,e)=>t?null!=e?`${"rgba("+t.join(",")},${e})`:"rgb("+t.join(",")+")":"rgb(0,0,0)",$r=(t,e)=>{if(z.isNumber(t))return t;if(e&&t&&z.isString(t)&&"%"===t.substr(t.length-1,1)){return e*(parseFloat(t)/100)}return 0},Zr=(t,e)=>(e||(e=window),e.requestPostAnimationFrame?e.requestPostAnimationFrame(t):e.requestAnimationFrame?e.requestAnimationFrame(t):e.msRequestAnimationFrame?e.msRequestAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitRequestAnimationFrame(t):e.mozRequestAnimationFrame?e.mozRequestAnimationFrame(t):e.oRequestAnimationFrame?e.oRequestAnimationFrame(t):window.setTimeout(t,16)),qr=()=>{let t=document.createElement("canvas");try{t.style=t.style||{}}catch(e){console.error(e)}return t},Qr=t=>t*Xr,Jr=()=>{let t="pointer";return"undefined"==typeof window||window.PointerEvent||"undefined"==typeof navigator||navigator.pointerEnabled||(t="mouse"),!z.isTablet()||z.isIPhone()||document&&"ontouchend"in document||(t="mouse"),t};function ta(t){return Object.prototype.toString.apply(t)}function ea(t){return"[object Function]"===ta(t)}function na(t){return"[object String]"===ta(t)}function ia(t,e){return e=10**e,Math.round(t*e)/e}function sa(t,e){return Math.round(t*e)/e}function oa(t,e){e||(e={fontList:["Arial"],defaultFontSize:14});const{fontList:n,defaultFontSize:i}=e;if(!t)return{fontString:`${i}px  ${n[0]}`,fontSize:i,fontFamily:n[0]};let s=It.ITALIC;0!==t.it&&void 0!==t.it||(s=It.NORMAL);let o=It.BOLD;0!==t.bl&&void 0!==t.bl||(o=It.NORMAL);let r=i;t.fs&&(r=Math.ceil(t.fs));let a=n[0];if(t.ff){let e=t.ff;e=e.replace(/"/g,"").replace(/'/g,""),e.indexOf(" ")>-1&&(e=`"${e}"`),null==e&&(e=n[0]),a=e}const{va:l}=t;if(l===Be.SUBSCRIPT||l===Be.SUPERSCRIPT){const t=Ar.getBaselineOffsetInfo(a,r),{sbr:e,spr:n}=t;r*=l===Be.SUBSCRIPT?e:n}return{fontString:`${s} ${o} ${r}px ${a}, "Helvetica Neue", Helvetica, Arial, "PingFang SC", "Hiragino Sans GB", "Heiti SC", "Microsoft YaHei", "WenQuanYi Micro Hei", sans-serif `,fontSize:r,fontFamily:a}}function ra(t){return!!/[\u2E80-\uA4CF]|[\uF900-\uFAFF]|[\uFE30-\uFE4F]|[\uFF00-\uFFEF]/gi.exec(t)}function aa(t){return!!/[\u0600-\u06FF]|[\u0750-\u0750]|[\u0870-\u08FF]|[\uFB50-\uFDFF]|[\uFE70-\uFEFF]/gi.exec(t)}function la(t){return!!/[\u0180-\u024F]/gi.exec(t)}function ha(t){return!!/\s+|\t+/g.exec(t)}function ca(t){const{scaleX:e=1,scaleY:n=1}=t;return Math.max(e,n)}function da(t,e,n,i){const s=e-1;return{startY:n[t-1]||0,endY:n[t],startX:i[s]||0,endX:i[e]}}function ua(t,e,n,i,s){let{startY:o,endY:r,startX:a,endX:l}=da(t,e,n,i);const{isMerged:d,isMergedMainCell:u,newEndRow:g,newEndColumn:_,mergeRow:p,mergeColumn:m}=function(t,e,n){let i=!1,s=!1,o=-1,r=-1,a=-1,l=-1;return null==n||n.forEach(((n,h)=>{let c=!1;if(null==h||h.forEach(((n,h)=>{const{startRow:d,endRow:u,startColumn:g,endColumn:_}=h;return t===d&&e===g?(o=u,r=_,a=d,l=g,c=!0,s=!0,!1):t>=d&&t<=u&&e>=g&&e<=_?(o=u,r=_,a=d,l=g,c=!0,i=!0,!1):void 0})),c)return!1})),{isMergedMainCell:s,isMerged:i,newEndRow:o,newEndColumn:r,mergeRow:a,mergeColumn:l}}(t,e,s);let f={startRow:p,startColumn:m,endRow:g,endColumn:_,startY:0,endY:0,startX:0,endX:0};if(d&&-1!==p&&-1!==m){let t=n[p-1]||0,e=n[g],s=i[m-1]||0,o=i[_];f=c(h({},f),{startY:t,endY:e,startX:s,endX:o})}else d||-1===g||-1===_||(r=n[g]||0,l=i[_]||0);return{isMerged:d,isMergedMainCell:u,row:t,column:e,startY:o,endY:r,startX:a,endX:l,mergeInfo:f}}function ga(t,e,n,i,s){const{startY:o,endY:r,startX:a,endX:l}=t;return t.startY=sa(o+n,s),t.endY=sa(r+n,s),t.startX=sa(a+e,i),t.endX=sa(l+e,i),h({},t)}function _a(t,e){return!(t.left>e.right||t.top>e.bottom||e.left>t.right||e.top>t.bottom)}function pa(t){return Number(t.replace(/px/gi,""))}class ma{constructor(t=0,e=0){this.x=t,this.y=e}static Zero(){return new ma(0,0)}static One(){return new ma(1,1)}static FromArray(t,e=0){return new ma(t[e],t[e+1])}static FromArrayToRef(t,e,n){n.x=t[e],n.y=t[e+1]}static CatmullRom(t,e,n,i,s){let o=s*s,r=s*o,a=.5*(2*e.x+(-t.x+n.x)*s+(2*t.x-5*e.x+4*n.x-i.x)*o+(-t.x+3*e.x-3*n.x+i.x)*r),l=.5*(2*e.y+(-t.y+n.y)*s+(2*t.y-5*e.y+4*n.y-i.y)*o+(-t.y+3*e.y-3*n.y+i.y)*r);return new ma(a,l)}static Clamp(t,e,n){let i=t.x;i=i>n.x?n.x:i,i=i<e.x?e.x:i;let s=t.y;return s=s>n.y?n.y:s,s=s<e.y?e.y:s,new ma(i,s)}static Hermite(t,e,n,i,s){let o=s*s,r=s*o,a=2*r-3*o+1,l=-2*r+3*o,h=r-2*o+s,c=r-o,d=t.x*a+n.x*l+e.x*h+i.x*c,u=t.y*a+n.y*l+e.y*h+i.y*c;return new ma(d,u)}static Hermite1stDerivative(t,e,n,i,s){let o=ma.Zero();return this.Hermite1stDerivativeToRef(t,e,n,i,s,o),o}static Hermite1stDerivativeToRef(t,e,n,i,s,o){const r=s*s;o.x=6*(r-s)*t.x+(3*r-4*s+1)*e.x+6*(-r+s)*n.x+(3*r-2*s)*i.x,o.y=6*(r-s)*t.y+(3*r-4*s+1)*e.y+6*(-r+s)*n.y+(3*r-2*s)*i.y}static Lerp(t,e,n){let i=t.x+(e.x-t.x)*n,s=t.y+(e.y-t.y)*n;return new ma(i,s)}static Dot(t,e){return t.x*e.x+t.y*e.y}static Normalize(t){let e=ma.Zero();return this.NormalizeToRef(t,e),e}static NormalizeToRef(t,e){let n=t.length();0!==n&&(e.x=t.x/n,e.y=t.y/n)}static Minimize(t,e){let n=t.x<e.x?t.x:e.x,i=t.y<e.y?t.y:e.y;return new ma(n,i)}static Maximize(t,e){let n=t.x>e.x?t.x:e.x,i=t.y>e.y?t.y:e.y;return new ma(n,i)}static Transform(t,e,n=!1){const i=e,s=t;return n?new ma(i[0]*s.x+i[2]*s.y,i[1]*s.x+i[3]*s.y):new ma(i[0]*s.x+i[2]*s.y+i[4],i[1]*s.x+i[3]*s.y+i[5])}static PointInTriangle(t,e,n,i){let s=.5*(-n.y*i.x+e.y*(-n.x+i.x)+e.x*(n.y-i.y)+n.x*i.y),o=s<0?-1:1,r=(e.y*i.x-e.x*i.y+(i.y-e.y)*t.x+(e.x-i.x)*t.y)*o,a=(e.x*n.y-e.y*n.x+(e.y-n.y)*t.x+(n.x-e.x)*t.y)*o;return r>0&&a>0&&r+a<2*s*o}static Distance(t,e){return Math.sqrt(ma.DistanceSquared(t,e))}static DistanceSquared(t,e){let n=t.x-e.x,i=t.y-e.y;return n*n+i*i}static Center(t,e){return ma.CenterToRef(t,e,ma.Zero())}static CenterToRef(t,e,n){return n.copyFromFloats((t.x+e.x)/2,(t.y+e.y)/2)}static DistanceOfPointFromSegment(t,e,n){let i=ma.DistanceSquared(e,n);if(0===i)return ma.Distance(t,e);let s=n.subtract(e),o=Math.max(0,Math.min(1,ma.Dot(t.subtract(e),s)/i)),r=e.add(s.multiplyByFloats(o,o));return ma.Distance(t,r)}static create(t,e){return new ma(t,e)}toString(){return`{X: ${this.x} Y: ${this.y}}`}getClassName(){return"Vector2"}getHashCode(){let t=0|this.x;return t=397*t^(0|this.y),t}toArray(t,e=0){return t[e]=this.x,t[e+1]=this.y,this}fromArray(t,e=0){return ma.FromArrayToRef(t,e,this),this}asArray(){let t=new Array;return this.toArray(t,0),t}copyFrom(t){return this.x=t.x,this.y=t.y,this}copyFromFloats(t,e){return this.x=t,this.y=e,this}set(t,e){return this.copyFromFloats(t,e)}add(t){return new ma(this.x+t.x,this.y+t.y)}addToRef(t,e){return e.x=this.x+t.x,e.y=this.y+t.y,this}addByPoint(t,e){return new ma(this.x+t,this.y+e)}addInPlace(t){return this.x+=t.x,this.y+=t.y,this}subtract(t){return new ma(this.x-t.x,this.y-t.y)}subtractByPoint(t,e){return new ma(this.x-t,this.y-e)}subtractToRef(t,e){return e.x=this.x-t.x,e.y=this.y-t.y,this}subtractInPlace(t){return this.x-=t.x,this.y-=t.y,this}multiplyInPlace(t){return this.x*=t.x,this.y*=t.y,this}multiply(t){return new ma(this.x*t.x,this.y*t.y)}multiplyToRef(t,e){return e.x=this.x*t.x,e.y=this.y*t.y,this}multiplyByFloats(t,e){return new ma(this.x*t,this.y*e)}divide(t){return new ma(this.x/t.x,this.y/t.y)}divideToRef(t,e){return e.x=this.x/t.x,e.y=this.y/t.y,this}divideInPlace(t){return this.divideToRef(t,this)}negate(){return new ma(-this.x,-this.y)}negateInPlace(){return this.x*=-1,this.y*=-1,this}negateToRef(t){return t.copyFromFloats(-1*this.x,-1*this.y)}scaleInPlace(t){return this.x*=t,this.y*=t,this}scale(t){let e=new ma(0,0);return this.scaleToRef(t,e),e}scaleToRef(t,e){return e.x=this.x*t,e.y=this.y*t,this}scaleAndAddToRef(t,e){return e.x+=this.x*t,e.y+=this.y*t,this}equals(t){return t&&this.x===t.x&&this.y===t.y}floor(){return new ma(Math.floor(this.x),Math.floor(this.y))}fract(){return new ma(this.x-Math.floor(this.x),this.y-Math.floor(this.y))}rotate(t){const e=Math.cos(t),n=Math.sin(t),i=e*this.x-n*this.y,s=n*this.x+e*this.y;return this.x=i,this.y=s,this}rotateToRef(t,e){const n=Math.cos(t),i=Math.sin(t);return e.x=n*this.x-i*this.y,e.y=i*this.x+n*this.y,this}rotateByPoint(t,e=ma.create(0,0)){const n=Math.cos(t),i=Math.sin(t),s=e.x+(this.x-e.x)*n-(this.y-e.y)*i,o=e.y+(this.x-e.x)*i+(this.y-e.y)*n;return this.x=s,this.y=o,this}transformCoordinateOnRotate(t){const e=Math.sqrt(this.x**2+this.y**2),n=-t+Math.atan2(this.y,this.x);return this.x=e*Math.cos(n),this.y=e*Math.sin(n),this}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}lengthSquared(){return this.x*this.x+this.y*this.y}normalize(){return ma.NormalizeToRef(this,this),this}clone(){return new ma(this.x,this.y)}}const fa=[1,0,0,1,0,0];class Ta{constructor(t=fa){this.dirty=!1,this._m=t&&t.slice()||fa}static create(t=fa){return new this(t)}reset(){this._m[0]=1,this._m[1]=0,this._m[2]=0,this._m[3]=1,this._m[4]=0,this._m[5]=0}copy(){return new Ta(this._m)}copyInto(t){t._m[0]=this._m[0],t._m[1]=this._m[1],t._m[2]=this._m[2],t._m[3]=this._m[3],t._m[4]=this._m[4],t._m[5]=this._m[5]}applyPoint(t,e=!1){const n=this._m;let i=n[0]*t.x+n[2]*t.y,s=n[1]*t.x+n[3]*t.y;return e?new ma(i,s):new ma(i+n[4],s+n[5])}translate(t,e){return this._m[4]+=this._m[0]*t+this._m[2]*e,this._m[5]+=this._m[1]*t+this._m[3]*e,this}scale(t,e){return this._m[0]*=t,this._m[1]*=t,this._m[2]*=e,this._m[3]*=e,this}rotate(t){const e=Qr(t);let n=Math.cos(e),i=Math.sin(e),s=this._m[0]*n+this._m[2]*i,o=this._m[1]*n+this._m[3]*i,r=this._m[0]*-i+this._m[2]*n,a=this._m[1]*-i+this._m[3]*n;return this._m[0]=s,this._m[1]=o,this._m[2]=r,this._m[3]=a,this}getTranslation(){return{x:this._m[4],y:this._m[5]}}skew(t,e){let n=this._m[0]+this._m[2]*e,i=this._m[1]+this._m[3]*e,s=this._m[2]+this._m[0]*t,o=this._m[3]+this._m[1]*t;return this._m[0]=n,this._m[1]=i,this._m[2]=s,this._m[3]=o,this}multiply(t){let e=this._m[0]*t._m[0]+this._m[2]*t._m[1],n=this._m[1]*t._m[0]+this._m[3]*t._m[1],i=this._m[0]*t._m[2]+this._m[2]*t._m[3],s=this._m[1]*t._m[2]+this._m[3]*t._m[3],o=this._m[0]*t._m[4]+this._m[2]*t._m[5]+this._m[4],r=this._m[1]*t._m[4]+this._m[3]*t._m[5]+this._m[5];return this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=s,this._m[4]=o,this._m[5]=r,this}invert(){let t=1/(this._m[0]*this._m[3]-this._m[1]*this._m[2]),e=this._m[3]*t,n=-this._m[1]*t,i=-this._m[2]*t,s=this._m[0]*t,o=t*(this._m[2]*this._m[5]-this._m[3]*this._m[4]),r=t*(this._m[1]*this._m[4]-this._m[0]*this._m[5]);return this._m[0]=e,this._m[1]=n,this._m[2]=i,this._m[3]=s,this._m[4]=o,this._m[5]=r,this}getMatrix(){return this._m}getMatrixByAccurate(t=3){return this._m.map((e=>ia(e,t)))}setAbsolutePosition(t){let e=this._m[0],n=this._m[1],i=this._m[2],s=this._m[3],o=this._m[4],r=this._m[5],a=(e*(t.y-r)-n*(t.x-o))/(e*s-n*i),l=(t.x-o-i*a)/e;return this.translate(l,a)}decompose(){let t=this._m[0],e=this._m[1],n=this._m[2],i=this._m[3],s=t*i-e*n,o={x:this._m[4],y:this._m[5],angle:0,scaleX:0,scaleY:0,skewX:0,skewY:0};if(0!==t||0!==e){let r=Math.sqrt(t*t+e*e);o.angle=e>0?Math.acos(t/r):-Math.acos(t/r),o.scaleX=r,o.scaleY=s/r,o.skewX=(t*n+e*i)/s,o.skewY=0}else if(0!==n||0!==i){let r=Math.sqrt(n*n+i*i);o.angle=Math.PI/2-(i>0?Math.acos(-n/r):-Math.acos(n/r)),o.scaleX=s/r,o.scaleY=r,o.skewX=0,o.skewY=(t*n+e*i)/s}return o.angle=o.angle*jr,o}makeBoundingBoxFromPoints(t){if(this)for(let r=0;r<t.length;r++)t[r]=this.applyPoint(t[r]);const e=[t[0].x,t[1].x,t[2].x,t[3].x],n=Math.min(...e),i=Math.max(...e)-n,s=[t[0].y,t[1].y,t[2].y,t[3].y],o=Math.min(...s);return{left:n,top:o,width:i,height:Math.max(...s)-o,points:t}}composeMatrix(t){const e=new Ta([1,0,0,1,t.left||0,t.top||0]);return t.angle&&e.rotate(t.angle),(1!==t.scaleX||1!==t.scaleY||t.skewX||t.skewY||t.flipX||t.flipY)&&e.multiply(this._calcDimensionsMatrix(t)),this._m=e.getMatrix(),this}clone(){return new Ta([...this._m])}_calcDimensionsMatrix(t){var e,n;const i=null!=(e=t.scaleX)?e:1,s=null!=(n=t.scaleY)?n:1,o=new Ta([t.flipX?-i:i,0,0,t.flipY?-s:s,0,0]);return t.skewX&&o.multiply(new Ta([1,0,Math.tan(Qr(t.skewX)),1,0,0])),t.skewY&&o.multiply(new Ta([1,Math.tan(Qr(t.skewY)),0,1,0,0])),o}}function va(t,e,n){let i=0,s=0,o=0,r=0;const{startX:a,startY:l,endX:h,endY:c}=n;e===Tr.TOP?(i=a,s=l,o=h,r=l):e===Tr.BOTTOM?(i=a,s=c,o=h,r=c):e===Tr.LEFT?(i=a,s=l,o=a,r=c):e===Tr.RIGHT&&(i=h,s=l,o=h,r=c),t.beginPath(),t.moveTo(i,s),t.lineTo(o,r),t.stroke()}function Ea(t,e){e===Yt.HAIR?t.setLineDash([1,2]):e===Yt.DASH_DOT_DOT||e===Yt.MEDIUM_DASH_DOT_DOT?t.setLineDash([2,2,5,2,2]):e===Yt.DASH_DOT||e===Yt.MEDIUM_DASH_DOT||e===Yt.SLANT_DASH_DOT?t.setLineDash([2,5,2]):e===Yt.DOTTED?t.setLineDash([2]):e===Yt.DASHED||e===Yt.MEDIUM_DASHED?t.setLineDash([3]):t.setLineDash([0])}function ba(t){let e=1;return t===Yt.MEDIUM||t===Yt.MEDIUM_DASH_DOT||t===Yt.MEDIUM_DASHED||t===Yt.MEDIUM_DASH_DOT_DOT?e=2:t===Yt.THICK&&(e=3),e}function Ia(t,e,n,i,s=ma.create(0,0)){const o=t.add(e).rotateByPoint(i),r=i-n;return o.subtract(e).rotateByPoint(r,o).add(s).transformCoordinateOnRotate(r)}function Ca(t){return t>0?Er.DOWN:Er.UP}function Sa(t,e,n){const i=[];let s=0,o=0,r=0,a=0,l=0;const h=Ca(n),c=t.length;n=Math.abs(n);const d=Math.tan(n),u=Math.sin(n),g=Math.cos(n);if(h===Er.UP){let n=0;for(let s=0;s<c;s++){const a=t[s],{lineHeight:h=0}=a;n+=0===s?0:h;const c=(h/d+e)*u;i.push(n/d),c>o&&(o=c),0===s&&(r+=h*u,l+=h*g)}r+=n/u+e*g,l-=o}else{let n=0,l=-1;const h=[];for(let i=c-1;i>=0;i--){const s=t[i],{lineHeight:a=0}=s,_=a/d,p=(e+_)*u;h.unshift(a/d),p>o&&(o=p,n=_,l=i),r+=0===i?a*u:i===c-1?e*g+a/u:a/u}let _=t[l].lineHeight||0,p=0;for(let e=l+1;e<=c-1;e++){const n=t[e],{lineHeight:s=0}=n;_+=s,p+=h[e]||0,i[e]=-p}p=0;for(let e=l-1;e>=0;e--){const n=t[e],{lineHeight:o=0}=n;p+=h[e+1]||0,i[e]=p,s+=o}i[l]=0,1===c&&(r+=e*g),a=_/u-n*g}return{rotateTranslateXList:i,rotatedHeight:o,rotatedWidth:r,fixOffsetX:a,fixOffsetY:l,rotateTranslateY:s}}const Aa=[new ma(0,0),new ma(1,1)];class wa{constructor(t=Aa){this._lines=t}intersection(t){if(this._lines.length<1||t.length<1)return;const e=[];for(let n=1;n<this._lines.length;n++){const i=this._lines[n-1],s=this._lines[n];for(let o=1;o<t.length;o++){const t=this._lines[n-1],o=this._lines[n],r=this._intersection({from:i,to:s},{from:t,to:o});r&&e.push(r)}}return e}_intersection(t,e){const n=t.from,i=t.to,s=e.from,o=e.to;let r=(n.x-s.x)*(i.y-s.y)-(n.y-s.y)*(i.x-s.x),a=(n.x-o.x)*(i.y-o.y)-(n.y-o.y)*(i.x-o.x);if(r*a>=0)return!1;let l=(s.x-n.x)*(o.y-n.y)-(s.y-n.y)*(o.x-n.x);if(l*(l+r-a)>=0)return!1;let h=l/(a-r),c=h*(i.x-n.x),d=h*(i.y-n.y);return new ma(n.x+c,n.y+d)}}function Ra(t,e,n,i,s,o){if(!o)return[];const r=o.getPluginManager().getPluginByName("documentCustomBlock");return r?r.dealWidthCustomBlock(t,e,n,i,s):[]}const Na=["top","left","width","height","angle","scaleX","scaleY","skewX","skewY","flipX","flipY","strokeWidth"];class ya{constructor(t){this.isInGroup=!1,this.onTransformChangeObservable=new y,this.onPointerDownObserver=new y,this.onPointerMoveObserver=new y,this.onPointerUpObserver=new y,this.onDblclickObserver=new y,this.onMouseWheelObserver=new y,this.onPointerOutObserver=new y,this.onPointerLeaveObserver=new y,this.onPointerOverObserver=new y,this.onPointerEnterObserver=new y,this.onIsAddedToParentObserver=new y,this.onDisposeObserver=new y,this._dirty=!0,this._top=0,this._topOrigin=0,this._left=0,this._leftOrigin=0,this._width=0,this._widthOrigin=0,this._height=0,this._heightOrigin=0,this._angle=0,this._scaleX=1,this._scaleY=1,this._skewX=0,this._skewY=0,this._flipX=!1,this._flipY=!1,this._strokeWidth=0,this._zIndex=0,this._evented=!0,this._visible=!0,this._debounceParentDirty=!0,this._transform=new Ta,this._cursor=_r.DEFAULT,this._isTransformer=!1,this._forceRender=!1,this._oKey=t||((t="obj",e=4)=>{let n=window.navigator.userAgent.replace(/[^a-zA-Z0-9]/g,"").split(""),i="";for(let s=0;s<e;s++)i+=n[Math.round(Math.random()*(n.length-1))];return`${t}_${i}_${(new Date).getTime()}`})()}get transform(){return this._transform}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get widthOrigin(){return this._widthOrigin}get heightOrigin(){return this._heightOrigin}get classType(){return Ir.BASE_OBJECT}get top(){return this._top}get left(){return this._left}get width(){return this._width}get height(){return this._height}get strokeWidth(){return this._strokeWidth}get angle(){return this._angle}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){var t;let e=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1;return this.scaleX*e}get ancestorScaleY(){var t;let e=(null==(t=this.getParent())?void 0:t.ancestorScaleY)||1;return this.scaleY*e}get skewX(){return this._skewX}get skewY(){return this._skewY}get flipX(){return this._flipX}get flipY(){return this._flipY}get parent(){return this._parent}get oKey(){return this._oKey}get zIndex(){return this._zIndex}get evented(){return this._evented}get visible(){return this._visible}get debounceParentDirty(){return this._debounceParentDirty}get isTransformer(){return this._isTransformer}get cursor(){return this._cursor}set transform(t){this._transform=t}set zIndex(t){this._zIndex=t}set parent(t){this._parent=t}set evented(t){this._evented=t}set debounceParentDirty(t){this._debounceParentDirty=t}set isTransformer(t){this._isTransformer=t}set cursor(t){this.setCursor(t)}set top(t){var e;this._topOrigin=t,this._top=$r(t,null==(e=this._parent)?void 0:e.height)}set left(t){var e;this._leftOrigin=t,this._left=$r(t,null==(e=this._parent)?void 0:e.width)}set width(t){var e;this._widthOrigin=t,this._width=$r(t,null==(e=this._parent)?void 0:e.width)}set height(t){var e;this._heightOrigin=t,this._height=$r(t,null==(e=this._parent)?void 0:e.height)}set strokeWidth(t){this._strokeWidth=t}set angle(t){this._angle=t}set scaleX(t){this._scaleX=t}set scaleY(t){this._scaleY=t}set skewX(t){this._skewX=t}set flipY(t){this._flipY=t}set flipX(t){this._flipX=t}set skewY(t){this._skewY=t}makeDirty(t=!0){return this._dirty=t,t&&(window.clearTimeout(this.__debounceParentTimeout),this.__debounceParentTimeout=window.setTimeout((()=>{var e;null==(e=this.parent)||e.makeDirty(t)}),0)),this}makeDirtyNoDebounce(t=!0){var e;return this._dirty=t,t&&(null==(e=this.parent)||e.makeDirty(t)),this}isDirty(){return this._dirty}translate(t,e){const n=this.top;void 0!==e&&(this.top=e);const i=this.left;return void 0!==t&&(this.left=t),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.translate,value:{top:this._top,left:this._left},preValue:{top:n,left:i}}),this}resize(t,e){const n=this.width;void 0!==t&&(this.width=t);const i=this.height;return void 0!==e&&(this.height=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.resize,value:{width:this._width,height:this._height},preValue:{width:n,height:i}}),this}scale(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX=t);const i=this.scaleY;return void 0!==e&&(this.scaleY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.scale,value:{scaleX:this._scaleX,scaleY:this._scaleY},preValue:{scaleX:n,scaleY:i}}),this}skew(t,e){const n=t;void 0!==t&&(this.skewX=t);const i=e;return void 0!==e&&(this.skewY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.skew,value:{skewX:this._skewX,skewY:this._skewY},preValue:{skewX:n,skewY:i}}),this}flip(t,e){const n=t;void 0!==t&&(this.flipX=t);const i=e;return void 0!==e&&(this.flipY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.flip,value:{flipX:this._flipX,flipY:this._flipY},preValue:{flipX:n,flipY:i}}),this}transformByState(t){const e=Object.keys(t),n={};if(0!==e.length)return e.forEach((e=>{void 0!==t[e]&&(n[e]=this[e],this[e]=t[e])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.all,value:t,preValue:n}),this}isRender(t){return!this._forceRender&&(t&&!this.isInGroup)}getParent(){return this._parent}getState(){return{left:this.left,top:this.top,width:this.width,height:this.height,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}hide(){this._visible=!1,this._makeDirtyMix()}show(){this._visible=!0,this._makeDirtyMix()}render(t,e){}isHit(t){const e=this._getInverseCoord(t);return e.x>=-this.strokeWidth/2&&e.x<=this.width+this.strokeWidth/2&&e.y>=-this.strokeWidth/2&&e.y<=this.height+this.strokeWidth/2}on(t,e){return this[`on${t}Observer`].add(e.bind(this))}off(t,e){this[`on${t}Observer`].remove(e)}clear(t){this[`on${t}Observer`].clear()}resizeCacheCanvas(){}scaleCacheCanvas(){}triggerPointerMove(t){var e,n;return!!(null==(e=this.onPointerMoveObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerMove(t),!1)}triggerPointerDown(t){var e,n;return!!(null==(e=this.onPointerDownObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerDown(t),!1)}triggerPointerUp(t){var e,n;return!!(null==(e=this.onPointerUpObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerUp(t),!1)}triggerDblclick(t){var e,n;return!!(null==(e=this.onDblclickObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerDblclick(t),!1)}triggerMouseWheel(t){var e,n;return!!(null==(e=this.onMouseWheelObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerMouseWheel(t),!1)}triggerPointerOut(t){var e,n;return!!(null==(e=this.onPointerOutObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerOut(t),!1)}triggerPointerLeave(t){var e,n;return!!(null==(e=this.onPointerLeaveObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerLeave(t),!1)}triggerPointerOver(t){var e;return!!this.onPointerOverObserver.notifyObservers(t)||(null==(e=this._parent)||e.triggerPointerOver(t),!1)}triggerPointerEnter(t){var e,n;return!!(null==(e=this.onPointerEnterObserver.notifyObservers(t))?void 0:e.stopPropagation)||(null==(n=this._parent)||n.triggerPointerEnter(t),!1)}dispose(){var t;this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onMouseWheelObserver.clear(),this.onPointerOutObserver.clear(),this.onPointerLeaveObserver.clear(),this.onPointerOverObserver.clear(),this.onPointerEnterObserver.clear(),this.onDblclickObserver.clear(),this.onIsAddedToParentObserver.clear(),null==(t=this.parent)||t.removeObject(this),this.onDisposeObserver.notifyObservers(this)}toJson(){const t={};return Na.forEach((e=>{this[e]&&(t[e]=this[e])})),t}getScene(){let t=this.parent;if(null!=t){if(t.classType===Ir.SCENE)return t;for(;t;){if(t.classType===Ir.SCENE)return t;t=t.getParent()}}}resetCursor(){this.setCursor(_r.DEFAULT)}setCursor(t){var e;this._cursor=t,null==(e=this.getScene())||e.setCursor(t)}getEngine(){let t=this.getParent();for(;null!=t;){if(t===Ir.ENGINE)return t;t=t.getParent()}return null}_getInverseCoord(t){return this._transform.clone().invert().applyPoint(t)}_setTransForm(){const t=Ta.create().composeMatrix({left:this.left+this.strokeWidth/2,top:this.top+this.strokeWidth/2,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY});this.transform=t,this._makeDirtyMix()}_makeDirtyMix(){this.debounceParentDirty?this.makeDirty(!0):this.makeDirtyNoDebounce(!0)}}function Oa(t){const e=t.getScene(),n=t.getViewportByCoord(e);if(!n)return{scrollX:0,scrollY:0};const i=n.getActualScroll(n.scrollX,n.scrollY);return{scrollX:i.x,scrollY:i.y}}function Da(t,e){const n=t.transform.clone().invert().applyPoint(e.tl),i=t.transform.clone().invert().applyPoint(e.tr),s=t.transform.clone().invert().applyPoint(e.bl),o=t.transform.clone().invert().applyPoint(e.br),r=[n.x,i.x,s.x,o.x],a=[n.y,i.y,s.y,o.y],l=Math.max(...r),h=Math.min(...r),c=Math.max(...a);return{minX:h,maxX:l,minY:Math.min(...a),maxY:c}}function Ma(){let t=1,e=qr().getContext("2d");return t=(window.devicePixelRatio||1)/(e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1),t<1?1:Math.ceil(10*t)/10}class xa{constructor(t){this.isCache=!1,this._pixelRatio=1,this._width=0,this._height=0,t=t||{},this._canvasEle=qr(),this._canvasEle.style.padding="0",this._canvasEle.style.margin="0",this._canvasEle.style.border="0",this._canvasEle.style.background="transparent",this._canvasEle.style.position="absolute",this._canvasEle.style.top="0",this._canvasEle.style.left="0",this._canvasEle.tabIndex=1,this._canvasEle.style.touchAction="none",this._canvasEle.style.outline="0",this._context=this._canvasEle.getContext("2d"),this.setSize(t.width,t.height,t.pixelRatio)}getCanvasEle(){return this._canvasEle}getContext(){return this._context}getPixelRatio(){return this._pixelRatio}getWidth(){return this._width}getHeight(){return this._height}setSize(t,e,n){this._pixelRatio=n||Ma(),t&&(this._width=t,this._canvasEle.width=t*this._pixelRatio,this._canvasEle.style.width=`${t}px`),e&&(this._height=e,this._canvasEle.height=e*this._pixelRatio,this._canvasEle.style.height=`${e}px`),this.getContext().setTransform(this._pixelRatio,0,0,this._pixelRatio,0,0)}setPixelRatio(t){0!==this._width&&0!==this._height&&(t<1&&(t=1),this.setSize(this._width,this._height,t))}dispose(){this.clear(),this._canvasEle.remove()}clear(){this.getContext().clearRect(0,0,this._width*this._pixelRatio,this._height*this._pixelRatio)}toDataURL(t,e){try{return this._canvasEle.toDataURL(t,e)}catch(n){try{return this._canvasEle.toDataURL()}catch(i){const{message:t}=i;return console.error(`Unable to get data URL. ${t} For more info read https://universheet.net/docs/Canvas.html.`),""}}}}class La{constructor(t=100,e=100){this.onInputChangedObservable=new y,this.renderEvenInBackground=!0,this.onBeginFrameObservable=new y,this.onEndFrameObservable=new y,this.onTransformChangeObservable=new y,this._canvas=new xa,this._scenes={},this._activeScene=null,this._renderingQueueLaunched=!1,this._activeRenderLoops=new Array,this._usingSafari="safari"===z.getBrowserType(),this._fps=60,this._deltaTime=0,this._performanceMonitor=new Yr,this.__pointer={},this.__mouseId=-1,this.__isUsingFirefox=-1!==navigator.userAgent.indexOf("Firefox"),this._canvasEle=this._canvas.getCanvasEle(),this._canvas.setSize(t,e),this._handleKeyboardAction(),this._handlePointerAction()}get width(){return this._canvas.getWidth()}get height(){return this._canvas.getHeight()}get classType(){return Ir.ENGINE}get activeScene(){return this._activeScene}get requestNewFrameHandler(){return this._requestNewFrameHandler}get frameId(){return this._frameId}getCanvas(){return this._canvas}getScenes(){return this._scenes}getScene(t){return this._scenes[t]}hasScene(t){return t in this._scenes}addScene(t){const e=t.sceneKey;return this.hasScene(e)&&console.warn("Scenes has similar key, it will be covered"),this._scenes[e]=t,t}setActiveScene(t){const e=this.getScene(t);return e&&(this._activeScene=e),e}hasActiveScene(){return null!=this._activeScene}setContainer(t){this._container=t,this._container.appendChild(this._canvasEle),this.resize()}resize(){if(!this._container)return;const{width:t,height:e}=function(t){const e=getComputedStyle(t),{borderTopWidth:n,borderLeftWidth:i,borderRightWidth:s,borderBottomWidth:o,width:r,height:a}=e;return{top:pa(n),left:pa(i),right:pa(s),bottom:pa(o),width:pa(r),height:pa(a)}}(this._container);this.resizeBySize(t,e)}resizeBySize(t,e){const n=this.width,i=this.height;this._canvas.setSize(t,e),this.onTransformChangeObservable.notifyObservers({type:Wr.resize,value:{width:t,height:e},preValue:{width:n,height:i}})}dispose(){const t=this.getScenes();Object.keys(t).forEach((e=>{t[e].dispose()}));const e=Jr();this._canvasEle.removeEventListener(`${e}move`,this._pointerMoveEvent),this._canvasEle.removeEventListener(`${e}down`,this._pointerDownEvent),this._canvasEle.removeEventListener(`${e}up`,this._pointerUpEvent),this._canvasEle.removeEventListener("blur",this._pointerBlurEvent),this._canvasEle.removeEventListener(this._getWheelEventName(),this._pointerWheelEvent),this._activeRenderLoops=[],this._canvas.dispose(),this.onBeginFrameObservable.clear(),this.onEndFrameObservable.clear(),this.onTransformChangeObservable.clear()}remainScene(t){const e=this.getScenes();if(e[t]){const n=e[t];return delete e[t],n}}runRenderLoop(t){-1===this._activeRenderLoops.indexOf(t)&&(this._activeRenderLoops.push(t),this._renderingQueueLaunched||(this._renderingQueueLaunched=!0,this._renderFunction=this._renderLoop.bind(this),this._requestNewFrameHandler=Zr(this._renderFunction)))}beginFrame(){this._measureFps(),this.onBeginFrameObservable.notifyObservers(this)}endFrame(){this._frameId++,this.onEndFrameObservable.notifyObservers(this)}getFps(){return this._fps}getDeltaTime(){return this._deltaTime}_renderFrame(){for(let t=0;t<this._activeRenderLoops.length;t++){(0,this._activeRenderLoops[t])()}}_renderLoop(){let t=!0;this.renderEvenInBackground||(t=!1),t&&(this.beginFrame(),this._renderFrame(),this.endFrame()),this._activeRenderLoops.length>0?this._requestNewFrameHandler=Zr(this._renderFunction):this._renderingQueueLaunched=!1}_measureFps(){this._performanceMonitor.sampleFrame(),this._fps=this._performanceMonitor.averageFPS,this._deltaTime=this._performanceMonitor.instantaneousFrameTime||0}_handleKeyboardAction(){this._canvasEle.addEventListener("keydown",(t=>{let e=t;e.deviceType=Br.Keyboard,e.inputIndex=t.keyCode,e.previousState=0,e.currentState=1,this.onInputChangedObservable.notifyObservers(e)})),this._canvasEle.addEventListener("keyup",(t=>{let e=t;e.deviceType=Br.Keyboard,e.inputIndex=t.keyCode,e.previousState=1,e.currentState=0,this.onInputChangedObservable.notifyObservers(e)}))}_handlePointerAction(){const t=Jr();this._pointerMoveEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[Ur.Horizontal],i=this.__pointer[Ur.Vertical],s=this.__pointer[Ur.DeltaHorizontal],o=this.__pointer[Ur.DeltaVertical];this.__pointer[Ur.Horizontal]=t.clientX,this.__pointer[Ur.Vertical]=t.clientY,this.__pointer[Ur.DeltaHorizontal]=t.movementX,this.__pointer[Ur.DeltaVertical]=t.movementY;let r=t;r.deviceType=e,n!==t.clientX&&(r.inputIndex=Ur.Horizontal,r.previousState=n,r.currentState=this.__pointer[Ur.Horizontal],this.onInputChangedObservable.notifyObservers(r)),i!==t.clientY&&(r.inputIndex=Ur.Vertical,r.previousState=i,r.currentState=this.__pointer[Ur.Vertical],this.onInputChangedObservable.notifyObservers(r)),0!==this.__pointer[Ur.DeltaHorizontal]&&(r.inputIndex=Ur.DeltaHorizontal,r.previousState=s,r.currentState=this.__pointer[Ur.DeltaHorizontal],this.onInputChangedObservable.notifyObservers(r)),0!==this.__pointer[Ur.DeltaVertical]&&(r.inputIndex=Ur.DeltaVertical,r.previousState=o,r.currentState=this.__pointer[Ur.DeltaVertical],this.onInputChangedObservable.notifyObservers(r)),this._usingSafari||-1===t.button||(r.inputIndex=t.button+2,r.previousState=this.__pointer[t.button+2],this.__pointer[t.button+2]=this.__pointer[t.button+2]?0:1,r.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(r))},this._pointerDownEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[Ur.Horizontal],i=this.__pointer[Ur.Vertical],s=this.__pointer[t.button+2];e===Br.Mouse?(-1===this.__mouseId&&(void 0===t.pointerId?this.__mouseId=this.__isUsingFirefox?0:1:this.__mouseId=t.pointerId),document.pointerLockElement||this._canvasEle.setPointerCapture(this.__mouseId)):t.pointerId&&!document.pointerLockElement&&this._canvasEle.setPointerCapture(t.pointerId),this.__pointer[Ur.Horizontal]=t.clientX,this.__pointer[Ur.Vertical]=t.clientY,this.__pointer[t.button+2]=1;let o=t;o.deviceType=e,n!==t.clientX&&(o.inputIndex=Ur.Horizontal,o.previousState=n,o.currentState=this.__pointer[Ur.Horizontal],this.onInputChangedObservable.notifyObservers(o)),i!==t.clientY&&(o.inputIndex=Ur.Vertical,o.previousState=i,o.currentState=this.__pointer[Ur.Vertical],this.onInputChangedObservable.notifyObservers(o)),o.inputIndex=t.button+2,o.previousState=s,o.currentState=this.__pointer[t.button+2],this.onInputChangedObservable.notifyObservers(o)},this._pointerUpEvent=t=>{const e=this.__getPointerType(t),n=this.__pointer[Ur.Horizontal],i=this.__pointer[Ur.Vertical],s=this.__pointer[t.button+2];this.__pointer[Ur.Horizontal]=t.clientX,this.__pointer[Ur.Vertical]=t.clientY,this.__pointer[t.button+2]=0;let o=t;o.deviceType=e,n!==t.clientX&&(o.inputIndex=Ur.Horizontal,o.previousState=n,o.currentState=this.__pointer[Ur.Horizontal],this.onInputChangedObservable.notifyObservers(o)),i!==t.clientY&&(o.inputIndex=Ur.Vertical,o.previousState=i,o.currentState=this.__pointer[Ur.Vertical],this.onInputChangedObservable.notifyObservers(o)),o.inputIndex=t.button+2,o.previousState=s,o.currentState=this.__pointer[t.button+2],e===Br.Mouse&&this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)?this._canvasEle.releasePointerCapture(this.__mouseId):t.pointerId&&this._canvasEle.hasPointerCapture(t.pointerId)&&this._canvasEle.releasePointerCapture(t.pointerId),this.onInputChangedObservable.notifyObservers(o),e!==Br.Mouse&&(this.__pointer={})},this._pointerBlurEvent=t=>{this.__mouseId>=0&&this._canvasEle.hasPointerCapture(this.__mouseId)&&(this._canvasEle.releasePointerCapture(this.__mouseId),this.__mouseId=-1),this.__pointer={}},this._pointerWheelEvent=t=>{const e=Br.Mouse;let n=this.__pointer[Ur.MouseWheelX],i=this.__pointer[Ur.MouseWheelY],s=this.__pointer[Ur.MouseWheelZ];this.__pointer[Ur.MouseWheelX]=t.deltaX||0,this.__pointer[Ur.MouseWheelY]=t.deltaY||t.wheelDelta||0,this.__pointer[Ur.MouseWheelZ]=t.deltaZ||0;let o=t;o.deviceType=e,0!==this.__pointer[Ur.MouseWheelX]&&(o.inputIndex=Ur.MouseWheelX,o.previousState=n,o.currentState=this.__pointer[Ur.MouseWheelX],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[Ur.MouseWheelY]&&(o.inputIndex=Ur.MouseWheelY,o.previousState=i,o.currentState=this.__pointer[Ur.MouseWheelY],this.onInputChangedObservable.notifyObservers(o)),0!==this.__pointer[Ur.MouseWheelZ]&&(o.inputIndex=Ur.MouseWheelZ,o.previousState=s,o.currentState=this.__pointer[Ur.MouseWheelZ],this.onInputChangedObservable.notifyObservers(o))},this._canvasEle.addEventListener(`${t}move`,this._pointerMoveEvent),this._canvasEle.addEventListener(`${t}down`,this._pointerDownEvent),this._canvasEle.addEventListener(`${t}up`,this._pointerUpEvent),this._canvasEle.addEventListener("blur",this._pointerBlurEvent),this._canvasEle.addEventListener(this._getWheelEventName(),this._pointerWheelEvent,!!this._getPassive()&&{passive:!1})}_getWheelEventName(){return"onwheel"in document.createElement("div")?"wheel":void 0!==document.onmousewheel?"mousewheel":"DOMMouseScroll"}_getPassive(){let t=!1;const e=()=>{};try{const n={passive:{get(){t=!0}}};this._canvasEle.addEventListener("test",e,n),this._canvasEle.removeEventListener("test",e,n)}catch(n){}return t}__getPointerType(t){let e=Br.Mouse;return("touch"===t.pointerType||"pen"===t.pointerType||t.touches)&&(e=Br.Touch),e}}const ka=class{constructor(t){this._alreadyAttached=!1,this._startingPosition=new ma(1/0,1/0),this._doubleClickOccurred=0,this._scene=t}mouseLeaveEnterHandler(t,e){var n;if(null==t)null==(n=this._currentMouseEnterPicked)||n.triggerPointerLeave(e),this._currentMouseEnterPicked=null;else if(t!==this._currentMouseEnterPicked){const n=this._currentMouseEnterPicked;this._currentMouseEnterPicked=t,null==n||n.triggerPointerLeave(e),null==t||t.triggerPointerEnter(e)}}attachControl(t=!0,e=!0,n=!0,i=!0){const s=this._scene.getEngine();s&&(this._onPointerMove=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerMove(t);this.mouseLeaveEnterHandler(e,t),this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerMoveObserver.hasObservers()&&this._scene.onPointerMoveObserver.notifyObservers(t)},this._onPointerDown=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerDown(t);this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerDownObserver.hasObservers()&&this._scene.onPointerDownObserver.notifyObservers(t)},this._onPointerUp=t=>{void 0===t.pointerId&&(t.pointerId=0);const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerPointerUp(t);this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onPointerUpObserver.hasObservers()&&this._scene.onPointerUpObserver.notifyObservers(t),this._prePointerDoubleClick(t)},this._onMouseWheel=t=>{const e=this._getCurrentObject(t.offsetX,t.offsetY),n=null==e?void 0:e.triggerMouseWheel(t);this._scene.getViewports().forEach((e=>{e.onMouseWheelObserver.hasObservers()&&e.onMouseWheelObserver.notifyObservers(t)})),this._checkDirectSceneEventTrigger(!n,e)&&this._scene.onMouseWheelObserver.hasObservers()&&this._scene.onMouseWheelObserver.notifyObservers(t)},this._onKeyDown=t=>{this._scene.onKeyDownObservable.hasObservers()&&this._scene.onKeyDownObservable.notifyObservers(t)},this._onKeyUp=t=>{this._scene.onKeyUpObservable.hasObservers()&&this._scene.onKeyUpObservable.notifyObservers(t)},this._onInputObserver=s.onInputChangedObservable.add((s=>{const o=s;s.deviceType===Br.Keyboard&&(1===s.currentState&&this._onKeyDown(o),0===s.currentState&&this._onKeyUp(o)),s.deviceType!==Br.Mouse&&s.deviceType!==Br.Touch||(t&&s.inputIndex>=Ur.LeftClick&&s.inputIndex<=Ur.RightClick&&1===s.currentState&&this._onPointerDown(o),e&&s.inputIndex>=Ur.LeftClick&&s.inputIndex<=Ur.RightClick&&0===s.currentState&&this._onPointerUp(o),!n||s.inputIndex!==Ur.Horizontal&&s.inputIndex!==Ur.Vertical&&s.inputIndex!==Ur.DeltaHorizontal&&s.inputIndex!==Ur.DeltaVertical?!i||s.inputIndex!==Ur.MouseWheelX&&s.inputIndex!==Ur.MouseWheelY&&s.inputIndex!==Ur.MouseWheelZ||this._onMouseWheel(o):this._onPointerMove(o))})),this._alreadyAttached=!0)}detachControl(){if(!this._alreadyAttached)return;const t=this._scene.getEngine();t&&(t.onInputChangedObservable.remove(this._onInputObserver),this._alreadyAttached=!1)}_getCurrentObject(t,e){var n;return null==(n=this._scene)?void 0:n.pick(ma.FromArray([t,e]))}_checkDirectSceneEventTrigger(t,e){let n=!1;null==e&&(n=!0);let i=!0;if(e&&e.classType===Ir.BASE_OBJECT){const t=e.getScene();if(t){i=t.getParent().classType!==Ir.SCENE_VIEWER}}return!this._scene.evented&&t&&i||n}_isPointerSwiping(t,e){return Math.abs(this._startingPosition.x-t)>ka.DragMovementThreshold||Math.abs(this._startingPosition.y-e)>ka.DragMovementThreshold}_prePointerDoubleClick(t){var e,n;const{clientX:i,clientY:s}=t;if(0===this._doubleClickOccurred&&(this._startingPosition.x=i,this._startingPosition.y=s),this._doubleClickOccurred+=1,this._delayedTimeout=window.setTimeout((()=>{this._resetDoubleClickParam()}),ka.DoubleClickDelay),this._doubleClickOccurred<2)return;this._isPointerSwiping(i,s)?this._resetDoubleClickParam():(null==(n=null==(e=this._scene)?void 0:e.pick(ma.FromArray([t.offsetX,t.offsetY])))||n.triggerDblclick(t),this._scene.onDblclickObserver.hasObservers()&&this._scene.onDblclickObserver.notifyObservers(t),this._resetDoubleClickParam(),console.log("_prePointerDoubleClick",t))}_resetDoubleClickParam(){this._doubleClickOccurred=0,this._startingPosition.x=1/0,this._startingPosition.y=1/0,window.clearTimeout(this._delayedTimeout)}};let Pa=ka;Pa.DragMovementThreshold=10,Pa.LongPressDelay=500,Pa.DoubleClickDelay=300,Pa.ExclusiveDoubleClickMode=!1;class Ha extends ya{constructor(t,...e){super(t),this._objects=[],this.addObjects(...e)}get classType(){return Ir.GROUP}set cursor(t){this.setCursor(t)}addObjects(...t){for(const e of t)this.addObject(e)}addObject(t){let e=t;if(na(t)){const n=this.getScene();if(e=null==n?void 0:n.getObject(t),!e)return void console.info("No object be added");e.parent=this,e.isInGroup=!0,e.groupKey=this.oKey,this._objects.push(e)}else t.parent=this,t.isInGroup=!0,t.groupKey=this.oKey,this._objects.push(t)}removeObject(t){const e=this.getObjects(),n=e.length;if(na(t))for(let i=0;i<n;i++){const n=e[i];if(n.oKey===t)return e.splice(i,1),void this.parent.removeObject(n)}else for(let i=0;i<n;i++){const n=e[i];if(n===t)return e.splice(i,1),void this.parent.removeObject(n)}}getObjectsByOrder(){const t=[];this._objects.sort(ci);for(let e of this._objects)!e.isInGroup&&e.visible&&t.push(e);return t}getObjects(){return this._objects}render(t,e){t.save();const n=this.transform.getMatrix();t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._objects.sort(ci);for(let i of this._objects)i.render(t,this._transformBounds(e));t.restore()}resize(t,e){return this}scale(t,e){return this}skew(t,e){return this}flip(t,e){return this}isHit(t){return!0}pick(t){}dispose(){this.getObjects().forEach((t=>{t.dispose()})),super.dispose()}_transformBounds(t){return t}}class Ba{constructor(t,e,n=.05,i=.05){this._scene=t,this._padding=e,this._smoothRatioX=n,this._smoothRatioY=i,this._offsetX=0,this._offsetY=0,this._moveX=0,this._moveY=0,this._scrollX=0,this._scrollY=0,this._padding||(this._padding={t:20,b:20,l:46,r:60})}static create(t,e){return new Ba(t,e)}startScroll(t,e){this._offsetX=t,this._offsetY=e,this._moveX=t,this._moveY=e,this._viewport=this.getViewportByCoord(this._scene),this._runRenderLoop()}_scroll(t){const e=(null==t?void 0:t.top)||0,n=e+((null==t?void 0:t.height)||0),i=(null==t?void 0:t.left)||0,s=i+((null==t?void 0:t.width)||0),{t:o=0,b:r=0,r:a=0,l:l=0}=this._padding;let h=0,c=0;this._moveX<i+l&&(h=(this._moveX-i-l)*this._smoothRatioX),this._moveX>s-a&&(h=(this._moveX-s+a)*this._smoothRatioX),this._moveY<e+o&&(c=(this._moveY-e-o)*this._smoothRatioY),this._moveY>n-r&&(c=(this._moveY-n+r)*this._smoothRatioY);const d=null==t?void 0:t.scrollBy({x:h,y:c}),u=null==t?void 0:t.getActualScroll(h,c);if(this._scrollX=(null==u?void 0:u.x)||0,this._scrollY=(null==u?void 0:u.y)||0,d){const e=this._findAncestorScene(null==t?void 0:t.scene),n=this.getViewportByCoord(e);n&&this._scroll(n)}}scrolling(t,e,n){this._moveX=t,this._moveY=e,this._scrollFunction=n}stopScroll(){var t,e;t=this._requestNewFrameNumber,e||(e=window),e.requestPostAnimationFrame?e.cancelPostAnimationFrame(t):e.requestAnimationFrame?e.cancelAnimationFrame(t):e.msRequestAnimationFrame?e.msCancelAnimationFrame(t):e.webkitRequestAnimationFrame?e.webkitCancelAnimationFrame(t):e.mozRequestAnimationFrame?e.mozCancelAnimationFrame(t):e.oRequestAnimationFrame?e.oCancelAnimationFrame(t):window.clearTimeout(t)}getViewportByCoord(t){return null==t?void 0:t.getActiveViewportByRelativeCoord(ma.FromArray([this._offsetX,this._offsetY]))}getScene(){return this._scene}_runRenderLoop(){this._scroll(this._viewport),this._scrollFunction&&this._scrollFunction(this._scrollX,this._scrollY),this._requestNewFrameNumber=Zr(this._runRenderLoop.bind(this))}_findAncestorScene(t){let e=null==t?void 0:t.getParent();for(;e;){if(e.classType===Ir.SCENE)return e;e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent())}}}const Fa=["hoverCursor","moveCursor","fillRule","globalCompositeOperation","allowCache","paintFirst","stroke","strokeScaleEnabled","fill","fillAfterStrokeEnabled","hitStrokeWidth","strokeLineJoin","strokeLineCap","shadowColor","shadowBlur","shadowOffset","shadowOffsetX","shadowOffsetY","shadowOpacity","shadowEnabled","shadowForStrokeEnabled","strokeDashArray","strokeDashOffset","strokeMiterLimit"];class Ua extends ya{constructor(t,e){super(t),this._moveCursor=null,this._fillRule="nonzero",this._globalCompositeOperation="source-over",this._allowCache=!1,this._allowCache&&(this._cacheCanvas=new xa,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._initialProps(e)}get hoverCursor(){return this._hoverCursor}get moveCursor(){return this._moveCursor}get fillRule(){return this._fillRule}get globalCompositeOperation(){return this._globalCompositeOperation}get allowCache(){return this._allowCache}get paintFirst(){return this._paintFirst}get stroke(){return this._stroke}get strokeScaleEnabled(){return this._strokeScaleEnabled}get fill(){return this._fill}get fillAfterStrokeEnabled(){return this._fillAfterStrokeEnabled}get hitStrokeWidth(){return this._hitStrokeWidth}get strokeLineJoin(){return this._strokeLineJoin}get strokeLineCap(){return this._strokeLineCap}get shadowColor(){return this._shadowColor}get shadowBlur(){return this._shadowBlur}get shadowOffset(){return this._shadowOffset}get shadowOffsetX(){return this._shadowOffsetX}get shadowOffsetY(){return this._shadowOffsetY}get shadowOpacity(){return this._shadowOpacity}get shadowEnabled(){return this._shadowEnabled}get shadowForStrokeEnabled(){return this._shadowForStrokeEnabled}get strokeDashArray(){return this._strokeDashArray}get strokeDashOffset(){return this._strokeDashOffset}get strokeMiterLimit(){return this._strokeMiterLimit}static drawWith(t,e){}static _renderPaintInOrder(t,e){"stroke"===e.paintFirst?(this._renderStroke(t,e),this._renderFill(t,e)):(this._renderFill(t,e),this._renderStroke(t,e))}static _renderFill(t,e){e.fill&&(t.save(),this.__setFillStyles(t,e),"evenodd"===e.fillRule?t.fill("evenodd"):t.fill(),t.restore())}static _renderStroke(t,e){let{stroke:n,strokeWidth:i,shadowEnabled:s,shadowForStrokeEnabled:o,strokeScaleEnabled:r,scaleX:a,scaleY:l,parent:h}=e;if(n&&0!==i){if(s&&!o&&this.__removeShadow(t),t.save(),r&&h){let e=this.__getObjectScaling();t.scale(1/e.scaleX,1/e.scaleY)}else r&&(a=null!=a?a:1,l=null!=l?l:1,t.scale(1/a,1/l));this.__setLineDash(t),this.__setStrokeStyles(t,e),t.stroke(),t.restore()}}static __getObjectScaling(){return{scaleX:1,scaleY:1}}static __removeShadow(t){}static __setFillStyles(t,e){t.fillStyle=e.fill}static __setStrokeStyles(t,e){const{strokeWidth:n,strokeLineCap:i,strokeDashOffset:s,strokeLineJoin:o,strokeMiterLimit:r,stroke:a}=e;t.lineWidth=n,t.lineCap=i,t.lineDashOffset=s,t.lineJoin=o,t.miterLimit=r,t.strokeStyle=a}static __setLineDash(t){}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:t,maxX:n,minY:i,maxY:s}=Da(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<i||s<0)return this}const n=this.transform.getMatrix();if(t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const t=this._cacheCanvas.getContext();this._cacheCanvas.clear(),t.save(),t.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(t),t.restore()}this._applyCache(t)}else this._draw(t);return t.restore(),this.makeDirty(!1),this}setProps(t){if(!t)return;const e=Object.keys(t);return 0!==e.length?(e.forEach((e=>{if(void 0===t[e])return!0;-1===Na.indexOf(e)&&(this[`_${e}`]=t[e])})),this.makeDirty(!0),this):void 0}resizeCacheCanvas(){var t;null==(t=this._cacheCanvas)||t.setSize(this.width+this.strokeWidth,this.height+this.strokeWidth),this.makeDirty(!0)}scaleCacheCanvas(){var t,e,n;let i=(null==(t=this.getParent())?void 0:t.ancestorScaleX)||1,s=(null==(e=this.getParent())?void 0:e.ancestorScaleX)||1;null==(n=this._cacheCanvas)||n.setPixelRatio(Math.max(i,s)*Ma()),this.makeDirty(!0)}toJson(){const t={};return Fa.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}_applyCache(t){if(!t||!this._cacheCanvas)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,i=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,i,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}_draw(t){}_initialProps(t){if(!t)return;const e=Object.keys(t);if(0===e.length)return;const n={};let i=!1;e.forEach((e=>{if(void 0===t[e])return!0;Na.indexOf(e)>-1?(n[e]=t[e],i=!0):this[`_${e}`]=t[e]})),i&&this.transformByState(n),this.makeDirty(!0)}}const za=["radius"];class Wa extends Ua{constructor(t,e){super(t,e),(null==e?void 0:e.radius)&&(this._radius=null==e?void 0:e.radius)}get radius(){return this._radius}static drawWith(t,e){let{radius:n,width:i,height:s}=e;if(n=null!=n?n:0,i=null!=i?i:30,s=null!=s?s:30,t.beginPath(),e.strokeDashArray&&t.setLineDash(e.strokeDashArray),n){let e=0,o=0,r=0,a=0;e=o=r=a=Math.min(n,i/2,s/2),t.moveTo(e,0),t.lineTo(i-o,0),t.arc(i-o,o,o,3*Math.PI/2,0,!1),t.lineTo(i,s-a),t.arc(i-a,s-a,a,0,Math.PI/2,!1),t.lineTo(r,s),t.arc(r,s-r,r,Math.PI/2,Math.PI,!1),t.lineTo(0,e),t.arc(e,e,e,Math.PI,3*Math.PI/2,!1)}else t.rect(0,0,i,s);t.closePath(),this._renderPaintInOrder(t,e)}toJson(){const t={};return za.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}_draw(t){Wa.drawWith(t,this)}}const Va=["pointsGroup"];class Ya extends Ua{constructor(t,e){super(t,e),this._pointsGroup=(null==e?void 0:e.pointsGroup)||[[]],this._setFixBoundingBox(),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:i}=t;e!==Wr.resize&&e!==Wr.all||this.resizePolygon(i)}))}get pointsGroup(){return this._pointsGroup}static drawWith(t,e){let{pointsGroup:n}=e;n=null!=n?n:[[]],e.strokeDashArray&&t.setLineDash(e.strokeDashArray),t.beginPath();for(let i of n){t.moveTo(i[0].x,i[0].y);for(let e=1;e<i.length;e++){const n=i[e];t.lineTo(n.x,n.y)}}t.closePath(),this._renderPaintInOrder(t,e)}updatePointGroup(t){this._pointsGroup=t,this._setFixBoundingBox()}resizePolygon(t){const{left:e,top:n,width:i,height:s}=this._getSelfRect(),{width:o,height:r}=t;let a,l;a=o?this.width-o:0,l=r?this.height-r:0;const h=a/i,c=l/s;this.scaleX+=h,this.scaleY+=c,this.left=this.left-e*h,this.top=this.top-n*c,this._setTransForm()}toJson(){const t={};return Va.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}getState(){const{left:t,top:e,width:n,height:i}=this.getRect();return{left:t,top:e,width:n,height:i,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:t,top:e,width:n,height:i}=this._getSelfRect();return{left:t*this.scaleX+this.left,top:e*this.scaleY+this.top,width:n*this.scaleX,height:i*this.scaleY}}_draw(t){Ya.drawWith(t,this)}_setFixBoundingBox(){const{width:t,height:e,left:n,top:i}=this._getSelfRect();this.left=this.left+n,this.top=this.top+i,this.width=t,this.height=e;const s=this.pointsGroup;for(let o of s)for(let t of o)t.x-=n,t.y-=i;this._setTransForm()}_getSelfRect(){const t=this.pointsGroup;let e=t[0][0].x,n=t[0][0].x,i=t[0][0].y,s=t[0][0].y;for(let o of t)for(let t of o)e=Math.min(e,t.x),n=Math.max(n,t.x),i=Math.min(i,t.y),s=Math.max(s,t.y);return{left:e,top:i,width:n-e,height:s-i}}}class Ga{constructor(t,e){this._thumbMargin=2,this._thumbLengthRatio=1,this._thumbBackgroundColor=Kr(rr,.2),this._thumbHoverBackgroundColor=Kr(rr,.35),this._thumbActiveBackgroundColor=Kr(rr,.4),this._barSize=14,this._barBackgroundColor=Kr(ar),this._barBorder=1,this._barBorderColor=Kr([218,220,224]),this._enableHorizontal=!0,this._enableVertical=!0,this._verticalMinusMiniThumb=0,this._horizontalMinusMiniThumb=0,this._isHorizonMove=!1,this._isVerticalMove=!1,t||console.warn("Missing viewport"),this._view=t,this.setProps(e),this._initialScrollRect(),this._view.setScrollBar(this)}get limitX(){return this._horizonThumbRect.visible?this._horizontalBarWidth-this._horizontalThumbWidth:0}get limitY(){return this._verticalThumbRect.visible?this._verticalBarHeight-this._verticalThumbHeight:0}get horizontalThumbWidth(){return this._horizontalThumbWidth}get verticalThumbHeight(){return this._verticalThumbHeight}get ratioScrollX(){return void 0===this._horizontalThumbWidth||void 0===this._horizontalBarWidth?1:(this._horizontalThumbWidth-this._horizontalMinusMiniThumb)/this._horizontalBarWidth}get ratioScrollY(){return void 0===this._verticalThumbHeight||void 0===this._verticalBarHeight?1:(this._verticalThumbHeight-this._verticalMinusMiniThumb)/this._verticalBarHeight}get barSize(){return this._barSize}get barBorder(){return this._barBorder}static attachTo(t,e){return new Ga(t,e)}setProps(t){if(!t)return;const e=Object.keys(t);0!==e.length&&e.forEach((e=>{void 0!==t[e]&&(this[`_${e}`]=t[e])}))}render(t,e=0,n=0){let{scrollX:i,scrollY:s}=this._view;t.save();const o=new Ta([1,0,0,1,e,n]).getMatrix();t.transform(o[0],o[1],o[2],o[3],o[4],o[5]),this._horizonBarRect.render(t),this._horizonThumbRect.translate(i).render(t),this._verticalBarRect.render(t),this._verticalThumbRect.translate(void 0,s).render(t),this._placeholderBarRect.render(t),t.restore()}resize(t=0,e=0,n=0,i=0){var s,o,r,a,l,h,c,d,u,g,_;0===t&&0===t||(this._enableHorizontal&&(this._horizontalMinusMiniThumb=0,this._horizontalBarWidth=t-this._barSize,this._horizontalThumbWidth=this._horizontalBarWidth*(this._horizontalBarWidth-this._barBorder)/n*this._thumbLengthRatio,this._horizontalThumbWidth<17&&(this._horizontalMinusMiniThumb=17-this._horizontalThumbWidth,this._horizontalThumbWidth=17),null==(s=this._horizonBarRect)||s.transformByState({left:0,top:e-this._barSize,width:this._horizontalBarWidth,height:this._barSize-this._barBorder}),this._horizontalThumbWidth>=t?null==(o=this._horizonThumbRect)||o.setProps({visible:!1}):((null==(r=this._horizonThumbRect)?void 0:r.visible)||null==(a=this._horizonThumbRect)||a.setProps({visible:!0}),null==(l=this._horizonThumbRect)||l.transformByState({left:this._view.scrollX,top:e-this._barSize+this._thumbMargin,width:this._horizontalThumbWidth,height:this._barSize-2*this._thumbMargin}))),this._enableVertical&&(this._verticalMinusMiniThumb=0,this._verticalBarHeight=e-this._barSize,this._verticalThumbHeight=this._verticalBarHeight*(this._verticalBarHeight-this._barBorder)/i*this._thumbLengthRatio,this._verticalThumbHeight<17&&(this._verticalMinusMiniThumb=17-this._verticalThumbHeight,this._verticalThumbHeight=17),null==(h=this._verticalBarRect)||h.transformByState({left:t-this._barSize,top:0,width:this._barSize-this._barBorder,height:this._verticalBarHeight}),this._verticalThumbHeight>=e?null==(c=this._verticalThumbRect)||c.setProps({visible:!1}):((null==(d=this._verticalThumbRect)?void 0:d.visible)||null==(u=this._verticalThumbRect)||u.setProps({visible:!0}),null==(g=this._verticalThumbRect)||g.transformByState({left:t-this._barSize+this._thumbMargin,top:this._view.scrollY,width:this._barSize-2*this._thumbMargin,height:this._verticalThumbHeight}))),this._enableHorizontal&&this._enableVertical&&(null==(_=this._placeholderBarRect)||_.transformByState({left:t-this._barSize,top:e-this._barSize,width:this._barSize-this._barBorder,height:this._barSize-this._barBorder})))}makeDirty(t){var e,n,i,s,o;null==(e=this._horizonBarRect)||e.makeDirty(t),null==(n=this._horizonThumbRect)||n.makeDirty(t),null==(i=this._verticalBarRect)||i.makeDirty(t),null==(s=this._verticalThumbRect)||s.makeDirty(t),null==(o=this._placeholderBarRect)||o.makeDirty(t),this.makeViewDirty(t)}makeViewDirty(t){this._view.makeDirty(t);const e=this._view.scene.getParent();e.classType===Ir.SCENE_VIEWER&&e.makeDirty(!0)}pick(t){var e,n,i,s;return(null==(e=this._horizonThumbRect)?void 0:e.isHit(t))?this._horizonThumbRect:(null==(n=this._verticalThumbRect)?void 0:n.isHit(t))?this._verticalThumbRect:(null==(i=this._horizonBarRect)?void 0:i.isHit(t))?this._horizonBarRect:(null==(s=this._verticalBarRect)?void 0:s.isHit(t))?this._verticalBarRect:null}dispose(){this._horizonBarRect.dispose(),this._horizonThumbRect.dispose(),this._verticalBarRect.dispose(),this._verticalThumbRect.dispose(),this._placeholderBarRect.dispose()}_initialScrollRect(){this._enableHorizontal&&(this._horizonBarRect=new Wa("__horizonBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._horizonThumbRect=new Wa("__horizonThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableVertical&&(this._verticalBarRect=new Wa("__verticalBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor}),this._verticalThumbRect=new Wa("__verticalThumbRect__",{radius:6,fill:this._thumbBackgroundColor})),this._enableHorizontal&&this._enableVertical&&(this._placeholderBarRect=new Wa("__placeholderBarRect__",{fill:this._barBackgroundColor,strokeWidth:this._barBorder,stroke:this._barBorderColor})),this.__initialEvent()}__initialEvent(){const t=this._mainScene||this._view.scene,e=(t,e)=>(n,i)=>{if(this._isHorizonMove||this._isVerticalMove)return;e.setProps({fill:t}),this.makeViewDirty(!0)};this._enableHorizontal&&(this._horizonThumbRect.on(hr.PointerEnter,e(this._thumbHoverBackgroundColor,this._horizonThumbRect)),this._horizonThumbRect.on(hr.PointerLeave,e(this._thumbBackgroundColor,this._horizonThumbRect)),this._horizonBarRect.on(hr.PointerDown,((t,e)=>{const n=t;this._view.scrollTo({x:n.offsetX-this._view.left-this._horizontalThumbWidth/2}),e.stopPropagation()})),this._horizonThumbRect.on(hr.PointerDown,((e,n)=>{const i=e;this._isHorizonMove=!0,this._lastX=i.offsetX,this._lastY=i.offsetY,this._horizonThumbRect.setProps({fill:this._thumbActiveBackgroundColor}),this.makeViewDirty(!0),t.disableEvent(),n.stopPropagation()})),t.on(hr.PointerMove,((t,e)=>{const n=t;this._isHorizonMove&&(this._view.scrollBy({x:n.offsetX-this._lastX}),this._lastX=n.offsetX)})),t.on(hr.PointerUp,((e,n)=>{const i=this._horizonThumbRect;this._isHorizonMove=!1,t.enableEvent(),i.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)}))),this._enableVertical&&(this._verticalThumbRect.on(hr.PointerEnter,e(this._thumbHoverBackgroundColor,this._verticalThumbRect)),this._verticalThumbRect.on(hr.PointerLeave,e(this._thumbBackgroundColor,this._verticalThumbRect)),this._verticalBarRect.on(hr.PointerDown,((t,e)=>{const n=t;this._view.scrollTo({y:n.offsetY-this._view.top-this._verticalThumbHeight/2}),e.stopPropagation()})),this._verticalThumbRect.on(hr.PointerDown,((e,n)=>{const i=e,s=this._verticalThumbRect;this._isVerticalMove=!0,this._lastX=i.offsetX,this._lastY=i.offsetY,s.setProps({fill:this._thumbActiveBackgroundColor}),t.disableEvent(),this.makeViewDirty(!0),n.stopPropagation()})),t.on(hr.PointerMove,((t,e)=>{const n=t;this._isVerticalMove&&(this._view.scrollBy({y:n.offsetY-this._lastY}),this._lastY=n.offsetY)})),t.on(hr.PointerUp,((e,n)=>{const i=this._verticalThumbRect;this._isVerticalMove=!1,t.enableEvent(),i.setProps({fill:this._thumbBackgroundColor}),this.makeViewDirty(!0)})))}}class Xa extends Ua{constructor(t,e){super(t,e),this._props=h({autoWidth:!1,autoHeight:!1},e),e.image?(this._native=e.image,this._init()):e.url&&(this._native=document.createElement("img"),this._native.src=e.url,this._native.onload=()=>{var t;null==(t=e.success)||t.call(e),this._init(),this.makeDirty(!0)},this._native.onerror=()=>{e.fail?e.fail():(this._native.src="data:image/svg+xml;base64,PHN2ZyBjbGFzcz0iaWNvbiIgdmlld0JveD0iMCAwIDEwMjQgMTAyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB3aWR0aD0iMjAwIiBoZWlnaHQ9IjIwMCI+PHBhdGggZD0iTTMwNC4xMjggNDU2LjE5MmM0OC42NCAwIDg4LjA2NC0zOS40MjQgODguMDY0LTg4LjA2NHMtMzkuNDI0LTg4LjA2NC04OC4wNjQtODguMDY0LTg4LjA2NCAzOS40MjQtODguMDY0IDg4LjA2NCAzOS40MjQgODguMDY0IDg4LjA2NCA4OC4wNjR6bTAtMTE2LjIyNGMxNS4zNiAwIDI4LjE2IDEyLjI4OCAyOC4xNiAyOC4xNnMtMTIuMjg4IDI4LjE2LTI4LjE2IDI4LjE2LTI4LjE2LTEyLjI4OC0yOC4xNi0yOC4xNiAxMi4yODgtMjguMTYgMjguMTYtMjguMTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PHBhdGggZD0iTTg4Ny4yOTYgMTU5Ljc0NEgxMzYuNzA0Qzk2Ljc2OCAxNTkuNzQ0IDY0IDE5MiA2NCAyMzIuNDQ4djU1OS4xMDRjMCAzOS45MzYgMzIuMjU2IDcyLjcwNCA3Mi43MDQgNzIuNzA0aDE5OC4xNDRMNTAwLjIyNCA2ODguNjRsLTM2LjM1Mi0yMjIuNzIgMTYyLjMwNC0xMzAuNTYtNjEuNDQgMTQzLjg3MiA5Mi42NzIgMjE0LjAxNi0xMDUuNDcyIDE3MS4wMDhoMzM1LjM2QzkyNy4yMzIgODY0LjI1NiA5NjAgODMyIDk2MCA3OTEuNTUyVjIzMi40NDhjMC0zOS45MzYtMzIuMjU2LTcyLjcwNC03Mi43MDQtNzIuNzA0em0tMTM4Ljc1MiA3MS42OHYuNTEySDg1Ny42YzE2LjM4NCAwIDMwLjIwOCAxMy4zMTIgMzAuMjA4IDMwLjIwOHYzOTkuODcyTDY3My4yOCA0MDguMDY0bDc1LjI2NC0xNzYuNjR6TTMwNC42NCA3OTIuMDY0SDE2NS44ODhjLTE2LjM4NCAwLTMwLjIwOC0xMy4zMTItMzAuMjA4LTMwLjIwOHYtOS43MjhsMTM4Ljc1Mi0xNjQuMzUyIDEwNC45NiAxMjQuNDE2LTc0Ljc1MiA3OS44NzJ6bTgxLjkyLTM1NS44NGwzNy4zNzYgMjI4Ljg2NC0uNTEyLjUxMi0xNDIuODQ4LTE2OS45ODRjLTMuMDcyLTMuNTg0LTkuMjE2LTMuNTg0LTEyLjI4OCAwTDEzNS42OCA2NTIuOFYyNjIuMTQ0YzAtMTYuMzg0IDEzLjMxMi0zMC4yMDggMzAuMjA4LTMwLjIwOGg0NzQuNjI0TDM4Ni41NiA0MzYuMjI0em01MDEuMjQ4IDMyNS42MzJjMCAxNi44OTYtMTMuMzEyIDMwLjIwOC0yOS42OTYgMzAuMjA4SDY4MC45Nmw1Ny4zNDQtOTMuMTg0LTg3LjU1Mi0yMDIuMjQgNy4xNjgtNy42OCAyMjkuODg4IDI3Mi44OTZ6IiBmaWxsPSIjZTZlNmU2Ii8+PC9zdmc+",this._init(),this.makeDirty(!0))})}static drawWith(t,e){var n;if(null==(n=e._native)?void 0:n.complete){const{width:n,height:s}=e;try{t.drawImage(e._native,0,0,n,s)}catch(i){console.error(i)}}}static create(t,e,n){return new Xa(t,{url:e,success:n})}_draw(t){Xa.drawWith(t,this)}_init(){this._props.autoWidth&&this.resize(this._native.width),this._props.autoHeight&&this.resize(void 0,this._native.height)}}const ja=["dataArray"];class Ka extends Ua{constructor(t,e){super(t,e),this.pathLength=0,this._reCalculateCache=!0,(null==e?void 0:e.data)?this._dataArray=Ka.parsePathData(e.data):(null==e?void 0:e.dataArray)&&(this._dataArray=e.dataArray);for(let n=0;n<this.dataArray.length;++n)this.pathLength+=this.dataArray[n].pathLength;this._setFixBoundingBox(),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:i}=t;if(e===Wr.resize||e===Wr.all){this._reCalculateCache=!0;const{left:t,top:e,width:n,height:s}=this._getSelfRect(),{width:o,height:r}=i;let a,l;a=o?this.width-o:0,l=r?this.height-r:0;const h=a/n,c=l/s;this.scaleX+=h,this.scaleY+=c,this.left=this.left-t*h,this.top=this.top-e*c,this._setTransForm()}}))}get dataArray(){return this._dataArray}static drawWith(t,e){const n=e.dataArray;if(n){t.beginPath();for(let e=0;e<n.length;e++){let i=n[e].command,s=n[e].points;switch(i){case"L":t.lineTo(s[0],s[1]);break;case"M":t.moveTo(s[0],s[1]);break;case"C":t.bezierCurveTo(s[0],s[1],s[2],s[3],s[4],s[5]);break;case"Q":t.quadraticCurveTo(s[0],s[1],s[2],s[3]);break;case"A":{const e=s[0],n=s[1],i=s[2],o=s[3],r=s[4],a=s[5],l=s[6],h=s[7],c=i>o?i:o,d=i>o?1:i/o,u=i>o?o/i:1;t.translate(e,n),t.rotate(l),t.scale(d,u),t.arc(0,0,c,r,r+a,!!(1-h)),t.scale(1/d,1/u),t.rotate(-l),t.translate(-e,-n);break}case"z":t.closePath()}}this._renderPaintInOrder(t,e)}}static getLineLength(t,e,n,i){return Math.sqrt((n-t)*(n-t)+(i-e)*(i-e))}static getPointOnLine(t,e,n,i,s,o,r){void 0===o&&(o=e),void 0===r&&(r=n);let a=(s-n)/(i-e+1e-8),l=Math.sqrt(t*t/(1+a*a));i<e&&(l*=-1);let h,c=a*l;if(i===e)h={x:o,y:r+c};else if((r-n)/(o-e+1e-8)===a)h={x:o+l,y:r+c};else{let d,u,g=this.getLineLength(e,n,i,s),_=(o-e)*(i-e)+(r-n)*(s-n);_/=g*g,d=e+_*(i-e),u=n+_*(s-n);let p=this.getLineLength(o,r,d,u),m=Math.sqrt(t*t-p*p);l=Math.sqrt(m*m/(1+a*a)),i<e&&(l*=-1),c=a*l,h={x:d+l,y:u+c}}return h}static getPointOnCubicBezier(t,e,n,i,s,o,r,a,l){function h(t){return t*t*t}function c(t){return 3*t*t*(1-t)}function d(t){return 3*t*(1-t)*(1-t)}function u(t){return(1-t)*(1-t)*(1-t)}return{x:a*h(t)+o*c(t)+i*d(t)+e*u(t),y:l*h(t)+r*c(t)+s*d(t)+n*u(t)}}static getPointOnQuadraticBezier(t,e,n,i,s,o,r){function a(t){return t*t}function l(t){return 2*t*(1-t)}function h(t){return(1-t)*(1-t)}return{x:o*a(t)+i*l(t)+e*h(t),y:r*a(t)+s*l(t)+n*h(t)}}static getPointOnEllipticalArc(t,e,n,i,s,o){let r=Math.cos(o),a=Math.sin(o),l=n*Math.cos(s),h=i*Math.sin(s);return{x:t+(l*r-h*a),y:e+(l*a+h*r)}}static parsePathData(t){if(!t)return[];let e=t,n=["m","M","l","L","v","V","h","H","z","Z","c","C","q","Q","t","T","s","S","a","A"];e=e.replace(new RegExp(" ","g"),",");for(let c=0,d=n.length;c<d;c++)e=e.replace(new RegExp(n[c],"g"),`|${n[c]}`);let i,s=e.split("|"),o=[],r=[],a=0,l=0,h=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:e[-+]?\d+)?)/gi;for(let c=1,d=s.length;c<d;c++){let t=s[c],e=t.charAt(0);for(t=t.slice(1),r.length=0;i=h.exec(t);)r.push(i[0]);let n=[];for(let i=0,s=r.length;i<s;i++){if("00"===r[i]){n.push(0,0);continue}let t=parseFloat(r[i]);isNaN(t)?n.push(0):n.push(t)}for(;n.length>0&&!isNaN(n[0]);){let t,i,s,r,h,c,d,u,g,_,p,m=[],f=a,T=l;switch(e){case"l":a+=n.shift()||0,l+=n.shift()||0,t="L",m.push(a,l);break;case"L":a=n.shift()||0,l=n.shift()||0,m.push(a,l);break;case"m":{let i=n.shift()||0,s=n.shift()||0;if(a+=i,l+=s,t="M",o.length>2&&"z"===o[o.length-1].command)for(let t=o.length-2;t>=0;t--)if("M"===o[t].command){a=o[t].points[0]+i,l=o[t].points[1]+s;break}m.push(a,l),e="l";break}case"M":a=n.shift()||0,l=n.shift()||0,t="M",m.push(a,l),e="L";break;case"h":a+=n.shift()||0,t="L",m.push(a,l);break;case"H":a=n.shift()||0,t="L",m.push(a,l);break;case"v":l+=n.shift()||0,t="L",m.push(a,l);break;case"V":l=n.shift()||0,t="L",m.push(a,l);break;case"C":m.push(n.shift()||0,n.shift()||0,n.shift()||0,n.shift()||0),a=n.shift()||0,l=n.shift()||0,m.push(a,l);break;case"c":m.push(a+(n.shift()||0),l+(n.shift()||0),a+(n.shift()||0),l+(n.shift()||0)),a+=n.shift()||0,l+=n.shift()||0,t="C",m.push(a,l);break;case"S":s=a,r=l,i=o[o.length-1],"C"===i.command&&(s=a+(a-i.points[2]),r=l+(l-i.points[3])),m.push(s,r,n.shift()||0,n.shift()||0),a=n.shift()||0,l=n.shift()||0,t="C",m.push(a,l);break;case"s":s=a,r=l,i=o[o.length-1],"C"===i.command&&(s=a+(a-i.points[2]),r=l+(l-i.points[3])),m.push(s,r,a+(n.shift()||0),l+(n.shift()||0)),a+=n.shift()||0,l+=n.shift()||0,t="C",m.push(a,l);break;case"Q":m.push(n.shift()||0,n.shift()||0),a=n.shift()||0,l=n.shift()||0,m.push(a,l);break;case"q":m.push(a+(n.shift()||0),l+(n.shift()||0)),a+=n.shift()||0,l+=n.shift()||0,t="Q",m.push(a,l);break;case"T":s=a,r=l,i=o[o.length-1],"Q"===i.command&&(s=a+(a-i.points[0]),r=l+(l-i.points[1])),a=n.shift()||0,l=n.shift()||0,t="Q",m.push(s,r,a,l);break;case"t":s=a,r=l,i=o[o.length-1],"Q"===i.command&&(s=a+(a-i.points[0]),r=l+(l-i.points[1])),a+=n.shift()||0,l+=n.shift()||0,t="Q",m.push(s,r,a,l);break;case"A":h=n.shift()||0,c=n.shift()||0,d=n.shift()||0,u=n.shift()||0,g=n.shift()||0,_=a,p=l,a=n.shift()||0,l=n.shift()||0,t="A",m=this.convertEndpointToCenterParameterization(_,p,a,l,u,g,h,c,d);break;case"a":h=n.shift()||0,c=n.shift()||0,d=n.shift()||0,u=n.shift()||0,g=n.shift()||0,_=a,p=l,a+=n.shift()||0,l+=n.shift()||0,t="A",m=this.convertEndpointToCenterParameterization(_,p,a,l,u,g,h,c,d)}o.push({command:t||e,points:m,start:{x:f,y:T},pathLength:this.calcLength(f,T,t||e,m)})}"z"!==e&&"Z"!==e||o.push({command:"z",points:[],start:{x:0,y:0},pathLength:0})}return o}static calcLength(t,e,n,i){let s,o,r,a,l=Ka;switch(n){case"L":return l.getLineLength(t,e,i[0],i[1]);case"C":for(s=0,o=l.getPointOnCubicBezier(0,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),a=.01;a<=1;a+=.01)r=l.getPointOnCubicBezier(a,t,e,i[0],i[1],i[2],i[3],i[4],i[5]),s+=l.getLineLength(o.x,o.y,r.x,r.y),o=r;return s;case"Q":for(s=0,o=l.getPointOnQuadraticBezier(0,t,e,i[0],i[1],i[2],i[3]),a=.01;a<=1;a+=.01)r=l.getPointOnQuadraticBezier(a,t,e,i[0],i[1],i[2],i[3]),s+=l.getLineLength(o.x,o.y,r.x,r.y),o=r;return s;case"A":{s=0;let t=i[4],e=i[5],n=i[4]+e,h=Math.PI/180;if(Math.abs(t-n)<h&&(h=Math.abs(t-n)),o=l.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],t,0),e<0)for(a=t-h;a>n;a-=h)r=l.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],a,0),s+=l.getLineLength(o.x,o.y,r.x,r.y),o=r;else for(a=t+h;a<n;a+=h)r=l.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],a,0),s+=l.getLineLength(o.x,o.y,r.x,r.y),o=r;return r=l.getPointOnEllipticalArc(i[0],i[1],i[2],i[3],n,0),s+=l.getLineLength(o.x,o.y,r.x,r.y),s}}return 0}static convertEndpointToCenterParameterization(t,e,n,i,s,o,r,a,l){let h=l*(Math.PI/180),c=Math.cos(h)*(t-n)/2+Math.sin(h)*(e-i)/2,d=-1*Math.sin(h)*(t-n)/2+Math.cos(h)*(e-i)/2,u=c*c/(r*r)+d*d/(a*a);u>1&&(r*=Math.sqrt(u),a*=Math.sqrt(u));let g=Math.sqrt((r*r*(a*a)-r*r*(d*d)-a*a*(c*c))/(r*r*(d*d)+a*a*(c*c)));s===o&&(g*=-1),isNaN(g)&&(g=0);let _=g*r*d/a,p=g*-a*c/r,m=(t+n)/2+Math.cos(h)*_-Math.sin(h)*p,f=(e+i)/2+Math.sin(h)*_+Math.cos(h)*p,T=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),v=(t,e)=>(t[0]*e[0]+t[1]*e[1])/(T(t)*T(e)),E=(t,e)=>(t[0]*e[1]<t[1]*e[0]?-1:1)*Math.acos(v(t,e)),b=E([1,0],[(c-_)/r,(d-p)/a]),I=[(c-_)/r,(d-p)/a],C=[(-1*c-_)/r,(-1*d-p)/a],S=E(I,C);return v(I,C)<=-1&&(S=Math.PI),v(I,C)>=1&&(S=0),0===o&&S>0&&(S-=2*Math.PI),1===o&&S<0&&(S+=2*Math.PI),[m,f,r,a,b,S,h,o]}toJson(){const t={};return ja.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}getState(){const{left:t,top:e,width:n,height:i}=this.getRect();return{left:t,top:e,width:n,height:i,scaleX:this.scaleX,scaleY:this.scaleY,angle:this.angle,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY}}getRect(){const{left:t,top:e,width:n,height:i}=this._getSelfRect();return{left:t*this.scaleX+this.left,top:e*this.scaleY+this.top,width:n*this.scaleX,height:i*this.scaleY}}getLength(){return this.pathLength}getPointAtLength(t){let e,n=0,i=this.dataArray.length;if(!i)return null;for(;n<i&&t>this.dataArray[n].pathLength;)t-=this.dataArray[n].pathLength,++n;if(n===i)return e=this.dataArray[n-1].points.slice(-2),{x:e[0],y:e[1]};if(t<.01)return e=this.dataArray[n].points.slice(0,2),{x:e[0],y:e[1]};let s=this.dataArray[n],o=s.points;switch(s.command){case"L":return Ka.getPointOnLine(t,s.start.x,s.start.y,o[0],o[1]);case"C":return Ka.getPointOnCubicBezier(t/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3],o[4],o[5]);case"Q":return Ka.getPointOnQuadraticBezier(t/s.pathLength,s.start.x,s.start.y,o[0],o[1],o[2],o[3]);case"A":{let e=o[0],n=o[1],i=o[2],r=o[3],a=o[4],l=o[5],h=o[6];return a+=l*t/s.pathLength,Ka.getPointOnEllipticalArc(e,n,i,r,a,h)}}return null}_draw(t){Ka.drawWith(t,this)}_setFixBoundingBox(){const{left:t,top:e,width:n,height:i}=this._getSelfRect(),s=this.width/n,o=this.height/i;this.left=this.left-t*s,this.top=this.top-e*o,this.scaleX=s,this.scaleY=o,this.width=n,this.height=i,this._setTransForm()}_getSelfRect(){if(!this._reCalculateCache)return this._selfRectCache;let t=[];this.dataArray.forEach((e=>{if("A"===e.command){let n=e.points[4],i=e.points[5],s=e.points[4]+i,o=Math.PI/180;if(Math.abs(n-s)<o&&(o=Math.abs(n-s)),i<0)for(let r=n-o;r>s;r-=o){const n=Ka.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],r,0);t.push(n.x,n.y)}else for(let r=n+o;r<s;r+=o){const n=Ka.getPointOnEllipticalArc(e.points[0],e.points[1],e.points[2],e.points[3],r,0);t.push(n.x,n.y)}}else if("C"===e.command)for(let n=0;n<=1;n+=.01){const i=Ka.getPointOnCubicBezier(n,e.start.x,e.start.y,e.points[0],e.points[1],e.points[2],e.points[3],e.points[4],e.points[5]);t.push(i.x,i.y)}else t=t.concat(e.points)}));let e,n,i=t[0],s=t[0],o=t[1],r=t[1];for(let l=0;l<t.length/2;l++)e=t[2*l],n=t[2*l+1],isNaN(e)||(i=Math.min(i,e),s=Math.max(s,e)),isNaN(n)||(o=Math.min(o,n),r=Math.max(r,n));const a={left:i,top:o,width:s-i,height:r-o};return this._selfRectCache=a,a}}function $a(t){return null==t?void 0:t[t.length-1]}function Za(t){var e;return null==(e=null==t?void 0:t.sections)?void 0:e[t.sections.length-1]}function qa(t){const e=Za(t);for(let n=0;n<e.columns.length;n++){const t=e.columns[n];if(!t.isFull)return{column:t,isLast:n===e.columns.length-1,index:n}}}function Qa(t){const e=function(t){var e;const n=null==(e=qa(t))?void 0:e.column.lines;return null==n?void 0:n[n.length-1]}(t);if(e)for(let n=0;n<e.divides.length;n++){const t=e.divides[n];if(!t.isFull)return{divide:t,isLast:n===e.divides.length-1,index:n}}}function Ja(t){const e=t.lines;if(e.length>1)return!1;return function(t){if(!t)return!0;for(let e=0;e<t.divides.length;e++){const n=t.divides[e].spanGroup.length;if(n>1)return!1;if(1===n){const n=t.divides[e].spanGroup[0],{spanType:i}=n;if(i!==Mr.TAB&&i!==Mr.LIST)return!1}}return!0}(e[e.length-1])}function tl(t,e){if(t instanceof Object){const{v:n,u:i}=t;return i===Nt.POINT?n:n*e}return t}function el(t=0,e,n=Z.LINES,i=Ue.TRUE){let s=1;return nl(n,i)&&(s=t),s*=e,s}function nl(t=Z.LINES,e=Ue.FALSE){return e===Ue.TRUE&&(t===Z.LINES_AND_CHARS||t===Z.SNAP_TO_CHARS)}function il(t,e){const{paragraphStyle:n={}}=e,{linePitch:i=15.6,gridType:s=Z.LINES,paragraphLineGapDefault:o=0}=t,{lineSpacing:r=1,spacingRule:a=ut.AUTO,snapToGrid:l=Ue.TRUE}=n;return{paragraphLineGapDefault:o,linePitch:i,gridType:s,lineSpacing:r,spacingRule:a,snapToGrid:l}}function sl(t,e=-1){t[0];let n=e;for(let i of t){const{sections:t}=i;let e=n,s=e,o=-1/0,r=0;for(let n of t){const{columns:t}=n;let e=s,i=e,a=-1/0;for(let n of t){const{lines:t}=n;let e=i,s=e,r=0,l=-1/0,h=null;for(let n of t){const{divides:t,lineHeight:e}=n;let i=s,o=i,a=0,c=0;r+=e;const d=t.length;for(let n=0;n<d;n++){const e=t[n],{spanGroup:i}=e;if(0===i.length)continue;let s=o,r=s;for(let t of i){r+=t.spanType===Mr.LIST?0:t.count||1;const i=t.bBox,{ba:s}=i;c=Math.max(c,s),n===d-1&&e.width===1/0&&(a+=t.width)}n===d-1&&(e.width===1/0?e.width=a:a+=e.width,a+=e.left),e.st=0===s?0:s+1,e.ed=r>=e.st?r:e.st,o=e.ed}n.st=0===i?0:i+1,n.ed=o>=n.st?o:n.st,n.width=a,n.asc=c,l=Math.max(l,a),n.top=((null==h?void 0:h.top)||0)+((null==h?void 0:h.lineHeight)||0),h=n,s=n.ed}n.st=0===e?0:e+1,n.ed=s>=n.st?s:n.st,n.height=r,n.width===1/0&&(n.width=l),o=Math.max(o,l),a=Math.max(a,n.height),i=n.ed}n.st=0===e?0:e+1,n.ed=i>=n.st?i:n.st,n.height=a,r+=a,s=n.ed}i.st=0===e?0:e+1,i.ed=s>=i.st?s:i.st,i.height=r,i.width=o,n=i.ed}}function ol(t){const e=t.spanGroup;let n=0;for(let i of e)n+=i.width;return n}function rl(t=[],e=tt.NONE,n=0,i=0,s=1/0,o=1/0){const r=[];let a=0,l=0;if(0===t.length)r.push(ll(i,s,0,tt.NONE));else for(let c=0;c<t.length;c++){const{width:n,paddingEnd:o}=t[c];l=o,a=n,r.push(ll(i,a,l,e)),i+=a+l,c===t.length-1&&(a=s!==1/0?s-a:n,l=0,r.push(ll(i,a,l,e)))}const h={columns:r,colCount:(null==t?void 0:t.length)||1,height:o,top:n,st:0,ed:0};return r.forEach((t=>{t.parent=h})),h}function al(t,e){t.isFull=e}function ll(t,e,n,i){return{lines:[],left:t,width:e,height:0,spaceWidth:n,separator:i,st:0,ed:0,drawingLRIds:[],isFull:!1}}function hl(t,e,n,i){return n in Y?function(t,e,n){if(n===Y.DECIMAL)return cl(t,e);if(n===Y.ZERO_DECIMAL)return function(t,e){const n=t+e;if(n<10)return`0${n}`;return n.toString()}(t,e);if(n===Y.UPPER_ALPHA)return function(t,e){return li(t+e-1,!0)}(t,e);if(n===Y.ALPHA)return function(t,e){return li(t+e-1,!1)}(t,e);if(n===Y.UPPER_ROMAN)return function(t,e){return dl(t+e,!0)}(t,e);if(n===Y.ROMAN)return function(t,e){return dl(t+e,!1)}(t,e);return cl(t,e)}(t,e,n):function(t,e,n,i){if(!i)return"";const s=i.getPluginManager().getPluginByName("documentCustomBullet");return s?s.dealWidthCustomBulletOrderedSymbol(t,e,n):""}(t,e,n,i)}function cl(t,e){return(t+e).toString()}function dl(t,e=!1){let n={m:1e3,cm:900,d:500,cd:400,c:100,xc:90,l:50,xl:40,x:10,ix:9,v:5,iv:4,i:1};e&&(n={M:1e3,CM:900,D:500,CD:400,C:100,XC:90,L:50,XL:40,X:10,IX:9,V:5,IV:4,I:1});let i="";for(let s in n)for(;t>=n[s];)i+=s,t-=n[s];return i}function ul(t,e,n,i,s){var o,r;if(!t||!e)return;const{listId:a,nestingLevel:l=0,textStyle:c}=t,d=e[a];if(!d||!d.nestingLevel)return gl(a,null==(o=null==n?void 0:n[l])?void 0:o.startIndexItem,i);if(!d.nestingLevel[l])return gl(a,null==(r=null==n?void 0:n[l])?void 0:r.startIndexItem,i);return function(t,e,n,i,s,o,r){var a,l;const c=n[e],{bulletAlignment:d,glyphFormat:u,textStyle:g,startNumber:_,glyphType:p,glyphSymbol:m,indentFirstLine:f,hanging:T,indentStart:v}=c,E=h(h({},s),g),b=oa(E,o);let I;I=m||function(t,e,n,i,s){var o;const r=t.split("%"),a=[r[0]];for(let l=1;l<r.length;l++){const t=r[l],{level:h,suffix:c}=pl(t);let d=(null==(o=null==i?void 0:i[h])?void 0:o.startIndexItem)||1;h!==e&&null!==(null==i?void 0:i[h])&&(d-=1);const u=_l(d,n[h],s);a.push(u,c)}return a.join("")}(u,e,n,i,r);const C=Ar.getTextSize(I,b),S=null!=(l=null==(a=null==i?void 0:i[e])?void 0:a.startIndexItem)?l:1;return{listId:t,symbol:I,ts:E,fontStyle:b,startIndexItem:S+1,bBox:C,nestingLevel:c,bulletAlign:d,bulletType:!m&&!!p,indentFirstLine:f,hanging:T,indentStart:v}}(a,l,d.nestingLevel,n,c,i,s)}function gl(t,e=1,n){return{listId:t,symbol:"●",ts:{ff:(null==n?void 0:n.fontList[0])||"Arial",fs:(null==n?void 0:n.defaultFontSize)||9},startIndexItem:e,bBox:{width:8.4560546875,ba:7,bd:-1,aba:7,abd:-1,sp:-2,sbr:.5,sbo:0,spr:.5,spo:0},indentFirstLine:0,hanging:21,indentStart:0}}function _l(t=1,e,n){const{startNumber:i,glyphType:s,glyphSymbol:o}=e;return o||(s?hl(t,i,s,n):"●")}function pl(t){if(""===t)return{level:0,suffix:""};const e=t.split("");let n="",i="",s=!1;const o=/[0-9]/g;return e.forEach((t=>{!s&&o.test(`${n}${t}`)?n+=t:(s=!0,i+=t)})),{level:parseInt(n)-1,suffix:i}}function ml(t,e,n){return Tl(Mr.WORD,t,e,n)}function fl(t,e,n){return Tl(Mr.LETTER,t,e,n)}function Tl(t,e,n,i){const{fontStyle:s,textStyle:o,charSpace:r=1,gridType:a=Z.LINES,snapToGrid:l=Ue.FALSE}=n,h=Ar.getTextSize(e,s),{width:c=0}=h;let d=null!=i?i:c,u=0;if(nl(a,l)){d=Math.ceil(c/r)*r,a===Z.LINES_AND_CHARS&&(u=(d-c)/2)}return{content:e,ts:o,fontStyle:s,width:d,bBox:h,paddingLeft:u,left:0,spanType:t}}function vl(t,e,n,i){return aa(t)?function(t,e,n,i){const s=[t];let o=e;for(let r=e+1;r<n.length;r++){const t=n[r];if(!aa(t))break;s.unshift(t),o=r}return{charIndex:o,spanGroup:[fl(s.join(""),i)]}}(t,e,n,i):la(t)?function(t,e,n,i){const s=[t];let o=e;for(let r=e+1;r<n.length;r++){const t=n[r];if(!la(t))break;s.push(t),o=r}return{charIndex:o,spanGroup:[ml(s.join(""),i)]}}(t,e,n,i):ra(t)?void 0:function(t,e,n,i){const{pageWidth:s=1/0}=i,o=fl(t,i),r=[o];let a=o.width,l=e;for(let h=e+1;h<n.length;h++){const t=n[h];if(ra(t)||ha(t))break;{const e=fl(t,i),n=e.width;if(a+n>s)break;r.push(e),a+=n,l=h}}return{charIndex:l,spanGroup:r}}(t,e,n,i)}var El,bl,Il,Cl,Sl,Al;function wl(t,e,n,i,s=0,o=0,r=!1,a,l,h){const{lineHeight:c=15.6,lineTop:d=0,contentHeight:u=0,paddingLeft:g=0,paddingRight:_=0,paddingTop:p=0,paddingBottom:m=0,marginTop:f=0,spaceBelowApply:T=0}=n,v=function(t,e){return{blockId:e,type:t,divides:[],lineHeight:0,contentHeight:0,top:0,asc:0,paddingTop:0,paddingBottom:0,marginTop:0,marginBottom:0,spaceBelowApply:0,divideLen:0,st:-1,ed:-1,lineIndex:0,paragraphStart:!1}}(e,t);v.lineIndex=s,v.paragraphStart=xl(o,r),v.contentHeight=u,v.top=d,v.lineHeight=c,v.paddingTop=p,v.paddingBottom=m,v.marginTop=f,v.spaceBelowApply=T,v.divides=function(t,e,n,i,s,o,r,a){const l=[];return l.push({left:0,width:i},{left:n-s,width:s}),null==r||r.forEach(((i,s)=>{const o=Nl(i,t,e,n);o&&l.push(o)})),null==a||a.forEach(((i,s)=>{const o=Nl(i,t,e,n);o&&l.push(o)})),null==o||o.forEach(((i,s)=>{const o=Nl(i,t,e,n);o&&l.push(o)})),function(t,e){e.sort(((t,e)=>t.left>e.left?1:-1));const n=[];let i=0;const s=e.length;for(let o=0;o<s;o++){const r=e[o],{left:a,width:l}=r;if(a>i){let e=a-i;e=e<t?e:t-i;const s=Ml(i,e);n.push(s)}if(i=Math.max(a+l,i),o===s-1&&a+l<t){const e=Ml(a+l,t-a-l);n.push(e)}}return n}(n,l)}(c,d,i,g,_,a,l,h);for(let E of v.divides)E.parent=v;return v}function Rl(t,e,n,i){const{aTop:s,height:o,aLeft:r,width:a,angle:l=0,drawingOrigin:h}=t,{layoutType:c,distT:d=0,distB:u=0}=h;if(c!==lt.WRAP_TOP_AND_BOTTOM)return;if(0===l){const t=s-d;if(t+(o+u)<n||t>e+n)return;return t+o}let{top:g=0,height:_=0}=yl(l,r,a,s,o);return g-=d,_+=u,g+_<n||g>e+n?void 0:g+_}function Nl(t,e,n,i){const{aTop:s,height:o,aLeft:r,width:a,angle:l=0,drawingOrigin:h}=t,{layoutType:c}=h;if(c===lt.WRAP_NONE||c===lt.WRAP_TOP_AND_BOTTOM)return;if(c===lt.WRAP_POLYGON){const{start:t=[0,0],lineTo:s}=h;if(!s)return;let o=[];o.push(new ma(t[0],t[1]));for(let e=0;e<s.length;e++){const t=s[e];o.push(new ma(t[0],t[1]))}if(0!==l){const t=(new Ta).rotate(l);for(let e=0;e<o.length;e++){const n=o[e];o[e]=t.applyPoint(n)}}return Ol(o,n,e,i)}if(0===l)return Dl(s,o,r,a,n,e,i,h);const d=yl(l,r,a,s,o);if(c===lt.WRAP_SQUARE){const{left:t,width:s,top:o,height:r}=d;return Dl(o,r,t,s,n,e,i,h)}return Ol(d.points,n,e,i)}function yl(t,e,n,i,s){const o=(new Ta).rotate(t),r=new ma(e,i),a=new ma(e,i+s),l=new ma(e+n,i),h=new ma(e+n,i+s);return o.makeBoundingBoxFromPoints([r,a,l,h])}function Ol(t,e,n,i){const s=new wa(t),o=s.intersection([new ma(0,e),new ma(i,e)]),r=s.intersection([new ma(0,e+n),new ma(i,e+n)]);if(!o&&!r)return;const a=function(t,e=0){const n=[];for(let i=0;i<t.length;i++){const s=t[i];0===e?n.push(s.x):n.push(s.y)}return{max:Math.max(...n),min:Math.min(...n)}}([...t,...o||[],...r||[]]);return{left:a.min,width:a.max}}function Dl(t,e,n,i,s,o,r,a){const{layoutType:l,wrapText:h=rt.BOTH_SIDES,distL:c=0,distR:d=0,distT:u=0,distB:g=0}=a,_=t-(l===lt.WRAP_SQUARE?u:0);if(_+(e+(l===lt.WRAP_SQUARE?g:0))<s||_>o+s)return;let p=n-c,m=i+d,f=function(t,e,n,i){let s=0;t===rt.LEFT?s=1:t===rt.RIGHT?s=2:t===rt.LARGEST&&(s=e>i-e-n?1:2);return s}(h,p,m,r);return 1===f?m=r-p:2===f&&(p=0,m=n+i+d),{left:p,width:m}}function Ml(t,e){return{spanGroup:[],width:e,left:t,paddingLeft:0,isFull:!1,st:0,ed:0}}function xl(t,e){return 0===t&&!0===e}function Ll(t,e){const n=t.parent;if(null!=n){const t=null==n.divides[0].spanGroup[0],i=e[0],s=i.content||" ";if(t&&" "===s){const t=i.width;i.width=0;for(let n of e)n!==i&&(n.left-=t)}}t.spanGroup.push(...e)}function kl(t,e,n,i,s=0,o=!1){if(xl(s,o))if(i.bulletSkeleton){const{bulletSkeleton:r,paragraphStyle:a={}}=i,{gridType:l=Z.LINES,charSpace:h=0,defaultTabStop:c=1}=n,{snapToGrid:d=Ue.TRUE}=a,u=el(h,c,l,d);!function(t,e,n){const{hanging:i,indentStart:s}=t,{hanging:o,indentStart:r}=e;void 0===i&&(t.hanging=o);void 0===s&&(t.indentStart=tl(r||0,n)-tl(o||0,n))}(a,r,u);Hl([function(t,e,n){const{bBox:i,symbol:s,ts:o,fontStyle:r,bulletAlign:a=X.START,bulletType:l=!1}=e,h=i.width,c=Math.ceil(h/n);let d=(c<2?2:c)*n,u=0;return l&&(a===X.CENTER?(u=-h/2,d-=u):a===X.END&&(u=-h,d-=u)),{content:s,ts:o,fontStyle:r,width:d,paddingLeft:0,bBox:function(t,e){const{ba:n,bd:i}=t.bBox,{ba:s,bd:o}=e.bBox;return n+i>s+o?t.bBox:e.bBox}(t,e),left:u,spanType:Mr.LIST}}(t[0],r,u),...t],e,n,i,s,o)}else Hl(t,e,n,i,s,o);else Pl(t,e,n,i,s,o);return[...e]}function Pl(t,e,n,i,s=0,o=!1,r){var a,l;const h=$a(e),c=Qa(h);if(c){const d=function(t){const e=t.length;let n=0;for(let i=0;i<e;i++){n+=t[i].width}return n}(t),u=c.divide,g=null==(a=null==u?void 0:u.spanGroup)?void 0:a[u.spanGroup.length-1],_=(null==g?void 0:g.width)||0,p=(null==g?void 0:g.left)||0,m=function(t){const{width:e,marginLeft:n,marginRight:i}=t;return e-n-i}(h);if(_+p+d>u.width){!function(t,e){t.isFull=e}(u,!0);const a=function(t){var e;const n=null==(e=t.parent)?void 0:e.parent;if(n)return n}(u);d>m?function(t){if(t.sections.length>1)return!1;const e=Za(t),n=e.columns.length;for(let i=0;i<n;i++)if(!Ja(e.columns[i]))return!1;return!0}(h)?(Ll(u,t),function(t=[]){for(let e=0;e<t.length;e++){al(t[e],!0)}}(null==(l=null==a?void 0:a.parent)?void 0:l.columns)):Fl(t,e,n,i,s,o,r):a&&d>a.width?(al(a,!0),Ja(a)?(console.log(t),Ll(u,t)):Bl(t,e,n,i,s,o,r)):c.isLast?Hl(t,e,n,i,s,o,r):Pl(t,e,n,i,s,o,r)}else{const r=u.parent,a=function(t){const e=t.length;let n,i=-1/0;for(let s=0;s<e;s++){const e=t[s],{ba:o,bd:r}=e.bBox;i<o+r&&(n={boundingBoxAscent:o,boundingBoxDescent:r}),i=o+r}return n}(t);if(r&&a){const{paragraphLineGapDefault:l,linePitch:h,lineSpacing:c,spacingRule:d,snapToGrid:u,gridType:g}=il(n,i),{boundingBoxAscent:_,boundingBoxDescent:p}=a,m=_+p,{contentHeight:f}=Ul(m,l,h,g,c,d,u);if(r.contentHeight<f){const a=function(t){const e=t.divides,n=e.length,i=[];for(let s=0;s<n;s++){const t=e[s];i.push(...t.spanGroup)}return i}(r),l=a.length;let h=[],c=1;a[0].spanType===Mr.LIST&&l>2?(h=[a[0],a[1]],c=2):h=[a[0]];const d=r.parent;null==d||d.lines.pop(),Hl(h,e,n,i,s,o,_+p);for(let t=c;t<a.length;t++)Pl([a[t]],e,n,i,s,o);return void Pl(t,e,n,i,s,o)}}!function(t,e=0){const n=t.length;let i;for(let s=0;s<n;s++){const n=t[s];n.left=i?i.left+i.width:e,i=n}}(t,_+p);for(let e of t)e.parent=u;Ll(u,t)}}else Hl(t,e,n,i,s,o,r)}function Hl(t,e,n,i,s=0,o=!1,r){var a,l,h,c,d;let u=$a(e),g=qa(u);if(g&&g.column||(Fl(t,e,n,i,s),u=$a(e),g=qa(u)),!g)return;const _=g.column,p=function(t){return t.lines[t.lines.length-1]}(_),{ba:m,bd:f}=t[0].bBox,T=r||m+f,{paragraphStyle:v={},paragraphAffectSkeDrawings:E,skeHeaders:b,skeFooters:I,blockAnchor:C,blockId:S}=i,{namedStyleType:A=ct.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:w=Ne.UNSPECIFIED,direction:R,spaceAbove:N=0,spaceBelow:y=0,borderBetween:O,borderTop:D,borderBottom:M,borderLeft:x,borderRight:L,indentFirstLine:k=0,hanging:P=0,indentStart:H=0,indentEnd:B=0,tabStops:F=[],keepLines:U=Ue.FALSE,keepNext:z=Ue.FALSE,wordWrap:W=Ue.FALSE,widowControl:V=Ue.FALSE,shading:Y}=v,{paragraphLineGapDefault:G,linePitch:X,lineSpacing:j,spacingRule:K,snapToGrid:$,gridType:q}=il(n,i),Q=xl(s,o),{paddingTop:J,paddingBottom:tt,contentHeight:et,lineSpacingApply:nt}=Ul(T,G,X,q,j,K,$),{marginTop:it,spaceBelowApply:st}=function(t=0,e=0,n=0,i,s){let o=0,r=0;if(!i)return{marginTop:o,spaceBelowApply:r};if(o=tl(e,t),r=tl(n,t),s){const{spaceBelowApply:t}=s;t>o&&(o=0,s.lineHeight+=t,s.marginBottom=t)}return{marginTop:o,spaceBelowApply:r}}(nt,N,y,Q,p),ot=it+J+et+tt;let rt=_.parent;rt||(rt=Za(u));const at=((null==p?void 0:p.lineHeight)||0)+((null==p?void 0:p.top)||0),{width:lt,headerId:ht,footerId:dt}=u,ut=null==(l=null==(a=null==b?void 0:b.get(ht))?void 0:a.get(lt))?void 0:l.skeDrawings,gt=null==(c=null==(h=null==I?void 0:I.get(dt))?void 0:h.get(lt))?void 0:c.skeDrawings;!function(t,e,n,i,s){var o;if(!s)return;const r=null==(o=n.parent)?void 0:o.parent;if(!r)return;const a=new Map,l=function(t){const e=t.parent;if(!e)return!1;const n=null==e?void 0:e.columns;if(!n)return!1;for(let i=n.length-1;i>=0;i--){const t=n[i].lines,e=t.length;if(!(e<=0))for(let n=e-1;n>=0;n--){if(t[n].paragraphStart)return!1}}return!0}(n);s.forEach((s=>{if(!s)return;const{initialState:o,drawingOrigin:h}=s;if(o||!h)return;const{objectProperties:c}=h,{positionH:d,positionV:u,size:g,angle:_}=c,{width:p=0,height:m=0}=g;s.aLeft=function(t,e,n,i,s=!1){const{relativeFrom:o,align:r,posOffset:a,percent:l}=t;if(null!=r)if(r===Ot.INSIDE||r===Ot.OUTSIDE)o===St.MARGIN||St.PAGE;else{if(o===St.COLUMN){const{width:t,left:n}=e;let s=0;return r===Ot.LEFT?s=n:r===Ot.RIGHT?s=n+t-i:r===Ot.CENTER&&(s=n+t/2-i/2),s}if(o===St.LEFT_MARGIN);else if(o===St.MARGIN);else if(o===St.RIGHT_MARGIN);else if(o===St.INSIDE_MARGIN);else if(o===St.OUTSIDE_MARGIN);else if(o===St.PAGE){const{width:t}=n;let e=0;return r===Ot.RIGHT?e=t-i:r===Ot.CENTER&&(e=t/2-i/2),e}}else{if(a){const{width:t,marginLeft:r,marginRight:l}=n,h=t-l;let c=0;return o===St.COLUMN?c=(s?0:(null==e?void 0:e.left)||0)+a:o===St.LEFT_MARGIN||(o===St.MARGIN?c=a+r:o===St.RIGHT_MARGIN||o===St.INSIDE_MARGIN||o===St.OUTSIDE_MARGIN||o===St.PAGE&&(c=a)),c+i>h&&(c=h-i),c}if(l){const{width:t,marginLeft:e,marginRight:i}=n;if(o===St.LEFT_MARGIN);else if(o===St.MARGIN);else if(o===St.RIGHT_MARGIN);else if(o===St.INSIDE_MARGIN);else if(o===St.OUTSIDE_MARGIN);else if(o===St.PAGE)return l*t}}}(d,n,r,p,l)||0,s.aTop=function(t,e,n,i,s,o,r=!1){const{relativeFrom:a,align:l,posOffset:h,percent:c}=t;if(null!=l){if(a===wt.LINE){let t=0;return l===Mt.BOTTOM?t=n+i-s:l===Mt.TOP?t=n:l===Mt.CENTER&&(t=n+i/2-s/2),t}if(a===wt.TOP_MARGIN);else if(a===wt.MARGIN);else if(a===wt.BOTTOM_MARGIN);else if(a===wt.INSIDE_MARGIN);else if(a===wt.OUTSIDE_MARGIN);else if(a===wt.PAGE){const{height:t}=e;let n=0;return l===Mt.BOTTOM?n=t-s:l===Mt.CENTER&&(n=t/2-s/2),n}}else{if(h){let t=0;return a===wt.LINE?t=n||0+h:a===wt.TOP_MARGIN||a===wt.MARGIN||a===wt.BOTTOM_MARGIN||a===wt.INSIDE_MARGIN||a===wt.OUTSIDE_MARGIN||(a===wt.PAGE?t=h:a===wt.PARAGRAPH&&(t=(r?0:null==o?n:o)+h)),t}if(c){const{height:t,marginBottom:n,marginTop:i}=e;if(a===wt.TOP_MARGIN);else if(a===wt.MARGIN);else if(a===wt.BOTTOM_MARGIN);else if(a===wt.INSIDE_MARGIN);else if(a===wt.OUTSIDE_MARGIN);else if(a===wt.PAGE)return c*t}}}(u,r,t,e,m,i,l)||0,s.width=p,s.height=m,s.angle=_,s.initialState=!0,a.set(s.objectId,s)})),r.skeDrawings=new Map([...r.skeDrawings,...a])}(at,ot,_,null==(d=null==C?void 0:C.get(S))?void 0:d.top,E);const _t=function(t=15.6,e=0,n=0,i,s,o){let r=e;return null==s||s.forEach((n=>{const i=Rl(n,t,e);i&&(r=Math.max(r,i))})),null==o||o.forEach((n=>{const i=Rl(n,t,e);i&&(r=Math.max(r,i))})),null==i||i.forEach((n=>{const i=Rl(n,t,e);i&&(r=Math.max(r,i))})),r}(ot,at,s,u.skeDrawings,ut,gt);if(ot+_t>rt.height&&_.lines.length>0&&u.sections.length>0)return al(_,!0),void Bl(t,e,n,i,s,o,r);const pt=p?p.lineIndex+1:0,{charSpace:mt,defaultTabStop:ft}=function(t,e){const{paragraphStyle:n={}}=e,{charSpace:i=0,gridType:s=Z.LINES,defaultTabStop:o=36,documentTextStyle:r={}}=t,{fs:a=gr}=r,{snapToGrid:l=Ue.TRUE}=n;return{charSpace:i,documentFontSize:a,defaultTabStop:o,gridType:s,snapToGrid:l}}(n,i),Tt=el(mt,ft,q,$),{paddingLeft:vt,paddingRight:Et,changeBulletWidth:bt}=function(t,e=0,n=0,i=0,s=0,o){const{spanType:r=Mr.LETTER,bBox:a}=t;let l=tl(e,o),h=tl(n,o),c=tl(i,o),d=tl(s,o),u=c,g=d,_={state:!1,hangingNumber:0};if(r===Mr.LIST){const{width:t}=a;l>0?u+=l:h>0&&h>t&&(_.state=!0,_.hangingNumber=h)}else u+=h;return{paddingLeft:u,paddingRight:g,changeBulletWidth:_}}(t[0],k,P,H,B,Tt);bt.state&&(t[0].width=bt.hangingNumber);const It=wl(S,Or.PARAGRAPH,{lineHeight:ot,contentHeight:et,lineTop:_t,paddingLeft:vt,paddingRight:Et,paddingTop:J,paddingBottom:tt,marginTop:it,spaceBelowApply:st},_.width,pt,s,o,u.skeDrawings,ut,gt);_.lines.push(It),It.parent=_,function(t,e,n,i){if(i)if(i.has(t)){const n=i.get(t);null==n||n.elements.push(e)}else i.set(t,{elements:[e],blockId:t,top:n})}(S,It,at,C),Pl(t,e,n,i,s,o,r)}function Bl(t,e,n,i,s=0,o=!1,r){!0===function(t){const e=Za(t),n=e.columns.length;for(let i=0;i<n;i++)if(!e.columns[i].isFull)return!1;return!0}($a(e))?Fl(t,e,n,i,s,o,r):Hl(t,e,n,i,s,o,r)}function Fl(t,e,n,i,s=0,o=!1,r){const a=$a(e),{skeHeaders:l,skeFooters:h}=i;e.push(Xl(n,{skeHeaders:l,skeFooters:h},null==a?void 0:a.pageNumber)),Bl(t,e,n,i,s,o,r)}function Ul(t,e,n,i,s,o,r){let a=e,l=e;if(i===Z.DEFAULT||r===Ue.FALSE)return o===ut.AUTO?{paddingTop:a,paddingBottom:l,contentHeight:s*t,lineSpacingApply:t}:{paddingTop:a,paddingBottom:l,contentHeight:Math.max(s,t),lineSpacingApply:s};let h=0;return h=o===ut.AUTO?s*n:s,t+2*e<h&&(a=l=(h-t)/2),{paddingTop:a,paddingBottom:l,contentHeight:t,lineSpacingApply:h}}function zl(t,e=0,n,i,s,o){const{ct:r="",ts:a={},tab:l=!1}=t,c=oa(a,o),{paragraphStyle:d={}}=s,{gridType:u=Z.LINES,charSpace:g=0,documentTextStyle:_={},defaultTabStop:p=10.5,pageSize:m={width:1/0,height:1/0},marginLeft:f=0,marginRight:T=0}=n,{namedStyleType:v=ct.NAMED_STYLE_TYPE_UNSPECIFIED,horizontalAlign:E=Ne.UNSPECIFIED,lineSpacing:b=1,spacingRule:I=ut.AUTO,snapToGrid:C=Ue.TRUE,direction:S,spaceAbove:A=0,spaceBelow:w=0,borderBetween:R,borderTop:N,borderBottom:y,borderLeft:O,borderRight:D,indentFirstLine:M=0,hanging:x=0,indentStart:L=0,indentEnd:k=0,tabStops:P=[],keepLines:H=Ue.FALSE,keepNext:B=Ue.FALSE,wordWrap:F=Ue.FALSE,widowControl:U=Ue.FALSE,shading:z}=d;let W=[i];const V=m.width||1/0-f-T,Y={fontStyle:c,textStyle:h(h({},_),a),charSpace:g,gridType:u,snapToGrid:C,pageWidth:V};if(l){const t=el(g,p,u,C);return W=kl([(G=Y,X=t,Tl(Mr.TAB," ",G,X))],W,n,s,e,!0),W}var G,X;const j=r.split("");for(let h=0;h<j.length;h++){const t=j[h],i=0===h,o=vl(t,h,j,Y);let r=[];if(o){const{charIndex:t,spanGroup:e}=o;h=t,r=e}else{const e=ml(t,Y);r.push(e)}W=kl(r,W,n,s,e,i)}return function(t,e){for(let n of t){const{sections:t}=n;for(let n of t){const{columns:t}=n;for(let n of t){const{lines:t}=n;for(let n of t)e&&ea(e)&&e(n)}}}}(W,(t=>{!function(t,e){if(e===Ne.UNSPECIFIED||e===Ne.LEFT)return;const{divides:n}=t,i=n.length;for(let s=0;s<i;s++){const t=n[s],{width:i,spanGroup:o}=t,r=ol(t);i!==1/0&&(e===Ne.CENTER?t.paddingLeft=(i-r)/2:e===Ne.RIGHT?t.paddingLeft=i-r:Ne.JUSTIFIED)}}(t,E)})),W}function Wl(t,e,n,i,s,o){const{pageNumberStart:r,pageSize:a={w:1/0,h:1/0},marginRight:l=0,marginLeft:d=0,columnProperties:u=[],columnSeparatorType:g=tt.NONE,contentDirection:_,sectionType:p,sectionTypeNext:m,textDirection:f,lists:T,drawings:v={},fontLocale:E}=i,{elements:b,paragraphStyle:I={},bullet:C}=e,{skeHeaders:S,skeFooters:A,skeListLevel:w,blockAnchor:R}=s,N={blockId:t,paragraphStyle:I,skeHeaders:S,skeFooters:A,blockAnchor:R},y=[n];let O=n;const D=new Map,M=ul(C,T,function(t,e){if(!t||!e)return;const{listId:n,nestingLevel:i}=t,s=null==e?void 0:e.get(n);let o=i;o<0&&(o=0);const r=[];for(let a=o;a>=0;a--){const t=null==s?void 0:s[a];r[a]=t||null}return r}(C,w),E,o);return function(t,e,n){if(!t||!e)return;const{listId:i,nestingLevel:s}=t,o=[...(null==n?void 0:n.get(i))||[]];o[s]=e,o.splice(s+1),null==n||n.set(i,o)}(C,M,w),N.bulletSkeleton=M,b.forEach(((t,e)=>{const{eId:n,et:i}=t;if(i===st.DRAWING){const t=v[n];t.layoutType===lt.INLINE||D.set(n,function(t){return{objectId:t.objectId,aLeft:0,aTop:0,width:0,height:0,angle:0,initialState:!1,drawingOrigin:t}}(t))}})),b.forEach(((t,e)=>{const{eId:n,et:o}=t;let r=[];if(o===st.TEXT_RUN){const{tr:n,st:s,ed:o}=t;if(!n)return!1;r=zl(n,e,i,O,c(h({},N),{paragraphAffectSkeDrawings:D}),E)}else if(o===st.PAGE_BREAK)r=[Xl(i,s,Vl(O),Nr.PAGE)],D.clear();else if(o===st.COLUMN_BREAK){const t=qa(O);t&&!t.isLast?al(t.column,!0):r=[Xl(i,s,Vl(O),Nr.COLUMN)]}O=function(t,e){const n=t.slice(-1)[0],i=e[0];if(n===i){if(1===e.length)return n;e.shift()}return t.push(...e),t.slice(-1)[0]}(y,r)})),y}function Vl(t){return t.pageNumber+1}function Yl(t,e,n,i,s,o){const r=[],a=new Map;for(let l of t){const{paragraph:t,table:h,tableOfContents:c,blockType:d,customBlock:u,blockId:g}=l;if(null==s?void 0:s.get(g))continue;let _=[],p=e;r.length>0&&(p=r[r.length-1]),d===K.PARAGRAPH&&t?_=Wl(l.blockId,t,p,n,i,o):d===K.TABLE&&h||d===K.SECTION_BREAK&&c||d===K.CUSTOM&&(_=Ra(l.blockId,u,p,n,i,o)),0===_.length&&(_=[]),Gl(r,_),a.set(g,!0)}return{pages:r,renderedBlockIdMap:a}}function Gl(t,e){t[t.length-1]===e[0]&&e.splice(0,1),t.push(...e)}function Xl(t,e,n=1,i=Nr.SECTION){var s,o,r,a;const l={sections:[],headerId:"",footerId:"",pageWidth:0,pageHeight:0,pageOrient:Pt.PORTRAIT,pageNumber:1,pageNumberStart:1,verticalAlign:!1,angle:0,width:0,height:0,marginLeft:0,marginRight:0,marginTop:0,marginBottom:0,breakType:Nr.SECTION,st:0,ed:0,skeDrawings:new Map},{pageNumberStart:h=1,pageSize:c={width:1/0,height:1/0},pageOrient:d=Pt.PORTRAIT,headerIds:u={},footerIds:g={},useFirstPageHeaderFooter:_,useEvenPageHeaderFooter:p,footers:m,headers:f,columnProperties:T=[],columnSeparatorType:v,marginTop:E=0,marginBottom:b=0,marginHeader:I=0,marginFooter:C=0,marginLeft:S=0,marginRight:A=0,renderConfig:w={}}=t,{skeHeaders:R,skeFooters:N}=e,{width:y=1/0,height:O=1/0}=c;l.pageNumber=n,l.pageNumberStart=h,l.renderConfig=w,l.marginLeft=S,l.marginRight=A,l.breakType=i,l.width=l.pageWidth=y,l.height=l.pageHeight=O,l.pageOrient=d;const{defaultHeaderId:D,evenPageHeaderId:M,firstPageHeaderId:x}=u,{defaultFooterId:L,evenPageFooterId:k,firstPageFooterId:P}=g;let H,B,F=null!=D?D:"",U=null!=L?L:"";n===h&&_?(F=null!=x?x:"",U=null!=P?P:""):n%2==0&&p&&(F=null!=M?M:"",U=null!=k?k:""),F&&((null==(s=R.get(F))?void 0:s.has(y))?H=null==(o=R.get(F))?void 0:o.get(y):f&&(H=jl(f[F],t,e),R.set(F,new Map([[y,H]]))),l.headerId=F),U&&((null==(r=N.get(U))?void 0:r.has(y))?B=null==(a=N.get(U))?void 0:a.get(y):m&&(B=jl(m[U],t,e),N.set(F,new Map([[y,B]]))),l.footerId=U),l.marginTop=Kl(E,I,H),l.marginBottom=Kl(b,C,B);const z=l.sections,W=z[z.length-1],{marginTop:V,marginBottom:Y,marginLeft:G,marginRight:X}=l,j=y-G-X,K=O-V-Y;let $=0;W&&($=W.top+W.height);const Z=rl(T,v,$,0,j,K-$);return Z.parent=l,z.push(Z),l}function jl(t,e,n,i=!0){const{body:s}=t,{lists:o,headers:r,footers:a,fontLocale:l,pageSize:d,marginLeft:u=0,marginRight:g=0,drawings:_,marginTop:p=0,marginBottom:m=0,marginHeader:f=0,marginFooter:T=0}=e,v={lists:o,headers:r,footers:a,pageSize:{width:((null==d?void 0:d.width)||1/0)-u-g,height:1/0},fontLocale:l,drawings:_},{blockElements:E}=s,b=[];E.forEach((t=>{b.push(t)}));const I=Xl(v,n),C=Yl(b,I,v,n).pages[0];sl([C]);const S=C.sections[0].columns[0],A=S.height||0,{skeDrawings:w,st:R,ed:N}=C,y={lines:S.lines,skeDrawings:w,height:A,st:R,ed:N,marginLeft:u,marginRight:g};return c(h({},y),i?{marginTop:$l(p,f,A)}:{marginBottom:Zl(m,T,A)})}function Kl(t,e,n){return n&&0!==n.lines.length?Math.max(t,e,(null==n?void 0:n.height)||0):t}function $l(t,e,n){const i=Math.max(t,e);return n>i?0:i-n}function Zl(t,e,n){const i=Math.max(t,e);return n>i?0:i-n}(bl=El||(El={}))[bl.BOTH=0]="BOTH",bl[bl.LEFT=1]="LEFT",bl[bl.RIGHT=2]="RIGHT",(Cl=Il||(Il={}))[Cl.X=0]="X",Cl[Cl.Y=1]="Y";class ql{constructor(t){this._dirty=!0,this._context=t,this._localeInitial()}get dirty(){return this._dirty}getFontLocale(){return this._fontLocale}getContext(){return this._context}makeDirty(t){this._dirty=t}_localeInitial(){if(!this._context)return;const t=this._context.getUniver().getGlobalContext().getLocale(),e=t.getObject("renderFont");e||t.load({en:or,zh:sr}),this._fontLocale=e}}(Al=Sl||(Sl={})).PENDING="pending",Al.CALCULATING="calculating",Al.READY="ready",Al.INVALID="invalid";class Ql extends ql{constructor(t,e){super(e),this.onRecalculateChangeObservable=new y,this._renderedBlockIdMap=new Map,this._documentData=t}static create(t,e){return new Ql(t,e)}updateDrawing(t,e){const n=this._documentData.drawings;if(!n)return;const i=n[t];if(!i)return;const s=i.objectProperties;s.size.width=e.width,s.size.height=e.height,s.positionH.posOffset=e.left,s.positionV.posOffset=e.top}calculate(t){this.dirty&&(this._skeletonData=this._createSkeleton(t),this.onRecalculateChangeObservable.notifyObservers(this._skeletonData))}getSkeletonData(){return this._skeletonData}getPageSize(){return this._documentData.documentStyle.pageSize}updateDocumentDataPageSize(t,e){const n=this._documentData.documentStyle;if(!n.pageSize)return t=null!=t?t:1/0,e=null!=e?e:1/0,void(n.pageSize={width:t,height:e});void 0!==t&&(n.pageSize.width=t),void 0!==e&&(n.pageSize.height=e)}__getContentMapArr(){const{body:t}=this._documentData;if(!t)return[];const{blockElements:e}=t;if(0===e.length)return[];const n=[];let i={blockElements:[],sectionBreak:void 0};return e.forEach((t=>{const{sectionBreak:e}=t;e?(i.sectionBreak=e,n.push(i),i={blockElements:[],sectionBreak:void 0}):i.blockElements.push(t)})),i.sectionBreak||(i.sectionBreak={columnProperties:[],columnSeparatorType:tt.NONE,sectionType:Q.SECTION_TYPE_UNSPECIFIED},i.blockElements.length>0&&n.push(i)),n}_createSkeleton(t){var e;const n=this.__getContentMapArr(),i={width:1/0,height:1/0},{documentStyle:s,footers:o,headers:r,lists:a,drawings:l}=this._documentData,{pageNumberStart:c=1,pageSize:d=i,pageOrient:u=Pt.PORTRAIT,defaultHeaderId:g,defaultFooterId:_,evenPageHeaderId:p,evenPageFooterId:m,firstPageHeaderId:f,firstPageFooterId:T,useFirstPageHeaderFooter:v,useEvenPageHeaderFooter:E,marginTop:b=0,marginBottom:I=0,marginRight:C=0,marginLeft:S=0,marginHeader:A=0,marginFooter:w=0,charSpace:R=0,linePitch:N=15.6,gridType:y=Z.LINES,paragraphLineGapDefault:O=0,defaultTabStop:D=10.5,textStyle:M={fs:14},renderConfig:x={horizontalAlign:Ne.UNSPECIFIED,verticalAlign:Oe.UNSPECIFIED,centerAngle:0,vertexAngle:0,wrapStrategy:Me.UNSPECIFIED}}=s,L=this.__getNullSke();if(0===n.length)return L;const k={footers:o,headers:r,lists:a,drawings:l,charSpace:R,linePitch:N,gridType:y,fontLocale:this.getFontLocale(),paragraphLineGapDefault:O,defaultTabStop:D,documentTextStyle:M},{skeHeaders:P,skeFooters:H,skeListLevel:B,blockAnchor:F}=L,U={skeHeaders:P,skeFooters:H,skeListLevel:B,blockAnchor:F},z=[];L.pages=z;for(let W=0;W<n.length;W++){const t=n[W];if(!t.sectionBreak)continue;const{pageNumberStart:i=c,pageSize:s=d,pageOrient:o=u,marginTop:r=b,marginBottom:a=I,marginRight:l=C,marginLeft:R=S,marginHeader:N=A,marginFooter:y=w,defaultHeaderId:O=g,defaultFooterId:D=_,evenPageHeaderId:M=p,evenPageFooterId:L=m,firstPageHeaderId:P=f,firstPageFooterId:H=T,useFirstPageHeaderFooter:B=v,useEvenPageHeaderFooter:F=E,columnProperties:V=[],columnSeparatorType:Y=tt.NONE,contentDirection:G,sectionType:X,textDirection:j,renderConfig:K=x}=t.sectionBreak,$=n[W+1],Z=null==(e=null==$?void 0:$.sectionBreak)?void 0:e.sectionType,q={defaultHeaderId:O,evenPageHeaderId:M,firstPageHeaderId:P},J={defaultFooterId:D,evenPageFooterId:L,firstPageFooterId:H};null===s.width&&(s.width=1/0),null===s.height&&(s.height=1/0);const et=h({pageNumberStart:i,pageSize:s,pageOrient:o,marginTop:r,marginBottom:a,marginRight:l,marginLeft:R,marginHeader:N,marginFooter:y,headerIds:q,footerIds:J,useFirstPageHeaderFooter:B,useEvenPageHeaderFooter:F,columnProperties:V,columnSeparatorType:Y,contentDirection:G,sectionType:X,sectionTypeNext:Z,textDirection:j,renderConfig:K},k);let nt=$a(z),it=!1;X===Q.CONTINUOUS?(sl(z),this.__addNewSectionByContinuous(nt,V,Y),it=!0):nt=Xl(et,U,null==nt?void 0:nt.pageNumber);const st=this.getContext(),ot=Yl(t.blockElements,nt,et,U,this._renderedBlockIdMap,st);Z===Q.CONTINUOUS&&V.length;const{pages:rt,renderedBlockIdMap:at}=ot;it&&rt.splice(0,1),z.push(...rt)}return sl(z),L}__addNewSectionByContinuous(t,e,n){const i=t.sections,s=i[i.length-1],{pageWidth:o,pageHeight:r,marginTop:a,marginBottom:l,marginLeft:h,marginRight:c}=t,d=o-h-c,u=r-a-l,g=((null==s?void 0:s.top)||0)+((null==s?void 0:s.height)||0),_=rl(e,n,g,0,d,u-g);_.parent=t,i.push(_)}__getNullSke(){return{pages:[],left:0,top:0,st:0,skeHeaders:new Map,skeFooters:new Map,skeListLevel:new Map,blockAnchor:new Map}}}class Jl extends ya{constructor(){super(...arguments),this._extensions=new Map}get extensions(){return this._extensions}register(...t){for(let e of t)e.parent=this,this._extensions.set(e.uKey,e)}unRegister(...t){for(let e of t)this._extensions.delete(e)}getExtensionsByOrder(){const t=Array.from(this._extensions.values());return t.sort(ci),t}getExtensionByKey(t){return this._extensions.get(t)}draw(t,e){}}class th extends Jl{constructor(t,e,n=!1){super(t),this._skeleton=e,this._allowCache=n,this._allowCache&&(this._cacheCanvas=new xa),this.onIsAddedToParentObserver.add((t=>{var e;null==(e=null==t?void 0:t.getEngine())||e.onTransformChangeObservable.add((t=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas()}))}getSkeleton(){return this._skeleton}setSkeleton(t){this._skeleton=t}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(!this._skeleton)return;const n=this.transform.getMatrix();t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._draw(t,e),t.restore()}getParentScale(){if(!this.parent)return{scaleX:1,scaleY:1};let{scaleX:t=1,scaleY:e=1}=this.parent;return this.parent.classType===Ir.SCENE&&(t=this.parent.ancestorScaleX||1,e=this.parent.ancestorScaleY||1),{scaleX:t,scaleY:e}}_getBounding(t){}_draw(t,e){}}class eh{constructor(){this.translateX=0,this.translateY=0}draw(t,e,n){}clearCache(){}_getScale(t){return ca(t)}}const nh=Uo.create(),ih=Uo.create(),sh=Uo.create(),oh=Uo.create();var rh,ah;(ah=rh||(rh={}))[ah.SPAN=0]="SPAN",ah[ah.LINE=1]="LINE";class lh extends eh{constructor(){super(...arguments),this.type=0,this.translateX=0,this.translateY=0}}oh.add(new class extends lh{constructor(){super(...arguments),this.uKey="DefaultDocsFontAndBaseLineExtension",this.zIndex=20,this._preFontString="",this._preFontColor=""}draw(t,e,n){var i;if(!(null==(i=n.parent)?void 0:i.parent))return;const{ts:s,content:o,fontStyle:r,bBox:a}=n;let{spanPointWithFont:l=ma.create(0,0)}=this.extensionOffset;if(!s)return void(null!=o&&t.fillText(o,l.x,l.y));if(null==o)return;this._preFontString!==(null==r?void 0:r.fontString)&&(t.font=this._preFontString=(null==r?void 0:r.fontString)||"");const{cl:h,va:c}=s,d=Hn(h)||"rgb(0,0,0)";if(d&&this._preFontColor!==d&&(t.fillStyle=d),c===Be.SUBSCRIPT||c===Be.SUPERSCRIPT){let t=a.spo;c===Be.SUPERSCRIPT&&(t=-a.sbo),l.y+=t}t.fillText(o,l.x,l.y)}clearCache(){this._preFontString="",this._preFontColor=""}});oh.add(new class extends lh{constructor(){super(...arguments),this.uKey="DefaultDocsBackgroundExtension",this.zIndex=10,this._preBackgroundColor=""}draw(t,e,n){var i;const s=null==(i=n.parent)?void 0:i.parent;if(!s)return;const{lineHeight:o=0}=s,{ts:r,width:a,content:l}=n;if(!r)return;const{bg:h}=r;if(!h)return;const c=Hn(h),{spanStartPoint:d=ma.create(0,0)}=this.extensionOffset;c&&(t.fillStyle=c,t.fillRect(d.x-.5,d.y,a+1,o))}clearCache(){this._preBackgroundColor=""}});oh.add(new class extends lh{constructor(){super(...arguments),this.uKey="DefaultDocsLineExtension",this.zIndex=40,this._preBackgroundColor=""}draw(t,e,n){var i;const s=null==(i=n.parent)?void 0:i.parent;if(!s)return;const{asc:o=0,lineHeight:r=0}=s,{ts:a,left:l,width:h,bBox:c}=n;if(!a)return;const{sp:d}=c,u=ca(e),{ul:g,st:_,ol:p}=a,{originTranslate:m=ma.create(0,0),centerPoint:f=ma.create(0,0),alignOffset:T=ma.create(0,0),renderConfig:v={}}=this.extensionOffset,{centerAngle:E=0,vertexAngle:b=0}=v;if(g){const{s:e,cl:n,t:i}=g;if(e===Ue.TRUE){t.beginPath();const e=Hn(n)||"rgb(0,0,0)";t.strokeStyle=e,this._setLineType(t,i||we.SINGLE);const s=sa(r+1-.5,u),o=Ia(m.addByPoint(l,s),f,E,b,T),a=Ia(m.addByPoint(l+h,s),f,E,b,T);t.moveTo(o.x,o.y),t.lineTo(a.x,a.y),t.stroke()}}if(_){const{s:e,cl:n,t:i}=_;if(e===Ue.TRUE){t.beginPath();const e=Hn(n)||"rgb(0,0,0)";t.strokeStyle=e,this._setLineType(t,i||we.SINGLE);const s=sa(d-.5,u),o=Ia(m.addByPoint(l,s),f,E,b,T),r=Ia(m.addByPoint(l+h,s),f,E,b,T);t.moveTo(o.x,o.y),t.lineTo(r.x,r.y),t.stroke()}}if(p){const{s:e,cl:n,t:i}=p;if(e===Ue.TRUE){t.beginPath();const e=Hn(n)||"rgb(0,0,0)";t.strokeStyle=e,this._setLineType(t,i||we.SINGLE);const s=sa(-1.5,u),o=Ia(m.addByPoint(l,s),f,E,b,T),r=Ia(m.addByPoint(l+h,s),f,E,b,T);t.moveTo(o.x,o.y),t.lineTo(r.x,r.y),t.stroke()}}}clearCache(){this._preBackgroundColor=""}_setLineType(t,e){e===we.DASH_DOT_DOT_HEAVY||e===we.DOT_DOT_DASH?t.setLineDash([2,2,5,2,2]):e===we.DASH_DOT_HEAVY||e===we.DOT_DASH?t.setLineDash([2,5,2]):e===we.DOTTED||e===we.DOTTED_HEAVY?t.setLineDash([2]):e===we.DASH||e===we.DASHED_HEAVY?t.setLineDash([3]):e===we.DASH_LONG||e===we.DASH_LONG_HEAVY?t.setLineDash([6]):t.setLineDash([0])}_getLineWidth(t){let e=1;return t===we.WAVY_HEAVY||t===we.DASHED_HEAVY||t===we.DOTTED_HEAVY||t===we.DASH_DOT_HEAVY||t===we.DASH_LONG_HEAVY||t===we.DASH_DOT_DOT_HEAVY?e=2:t===we.THICK&&(e=3),e}});oh.add(new class extends lh{constructor(){super(...arguments),this.uKey="DefaultDocsBorderExtension",this.zIndex=30,this._preBorderColor=""}draw(t,e,n){var i;const s=null==(i=n.parent)?void 0:i.parent;if(!s)return;const{asc:o=0,lineHeight:r=0}=s,{ts:a,left:l,width:h}=n;if(!a)return;const{bd:c}=a;if(!c)return;const d=this._getScale(e),u=this._createBorderCache(c),{spanStartPoint:g=ma.create(0,0)}=this.extensionOffset;for(let _ of u.keys()){const e=u.get(_);if(!e)continue;const{s:n,cl:i}=e,s=Hn(i)||"rgb(0,0,0)";n!==this._preBorderStyle&&(Ea(t,n),t.lineWidth=ba(n)/d,this._preBorderStyle=n),s!==this._preBorderColor&&(t.strokeStyle=s||"rgb(0,0,0)",this._preBorderColor=s),va(t,_,{startX:g.x,startY:g.y,endX:g.x+h,endY:g.y+r})}}clearCache(){this._preBorderStyle=null,this._preBorderColor=""}_createBorderCache(t){const{t:e,b:n,l:i,r:s}=t,o=new Map;return e&&o.set(Tr.TOP,e),n&&o.set(Tr.BOTTOM,n),i&&o.set(Tr.LEFT,i),s&&o.set(Tr.RIGHT,s),o}});class hh{constructor(){this._translateX=0,this._translateY=0,this._translateSaveList=[]}get x(){return this._translateX}get y(){return this._translateY}reset(){this.translateBy(0,0),this._translateSaveList=[]}translateBy(t=0,e=0){this._translateX=t,this._translateY=e}translate(t=0,e=0){this._translateX+=t,this._translateY+=e}translateSave(){this._translateSaveList.push({x:this._translateX,y:this._translateY})}translateRestore(){const t=this._translateSaveList.pop();t&&(this._translateX=t.x,this._translateY=t.y)}translatePagePadding(t){const{marginTop:e=0,marginBottom:n=0,marginLeft:i=0,marginRight:s=0}=t;this.translate(i,e)}restorePagePadding(t){const{marginTop:e=0,marginBottom:n=0,marginLeft:i=0,marginRight:s=0}=t;this.translate(-i,-e)}translatePage(t,e=Lr.VERTICAL,n=0,i=0,s=0,o=0){const{sections:r,marginTop:a=0,marginBottom:l=0,marginLeft:h=0,marginRight:c=0,pageWidth:d,pageHeight:u,width:g,height:_,pageNumber:p=1,renderConfig:m={}}=t;let f=0,T=0;return e===Lr.VERTICAL?f=u+i:e===Lr.HORIZONTAL&&(T=d+n),this.translate(T,f),{x:T,y:f}}translateSection(t){const{top:e=0}=t;return this.translate(0,e),{x:0,y:e}}translateColumn(t){const{left:e}=t;return this.translate(e,0),{x:e,y:0}}translateLine(t,e=!1){const{top:n,marginBottom:i=0,marginTop:s=0,paddingTop:o=0,paddingBottom:r=0}=t,a=n+(!0===e?s:0)+o;return this.translate(0,a),{x:0,y:a}}translateDivide(t){const{left:e,paddingLeft:n}=t,i=e+n;return this.translate(i,0),{x:i,y:0}}translateSpan(t){const{left:e}=t;return this.translate(e,0),{x:e,y:0}}}var ch,dh,uh,gh;(dh=ch||(ch={}))[dh.NORMAL=0]="NORMAL",dh[dh.START=1]="START",dh[dh.END=2]="END",(gh=uh||(uh={}))[gh.page=0]="page",gh[gh.section=1]="section",gh[gh.column=2]="column",gh[gh.line=3]="line",gh[gh.divide=4]="divide",gh[gh.span=5]="span";const _h={page:0,section:1,column:2,line:3,divide:4,span:5};class ph{constructor(t,e,n,i){this._scene=t,this.startNodePosition=e,this.endNodePosition=n,this.segmentId=i,this._current=!1,this._Liquid=new hh,this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}getRange(){const t=this._rangeList,e=t[0],n=t[t.length-1];let i=1===t.length&&e.isCollapse;return{cursorStart:e.cursorStart,cursorEnd:n.cursorEnd,isStartBack:e.isStartBack,isEndBack:n.isEndBack,isCollapse:i}}getRangeList(){return this._rangeList}getAnchor(){return this._anchorShape}activeStatic(){var t;null==(t=this._anchorShape)||t.setProps({stroke:Kr(rr,1)})}deactivateStatic(){var t;null==(t=this._anchorShape)||t.setProps({stroke:Kr(rr,0)})}isActive(){return!0===this._current}activate(){this._current=!0}deactivate(){this._current=!1}isEmpty(){return null==this.startNodePosition&&null==this.endNodePosition}isCollapsed(){return null!=this.startNodePosition&&null==this.endNodePosition||!!this.isSamePosition()}isRange(){const t=this.startNodePosition,e=this.endNodePosition;return null!=t&&null!=e&&!this.isSamePosition()}dispose(){var t,e;null==(t=this._rangeShape)||t.dispose(),this._rangeShape=null,null==(e=this._anchorShape)||e.dispose(),this._anchorShape=null}isIntersection(t){const e=this.getRange(),n=t.getRange(),i=this._getCursorPosition(e.cursorStart,e.isStartBack),s=this._getCursorPosition(e.cursorEnd,e.isEndBack),o=this._getCursorPosition(n.cursorStart,n.isStartBack);return!(i>this._getCursorPosition(n.cursorEnd,n.isEndBack)||s<o)}refresh(t){var e,n;const i=this.startNodePosition,s=this.endNodePosition;if(null==(e=this._anchorShape)||e.hide(),null==(n=this._rangeShape)||n.hide(),this.isEmpty())return;if(this.isCollapsed()){const e=this._getRangePointData(i,i,t),{pointGroup:n,cursorList:s}=e;return this._setRangeList(s),void(n.length>0&&this._createAndUpdateAnchor(n,t.left,t.top))}const o=this._getRangePointData(i,s,t),{pointGroup:r,cursorList:a}=o;this._setRangeList(a),r.length>0&&this._createAndUpdateRange(r,t.left,t.top)}getStart(){if(null==this.startNodePosition)return this.endNodePosition;if(null==this.endNodePosition)return this.startNodePosition;const{start:t}=this._compareNodePosition(this.startNodePosition,this.endNodePosition);return t}_resetCurrentNodePositionState(){this._currentStartState={page:0,section:0,column:0,line:0,divide:0,span:0},this._currentEndState={page:0,section:0,column:0,line:0,divide:0,span:0}}_compareNodePositionLogic(t,e){return!(t.page>e.page)&&(t.page<e.page||!(t.section>e.section)&&(t.section<e.section||!(t.column>e.column)&&(t.column<e.column||!(t.line>e.line)&&(t.line<e.line||!(t.divide>e.divide)&&(t.divide<e.divide||!(t.span>e.span)&&(t.span,e.span,!0))))))}_compareNodePosition(t,e){return this._compareNodePositionLogic(t,e)?{start:t,end:e}:{start:e,end:t}}_setNodePositionState(t=0,e,n,i){this._currentStartState[t]=i===e?1:0,this._currentEndState[t]=i===n?2:0}_checkPreviousNodePositionState(t,e=!0){let n,i=t;for(;i>=0;){const t=uh[i];let s;if(s=e?this._currentStartState[t]:this._currentEndState[t],void 0===s)return;if(void 0===n&&(n=s),s!==n)return 0;i--}return n}_getSelectionRuler(t,e,n,i,s){let o=0,r=i;const a=uh[t],l=uh[t+1];if(null===l||null===a)return{start_next:o,end_next:r};const h=e[a],c=n[a];this._setNodePositionState(a,h,c,s);const d=this._checkPreviousNodePositionState(t),u=this._checkPreviousNodePositionState(t,!1);return 1===d&&(o=e[l]),2===u&&(r=n[l]),{start_next:o,end_next:r}}_pushToPoints(t){const{startX:e,startY:n,endX:i,endY:s}=t,o=[];return o.push({x:e,y:n}),o.push({x:i,y:n}),o.push({x:i,y:s}),o.push({x:e,y:s}),o.push({x:e,y:n}),o}isSamePosition(){const t=this.startNodePosition,e=this.endNodePosition;if(null==t||null==e)return!1;const n=Object.keys(_h);for(let i of n){if(t[i]!==e[i])return!1}return t.isBack===e.isBack}_createAndUpdateRange(t,e,n){if(this._rangeShape)return this._rangeShape.translate(e,n),this._rangeShape.updatePointGroup(t),void this._rangeShape.show();const i=new Ya("__TestSelectionRange__"+z.generateRandomId(6),{pointsGroup:t,fill:Kr(rr,.2),left:e,top:n,evented:!1});this._rangeShape=i,this._scene.addObject(i,2)}_getAnchorBounding(t){const e=t[0],n=e[0],i=e[2],{x:s,y:o}=n,{x:r,y:a}=i;return{left:s,top:o,width:r-s,height:a-o}}_createAndUpdateAnchor(t,e,n){const i=this._getAnchorBounding(t),{left:s,top:o,width:r,height:a}=i;if(this._anchorShape)return this._anchorShape.transformByState({left:s+e,top:o+n,height:a}),void this._anchorShape.show();const l=new Wa("__TestSelectionAnchor__"+z.generateRandomId(6),{left:s+e,top:o+n,height:a,strokeWidth:1,stroke:Kr(rr),evented:!1});this._anchorShape=l,this._scene.addObject(l,2)}_getRangePointData(t,e,n){const i=[],s=[];if(null==t||null==e)return{pointGroup:i,cursorList:s};const{start:o,end:r}=this._compareNodePosition(t,e);return this._selectionIterator(o,r,n,((t,e,n,a,l,h)=>{var c;const{lineHeight:d}=h,{spanGroup:u,st:g}=l,{x:_,y:p}=this._Liquid;let m;const f=u[t],T=u[e],v=(null==f?void 0:f.left)||0,E=(null==f?void 0:f.width)||0,b=(null==T?void 0:T.left)||0,I=(null==T?void 0:T.width)||0;let C=(null==f?void 0:f.spanType)===Mr.LIST,S=(null==(c=u[0])?void 0:c.spanType)===Mr.LIST,A=t+g,w=e+g;const R=o.span!==t||!n||o.isBack,N=!(r.span!==e||!a)&&r.isBack,y=o===r;if(0===t&&e===u.length-1)w-=S?1:0,m={startX:_+v+(C?E:0),startY:p,endX:_+b+I,endY:p+d};else{A-=S&&!C?1:0,w-=S&&!C?1:0,m={startX:_+v+(R&&!C?0:E),startY:p,endX:_+b+(N?0:I),endY:p+d}}i.push(this._pushToPoints(m)),s.push({isStartBack:R,isEndBack:N,cursorStart:A,cursorEnd:w,isCollapse:y})})),{pointGroup:i,cursorList:s}}_selectionIterator(t,e,n,i){const s=n.getSkeleton();if(!s)return[];this._Liquid.reset();const o=s.getSkeletonData().pages,{page:r}=t,{page:a}=e;this._resetCurrentNodePositionState();for(let l=0;l<=r-1;l++){const t=o[l];this._Liquid.translatePage(t,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}for(let l=r;l<=a;l++){const s=o[l],h=s.sections,{start_next:c,end_next:d}=this._getSelectionRuler(_h.page,t,e,h.length-1,l);this._Liquid.translateSave(),this._Liquid.translatePagePadding(s);for(let n=c;n<=d;n++){const o=h[n],u=o.columns,{start_next:g,end_next:_}=this._getSelectionRuler(_h.section,t,e,u.length-1,n);this._Liquid.translateSection(o);for(let h=g;h<=_;h++){const p=u[h],m=p.lines,{start_next:f,end_next:T}=this._getSelectionRuler(_h.column,t,e,m.length-1,h);this._Liquid.translateColumn(p);for(let u=f;u<=T;u++){const v=m[u],{divides:E,type:b,lineHeight:I=0}=v,{start_next:C,end_next:S}=this._getSelectionRuler(_h.line,t,e,E.length-1,u);this._Liquid.translateSave(),this._Liquid.translateLine(v);for(let m=C;m<=S;m++){const b=E[m];this._Liquid.translateSave(),this._Liquid.translateDivide(b);const I=b.spanGroup,{start_next:A,end_next:w}=this._getSelectionRuler(_h.divide,t,e,I.length-1,m);let R=!1,N=!1;l===r&&n===c&&h===g&&u===f&&m===C&&(R=!0),l===a&&n===d&&h===_&&u===T&&m===S&&(N=!0),i&&i(A,w,R,N,b,v,p,o,s),this._Liquid.translateRestore()}this._Liquid.translateRestore()}}}this._Liquid.translateRestore(),this._Liquid.translatePage(s,n.pageLayoutType,n.pageMarginLeft,n.pageMarginTop)}}_setRangeList(t){0!==t.length&&(this._rangeList=t)}_getCursorPosition(t,e){return t-(!0===e?1:0)}}class mh{constructor(t){var e;this._documents=t,this.onKeydownObservable=new y,this.onInputObservable=new y,this.onCompositionstartObservable=new y,this.onCompositionupdateObservable=new y,this.onCompositionendObservable=new y,this._textSelectionList=[],this._viewPortObserverMap=new Map,this._isIMEInputApply=!1,this._initialDom(),this.activeViewport=null==(e=this._documents)?void 0:e.getFirstViewport(),this._documents&&this.changeDocuments(this._documents)}set activeViewport(t){this._attachScrollEvent(t),this._activeViewport=t}static create(t){return new mh(t)}getActiveTextSelection(){const t=this._textSelectionList;for(let e of t)if(e.isActive())return e}getTextSelectionList(){return this._textSelectionList}add(t){this._addTextSelection(t)}remain(){const t=this.getActiveTextSelection();if(null==t)return;const e=this._textSelectionList.indexOf(t);return this._textSelectionList.splice(e,1)[0]}sync(){this._syncDomToSelection()}active(t,e){this._container.style.left=`${t}px`,this._container.style.top=`${e}px`,this._cursor.style.animation="univer_cursor_blinkStyle 1s steps(1) infinite",this._cursor.style.display="revert",setTimeout((()=>{this._input.focus()}),0)}deactivate(){this._container.style.left="0px",this._container.style.top="0px",this._cursor.style.animation="",this._cursor.style.display="none",this._input.blur()}changeDocuments(t){var e;this._documents&&this._detachEvent(this._documents),this._documents=t,this._skeletonObserver=null==(e=t.getSkeleton())?void 0:e.onRecalculateChangeObservable.add((t=>{this._deleteAllTextSelection()})),this._attachSelectionEvent(this._documents)}dispose(){this._documents&&this._detachEvent(this._documents),this._container.remove()}_initialDom(){const t=document.createElement("div");t.style.position="absolute",t.style.position="absolute",t.style.left="0px",t.style.top="0px";const e=document.createElement("div"),n=document.createElement("div"),i=document.createElement("div");e.appendChild(n),t.appendChild(e),t.appendChild(i),this._container=t,this._inputParent=e,this._input=n,this._cursor=i,this._initialInput(),this._initialCursorDom(),this._attachInputEvent(),document.body.appendChild(t)}_initialInput(){this._inputParent.style.cssText="\n            position:absolute;\n            height:1px;\n            width:1px;\n            overflow: hidden;\n        ",this._input.contentEditable="true",this._input.style.cssText="\n            position: absolute; \n            overflow: hidden; \n            opacity: 1; \n            background: #000; \n            color: transparent; \n            outline: none; \n            z-index: -2; \n            caret-color: transparent; \n            white-space: pre-wrap; \n            user-select: text;\n        "}_initialCursorDom(){if(this._cursor.style.cssText="\n            visibility: visible;\n            position: absolute;\n            background: #000;\n            left: 0;\n            top: 0;\n            width: 1px;\n            height: 20px;\n            opacity: 0;\n            z-index: 0;\n            pointer-events: none;\n            display: none\n        ",!function(t){for(let e=0,n=document.head.childNodes.length;e<n;e++){const n=document.head.childNodes[e];if("STYLE"===n.nodeName&&n.textContent&&n.textContent.indexOf(t)>-1)return!0}return!1}("keyframes univer_cursor_blinkStyle")){!function(t){const e=document.createElement("style");document.head.appendChild(e);const n=e.sheet;for(let i of t)null==n||n.insertRule(i,n.cssRules.length)}(["\n                @-webkit-keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            ","\n                @keyframes univer_cursor_blinkStyle {\n                    0% {\n                        opacity: 1;\n                    }\n                \n                    13% {\n                        opacity: 0;\n                    }\n\n                    50% {\n                        opacity: 0;\n                    }\n\n                    63% {\n                        opacity: 1;\n                    }\n                \n                    100% {\n                        opacity: 1;\n                    }\n                }\n            "])}}_getSkeletonData(){var t,e;return null==(e=null==(t=this._documents)?void 0:t.getSkeleton())?void 0:e.getSkeletonData()}_getNodePosition(t){var e;if(!1===t)return;const{node:n,ratioX:i,ratioY:s}=t,o=null==(e=this._documents)?void 0:e.findPositionBySpan(n);return null!=o?c(h({},o),{isBack:i<.5}):void 0}_interactTextSelection(t){const e=[];let n=!1;this._textSelectionList.forEach((i=>{if(i===t)return!0;t.isIntersection(i)?(n=!0,i.dispose()):e.push(i)})),n&&(e.push(t),this._textSelectionList=e)}_deleteAllTextSelection(){this._textSelectionList.forEach((t=>{t.dispose()})),this._textSelectionList=[]}_deactivateTextSelection(){this._textSelectionList.forEach((t=>{t.deactivate()}))}_addTextSelection(t){this._deactivateTextSelection(),t.activate(),this._textSelectionList.push(t)}_updateTextSelection(t){if(!this._documents)return;let e=this._textSelectionList.pop();e||(e=new ph(this._documents.getScene(),t)),this._deleteAllTextSelection(),e.activate(),e.startNodePosition=t,e.endNodePosition=null,this._textSelectionList=[e]}_isEmptyTextSelection(){return 0===this._textSelectionList.length}_getCanvasOffset(){var t,e;const n=null==(t=this._documents)?void 0:t.getEngine(),i=null==(e=null==n?void 0:n.getCanvas())?void 0:e.getCanvasEle();if(!i)return{left:0,top:0};const{top:s,left:o}=function(t){let e=t.getBoundingClientRect(),n=document.body,i=document.documentElement,s=window.pageYOffset||i.scrollTop||n.scrollTop,o=window.pageXOffset||i.scrollLeft||n.scrollLeft,r=i.clientTop||n.clientTop,a=i.clientLeft||n.clientLeft;return{top:e.top+s-r,left:e.left+o-a}}(i);return{left:o,top:s}}_syncDomToSelection(){var t;const e=this.getActiveTextSelection(),n=null==e?void 0:e.getAnchor();if(!n||n&&!n.visible)return;const{height:i,left:s,top:o}=n,r=null==(t=this._activeViewport)?void 0:t.getAbsoluteVector(ma.FromArray([s,o]));this._cursor.style.height=`${i}px`;let{left:a,top:l}=this._getCanvasOffset();a+=(null==r?void 0:r.x)||0,l+=(null==r?void 0:r.y)||0,this.active(a,l)}_moving(t,e,n){const{scrollX:i,scrollY:s}=Oa(n);if(!this._documents)return;const o=this._documents.findNodeByCoord(t,e),r=this._getNodePosition(o);if(console.log("endNode",o,r,{moveOffsetX:t,moveOffsetY:e,_viewportScrollY:this._viewportScrollY,scrollX:i}),!r)return;const a=this.getActiveTextSelection();a&&(a.endNodePosition=r,a.refresh(this._documents),this._interactTextSelection(a))}_attachScrollEvent(t){if(!t)return;const e=t.viewPortKey;if(this._viewPortObserverMap.has(e))return;const n=t.onScrollBeforeObserver.add((t=>{if(!t.viewport)return;const e=this.getActiveTextSelection();null==e||e.activeStatic(),this._cursor.style.display="none"})),i=t.onScrollStopObserver.add((t=>{const e=t.viewport;if(!e)return;const n=e.getBounding(),i=this.getActiveTextSelection(),s=null==i?void 0:i.getAnchor();if(s&&(!s||s.visible)){if(n){const{minX:t,maxX:e,minY:i,maxY:o}=Da(s,n);if(s.strokeWidth<t||e<0||s.strokeWidth<i||o<0)return}this._syncDomToSelection(),null==i||i.deactivateStatic(),this._cursor.style.display="revert"}}));this._viewPortObserverMap.set(e,{scrollBefore:n,scrollStop:i})}_attachInputEvent(){this._input.addEventListener("keydown",(t=>{if(this._isIMEInputApply)return;const e=this.getActiveTextSelection(),n=this.getTextSelectionList();null!=this._documents&&(this._input.innerHTML="",this.onKeydownObservable.notifyObservers({event:t,content:"",document:this._documents,activeSelection:e,selectionList:n}))})),this._input.addEventListener("input",(t=>{if(this._isIMEInputApply)return;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onInputObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})})),this._input.addEventListener("compositionstart",(t=>{this._isIMEInputApply=!0;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onCompositionstartObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})})),this._input.addEventListener("compositionend",(t=>{this._isIMEInputApply=!1;const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onCompositionendObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})})),this._input.addEventListener("compositionupdate",(t=>{const e=this._input.textContent||"";this._input.innerHTML="";const n=this.getActiveTextSelection(),i=this.getTextSelectionList();null!=this._documents&&this.onCompositionupdateObservable.notifyObservers({event:t,content:e,document:this._documents,activeSelection:n,selectionList:i})}))}_attachSelectionEvent(t){this._moveInObserver=t.onPointerEnterObserver.add((()=>{t.cursor=_r.TEXT})),this._moveOutObserver=t.onPointerLeaveObserver.add((()=>{t.cursor=_r.DEFAULT,e.resetCursor()}));const e=t.getScene();this._downObserver=t.onPointerDownObserver.add(((t,n)=>{const{offsetX:i,offsetY:s}=t;if(!this._documents)return;this.activeViewport=this._documents.getActiveViewportByCoord(i,s);const o=this._documents.findNodeByCoord(i,s),r=this._getNodePosition(o);if(console.log("startNode",o,r,i,s),!r)return void this._deleteAllTextSelection();if(t.ctrlKey||this._isEmptyTextSelection()){const t=new ph(this._documents.getScene(),r);this._addTextSelection(t)}else this._updateTextSelection(r);this._activeSelectionRefresh(),this._syncDomToSelection(),e.disableEvent();const a=Ba.create(e);a.startScroll(i,s);const{scrollX:l,scrollY:h}=Oa(a);this._viewportScrollX=l,this._viewportScrollY=h,this._moveObserver=e.onPointerMoveObserver.add((t=>{const{offsetX:n,offsetY:i}=t;this._moving(n,i,a),a.scrolling(n,i,(()=>{this._moving(n,i,a)})),e.setCursor(_r.TEXT)})),this._upObserver=e.onPointerUpObserver.add((t=>{e.onPointerMoveObserver.remove(this._moveObserver),e.onPointerUpObserver.remove(this._upObserver),e.enableEvent(),a.stopScroll()}))}))}_detachEvent(t){var e;t.onPointerEnterObserver.remove(this._moveInObserver),t.onPointerLeaveObserver.remove(this._moveOutObserver),t.onPointerDownObserver.remove(this._downObserver),null==(e=t.getSkeleton())||e.onRecalculateChangeObservable.remove(this._skeletonObserver),this.onKeydownObservable.clear(),this.onInputObservable.clear(),this.onCompositionstartObservable.clear(),this.onCompositionupdateObservable.clear(),this.onCompositionendObservable.clear()}_activeSelectionRefresh(){if(!this._documents)return;const t=this.getActiveTextSelection();null==t||t.refresh(this._documents)}}class fh extends th{constructor(t,e,n){super(t,e,null==n?void 0:n.allowCache),this.isCalculateSkeleton=!0,this.onPageRenderObservable=new y,this.docsLeft=0,this.docsTop=0,this._hasEditor=!1,void 0===(null==n?void 0:n.pageMarginLeft)?this.pageMarginLeft=17:this.pageMarginLeft=null==n?void 0:n.pageMarginLeft,void 0===(null==n?void 0:n.pageMarginTop)?this.pageMarginTop=14:this.pageMarginTop=null==n?void 0:n.pageMarginTop,this.pageLayoutType=(null==n?void 0:n.pageLayoutType)||Lr.VERTICAL,this._drawLiquid=new hh,this._findLiquid=new hh,this._hasEditor=(null==n?void 0:n.hasEditor)||!1,this._initialDefaultExtension(),this._addSkeletonChangeObserver(e),this.makeDirty(!0)}get hasEditor(){return this._hasEditor}static create(t,e,n){return new fh(t,e,n)}calculatePagePosition(){const t=this.getScene();let e=null==t?void 0:t.getParent();const{width:n,height:i,pageMarginLeft:s,pageMarginTop:o}=this;if(null==e)return this;const{width:r,height:a}=e;let l=0,h=0,c=0,d=0;return r>n?(l=r/2-n/2,c=r-30):(l=s,c=n+2*s),a>i?(h=a/2-i/2,d=a-30):(h=o,d=i+2*o),this.docsLeft=l,this.docsTop=h,t.resize(c,d+200),this.translate(l,h),this}getFirstViewport(){return this.getScene().getViewports()[0]}getActiveViewportByCoord(t,e){return this.getScene().getActiveViewportByCoord(ma.FromArray([t,e]))}getEngine(){return this.getScene().getEngine()}enableEditor(){this._hasEditor||(this._editor=mh.create(this),this._hasEditor=!0)}disableEditor(){var t;null==(t=this._editor)||t.dispose(),this._hasEditor=!1}getEditorInputEvent(){if(!this._hasEditor)return;const{onInputObservable:t,onCompositionstartObservable:e,onCompositionupdateObservable:n,onCompositionendObservable:i,onKeydownObservable:s}=this._editor;return{onInputObservable:t,onCompositionstartObservable:e,onCompositionupdateObservable:n,onCompositionendObservable:i,onKeydownObservable:s}}remainActiveSelection(){if(this._hasEditor)return this._editor.remain()}addSelection(t){if(this._hasEditor)return this._editor.add(t)}syncSelection(){if(this._hasEditor)return this._editor.sync()}draw(t,e){const n=this.getSkeleton();if(!n)return;this._drawLiquid.reset();const i=n.getSkeletonData(),{pages:s}=i,o=this.getParentScale(),r=this.getExtensionsByOrder(),a=ca(o);for(let c of r)c.clearCache();let l=0,h=0;for(let c=0,d=s.length;c<d;c++){const e=s[c],{sections:n,marginTop:i=0,marginBottom:d=0,marginLeft:u=0,marginRight:g=0,width:_,height:p,renderConfig:m={}}=e,{verticalAlign:f=Oe.TOP,horizontalAlign:T=Ne.LEFT,centerAngle:v=0,vertexAngle:E=0,wrapStrategy:b=Me.UNSPECIFIED,isRotateNonEastAsian:I=Ue.FALSE}=m,C=this._horizontalHandler(_,u,g,T),S=this._verticalHandler(p,i,d,f),A=ma.create(C,S),w=Qr(v),R=Qr(E),N=R-w;this.onPageRenderObservable.notifyObservers({page:e,pageLeft:h,pageTop:l,ctx:t}),this._startRotation(t,N);for(let s of n){const{columns:e}=s;this._drawLiquid.translateSection(s);for(let n of e){const{lines:e,width:s}=n;this._drawLiquid.translateColumn(n);const l=e.length;let h,c=null;if(0!==R){const{rotateTranslateXList:t,rotatedHeight:n,rotatedWidth:o,fixOffsetX:r,fixOffsetY:a,rotateTranslateY:l}=Sa(e,s,R);let _=o;n>this.height&&b!==Me.WRAP&&(b===Me.OVERFLOW||R>0)&&(_=this.height/Math.tan(Math.abs(R)));const p=this._horizontalHandler(_,u,g,T);let m=this._verticalHandler(n,i,d,f)-a;n>this.height&&(m=R<0?this.height-(n+a):-a),h=ma.create(p+r,m),this._drawLiquid.translate(0,-l),c=t}else h=A;for(let n=0;n<l;n++){const i=e[n],{divides:s,asc:l=0,type:d,lineHeight:u=0}=i;let g=l;const _=g*Math.sin(w),p=g*Math.cos(w);if(d===Or.BLOCK)for(let e of r)e.type===rh.LINE&&(e.extensionOffset={alignOffset:h,renderConfig:m},e.draw(t,o,i));else{this._drawLiquid.translateSave(),this._drawLiquid.translateLine(i,!0),c&&this._drawLiquid.translate(c[n]);const e=s.length;for(let n=0;n<e;n++){const e=s[n],{spanGroup:i}=e;this._drawLiquid.translateSave(),this._drawLiquid.translateDivide(e);for(let n of i){if(!n.content||0===n.content.length)continue;const{width:e,left:i}=n,{x:s,y:l}=this._drawLiquid,c=ma.create(sa(s,a),sa(l,a)),d=ma.create(sa(e/2,a),sa(u/2,a)),g=Ia(c.addByPoint(sa(i,a),0),d,w,R,h),f=Ia(c.addByPoint(sa(i+_,a),sa(p,a)),d,w,R,h),T={originTranslate:c,spanStartPoint:g,spanPointWithFont:f,centerPoint:d,alignOffset:h,renderConfig:m};for(let a of r)a.type===rh.SPAN&&(a.extensionOffset=T,a.draw(t,o,n))}this._drawLiquid.translateRestore()}this._drawLiquid.translateRestore()}}}}this._resetRotation(t,N);const{x:y,y:O}=this._drawLiquid.translatePage(e,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop);h+=y,l+=O}}changeSkeleton(t){return this._disposeSkeletonChangeObserver(this.getSkeleton()),this.setSkeleton(t),this._addSkeletonChangeObserver(t),this}findPositionBySpan(t){var e;const n=t.parent,i=null==n?void 0:n.parent,s=null==i?void 0:i.parent,o=null==s?void 0:s.parent,r=null==o?void 0:o.parent,a=null==(e=this.getSkeleton())?void 0:e.getSkeletonData();if(!(n&&s&&o&&r&&a))return;return{span:n.spanGroup.indexOf(t),divide:i.divides.indexOf(n),line:s.lines.indexOf(i),column:o.columns.indexOf(s),section:r.sections.indexOf(o),page:a.pages.indexOf(r)}}findNodeByCharIndex(t){const e=this.getSkeleton();if(!e)return;const n=e.getSkeletonData().pages;for(let i of n){const{sections:e,st:n,ed:s}=i;if(!(t<n||t>s))for(let i of e){const{columns:e,st:n,ed:s}=i;if(!(t<n||t>s))for(let i of e){const{lines:e,st:n,ed:s}=i;if(!(t<n||t>s))for(let i of e){const{divides:e,lineHeight:n,st:s,ed:o}=i,r=e.length;if(!(t<s||t>o))for(let i=0;i<r;i++){const n=e[i],{spanGroup:s,st:o,ed:r}=n;if(t<o||t>r)continue;const a=s[t-o];if(a)return a}}}}}}findNodeByCoord(t,e){const n=this.getScene().transformToSceneCoord(ma.FromArray([t,e]));if(!n)return!1;const i=this._getInverseCoord(n);let{x:s,y:o}=i;const r=this.getSkeleton();if(!r)return!1;this._findLiquid.reset();const a=r.getSkeletonData().pages;for(let l=0,h=a.length;l<h;l++){const t=a[l],{startX:e,startY:n,endX:i,endY:r}=this._getPageBoundingBox(t);if(!(s>=e&&s<=i&&o>=n&&o<=r)){this._translatePage(t);continue}this._findLiquid.translatePagePadding(t);const h=t.sections;for(let a of h){const{columns:t,height:e}=a;this._findLiquid.translateSection(a);const{y:n}=this._findLiquid;if(o>=n&&o<=n+e)for(let i of t){const{lines:t,width:e}=i;this._findLiquid.translateColumn(i);const{x:n}=this._findLiquid;if(!(s>=n&&s<=n+e))continue;const r=t.length;for(let i=0;i<r;i++){const e=t[i],{divides:n,type:r,lineHeight:a=0}=e;if(r!==Or.BLOCK){this._findLiquid.translateSave(),this._findLiquid.translateLine(e);const{y:t}=this._findLiquid,i=t,r=t+a;if(!(o>=i&&o<=r)){this._findLiquid.translateRestore();continue}const l=n.length;for(let e=0;e<l;e++){const t=n[e],{spanGroup:a,width:l}=t;this._findLiquid.translateSave(),this._findLiquid.translateDivide(t);const{x:h}=this._findLiquid;if(s>=h&&s<=h+l){for(let t of a){if(!t.content||0===t.content.length)continue;const{width:e,left:n}=t,a=h+n,l=h+n+e;if(s>=a&&s<=l)return{node:t,ratioX:s/(a+l),ratioY:o/(i+r)}}this._findLiquid.translateRestore()}else this._findLiquid.translateRestore()}this._findLiquid.translateRestore()}}}}this._findLiquid.restorePagePadding(t),this._translatePage(t)}return!1}_draw(t,e){this.draw(t,e)}_horizontalHandler(t,e,n,i){let s=0;return s=i===Ne.CENTER?(this.width-t)/2:i===Ne.RIGHT?this.width-t-n:e,s}_verticalHandler(t,e,n,i){let s=0;return s=i===Oe.MIDDLE?(this.height-t)/2:i===Oe.BOTTOM?this.height-t-n:e,s}_startRotation(t,e){t.rotate(e||0)}_resetRotation(t,e){t.rotate(-e||0)}_initialDefaultExtension(){oh.getData().forEach((t=>{this.register(t)}))}_addSkeletonChangeObserver(t){t&&(this._skeletonObserver=t.onRecalculateChangeObservable.add((t=>{const e=t.pages;let n=0,i=0;for(let s=0,o=e.length;s<o;s++){const t=e[s],{pageWidth:r,pageHeight:a}=t;this.pageLayoutType===Lr.VERTICAL?(i+=a,s!==o-1&&(i+=this.pageMarginTop),n=Math.max(n,r)):this.pageLayoutType===Lr.HORIZONTAL&&(n+=r,s!==o-1&&(n+=this.pageMarginLeft),i=Math.max(i,a))}this.resize(n,i),this.calculatePagePosition()})))}_disposeSkeletonChangeObserver(t){t&&t.onRecalculateChangeObservable.remove(this._skeletonObserver)}_getPageBoundingBox(t){const{pageWidth:e,pageHeight:n}=t;let{x:i,y:s}=this._findLiquid,o=-1,r=-1;return this.pageLayoutType===Lr.VERTICAL?(o=e,r=s+n):this.pageLayoutType===Lr.HORIZONTAL&&(o=i+e,r=n),{startX:i,startY:s,endX:o,endY:r}}_translatePage(t){this._findLiquid.translatePage(t,this.pageLayoutType,this.pageMarginLeft,this.pageMarginTop)}}const Th=["text","richText"];class vh extends ya{constructor(t,e,n){super(e),this._allowCache=!1,(null==n?void 0:n.richText)?this._documentData=n.richText:n&&(this._fs=n.fs,this._ff=n.ff,this._it=n.it,this._bl=n.bl,this._ul=n.ul,this._st=n.st,this._ol=n.ol,this._bg=n.bg,this._bd=n.bd,this._cl=n.cl,this._documentData=this.convertToDocumentData(n.text||"")),this._allowCache&&(this._cacheCanvas=new xa,this.onTransformChangeObservable.add((()=>{this.resizeCacheCanvas()}))),this._context=t,this._documentSkeleton=Ql.create(this._documentData,this._context),this._documents=new fh(`${this.oKey}_DOCUMENTS`,this._documentSkeleton,{pageMarginLeft:0,pageMarginTop:0}),this._initialProps(n),this.onTransformChangeObservable.add((t=>{const{type:e,value:n,preValue:i}=t;if(e===Wr.resize||e===Wr.all){this._documentSkeleton.updateDocumentDataPageSize(this.width),this._documentSkeleton.makeDirty(!0),this._documentSkeleton.calculate();const t=this.getDocsSkeletonPageSize();this.height=(null==t?void 0:t.height)||this.height,this._setTransForm()}}))}get documentData(){return this._documentData}getDocsSkeletonPageSize(){var t;const e=null==(t=this._documentSkeleton)?void 0:t.getSkeletonData();if(!e)return;const{pages:n}=e,i=n[n.length-1],{width:s,height:o}=i;return{width:s,height:o}}setProps(t){if(!t)return;const e=Object.keys(t);return 0!==e.length?(e.forEach((e=>{if(void 0===t[e])return!0;-1===Th.indexOf(e)&&(this[`_${e}`]=t[e])})),this.makeDirty(!0),this):void 0}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this.isRender()){const{minX:t,maxX:n,minY:i,maxY:s}=Da(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<i||s<0)return this}const n=this.transform.getMatrix();if(t.save(),t.transform(n[0],n[1],n[2],n[3],n[4],n[5]),this._allowCache){if(this.isDirty()){const t=this._cacheCanvas.getContext();this._cacheCanvas.clear(),t.save(),t.translate(this.strokeWidth/2,this.strokeWidth/2),this._draw(t),t.restore()}this._applyCache(t)}else this._draw(t);return t.restore(),this.makeDirty(!1),this}getContext(){return this._context}toJson(){const t={};return Th.forEach((e=>{this[e]&&(t[e]=this[e])})),h(h({},super.toJson()),t)}_draw(t){this._documents.render(t)}convertToDocumentData(t){const e=t.length;return{id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:e,blockType:K.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:e,et:st.TEXT_RUN,tr:{ct:t,ts:{fs:this._fs||14,ff:this._ff,it:this._it,bl:this._bl,ul:this._ul,st:this._st,ol:this._ol,bg:this._bg,bd:this._bd,cl:this._cl}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0}}}}_initialProps(t){this._documentSkeleton.updateDocumentDataPageSize(null==t?void 0:t.width,null==t?void 0:t.height),this._documentSkeleton.calculate();const e=this.getDocsSkeletonPageSize();this.transformByState({width:(null==e?void 0:e.width)||0,height:(null==e?void 0:e.height)||0,left:(null==t?void 0:t.left)||0,top:(null==t?void 0:t.top)||0,angle:null==t?void 0:t.angle}),this.setProps(t),this.makeDirty(!0)}_applyCache(t){if(!t||!this._cacheCanvas)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,i=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,i,-this.strokeWidth/2,-this.strokeWidth/2,this.width+this.strokeWidth,this.height+this.strokeWidth)}}var Eh,bh;(bh=Eh||(Eh={})).RESIZE_LT="__SpreadsheetTransformerResizeLT__",bh.RESIZE_CT="__SpreadsheetTransformerResizeCT__",bh.RESIZE_RT="__SpreadsheetTransformerResizeRT__",bh.RESIZE_LM="__SpreadsheetTransformerResizeLM__",bh.RESIZE_RM="__SpreadsheetTransformerResizeRM__",bh.RESIZE_LB="__SpreadsheetTransformerResizeLB__",bh.RESIZE_CB="__SpreadsheetTransformerResizeCB__",bh.RESIZE_RB="__SpreadsheetTransformerResizeRB__",bh.OUTLINE="__SpreadsheetTransformerOutline__",bh.ROTATE_LINE="__SpreadsheetTransformerRotateLine__",bh.ROTATE="__SpreadsheetTransformerRotate__",bh.GROUP="__SpreadsheetTransformer__";const Ih=[Eh.RESIZE_LT,Eh.RESIZE_CT,Eh.RESIZE_RT,Eh.RESIZE_LM,Eh.RESIZE_RM,Eh.RESIZE_LB,Eh.RESIZE_CB,Eh.RESIZE_RB];var Ch,Sh,Ah,wh,Rh,Nh,yh,Oh;(Sh=Ch||(Ch={}))[Sh.MOVE_START=0]="MOVE_START",Sh[Sh.MOVING=1]="MOVING",Sh[Sh.MOVE_END=2]="MOVE_END";class Dh{constructor(t,e){this._scene=t,this.hoverEnabled=!1,this.resizeEnabled=!0,this.rotateEnabled=!0,this.rotationSnaps=[],this.rotationSnapTolerance=5,this.rotateAnchorOffset=50,this.rotateSize=10,this.rotateCornerRadius=10,this.borderEnabled=!0,this.borderStroke="rgb(97, 97, 97)",this.borderStrokeWidth=1,this.borderDash=[],this.borderSpacing=10,this.anchorFill="rgb(255,255,255)",this.anchorStroke="rgb(185,185,185)",this.anchorStrokeWidth=1,this.anchorSize=10,this.anchorCornerRadius=10,this.keepRatio=!0,this.centeredScaling=!1,this.enabledAnchors=[1,1,1,1,1,1,1,1],this.flipEnabled=!1,this.ignoreStroke=!1,this.onChangeStartObservable=new y,this.onChangingObservable=new y,this.onChangeEndObservable=new y,this.onClearControlObservable=new y,this.onCreateControlObservable=new y,this._transformerControlMap=new Map,this._selectedObjectMap=new Map,this._initialProps(e)}getScene(){return this._scene}attachTo(t){if(t.isTransformer)return this.hoverEnabled&&(this.hoverEnterFunc&&t.onPointerEnterObserver.add(this.hoverEnterFunc),this.hoverLeaveFunc&&t.onPointerLeaveObserver.add(this.hoverLeaveFunc)),t.onPointerDownObserver.add(((e,n)=>{const{offsetX:i,offsetY:s}=e;this._startOffsetX=i,this._startOffsetY=s;const o=this._getTopScene();if(!o)return;this._addCancelObserver(o),o.disableEvent();const r=Ba.create(o);r.startScroll(i,s);const{scrollX:a,scrollY:l}=Oa(r);this._viewportScrollX=a,this._viewportScrollY=l,this._updateActiveObjectList(t,e),this._moveObserver=o.onPointerMoveObserver.add((t=>{const{offsetX:e,offsetY:n}=t;this._moving(e,n,r),this._hiddenControl(),r.scrolling(e,n,(()=>{this._moving(e,n,r)}))})),this._upObserver=o.onPointerUpObserver.add((t=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),this._updateControl(),r.stopScroll(),this.onChangeEndObservable.notifyObservers({objects:this._selectedObjectMap,type:2})})),n.stopPropagation()})),t}dispose(){this._moveObserver=null,this._upObserver=null,this._transformerControlMap.forEach((t=>{t.dispose()})),this._selectedObjectMap.forEach((t=>{t.dispose()})),this.onChangeStartObservable.clear(),this.onChangingObservable.clear(),this.onChangeEndObservable.clear()}_initialProps(t){if(!t)return;const e=Object.keys(t);0!==e.length&&e.forEach((e=>{if(void 0===t[e])return!0;this[e]=t[e]}))}_updateControlChildren(){this._updateControlIterator(((t,e)=>{const{left:n,top:i,width:s,height:o,scaleX:r,scaleY:a}=e.getState();t.getObjects().forEach((t=>{const e=t.oKey,n=this._checkTransformerType(e);if(!n)return!0;if(n===Eh.OUTLINE)t.transformByState(this._getOutlinePosition(s,o,r,a));else{const{left:e,top:i}=this._getRotateAnchorPosition(n,o,s,r,a);t.transformByState({left:e,top:i})}})),t.transformByState({left:n,top:i})}))}_anchorMoving(t,e,n,i){const{scrollX:s,scrollY:o}=Oa(i),r=e-this._viewportScrollX+s,a=n-this._viewportScrollY+o,l=r-this._startOffsetX,h=a-this._startOffsetY;this._selectedObjectMap.forEach((e=>{const{left:n,top:i,width:s,height:o}=e,r={};switch(t){case Eh.RESIZE_LT:r.left=n+l,r.top=i+h,r.width=s-l,r.height=o-h;break;case Eh.RESIZE_CT:r.top=i+h,r.height=o-h;break;case Eh.RESIZE_RT:r.top=i+h,r.width=s+l,r.height=o-h;break;case Eh.RESIZE_LM:r.left=n+l,r.width=s-l;break;case Eh.RESIZE_RM:r.width=l+s;break;case Eh.RESIZE_LB:r.left=n+l,r.width=s-l,r.height=o+h;break;case Eh.RESIZE_CB:r.height=h+o;break;case Eh.RESIZE_RB:r.width=l+s,r.height=h+o}e.transformByState(r)})),this._updateControlChildren(),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:l,moveY:h,type:1}),this._startOffsetX=r,this._startOffsetY=a}_attachEventToAnchor(t,e=Eh.RESIZE_LT){t.onPointerDownObserver.add(((t,n)=>{const{offsetX:i,offsetY:s}=t;this._startOffsetX=i,this._startOffsetY=s;const o=this._getTopScene();if(null==o)return;o.disableEvent();const r=Ba.create(o);r.startScroll(i,s);const{scrollX:a,scrollY:l}=Oa(r);this._viewportScrollX=a,this._viewportScrollY=l;const h=this._getRotateAnchorCursor(e);this._moveObserver=o.onPointerMoveObserver.add((t=>{const{offsetX:n,offsetY:i}=t;this._anchorMoving(e,n,i,r),r.scrolling(n,i,(()=>{this._anchorMoving(e,n,i,r)})),o.setCursor(h)})),this._upObserver=o.onPointerUpObserver.add((t=>{o.onPointerMoveObserver.remove(this._moveObserver),o.onPointerUpObserver.remove(this._upObserver),o.enableEvent(),o.resetCursor(),r.stopScroll()})),n.stopPropagation()}))}_attachEventToRotate(t){t.onPointerDownObserver.add(((t,e)=>{const{offsetX:n,offsetY:i}=t;this._startOffsetX=n,this._startOffsetY=i;const s=this._getTopScene();null!=s&&(s.disableEvent(),this._viewportScrollX=scrollX,this._viewportScrollY=scrollY,this._moveObserver=s.onPointerMoveObserver.add((t=>{})),this._upObserver=s.onPointerUpObserver.add((t=>{s.onPointerMoveObserver.remove(this._moveObserver),s.onPointerUpObserver.remove(this._upObserver),s.enableEvent()})),e.stopPropagation())}))}_getOutlinePosition(t,e,n,i){return{left:-this.borderSpacing-this.borderStrokeWidth,top:-this.borderSpacing-this.borderStrokeWidth,width:t+2*this.borderSpacing,height:e+2*this.borderSpacing}}_getRotateAnchorCursor(t){let e=_r.NORTH_WEST_RESIZE;switch(t){case Eh.ROTATE:case Eh.ROTATE_LINE:e=_r.MOVE;break;case Eh.RESIZE_LT:break;case Eh.RESIZE_CT:e=_r.NORTH_RESIZE;break;case Eh.RESIZE_RT:e=_r.NORTH_EAST_RESIZE;break;case Eh.RESIZE_LM:e=_r.WEST_RESIZE;break;case Eh.RESIZE_RM:e=_r.EAST_RESIZE;break;case Eh.RESIZE_LB:e=_r.SOUTH_WEST_RESIZE;break;case Eh.RESIZE_CB:e=_r.SOUTH_RESIZE;break;case Eh.RESIZE_RB:e=_r.SOUTH_EAST_RESIZE}return e}_getRotateAnchorPosition(t,e,n,i,s){let o=-this.anchorSize/2,r=-this.anchorSize/2;switch(t){case Eh.ROTATE:o=n/2-this.rotateSize/2,r=-this.rotateAnchorOffset-this.borderSpacing-2*this.borderStrokeWidth-this.rotateSize;break;case Eh.ROTATE_LINE:o=n/2,r=-this.rotateAnchorOffset-this.borderSpacing-this.borderStrokeWidth;break;case Eh.RESIZE_LT:o+=-this.borderSpacing-this.borderStrokeWidth,r+=-this.borderSpacing-this.borderStrokeWidth;break;case Eh.RESIZE_CT:o+=n/2,r+=-this.borderSpacing-this.borderStrokeWidth;break;case Eh.RESIZE_RT:o+=n+this.borderSpacing-this.borderStrokeWidth,r+=-this.borderSpacing-this.borderStrokeWidth;break;case Eh.RESIZE_LM:o+=-this.borderSpacing-this.borderStrokeWidth,r+=e/2;break;case Eh.RESIZE_RM:o+=n+this.borderSpacing-this.borderStrokeWidth,r+=e/2;break;case Eh.RESIZE_LB:o+=-this.borderSpacing-this.borderStrokeWidth,r+=e+this.borderSpacing-this.borderStrokeWidth;break;case Eh.RESIZE_CB:o+=n/2,r+=e+this.borderSpacing-this.borderStrokeWidth;break;case Eh.RESIZE_RB:o+=n+this.borderSpacing-this.borderStrokeWidth,r+=e+this.borderSpacing-this.borderStrokeWidth}return{left:o,top:r}}_createResizeAnchor(t,e,n){let{height:i,width:s,scaleX:o,scaleY:r}=e.getState();const{left:a,top:l}=this._getRotateAnchorPosition(t,i,s,o,r),h=this._getRotateAnchorCursor(t),c=new Wa(`${t}_${n}`,{zIndex:n-1,fill:this.anchorFill,stroke:this.anchorStroke,strokeWidth:this.anchorStrokeWidth,width:this.anchorSize,height:this.anchorSize,radius:this.anchorCornerRadius,left:a,top:l});return this._attachHover(c,h,_r.DEFAULT),c}_checkTransformerType(t){return t.indexOf(Eh.OUTLINE)>-1?Eh.OUTLINE:t.indexOf(Eh.ROTATE)>-1?Eh.ROTATE:t.indexOf(Eh.ROTATE_LINE)>-1?Eh.ROTATE_LINE:t.indexOf(Eh.RESIZE_LT)>-1?Eh.RESIZE_LT:t.indexOf(Eh.RESIZE_CT)>-1?Eh.RESIZE_CT:t.indexOf(Eh.RESIZE_RT)>-1?Eh.RESIZE_RT:t.indexOf(Eh.RESIZE_LM)>-1?Eh.RESIZE_LM:t.indexOf(Eh.RESIZE_RM)>-1?Eh.RESIZE_RM:t.indexOf(Eh.RESIZE_LB)>-1?Eh.RESIZE_LB:t.indexOf(Eh.RESIZE_CB)>-1?Eh.RESIZE_CB:t.indexOf(Eh.RESIZE_RB)>-1?Eh.RESIZE_RB:void 0}_updateControlIterator(t){this._transformerControlMap.forEach(((e,n)=>{const i=this._selectedObjectMap.get(n);if(!i)return!0;t(e,i)}))}_updateControl(){this._updateControlIterator(((t,e)=>{const{left:n,top:i}=e.getState();t.transformByState({left:n,top:i}),t.show(),t.makeDirty(!0)}))}_hiddenControl(){this._transformerControlMap.forEach((t=>{t.hide(),t.makeDirty(!0)}))}_attachHover(t,e,n){t.onPointerEnterObserver.add((()=>{t.cursor=e})),t.onPointerLeaveObserver.add((()=>{t.cursor=n}))}_clearControl(){this._transformerControlMap.forEach((t=>{t.dispose()})),this._transformerControlMap.clear(),this.onClearControlObservable.notifyObservers(null)}_createControl(t){let{left:e,top:n,height:i,width:s,angle:o,scaleX:r,scaleY:a,skewX:l,skewY:c,flipX:d,flipY:u}=t.getState();const g=t.oKey,_=this._selectedObjectMap.size,p=[];if(this.borderEnabled){const t=new Wa(`${Eh.OUTLINE}_${_}`,h({zIndex:_-1,evented:!1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke},this._getOutlinePosition(s,i,r,a)));p.push(t)}if(this.resizeEnabled){const{left:t,top:e}=this._getRotateAnchorPosition(Eh.ROTATE_LINE,i,s,r,a),n=new Wa(`${Eh.ROTATE_LINE}_${_}`,{zIndex:_-1,evented:!1,left:t,top:e,height:this.rotateAnchorOffset,width:1,strokeWidth:this.borderStrokeWidth,stroke:this.borderStroke}),{left:o,top:l}=this._getRotateAnchorPosition(Eh.ROTATE,i,s,r,a),h=this._getRotateAnchorCursor(Eh.ROTATE),c=new Wa(`${Eh.ROTATE}_${_}`,{zIndex:_-1,left:o,top:l,height:this.rotateSize,width:this.rotateSize,radius:this.rotateCornerRadius,strokeWidth:2*this.borderStrokeWidth,stroke:this.borderStroke});this._attachEventToRotate(c),this._attachHover(c,h,_r.DEFAULT),p.push(n,c)}if(this.resizeEnabled)for(let h=0,T=this.enabledAnchors.length;h<T;h++){if(1!==this.enabledAnchors[h])continue;const e=Ih[h],n=this._createResizeAnchor(e,t,_);this._attachEventToAnchor(n,e),p.push(n)}const m=new Ha(`${Eh.GROUP}_${_}`,...p);m.zIndex=_,m.evented=!1,m.transformByState({left:e,top:n});const f=this.getScene();return f.addObject(m,2),console.log(f,t),this._transformerControlMap.set(g,m),this.onCreateControlObservable.notifyObservers(m),m}_getTopScene(){var t;return null==(t=this.getScene().getEngine())?void 0:t.activeScene}_moving(t,e,n){const{scrollX:i,scrollY:s}=Oa(n),o=t-this._viewportScrollX+i,r=e-this._viewportScrollY+s,a=o-this._startOffsetX,l=r-this._startOffsetY;this._selectedObjectMap.forEach((t=>{t.translate(a+t.left,l+t.top)})),this.onChangingObservable.notifyObservers({objects:this._selectedObjectMap,moveX:a,moveY:l,type:1}),this._startOffsetX=o,this._startOffsetY=r}_updateActiveObjectList(t,e){this._selectedObjectMap.has(t.oKey)||(e.ctrlKey||(this._selectedObjectMap.clear(),this._clearControl()),this._selectedObjectMap.set(t.oKey,t),this._createControl(t))}_addCancelObserver(t){t.onPointerDownObserver.remove(this._cancelFocusObserver),this._cancelFocusObserver=t.onPointerDownObserver.add((e=>{this._selectedObjectMap.clear(),this._clearControl(),t.onPointerDownObserver.remove(this._cancelFocusObserver)}))}}class Mh{constructor(t,e,n){var i;if(this._parent=e,this.onPointerDownObserver=new y,this.onPointerMoveObserver=new y,this.onPointerUpObserver=new y,this.onDblclickObserver=new y,this.onMouseWheelObserver=new y,this.onKeyDownObservable=new y,this.onKeyUpObservable=new y,this.onTransformChangeObservable=new y,this._layers=[],this._sceneKey="",this._viewports=[],this._width=100,this._height=100,this._scaleX=1,this._scaleY=1,this._transform=new Ta,this._isFirstDirty=!0,this._evented=!0,this._cursor=_r.DEFAULT,this._transformerOpenState=!1,this._sceneKey=t,n&&this.transformByState(n),this._parent.classType===Ir.ENGINE){const e=this._parent;e.addScene(this),e.hasActiveScene()||e.setActiveScene(t),this._inputManager=new Pa(this)}else if(this._parent.classType===Ir.SCENE_VIEWER){this._parent.addSubScene(this)}null==(i=this._parent)||i.onTransformChangeObservable.add((t=>{this._resetViewportSize(),this._setTransForm()}))}get classType(){return Ir.SCENE}get transform(){return this._transform}get width(){return this._width}get height(){return this._height}get scaleX(){return this._scaleX}get scaleY(){return this._scaleY}get ancestorScaleX(){const t=this.getParent();let e=1;return t.classType===Ir.SCENE_VIEWER&&(e=t.ancestorScaleX),this._scaleX*e}get ancestorScaleY(){const t=this.getParent();let e=1;return t.classType===Ir.SCENE_VIEWER&&(e=t.ancestorScaleY),this._scaleY*e}get cursor(){return this._cursor}get sceneKey(){return this._sceneKey}get evented(){return this._evented}set transform(t){this._transform=t}set cursor(t){this.setCursor(t)}set width(t){this._width=t}set height(t){this._height=t}set scaleX(t){this._scaleX=t}set scaleY(t){this._scaleY=t}attachControl(t=!0,e=!0,n=!0,i=!0){var s;if(this._parent.classType===Ir.ENGINE)return null==(s=this._inputManager)||s.attachControl(t,e,n,i),this}detachControl(){var t;return null==(t=this._inputManager)||t.detachControl(),this}makeDirty(t=!0){var e;return this._viewports.forEach((e=>{e.makeDirty(t)})),this._parent.classType===Ir.SCENE_VIEWER&&(null==(e=this._parent)||e.makeDirty(t)),this}makeDirtyNoParent(t=!0){return this._viewports.forEach((e=>{e.makeDirty(t)})),this}isDirty(){for(let t=0;t<this._viewports.length;t++){if(!0===this._viewports[t].isDirty())return!0}return!1}resetCursor(){this.setCursor(_r.DEFAULT)}setCursor(t){this._cursor=t;const e=this.getEngine();if(!e)return;e.getCanvas().getCanvasEle().style.cursor=t}resize(t,e){const n=this.width;void 0!==t&&(this.width=t);const i=this.height;return void 0!==e&&(this.height=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.resize,value:{width:this.width,height:this.height},preValue:{width:n,height:i}}),this}scale(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX=t);const i=this.scaleY;return void 0!==e&&(this.scaleY=e),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:i}}),this}scaleBy(t,e){const n=this.scaleX;void 0!==t&&(this.scaleX+=t);const i=this.scaleY;return void 0!==e&&(this.scaleY+=e),this.scaleX=ia(this.scaleX,1),this.scaleY=ia(this.scaleY,1),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.scale,value:{scaleX:this.scaleX,scaleY:this.scaleY},preValue:{scaleX:n,scaleY:i}}),this}transformByState(t){const e=Object.keys(t),n={};0!==e.length&&(e.forEach((e=>{void 0!==t[e]&&(n[e]=this[e],this[e]=t[e])})),this._setTransForm(),this.onTransformChangeObservable.notifyObservers({type:Wr.all,value:t,preValue:n}))}getParent(){return this._parent}getEngine(){if(this._parent.classType===Ir.ENGINE)return this._parent;let t=this._parent;for(;t;){if(t.classType===Ir.ENGINE)return t;t=null==t?void 0:t.getParent()}return null}getLayers(){return this._layers}getLayer(t=1){for(let e of this._layers)if(e.zIndex===t)return e;return this._createDefaultLayer(t)}getLayerMaxZIndex(){let t=Number.MIN_VALUE;for(let e=0;e<this._layers.length;e++){const n=this._layers[e];n.zIndex>=t&&(t=n.zIndex)}return t}addLayer(...t){this._layers.push(...t)}addObject(t,e=1){var n;return null==(n=this.getLayer(e))||n.addObject(t),this}setObjectBehavior(t){t.parent||(t.parent=this),this.onTransformChangeObservable.add((e=>{t.scaleCacheCanvas()})),t.onIsAddedToParentObserver.notifyObservers(this)}addObjects(t,e=1){var n;return null==(n=this.getLayer(e))||n.addObjects(t),this}removeObject(t){if(null==t)return;const e=this.getLayers();for(let n of e)n.removeObject(t);return this}removeObjects(t){if(null==t)return;const e=this.getLayers();for(let n of e)n.removeObjects(t);return this}getAllObjects(){const t=[];this._layers.sort(ci);for(let e of this._layers)t.push(...e.getObjectsByOrder());return t}getAllObjectsByOrder(t=!1){const e=[],n=t?di:ci;this._layers.sort(n);for(let i of this._layers)e.push(...i.getObjectsByOrder().sort(n));return e}getAllObjectsByOrderForPick(t=!1){const e=[],n=t?di:ci;this._layers.sort(n);for(let i of this._layers)e.push(...i.getObjectsByOrderForPick().sort(n));return e}getObject(t){for(let e of this._layers){const n=e.getObjectsByOrder();for(let e of n)if(e.oKey===t)return e}}fuzzyMathObjects(t){for(let e of this._layers){const n=e.getObjectsByOrder();for(let e of n)e.oKey.indexOf(t)>-1&&n.push(e)}return[]}addViewport(...t){return this._viewports.push(...t),this}removeViewport(){}getViewports(){return this._viewports}getViewport(t){for(let e of this._viewports)if(e.viewPortKey===t)return e}changeObjectOrder(){}renderObjects(t,e){return this.getAllObjectsByOrder().forEach((n=>{n.render(t,e)})),this}render(t){var e,n;this.isDirty()&&(!t&&(null==(e=this.getEngine())||e.getCanvas().clear()),null==(n=this.getViewports())||n.forEach((e=>e.render(t))))}enableEvent(){this._evented=!0}disableEvent(){this._evented=!1}async requestRender(t){return new Promise(((e,n)=>{this.render(t),Zr(e)}))}openTransformer(t){this._transformer||(this._transformer=new Dh(this,t)),this._transformerOpenState=!0}closeTransformer(t=!1){t&&(this._transformer=null),this._transformerOpenState=!1}applyTransformer(t){var e;this._transformerOpenState&&(null==(e=this._transformer)||e.attachTo(t))}getTransformer(){return this._transformer}getActiveViewportByRelativeCoord(t){return this._viewports.find((e=>e.isHit(t)))}getActiveViewportByCoord(t){return t=this.getRelativeCoord(t),this.getActiveViewportByRelativeCoord(t)}getRelativeCoord(t){let e=this.getParent();const n=[];for(;e;)e.classType!==Ir.SCENE&&e.classType!==Ir.SCENE_VIEWER||n.push(e),e=(null==e?void 0:e.getParent)&&(null==e?void 0:e.getParent());n.reverse();for(let i of n)if(i.classType===Ir.SCENE){const e=i.getActiveViewportByCoord(t);if(e){const n=e.actualScrollX||0,i=e.actualScrollY||0;t=t.addByPoint(n,i)}}else if(i.classType===Ir.SCENE_VIEWER){t=i.transform.clone().invert().applyPoint(t)}return t}transformToSceneCoord(t){const e=this.getActiveViewportByCoord(t);return null==e?void 0:e.getRelativeVector(t)}clearLayer(){this._layers=[]}clearViewports(){this._viewports=[]}dispose(){var t;this.getLayers().forEach((t=>{t.dispose()})),this.getViewports().forEach((t=>{t.dispose()})),this.clearLayer(),this.clearViewports(),this.detachControl(),null==(t=this._transformer)||t.dispose(),this.onPointerDownObserver.clear(),this.onPointerMoveObserver.clear(),this.onPointerUpObserver.clear(),this.onDblclickObserver.clear(),this.onMouseWheelObserver.clear(),this.onKeyDownObservable.clear(),this.onKeyUpObservable.clear()}pick(t){let e=this.getActiveViewportByCoord(t);if(e||(e=this._viewports[0]),!this._evented||!e)return;const n=e.pickScrollBar(t);if(n)return n;const i=e.getRelativeVector(t);let s=null;const o=this.getAllObjectsByOrderForPick().reverse(),r=o.length;for(let a=0;a<r;a++){const t=o[a];if(!t.visible||!t.evented||t.classType===Ir.GROUP)continue;let e=i;if(t.isInGroup&&t.parent.classType===Ir.GROUP){const{cumLeft:n,cumTop:i}=this._getGroupCumLeftRight(t);e=e.clone().add(ma.FromArray([-n,-i]))}if(t.isHit(e)){if(t.classType===Ir.SCENE_VIEWER){const n=t.pick(e);s=n||t.getActiveSubScene()}else s=t;break}if(t.classType===Ir.SCENE_VIEWER&&t.allowSelectedClipElement()){const n=t.pick(e);if(n){s=n;break}}}return s||this._parent.classType!==Ir.ENGINE?s:this}on(t,e){return this[`on${t}Observer`].add(e.bind(this))}off(t,e){this[`on${t}Observer`].remove(e)}remove(t){this[`on${t}Observer`].clear()}triggerKeyDown(t){this.onKeyDownObservable.notifyObservers(t)}triggerKeyUp(t){this.onKeyUpObservable.notifyObservers(t)}triggerPointerUp(t){var e,n;return!(!(null==(e=this.onPointerUpObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Ir.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerUp(t),!1)}triggerMouseWheel(t){var e,n;return!(!(null==(e=this.onMouseWheelObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Ir.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerMouseWheel(t),!1)}triggerPointerMove(t){var e,n;return!(!(null==(e=this.onPointerMoveObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Ir.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerMove(t),!1)}triggerDblclick(t){var e,n;return!(!(null==(e=this.onDblclickObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Ir.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerDblclick(t),!1)}triggerPointerDown(t){var e,n;return!(!(null==(e=this.onPointerDownObserver.notifyObservers(t))?void 0:e.stopPropagation)&&this._parent.classType===Ir.SCENE_VIEWER)||(null==(n=this._parent)||n.triggerPointerDown(t),!1)}triggerPointerOut(t){var e;return this._parent.classType!==Ir.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerOut(t),!1)}triggerPointerLeave(t){var e;return this._parent.classType!==Ir.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerLeave(t),!1)}triggerPointerOver(t){var e;return this._parent.classType!==Ir.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerOver(t),!1)}triggerPointerEnter(t){var e;return this._parent.classType!==Ir.SCENE_VIEWER||(null==(e=this._parent)||e.triggerPointerEnter(t),!1)}_createDefaultLayer(t=1){const e=class{constructor(t,e=[],n=1){this._scene=t,this._zIndex=n,this._objects=[],this.addObjects(e)}get scene(){return this._scene}get zIndex(){return this._zIndex}static create(t,e=[],n=1e3){return new this(t,e,n)}getObjectsByOrder(){const t=[];this._objects.sort(ci);for(let e of this._objects)!e.isInGroup&&e.visible&&t.push(e);return t}getObjectsByOrderForPick(){const t=[];this._objects.sort(ci);for(let e of this._objects)e.classType!==Ir.GROUP&&e.visible&&t.push(e);return t}getObjects(){return this._objects}addObject(t){if(t.classType===Ir.GROUP){const e=t.getObjects();for(let t of e)this.scene.getObject(t.oKey)||(this._objects.push(t),this.scene.setObjectBehavior(t))}return this._objects.push(t),this.scene.setObjectBehavior(t),this.scene.applyTransformer(t),this}removeObject(t){const e=this.getObjects(),n=e.length;if(t instanceof ya){for(let i=0;i<n;i++)if(e[i]===t)return void e.splice(i,1)}else for(let i=0;i<n;i++)if(e[i].oKey===t)return void e.splice(i,1)}addObjects(t){return t.forEach((t=>{this.addObject(t)})),this}removeObjects(t){const e=this.getObjects();for(let n=e.length-1;n>=0;n--){let i=e[n];const s=t.length;if(0===s)break;for(let o=0;o<s;o++){const s=t[o];if(i=s instanceof ya?i:i.oKey,i===s){e.splice(n,1);break}}}}clear(){this._objects=[]}dispose(){this.getObjects().forEach((t=>{t.dispose()})),this.clear()}}.create(this,[],t);return this.addLayer(e),e}_resetViewportSize(){this.getViewports().forEach((t=>{t.resetSize()}))}_setTransForm(){const t=Ta.create().composeMatrix({scaleX:this.scaleX,scaleY:this.scaleY});this.transform=t,this.getViewports().forEach((t=>{t.resizeScrollBar()})),this.makeDirty(!0)}_getGroupCumLeftRight(t){let e=t.parent,n=0,i=0;for(;e.classType===Ir.GROUP;){const{left:t,top:s}=e;n+=t,i+=s,e=e.parent}return{cumLeft:n,cumTop:i}}}class xh extends ya{constructor(t,e){super(t),this._subScenes=new Map,this._allowSelectedClipElement=!1,this._initialProps(e)}get classType(){return Ir.SCENE_VIEWER}render(t,e){var n;if(!this.visible)return this.makeDirty(!1),this;if(e){const{minX:t,maxX:n,minY:i,maxY:s}=Da(this,e);if(this.width+this.strokeWidth<t||n<0||this.height+this.strokeWidth<i||s<0)return this}const i=this.transform.getMatrix();return t.save(),t.transform(i[0],i[1],i[2],i[3],i[4],i[5]),null==(n=this._activeSubScene)||n.makeDirtyNoParent(!0).render(t),t.restore(),this.makeDirty(!1),this}getSubScenes(){return this._subScenes}getActiveSubScene(){return this._activeSubScene}getSubScene(t){for(let[e,n]of this._subScenes)if(e===t)return n}addSubScene(t){this._activeSubScene=t,this._subScenes.set(t.sceneKey,t),this.makeDirty()}removeSubScene(t){const e=this._subScenes.get(t);this._subScenes.delete(t),this._activeSubScene===e&&(this._activeSubScene=this._subScenes.values().next().value),this.makeDirty()}activeSubScene(t){if(null==t)return;const e=this._subScenes.get(t);this._activeSubScene!==e&&(this._activeSubScene=e,this.makeDirty())}enableSelectedClipElement(){this._allowSelectedClipElement=!0}disableSelectedClipElement(){this._allowSelectedClipElement=!1}allowSelectedClipElement(){return this._allowSelectedClipElement}pick(t){var e;if(void 0===this._activeSubScene)return;const n=this.transform.clone().invert().applyPoint(t);return null==(e=this._activeSubScene)?void 0:e.pick(n)}dispose(){super.dispose(),this._subScenes.forEach((t=>{t.dispose()}))}_initialProps(t){if(!t)return;const e=Object.keys(t);if(0===e.length)return;const n={};let i=!1;e.forEach((e=>{if(void 0===t[e])return!0;n[e]=t[e],i=!0})),i&&this.transformByState(n),this.makeDirty(!0)}}(wh=Ah||(Ah={}))[wh.scrollTo=0]="scrollTo",wh[wh.scrollBy=1]="scrollBy";class Lh{constructor(t,e,n){var i;this.scrollX=0,this.scrollY=0,this.onMouseWheelObserver=new y,this.onScrollAfterObserver=new y,this.onScrollBeforeObserver=new y,this.onScrollStopObserver=new y,this._dirty=!0,this._topOrigin=0,this._leftOrigin=0,this._bottomOrigin=0,this._rightOrigin=0,this._top=0,this._left=0,this._bottom=0,this._right=0,this._isWheelPreventDefaultX=!1,this._isWheelPreventDefaultY=!1,this._allowCache=!1,this._preScrollX=0,this._preScrollY=0,this._renderClipState=!0,this._viewPortKey=t,this._scene=e,this.top=(null==n?void 0:n.top)||0,this.left=(null==n?void 0:n.left)||0,this.bottom=(null==n?void 0:n.bottom)||0,this.right=(null==n?void 0:n.right)||0,(null==n?void 0:n.width)&&(this.width=null==n?void 0:n.width,this._widthOrigin=this.width),(null==n?void 0:n.height)&&(this.height=null==n?void 0:n.height,this._heightOrigin=this.height),this._allowCache&&(this._cacheCanvas=new xa),this._isWheelPreventDefaultX=(null==n?void 0:n.isWheelPreventDefaultX)||!1,this._isWheelPreventDefaultY=(null==n?void 0:n.isWheelPreventDefaultY)||!1,this._resizeCacheCanvasAndScrollBar(),null==(i=this._scene)||i.getParent().onTransformChangeObservable.add((()=>{this._resizeCacheCanvasAndScrollBar()}))}get scene(){return this._scene}get width(){return this._width}get height(){return this._height}get viewPortKey(){return this._viewPortKey}get topOrigin(){return this._topOrigin}get leftOrigin(){return this._leftOrigin}get bottomOrigin(){return this._bottomOrigin}get rightOrigin(){return this._rightOrigin}get top(){return this._top}get left(){return this._left}get bottom(){return this._bottom}get right(){return this._right}set width(t){this._width=t}set height(t){this._height=t}set top(t){var e,n;this._topOrigin=t,this._top=$r(t,null==(n=null==(e=this._scene)?void 0:e.getParent())?void 0:n.height)}set left(t){var e;this._leftOrigin=t,this._left=$r(t,null==(e=this.scene.getParent())?void 0:e.width)}set bottom(t){var e;this._bottomOrigin=t,this._bottom=$r(t,null==(e=this.scene.getParent())?void 0:e.height)}set right(t){var e;this._rightOrigin=t,this._right=$r(t,null==(e=this.scene.getParent())?void 0:e.width)}resetSize(){this._resizeCacheCanvasAndScrollBar(!0)}setScrollBar(t){this._scrollBar&&console.warn("Old scrollBar will be replaced "),this._scrollBar=t,this._resizeCacheCanvasAndScrollBar()}resize(t){const e=Object.keys(t);0!==e.length&&(this._width=void 0,this._height=void 0,e.forEach((e=>{void 0!==t[e]&&(this[e]=t[e])})),this._resizeCacheCanvasAndScrollBar())}resizeScrollBar(){this._resizeCacheCanvasAndScrollBar()}makeDirty(t=!0){this._dirty=t}isDirty(){return this._dirty}scrollTo(t){return this._scroll(0,t)}scrollBy(t){return this._scroll(1,t)}getBarScroll(t,e){let n=t,i=e;if(this._scrollBar){n*=this._scrollBar.ratioScrollX,i*=this._scrollBar.ratioScrollY;const{scaleX:t,scaleY:e}=this.scene;n=Math.round(n)*t,i=Math.round(i)*e}else void 0!==this.scrollX&&(n=this.scrollX),void 0!==this.scrollY&&(i=this.scrollY);return{x:n,y:i}}getActualScroll(t,e){let n=t,i=e;if(this._scrollBar){n/=this._scrollBar.ratioScrollX,i/=this._scrollBar.ratioScrollY;const{scaleX:t,scaleY:e}=this.scene;n=Math.round(n)/t,i=Math.round(i)/e}else void 0!==this.actualScrollX&&(n=this.actualScrollX),void 0!==this.actualScrollY&&(i=this.actualScrollY);return{x:n,y:i}}transformScroll(){let t=this.scrollX,e=this.scrollY;return this.getActualScroll(t,e)}getScrollBar(){return this._scrollBar}updateScroll(t){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY;const{scrollX:e,scrollY:n,actualScrollX:i,actualScrollY:s}=t;return void 0!==e&&(this.scrollX=e),void 0!==n&&(this.scrollY=n),void 0!==i&&(this.actualScrollX=i),void 0!==s&&(this.actualScrollY=s),this}getScrollBarTransForm(t=!1){const e=Ta.create();return!t&&this._allowCache||e.multiply(Ta.create([1,0,0,1,this._left,this._top])),e}render(t){var e;const n=t||(null==(e=this._scene.getEngine())?void 0:e.getCanvas().getContext());if(!this.isDirty()&&this._allowCache)return void this._applyCache(n);let i=this._scene.transform.clone();i.multiply(Ta.create([1,0,0,1,-this.actualScrollX||0,-this.actualScrollY||0]));let s=n;if(!s)return;const o=this._getApplyCanvasState();o&&(i.multiply(Ta.create([1,0,0,1,-this.left/this._scene.scaleX,-this.top/this._scene.scaleY])),s=this._cacheCanvas.getContext(),this._cacheCanvas.clear());const r=i.getMatrix(),a=this.getScrollBarTransForm().getMatrix();s.save(),!o&&this._renderClipState&&(s.beginPath(),s.rect(this.left,this.top,this.width||0,this.height||0),s.clip()),s.transform(r[0],r[1],r[2],r[3],r[4],r[5]),this._scene.renderObjects(s,this._calViewportRelativeBounding()),s.restore(),this._scrollBar&&(s.save(),s.transform(a[0],a[1],a[2],a[3],a[4],a[5]),this.drawScrollbar(s),s.restore()),o&&this._applyCache(n),this.makeDirty(!1),this._scrollRendered()}getBounding(){return this._calViewportRelativeBounding()}getRelativeVector(t){const e=this.scene.transform.clone().invert(),n=this.transformScroll();return e.applyPoint(t).add(ma.FromArray([n.x,n.y]))}getAbsoluteVector(t){const e=this.scene.transform.clone(),n=this.transformScroll();return e.applyPoint(t).subtract(ma.FromArray([n.x,n.y]))}onMouseWheel(t,e){if(!this._scrollBar)return;let n;if(t.inputIndex===Ur.MouseWheelX){const i=Math.abs(t.deltaX),s=this._scene.width;let o=(this.width||1)/s*i;n=t.deltaX>0?this.scrollBy({x:o}):this.scrollBy({x:-o}),this._scene.getParent().classType===Ir.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||e.stopPropagation():this._isWheelPreventDefaultX?t.preventDefault():(null==n?void 0:n.isLimitedX)||t.preventDefault()}if(t.inputIndex===Ur.MouseWheelY){const i=Math.abs(t.deltaY),s=this._scene.height;let o=(this.height||1)/s*i;t.shiftKey?(n=t.deltaY>0?this.scrollBy({x:o}):this.scrollBy({x:-o}),this._scene.getParent().classType===Ir.SCENE_VIEWER?(null==n?void 0:n.isLimitedX)||e.stopPropagation():this._isWheelPreventDefaultX?t.preventDefault():(null==n?void 0:n.isLimitedX)||t.preventDefault()):(n=t.deltaY>0?this.scrollBy({y:o}):this.scrollBy({y:-o}),this._scene.getParent().classType===Ir.SCENE_VIEWER?(null==n?void 0:n.isLimitedY)||e.stopPropagation():this._isWheelPreventDefaultY?t.preventDefault():(null==n?void 0:n.isLimitedY)||t.preventDefault())}t.inputIndex,Ur.MouseWheelZ}isHit(t){const{width:e,height:n}=this._getViewPortSize();return t.x>=this.left&&t.x<=this.left+e&&t.y>=this.top&&t.y<=this.top+n}pickScrollBar(t){if(!this._scrollBar)return;const e=this.getScrollBarTransForm(!0).invert().applyPoint(t);return this._scrollBar.pick(e)}openClip(){this._renderClipState=!0}closeClip(){this._renderClipState=!1}dispose(){var t;this.onMouseWheelObserver.clear(),this.onScrollAfterObserver.clear(),this.onScrollBeforeObserver.clear(),this.onScrollStopObserver.clear(),null==(t=this._scrollBar)||t.dispose()}_resizeCacheCanvasAndScrollBar(t=!1){var e;const{width:n,height:i}=this._getViewPortSize(t);this.width=n,this.height=i;const s=this._scene.width*this._scene.scaleX,o=this._scene.height*this._scene.scaleY;null==(e=this._scrollBar)||e.resize(n,i,s,o),this.makeDirty(!0)}_getViewPortSize(t=!1){var e;const n=null==(e=this._scene)?void 0:e.getParent();let i,s;if(t||void 0===this._widthOrigin){const t=n.width;i=(n.classType===Ir.SCENE_VIEWER?t*n.scaleX:t)-(this._left+this._right)}else i=this._widthOrigin;if(t||void 0===this._heightOrigin){const t=n.height;s=(n.classType===Ir.SCENE_VIEWER?t*n.scaleY:t)-(this._top+this._bottom)}else s=this._heightOrigin;return{width:i,height:s}}_getApplyCanvasState(){return this._allowCache&&this._renderClipState}_scrollRendered(){this._preScrollX=this.scrollX,this._preScrollY=this.scrollY}_limitedScroll(){var t,e;if(!this._scrollBar)return;const n=(null==(t=this._scrollBar)?void 0:t.limitX)||1/0,i=(null==(e=this._scrollBar)?void 0:e.limitY)||1/0;let s=!0,o=!0;return this.scrollX<0?this.scrollX=0:this.scrollX>n?this.scrollX=n:s=!1,this.scrollY<0?this.scrollY=0:this.scrollY>i?this.scrollY=i:o=!1,{isLimitedX:s,isLimitedY:o}}_triggerScrollStop(t,e,n){window.clearTimeout(this._scrollStopNum),this._scrollStopNum=window.setTimeout((()=>{var i,s;this.onScrollStopObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:e,y:n,actualScrollX:t.x,actualScrollY:t.y,limitX:null==(i=this._scrollBar)?void 0:i.limitX,limitY:null==(s=this._scrollBar)?void 0:s.limitY})}),0)}_scroll(t,e){var n,i,s,o;const{x:r,y:a}=e;void 0!==r&&(1===t?this.scrollX+=r:this.scrollX=r),void 0!==a&&(1===t?this.scrollY+=a:this.scrollY=a);const l=this._limitedScroll();this.onScrollBeforeObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:r,y:a,limitX:null==(n=this._scrollBar)?void 0:n.limitX,limitY:null==(i=this._scrollBar)?void 0:i.limitY}),this._scrollBar?this._scrollBar.makeDirty(!0):this.makeDirty(!0);const h=this.transformScroll();return this.actualScrollX=h.x,this.actualScrollY=h.y,this.onScrollAfterObserver.notifyObservers({viewport:this,scrollX:this.scrollX,scrollY:this.scrollY,x:r,y:a,actualScrollX:h.x,actualScrollY:h.y,limitX:null==(s=this._scrollBar)?void 0:s.limitX,limitY:null==(o=this._scrollBar)?void 0:o.limitY}),this._triggerScrollStop(h,r,a),l}_calViewportRelativeBounding(){var t,e,n,i;let s=null!=(e=null==(t=this._scrollBar)?void 0:t.ratioScrollX)?e:1,o=null!=(i=null==(n=this._scrollBar)?void 0:n.ratioScrollY)?i:1,r=this.left,a=(this.width||0)+this.left,l=this.top,h=(this.height||0)+this.top,c=0,d=0;null!=this._preScrollX&&(c=(this._preScrollX-this.scrollX)/s),null!=this._preScrollY&&(d=(this._preScrollY-this.scrollY)/o);const u={tl:ma.FromArray([r,l]),tr:ma.FromArray([a,l]),bl:ma.FromArray([r,h]),br:ma.FromArray([a,h]),dx:c,dy:d};return u.tl=this.getRelativeVector(u.tl),u.tr=this.getRelativeVector(u.tr),u.bl=this.getRelativeVector(u.bl),u.br=this.getRelativeVector(u.br),u}drawScrollbar(t){if(!this._scrollBar)return;const e=this._scene.getParent();(e.classType===Ir.SCENE_VIEWER||e.classType===Ir.ENGINE)&&this._scrollBar.render(t)}_applyCache(t){if(!t)return;const e=this._cacheCanvas.getPixelRatio(),n=this._cacheCanvas.getWidth()*e,i=this._cacheCanvas.getHeight()*e;t.drawImage(this._cacheCanvas.getCanvasEle(),0,0,n,i,this.left,this.top,this.width||0,this.height||0)}}(Nh=Rh||(Rh={}))[Nh.OFF=0]="OFF",Nh[Nh.ON=1]="ON";class kh extends Jl{constructor(t,e){super(t),this._skeleton=e}getSkeleton(){return this._skeleton}updateSkeleton(t){this._skeleton=t}render(t,e){if(!this.visible)return this.makeDirty(!1),this;t.save(),this._draw(t,e),t.restore()}getParentScale(){let{scaleX:t=1,scaleY:e=1}=this.parent;return this.parent.classType===Ir.SCENE_VIEWER&&(t=this.parent.ancestorScaleX||1,e=this.parent.ancestorScaleY||1),{scaleX:t,scaleY:e}}_getBounding(t,e,n){const i=t.length,s=e.length;if(!n)return{startRow:0,endRow:i-1,startColumn:0,endColumn:s-1};let o=-1,r=-1,a=-1,l=-1;return o=M(t,n.tl.y),r=M(t,n.bl.y),-1===o&&(o=0),-1===r&&(r=i-1),r>=i&&(r=i-1),a=M(e,n.tl.x),l=M(e,n.tr.x),-1===a&&(a=0),-1===l&&(l=s-1),l>=s&&(l=s-1),{startRow:o-1,endRow:r+1,startColumn:a-1,endColumn:l+1}}_draw(t,e){}}class Ph extends kh{_draw(t,e){this.draw(t,e)}}(Oh=yh||(yh={}))[Oh.GRID=0]="GRID";class Hh extends eh{constructor(){super(...arguments),this.type=0}getCellIndex(t,e,n,i,s){return ua(t,e,n,i,s)}}nh.add(new class extends Hh{constructor(){super(...arguments),this.uKey="DefaultBackgroundExtension",this.zIndex=20}draw(t,e,n){const{rowTitleWidth:i,columnTitleHeight:s,dataMergeCache:o,stylesCache:r}=n,{background:a}=r;if(!n)return;const{rowHeightAccumulation:l,columnTotalWidth:h,columnWidthAccumulation:c,rowTotalHeight:d}=n;if(!l||!c||void 0===h||void 0===d)return;t.save();const{scaleX:u=1,scaleY:g=1}=e;a&&Object.keys(a).forEach((e=>{const n=a[e];t.fillStyle=e||Kr([255,255,255]),t.beginPath(),n.forEach(((e,n)=>{n.forEach((n=>{let{isMerged:i,startY:s,endY:r,startX:a,endX:h}=this.getCellIndex(e,n,l,c,o);if(i)return!0;s=sa(s,g),r=sa(r,g),a=sa(a,u),h=sa(h,u),t.moveTo(a,s),t.lineTo(a,r),t.lineTo(h,r),t.lineTo(h,s)}))})),t.closePath(),t.fill()})),t.restore()}});nh.add(new class extends Hh{constructor(){super(...arguments),this.uKey="DefaultBorderExtension",this.zIndex=30}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:s,columnTitleHeight:o,dataMergeCache:r,stylesCache:a,overflowCache:l}=n,{border:h}=a;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;t.save();const{scaleX:_=1,scaleY:p=1}=e,m=this._getScale(e);let f,T;null==h||h.forEach(((e,n)=>{null==n||n.forEach(((n,i)=>{if(!i)return!0;let{isMerged:s,startY:o,endY:a,startX:h,endX:d}=this.getCellIndex(e,n,c,u,r);if(s)return!0;o=sa(o,p),a=sa(a,p),h=sa(h,_),d=sa(d,_);for(let r in i){const{type:s,style:c,color:u}=i[r];this._getOverflowExclusion(l,s,e,n)||(c!==f&&(Ea(t,c),t.lineWidth=ba(c)/m,f=c),u!==T&&(t.strokeStyle=u||"rgb(0,0,0)",T=u),va(t,s,{startX:h,startY:o,endX:d,endY:a}))}}))})),t.closePath(),t.restore()}_getOverflowExclusion(t,e,n,i){let s=!1;return e===Tr.TOP||e===Tr.BOTTOM||t&&t.forEach(((t,i)=>{if(t!==n)return!0;i.forEach(((t,n)=>{const{startColumn:i,endColumn:o}=n;return e===Tr.LEFT&&t>i&&t<=o||e===Tr.RIGHT&&t>=i&&t<o?(s=!0,!1):void 0}))})),s}});nh.add(new class extends Hh{constructor(){super(...arguments),this.uKey="DefaultBorderAuxiliaryExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:s=0,columnTitleHeight:o=0,dataMergeCache:r,overflowCache:a,stylesCache:l,showGridlines:h}=n,{startRow:c,endRow:d,startColumn:u,endColumn:g}=i;if(!n||h===Ue.FALSE)return;const{rowHeightAccumulation:_,columnTotalWidth:p,columnWidthAccumulation:m,rowTotalHeight:f}=n;if(!_||!m||void 0===p||void 0===f)return;t.save();const T=this._getScale(e);t.beginPath(),t.lineWidth=1/T,t.strokeStyle=Kr([217,217,217]);let v=sa(p,T),E=sa(f,T);const b=m.length,I=_.length;for(let C=c-1;C<=d;C++){if(C<0||C>I-1)continue;const e=sa(_[C],T);t.moveTo(0,e),t.lineTo(v,e)}for(let C=u;C<=g;C++){if(C<0||C>b-1)continue;const e=sa(m[C],T);t.moveTo(e,0),t.lineTo(e,E)}t.stroke(),t.closePath(),this._clearRectangle(t,T,_,m,r),this._clearRectangle(t,T,_,m,a),t.restore()}_clearRectangle(t,e,n,i,s){null==s||s.forEach(((s,o)=>{null==o||o.forEach(((s,o)=>{const{startRow:r,endRow:a,startColumn:l,endColumn:h}=o,c=sa(n[r-1]||0,e),d=sa(n[a],e),u=sa(i[l-1]||0,e),g=sa(i[h],e);t.clearRect(u,c,g-u,d-c),t.beginPath(),t.moveTo(u,c),t.lineTo(g,c),t.lineTo(g,d),t.lineTo(u,d),t.lineTo(u,c),t.stroke(),t.closePath()}))}))}});nh.add(new class extends Hh{constructor(){super(...arguments),this.uKey="DefaultFontExtension",this.zIndex=40}getDocuments(){return this.parent.getDocuments()}setChangeFontColor(t,e,n){this.changeFontColor.setValue(t,e,n)}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:s,columnTitleHeight:o,stylesCache:r,dataMergeCache:a,overflowCache:l}=n,{font:h}=r;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;t.save();const _=this._getScale(e),{scaleX:p=1,scaleY:m=1}=e;h&&Object.keys(h).forEach((e=>{h[e].forEach(((e,n)=>{n.forEach(((n,i)=>{let{isMerged:s,isMergedMainCell:o,startY:r,endY:h,startX:d,endX:g,mergeInfo:f}=this.getCellIndex(e,n,c,u,a);if(s)return!0;r=sa(r,m),h=sa(h,m),d=sa(d,p),g=sa(g,p);const T=g-d,v=h-r,E=l.getValue(e,n),{horizontalAlign:b}=i;if(t.save(),t.beginPath(),E){const{startColumn:i,startRow:s,endColumn:o,endRow:a}=E;i===o&&i===n?t.rect(d,r,T,v):b===Ne.CENTER?this._clipRectangle(t,s,a,i,o,_,c,u):b===Ne.RIGHT?this._clipRectangle(t,s,e,i,n,_,c,u):this._clipRectangle(t,e,a,n,o,_,c,u)}else t.rect(d,r,T,v);t.clip(),t.translate(d,r),this._renderDocuments(t,i,d,r,g,h,e,n),t.restore()}))}))})),t.restore()}_renderDocuments(t,e,n,i,s,o,r,a){const l=this.getDocuments(),{documentSkeleton:h,angle:c,verticalAlign:d,horizontalAlign:u,wrapStrategy:g,content:_}=e,p=s-n,m=o-i;g===Me.WRAP&&0===c&&(h.updateDocumentDataPageSize(p),h.calculate()),h.makeDirty(!1),l.resize(p,m),l.changeSkeleton(h).render(t)}_clipRectangle(t,e,n,i,s,o,r,a){const l=sa(r[e-1]||0,o),h=sa(r[n],o),c=sa(a[i-1]||0,o),d=sa(a[s],o);t.rect(c,l,d-c,h-l)}});ih.add(new class extends Hh{constructor(){super(...arguments),this.uKey="DefaultRowTitleLayoutExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:s=0,columnTitleHeight:o=0}=n,{startRow:r,endRow:a,startColumn:l,endColumn:h}=i;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;const _=this._getScale(e);t.fillStyle=Kr([248,249,250]),t.fillRect(0,0,s,g),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Kr([0,0,0]),t.beginPath(),t.lineWidth=1/_,t.strokeStyle=Kr([217,217,217]);let p=0;const m=c.length;for(let f=r-1;f<=a;f++){if(f<0||f>m-1)continue;const e=sa(c[f],_);if(p===e)continue;t.moveTo(0,e),t.lineTo(s,e);const n=p+(e-p)/2;t.fillText(`${f+1}`,s/2,n+1),p=e}t.moveTo(sa(s,_),0),t.lineTo(sa(s,_),g),t.stroke()}});sh.add(new class extends Hh{constructor(){super(...arguments),this.uKey="DefaultColumnTitleLayoutExtension",this.zIndex=10}draw(t,e,n){const{rowColumnSegment:i,rowTitleWidth:s=0,columnTitleHeight:o=0}=n,{startRow:r,endRow:a,startColumn:l,endColumn:h}=i;if(!n)return;const{rowHeightAccumulation:c,columnTotalWidth:d,columnWidthAccumulation:u,rowTotalHeight:g}=n;if(!c||!u||void 0===d||void 0===g)return;const _=this._getScale(e);t.fillStyle=Kr([248,249,250]),t.fillRect(0,0,d,o),t.textAlign="center",t.textBaseline="middle",t.fillStyle=Kr([0,0,0]),t.beginPath(),t.lineWidth=1/_,t.strokeStyle=Kr([217,217,217]);let p=0;const m=u.length;for(let T=l-1;T<=h;T++){if(T<0||T>m-1)continue;const e=sa(u[T],_);if(p===e)continue;t.moveTo(e,0),t.lineTo(e,o);const n=p+(e-p)/2;t.fillText(ai(T),n,o/2+1),p=e}const f=sa(o,_);t.moveTo(0,f),t.lineTo(d,f),t.stroke()}});class Bh{constructor(t=Gh.NORMAL){this._type=t}get startColumn(){return this._startColumn}get startRow(){return this._startRow}get endColumn(){return this._endColumn}get endRow(){return this._endRow}get startX(){return this._startX}get startY(){return this._startY}get endX(){return this._endX}get endY(){return this._endY}get type(){return this._type}get currentCell(){return this._currentCell}isEqual(t){const{startColumn:e,startRow:n,endColumn:i,endRow:s,type:o}=this,{startColumn:r,startRow:a,endColumn:l,endRow:h}=t;return e===r&&n===a&&i===l&&s===h}isInclude(t){const{startColumn:e,startRow:n,endColumn:i,endRow:s,type:o}=this,{startColumn:r,startRow:a,endColumn:l,endRow:h}=t;return!(l<e||r>i||a>s||h<n)}highlightToSelection(){return kn(this._currentCell)}getValue(){return{selection:{startColumn:this._startColumn,startRow:this._startRow,endColumn:this._endColumn,endRow:this._endRow,startX:this._startX,startY:this._startY,endX:this._endX,endY:this._endY},cell:this._currentCell}}setValue(t,e){const{startColumn:n,startRow:i,endColumn:s,endRow:o,startX:r,startY:a,endX:l,endY:h}=t;this._startColumn=n,this._startRow=i,this._endColumn=s,this._endRow=o,this._startX=r,this._startY=a,this._endX=l,this._endY=h,this.setCurrentCell(e)}setCurrentCell(t){t&&(this._currentCell=t)}clearCurrentCell(){this._currentCell=null}}const Fh="rgb(1,136,251)",Uh="rgba(1,136,251, 0.1)",zh=2,Wh=6,Vh=1,Yh="rgb(255,255,255)";var Gh,Xh,jh,Kh;(Xh=Gh||(Gh={}))[Xh.NORMAL=0]="NORMAL",Xh[Xh.ROW=1]="ROW",Xh[Xh.COLUMN=2]="COLUMN",(Kh=jh||(jh={})).Selection="__SpreadsheetSelectionShape__",Kh.top="__SpreadsheetSelectionTopControl__",Kh.bottom="__SpreadsheetSelectionBottomControl__",Kh.left="__SpreadsheetSelectionShapeLeftControl__",Kh.right="__SpreadsheetSelectionShapeRightControl__",Kh.backgroundTop="__SpreadsheetSelectionBackgroundControlTop__",Kh.backgroundMiddleLeft="__SpreadsheetSelectionBackgroundControlMiddleLeft__",Kh.backgroundMiddleRight="__SpreadsheetSelectionBackgroundControlMiddleRight__",Kh.backgroundBottom="__SpreadsheetSelectionBackgroundControlBottom__",Kh.fill="__SpreadsheetSelectionFillControl__",Kh.lineMain="__SpreadsheetDragLineMainControl__",Kh.lineContent="__SpreadsheetDragLineContentControl__",Kh.line="__SpreadsheetDragLineControl__";class $h{constructor(t,e){this._scene=t,this._zIndex=e,this._initialize()}get zIndex(){return this._zIndex}get leftControl(){return this._leftControl}get rightControl(){return this._rightControl}get topControl(){return this._topControl}get bottomControl(){return this._bottomControl}get fillControl(){return this._fillControl}get backgroundControlTop(){return this._backgroundControlTop}get backgroundControlBottom(){return this._backgroundControlBottom}get backgroundControlMiddleLeft(){return this._backgroundControlMiddleLeft}get backgroundControlMiddleRight(){return this._backgroundControlMiddleRight}get selectionShape(){return this._selectionShape}get model(){return this._selectionModel}static create(t,e){return new this(t,e)}static fromJson(t,e,n){const i=$h.create(t,e);return i.update(n),i}_updateControl(){const{startX:t,startY:e,endX:n,endY:i}=this._selectionModel;this.leftControl.resize(void 0,i-e),this.rightControl.transformByState({height:i-e,left:n-t-zh/2}),this.topControl.resize(n-t+zh),this.bottomControl.transformByState({width:n-t+zh,top:i-e-zh/2}),this.fillControl.translate(n-t-Wh/2,i-e-Wh/2),this._updateBackgroundControl(),this.selectionShape.show(),this.selectionShape.translate(t,e),this.selectionShape.makeDirty(!0)}update(t,e){this._selectionModel.setValue(t,e),this._updateControl()}clearHighlight(){this._selectionModel.clearCurrentCell(),this._updateControl()}getScene(){return this._scene}dispose(){var t,e,n,i,s,o,r,a,l,h;null==(t=this._leftControl)||t.dispose(),null==(e=this._rightControl)||e.dispose(),null==(n=this._topControl)||n.dispose(),null==(i=this._bottomControl)||i.dispose(),null==(s=this._backgroundControlTop)||s.dispose(),null==(o=this._backgroundControlMiddleLeft)||o.dispose(),null==(r=this._backgroundControlMiddleRight)||r.dispose(),null==(a=this._backgroundControlBottom)||a.dispose(),null==(l=this._fillControl)||l.dispose(),null==(h=this._selectionShape)||h.dispose()}getCurrentCellInfo(){const t=this.model.currentCell;if(t){let e;if(t.isMerged){const n=t.mergeInfo;e={startRow:n.startRow,endRow:n.endRow,startColumn:n.startColumn,endColumn:n.endColumn,startX:n.startX,endX:n.endX,startY:n.startY,endY:n.endY}}else{const{row:n,column:i,startX:s,endX:o,startY:r,endY:a}=t;e={startRow:n,endRow:n,startColumn:i,endColumn:i,startX:s,endX:o,startY:r,endY:a}}return e}}_initialize(){this._selectionModel=new Bh(0);const t=this._zIndex;this._leftControl=new Wa(jh.left+t,{top:0,left:-zh/2,width:zh,fill:Fh,zIndex:t}),this._rightControl=new Wa(jh.right+t,{width:zh,fill:Fh,zIndex:t}),this._topControl=new Wa(jh.top+t,{top:-zh/2,left:-zh/2,height:zh,fill:Fh,zIndex:t}),this._bottomControl=new Wa(jh.bottom+t,{height:zh,fill:Fh,left:-zh/2,zIndex:t}),this._backgroundControlTop=new Wa(jh.backgroundTop+t,{fill:Uh,zIndex:t-1,evented:!1}),this._backgroundControlBottom=new Wa(jh.backgroundBottom+t,{fill:Uh,zIndex:t-1,evented:!1}),this._backgroundControlMiddleLeft=new Wa(jh.backgroundMiddleLeft+t,{fill:Uh,zIndex:t-1,evented:!1}),this._backgroundControlMiddleRight=new Wa(jh.backgroundMiddleRight+t,{fill:Uh,zIndex:t-1,evented:!1});const e=Wh-Vh;this._fillControl=new Wa(jh.fill+t,{width:e,height:e,fill:Fh,strokeWidth:Vh,stroke:Yh,zIndex:t+1}),this._selectionShape=new Ha(jh.Selection+t,this._fillControl,this._leftControl,this._rightControl,this._topControl,this._bottomControl,this._backgroundControlTop,this._backgroundControlMiddleLeft,this._backgroundControlMiddleRight,this._backgroundControlBottom),this._selectionShape.hide(),this._selectionShape.evented=!1,this._selectionShape.zIndex=t;this.getScene().addObject(this._selectionShape)}_updateBackgroundControl(){const{startColumn:t,startRow:e,endColumn:n,endRow:i,startX:s,startY:o,endX:r,endY:a}=this._selectionModel,l=this._selectionModel.highlightToSelection();if(!l)return this._backgroundControlTop.resize(r-s,a-o),this._backgroundControlBottom.resize(0,0),this._backgroundControlMiddleLeft.resize(0,0),void this._backgroundControlMiddleRight.resize(0,0);const{startX:h,startY:c,endX:d,endY:u}=l,g=zh/2,_={left:-g,top:-g,width:r-s+2*g,height:c-o+g};_.height<0&&(_.width=0,_.height=0),this._backgroundControlTop.transformByState(_);const p={left:-g,top:c-o,width:h-s+g,height:u-c};p.width<0&&(p.width=0,p.height=0),this._backgroundControlMiddleLeft.transformByState(p);const m={left:d-s-g,top:c-o,width:r-d+2*g,height:u-c};m.width<0&&(m.width=0,m.height=0),this._backgroundControlMiddleRight.transformByState(m);const f={left:-g,top:u-o,width:r-s+2*g,height:a-u+g};f.height<0&&(f.width=0,f.height=0),this._backgroundControlBottom.transformByState(f)}}class Zh{constructor(t){this._spreadsheet=t,this.hasSelection=!1,this._selectionControls=[],this._startOffsetX=0,this._startOffsetY=0,this._mainEventInitial()}static create(t){return new Zh(t)}addControlToCurrentByRangeData(t,e){const n=this.getCurrentControls();if(!n)return;const i=this._spreadsheet,s=$h.create(this.getScene(),n.length);let o=null;e&&(o=i.getCellByIndex(e.row,e.column));const{startRow:r,startColumn:a,endRow:l,endColumn:h}=t,c=i.getNoMergeCellPositionByIndex(r,a),d=i.getNoMergeCellPositionByIndex(l,h);s.update({startColumn:a,startRow:r,endColumn:h,endRow:l,startY:(null==c?void 0:c.startY)||0,endY:(null==d?void 0:d.endY)||0,startX:(null==c?void 0:c.startX)||0,endX:(null==d?void 0:d.endX)||0},o),n.push(s)}getSpreadsheet(){return this._spreadsheet}getMaxIndex(){return this._spreadsheet.zIndex+1}getScene(){return this._spreadsheet.getScene()}getSkeleton(){return this._spreadsheet.getSkeleton()}getRowAndColumnCount(){const t=this.getSkeleton();return{rowCount:(null==t?void 0:t.getRowCount())||1e3,columnCount:(null==t?void 0:t.getColumnCount())||50}}getCurrentControls(){return this._selectionControls}getCurrentControl(){const t=this.getCurrentControls();if(t&&t.length>0)for(const e of t){if(e.model.currentCell)return e}}clearSelectionControls(){let t=this.getCurrentControls();if(t.length>0){for(let e of t)e.dispose();t.length=0}}getActiveRangeList(){const t=this.getCurrentControls();if(t&&t.length>0){return null==t?void 0:t.map((t=>{const e=t.model;return{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}))}}getActiveRange(){const t=this.getCurrentControls(),e=t&&t[t.length-1].model;return e&&{startRow:e.startRow,startColumn:e.startColumn,endRow:e.endRow,endColumn:e.endColumn}}getActiveSelection(){const t=this.getCurrentControls();return t&&t[t.length-1]}dispose(){this.clearSelectionControls(),this._moveObserver=null,this._upObserver=null}_moving(t,e,n){const i=this._spreadsheet,{startRow:s,startColumn:o,endRow:r,endColumn:a}=this._startSelectionRange,l=i.getScrollXYByRelativeCoords(ma.FromArray([this._startOffsetX,this._startOffsetY])),h=kn(i.calculateCellIndexByPosition(t,e,l));if(!h)return!1;const{startRow:c,startColumn:d,endColumn:u,endRow:g}=h,_=Math.min(c,s),p=Math.min(d,o),m=Math.max(g,r),f=Math.max(u,a),T=i.getSelectionBounding(_,p,m,f);if(!T)return!1;const{startRow:v,startColumn:E,endRow:b,endColumn:I}=T,C=i.getNoMergeCellPositionByIndex(v,E),S=i.getNoMergeCellPositionByIndex(b,I),A={startColumn:E,startRow:v,endColumn:I,endRow:b,startY:(null==C?void 0:C.startY)||0,endY:(null==S?void 0:S.endY)||0,startX:(null==C?void 0:C.startX)||0,endX:(null==S?void 0:S.endX)||0},{startRow:w,endRow:R,startColumn:N,endColumn:y}=(null==n?void 0:n.model)||{startRow:-1,endRow:-1,startColumn:-1,endColumn:-1};N===E&&w===v&&y===I&&R===b||n&&n.update(A)}_endSelection(t){var e,n;t.onPointerMoveObserver.remove(this._moveObserver),t.onPointerUpObserver.remove(this._upObserver),t.enableEvent(),null==(e=this._scrollTimer)||e.stopScroll();const i=null==(n=t.getEngine())?void 0:n.activeScene;null==i||i.onPointerDownObserver.remove(this._cancelDownObserver),null==i||i.onPointerUpObserver.remove(this._cancelUpObserver)}_addCancelObserver(){var t;const e=this.getScene(),n=null==(t=e.getEngine())?void 0:t.activeScene;null!=n&&n!==e&&(n.onPointerDownObserver.remove(this._cancelDownObserver),n.onPointerUpObserver.remove(this._cancelUpObserver),this._cancelDownObserver=n.onPointerDownObserver.add((t=>{this._endSelection(e)})),this._cancelUpObserver=n.onPointerUpObserver.add((t=>{this._endSelection(e)})))}_mainEventInitial(){const t=this._spreadsheet;t.onPointerDownObserver.add(((e,n)=>{const{offsetX:i,offsetY:s}=e,o=this.getScene(),r=o.getRelativeCoord(ma.FromArray([i,s])),{x:a,y:l}=r;this._startOffsetX=a,this._startOffsetY=l;const h=t.getScrollXYByRelativeCoords(r),c=t.calculateCellIndexByPosition(a,l,h),d=kn(c);if(!d)return!1;const{startRow:u,startColumn:g,endColumn:_,endRow:p,startY:m,endY:f,startX:T,endX:v}=d,E={startColumn:g,startRow:u,endColumn:_,endRow:p,startY:m,endY:f,startX:T,endX:v};this._startSelectionRange=E;let b=this.getCurrentControl(),I=this.getCurrentControls();if(!I)return!1;for(let t of I){if(2===e.button&&t.model.isInclude(E))return void(b=t);if(t.model.isEqual(E)){b=t;break}e.shiftKey||t.clearHighlight()}if(I.length>0&&!e.ctrlKey&&!e.shiftKey){for(let t of I)t.dispose();I.length=0}const C=b&&b.model.currentCell;if(b&&e.shiftKey&&C){const{row:e,column:n}=C,i=t.getNoMergeCellPositionByIndex(e,n),s=t.getNoMergeCellPositionByIndex(p,_),o={startColumn:n,startRow:e,endColumn:E.startColumn,endRow:E.startRow,startY:(null==i?void 0:i.startY)||0,endY:(null==s?void 0:s.endY)||0,startX:(null==i?void 0:i.startX)||0,endX:(null==s?void 0:s.endX)||0};b.update(o,C)}else b=$h.create(o,I.length+this.getMaxIndex()),b.update(E,c),I.push(b);this.hasSelection=!0,o.disableEvent(),this._endSelection(o);const S=Ba.create(this.getScene());S.startScroll(a,l),this._scrollTimer=S,this._addCancelObserver(),this._moveObserver=o.onPointerMoveObserver.add((t=>{const{offsetX:e,offsetY:n}=t,{x:i,y:s}=o.getRelativeCoord(ma.FromArray([e,n]));this._moving(i,s,b),S.scrolling(i,s,(()=>{this._moving(i,s,b)}))})),this._upObserver=o.onPointerUpObserver.add((t=>{this._endSelection(o)})),n.stopPropagation()}))}}class qh extends kh{constructor(t,e,n=!0){super(t,e),this._allowCache=n,this._cacheOffsetX=0,this._cacheOffsetY=0,this._hasSelection=!1,this._documents=new fh("__SHEET_EXTENSION_FONT_DOCUMENT_INSTANCE__",void 0,{pageMarginLeft:0,pageMarginTop:0}),this._allowCache&&(this._cacheCanvas=new xa),this.onIsAddedToParentObserver.add((t=>{var e;null==(e=null==t?void 0:t.getEngine())||e.onTransformChangeObservable.add((t=>{this.resizeCacheCanvas()})),this.resizeCacheCanvas(),this._addMakeDirtyToScroll()})),this._initialDefaultExtension(),this.makeDirty(!0)}get borderAuxiliaryExtension(){return this._borderAuxiliaryExtension}get backgroundExtension(){return this._backgroundExtension}get borderExtension(){return this._borderExtension}get fontExtension(){return this._fontExtension}getDocuments(){return this._documents}draw(t,e){const n=this.getSkeleton();if(!n)return;const i=this.getParentScale();n.calculate(e);const s=ca(i),{rowTitleWidth:o,columnTitleHeight:r}=n;t.translate(sa(o,s)-.5/s,sa(r,s)-.5/s),this._calculateOverflow();const a=this.getExtensionsByOrder();for(let l of a)l.draw(t,i,n)}isHit(t){const e=this._getInverseCoord(t),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:i,columnTitleHeight:s}=n;return e.x>i&&e.y>s}getNoMergeCellPositionByIndex(t,e){const n=this.getSkeleton();if(!n)return;const{rowHeightAccumulation:i,columnWidthAccumulation:s,rowTitleWidth:o,columnTitleHeight:r}=n,{scaleX:a=1,scaleY:l=1}=this.getParentScale();let{startY:h,endY:c,startX:d,endX:u}=da(t,e,i,s);return h=sa(h+r,l),c=sa(c+r,l),d=sa(d+o,a),u=sa(u+o,a),{startY:h,endY:c,startX:d,endX:u}}calculateCellIndexByPosition(t,e,n){const i=this.getSkeleton();if(!i)return;const{x:s,y:o}=n,{rowHeightAccumulation:r,columnWidthAccumulation:a,rowTitleWidth:l,columnTitleHeight:h,dataMergeCacheAll:c}=i;t+=s-l;let d=M(r,e+=o-h),u=M(a,t);if(-1===d){d=r[r.length-1]<=e?r.length-1:0}if(-1===u){u=a[a.length-1]<=t?a.length-1:0}const{scaleX:g=1,scaleY:_=1}=this.getParentScale();let{isMerged:p,startY:m,endY:f,startX:T,endX:v,mergeInfo:E,isMergedMainCell:b}=ua(d,u,r,a,c);return m=sa(m+h,_),f=sa(f+h,_),T=sa(T+l,g),v=sa(v+l,g),E=ga(E,l,h,g,_),{row:d,column:u,startY:m,endY:f,startX:T,endX:v,isMerged:p,isMergedMainCell:b,mergeInfo:E}}getCellByIndex(t,e){const n=this.getSkeleton();if(!n)return;const{scaleX:i=1,scaleY:s=1}=this.getParentScale(),{rowHeightAccumulation:o,columnWidthAccumulation:r,rowTitleWidth:a,columnTitleHeight:l,dataMergeCacheAll:h}=n;let{isMerged:c,startY:d,endY:u,startX:g,endX:_,mergeInfo:p,isMergedMainCell:m}=ua(t,e,o,r,h);return d=sa(d+l,s),u=sa(u+l,s),g=sa(g+a,i),_=sa(_+a,i),p=ga(p,a,l,i,s),{row:t,column:e,startY:d,endY:u,startX:g,endX:_,isMerged:c,isMergedMainCell:m,mergeInfo:p}}getScrollXYByRelativeCoords(t){let e=0,n=0;const i=this.getParent().getActiveViewportByRelativeCoord(t);if(i){e+=i.actualScrollX||0,n+=i.actualScrollY||0}return{x:e,y:n}}getAncestorScrollXY(t,e){let n=this.getParent(),i=0,s=0,o=ma.FromArray([t,e]);for(;n;){if(n.classType===Ir.SCENE){const t=n.getActiveViewportByCoord(o);if(t){i+=t.actualScrollX||0,s+=t.actualScrollY||0}}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}return{x:i,y:s}}getSelectionBounding(t,e,n,i){var s;return null==(s=this.getSkeleton())?void 0:s.getMergeBounding(t,e,n,i)}render(t,e){if(!this.visible)return this.makeDirty(!1),this;if(this._allowCache){if(this._cacheOffsetX=0,this._cacheOffsetY=0,this.isDirty()){let n=e;const i=this._cacheCanvas.getContext();if(n){const{dx:t=0,dy:e=0}=n;this._cacheOffsetX=t,this._cacheOffsetY=e}this._cacheCanvas.clear(),i.save(),i.setTransform(t.getTransform()),this._draw(i,n),i.restore(),this._boundsCache=e}this._applyCache(t)}else t.save(),this._draw(t,e),t.restore();return this.makeDirty(!1),this}resizeCacheCanvas(){const t=this._getAncestorSize();if(!t||null==this._cacheCanvas)return;const{width:e,height:n}=t,i=this.getSkeleton();i&&(i.rowTitleWidth,i.columnTitleHeight),this._cacheCanvas.setSize(e,n),this.makeDirty(!0)}enableSelection(){this._hasSelection||(this._selection=Zh.create(this),this._hasSelection=!0)}disableSelection(){var t;null==(t=this._selection)||t.dispose(),this._hasSelection=!1}getDocsSkeletonPageSize(t,e=0){const n=null==t?void 0:t.getSkeletonData();if(!n)return;const{pages:i}=n,s=i[i.length-1];if(0===e){const{width:t,height:e}=s;return{width:t,height:e}}let o=0,r=0;const a=Ca(e),l=[];!function(t,e){for(let n of t){const{sections:t}=n;for(let n of t){const{columns:t}=n;for(let n of t)e&&ea(e)&&e(n)}}}([s],(t=>{const{lines:n,width:i,spaceWidth:s}=t,{rotatedHeight:o,rotatedWidth:a}=Sa(n,i,e);r+=o,l.push({rotatedWidth:a,spaceWidth:s})}));const h=Math.tan(e),c=Math.sin(e),d=l.length;for(let u=0;u<d;u++){const{rotatedWidth:t,spaceWidth:e}=l[u];0===u&&(o+=t),(a===Er.UP&&0===u||a===Er.DOWN&&u===d-1)&&(o+=(t+e/c)/h)}return{width:o,height:r}}_applyCache(t){t&&(t.save(),t.setTransform(1,0,0,1,0,0),t.drawImage(this._cacheCanvas.getCanvasEle(),0,0),t.restore())}_draw(t,e){this.draw(t,e)}_getAncestorSize(){const t=this._getAncestorParent();if(t){if(t.classType===Ir.ENGINE){const e=t.getCanvas();return{width:e.getWidth(),height:e.getHeight()}}return t.classType===Ir.SCENE_VIEWER?{width:t.width,height:t.height}:void 0}}_getAncestorParent(){let t=this.parent;for(;t;){if(t.classType===Ir.ENGINE||t.classType===Ir.SCENE_VIEWER)return t;t=(null==t?void 0:t.getParent)&&(null==t?void 0:t.getParent())}}_initialDefaultExtension(){nh.getData().sort(ci).forEach((t=>{this.register(t)})),this._borderAuxiliaryExtension=this.getExtensionByKey("DefaultBorderAuxiliaryExtension"),this._backgroundExtension=this.getExtensionByKey("DefaultBackgroundExtension"),this._borderExtension=this.getExtensionByKey("DefaultBorderExtension"),this._fontExtension=this.getExtensionByKey("DefaultFontExtension")}_addMakeDirtyToScroll(){this._hasScrollViewportOperator(this,(t=>{t.onScrollBeforeObserver.add((()=>{this.makeDirty(!0)}))}))}_hasScrollViewportOperator(t,e){let n=t.getParent();for(;n;){if(n.classType===Ir.SCENE){const t=n.getViewports();this._getHasScrollViewports(t);for(let n of t)n&&e(n)}n=(null==n?void 0:n.getParent)&&(null==n?void 0:n.getParent())}}_getHasScrollViewports(t){const e=[];for(let n of t){n.getScrollBar()&&e.push(n)}return e}_calculateOverflow(){const t=new H,e=this.getSkeleton();if(!e)return;const n=e.getColumnCount(),{stylesCache:i,rowHeightAccumulation:s,columnWidthAccumulation:o,dataMergeCache:r}=e,{font:a}=i;a&&Object.keys(a).forEach((i=>{a[i].forEach(((i,a)=>{a.forEach(((a,l)=>{let{documentSkeleton:h,angle:c=0,verticalAlign:d,horizontalAlign:u,wrapStrategy:g}=l;const _=e.getCellData().getValue(i,a),p=this.getSkeleton();if(!p)return!0;const{t:m=We.STRING}=_||{};if(g===Me.OVERFLOW&&m!==We.NUMBER&&m!==We.BOOLEAN&&u!==Ne.JUSTIFIED){let l=this.getDocsSkeletonPageSize(h,c);if(!l)return!0;if(0!==c){let{startY:t,endY:e,startX:n,endX:h}=ua(i,a,s,o,r);const d=h-n,u=e-t;l.height>u&&(l={width:u/Math.tan(Math.abs(c))+d,height:u})}const d=e.getOverflowPosition(l,u,i,a,n),{startColumn:g,endColumn:_}=d;t.setValue(i,a,{startRow:i,endRow:i,startColumn:g,endColumn:_})}else if(g===Me.WRAP&&0!==c){let{startY:e,endY:n}=ua(i,a,s,o,r);const l=n-e;h.updateDocumentDataPageSize(l),h.calculate();const d=this.getDocsSkeletonPageSize(h,c);if(!d)return!0;const{startColumn:g,endColumn:_}=p.getOverflowPosition(d,u,i,a,p.getColumnCount());t.setValue(i,a,{startRow:i,endRow:i,startColumn:g,endColumn:_})}}))}))})),e.setOverflowCache(t)}_differentBounds(t){if(!this._boundsCache)return t;const{tl:e,tr:n,bl:i,br:s,dx:o,dy:r}=t,{tl:a,tr:l,bl:h,br:c,dx:d,dy:u}=this._boundsCache,g={tl:e,tr:n,bl:i,br:s,dx:0,dy:0};return e.x===a.x?(e.y>a.y?(g.tl=h,g.tr=c):(g.bl=a,g.br=l),g.dy=a.y-e.y):e.y===a.y&&(e.x>a.x?(g.tl=l,g.bl=c):(g.tr=a,g.br=h),g.dx=a.x-e.x),g}_checkSheetDifferentBounds(t,e){const{tl:n,tr:i,bl:s,br:o}=t,{tl:r,tr:a,bl:l,br:h}=e;return n.x===r.x&&i.x===a.x&&s.x===l.x&&o.x===h.x?n.y>=r.y&&n.y<=l.y||s.y>=r.y&&s.y<=l.y:n.y===r.y&&i.y===a.y&&s.y===l.y&&o.y===h.y&&(n.x>=r.x&&n.x<=a.x||i.x>=r.x&&(i.x,a.x),!0)}}class Qh extends Ph{constructor(t,e){super(t,e),this._initialDefaultExtension(),this.makeDirty(!0)}get rowTitleLayoutExtension(){return this._rowTitleLayoutExtension}draw(t,e){const n=this.getSkeleton();if(!n)return;const i=this.getParentScale();n.calculate(e);const s=ca(i),{columnTitleHeight:o}=n;t.translate(-.5/s,sa(o,s)-.5/s);const r=this.getExtensionsByOrder();for(let a of r)a.draw(t,i,n)}isHit(t){const e=this._getInverseCoord(t),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:i,columnTitleHeight:s}=n;return e.x>=0&&e.x<=i&&e.y>s}_initialDefaultExtension(){ih.getData().forEach((t=>{this.register(t)})),this._rowTitleLayoutExtension=this.getExtensionByKey("DefaultRowTitleLayoutExtension")}}class Jh extends Ph{constructor(t,e){super(t,e),this._initialDefaultExtension(),this.makeDirty(!0)}get columnTitleLayoutExtension(){return this._columnTitleLayoutExtension}draw(t,e){const n=this.getSkeleton();if(!n)return;const i=this.getParentScale();n.calculate(e);const s=ca(i),{rowTitleWidth:o}=n;t.translate(sa(o,s)-.5/s,-.5/s);const r=this.getExtensionsByOrder();for(let a of r)a.draw(t,i,n)}isHit(t){const e=this._getInverseCoord(t),n=this.getSkeleton();if(!n)return!1;const{rowTitleWidth:i,columnTitleHeight:s}=n;return e.x>i&&e.y>=0&&e.y<=s}_initialDefaultExtension(){sh.getData().forEach((t=>{this.register(t)})),this._columnTitleLayoutExtension=this.getExtensionByKey("DefaultColumnTitleLayoutExtension")}}class tc extends ql{constructor(t,e,n,i){super(i),this._config=t,this._cellData=e,this._styles=n,this._rowTitleWidth=0,this._columnTitleHeight=0,this.updateLayout(),this.updateDataMerge()}get rowHeightAccumulation(){return this._rowHeightAccumulation}get rowTotalHeight(){return this._rowTotalHeight}get columnWidthAccumulation(){return this._columnWidthAccumulation}get columnTotalWidth(){return this._columnTotalWidth}get rowTitleWidth(){return this._rowTitleWidth}get columnTitleHeight(){return this._columnTitleHeight}get rowColumnSegment(){return this._rowColumnSegment}get dataMergeCache(){return this._dataMergeCache}get stylesCache(){return this._stylesCache}get overflowCache(){return this._overflowCache}get showGridlines(){return this._showGridlines}get dataMergeCacheAll(){return this._dataMergeCacheAll}static create(t,e,n,i){return new tc(t,e,n,i)}getWorksheetConfig(){return this._config}getCellData(){return this._cellData}getsStyles(){return this._styles}setOverflowCache(t){this._overflowCache=t}calculate(t){if(!this._config)return;if(this.updateLayout(),!this._rowHeightAccumulation||!this._columnWidthAccumulation)return;const{mergeData:e}=this._config;return this._rowColumnSegment=this.getRowColumnSegment(t),this._dataMergeCache=e&&this._getMergeCells(e,this._rowColumnSegment),this._stylesCache=this._calculateStylesCache(),this}updateLayout(){if(!this.dirty)return;const{rowData:t,columnData:e,defaultRowHeight:n,defaultColumnWidth:i,rowCount:s,columnCount:o,rowTitle:r,columnTitle:a,showGridlines:l}=this._config,{rowTotalHeight:h,rowHeightAccumulation:c}=this._generateRowMatrixCache(s,t,n),{columnTotalWidth:d,columnWidthAccumulation:u}=this._generateColumnMatrixCache(o,e,i);return this._rowTitleWidth=r.hidden!==Ue.TRUE?r.width:0,this._columnTitleHeight=a.hidden!==Ue.TRUE?a.height:0,this._rowTotalHeight=h,this._rowHeightAccumulation=c,this._columnTotalWidth=d,this._columnWidthAccumulation=u,this._showGridlines=l,this.makeDirty(!0),this}updateDataMerge(){const{mergeData:t}=this._config;this._dataMergeCacheAll=t&&this._getMergeCells(t)}getRowColumnSegment(t){return this._getBounding(this._rowHeightAccumulation,this._columnWidthAccumulation,t)}getMergeBounding(t,e,n,i){const s=this._dataMergeCacheAll;if(!s)return{startRow:t,startColumn:e,endRow:n,endColumn:i};let o=!0,r=new H;for(;o;)o=!1,s.forEach(((s,a)=>{a.forEach(((a,l)=>{if(!l||r.getValue(s,a))return!0;const{startRow:h,startColumn:c,endRow:d,endColumn:u}=l;_a({left:e,top:t,right:i,bottom:n},{left:c,top:h,right:u,bottom:d})&&(t=Math.min(t,h),e=Math.min(e,c),n=Math.max(n,d),i=Math.max(i,u),r.setValue(s,a,!0),o=!0)}))}));return{startRow:t,startColumn:e,endRow:n,endColumn:i}}appendToOverflowCache(t,e,n,i){this._overflowCache.setValue(t,e,{startRow:t,endRow:t,startColumn:n,endColumn:i})}getColumnCount(){return this._columnWidthAccumulation.length}getRowCount(){return this._rowHeightAccumulation.length}getOverflowPosition(t,e,n,i,s){const{width:o,height:r}=t;let a=i,l=i;return e===Ne.CENTER?(a=this._getOverflowBound(n,i,0,o/2),l=this._getOverflowBound(n,i,s-1,o/2)):e===Ne.RIGHT?a=this._getOverflowBound(n,i,0,o):l=this._getOverflowBound(n,i,s-1,o),{startColumn:a,endColumn:l}}_getBounding(t,e,n){const i=t.length,s=e.length;if(!n)return{startRow:0,endRow:i-1,startColumn:0,endColumn:s-1};let o=-1,r=-1,a=-1,l=-1;return o=M(t,n.tl.y-this.columnTitleHeight),r=M(t,n.bl.y-this.columnTitleHeight),-1===o&&(o=0),-1===r&&(r=i-1),r>=i&&(r=i-1),a=M(e,n.tl.x-this.rowTitleWidth),l=M(e,n.tr.x-this.rowTitleWidth),-1===a&&(a=0),-1===l&&(l=s-1),l>=s&&(l=s-1),{startRow:o-1,endRow:r+1,startColumn:a-1,endColumn:l+1}}_generateRowMatrixCache(t,e,n){let i=0;const s=[],o=new k(e);for(let r=0;r<t;r++){let t=n;if(null!=o.get(r)){const e=o.get(r);if(!e)continue;null!=e.h?t=e.h:null!=e.ah&&(t=e.ah),e.hd===Ue.TRUE&&(t=0)}i+=t,s.push(i)}return{rowTotalHeight:i,rowHeightAccumulation:s}}_generateColumnMatrixCache(t,e,n){let i=0;const s=[],o=new k(e);for(let r=0;r<t;r++){let t=n;if(null!=o.get(r)){const e=o.get(r);if(!e)continue;null!=e.w&&(t=e.w),e.hd===Ue.TRUE&&(t=0)}i+=t,s.push(i)}return{columnTotalWidth:i,columnWidthAccumulation:s}}_getOverflowBound(t,e,n,i){let s=0;if(e>n){const o=this._columnWidthAccumulation.length-1;for(let r=e;r>=n;r--){const n=r;if(!Pn(this._cellData.getValue(t,n))&&n!==e||this._intersectMergeRange(t,n))return n===e?n:n+1>o?o:n+1;const{startX:a,endX:l}=da(t,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s+=l-a,i<s)return n}return e}for(let o=e;o<=n;o++){const n=o;if(!Pn(this._cellData.getValue(t,n))&&n!==e||this._intersectMergeRange(t,n))return n===e?n:n-1<0?0:n-1;const{startX:r,endX:a}=da(t,n,this.rowHeightAccumulation,this.columnWidthAccumulation);if(s+=a-r,i<s)return n}return n}_intersectMergeRange(t,e){const n=this.dataMergeCache;let i=!1;return null==n||n.forEach(((n,s)=>{null==s||s.forEach(((n,s)=>{const{startRow:o,endRow:r,startColumn:a,endColumn:l}=s;if(t>=o&&t<=r&&e>=a&&e<=l)return i=!0,!1}))})),i}_calculateStylesCache(){const t={background:{},font:{},border:new H},e=this.getFontLocale(),n=this._dataMergeCache,i=this._rowColumnSegment,s=this.columnWidthAccumulation,o=this._styles,r=this._cellData,{startRow:a,endRow:l,startColumn:h,endColumn:c}=i;for(let d=a;d<=l;d++){for(let n=h;n<=c;n++)this.__setCellCache(d,n,{cache:t,styles:o,cellData:r,skipBackgroundAndBorder:!1},e);for(let n=0;n<h;n++)this.__setCellCache(d,n,{cache:t,styles:o,cellData:r,skipBackgroundAndBorder:!0},e);for(let n=c+1;n<s.length;n++)this.__setCellCache(d,n,{cache:t,styles:o,cellData:r,skipBackgroundAndBorder:!0},e)}return n&&n.forEach(((n,i)=>{i.forEach(((i,s)=>{if(!s)return!0;this.__setCellCache(n,i,{cache:t,styles:o,cellData:r,skipBackgroundAndBorder:!1},e)}))})),t}__setCellCache(t,e,n,i){const{cache:s,skipBackgroundAndBorder:o=!1,styles:r,cellData:a}=n;if(!a)return!0;const l=a.getValue(t,e);if(!l)return!0;const h=r&&r.getStyleByCell(l);if(!o&&h&&h.bg&&h.bg.rgb){const n=h.bg.rgb;s.background[n]||(s.background[n]=new H);s.background[n].setValue(t,e,n)}!o&&h&&h.bd&&(this.___setBorderProps(t,e,Tr.TOP,h,s),this.___setBorderProps(t,e,Tr.BOTTOM,h,s),this.___setBorderProps(t,e,Tr.LEFT,h,s),this.___setBorderProps(t,e,Tr.RIGHT,h,s));const c=l.m||l.v;let d,u="document";const g=this._getOtherStyle(h),_=g.textRotation||{a:0,v:Ue.FALSE},p=g.horizontalAlign||Ne.UNSPECIFIED,m=g.verticalAlign||Oe.UNSPECIFIED,f=g.wrapStrategy||Me.UNSPECIFIED;if(l.p){s.font[u]||(s.font[u]=new H);let{a:t=0,v:e=Ue.FALSE}=_,n=0,i=t;e===Ue.TRUE&&(n=90,i=90),d=this._updateRenderConfigAndHorizon(l.p,p,{horizontalAlign:p,verticalAlign:m,centerAngle:n,vertexAngle:i,wrapStrategy:f})}else if(c){const t=this._getFontFormat(h);u=oa(t,i).fontString,s.font[u]||(s.font[u]=new H),d=this._getDocumentDataByStyle(c.toString(),t,g)}const T=s.font[u];let{a:v,v:E=Ue.FALSE}=_;if(E===Ue.TRUE&&(v=90),d){const n=Ql.create(d,this.getContext());0!==v&&f===Me.WRAP||n.calculate(),T.setValue(t,e,{documentSkeleton:n,angle:v,verticalAlign:m,horizontalAlign:p,wrapStrategy:f,content:null==c?void 0:c.toString()})}}_updateRenderConfigAndHorizon(t,e,n){var i;if(!n)return;if(!(null==(i=t.body)?void 0:i.blockElements))return;t.documentStyle||(t.documentStyle={}),t.documentStyle.renderConfig=n;const s=t.body.blockElements;for(let o of s)if(o.blockType===K.PARAGRAPH){if(!o.paragraph)continue;o.paragraph.paragraphStyle||(o.paragraph.paragraphStyle={}),o.paragraph.paragraphStyle.horizontalAlign=e}return t}_getDocumentDataByStyle(t,e,n){const i=t.length-1,{textRotation:s={a:0,v:Ue.FALSE},textDirection:o=Se.UNSPECIFIED,paddingData:r={t:0,r:2,b:0,l:2},horizontalAlign:a=Ne.UNSPECIFIED,verticalAlign:l=Oe.UNSPECIFIED,wrapStrategy:h=Me.UNSPECIFIED}=n,{a:c=0,v:d=Ue.FALSE}=s,{t:u,r:g,b:_,l:p}=r;nt.NORMAL;let m=0,f=c;d===Ue.TRUE&&(m=90,f=90,nt.TBRL);return{id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:i,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{horizontalAlign:a},elements:[{eId:"oneElement",st:0,ed:i,et:st.TEXT_RUN,tr:{ct:t,ts:e}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:u,marginBottom:_,marginRight:g,marginLeft:p,renderConfig:{horizontalAlign:a,verticalAlign:l,centerAngle:m,vertexAngle:f,wrapStrategy:h}}}}___setBorderProps(t,e,n,i,s){var o;const r=null==(o=i.bd)?void 0:o[n];if(!r||!s.border)return!0;const a=Hn(r.cl)||"rgb(0,0,0)",l=s.border;l.getValue(t,e)||l.setValue(t,e,{[n]:{}}),l.getValue(t,e)[n]={type:n,style:r.s,color:a}}_getFontFormat(t){if(!t)return{};const{ff:e,fs:n,it:i,bl:s,ul:o,st:r,ol:a,cl:l,bg:h,bd:c}=t;return{ff:e,fs:n,it:i,bl:s,ul:o,st:r,ol:a,cl:l}}_getOtherStyle(t){if(!t)return{};const{tr:e,td:n,ht:i,vt:s,tb:o,pd:r}=t;return{textRotation:e,textDirection:n,horizontalAlign:i,verticalAlign:s,wrapStrategy:o,paddingData:r}}_getMergeCells(t,e){const n=this.columnWidthAccumulation.length-1;if(e)e={startRow:e.startRow,endRow:e.endRow,endColumn:n,startColumn:0};else{e={startRow:0,startColumn:0,endRow:this.rowHeightAccumulation.length-1,endColumn:n}}const{startRow:i,startColumn:s,endRow:o,endColumn:r}=e,a=new H;for(let l=0;l<t.length;l++){const{startRow:e,endRow:n,startColumn:h,endColumn:c}=t[l];for(let t=i;t<=o;t++){let i=!1;for(let o=s;o<=r;o++)if(t>=e&&t<=n&&o>=h&&o<=c){a.setValue(e,h,{startRow:e,endRow:n,startColumn:h,endColumn:c}),i=!0;break}if(i)break}}return a}}function ec(t,e,n){t.onPointerEnterObserver.add((n=>{e(t,n)})),t.onPointerLeaveObserver.add((e=>{n(t,e)}))}var nc,ic;(ic=nc||(nc={})).LEFT="__slideNavigationLeft__",ic.RIGHT="__slideNavigationRight__";const sc="M512 1024C229.248 1024 0 794.752 0 512S229.248 0 512 0s512 229.248 512 512-229.248 512-512 512z m200.746667-478.506667l1.749333-1.664 30.165333-30.165333-330.496-330.581333a42.837333 42.837333 0 0 0-60.288 0 42.538667 42.538667 0 0 0 0 60.330666l270.08 270.165334-270.08 269.952a42.496 42.496 0 0 0 0 60.288c16.64 16.64 43.861333 16.469333 60.288 0.042666l298.581334-298.368z";class oc extends xh{constructor(){super(...arguments),this.onSlideChangePageByNavigationObservable=new y,this._navigationEnabled=!1}activeFirstPage(){const t=this.getSubScenes().keys().next().value;null!=t&&this.changePage(t)}addPage(t){const e=t.sceneKey;null==this.getSubScene(e)&&(this.addSubScene(t),this.addNavigation())}changePage(t){null!==t&&(this.removeNavigation(),this.activeSubScene(t),this.addNavigation())}hasPage(t){return this.getSubScene(t)}addNavigation(){const t=this.getActiveSubScene();if(null==t||!1===this._navigationEnabled)return;const e=new Ka(nc.LEFT,{data:sc,width:60,height:60,left:90,top:(this.height-30)/2,fill:this._getArrowColor(),flipX:!0}),n=new Ka(nc.RIGHT,{data:sc,width:60,height:60,left:this.width-90,top:(this.height-30)/2,fill:this._getArrowColor()}),i=(t,e)=>{t.setCursor(_r.POINTER),t.setProps({fill:this._getArrowColor(!0)})},s=(t,e)=>{t.setCursor(_r.DEFAULT),t.setProps({fill:this._getArrowColor()})};ec(e,i,s),ec(n,i,s),this._addNavTrigger(e,n),t.addObjects([e,n],7)}removeNavigation(){var t,e;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(t=n.getObject(nc.LEFT))||t.dispose(),null==(e=n.getObject(nc.RIGHT))||e.dispose())}enableNav(){this._navigationEnabled=!0}disableNav(){this._navigationEnabled=!1}hiddenNav(){var t,e;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(t=n.getObject(nc.LEFT))||t.hide(),null==(e=n.getObject(nc.RIGHT))||e.hide())}showNav(){var t,e;const n=this.getActiveSubScene();null!=n&&!1!==this._navigationEnabled&&(null==(t=n.getObject(nc.LEFT))||t.show(),null==(e=n.getObject(nc.RIGHT))||e.show())}renderToThumb(t,e,n=1,i=1){const s=this.getSubScene(e);null!=s&&(t.save(),t.scale(n,i),s.makeDirtyNoParent(!0).render(t),t.restore())}_getSubScenesIndex(t){if(null==t)return;const e=Array.from(this.getSubScenes()),n=e.length;let i=0;for(let r=0;r<n;r++){const[n]=e[r];if(t===n){i=r;break}}let s=i+1,o=i-1;return s=s>=n?0:s,o=o<0?n-1:o,{nextScene:e[s][1],previousScene:e[o][1]}}_addNavTrigger(t,e){t.onPointerDownObserver.add((()=>{var t;const e=this._getSubScenesIndex(null==(t=this.getActiveSubScene())?void 0:t.sceneKey),n=null==e?void 0:e.previousScene.sceneKey;this.changePage(n),this.onSlideChangePageByNavigationObservable.notifyObservers(n)})),e.onPointerDownObserver.add((()=>{var t;const e=this._getSubScenesIndex(null==(t=this.getActiveSubScene())?void 0:t.sceneKey),n=null==e?void 0:e.nextScene.sceneKey;this.changePage(n),this.onSlideChangePageByNavigationObservable.notifyObservers(n)}))}_getArrowColor(t=!1){return Kr(ar,t?.8:.5)}}class rc extends ko{constructor(){super(sn.BASE_RENDER),this._engine=new La}static create(){return new rc}installTo(t){t.install(this)}getEngine(){return this._engine}}var ac={spreadsheetLabel:"插件",spreadsheetRightLabel:"更多 Sheets",spreadsheet:{one:"一",two:"二",three:"三"},toolbar:{undo:"撤销",redo:"重做",paintFormat:"格式刷",currencyFormat:"货币格式",percentageFormat:"百分比格式",numberDecrease:"减少小数位数",numberIncrease:"增加小数位数",moreFormats:"更多格式",font:"字体",fontSize:"字号大小",bold:"粗体 (Ctrl+B)",italic:"斜体 (Ctrl+I)",strikethrough:"删除线 (Alt+Shift+5)",underline:"下划线",textColor:{main:"文本颜色",right:"颜色选择"},resetColor:"重置颜色",customColor:"自定义",alternatingColors:"交替颜色",confirmColor:"确定颜色",cancelColor:"取消",collapse:"收起",fillColor:{main:"单元格颜色",right:"颜色选择"},border:{main:"边框",right:"边框类型"},mergeCell:{main:"合并单元格",right:"选择合并类型"},horizontalAlignMode:{main:"水平对齐",right:"对齐方式"},verticalAlignMode:{main:"垂直对齐",right:"对齐方式"},textWrapMode:{main:"文本换行",right:"换行方式"},textRotateMode:{main:"文本旋转",right:"旋转方式"},freezeTopRow:"冻结首行",sortAndFilter:"排序和筛选",findAndReplace:"查找替换",sum:"求和",autoSum:"自动求和",moreFunction:"更多函数",conditionalalFormat:"条件格式",comment:"批注",pivotTable:"数据透视表",chart:"图表",screenshot:"截图",splitColumn:"分列",insertImage:"插入图片",insertLink:"插入链接",dataValidation:"数据验证",protection:"保护工作表内容",clearText:"清除颜色选择",noColorSelectedText:"没有颜色被选择",toolMore:"更多",toolLess:"少于",toolClose:"收起",toolMoreTip:"更多功能",moreOptions:"更多选项",cellFormat:"设置单元格格式",print:"打印",borderMethod:{top:"上框线",bottom:"下框线",left:"左框线",right:"右框线"},more:"更多"},defaultFmt:{Automatic:{text:"自动",value:"General",example:""},Number:{text:"数字",value:"##0.00",example:"1000.12"},Percent:{text:"百分比",value:"#0.00%",example:"12.21%"},PlainText:{text:"纯文本",value:"@",example:""},Scientific:{text:"科学计数",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"会计",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"万元",value:"w",example:"1亿2000万2500"},Currency:{text:"货币",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"日期",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"时间",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"时间24H",value:"hh:mm",example:"15:00"},DateTime:{text:"日期时间",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"日期时间24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"自定义格式",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"更多货币格式",moreDateTime:"更多日期与时间格式",moreNumber:"更多数字格式",titleCurrency:"货币格式",decimalPlaces:"小数位数",titleDateTime:"日期与时间格式",titleNumber:"数字格式"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"微软雅黑",SimSun:"宋体",SimHei:"黑体",Kaiti:"楷体",FangSong:"仿宋",NSimSun:"新宋体",STXinwei:"华文新魏",STXingkai:"华文行楷",STLiti:"华文隶书",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"常规视图",layoutBtn:"页面布局",pageBtn:"分页预览",menuItemPrint:"打印(Ctrl+P)",menuItemAreas:"打印区域",menuItemRows:"打印标题行",menuItemColumns:"打印标题列"},align:{left:"左对齐",center:"中间对齐",right:"右对齐",top:"顶部对齐",middle:"居中对齐",bottom:"底部对齐"},button:{confirm:"确定",cancel:"取消",close:"关闭",update:"Update",delete:"Delete",insert:"新建",prevPage:"上一页",nextPage:"下一页",total:"总共："},punctuation:{tab:"Tab 键",semicolon:"分号",comma:"逗号",space:"空格"},colorPicker:{collapse:"收起",customColor:"自定义",change:"切换",confirmColor:"确定",cancelColor:"取消"},borderLine:{borderTop:"上框线",borderBottom:"下框线",borderLeft:"左框线",borderRight:"右框线",borderNone:"无",borderAll:"所有",borderOutside:"外侧",borderInside:"内侧",borderHorizontal:"内侧横线",borderVertical:"内侧竖线",borderColor:"边框颜色",borderSize:"边框粗细"},merge:{all:"全部合并",vertical:"垂直合并",horizontal:"水平合并",cancel:"取消合并",overlappingError:"不能合并重叠区域",partiallyError:"无法对部分合并单元格执行此操作"},textWrap:{overflow:"溢出",wrap:"自动换行",clip:"截断"},textRotate:{none:"无旋转",angleUp:"向上倾斜",angleDown:"向下倾斜",vertical:"竖排文字",rotationUp:"向上90°",rotationDown:"向下90°"},sheetConfig:{delete:"删除",copy:"复制",rename:"重命名",changeColor:"更改颜色",hide:"隐藏",unhide:"取消隐藏",moveLeft:"向左移",moveRight:"向右移",resetColor:"重置颜色",cancelText:"取消",chooseText:"确定颜色",tipNameRepeat:"标签页的名称不能重复！请重新修改",noMoreSheet:"工作薄内至少含有一张可视工作表。若需删除选定的工作表，请先插入一张新工作表或显示一张隐藏的工作表。",confirmDelete:"是否删除",redoDelete:"可以通过Ctrl+Z撤销删除",noHide:"不能隐藏, 至少保留一个sheet标签",chartEditNoOpt:"图表编辑模式下不允许该操作！",sheetNameSpecCharError:"名称不能超过31个字符，首尾不能是' 且名称不能包含:\r\n[ ] : \\ ? * /",sheetNameCannotIsEmptyError:"名称不能为空!"},rightClick:{copy:"复制",copyAs:"复制为",paste:"粘贴",insert:"插入",delete:"删除",deleteCell:"删除单元格",deleteSelected:"删除选中",hide:"隐藏",hideSelected:"隐藏选中",showHide:"显示隐藏",to:"向",left:"左",right:"右",top:"上",bottom:"下",moveLeft:"左移",moveUp:"上移",add:"增加",row:"行",column:"列",width:"宽",height:"高",number:"数字",confirm:"确认",orderAZ:"A-Z顺序排列",orderZA:"Z-A降序排列",clearContent:"清除内容",matrix:"矩阵操作选区",sortSelection:"排序选区",filterSelection:"筛选选区",chartGeneration:"图表生成",firstLineTitle:"首行为标题",untitled:"无标题",array1:"一维数组",array2:"二维数组",array3:"多维数组",diagonal:"对角线",antiDiagonal:"反对角线",diagonalOffset:"对角偏移",offset:"偏移量",boolean:"布尔值",flip:"翻转",upAndDown:"上下",leftAndRight:"左右",clockwise:"顺时针",counterclockwise:"逆时针",transpose:"转置",matrixCalculation:"矩阵计算",plus:"加",minus:"减",multiply:"乘",divided:"除",power:"次方",root:"次方根",log:"log",delete0:"删除两端0值",removeDuplicate:"删除重复值",byRow:"按行",byCol:"按列",generateNewMatrix:"生成新矩阵"},info:{detailUpdate:"新打开",detailSave:"已恢复本地缓存",row:"行",column:"列",loading:"渲染中···",copy:"副本",return:"返回",rename:"重命名",tips:"重命名",noName:"无标题的电子表格",wait:"待更新",add:"添加",addLast:"在底部添加",backTop:"回到顶部",pageInfo:"共${total}条，${totalPage}页，当前已显示${currentPage}页",nextPage:"下一页",tipInputNumber:"请输入数字",tipInputNumberLimit:"增加范围限制在1-100",tipRowHeightLimit:"行高必须在0 ~ 545之间",tipColumnWidthLimit:"列宽必须在0 ~ 2038之间",pageInfoFull:"共${total}条，${totalPage}页，已显示全部数据"}},lc={spreadsheetLabel:"Spreadsheet",spreadsheetRightLabel:"more Sheets",spreadsheet:{one:"one",two:"two",three:"three"},toolbar:{undo:"Undo",redo:"Redo",paintFormat:"Paint format",currencyFormat:"Format as currency",percentageFormat:"Format as percent",numberDecrease:"Decrease decimal places",numberIncrease:"Increase decimal places",moreFormats:"More formats",font:"Font",fontSize:"Font size",bold:"Bold (Ctrl+B)",italic:"Italic (Ctrl+I)",strikethrough:"Strikethrough (Alt+Shift+5)",underline:"Underline",textColor:{main:"Text color",right:"Choose color"},resetColor:"Reset",customColor:"CUSTOM",alternatingColors:"Alternating colors",confirmColor:"OK",cancelColor:"Cancel",collapse:"Collapse",fillColor:{main:"Fill color",right:"Choose color"},border:{main:"Border",right:"Border style"},mergeCell:{main:"Merge cells",right:"Choose merge type"},horizontalAlignMode:{main:"Horizontal align",right:"Alignment"},verticalAlignMode:{main:"Vertical align",right:"Alignment"},textWrapMode:{main:"Text wrap",right:"Text wrap mode"},textRotateMode:{main:"Text rotate",right:"Text rotate mode"},freezeTopRow:"Freeze top row",sortAndFilter:"Sort and filter",findAndReplace:"Find and replace",sum:"SUM",autoSum:"Auto SUM",moreFunction:"More functions",conditionalFormat:"Conditional format",comment:"Comment",pivotTable:"Pivot Table",chart:"Chart",screenshot:"Screenshot",splitColumn:"Split text",insertImage:"Insert image",insertLink:"Insert link",dataValidation:"Data validation",protection:"Protect the sheet",clearText:"Clear color",noColorSelectedText:"No color is selected",toolMore:"More",toolLess:"Less",toolClose:"Close",toolMoreTip:"More features",moreOptions:"More options",cellFormat:"Cell format config",print:"Print",borderMethod:{top:"Upper frame line",bottom:"Lower frame line",left:"Left frame line",right:"Right frame line"},more:"More"},defaultFmt:{Automatic:{text:"Automatic",value:"General",example:""},Number:{text:"Number",value:"##0.00",example:"1000.12"},Percent:{text:"Percent",value:"#0.00%",example:"12.21%"},PlainText:{text:"Plain text",value:"@",example:""},Scientific:{text:"Scientific",value:"0.00E+00",example:"1.01E+5"},Accounting:{text:"Accounting",value:"¥(0.00)",example:"¥(1200.09)"},Thousand:{text:"Ten Thousand",value:"w",example:"1亿2000万2500"},Currency:{text:"Currency",value:"¥0.00",example:"¥1200.09"},Digit:{text:"万元2位小数",value:"w0.00",example:"2万2500.55"},Date:{text:"Date",value:"yyyy-MM-dd",example:"2017-11-29"},Time:{text:"Time",value:"hh:mm AM/PM",example:"3:00 PM"},Time24H:{text:"Time 24H",value:"hh:mm",example:"15:00"},DateTime:{text:"Date time",value:"yyyy-MM-dd hh:mm AM/PM",example:"2017-11-29 3:00 PM"},DateTime24H:{text:"Date time 24H",value:"yyyy-MM-dd hh:mm",example:"2017-11-29 15:00"},CustomFormats:{text:"Custom Formats",value:"fmtOtherSelf",example:""}},format:{moreCurrency:"More currency formats",moreDateTime:"More date and time formats",moreNumber:"More number formats",titleCurrency:"Currency formats",decimalPlaces:"Decimal places",titleDateTime:"Date and time formats",titleNumber:"Number formats"},fontFamily:{TimesNewRoman:"Times New Roman",Arial:"Arial",Tahoma:"Tahoma",Verdana:"Verdana",MicrosoftAccorblack:"Microsoft Accor black ",SimSun:"SimSun",SimHei:"SimHei",Kaiti:"Kaiti",FangSong:"FangSong",NSimSun:"NSimSun",STXinwei:"STXinwei",STXingkai:"STXingkai",STLiti:"STLiti",HanaleiFill:"HanaleiFill",Anton:"Anton",Pacifico:"Pacifico"},print:{normalBtn:"Normal",layoutBtn:"Page Layout",pageBtn:"Page break preview",menuItemPrint:"Print (Ctrl+P)",menuItemAreas:"Print areas",menuItemRows:"Print title rows",menuItemColumns:"Print title columns"},align:{left:"left",center:"center",right:"right",top:"top",middle:"middle",bottom:"bottom"},dateFmtList:[{name:"1930-08-05",value:"yyyy-MM-dd"},{name:"1930/8/5",value:"yyyy/MM/dd"},{name:"08-05",value:"MM-dd"},{name:"8-5",value:"M-d"},{name:"13:30:30",value:"h:mm:ss"},{name:"13:30",value:"h:mm"},{name:"PM 01:30",value:"AM/PM hh:mm"},{name:"PM 1:30",value:"AM/PM h:mm"},{name:"PM 1:30:30",value:"AM/PM h:mm:ss"},{name:"08-05 PM 01:30",value:"MM-dd AM/PM hh:mm"}],numFmtList:[{name:"1235",value:"0"},{name:"1234.56",value:"0.00"},{name:"1,235",value:"#,##0"},{name:"1,234.56",value:"#,##0.00"},{name:"1,235",value:"#,##0_);(#,##0)"},{name:"1,235",value:"#,##0_);[Red](#,##0)"},{name:"1,234.56",value:"#,##0.00_);(#,##0.00)"},{name:"1,234.56",value:"#,##0.00_);[Red](#,##0.00)"},{name:"$1,235",value:"$#,##0_);($#,##0)"},{name:"$1,235",value:"$#,##0_);[Red]($#,##0)"},{name:"$1,234.56",value:"$#,##0.00_);($#,##0.00)"},{name:"$1,234.56",value:"$#,##0.00_);[Red]($#,##0.00)"},{name:"1234.56",value:"@"},{name:"123456%",value:"0%"},{name:"123456.00%",value:"0.00%"},{name:"1.23E+03",value:"0.00E+00"},{name:"1.2E+3",value:"##0.0E+0"},{name:"1234 5/9",value:"# ?/?"},{name:"1234 14/25",value:"# ??/??"},{name:"$ 1,235",value:'_($* #,##0_);_(...($* "-"_);_(@_)'},{name:"1,235",value:'_(* #,##0_);_(*..._(* "-"_);_(@_)'},{name:"$ 1,234.56",value:'_($* #,##0.00_);_(...($* "-"_);_(@_)'},{name:"1,234.56",value:'_(* #,##0.00_);...* "-"??_);_(@_)'}],button:{confirm:"OK",cancel:"Cancel",close:"Close",update:"Update",delete:"Delete",insert:"Insert",prevPage:"Previous",nextPage:"Next",total:"total:"},punctuation:{tab:"Tab",semicolon:"semicolond",comma:"comma",space:"space"},colorPicker:{collapse:"Collapse",customColor:"CUSTOM",change:"Change",confirmColor:"OK",cancelColor:"Cancel"},borderLine:{borderTop:"borderTop",borderBottom:"borderBottom",borderLeft:"borderLeft",borderRight:"borderRight",borderNone:"borderNone",borderAll:"borderAll",borderOutside:"borderOutside",borderInside:"borderInside",borderHorizontal:"borderHorizontal",borderVertical:"borderVertical",borderColor:"borderColor",borderSize:"borderSize"},merge:{all:"Merge all",vertical:"Vertical merge",horizontal:"Horizontal merger",cancel:"Cancel merge",overlappingError:"Cannot merge overlapping areas",partiallyError:"Cannot perform this operation on partially merged cells"},textWrap:{overflow:"Overflow",wrap:"Wrap",clip:"Clip"},textRotate:{none:"None",angleUp:"Tilt Up",angleDown:"Tilt Down",vertical:"Stack Vertically",rotationUp:"Rotate Up",rotationDown:"Rotate Down"},sheetConfig:{delete:"Delete",copy:"Copy",rename:"Rename",changeColor:"Change color",hide:"Hide",unhide:"Unhide",moveLeft:"Move left",moveRight:"Move right",resetColor:"Reset color",cancelText:"Cancel",chooseText:"Confirm color",tipNameRepeat:"The name of the tab page cannot be repeated! Please revise",noMoreSheet:"The workbook contains at least one visual worksheet. To delete the selected worksheet, please insert a new worksheet or show a hidden worksheet.",confirmDelete:"Are you sure to delete",redoDelete:"Can be undo by Ctrl+Z",noHide:"Can't hide, at least keep one sheet tag",chartEditNoOpt:"This operation is not allowed in chart editing mode!",sheetNameSpecCharError:"The name cannot contain:[ ] :  ? * / ' \"",sheetNameCannotIsEmptyError:"Sheet name cannot be empty"},rightClick:{copy:"Copy",copyAs:"Copy as",paste:"Paste",insert:"Insert",delete:"Delete",deleteCell:"Delete cell",deleteSelected:"Delete selected ",hide:"Hide",hideSelected:"Hide selected ",showHide:"Show hidden ",to:"Towards",left:"Left",right:"Right",top:"Top",bottom:"Bottom",moveLeft:"Move left",moveUp:"Move up",add:"Add",row:"Row",column:"Column",width:"Width",height:"Height",number:"Number",confirm:"Confirm",orderAZ:"A-Z order",orderZA:"Z-A order",clearContent:"Clear content",matrix:"Matrix operation",sortSelection:"Sort",filterSelection:"Filter",chartGeneration:"Create chart",firstLineTitle:"first line title",untitled:"untitled",array1:"One-dimensional array",array2:"Two-dimensional array",array3:"Multidimensional Arrays",diagonal:"Diagonal",antiDiagonal:"Anti-diagonal",diagonalOffset:"Diagonal offset",offset:"Offset",boolean:"Boolean",flip:"Flip",upAndDown:"Up and down",leftAndRight:"Left and right",clockwise:"Clockwise",counterclockwise:"Counterclockwise",transpose:"Transpose",matrixCalculation:"Matrix calculation",plus:"Plus",minus:"Minus",multiply:"Multiply",divided:"Divided",power:"Power",root:"Root",log:"Log",delete0:"Delete 0 values at both ends",removeDuplicate:"Remove duplicate values",byRow:"By row",byCol:"By column",generateNewMatrix:"Generate new matrix"},info:{detailUpdate:"New opened",detailSave:"Local cache restored",row:"",column:"",loading:"Loading...",copy:"Copy",return:"Exit",rename:"Rename",tips:"Rename",noName:"Untitled spreadsheet",wait:"waiting for update",add:"Add",addLast:"more rows at bottom",backTop:"Back to the top",pageInfo:"Total ${total}，${totalPage} page，current ${currentPage}",nextPage:"Next",tipInputNumber:"Please enter the number",tipInputNumberLimit:"The increase range is limited to 1-100",tipRowHeightLimit:"Row height must be between 0 ~ 545",tipColumnWidthLimit:"The column width must be between 0 ~ 2038",pageInfoFull:"Total ${total}，${totalPage} page，All data displayed"}};class hc{constructor(){this.zIndex=0}check(t){if(t===this.viewKey)return this}convert(t,e,n){}}const cc=Uo.create();cc.add(new class extends hc{constructor(){super(...arguments),this.zIndex=1,this.viewKey=hn.IMAGE}check(t){if(t===this.viewKey)return this}convert(t){const{id:e,zIndex:n,left:i=0,top:s=0,width:o,height:r,angle:a,scaleX:l,scaleY:h,skewX:c,skewY:d,flipX:u,flipY:g,title:_,description:p,image:m={}}=t,{imageProperties:f,placeholder:T,link:v}=m,E=(null==f?void 0:f.contentUrl)||"";return new Xa(e,{url:E,top:s,left:i,width:o,height:r,zIndex:n,angle:a,scaleX:l,scaleY:h,skewX:c,skewY:d,flipX:u,flipY:g,isTransformer:!0,forceRender:!0})}});cc.add(new class extends hc{constructor(){super(...arguments),this.zIndex=2,this.viewKey=hn.TEXT}check(t){if(t===this.viewKey)return this}convert(t,e,n){if(null==n)return;const{id:i,zIndex:s,left:o=0,top:r=0,width:a,height:l,angle:d,scaleX:u,scaleY:g,skewX:_,skewY:p,flipX:m,flipY:f,title:T,description:v,richText:E={}}=t,{text:b,ff:I,fs:C,it:S,bl:A,ul:w,st:R,ol:N,bg:y,bd:O,cl:D,rich:M}=E;let x={top:r,left:o,width:a,height:l,zIndex:s,angle:d,scaleX:u,scaleY:g,skewX:_,skewY:p,flipX:m,flipY:f,isTransformer:!0,forceRender:!0},L=!1;return null!=b?(x=c(h({},x),{text:b,ff:I,fs:C,it:S,bl:A,ul:w,st:R,ol:N,bg:y,bd:O,cl:D}),L=!0):null!=M&&(x=c(h({},x),{richText:M}),L=!0),!1!==L?new vh(n,i,x):void 0}});var dc,uc,gc,_c,pc,mc,fc,Tc;cc.add(new class extends hc{constructor(){super(...arguments),this.zIndex=2,this.viewKey=hn.SHAPE}check(t){if(t===this.viewKey)return this}convert(t){const{id:e,zIndex:n,left:i=0,top:s=0,width:o,height:r,angle:a,scaleX:l,scaleY:c,skewX:d,skewY:u,flipX:g,flipY:_,title:p,description:m}=t,{shapeType:f,text:T,shapeProperties:v,placeholder:E,link:b}=t.shape||{},I=null==v?"":Hn(v.shapeBackgroundFill)||"rgba(255,255,255,1)",C=null==v?void 0:v.outline,S={};if(C){const{outlineFill:t,weight:e}=C;S.strokeWidth=e,S.stroke=Hn(t)||"rgba(0,0,0,1)"}if(f===Ke.RECTANGLE)return new Wa(e,h({fill:I,top:s,left:i,width:o,height:r,zIndex:n,angle:a,scaleX:l,scaleY:c,skewX:d,skewY:u,flipX:g,flipY:_,isTransformer:!0,forceRender:!0},S));if(f===Ke.ROUND_RECTANGLE){const t=(null==v?void 0:v.radius)||0;return new Wa(e,h({fill:I,top:s,left:i,width:o,height:r,zIndex:n,angle:a,scaleX:l,scaleY:c,skewX:d,skewY:u,flipX:g,flipY:_,isTransformer:!0,forceRender:!0,radius:t},S))}Ke.ELLIPSE}}),(uc=dc||(dc={})).MAIN="spreadInSlide",uc.SCENE="spreadInSlideScene",uc.SCENE_VIEWER="spreadInSlideSceneViewer",uc.ROW="spreadInSlideRow",uc.COLUMN="spreadInSlideColumn",uc.LEFT_TOP="spreadInSlideLeftTop",uc.VIEW_MAIN="spreadInSlideViewMain",uc.VIEW_TOP="spreadInSlideViewTop",uc.VIEW_LEFT="spreadInSlideViewLeft",uc.VIEW_LEFT_TOP="spreadInSlideViewLeftTop";cc.add(new class extends hc{constructor(){super(...arguments),this.zIndex=4,this.viewKey=hn.SPREADSHEET}check(t){if(t===this.viewKey)return this}convert(t,e,n){const{id:i,zIndex:s,left:o=0,top:r=0,width:a,height:l,angle:h,scaleX:c,scaleY:d,skewX:u,skewY:g,flipX:_,flipY:p,title:m,description:f,spreadsheet:T}=t;if(null==T||null==n)return;const{worksheet:v,styles:E}=T,{columnData:b,rowData:I,cellData:C}=v,S=new H(C),A=tc.create(v,S,new Ln(E),n),{rowTotalHeight:w,columnTotalWidth:R,rowTitleWidth:N,columnTitleHeight:y}=A,O=R+v.rowTitle.width||0,D=w+v.columnTitle.height||0,M=new xh(dc.SCENE_VIEWER+i,{top:r,left:o,width:a,height:l,zIndex:s,angle:h,scaleX:c,scaleY:d,skewX:u,skewY:g,flipX:_,flipY:p,isTransformer:!0,forceRender:!0}),x=new Mh(dc.SCENE+i,M,{width:O,height:D});this._updateViewport(i,N,y,x,e);const L=new qh("testSheetViewer",A,!1),k=new Qh(dc.ROW,A),P=new Jh(dc.COLUMN,A),B=new Wa(dc.LEFT_TOP,{zIndex:2,left:-1,top:-1,width:N,height:y,fill:Kr([248,249,250]),stroke:Kr([217,217,217]),strokeWidth:1});return L.zIndex=10,x.addObjects([L],1),x.addObjects([k,P,B],2),L.enableSelection(),M}_updateViewport(t,e,n,i,s){if(null==s)return;const o=e*i.scaleX,r=n*i.scaleY,a=new Lh(dc.VIEW_MAIN+t,i,{left:o,top:r,bottom:0,right:0,isWheelPreventDefaultX:!0}),l=new Lh(dc.VIEW_TOP+t,i,{left:o,height:r,top:0,right:0,isWheelPreventDefaultX:!0}),h=new Lh(dc.VIEW_LEFT+t,i,{left:0,bottom:0,top:r,width:o,isWheelPreventDefaultX:!0}),c=new Lh(dc.VIEW_LEFT_TOP+t,i,{left:0,top:0,width:o,height:r,isWheelPreventDefaultX:!0});a.onScrollAfterObserver.add((t=>{const{scrollX:e,scrollY:n,actualScrollX:i,actualScrollY:s}=t;l.updateScroll({scrollX:e,actualScrollX:i}).makeDirty(!0),h.updateScroll({scrollY:n,actualScrollY:s}).makeDirty(!0)})),i.addViewport(a,h,l,c).attachControl(),new Ga(a,{mainScene:s}),i.on(hr.wheel,((t,e)=>{const n=t;if(n.ctrlKey){const t=Math.abs(n.deltaX);let e=t<40?.05:t<80?.02:.01;e*=n.deltaY>0?-1:1,i.scaleX<1&&(e/=2),i.scaleX+e>4?i.scale(4,4):i.scaleX+e<.1?i.scale(.1,.1):(i.scaleBy(e,e),n.preventDefault())}else a.onMouseWheel(n,e)}))}}),(_c=gc||(gc={})).MAIN="__DocsRender__",_c.SCENE_VIEWER="__DocsViewer__",_c.SCENE="__DocsScene__",_c.VIEWPORT="__DocsViewPort_";cc.add(new class extends hc{constructor(){super(...arguments),this.zIndex=5,this.viewKey=hn.DOCUMENT,this._liquid=new hh}check(t){if(t===this.viewKey)return this}convert(t,e,n){var i,s;const{id:o,zIndex:r,left:a=0,top:l=0,width:h,height:c,angle:d,scaleX:u,scaleY:g,skewX:_,skewY:p,flipX:m,flipY:f,title:T,description:v,document:E}=t;if(null==E)return;const b=Ql.create(E,n),I=new fh(gc.MAIN,b);b.calculate();const C=new xh(gc.SCENE_VIEWER+o,{top:l,left:a,width:h,height:c,zIndex:r,angle:d,scaleX:u,scaleY:g,skewX:_,skewY:p,flipX:m,flipY:f,isTransformer:!0}),S=new Mh(gc.SCENE+o,C),A=new Lh(gc.VIEWPORT+o,S,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});S.addViewport(A).attachControl(),S.on(hr.wheel,((t,e)=>{const n=t;if(n.ctrlKey){const t=Math.abs(n.deltaX);let e=t<40?.2:t<80?.4:.2;e*=n.deltaY>0?-1:1,S.scaleX<1&&(e/=2),S.scaleX+e>4?S.scale(4,4):S.scaleX+e<.1?S.scale(.1,.1):(n.deltaY,n.preventDefault())}else A.onMouseWheel(n,e)})),new Ga(A,{mainScene:e}),S.addObject(I),I.calculatePagePosition();const w=null==(i=I.getSkeleton())?void 0:i.getPageSize();I.onPageRenderObservable.add((t=>{const{page:e,pageLeft:n,pageTop:i,ctx:s}=t,{width:o,height:r,marginBottom:a,marginLeft:l,marginRight:h,marginTop:c}=e;s.save(),s.translate(n-.5,i-.5),Wa.drawWith(s,{width:(null==w?void 0:w.width)||o,height:(null==w?void 0:w.height)||r,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:"rgba(255,255,255, 1)",zIndex:3}),s.restore()}));const{left:R,top:N}=I,{pages:y}=b.getSkeletonData(),O=[],D=new Map;for(let M=0,x=y.length;M<x;M++){const t=y[M],{skeDrawings:e,marginLeft:n,marginTop:i,pageWidth:s,pageHeight:o}=t;this._liquid.translatePagePadding(t),e.forEach((t=>{var e;const{aLeft:n,aTop:i,height:s,width:o,drawingOrigin:r}=t,{objectProperties:a}=r,l=new Xa(t.objectId,{url:(null==(e=a.imageProperties)?void 0:e.contentUrl)||"",left:n+R+this._liquid.x,top:i+N+this._liquid.y,width:o,height:s,zIndex:11,isTransformer:!0});D.set(t.objectId,{marginLeft:this._liquid.x,marginTop:this._liquid.y}),O.push(l)})),this._liquid.translatePage(t,I.pageLayoutType,I.pageMarginLeft,I.pageMarginTop)}return S.openTransformer(),S.addObjects(O),null==(s=S.getTransformer())||s.onChangingObservable.add((t=>{const{objects:e}=t;e.forEach((t=>{const{oKey:e,left:n,top:i,height:s,width:o}=t,r=D.get(e),a=(null==r?void 0:r.marginLeft)||0,l=(null==r?void 0:r.marginTop)||0;null==b||b.updateDrawing(e,{left:n-R-a,top:i-N-l,height:s,width:o})})),null==b||b.calculate()})),S.closeTransformer(),C}}),(mc=pc||(pc={})).MAIN="__SLIDERender__",mc.SCENE_VIEWER="__SLIDEViewer__",mc.SCENE="__SLIDEScene__",mc.VIEWPORT="__SLIDEViewPort_";cc.add(new class extends hc{constructor(){super(...arguments),this.zIndex=6,this.viewKey=hn.SLIDE}check(t){if(t===this.viewKey)return this}convert(t,e,n){const{id:i,zIndex:s,left:o=0,top:r=0,width:a,height:l,angle:h,scaleX:c,scaleY:d,skewX:u,skewY:g,flipX:_,flipY:p,title:m,description:f,slide:T}=t;if(null==T)return;const v=new zo(T,n),E=new oc(pc.MAIN+i,{top:r,left:o,width:a,height:l,zIndex:s,angle:h,scaleX:c,scaleY:d,skewX:u,skewY:g,flipX:_,flipY:p,isTransformer:!1,forceRender:!0});E.enableNav(),E.enableSelectedClipElement();const b=v.getPageOrder(),I=v.getPages();if(!b||!I)return E;this._ObjectProvider=new vc;for(var C=0,S=b.length;C<S;C++){const t=I[b[C]],{id:i}=t;E.addPage(this._createScene(i,E,t,e,v,n))}return E.activeFirstPage(),E}_createScene(t,e,n,i,s,o){let{width:r,height:a}=e;const l=new Mh(t,e,{width:r,height:a}),h=new Lh("PageViewer_"+t,l,{left:0,top:0,bottom:0,right:0});h.closeClip(),l.addViewport(h);const{pageElements:c,pageBackgroundFill:d}=n,u=this._ObjectProvider.convertToRenderObjects(c,i,o);return l.openTransformer(),this._addBackgroundRect(l,d,s),l.addObjects(u),l}_addBackgroundRect(t,e,n){const i=n.getPageSize(),{width:s=0,height:o=0}=i,r=new Wa("canvas",{left:0,top:0,width:s,height:o,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:Hn(e)||"rgba(255,255,255, 1)",zIndex:0,evented:!1});t.addObject(r,0)}});class vc{constructor(){this._adaptors=[],this._adaptorLoader()}convertToRenderObjects(t,e,n){const i=Object.keys(t),s=[];return i.forEach((i=>{const o=t[i],r=this._executor(o,e,n);null!=r&&s.push(r)})),s}_executor(t,e,n){var i;const{id:s,type:o}=t;for(let r of this._adaptors){const s=null==(i=r.check(o))?void 0:i.convert(t,e,n);if(null!=s)return s}}_adaptorLoader(){cc.getData().sort(ci).forEach((t=>{this._adaptors.push(t)}))}static create(){return new vc}}(Tc=fc||(fc={})).COMPONENT="__slideRender__",Tc.SCENE="__mainScene__",Tc.VIEW="__mainView__";class Ec{constructor(t,e){this._engine=t,this._plugin=e,this._slideThumbEngine=new Map,this._ObjectProvider=new vc,this._initialize()}getSlide(){return this._slide}createSlidePages(t,e){if(null!=t&&t.length===e.length){for(let n=0,i=t.length;n<i;n++){const i=t[n].querySelector("div"),s=e[n],{id:o}=s;!this._slideThumbEngine.has(o)&&i&&this._createScene(o,this._slide,e[n])}setTimeout((()=>{for(let n=0,i=t.length;n<i;n++){const i=t[n].querySelector("div"),s=e[n],{id:o}=s;!this._slideThumbEngine.has(o)&&i&&(this._createThumb(i,o),this._thumbSceneRender(o))}}),300),this._activePageId=e[0].id,this._slide.activeFirstPage()}}activePage(t){const e=this._plugin.context.getSlide();let n;if(t)n=e.getPage(t);else{const i=e.getPages(),s=e.getPageOrder();if(null==s||null==i)return;n=i[s[0]],t=n.id}if(null==n)return;const{id:i}=n;this._activePageId=t,this._slide.hasPage(i)?this._slide.changePage(i):this._createScene(i,this._slide,n)}scrollToCenter(){const t=this._scene.getViewport(fc.VIEW);if(!t)return;const{left:e,top:n}=this._getCenterPositionViewPort(),{x:i,y:s}=t.getBarScroll(e,n);t.scrollTo({x:i,y:s})}_initialize(){const t=this._engine,e=new Mh(fc.SCENE,t,{width:2400,height:1800});this._scene=e;const n=new Lh(fc.VIEW,e,{left:0,top:0,bottom:0,right:0,isWheelPreventDefaultX:!0});e.addViewport(n).attachControl(),e.on(hr.wheel,((t,i)=>{const s=t;if(s.ctrlKey){const t=Math.abs(s.deltaX);let n=t<40?.2:t<80?.4:.2;n*=s.deltaY>0?-1:1,e.scaleX<1&&(n/=2),e.scaleX+n>4?e.scale(4,4):e.scaleX+n<.1?e.scale(.1,.1):(s.deltaY,s.preventDefault())}else n.onMouseWheel(s,i)})),Ga.attachTo(n);const{left:i,top:s}=this._getCenterPositionViewPort(),{x:o,y:r}=n.getBarScroll(i,s);n.scrollTo({x:o,y:r}),this._createSlide(),this.activePage(),t.runRenderLoop((()=>{e.render();const n=document.getElementById("app");n&&(n.innerText=`fps:${Math.round(t.getFps()).toString()}`)}))}_createSlide(){const t=this._plugin.context.getSlide(),e=this._scene,{width:n,height:i}=e,s=t.getPageSize(),{width:o=100,height:r=100}=s,a=new oc(fc.COMPONENT,{left:(n-o)/2,top:(i-r)/2,width:o,height:r,zIndex:10});a.enableNav(),a.enableSelectedClipElement(),this._slide=a,e.addObject(a)}_addBackgroundRect(t,e){const n=this._plugin.context.getSlide().getPageSize(),{width:i=0,height:s=0}=n,o=new Wa("canvas",{left:0,top:0,width:i,height:s,strokeWidth:1,stroke:"rgba(198,198,198, 1)",fill:Hn(e)||"rgba(255,255,255, 1)",zIndex:0,evented:!1});t.addObject(o,0)}_getCenterPositionViewPort(){const{width:t,height:e}=this._scene,n=this._scene.getEngine();return{left:(t-((null==n?void 0:n.width)||0))/2,top:(e-((null==n?void 0:n.height)||0))/2}}_thumbSceneRender(t){const e=this._slideThumbEngine.get(t);if(null==e)return;const{width:n,height:i}=this._slide,{width:s=n,height:o=i}=e,r=e.getCanvas().getContext();this._slide.renderToThumb(r,t,s/n,o/i)}_createThumb(t,e){const n=new La;n.setContainer(t),this._slideThumbEngine.set(e,n)}_createScene(t,e,n){let{width:i,height:s}=e;const o=new Mh(t,e,{width:i,height:s}),r=new Lh(`PageViewer_${t}`,o,{left:0,top:0,bottom:0,right:0});r.closeClip(),o.addViewport(r);const{pageElements:a,pageBackgroundFill:l}=n,h=this._ObjectProvider.convertToRenderObjects(a,this._scene,this._plugin.context);o.openTransformer(),this._addBackgroundRect(o,l),o.addObjects(h);const c=o.getTransformer();return null==c||c.onChangeEndObservable.add((()=>{this._thumbSceneRender(this._activePageId)})),null==c||c.onClearControlObservable.add((()=>{this._thumbSceneRender(this._activePageId)})),this._slide.addPage(o),o}}const bc={};class Ic extends ko{constructor(t={}){super(sn.SLIDE),this._config=Object.assign(bc,t)}static create(t){return new Ic(t)}installTo(t){t.installPlugin(this)}initialize(t){var e;this.context=t,this.getGlobalContext().getLocale().load({en:lc,zh:ac}),(e=this).pushToObserve("onAfterChangeFontFamilyObservable"),e.pushToObserve("onAfterChangeFontSizeObservable"),e.pushToObserve("onAfterChangeFontWeightObservable"),e.pushToObserve("onAfterChangeFontItalicObservable"),e.pushToObserve("onAfterChangeFontStrikethroughObservable"),e.pushToObserve("onAfterChangeFontUnderlineObservable"),e.pushToObserve("onAfterChangeFontBackgroundObservable"),e.pushToObserve("onAfterChangeFontColorObservable"),e.pushToObserve("onDragAndDropStartObserver"),e.pushToObserve("onDragAndDroppingObserver"),e.pushToObserve("onDragAndDropEndEndObserver"),e.pushToObserve("onFillStartObserver"),e.pushToObserve("onFillingObserver"),e.pushToObserve("onFillEndObserver"),e.pushToObserve("onChangeCurrentSheetObserver"),e.pushToObserve("onToolbarDidMountObservable"),e.pushToObserve("onSheetBarDidMountObservable"),e.pushToObserve("onCountBarDidMountObservable"),e.pushToObserve("onInfoBarDidMountObservable"),e.pushToObserve("onSlideBarDidMountObservable"),e.pushToObserve("onRightMenuDidMountObservable"),e.pushToObserve("onSlideContainerDidMountObservable"),e.pushToObserve("onSpreadsheetKeyDownObservable"),e.pushToObserve("onSpreadsheetKeyUpObservable"),e.pushToObserve("onSpreadsheetKeyCopyObservable"),e.pushToObserve("onSpreadsheetKeyPasteObservable"),e.pushToObserve("onSpreadsheetKeyCutObservable"),e.pushToObserve("onSpreadsheetKeyCompositionStartObservable"),e.pushToObserve("onSpreadsheetKeyCompositionUpdateObservable"),e.pushToObserve("onSpreadsheetKeyCompositionEndObservable"),this.initConfig(),this.initController(),this.initCanvasView(),this.registerExtension(),this.listenEventManager()}getConfig(){return this._config}initConfig(){}initController(){}initCanvasView(){const t=this.getGlobalContext().getPluginManager().getRequirePluginByName(sn.BASE_RENDER).getEngine();this._canvasEngine=t,null==this._canvasView&&(this._canvasView=new Ec(t,this))}onMounted(t){this.initialize(t)}onDestroy(){var t;super.onDestroy(),(t=this).deleteObserve("onAfterChangeFontFamilyObservable"),t.deleteObserve("onAfterChangeFontSizeObservable"),t.deleteObserve("onAfterChangeFontWeightObservable"),t.deleteObserve("onAfterChangeFontItalicObservable"),t.deleteObserve("onAfterChangeFontStrikethroughObservable"),t.deleteObserve("onAfterChangeFontUnderlineObservable"),t.deleteObserve("onAfterChangeFontBackgroundObservable"),t.deleteObserve("onAfterChangeFontColorObservable"),t.deleteObserve("onToolbarDidMountObservable"),t.deleteObserve("onSlideBarDidMountObservable"),t.deleteObserve("onChangeCurrentSheetObserver"),t.deleteObserve("onSlideContainerDidMountObservable"),t.deleteObserve("onSpreadsheetKeyDownObservable"),t.deleteObserve("onSpreadsheetKeyUpObservable"),t.deleteObserve("onSpreadsheetKeyCopyObservable"),t.deleteObserve("onSpreadsheetKeyPasteObservable"),t.deleteObserve("onSpreadsheetKeyCutObservable"),t.deleteObserve("onSpreadsheetKeyCompositionStartObservable"),t.deleteObserve("onSpreadsheetKeyCompositionUpdateObservable"),t.deleteObserve("onSpreadsheetKeyCompositionEndObservable")}registerExtension(){}listenEventManager(){}getCanvasEngine(){return this._canvasEngine}getCanvasView(){return this._canvasView}}St.COLUMN,wt.PARAGRAPH,lt.WRAP_SQUARE,Ue.FALSE,rt.BOTH_SIDES,X.START,X.START,X.START,X.START,Y.ROMAN,X.START,Y.ROMAN,X.START,Y.ROMAN,K.PARAGRAPH,st.TEXT_RUN,st.DRAWING,st.TEXT_RUN,Be.SUPERSCRIPT,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN;const Cc={id:"d",body:{blockElements:[{blockId:"oneParagraph",st:0,ed:15,blockType:K.PARAGRAPH,paragraph:{elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"在“第1题”工作表中完成以下操作",ts:{fs:12,bg:{rgb:"rgb(200,0,90)"},cl:{rgb:"rgb(255,130,0)"}}}},{eId:"twoElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"上标",ts:{fs:14,bg:{rgb:"rgb(2,128,2)"},cl:{rgb:"rgb(0,1,55)"},va:Be.SUPERSCRIPT}}},{eId:"twoElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"日期列单元格数据验证，限制只能输入日期（介于1949年1月1日至2099年1月1日）",ts:{fs:14,bg:{rgb:"rgb(90,128,255)"},cl:{rgb:"rgb(0,1,255)"}}}}]}}]},documentStyle:{pageSize:{width:1/0,height:1/0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};me.EN,Ue.FALSE,Yt.MEDIUM_DASHED,Yt.MEDIUM_DASHED,Yt.THICK,Yt.THIN,Ne.RIGHT,Oe.TOP,Ne.RIGHT,Oe.MIDDLE,Me.WRAP,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Me.WRAP,Ie.GRID,z.deepClone(Cc),Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ie.GRID,Ie.GRID,Ie.GRID,Ie.GRID,Ie.GRID,me.EN,Ue.FALSE,Yt.MEDIUM_DASHED,Yt.MEDIUM_DASHED,Yt.THICK,Yt.THIN,Ne.RIGHT,Oe.TOP,Me.WRAP,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Ie.GRID,z.deepClone(Cc),Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ie.GRID;const Sc={unorderedTest:{listId:"unorderedTest",nestingLevel:[{bulletAlignment:X.START,glyphFormat:" %0",textStyle:{fs:12},startNumber:0,glyphSymbol:"●",hanging:21,indentStart:21},{bulletAlignment:X.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"■",hanging:21,indentStart:42},{bulletAlignment:X.START,glyphFormat:" %1",textStyle:{fs:12},startNumber:0,glyphSymbol:"◆",hanging:21,indentStart:63}]},testBullet:{listId:"testBullet",nestingLevel:[{bulletAlignment:X.START,glyphFormat:" %1.",textStyle:{fs:12},startNumber:0,glyphType:Y.ROMAN,hanging:21,indentStart:21},{bulletAlignment:X.START,glyphFormat:" %1.%2)",textStyle:{fs:12},startNumber:0,glyphType:Y.ROMAN,hanging:21,indentStart:42},{bulletAlignment:X.START,glyphFormat:" %1.%2.%3.",textStyle:{fs:12},startNumber:0,glyphType:Y.ROMAN,hanging:21,indentStart:63}]}},Ac={id:"d",lists:Sc,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:K.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:st.TEXT_RUN,tr:{ct:"What’s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:Ue.TRUE,fs:16,cl:{rgb:"rgb(255,255,255)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:st.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:12,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:st.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p4",st:402,ed:429,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:st.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:st.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:12,bl:Ue.TRUE}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:st.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:12,bl:Ue.TRUE}}}]}},{blockId:"p5",st:430,ed:479,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:st.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"testBullet",nestingLevel:1,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:st.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:12,cl:{rgb:"rgb(0, 0, 0)"},bl:Ue.TRUE}}}]}},{blockId:"p6",st:480,ed:510,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20,cl:{rgb:"rgb(249,249,249)"}}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:st.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:12,cl:{rgb:"rgb(249,249,249)"}}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:0,marginBottom:0,marginRight:2,marginLeft:2}};K.PARAGRAPH,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN;me.EN,Ue.FALSE,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,me.EN,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,me.EN,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE;K.PARAGRAPH,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN,st.PAGE_BREAK,st.TEXT_RUN;me.EN,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE;K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN;me.EN,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Ie.GRID,Ue.FALSE,Ue.FALSE,Ue.FALSE,Ue.FALSE,me.EN,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,me.EN,Ue.FALSE,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THICK,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,Yt.THIN,me.EN,Ue.FALSE,me.EN,Ue.FALSE;const wc={id:"workbook-01",theme:"default",locale:me.EN,creator:"univer",name:"universheet",skin:"default",socketUrl:"",socketEnable:Ue.FALSE,extensions:[],sheetOrder:["sheet-0001"],pluginMeta:{},styles:{1:{vt:2,ht:2,bl:1,fs:14,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"}},2:{vt:2,ht:2,bl:1,fs:20,bg:{rgb:"rgb(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},3:{vt:2,bg:{rgb:"rgb(105,126,146)"},cl:{rgb:"rgb(255,255,255)"},fs:14,ht:2,bd:{t:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},4:{fs:12,vt:2,pd:{l:5},ht:2,bd:{t:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},5:{ht:2,vt:2,bd:{t:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}}}},6:{ht:1,vt:2,tb:3,bg:{rgb:"rgba(244,79,86)"},cl:{rgb:"rgb(255,255,255)"},bd:{t:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},l:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},r:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}},b:{s:Yt.THIN,cl:{rgb:"rgb(217,217,217)"}}}}},timeZone:"GMT+8",createdTime:"2021-11-28 12:10:10",modifiedTime:"2021-11-29 12:10:10",appVersion:"3.0.0-alpha",lastModifiedBy:"univer",sheets:{"sheet-0001":{type:Ie.GRID,id:"sheet-0001",name:"sheet-0001",tabColor:"blue",hidden:Ue.FALSE,freezeColumn:1,rowCount:12,columnCount:11,freezeRow:1,zoomRatio:1,scrollTop:200,scrollLeft:100,defaultColumnWidth:93,defaultRowHeight:40,cellData:{1:{1:{v:"Variants",s:"2"},2:{v:"Platform",s:"2"},3:{v:"UGC Buzz volume",s:"2"},9:{p:Ac,s:"6"}},2:{3:{v:"Jul'21",s:"1"},4:{v:"Aug'21",s:"1"},5:{v:"Sep'21",s:"1"},6:{v:"Oct'21",s:"1"},7:{v:"Nov'21",s:"1"},8:{v:"Dec'21",s:"1"}},3:{1:{v:"Eleva",s:"3"},2:{v:"Amazon",s:"4"},3:{v:"4",s:"5"},4:{v:"145",s:"5"},5:{v:"44",s:"5"},6:{v:"20",s:"5"},7:{v:"7",s:"5"},8:{v:"12",s:"5"}},4:{2:{v:"Google",s:"4"},3:{v:"2",s:"5"},4:{v:"6",s:"5"},5:{v:"5",s:"5"},6:{v:"6",s:"5"},7:{v:"12",s:"5"},8:{v:"3113",s:"5"}},5:{2:{v:"Amazon",s:"4"},3:{v:"14",s:"5"},4:{v:"13",s:"5"},5:{v:"6",s:"5"},6:{v:"6",s:"5"},7:{v:"11",s:"5"},8:{v:"2",s:"5"}},6:{1:{v:"Similac",s:"3"},2:{v:"SaleForce",s:"4"},3:{v:"451",s:"5"},4:{v:"255",s:"5"},5:{v:"72",s:"5"},6:{v:"23",s:"5"},7:{v:"163",s:"5"},8:{v:"22",s:"5"}},7:{2:{v:"Oracle",s:"4"},3:{v:"0",s:"5"},4:{v:"1",s:"5"},5:{v:"1136",s:"5"},6:{v:"11",s:"5"},7:{v:"2",s:"5"},8:{v:"1",s:"5"}},8:{2:{v:"Apple",s:"4"},3:{v:"7",s:"5"},4:{v:"2",s:"5"},5:{v:"10",s:"5"},6:{v:"5",s:"5"},7:{v:"6",s:"5"},8:{v:"3",s:"5"}},9:{1:{v:"TC",s:"3"},2:{v:"IBM",s:"4"},3:{v:"1",s:"5"},4:{v:"12",s:"5"},5:{v:"2",s:"5"},6:{v:"1",s:"5"},7:{v:"1",s:"5"},8:{v:"1",s:"5"}},10:{2:{v:"Google",s:"4"},3:{v:"26",s:"5"},4:{v:"33",s:"5"},5:{v:"33",s:"5"},6:{v:"6",s:"5"},7:{v:"22",s:"5"},8:{v:"8",s:"5"}}},mergeData:[{startRow:1,endRow:2,startColumn:1,endColumn:1},{startRow:1,endRow:2,startColumn:2,endColumn:2},{startRow:1,endRow:1,startColumn:3,endColumn:8},{startRow:3,endRow:5,startColumn:1,endColumn:1},{startRow:6,endRow:8,startColumn:1,endColumn:1},{startRow:9,endRow:10,startColumn:1,endColumn:1},{startRow:1,endRow:10,startColumn:9,endColumn:10}],rowData:{0:{h:20}},columnData:{0:{w:20},2:{w:120},3:{w:60},4:{w:60},5:{w:60},6:{w:60},7:{w:60},8:{w:60}},status:1,showGridlines:0,hideRow:[],hideColumn:[],rowTitle:{width:46,hidden:Ue.FALSE},columnTitle:{height:20,hidden:Ue.FALSE},selections:["A2"],rightToLeft:Ue.FALSE,pluginMeta:{}}},namedRanges:[{namedRangeId:"named-rang",name:"namedRange",range:{sheetId:"sheet-0001",rangeData:{startRow:0,startColumn:0,endRow:1,endColumn:1}}}]};St.COLUMN,wt.PARAGRAPH,lt.WRAP_SQUARE,Ue.FALSE,rt.BOTH_SIDES,K.PARAGRAPH,st.TEXT_RUN,st.DRAWING,st.TEXT_RUN,Be.SUPERSCRIPT,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.PARAGRAPH,st.TEXT_RUN,st.TEXT_RUN,K.SECTION_BREAK,tt.NONE,Q.SECTION_TYPE_UNSPECIFIED;const Rc={id:"d",drawings:{shapeTest1:{objectId:"shapeTest1",objectProperties:{title:"test shape",description:"test shape",size:{width:222.6,height:129.6},positionH:{relativeFrom:St.COLUMN,posOffset:130},positionV:{relativeFrom:wt.PAGE,posOffset:510},angle:0,imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/gartner-tech-2022.png"}},layoutType:lt.WRAP_SQUARE,behindDoc:Ue.FALSE,wrapText:rt.BOTH_SIDES},shapeTest2:{objectId:"shapeTest2",objectProperties:{title:"test shape",description:"test shape",size:{width:254.8,height:234.3},positionH:{relativeFrom:St.COLUMN,posOffset:130},positionV:{relativeFrom:wt.PAGE,posOffset:200},angle:0,imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/hype-cycle-for-emerging-tech-2022.png"}},layoutType:lt.WRAP_SQUARE,behindDoc:Ue.FALSE,wrapText:rt.BOTH_SIDES}},lists:Sc,body:{blockElements:[{blockId:"p1",st:0,ed:66,blockType:K.PARAGRAPH,paragraph:{elements:[{eId:"e1",st:0,ed:66,et:st.TEXT_RUN,tr:{ct:"What’s New in the 2022 Gartner Hype Cycle for Emerging Technologies",ts:{bl:Ue.TRUE,fs:24,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p2",st:67,ed:251,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:67,ed:251,et:st.TEXT_RUN,tr:{ct:"Emerging technologies for 2022 fit into three main themes: evolving/expanding immersive experiences, accelerated artificial intelligence automation, and optimized technologist delivery.",ts:{fs:18,cl:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p3",st:252,ed:401,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:252,ed:401,et:st.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle identifies 25 must-know emerging technologies designed to help enterprise architecture and technology innovation leaders: ",ts:{fs:16}}}]}},{blockId:"p4",st:402,ed:429,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:402,ed:429,et:st.TEXT_RUN,tr:{ct:"Expand immersive experiences",ts:{fs:16}}}]}},{blockId:"p5",st:430,ed:479,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:430,ed:479,et:st.TEXT_RUN,tr:{ct:"Accelerate artificial intelligence (AI) automation",ts:{fs:16}}}]}},{blockId:"p6",st:480,ed:510,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{lineSpacing:1.5},elements:[{eId:"e1",st:480,ed:510,et:st.TEXT_RUN,tr:{ct:"Optimize technologist delivery ",ts:{fs:16}}}]}},{blockId:"p7",st:511,ed:705,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:511,ed:672,et:st.TEXT_RUN,tr:{ct:"These technologies are expected to greatly impact business and society over the next two to 10 years, but will especially enable CIOs and IT leaders to deliver on",ts:{fs:16}}},{eId:"e2",st:673,ed:705,et:st.TEXT_RUN,tr:{ct:"digital business transformation. ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:Ue.TRUE}}}]}},{blockId:"p8",st:706,ed:762,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20},elements:[{eId:"e1",st:706,ed:762,et:st.TEXT_RUN,tr:{ct:"Three Hype Cycle themes to think about in 2022 and beyond",ts:{fs:24,cl:{rgb:"rgb(255,255,255)"},bg:{rgb:"rgb(0,40,86)"}}}}]}},{blockId:"p9",st:763,ed:1233,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{spaceAbove:20,indentFirstLine:20},elements:[{eId:"e1",st:763,ed:1233,et:st.TEXT_RUN,tr:{ct:"The 2022 Gartner Hype Cycle features emerging technologies and distills insights from more than 2,000 technologies into a succinct high-potential set. Most technologies have multiple use cases but enterprise architecture and technology innovation leaders should prioritize those with the greatest potential benefit for their organization. (They will also need to launch a proof-of-concept project to demonstrate the feasibility of a technology for their target use case.)",ts:{fs:16}}},{eId:"shapeTest1",st:0,ed:0,et:st.DRAWING}]}},{blockId:"oneSectionBreak",st:0,ed:0,blockType:K.SECTION_BREAK,sectionBreak:{columnProperties:[],columnSeparatorType:tt.NONE,sectionType:Q.SECTION_TYPE_UNSPECIFIED}},{blockId:"p10",st:1234,ed:1576,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1234,ed:1576,et:st.TEXT_RUN,tr:{ct:"The benefit of these technologies is that they provide individuals with more control over their identities and data, and expand their range of experiences into virtual venues and ecosystems that can be integrated with digital currencies. These technologies also provide new ways to reach customers to strengthen or open up new revenue streams.",ts:{fs:16}}}]}},{blockId:"p11",st:1577,ed:1972,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1577,ed:1972,et:st.TEXT_RUN,tr:{ct:"Digital twin of the customer (DToC) is a dynamic virtual representation of a customer that simulates and learns to emulate and anticipate behavior. It can be used to modify and enhance the customer experience (CX) and support new digitalization efforts, products, services and opportunities. DToC will take five to 10 years until mainstream adoption but will be transformational to organizations.",ts:{fs:16}}}]}},{blockId:"p12",st:1973,ed:2047,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},elements:[{eId:"e1",st:1973,ed:2047,et:st.TEXT_RUN,tr:{ct:"Other critical technologies in immersive experiences include the following:",ts:{fs:16}}}]}},{blockId:"p13",st:2048,ed:2278,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2048,ed:2070,et:st.TEXT_RUN,tr:{ct:"Decentralized identity ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:Ue.TRUE}}},{eId:"e2",st:2071,ed:2278,et:st.TEXT_RUN,tr:{ct:"(DCI) allows an entity (typically a human user) to control their own digital identity by leveraging technologies such as blockchain or other distributed ledger technologies (DLTs), along with digital wallets.",ts:{fs:16}}}]}},{blockId:"p14",st:2279,ed:2421,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2279,ed:2293,et:st.TEXT_RUN,tr:{ct:"Digital humans ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 211)"},bl:Ue.TRUE}}},{eId:"e2",st:2294,ed:2421,et:st.TEXT_RUN,tr:{ct:"are interactive, AI-driven representations that have some of the characteristics, personality, knowledge and mindset of a human.",ts:{fs:16}}}]}},{blockId:"p15",st:2422,ed:2610,blockType:K.PARAGRAPH,paragraph:{paragraphStyle:{indentFirstLine:20},bullet:{listId:"unorderedTest",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"e1",st:2422,ed:2450,et:st.TEXT_RUN,tr:{ct:"Internal talent marketplaces ",ts:{fs:16,cl:{rgb:"rgb(0, 0, 0)"},bl:Ue.TRUE}}},{eId:"e2",st:2451,ed:2610,et:st.TEXT_RUN,tr:{ct:"match internal employees and, in some cases, a pool of contingent workers, to time-boxed projects and various work opportunities, with no recruiter involvement.",ts:{fs:16}}}]}},{blockId:"twoSectionBreak",st:0,ed:0,blockType:K.SECTION_BREAK,sectionBreak:{columnProperties:[{width:200,paddingEnd:5}],columnSeparatorType:tt.NONE,sectionType:Q.SECTION_TYPE_UNSPECIFIED}}]},documentStyle:{pageSize:{width:594.3,height:840.51},marginTop:72,marginBottom:72,marginRight:90,marginLeft:90}},Nc={id:"cover_1",pageType:an.SLIDE,zIndex:1,title:"cover",description:"this is first page, cover",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:hn.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:hn.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:hn.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},yc={id:"catalog_1",pageType:an.SLIDE,zIndex:2,title:"catalog",description:"this is second page, catalog",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:3,left:180,top:240,width:200,height:40,title:"Catalog",description:"",type:hn.TEXT,richText:{text:"Catalog",fs:42,cl:{rgb:"rgb(255,255,255)"}}},centerRect1:{id:"centerRect1",zIndex:2,left:140,top:168,width:203,height:203,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},firstRect1:{id:"firstRect1",zIndex:2,left:547,top:115,width:44,height:44,title:"index1",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},secondRect1:{id:"secondRect1",zIndex:2,left:547,top:210,width:44,height:44,title:"index2",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},thirdRect1:{id:"thirdRect1",zIndex:2,left:547,top:304,width:44,height:44,title:"index2",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},forth1:{id:"forth1",zIndex:2,left:547,top:397,width:44,height:44,title:"index2",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},first_index1:{id:"first_index1",zIndex:3,left:557,top:120,width:44,height:44,title:"mask",description:"",type:hn.TEXT,richText:{text:"01",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},first_title1:{id:"first_title1",zIndex:3,left:610,top:115,width:248,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"Strategic technology trends",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},first_detail1:{id:"first_detail1",zIndex:3,left:610,top:140,width:300,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"How they impact business goals.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},second_index1:{id:"second_index1",zIndex:3,left:557,top:215,width:44,height:44,title:"mask",description:"",type:hn.TEXT,richText:{text:"02",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},second_title1:{id:"second_title1",zIndex:3,left:610,top:210,width:248,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"Technical profile",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},second_detail1:{id:"second_detail1",zIndex:3,left:610,top:235,width:300,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"What the technologies are and do.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},third_index1:{id:"third_index1",zIndex:3,left:557,top:310,width:44,height:44,title:"mask",description:"",type:hn.TEXT,richText:{text:"03",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},third_title1:{id:"third_title1",zIndex:3,left:610,top:305,width:248,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"Opportunities",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},third_detail1:{id:"third_detail1",zIndex:3,left:610,top:330,width:300,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"What benefits and outcomes they drive.",fs:14,cl:{rgb:"rgb(255,255,255)"}}},forth_index1:{id:"forth_index1",zIndex:3,left:557,top:405,width:44,height:44,title:"mask",description:"",type:hn.TEXT,richText:{text:"04",fs:28,cl:{rgb:"rgb(255,255,255)"},bl:1}},forth_title1:{id:"forth_title1",zIndex:3,left:610,top:400,width:248,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"Implementation steps",fs:20,cl:{rgb:"rgb(244,79,86)"},bl:1}},forth_detail1:{id:"forth_detail1",zIndex:3,left:610,top:425,width:300,height:39,title:"mask",description:"",type:hn.TEXT,richText:{text:"Action plans for implementation.",fs:14,cl:{rgb:"rgb(255,255,255)"}}}}},Oc={id:"detailContent1",zIndex:3,left:53,top:363,width:273,height:54,title:"detailContent1",description:"",type:hn.TEXT,richText:{rich:{id:"d",lists:Sc,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"Digital Immune System",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"Applied Observability",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},Dc={id:"detailContent2",zIndex:3,left:334,top:363,width:273,height:120,title:"detailContent2",description:"",type:hn.TEXT,richText:{rich:{id:"d",lists:Sc,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"combine SaaS, PaaS and IaaS with tailored",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"provides a curated set of tools, capabilities and processes that are packaged for easy consumption by developers and end users",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},Mc={id:"detailContent3",zIndex:3,left:652,top:363,width:273,height:130,title:"detailContent3",description:"",type:hn.TEXT,richText:{rich:{id:"d",lists:Sc,body:{blockElements:[{blockId:"oneParagraph",st:0,ed:59,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},paragraphStyle:{spaceBelow:15},elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"SuperApps are more than composite applications that aggregate services.",ts:{fs:12}}}]}},{blockId:"twoParagraph",st:0,ed:59,blockType:K.PARAGRAPH,paragraph:{bullet:{listId:"testBullet",nestingLevel:0,textStyle:{fs:20}},elements:[{eId:"oneElement",st:0,ed:15,et:st.TEXT_RUN,tr:{ct:"Adaptive AI allows for model behavior change post-deployment by using real-time feedback",ts:{fs:12}}}]}}]},documentStyle:{pageSize:{width:void 0,height:void 0},marginTop:2,marginBottom:2,marginRight:0,marginLeft:0}}}},xc={id:"strategic_1",pageType:an.SLIDE,zIndex:1,title:"cover",description:"this is third page, strategic",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:hn.TEXT,richText:{text:"Strategic technology trends",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:hn.TEXT,richText:{text:"We expect the 2023 trends to impact enterprise strategies in the coming three years by enabling organizations to address four key priorities:",fs:18,cl:{rgb:"rgb(127,127,127)"}}},chart1:{id:"chart1",zIndex:2,left:53,top:214,width:125,height:58,title:"chart1",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(105,126,146)"}}}},chartTitle1:{id:"chartTitle1",zIndex:3,left:53,top:186,width:84,height:28,title:"chartTitle1",description:"",type:hn.TEXT,richText:{text:"Optimize",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber1:{id:"chartNumber1",zIndex:3,left:63,top:230,width:61,height:36,title:"chartNumber1",description:"",type:hn.TEXT,richText:{text:"20%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart2:{id:"chart2",zIndex:2,left:178,top:214,width:428,height:58,title:"chart2",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(57,74,87)"}}}},chartTitle2:{id:"chartTitle2",zIndex:3,left:178,top:186,width:59,height:28,title:"chartTitle2",description:"",type:hn.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber2:{id:"chartNumber2",zIndex:3,left:188,top:230,width:61,height:36,title:"chartNumber2",description:"",type:hn.TEXT,richText:{text:"50%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},chart3:{id:"chart3",zIndex:2,left:605,top:214,width:302,height:58,title:"chart3",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},chartTitle3:{id:"chartTitle3",zIndex:3,left:605,top:186,width:74,height:28,title:"chartTitle3",description:"",type:hn.TEXT,richText:{text:"Scale",fs:16,cl:{rgb:"rgb(127,127,127)"}}},chartNumber3:{id:"chartNumber3",zIndex:3,left:615,top:230,width:61,height:36,title:"chartNumber3",description:"",type:hn.TEXT,richText:{text:"30%",fs:22,cl:{rgb:"rgb(255,255,255)"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:53,top:326,width:152,height:28,title:"detailTitle1",description:"",type:hn.TEXT,richText:{text:"Theme 1: Optimize",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:Oc,detailTitle2:{id:"detailTitle2",zIndex:3,left:334,top:326,width:129,height:28,title:"detailTitle2",description:"",type:hn.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent2:Dc,detailTitle3:{id:"detailTitle3",zIndex:3,left:652,top:326,width:143,height:28,title:"detailTitle3",description:"",type:hn.TEXT,richText:{text:"Theme 2: Scale",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent3:Mc}},Lc=wc.sheets[wc.sheetOrder[0]],kc=wc.styles,Pc={id:"business_1",pageType:an.SLIDE,zIndex:2,title:"business",description:"this is second page, business",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:hn.TEXT,richText:{text:"The Business Objectives",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:hn.TEXT,richText:{text:"What we hope to achieve in the short and long run",fs:18,cl:{rgb:"rgb(127,127,127)"}}},spreadSheet1:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:hn.SPREADSHEET,spreadsheet:{worksheet:Lc,styles:kc}}}},Hc={id:"technology_1",pageType:an.SLIDE,zIndex:2,title:"technology",description:"this is second page, technology",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:hn.TEXT,richText:{text:"Sustainable Technology",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:hn.TEXT,richText:{text:"Delivering technology alone will not be enough in 2023",fs:18,cl:{rgb:"rgb(127,127,127)"}}},picture1:{id:"picture1",zIndex:2,left:53,top:151,width:258,height:156,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P1.png"}}},picture2:{id:"picture2",zIndex:2,left:315,top:151,width:241,height:156,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P2.png"}}},picture3:{id:"picture3",zIndex:2,left:53,top:310,width:258,height:156,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P3.png"}}},picture4:{id:"picture4",zIndex:2,left:310,top:315,width:241,height:156,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/P4.jpg"}}},detailTitle1:{id:"detailTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"detailTitle1",description:"",type:hn.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},detailContent1:{id:"detailContent1",zIndex:3,left:580,top:167,width:373,height:81,title:"detailContent1",description:"",type:hn.TEXT,richText:{text:"Investments in sustainable technology also have the potential to create greater operational resiliency and financial performance, while providing new avenues for growth.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitle1:{id:"listTitle1",zIndex:3,left:580,top:138,width:75,height:28,title:"listTitle1",description:"",type:hn.TEXT,richText:{text:"In short:",fs:16,cl:{rgb:"rgb(244,79,86)"}}},listTitlePicture1:{id:"listTitlePicture1",zIndex:2,left:572,top:261,width:53,height:53,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon1.png"}}},listContent1:{id:"listContent1",zIndex:3,left:637,top:265,width:309,height:61,title:"listContent1",description:"",type:hn.TEXT,richText:{text:"Gartner’s Top 10 Strategic Technology Trends will help fulfill your business needs to optimize, scale or pioneer.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture2:{id:"listTitlePicture2",zIndex:2,left:572,top:341,width:53,height:53,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon2.png"}}},listContent2:{id:"listContent2",zIndex:3,left:637,top:345,width:309,height:61,title:"listContent2",description:"",type:hn.TEXT,richText:{text:"The trends allow you to align your technology innovation with the future strategic objectives of your enterprise.",fs:12,cl:{rgb:"rgb(127,127,127)"}}},listTitlePicture3:{id:"listTitlePicture3",zIndex:2,left:572,top:421,width:53,height:53,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/icon3.png"}}},listContent3:{id:"listContent3",zIndex:3,left:637,top:425,width:309,height:61,title:"listContent3",description:"",type:hn.TEXT,richText:{text:"Investments in sustainable technology provide operational and financial benefits, and can create growth opportunities.",fs:12,cl:{rgb:"rgb(127,127,127)"}}}}},Bc={id:"richText_1",pageType:an.SLIDE,zIndex:2,title:"business",description:"this is fix page, rich text",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(237,237,237,1)"},outline:{outlineFill:{rgb:"rgba(198,198,198,1)"},weight:1}}}},titleIcon1:{id:"titleIcon1",zIndex:2,left:48,top:52,width:35.1,height:4.8,title:"title Icon",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/title.png"}}},title1:{id:"title1",zIndex:2,left:44,top:56,width:454,height:50,title:"mask",description:"",type:hn.TEXT,richText:{text:"The Work-like Editor",fs:32,cl:{rgb:"rgb(244,79,86)"}}},subTitle1:{id:"subTitle1",zIndex:2,left:44,top:93,width:889,height:46,title:"subTitle",description:"",type:hn.TEXT,richText:{text:"Open source WYSIWYG editor built for the modern web",fs:18,cl:{rgb:"rgb(127,127,127)"}}},document:{id:"table1",zIndex:3,left:30,top:125,width:900,height:400,title:"table1",description:"",type:hn.DOCUMENT,document:Rc}}};function Fc(t=1,e){const n={id:"slide_unlimited",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{unlimited_1:{id:"unlimited_1",pageType:an.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:hn.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:hn.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:hn.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}}}},catalog_1:yc,strategic_1:xc,technology_1:Hc,richText_1:Bc,business_1:Pc},pageOrder:["unlimited_1","catalog_1","strategic_1","technology_1","richText_1","business_1"]}};return e&&(n.body.pages.unlimited_1.pageElements.slide={id:"slide",zIndex:3,left:960*(1-t)/2,top:540*(1-t)/2,width:960,height:540,scaleX:t,scaleY:t,title:"slide",description:"",type:hn.SLIDE,slide:e}),n}const Uc={id:"unlimited_1",pageType:an.SLIDE,zIndex:1,title:"unlimited",description:"this is seven page, unlimited",pageBackgroundFill:{rgb:"rgb(255,255,255)"},pageElements:{background1:{id:"background1",zIndex:0,left:0,top:0,width:960,height:540,title:"background",description:"",type:hn.IMAGE,image:{imageProperties:{contentUrl:"https://gcore.jsdelivr.net/gh/dream-num/static@main/univer/slide/Picture1.jpg"}}},mask1:{id:"mask1",zIndex:1,left:0,top:0,width:960,height:540,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgba(0,0,0,0.7)"}}}},text1:{id:"text1",zIndex:2,left:300,top:200,width:400,height:140,title:"mask",description:"",type:hn.TEXT,richText:{text:"Univer slide",fs:64,cl:{rgb:"rgb(244,79,86)"},bl:1}},centerRect1:{id:"centerRect1",zIndex:1,left:378,top:0,width:204,height:144,title:"mask",description:"",type:hn.SHAPE,shape:{shapeType:Ke.RECTANGLE,text:"",shapeProperties:{shapeBackgroundFill:{rgb:"rgb(244,79,86)"}}}},year1:{id:"year1",zIndex:2,left:430,top:42,width:100,height:40,title:"mask",description:"",type:hn.TEXT,richText:{text:"2022",fs:48,cl:{rgb:"rgb(255,255,255)"},bl:1}},content1:{id:"content1",zIndex:2,left:80,top:300,width:780,height:140,title:"mask",description:"",type:hn.TEXT,richText:{text:"The concepts national income and national product have roughly the same value and can be used interchangeably if our interest is in their sum total which is measured as the market value of the total output of goods and services of an economy in a given period, usually a year.",fs:14,cl:{rgb:"rgb(255,255,255)"},bl:1}},slide1:{id:"slide",zIndex:3,left:960*(1-.9)/2,top:540*(1-.9)/2,width:960,height:540,scaleX:.9,scaleY:.9,title:"slide",description:"",type:hn.SLIDE,slide:Fc(.9,Fc(.9,Fc(.9,Fc(.9,Fc(.9,Fc(.9,Fc(.9,Fc(.9,Fc(.9)))))))))}}},zc={id:"slide_test",title:"UniverSlide",pageSize:{width:960,height:540},body:{pages:{cover_1:Nc,catalog_1:yc,strategic_1:xc,technology_1:Hc,richText_1:Bc,business_1:Pc,unlimited_1:Uc},pageOrder:["cover_1","catalog_1","strategic_1","technology_1","richText_1","business_1","unlimited_1"]}};class Wc{constructor(){this._clipboardExtensionFactoryList=[]}get clipboardExtensionFactoryList(){return this._clipboardExtensionFactoryList}add(...t){this._clipboardExtensionFactoryList.push(...t),this._clipboardExtensionFactoryList.sort(ci)}delete(t){const e=this._clipboardExtensionFactoryList.indexOf(t);this._clipboardExtensionFactoryList.splice(e,1)}}const Vc=class{static async writeText(t,e){var n;if(Vc.clipboard)return Vc.clipboard.writeText(t).then((()=>!0),(t=>console.dir(t)));null==(n=null==e?void 0:e.clipboardData)||n.setData("text/html",t),null==e||e.preventDefault()}static async write(t,e){var n,i,s;if(Vc.clipboard){const e=new Blob([t.data],{type:null!=(n=t.type)?n:"text/html"}),i=[new ClipboardItem({"text/html":e})];Vc.clipboard.write(i)}null==(s=null==e?void 0:e.clipboardData)||s.setData(null!=(i=t.type)?i:"text/html",t.data),null==e||e.preventDefault(),Vc.localData=t.data}static async readText(){return Vc.clipboard?Vc.clipboard.readText().then((t=>t),(()=>null)):Vc.textArea?new Promise(((t,e)=>{t(Vc.textArea.value)})).then((t=>t)).then((()=>null)):null}static async read(t){var e;if(t){const e=[],n=null==t?void 0:t.clipboardData,i=null==n?void 0:n.types;if(!i)return null;for(let t=0;t<i.length;t++)e.push({type:i[t],result:n.getData(i[t])});return e}if(Vc.clipboard){const t=await Vc.clipboard.read(),e=[];for(const n of t)for(const t of n.types){const i=await n.getType(t),s=new FileReader;"image/png"===t?s.readAsDataURL(i):s.readAsText(i);const o=new Promise(((e,n)=>{s.onload=n=>{const i={type:t,result:s.result};e(i)}})).then((t=>t),(()=>null));e.push(o)}return Promise.all(e)}const n=null!=(e=Vc.localData)?e:null;return Vc.localData=null,n}};let Yc=Vc;Yc.clipboard=window.navigator.clipboard;class Gc{constructor(){this._register=new Wc}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.clipboardExtensionFactoryList;if(!n)return;this._clipboardExtensionFactoryList=n;const i=this._checkExtension(t);i&&i.execute()}pasteResolver(t){return new Promise(((e,n)=>{Yc.read(t).then((t=>{var n,i;if(!t)return[];const s=t.findIndex(((t,e)=>t&&"text/html"===t.type)),o=t.findIndex(((t,e)=>t&&"text/plain"===t.type)),r={};if(s>-1){const e=null==(n=t[s])?void 0:n.result;r.html=e}if(o>-1){const e=null==(i=t[o])?void 0:i.result;r.plain=e}e(r)}))}))}_checkExtension(t){if(!this._clipboardExtensionFactoryList)return!1;let e=!1;for(let n=0;n<this._clipboardExtensionFactoryList.length;n++){if(e=this._clipboardExtensionFactoryList[n].check(t),!1!==e)break}return e}}class Xc{constructor(){this._DragAndDropExtensionFactoryList=[]}get DragAndDropExtensionFactoryList(){return this._DragAndDropExtensionFactoryList}add(...t){this._DragAndDropExtensionFactoryList.push(...t),this._DragAndDropExtensionFactoryList.sort(ci)}delete(t){const e=this._DragAndDropExtensionFactoryList.indexOf(t);this._DragAndDropExtensionFactoryList.splice(e,1)}}class jc{constructor(){this._register=new Xc}getRegister(){return this._register}handle(t){var e;const n=null==(e=this._register)?void 0:e.DragAndDropExtensionFactoryList;n&&(this._DragAndDropExtensionFactoryList=n,this._checkExtension(t))}dragResolver(t){return new Promise(((e,n)=>{if(!t.dataTransfer)return;const i=[];t.dataTransfer.items?[...t.dataTransfer.items].forEach(((t,e)=>{if("file"===t.kind){const e=t.getAsFile();e&&i.push({kind:t.kind,type:t.type,file:e})}})):[...t.dataTransfer.files].forEach(((t,e)=>{t&&i.push({kind:"file",type:t.type,file:t})})),e(i)}))}_checkExtension(t){if(!this._DragAndDropExtensionFactoryList)return!1;this._DragAndDropExtensionFactoryList.forEach((e=>{const n=e.check(t);!1!==n&&n.execute()}))}}const Kc=_({});class $c{constructor(t){this._plugin=t,this._observerManager=this._plugin.getContext().getObserverManager(),this._installObserver()}handleDragAction(t){t.addEventListener("drop",(t=>{var e;t.preventDefault(),null==(e=this._observerManager.requiredObserver("onDropObservable","core"))||e.notifyObservers(t)})),t.addEventListener("dragover",(t=>{t.preventDefault()}))}_installObserver(){this._observerManager.addObserver("onDropObservable","core",new y)}}class Zc{constructor(t){this._plugin=t,this._observerManager=this._plugin.getGlobalContext().getObserverManager(),this._installObserver()}_installObserver(){this._observerManager.addObserver("onUIChangeObservable","core",new y),this._observerManager.addObserver("onUIDidMountObservable","core",new y),this._observerManager.addObserver("onAfterChangeUISkinObservable","core",new y),this._observerManager.addObserver("onAfterChangeUILocaleObservable","core",new y),this._observerManager.addObserver("onViewComponentFocusChange","core",new y),this._observerManager.addObserver("onAddSheet","core",new y),this._observerManager.addObserver("onDeleteSheet","core",new y),this._observerManager.addObserver("onHideSheet","core",new y),this._observerManager.addObserver("onUnHideSheet","core",new y),this._observerManager.addObserver("onToLeftSheet","core",new y),this._observerManager.addObserver("onToRightSheet","core",new y),this._observerManager.addObserver("onCopySheet","core",new y),this._observerManager.addObserver("onRemoveSheet","core",new y),this._observerManager.addObserver("onSheetColor","core",new y)}}class qc extends p{constructor(t){super(t),this.initialize(t)}getContext(){return this.context.context}getLocale(t){if(t)return this.getContext().getLocale().get(t)}initialize(t){}}qc.contextType=Kc;(class extends m{constructor(t){super(t),this.initialize(t)}getContext(){return this.context.context}getLocale(t){return this.getContext().getLocale().get(t)}initialize(t){}}).contextType=Kc;var Qc={};class Jc extends qc{constructor(){super(...arguments),this.canvasRef=f()}componentDidMount(){this.drawLine()}drawLine(){const t=this.canvasRef;this.props.drawLine(t)}setLineDash(t,e,n,i,s,o,r){try{"Hair"===e?t.setLineDash([1,2]):e.indexOf("DashDotDot")>-1?t.setLineDash([2,2,5,2,2]):e.indexOf("DashDot")>-1?t.setLineDash([2,5,2]):e.indexOf("Dotted")>-1?t.setLineDash([2]):e.indexOf("Dashed")>-1?t.setLineDash([3]):t.setLineDash([0])}catch(a){console.log(a)}t.beginPath(),e.indexOf("Medium")>-1?("h"===n?(t.moveTo(i,s-.5),t.lineTo(o,r-.5)):(t.moveTo(i-.5,s),t.lineTo(o-.5,r)),t.lineWidth=2):"Thick"===e?(t.moveTo(i,s),t.lineTo(o,r),t.lineWidth=3):(t.moveTo(i,s),t.lineTo(o,r),t.lineWidth=1)}render(){return T("canvas",{ref:this.canvasRef,className:Qc.canvas,width:this.props.width,height:this.props.height})}}class td extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Thin","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class ed extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Hair","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class nd extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Dotted","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class id extends p{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Dashed","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class sd extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"DashDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class od extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"DashDotDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class rd extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Medium","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class ad extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashed","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class ld extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class hd extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"MediumDashDotDot","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}class cd extends qc{constructor(){super(...arguments),this.ref=f()}drawLine(t){let e=t.current.getContext("2d");this.ref.current.setLineDash(e,"Thick","h",0,5,100,5),e.stroke(),e.closePath()}render(){const{width:t="100",height:e="10"}=this.props;return T(Jc,{ref:this.ref,width:t,height:e,drawLine:t=>this.drawLine(t)})}}const dd="object"==typeof HTMLElement?t=>t instanceof HTMLElement:t=>t&&"object"==typeof t&&1===t.nodeType&&"string"==typeof t.nodeName;function ud(...t){if(!t.length)return;let e="";return t.forEach((t=>{if(t instanceof Object)for(let n in t)t[n]&&(e+=` ${n}`);else e+=t?` ${t}`:""})),e}function gd(t,e){let n=null;return(...i)=>{clearTimeout(n),n=setTimeout((()=>{t(...i)}),e)}}function _d(t){if(dd(t.current))return t.current;let e=t.current;return e?null==e?void 0:e.base:t.base}function pd(t,e){for(let n in t)if(n.endsWith("Locale")&&"string"==typeof t[n]){const i=n.indexOf("Locale");t[n.slice(0,i)]=e(t[n])}return t}var md="univer-icon";const fd=t=>{const{spin:e,rotate:n,children:i,name:s,style:o,className:r}=t;let a;o?(a=o,a.transform=n?`rotate(${n}deg)`:""):a=n?{transform:`rotate(${n}deg)`}:{};const l=ud(md,{[`${md}-${s}`]:s,[`${md}-spin`]:e||"loading"===s},r);return T("span",{role:"img",className:l,style:h({},a)},i)},Td=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"loading",style:t.style},T("svg",{viewBox:"0 0 1024 1024",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M988 548c-19.9 0-36-16.1-36-36 0-59.4-11.6-117-34.6-171.3a440.45 440.45 0 0 0-94.3-139.9 437.71 437.71 0 0 0-139.9-94.3C629 83.6 571.4 72 512 72c-19.9 0-36-16.1-36-36s16.1-36 36-36c69.1 0 136.2 13.5 199.3 40.3C772.3 66 827 103 874 150c47 47 83.9 101.8 109.7 162.7 26.7 63.1 40.2 130.2 40.2 199.3.1 19.9-16 36-35.9 36z"}))),vd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M298.666667 213.333333h224a174.208 174.208 0 0 1 141.952 275.242667A174.208 174.208 0 0 1 572.458667 810.666667H298.666667V213.333333z m273.792 348.458667l-174.250667-0.042667v149.333334h174.250667a74.666667 74.666667 0 0 0 6.101333-149.077334l-6.101333-0.213333zM398.208 312.874667v149.333333h124.458667a74.666667 74.666667 0 0 0 6.144-149.077333l-6.144-0.256H398.208z","p-id":"5566"}))),Ed=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M469.333333 256h170.666667v42.666667h-170.666667z","p-id":"5693"}),T("path",{d:"M573.738667 284.586667l-81.493334 462.208-41.984-7.381334 81.493334-462.208z","p-id":"5694"}),T("path",{d:"M384 725.333333h170.666667v42.666667H384z","p-id":"5695"}))),bd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M298.666667 256h426.666666v42.666667H298.666667z","p-id":"5312"}),T("path",{d:"M533.290667 554.666667l0.042666 192h-42.666666l-0.042667-192h42.666667z m0.042666-277.333334l-0.042666 234.666667h-42.666667l0.042667-234.666667h42.666666zM320 256v85.333333h-42.666667V256zM746.666667 256v85.333333h-42.666667V256z","p-id":"5313"}),T("path",{d:"M256 469.333333h512v42.666667H256zM426.666667 725.333333h170.666666v42.666667h-170.666666z","p-id":"5314"}))),Id=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5318",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M362.666667 256v298.666667a149.333333 149.333333 0 0 0 298.453333 8.192L661.333333 554.666667V256h42.666667v298.666667a192 192 0 0 1-383.786667 9.045333L320 554.666667V256h42.666667z","p-id":"5319"}),T("path",{d:"M256 768m21.333333 0l469.333334 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-469.333334 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5320"}),T("path",{d:"M256 256m21.333333 0l128 0q21.333333 0 21.333334 21.333333l0 0q0 21.333333-21.333334 21.333334l-128 0q-21.333333 0-21.333333-21.333334l0 0q0-21.333333 21.333333-21.333333Z","p-id":"5321"}),T("path",{d:"M597.333333 256m21.333334 0l128 0q21.333333 0 21.333333 21.333333l0 0q0 21.333333-21.333333 21.333334l-128 0q-21.333333 0-21.333334-21.333334l0 0q0-21.333333 21.333334-21.333333Z","p-id":"5322"}))),Cd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5440",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M549.546667 256l194.133333 533.333333h-45.354667l-77.653333-213.333333H421.632l-77.653333 213.333333H298.666667L492.757333 256h56.789334z m-28.416 46.634667L437.162667 533.333333h167.978666l-84.010666-230.698666z","p-id":"5441"}))),Sd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5567",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M730.24 562.176l-253.44 253.44-217.173333-217.258667 253.44-253.44 217.173333 217.258667z m-72.405333-0.042667L512.981333 417.28l-180.992 180.992 144.810667 144.853333 181.034667-181.034666z","p-id":"5568"}),T("path",{d:"M520.533333 298.666667v230.4H469.333333V349.824H392.533333v179.626667H341.333333V298.666667zM699.733333 554.666667c48.768 0 88.32 37.802667 88.32 84.48 0 46.634667-39.552 84.48-88.32 84.48","p-id":"5569"}))),Ad=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5695",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667zM469.333333 810.666667V256h42.666667v554.666667z","p-id":"5696"}),T("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 512h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"5697"}))),wd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5823",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 256h554.666667v42.666667H213.333333z","p-id":"5824"}),T("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM384 512h42.666667v42.666667H384zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 512h42.666666v42.666667H298.666667z","p-id":"5825"}),T("path",{d:"M469.333333 512h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"5826"}))),Rd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5952",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M768 810.666667H213.333333v-42.666667h554.666667z","p-id":"5953"}),T("path",{d:"M768 640h-42.666667v-42.666667h42.666667zM768 469.333333h-42.666667v-42.666666h42.666667zM768 725.333333h-42.666667v-42.666666h42.666667zM768 554.666667h-42.666667v-42.666667h42.666667zM768 384h-42.666667V341.333333h42.666667z","p-id":"5954"}),T("path",{d:"M512 640h-42.666667v-42.666667h42.666667z","p-id":"5955"}),T("path",{d:"M256 640H213.333333v-42.666667h42.666667zM256 469.333333H213.333333v-42.666666h42.666667zM256 725.333333H213.333333v-42.666666h42.666667zM256 554.666667H213.333333v-42.666667h42.666667zM256 384H213.333333V341.333333h42.666667zM256 298.666667H213.333333V256h42.666667z","p-id":"5956"}),T("path",{d:"M512 469.333333h-42.666667v-42.666666h42.666667zM512 725.333333h-42.666667v-42.666666h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM512 384h-42.666667V341.333333h42.666667z","p-id":"5957"}),T("path",{d:"M768 298.666667h-42.666667V256h42.666667zM597.333333 298.666667h-42.666666V256h42.666666zM426.666667 298.666667H384V256h42.666667zM682.666667 298.666667h-42.666667V256h42.666667zM512 298.666667h-42.666667V256h42.666667zM341.333333 298.666667H298.666667V256h42.666666z","p-id":"5958"}),T("path",{d:"M597.333333 554.666667h-42.666666v-42.666667h42.666666zM426.666667 554.666667H384v-42.666667h42.666667zM682.666667 554.666667h-42.666667v-42.666667h42.666667zM512 554.666667h-42.666667v-42.666667h42.666667zM341.333333 554.666667H298.666667v-42.666667h42.666666z","p-id":"5959"}))),Nd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6085",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 810.666667V256h42.666667v554.666667z","p-id":"6086"}),T("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667z","p-id":"6087"}),T("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6088"}),T("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6089"}),T("path",{d:"M384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667z","p-id":"6090"}),T("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667z","p-id":"6091"}))),yd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6217",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M768 256v554.666667h-42.666667V256z","p-id":"6218"}),T("path",{d:"M597.333333 256v42.666667h-42.666666V256zM426.666667 256v42.666667H384V256zM682.666667 256v42.666667h-42.666667V256zM512 256v42.666667h-42.666667V256zM341.333333 256v42.666667H298.666667V256z","p-id":"6219"}),T("path",{d:"M597.333333 512v42.666667h-42.666666v-42.666667z","p-id":"6220"}),T("path",{d:"M597.333333 768v42.666667h-42.666666v-42.666667zM426.666667 768v42.666667H384v-42.666667zM682.666667 768v42.666667h-42.666667v-42.666667zM512 768v42.666667h-42.666667v-42.666667zM341.333333 768v42.666667H298.666667v-42.666667zM256 768v42.666667H213.333333v-42.666667z","p-id":"6221"}),T("path",{d:"M426.666667 512v42.666667H384v-42.666667zM682.666667 512v42.666667h-42.666667v-42.666667zM512 512v42.666667h-42.666667v-42.666667zM341.333333 512v42.666667H298.666667v-42.666667z","p-id":"6222"}),T("path",{d:"M256 256v42.666667H213.333333V256zM256 426.666667v42.666666H213.333333v-42.666666zM256 597.333333v42.666667H213.333333v-42.666667zM256 341.333333v42.666667H213.333333V341.333333zM256 512v42.666667H213.333333v-42.666667zM256 682.666667v42.666666H213.333333v-42.666666z","p-id":"6223"}),T("path",{d:"M512 426.666667v42.666666h-42.666667v-42.666666zM512 597.333333v42.666667h-42.666667v-42.666667zM512 341.333333v42.666667h-42.666667V341.333333zM512 512v42.666667h-42.666667v-42.666667zM512 682.666667v42.666666h-42.666667v-42.666666z","p-id":"6224"}))),Od=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6350",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M384 810.666667v-42.666667h42.666667v42.666667zM554.666667 810.666667v-42.666667h42.666666v42.666667zM298.666667 810.666667v-42.666667h42.666666v42.666667zM469.333333 810.666667v-42.666667h42.666667v42.666667zM640 810.666667v-42.666667h42.666667v42.666667zM384 554.666667v-42.666667h42.666667v42.666667zM384 298.666667V256h42.666667v42.666667zM554.666667 298.666667V256h42.666666v42.666667zM298.666667 298.666667V256h42.666666v42.666667zM469.333333 298.666667V256h42.666667v42.666667zM640 298.666667V256h42.666667v42.666667zM725.333333 298.666667V256h42.666667v42.666667zM213.333333 298.666667V256h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667z","p-id":"6351"}),T("path",{d:"M725.333333 810.666667v-42.666667h42.666667v42.666667zM213.333333 810.666667v-42.666667h42.666667v42.666667zM725.333333 640v-42.666667h42.666667v42.666667zM213.333333 640v-42.666667h42.666667v42.666667zM725.333333 469.333333v-42.666666h42.666667v42.666666zM213.333333 469.333333v-42.666666h42.666667v42.666666zM725.333333 725.333333v-42.666666h42.666667v42.666666zM213.333333 725.333333v-42.666666h42.666667v42.666666zM725.333333 554.666667v-42.666667h42.666667v42.666667zM213.333333 554.666667v-42.666667h42.666667v42.666667zM725.333333 384V341.333333h42.666667v42.666667zM213.333333 384V341.333333h42.666667v42.666667z","p-id":"6352"}),T("path",{d:"M469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666zM469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6353"}))),Dd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6479",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 810.666667V256h42.666667v554.666667zM725.333333 810.666667V256h42.666667v554.666667z","p-id":"6480"}),T("path",{d:"M213.333333 256h554.666667v42.666667H213.333333zM213.333333 768h554.666667v42.666667H213.333333z","p-id":"6481"}),T("path",{d:"M384 554.666667v-42.666667h42.666667v42.666667zM554.666667 554.666667v-42.666667h42.666666v42.666667zM298.666667 554.666667v-42.666667h42.666666v42.666667zM469.333333 554.666667v-42.666667h42.666667v42.666667zM640 554.666667v-42.666667h42.666667v42.666667zM469.333333 640v-42.666667h42.666667v42.666667zM469.333333 469.333333v-42.666666h42.666667v42.666666zM469.333333 725.333333v-42.666666h42.666667v42.666666z","p-id":"6482"}),T("path",{d:"M469.333333 554.666667v-42.666667h42.666667v42.666667zM469.333333 384V341.333333h42.666667v42.666667z","p-id":"6483"}))),Md=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6609",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6610"}),T("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6611"}),T("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6612"}))),xd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6866",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 512h554.666667v42.666667H213.333333z","p-id":"6867"}),T("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM469.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM469.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM469.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM469.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667z","p-id":"6868"}))),Ld=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"6994",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 426.666667h42.666667v42.666666H213.333333zM213.333333 597.333333h42.666667v42.666667H213.333333zM213.333333 341.333333h42.666667v42.666667H213.333333zM213.333333 682.666667h42.666667v42.666666H213.333333zM725.333333 426.666667h42.666667v42.666666h-42.666667zM725.333333 597.333333h42.666667v42.666667h-42.666667zM725.333333 341.333333h42.666667v42.666667h-42.666667zM725.333333 682.666667h42.666667v42.666666h-42.666667zM725.333333 768h42.666667v42.666667h-42.666667zM725.333333 256h42.666667v42.666667h-42.666667zM725.333333 512h42.666667v42.666667h-42.666667zM213.333333 768h42.666667v42.666667H213.333333zM213.333333 256h42.666667v42.666667H213.333333zM213.333333 512h42.666667v42.666667H213.333333zM384 768h42.666667v42.666667H384zM384 256h42.666667v42.666667H384zM384 512h42.666667v42.666667H384zM554.666667 768h42.666666v42.666667h-42.666666zM554.666667 256h42.666666v42.666667h-42.666666zM554.666667 512h42.666666v42.666667h-42.666666zM298.666667 768h42.666666v42.666667H298.666667zM298.666667 256h42.666666v42.666667H298.666667zM298.666667 512h42.666666v42.666667H298.666667zM469.333333 768h42.666667v42.666667h-42.666667zM469.333333 256h42.666667v42.666667h-42.666667zM469.333333 512h42.666667v42.666667h-42.666667zM640 768h42.666667v42.666667h-42.666667zM640 256h42.666667v42.666667h-42.666667zM640 512h42.666667v42.666667h-42.666667z","p-id":"6995"}),T("path",{d:"M512 256v554.666667h-42.666667V256z","p-id":"6996"}))),kd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7122",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M810.666667 213.333333v597.333334H213.333333V213.333333h597.333334z m-42.666667 42.666667H256v512h512V256z","p-id":"7123"}),T("path",{d:"M389.162667 426.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.802667-37.845333-119.466667 0.042666v-42.666666l121.856-0.042667-40.192-40.192 30.165334-30.165333zM645.162667 426.666667L554.666667 517.162667l90.496 90.538666 30.165333-30.165333-37.76-37.845333 119.466667 0.042666v-42.666666l-121.856-0.042667 40.149333-40.192-30.165333-30.165333z","p-id":"7124"}))),Pd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7250",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m0 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m0 128h341.333333a21.333333 21.333333 0 0 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7251"}))),Hd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7377",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666zM341.333333 426.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-106.666666 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666zM341.333333 682.666667h341.333334a21.333333 21.333333 0 1 1 0 42.666666H341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7378"}))),Bd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7504",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M234.666667 298.666667h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 1 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z m-213.333333 128h554.666666a21.333333 21.333333 0 1 1 0 42.666666h-554.666666a21.333333 21.333333 0 0 1 0-42.666666z m213.333333 128h341.333333a21.333333 21.333333 0 1 1 0 42.666666h-341.333333a21.333333 21.333333 0 0 1 0-42.666666z","p-id":"7505"}))),Fd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7631",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M298.666667 384h426.666666v42.666667H298.666667zM416 527.829333l90.496-90.496 90.538667 90.496-30.165334 30.165334-37.802666-37.717334v290.090667h-42.666667v-292.565333l-40.234667 40.192-30.165333-30.165334z","p-id":"7632"}))),Ud=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7758",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M725.333333 533.333333H298.666667v-42.666666h426.666666zM426.666667 634.496l90.496-90.496 90.538666 90.496-30.165333 30.165333-39.936-39.850666v121.557333h-42.666667v-119.765333l-38.101333 38.058666-30.165333-30.165333zM426.666667 389.162667l90.496 90.538666 90.538666-90.538666-30.165333-30.165334-39.936 39.893334V277.333333h-42.666667v119.765334l-38.101333-38.101334-30.165333 30.165334z","p-id":"7759"}))),zd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"7885",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M725.333333 725.333333H298.666667v-42.666666h426.666666zM608 581.504l-90.496 90.496-90.538667-90.496 30.165334-30.165333 37.802666 37.717333V298.965333h42.666667v292.565334l40.234667-40.192 30.165333 30.165333z","p-id":"7886"}))),Wd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8217",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M549.546667 213.333333l77.653333 213.333334h0.64l-0.042667 1.621333 53.76 147.712h-45.354666l-38.826667-106.666667h-152.405333l-38.826667 106.666667H360.789333l53.674667-147.498667 0.042667-1.834666h0.64l77.610666-213.333334h56.789334z m-28.416 46.634667L460.458667 426.666667h121.386666l-60.714666-166.698667zM709.162667 618.666667l90.538666 90.496-90.538666 90.538666-30.165334-30.165333 37.76-37.802667H256v-42.666666h463.232l-40.234667-40.234667 30.165334-30.165333z","p-id":"8218"}))),Vd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4524",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M290.944 289.365333l205.738667 95.914667 0.469333-0.426667 1.109333 1.152 142.506667 66.432-32.128 32.085334-102.826667-47.957334-107.818666 107.733334 48 102.912-32.085334 32.042666-66.346666-142.250666-1.28-1.28 0.469333-0.512-96-205.696 40.192-40.149334z m12.885333 53.034667l74.965334 160.810667 85.845333-85.845334L303.786667 342.4zM690.432 463.104h128v128h-42.666667v-53.418667l-325.845333 325.802667-30.165333-30.165333 327.552-327.552h-56.874667v-42.666667z",fill:"#444D5A","p-id":"4525"}))),Yd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4659",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M755.968 312.277333l-95.914667 205.738667 0.426667 0.469333-1.152 1.109334-66.432 142.506666-32.085333-32.128 47.957333-102.826666-107.733333-107.818667-102.912 48-32.042667-32.085333 142.250667-66.346667 1.28-1.28 0.512 0.469333 205.696-96 40.149333 40.192z m-53.034667 12.885334l-160.810666 74.965333 85.845333 85.845333 74.965333-160.810666zM582.229333 711.765333v128h-128v-42.666666h53.418667l-325.802667-325.845334 30.165334-30.165333 327.552 327.552v-56.874667h42.666666z",fill:"#444D5A","p-id":"4660"}))),Gd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4794",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M636.757333 298.666667l77.653334 213.333333h0.64l-0.042667 1.621333 53.76 147.712h-45.354667l-38.826666-106.666666h-152.405334l-38.826666 106.666666H448l53.674667-147.498666 0.042666-1.834667h0.64l77.610667-213.333333h56.789333z m-28.416 46.634666L547.669333 512h121.386667l-60.714667-166.698667zM394.368 698.496L303.786667 789.034667 213.333333 698.453333l30.165334-30.165333 37.802666 37.76V245.333333h42.666667v463.232l40.234667-40.234666 30.165333 30.165333z",fill:"#444D5A","p-id":"4795"}))),Xd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"4929",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M192 495.786667l213.333333-77.653334v-0.64l1.621334 0.042667L554.666667 363.776v45.354667l-106.666667 38.826666v152.405334l106.666667 38.826666v45.354667l-147.498667-53.674667-1.834667-0.042666v-0.64l-213.333333-77.610667V495.786667z m46.634667 28.416L405.333333 584.874667v-121.386667l-166.698666 60.714667zM597.333333 336.170667l90.496-90.538667 90.538667 90.538667-30.165333 30.165333-37.802667-37.76V789.333333h-42.666667V326.101333l-40.234666 40.234667L597.333333 336.170667z",fill:"#444D5A","p-id":"4930"}))),jd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5199",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M789.333333 528.213333l-213.333333 77.653334v0.64l-1.621333-0.042667L426.666667 660.224v-45.354667l106.666666-38.826666V423.637333l-106.666666-38.826666V339.456l147.498666 53.674667 1.834667 0.042666v0.64l213.333333 77.610667v56.789333z m-46.634666-28.416L576 439.125333v121.386667l166.698667-60.714667zM384 687.829333l-90.496 90.538667-90.538667-90.538667 30.165334-30.165333 37.802666 37.76V234.666667h42.666667v463.232l40.234667-40.234667 30.165333 30.165333z",fill:"#444D5A","p-id":"5200"}))),Kd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8736",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M213.333333 213.333333h85.12v597.333334H213.333333V213.333333z m225.450667 477.44l25.557333-21.333333-72.362666-63.786667 72.362666-63.872-25.557333-21.248-93.610667 80.853334h4.266667-4.266667l93.610667 89.386666z","p-id":"8737"}),T("path",{d:"M768 213.333333h42.581333v597.333334H768z","p-id":"8738"}),T("path",{d:"M540.928 367.274667H391.978667v42.581333h148.949333c59.605333 0 106.410667 38.314667 106.410667 85.12s-46.805333 85.12-106.410667 85.12H391.978667v42.581333h148.949333c85.12 0 157.482667-55.338667 157.482667-127.701333s-72.362667-127.701333-157.44-127.701333z","p-id":"8739"}))),$d=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8608",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M300.288 810.666667H213.333333V213.333333h86.954667v279.978667h441.898667l-91.306667-85.845333 26.624-26.112L810.666667 512l-133.162667 130.688-26.624-26.154667 91.306667-85.845333-441.898667-0.042667z","p-id":"8609"}),T("path",{d:"M530.688 213.333333h42.666667v242.688h-42.666667V213.333333z m0 354.688h42.666667V810.666667h-42.666667v-242.688z","p-id":"8610"}))),Zd=t=>T(fd,{spin:t.spin,rotate:t.rotate,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"8865",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M767.829333 213.333333h42.496v597.333334h-42.496z","p-id":"8866"}),T("path",{d:"M767.146667 553.216h-384v-42.496h384v42.496zM213.333333 213.333333h84.992v597.333334H213.333333V213.333333z","p-id":"8867"}))),qd=t=>T(fd,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5692",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M737.664 419.328H426.666667v42.666667h311.296l-84.48 84.437333a21.333333 21.333333 0 0 0 30.208 30.165333l120.746666-120.704a21.290667 21.290667 0 0 0 0-30.165333l-120.746666-120.661333a21.333333 21.333333 0 0 0-30.165334 30.165333l84.138667 84.096zM213.333333 632.661333a213.333333 213.333333 0 0 1 213.333334-213.333333v42.666667a170.666667 170.666667 0 0 0-170.666667 170.666666H213.333333z m0 0h42.666667v64a21.333333 21.333333 0 0 1-42.666667 0v-64z","p-id":"5693"}))),Qd=t=>T(fd,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5565",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M287.018667 419.328h310.997333v42.666667H286.72l84.48 84.437333a21.333333 21.333333 0 1 1-30.208 30.165333l-120.746667-120.704a21.248 21.248 0 0 1 0-30.165333l120.746667-120.661333a21.333333 21.333333 0 0 1 30.165333 30.165333L287.018667 419.328z m524.330666 213.333333a213.333333 213.333333 0 0 0-213.333333-213.333333v42.666667a170.666667 170.666667 0 0 1 170.666667 170.666666h42.666666z m0 0h-42.666666v64a21.333333 21.333333 0 1 0 42.666666 0v-64z","p-id":"5566"}))),Jd=t=>T(fd,{spin:t.spin,rotate:t.rotate,className:t.className,name:"nextIcon",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M512 682.666667L170.666667 341.333333h682.666666z","p-id":"5312"}))),tu=t=>T(fd,{spin:t.spin,rotate:t.rotate,className:t.className,name:"rightIcon",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M682.666667 512l-341.333334 341.333333V170.666667z","p-id":"5312"}))),eu=t=>T(fd,{spin:t.spin,rotate:t.rotate,className:t.className,name:"foward",style:t.style},T("svg",{class:"icon",viewBox:"0 0 1024 1024",version:"1.1",xmlns:"http://www.w3.org/2000/svg","p-id":"5311",width:"1em",height:"1em",fill:"currentColor"},T("path",{d:"M268.032 523.434667l60.373333-60.330667 211.2 211.2-60.373333 60.330667z","p-id":"5312"}),T("path",{d:"M780.928 312.234667l60.373333 60.330666-331.904 331.861334-60.330666-60.330667z","p-id":"5313"})));var nu,iu,su,ou,ru,au,lu,hu=Jd;class cu{constructor(){this._componentList=new Map;const t={ForwardIcon:Qd,BackIcon:qd,BoldIcon:vd,ItalicIcon:Ed,DeleteLineIcon:bd,UnderLineIcon:Id,TextColorIcon:Cd,FillColorIcon:Sd,MergeIcon:kd,TopBorderIcon:wd,BottomBorderIcon:Rd,LeftBorderIcon:Nd,RightBorderIcon:yd,NoneBorderIcon:Od,FullBorderIcon:Ad,OuterBorderIcon:Dd,InnerBorderIcon:Md,StripingBorderIcon:xd,VerticalBorderIcon:Ld,LeftAlignIcon:Pd,CenterAlignIcon:Hd,RightAlignIcon:Bd,TopVerticalIcon:Fd,CenterVerticalIcon:Ud,BottomVerticalIcon:zd,OverflowIcon:$d,BrIcon:Kd,CutIcon:Zd,TextRotateIcon:Wd,TextRotateAngleUpIcon:Vd,TextRotateAngleDownIcon:Yd,TextRotateVerticalIcon:Gd,TextRotateRotationUpIcon:Xd,TextRotateRotationDownIcon:jd,BorderThin:td,BorderHair:ed,BorderDotted:nd,BorderDashed:id,BorderDashDot:sd,BorderDashDotDot:od,BorderMedium:rd,BorderMediumDashed:ad,BorderMediumDashDot:ld,BorderMediumDashDotDot:hd,BorderThick:cd};for(let e in t)this.register(e,t[e])}register(t,e){this._componentList.set(t,e)}get(t){return this._componentList.get(t)}delete(t){this._componentList.delete(t)}}class du{constructor(t){this._plugin=t,this.initialize()}initialize(){this.setClipboardExtensionManager(),this.setDragAndDropExtensionManager()}setClipboardExtensionManager(){this._clipboardExtensionManager=new Gc;const t=this._plugin.getGlobalContext().getObserverManager().getObserver("onKeyPasteObservable","core");t&&!t.hasObservers()&&t.add((t=>{this._clipboardExtensionManager.pasteResolver(t).then((t=>{this._clipboardExtensionManager.handle(t)}))}))}setDragAndDropExtensionManager(){this._dragAndDropExtensionManager=new jc;const t=this._plugin.getGlobalContext().getObserverManager().getObserver("onDropObservable","core");t&&!t.hasObservers()&&t.add((t=>{this._dragAndDropExtensionManager.dragResolver(t).then((t=>{0!==t.length&&this._dragAndDropExtensionManager.handle(t)}))}))}getClipboardExtensionManager(){return this._clipboardExtensionManager}getDragAndDropExtensionManager(){return this._dragAndDropExtensionManager}onMounted(){this.initialize()}onDestroy(){}}(iu=nu||(nu={}))[iu.Button=0]="Button",iu[iu.SingleButton=1]="SingleButton",iu[iu.Select=2]="Select",iu[iu.Container=3]="Container",iu[iu.CellRangeModal=4]="CellRangeModal",iu[iu.Modal=5]="Modal",iu[iu.SiderModal=6]="SiderModal",iu[iu.Layout=7]="Layout",iu[iu.Header=8]="Header",iu[iu.Footer=9]="Footer",iu[iu.Content=10]="Content",iu[iu.Sider=11]="Sider",iu[iu.Demo=12]="Demo",iu[iu.Checkbox=13]="Checkbox",iu[iu.CheckboxGroup=14]="CheckboxGroup",iu[iu.ColorPicker=15]="ColorPicker",iu[iu.ColorPickerCircleButton=16]="ColorPickerCircleButton",iu[iu.Input=17]="Input",iu[iu.Radio=18]="Radio",iu[iu.RadioGroup=19]="RadioGroup",iu[iu.Tab=20]="Tab",iu[iu.TabPane=21]="TabPane",iu[iu.Avatar=22]="Avatar",iu[iu.Tooltip=23]="Tooltip",iu[iu.Ul=24]="Ul",iu[iu.Collapse=25]="Collapse",iu[iu.Panel=26]="Panel",iu[iu.FormatModal=27]="FormatModal",iu[iu.RichText=28]="RichText",iu[iu.NextIcon=29]="NextIcon",iu[iu.RightIcon=30]="RightIcon",iu[iu.OrderIcon=31]="OrderIcon",iu[iu.CommentIcon=32]="CommentIcon",iu[iu.ConditionalFormatIcon=33]="ConditionalFormatIcon",iu[iu.ScreenshotIcon=34]="ScreenshotIcon",iu[iu.CheckIcon=35]="CheckIcon",iu[iu.SearchIcon=36]="SearchIcon",iu[iu.ReplaceIcon=37]="ReplaceIcon",iu[iu.FreezeIcon=38]="FreezeIcon",iu[iu.PivotableIcon=39]="PivotableIcon",iu[iu.FillColorIcon=40]="FillColorIcon",iu[iu.BoldIcon=41]="BoldIcon",iu[iu.FullBorderIcon=42]="FullBorderIcon",iu[iu.TopBorderIcon=43]="TopBorderIcon",iu[iu.BottomBorderIcon=44]="BottomBorderIcon",iu[iu.LeftBorderIcon=45]="LeftBorderIcon",iu[iu.RightBorderIcon=46]="RightBorderIcon",iu[iu.NoneBorderIcon=47]="NoneBorderIcon",iu[iu.OuterBorderIcon=48]="OuterBorderIcon",iu[iu.InnerBorderIcon=49]="InnerBorderIcon",iu[iu.StripingBorderIcon=50]="StripingBorderIcon",iu[iu.VerticalBorderIcon=51]="VerticalBorderIcon",iu[iu.MergeIcon=52]="MergeIcon",iu[iu.SumIcon=53]="SumIcon",iu[iu.OrderDESCIcon=54]="OrderDESCIcon",iu[iu.OrderASCIcon=55]="OrderASCIcon",iu[iu.FilterIcon=56]="FilterIcon",iu[iu.FilterRankIcon=57]="FilterRankIcon",iu[iu.CleanIcon=58]="CleanIcon",iu[iu.DeleteIcon=59]="DeleteIcon",iu[iu.DeleteLineIcon=60]="DeleteLineIcon",iu[iu.UnderLineIcon=61]="UnderLineIcon",iu[iu.ItalicIcon=62]="ItalicIcon",iu[iu.TextColorIcon=63]="TextColorIcon",iu[iu.BackIcon=64]="BackIcon",iu[iu.ForwardIcon=65]="ForwardIcon",iu[iu.FormatIcon=66]="FormatIcon",iu[iu.CorrectIcon=67]="CorrectIcon",iu[iu.LtIcon=68]="LtIcon",iu[iu.CloseIcon=69]="CloseIcon",iu[iu.DropDownIcon=70]="DropDownIcon",iu[iu.MenuIcon=71]="MenuIcon",iu[iu.HideIcon=72]="HideIcon",iu[iu.PhotoIcon=73]="PhotoIcon",iu[iu.LinkIcon=74]="LinkIcon",iu[iu.ChartIcon=75]="ChartIcon",iu[iu.LoadingIcon=76]="LoadingIcon",iu[iu.LogoIcon=77]="LogoIcon",iu[iu.AddNumIcon=78]="AddNumIcon",iu[iu.ReduceNumIcon=79]="ReduceNumIcon",iu[iu.PercentIcon=80]="PercentIcon",iu[iu.MoneyIcon=81]="MoneyIcon",iu[iu.FxIcon=82]="FxIcon",iu[iu.AddIcon=83]="AddIcon",iu[iu.ReduceIcon=84]="ReduceIcon",iu[iu.DivideIcon=85]="DivideIcon",iu[iu.LockIcon=86]="LockIcon",iu[iu.LocationIcon=87]="LocationIcon",iu[iu.PageIcon=88]="PageIcon",iu[iu.RegularIcon=89]="RegularIcon",iu[iu.LayoutIcon=90]="LayoutIcon",iu[iu.TableIcon=91]="TableIcon",iu[iu.ImageIcon=92]="ImageIcon",iu[iu.LeftAlignIcon=93]="LeftAlignIcon",iu[iu.CenterAlignIcon=94]="CenterAlignIcon",iu[iu.RightAlignIcon=95]="RightAlignIcon",iu[iu.TopVerticalIcon=96]="TopVerticalIcon",iu[iu.CenterVerticalIcon=97]="CenterVerticalIcon",iu[iu.BottomVerticalIcon=98]="BottomVerticalIcon",iu[iu.TextRotateIcon=99]="TextRotateIcon",iu[iu.TextRotateAngleUpIcon=100]="TextRotateAngleUpIcon",iu[iu.TextRotateAngleDownIcon=101]="TextRotateAngleDownIcon",iu[iu.TextRotateVerticalIcon=102]="TextRotateVerticalIcon",iu[iu.TextRotateRotationUpIcon=103]="TextRotateRotationUpIcon",iu[iu.TextRotateRotationDownIcon=104]="TextRotateRotationDownIcon",iu[iu.BrIcon=105]="BrIcon",iu[iu.OverflowIcon=106]="OverflowIcon",iu[iu.CutIcon=107]="CutIcon",iu[iu.PrintIcon=108]="PrintIcon",iu[iu.PrintAreaIcon=109]="PrintAreaIcon",iu[iu.PrintTitleIcon=110]="PrintTitleIcon",iu[iu.BorderDashDot=111]="BorderDashDot",iu[iu.BorderDashDotDot=112]="BorderDashDotDot",iu[iu.BorderDashed=113]="BorderDashed",iu[iu.BorderDotted=114]="BorderDotted",iu[iu.BorderHair=115]="BorderHair",iu[iu.BorderMedium=116]="BorderMedium",iu[iu.BorderMediumDashDot=117]="BorderMediumDashDot",iu[iu.BorderMediumDashDotDot=118]="BorderMediumDashDotDot",iu[iu.BorderMediumDashed=119]="BorderMediumDashed",iu[iu.BorderThick=120]="BorderThick",iu[iu.BorderThin=121]="BorderThin",(ou=su||(su={})).BUTTON="Button",ou.CONTAINER="Container",ou.CELL_RANGE_MODAL="CellRangeModal",ou.LAYOUT="Layout",ou.HEADER="Header",ou.FOOTER="Footer",ou.CONTENT="Content",ou.SIDER="Sider",ou.DEMO="Demo",ou.SHEET_CONTAINER="SheetContainer",(au=ru||(ru={})).INPUT="input",au.COLOR="color",au.DOUBLE="double",au.JSX="jsx",au.INPUT_NUMBER="inputNumber",function(t){t.EN="en",t.ZH="zh"}(lu||(lu={}));var uu="univer-btn";class gu extends qc{constructor(t){var e;super(),this.handleClick=t=>{const{disabled:e,onClick:n,unActive:i=!0}=this.props;e?t.preventDefault():i?null==n||n(t):this.setState({isActive:!this.state.isActive},(()=>{n&&n.call(null,t,this.state.isActive)}))},this.state={isActive:null!=(e=t.active)&&e}}getSizeCls(){const{size:t}=this.props;let e="";switch(t){case"large":e="lg";break;case"small":e="sm"}return e}getClass(){const{isActive:t}=this.state,{type:e,shape:n,danger:i,block:s,loading:o,size:r,className:a}=this.props;return ud(uu,{[`${uu}-${e}`]:e,[`${uu}-${n}`]:n,[`${uu}-${this.getSizeCls()}`]:r,[`${uu}-danger`]:!!i,[`${uu}-block`]:s,[`${uu}-loading`]:o,[`${uu}-active`]:t},a)}componentWillReceiveProps(t){this.setState({isActive:t.active})}render(){const{htmlType:t,disabled:e,style:n,loading:i,children:s}=this.props;return T("button",{type:t,onClick:this.handleClick,className:this.getClass(),disabled:e,style:n},i?T(Td,null):"",s)}}var _u="univer-input";class pu extends qc{constructor(){super(...arguments),this.ref=f(),this.setValue=(t,e)=>{this.setState((e=>({value:t})),e)},this.handleChange=t=>{const{onChange:e}=this.props;if(!e)return;const n=t.target;this.setValue(n.value),e(t)},this.handlePressEnter=t=>{const{onPressEnter:e}=this.props;"Enter"===t.key&&(null==e||e(t),this.ref.current.blur())},this.onFocus=t=>{const{onFocus:e}=this.props;null==e||e(t)},this.onClick=t=>{const{onClick:e}=this.props;null==e||e(t)},this.onBlur=t=>{const{onBlur:e}=this.props;null==e||e(t)},this.getValue=()=>this.ref.current.value}initialize(t){this.state={value:t.value,focused:!1}}componentWillMount(){this.props.value&&this.setValue(this.props.value)}componentWillReceiveProps(t){t.value&&t.value!==this.state.value&&this.setValue(t.value)}render(t,e){const{id:n,disabled:i,type:s,placeholder:o,bordered:r=!0,className:a="",readonly:l}=t,{value:h}=e,c=ud(_u,{[`${_u}-disable`]:i,[`${_u}-borderless`]:!r},a);return T("input",{type:s,onBlur:this.onBlur,onFocus:this.onFocus,className:c,placeholder:o,disabled:i,ref:this.ref,onChange:this.handleChange,value:h,onClick:this.onClick,readonly:l,id:n,onKeyUp:this.handlePressEnter})}}const mu=t=>{let e,{color:n}=t;if(!n)return null;if(n.indexOf("#")>-1){if(n=_n.hexToRgbString(n),!n)return null;e=n.replace("rgba(","").replace(")","").split(",")}else n.indexOf("rgba")>-1?e=n.replace("rgba(","").replace(")","").split(","):(e=n.replace("rgb(","").replace(")","").split(","),e.push("1"));let i=v(null);return T(pu,{ref:i,type:"text",value:`rgba(${e})`,onChange:()=>{t.onChange(i.current.base.value)}})};var fu={colorPickerPanel:"univer-color-picker-panel",colorPickerPanelSetting:"univer-color-picker-panel-setting",panelInput:"univer-panel-input",panelColor:"univer-panel-color"};class Tu extends qc{initialize(t){this.state={color:t.color||"#000"}}setColor(t){this.setState({color:t}),this.props.onChange(t)}render(){return T("div",{className:fu.colorPickerPanel,onClick:t=>t.stopPropagation()},T(b,{className:fu.colorPicker,color:this.state.color,onChange:gd(this.setColor.bind(this),500)}),T("div",{className:fu.colorPickerPanelSetting},T("div",{className:fu.panelInput},this.props.rgb?T(mu,{color:this.state.color,onChange:gd(this.setColor.bind(this),500)}):T(E,{color:this.state.color,onChange:gd(this.setColor.bind(this),500)})),T("div",{className:fu.panelColor},T("div",{style:{background:this.state.color}}),T("div",{style:{background:this.props.color}}))))}}var vu="univer-color-picker-outer",Eu="univer-color-picker",bu="univer-picker",Iu="univer-picker-swatches",Cu="univer-picker-swatches-item",Su="univer-picker-swatch",Au="univer-picker-swatch-btn",wu="univer-colorful-warp";let Ru=[["#000","#444","#666","#999","#ccc","#eee","#f3f3f3","#fff"],["#f00","#f90","#ff0","#0f0","#0ff","#00f","#90f","#f0f"],["#f4cccc","#fce5cd","#fff2cc","#d9ead3","#d0e0e3","#cfe2f3","#d9d2e9","#ead1dc"],["#ea9999","#f9cb9c","#ffe599","#b6d7a8","#a2c4c9","#9fc5e8","#b4a7d6","#d5a6bd"],["#e06666","#f6b26b","#ffd966","#93c47d","#76a5af","#6fa8dc","#8e7cc3","#c27ba0"],["#c00","#e69138","#f1c232","#6aa84f","#45818e","#3d85c6","#674ea7","#a64d79"],["#900","#b45f06","#bf9000","#38761d","#134f5c","#0b5394","#351c75","#741b47"],["#600","#783f04","#7f6000","#274e13","#0c343d","#073763","#20124d","#4c1130"]];class Nu extends qc{constructor(){super(...arguments),this.ulRef=f(),this.onChange=t=>{this.props.onChange&&this.props.onChange(t),this.setState({afterColor:t})},this.onClick=(t,e)=>{this.props.onClick&&this.props.onClick(t,e)},this.onCancel=()=>{this.props.onCancel&&this.props.onCancel()},this.hideSelect=t=>{t&&this.ulRef.current.contains(t.target)||(this.setState((t=>({styles:{display:"none"}}))),document.removeEventListener("click",this.hideSelect,!0))},this.showSelect=t=>{this.setState((t=>({styles:{display:"block"}}))),document.addEventListener("click",this.hideSelect,!0)},this.getOffset=(t,e)=>{const n=t.getBoundingClientRect(),i=this.ulRef.current.getBoundingClientRect(),s=document.documentElement.clientWidth||document.body.clientWidth,o=document.documentElement.clientHeight||document.body.clientHeight;let r=0,a=0;return a=n.top+i.height>o?n.top-i.height:n.top+n.height,r=n.left+i.width>s?s-i.width:n.left,{left:r,top:a}},this.onSwitch=t=>{t.stopImmediatePropagation(),new Promise(((t,e)=>{this.setState({setting:!this.state.setting}),t("end")})).then((()=>{if(this.state.root){const{top:t,left:e}=this.getOffset(this.state.root,this.ulRef.current);this.ulRef.current.style.left=`${e}px`,this.ulRef.current.style.top=`${t}px`}}))}}initialize(t){this.state={presetColors:Ru,defaultColor:t.color||"#000",afterColor:t.color||"#000",rgb:!0,setting:!1,styles:{},currentLocale:"",root:null}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}render(){const t=Object.assign(this.state.styles||{},this.props.style);return T("div",{className:`${vu} ${this.props.className}`,ref:this.ulRef,style:h({},t)},T("div",{className:Eu,onClick:t=>{}},T("div",{className:bu},T("div",{className:Iu},this.state.presetColors.map((t=>T("div",{className:Cu},t.map((t=>T("span",{className:Su,style:{background:t}},T(qu,{title:t,placement:"top"},T("button",{key:t,className:Au,style:{background:t},onClick:e=>{this.props.onClick&&this.props.onClick(t,e)}}))))))))),T("div",{onClick:t=>t.stopImmediatePropagation()},T(gu,{onClick:this.onSwitch},this.state.setting?this.getLocale("colorPicker.collapse"):this.getLocale("colorPicker.customColor")))),this.state.setting?T("div",{className:wu},T(Tu,{color:this.state.defaultColor,rgb:this.state.rgb,onChange:this.onChange.bind(this)}),T("div",null,T(gu,{type:"primary",onClick:t=>{var e;null==(e=this.onClick)||e.call(this,this.state.afterColor,t)}},this.getLocale("colorPicker.confirmColor")),T(gu,{danger:!0,onClick:t=>{this.onCancel()}},this.getLocale("colorPicker.cancelColor")),T(gu,{onClick:t=>{t.stopPropagation(),this.setState({rgb:!this.state.rgb})}},this.getLocale("colorPicker.change")))):null))}}const yu=I(((t,e)=>{const{children:n,style:i,className:s,onClick:o,onContextMenu:r}=t;return T("div",{onContextMenu:r,ref:e,style:i,className:s,onClick:o},n)}));var Ou="univer-layout-wrapper",Du="univer-layout-wrapper-has-sider",Mu="univer-header-wrapper",xu="univer-footer-wrapper",Lu="univer-content-wrapper",ku="univer-sider-wrapper";class Pu extends qc{constructor(){super(...arguments),this.ref=f(),this.state={isAside:!1}}componentDidMount(){if(this.ref.current){let t=function(t){let e=[],n=t.getElementsByTagName("*");for(let i=0,s=n.length;i<s;++i){if(1!==n[i].nodeType)continue;let s=n[i].parentNode;s&&1===s.nodeType?s===t&&(e[e.length]=n[i]):s&&s.parentNode===t&&(e[e.length]=n[i])}return e}(this.ref.current);const e=t instanceof Array?t:[t];for(const n of e)"ASIDE"===n.tagName&&this.setState({isAside:!0})}}render(t,e){const{children:n,style:i,className:s=""}=t,{isAside:o}=e;return T("section",{style:i,ref:this.ref,className:o?`${Ou} ${Du} ${s}`:`${Ou} ${s}`},n)}}const Hu=t=>{const{children:e,style:n,className:i=""}=t;return T("header",{style:n,className:`${Mu} ${i}`},e)},Bu=t=>{const{children:e,style:n,className:i=""}=t;return T("footer",{style:n,className:`${xu} ${i}`},e)},Fu=I(((t,e)=>{const{children:n,style:i,className:s=""}=t;return T("main",{ref:e,style:i,className:`${Lu} ${s}`},n)})),Uu=t=>{const{children:e,style:n,className:i=""}=t;return T("aside",{style:n,className:`${ku} ${i}`},e)};var zu="univer-cols-menu",Wu="univer-cols-menuitem",Vu="univer-cols-menuitem-line",Yu="univer-cols-menuitem-disabled";class Gu extends qc{constructor(){super(...arguments),this._MenuRef=f(),this._refs=[],this.getMenuRef=()=>this._MenuRef,this.handleClick=(t,e,n)=>{var i,s;const{deep:o=0}=this.props;null==(i=e.onClick)||i.call(null,t,e.value,n,o),null==(s=this.props.onClick)||s.call(null,t,e.value,n,o),this.showMenu(!1)},this.showMenu=t=>{this.setState((e=>({show:t})),(()=>{this.getStyle()}))},this.mouseEnter=(t,e)=>{const{menu:n=[]}=this.props;n[e].children&&this._refs[e].showMenu(!0)},this.mouseLeave=(t,e)=>{const{menu:n=[]}=this.props;n[e].children&&this._refs[e].showMenu(!1)},this.getStyle=()=>{var t;const e=this._MenuRef.current;if(!e)return;let n={};const i=e.getBoundingClientRect();let s;const{dom:o,parent:r}=this.props;if(s=o?o.getBoundingClientRect():{left:0,right:document.documentElement.clientWidth,top:0,bottom:document.documentElement.clientHeight},r){e.style.position="fixed";let o=null==(t=e.parentElement)?void 0:t.getBoundingClientRect();if(!o)return;o.right+i.width>s.right?(n.left=o.left-i.width+"px",n.top=`${o.top}px`):(n.left=`${o.right}px`,n.top=`${o.top}px`),i.bottom>s.bottom&&(n.top="auto",n.bottom="5px"),this.setState({posStyle:n})}}}render(){const{className:t="",style:e="",menu:n,deep:i=0}=this.props,{show:s,posStyle:o}=this.state;return T("ul",{className:ud(zu,t),style:c(h(h({},e),o),{display:s?"block":"none"}),ref:this._MenuRef},null==n?void 0:n.map(((t,e)=>{var n,s;if(!1!==t.show)return T(C,null,T("li",{className:ud(Wu,null!=(n=t.className)?n:"",t.disabled?Yu:""),style:null!=(s=t.style)?s:"",onClick:n=>this.handleClick(n,t,e),onMouseEnter:t=>{this.mouseEnter(t,e)},onMouseLeave:t=>{this.mouseLeave(t,e)}},t.label,t.children?T(Gu,{ref:t=>this._refs[e]=t,menu:t.children,onClick:t.onClick,className:t.className,style:t.style,parent:this,deep:i+1}):T(C,null)),t.border?T("div",{className:Vu}):"")})))}initialize(){this.state={show:!1,posStyle:{}}}}var Xu="univer-tooltip-Group",ju="univer-tooltip-title",Ku="univer-tooltip-body",$u="univer-tooltip-triangle";const Zu={top:"univer-top",bottom:"univer-bottom",left:"univer-left",right:"univer-right"};class qu extends qc{constructor(){super(...arguments),this.tooltip=f()}initialize(t){this.state={placement:t.placement||"top",placementClassName:ud(ju,Zu[t.placement||"top"]),top:"",left:"",show:!1}}handleMouseOver(){if(this.tooltip&&this.tooltip.current){let t=this.tooltip.current.getBoundingClientRect(),e=t.height,n=t.width;"bottom"===this.state.placement?this.setState({top:e+10,left:n/2,show:!0}):"left"===this.state.placement?this.setState({top:e/2,left:n+5,show:!0}):"right"===this.state.placement?this.setState({top:e/2,left:-n-10,show:!0}):this.setState({top:-e-20,left:n/2,show:!0})}}handleMouseLeave(){this.setState({show:!1})}render(){return T("div",{ref:this.tooltip,className:Xu,style:this.props.styles},T("div",{className:Ku,onMouseEnter:this.handleMouseOver.bind(this),onMouseLeave:this.handleMouseLeave.bind(this)},this.props.children),this.props.title?T("span",{className:this.state.placementClassName,style:{top:`${this.state.top}px`,left:`${this.state.left}px`,display:""+(this.state.show?"block":"none")}},this.props.title,T("span",{className:$u})):null)}}var Qu="univer-dropdown",Ju="univer-drop-content",tg="univer-drop-icon";class eg extends qc{constructor(){super(...arguments),this.MenuRef=f(),this.DropRef=f(),this.IconRef=f(),this.handleClick=t=>{var e,n,i,s,o;null==(n=(e=this.props).onClick)||n.call(e),null==(s=(i=this.props).onMainClick)||s.call(i);const{icon:r}=this.props;r||null==(o=this.MenuRef.current)||o.showMenu(!0)},this.handleSubClick=()=>{var t;null==(t=this.MenuRef.current)||t.showMenu(!0)},this.hideMenu=()=>{var t;null==(t=this.MenuRef.current)||t.showMenu(!1)},this.hideMenuClick=t=>{var e;this.DropRef.current&&(null==(e=this.DropRef.current)?void 0:e.contains(t.target))||this.hideMenu()}}componentDidMount(){const{placement:t}=this.props;let e={position:"absolute"};t&&"Bottom"!==t?"Top"===t?(e.left=0,e.top="-100%"):"Left"===t?(e.left="-100%",e.top=0):(e.left="100%",e.top=0):(e.left=0,e.top="100%"),this.setState({menuStyle:e}),window.addEventListener("click",this.hideMenuClick,!0)}componentWillUnmount(){window.removeEventListener("click",this.hideMenuClick,!0)}render(){const{children:t,menu:e,showArrow:n,icon:i,tooltip:s}=this.props,{menuStyle:o}=this.state;return T("div",{className:Qu,ref:this.DropRef},T(qu,{title:s,placement:"bottom"},T("div",{className:Ju,onClick:this.handleClick},t,n?T(hu,null):"")),i?T("div",{ref:this.IconRef,className:tg,onClick:this.handleSubClick},i):"",T(Gu,{onClick:e.onClick,ref:this.MenuRef,menu:e.menu,className:e.className,style:h(h({},e.style),o)}))}initialize(){this.state={menuStyle:{}}}}var ng="univer-select-item",ig="univer-select-item-selected",sg="univer-select-item-content",og="univer-select-item-suffix",rg="univer-select-disabled-item";class ag extends qc{render(){const{selected:t,label:e,suffix:n,disabled:i}=this.props;return T("div",{className:ud(ng,i?rg:"")},t?T("span",{className:ig},T(eu,null)):"",T("span",{className:sg},e),n?T("span",{className:og},n):"")}}var lg,hg,cg,dg,ug="univer-select-component",gg="univer-select-single",_g="univer-select-input",pg="univer-select-double",mg="univer-select-label";(hg=lg||(lg={}))[hg.SINGLE=0]="SINGLE",hg[hg.INPUT=1]="INPUT",hg[hg.COLOR=2]="COLOR",hg[hg.DOUBLE=3]="DOUBLE",hg[hg.FIX=4]="FIX",hg[hg.DOUBLEFIX=5]="DOUBLEFIX",(dg=cg||(cg={}))[dg.LABEL=0]="LABEL",dg[dg.SUFFIX=1]="SUFFIX";class fg extends m{constructor(){super(...arguments),this.handleSelected=t=>{const{children:e=[],hideSelectedIcon:n}=this.props;e.length&&(e.forEach((t=>{t.selected=!1})),null!==t&&(e[t].selected=!0));return this.resetMenu(e,n)},this.getSingle=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:i,onMainClick:s}=this.props;return T("div",{className:`${gg} ${n}`},T(eg,{onMainClick:s,tooltip:i,menu:{menu:e,onClick:this.onClick},showArrow:!0},T("div",null,t)))},this.handlePressEnter=(t,e)=>{var n;this.onPressEnter(t),null==(n=e.current)||n.hideMenu()},this.getInput=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:i,onMainClick:s}=this.props,o=f();return T("div",{className:`${_g} ${n}`},T(eg,{onMainClick:s,ref:o,tooltip:i,menu:{menu:e,onClick:this.onClick},showArrow:!0},T(pu,{onPressEnter:t=>this.handlePressEnter(t,o),onBlur:this.onPressEnter,type:"number",value:t})))},this.getDouble=()=>{const{content:t,menu:e}=this.state,{className:n="",tooltip:i,onClick:s}=this.props;return T("div",{className:`${pg} ${n}`},T(eg,{onClick:s,tooltip:i,menu:{menu:e,onClick:this.onClick},icon:T(Jd,null)},T("div",{className:mg},t)))},this.getFix=()=>{const{label:t,className:e="",tooltip:n}=this.props,{menu:i}=this.state;return T("div",{className:`${pg} ${e}`},T(eg,{tooltip:n,menu:{menu:i,onClick:this.onClick},showArrow:!0},T("div",{className:mg},t)))},this.getDoubleFix=()=>{const{label:t,className:e="",tooltip:n,onClick:i}=this.props,{menu:s}=this.state;return T("div",{className:`${pg} ${e}`},T(eg,{tooltip:n,onClick:i,menu:{menu:s,onClick:this.onClick},icon:T(Jd,null)},T("div",{className:mg},t)))}}initialize(){var t;const{children:e=[],hideSelectedIcon:n}=this.props,i=this.resetMenu(e,n);this.state={menu:i,color:null!=(t=this.props.defaultColor)?t:"#000",content:"",value:""}}getType(t){switch(t){case 0:return this.getSingle();case 1:return this.getInput();case 3:return this.getDouble();case 4:return this.getFix();case 5:return this.getDoubleFix()}}initData(){const{type:t,display:e,children:n=[],label:i}=this.props;if(0===t||3===t){if(!n.length)return;let t=n.findIndex((t=>t.selected));t<0&&(t=0);const i=this.handleSelected(t),s=n[t];1===e?this.setState({content:s.suffix,menu:i}):this.setState({content:s.label,menu:i}),this.onClick=(...t)=>{var i,s;const o=n[t[2]];if(null==(s=(i=this.props).onClick)||s.call(i,t[1],t[2],t[3]),o.unSelectable)return;const r=this.handleSelected(t[2]);1===e?this.setState({content:n[t[2]].suffix,menu:r}):this.setState({content:n[t[2]].label,menu:r})}}else if(1===t){if(!n.length)return;const t=t=>{if(null!==t){if(""===t)return;let e=n.findIndex((e=>t===e.label)),i=this.handleSelected(e<0?null:e);this.setState({content:t,menu:i})}else{let t=n.findIndex((t=>t.selected));t<0&&(t=0);let e=this.handleSelected(t);const i=n[t];this.setState({content:i.label,menu:e})}};t(i),this.onClick=(...t)=>{var e,i;null==(i=(e=this.props).onClick)||i.call(e,t[1],t[2],t[3]);const s=this.handleSelected(t[2]);this.setState({content:n[t[2]].label,menu:s})},this.onPressEnter=e=>{var n,i;const s=e.currentTarget.value;null==(i=(n=this.props).onPressEnter)||i.call(n,s),t(s)}}else if(2===t){const t=this.handleSelected(null);this.setState({menu:t}),this.onClick=()=>{var t,e;const{color:n}=this.state;null==(e=(t=this.props).onClick)||e.call(t,n)}}else if(4===t||5===t){if(!n.length)return;let t=n.findIndex((t=>t.selected));t<0&&(t=0);const e=n[t],i=this.handleSelected(t);this.setState({menu:i,value:e.value}),this.onClick=(...t)=>{var e,i,s,o;if(t.length){null==(i=(e=this.props).onClick)||i.call(e,t[1],t[2],t[3]);const s=this.handleSelected(t[2]);this.setState({menu:s,value:n[t[2]].value})}else null==(o=(s=this.props).onClick)||o.call(s,this.state.value)}}}componentDidMount(){this.initData()}componentWillReceiveProps(t){}resetMenu(t,e){var n;const i=[];for(let s=0;s<t.length;s++){let o=!1;e||(o=null!=(n=t[s].selected)&&n),i[s]={label:""},i[s].label=T(ag,{disabled:t[s].disabled,border:t[s].border,selected:o,label:t[s].label,suffix:t[s].suffix}),i[s].disabled=t[s].disabled,i[s].style=t[s].style,i[s].value=t[s].value,i[s].className=t[s].className,i[s].onClick=t[s].onClick,i[s].border=t[s].border,t[s].children&&(i[s].children=this.resetMenu(t[s].children))}return i}render(){const{type:t=0}=this.props;return T("div",{className:ug},this.getType(t))}}const Tg={};class vg extends ko{constructor(t={}){super(sn.BASE_UI),this._config=Object.assign(Tg,t)}static create(t){return new vg(t)}installTo(t){t.install(this)}initialize(t){this.context=t,this.initEventManager()}getConfig(){return this._config}onMounted(t){this.initialize(t)}initEventManager(){this._eventManager=new Zc(this)}getEventManager(){return this._eventManager}}var Eg={ui:{tooltip:"UI",one:"一",two:"二",three:"三"}},bg={ui:{tooltip:"UI",one:"one",two:"two",three:"three"}};var Ig={successColor:"#52c41a",warningColor:"#faad14",errorColor:"#f5222d",borderRadiusBase:"2px",borderWidthBase:"1px",borderStyleBase:"solid",lineHeightBase:"1.5715",fontWeight:"400",fontSizeBase:"14px",fontSizeLg:"16px",fontSizeSm:"12px",paddingBase:"1em",marginBase:"1em",gray1:"#ffffff",gray2:"#fafafa",gray3:"#f5f5f5",gray4:"#f0f0f0",gray5:"#d9d9d9",gray6:"#bfbfbf",gray7:"#8c8c8c",gray8:"#595959",gray9:"#434343",gray10:"#262626",gray11:"#1f1f1f",gray12:"#141414",gray13:"#000000",gray14:"#efefef",gray15:"#e0e0e0",gray16:"#ececec",gray17:"#cbcbcb",primaryColor:"#0188fb",primaryColorHover:"#5391ff",linkColor:"#1890ff",bg:"#fff",bgHover:"#efefef",fontSize:"14px",headingColor:"#262626",textColor:"#333",textColorSecondary:"#8c8c8c",disabledColor:"#bfbfbf",disabledBg:"#f5f5f5",borderColorBase:"#d9d9d9",boxShadowBase:"0 3px 6px -4px rgba(0, 0, 0, 0.12), 0 6px 16px 0 rgba(0, 0, 0, 0.08), 0 9px 28px 8px rgba(0, 0, 0, 0.05)",borderColorBaseHover:"#bfbfbf"};var Cg="univer-layout-container",Sg="univer-content-container-horizontal",Ag="univer-content-inner-left-container",wg="univer-hover-cursor",Rg="univer-content-inner-right-container",Ng="univer-content-container-vertical",yg="univer-main-content",Og="univer-outer-right-container";var Dg="univer-info-detail",Mg="univer-sheet-name",xg="univer-info-detail-update",Lg="univer-info-detail-save";class kg extends qc{initialize(){this.state={infoList:null}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}setInfoList(t){this.setState({infoList:t})}render(){const{renameSheet:t}=this.props;if(!this.state.infoList)return;const{back:e,slide:n,update:i,save:s,rename:o}=this.state.infoList;return T(yu,{className:Dg},T("div",{className:Mg},T(qu,{title:o.label,placement:"bottom"},T(pu,{bordered:!1,value:n.label,onBlur:t}))),T("div",{className:xg},i.label),T("div",{className:Lg},s.label))}}const Pg={undo:!0,redo:!0,paintFormat:!0,currencyFormat:!0,percentageFormat:!0,numberDecrease:!0,numberIncrease:!0,moreFormats:!0,font:!0,fontSize:!0,bold:!0,italic:!0,strikethrough:!0,underline:!0,textColor:!0,fillColor:!0,border:!0,horizontalAlignMode:!0,verticalAlignMode:!0,textWrapMode:!0,textRotateMode:!0,mergeCell:!0},Hg={layout:{slideContainerConfig:{outerLeft:!1,outerRight:!1,header:!0,footer:!0,innerLeft:!1,innerRight:!1,frozenHeaderLT:!1,frozenHeaderRT:!1,frozenHeaderLM:!1,frozenContent:!1,infoBar:!0,toolbar:!0},toolbarConfig:Pg}};var Bg="univer-toolbar-warp",Fg="univer-toolbar",Ug="univer-select-label-string",zg="univer-select-double-string",Wg="univer-select-color-picker-parent",Vg="univer-select-color-picker",Yg="univer-select-line-bold-parent",Gg="univer-text-button",Xg="univer-more-button",jg="univer-more-tool",Kg="univer-tooltip-title",$g="univer-bottom";class Zg extends qc{constructor(){super(...arguments),this.toolbarRef=f(),this.moreBtnRef=f(),this.moreToolRef=f(),this.SelectRef=f(),this.clientWidth=0,this.debounceSetToolbarListWidth=gd((()=>{this.setToolbarListWidth()}),50),this.showMore=()=>{let t=this.state.showMore;this.setState({showMore:!t}),t||document.addEventListener("click",this.hide,!0)},this.hide=t=>{this.moreToolRef.current.contains(t.target)||(t.stopImmediatePropagation(),this.setState({showMore:!1}),document.removeEventListener("click",this.hide,!0))},this.setToolbarListWidth=()=>{this.clientWidth||(this.clientWidth=document.documentElement.clientWidth);const t=this.toolbarRef.current.querySelectorAll(`.${Bg} > div`),e=this.moreBtnRef.current.clientWidth;let n=60+e,i=null;const s=document.documentElement.clientWidth;if(s<=this.clientWidth){this.clientWidth=s;for(let e=0;e<t.length;e++)if(n+=t[e].clientWidth+6,n>s){i=e;break}null!==i&&this.setState({defaultToolList:this.state.toolList.slice(0,i),moreToolList:i?this.state.toolList.slice(i):[]},(()=>{this.resetUl(),this.forceUpdate()}))}else if(this.clientWidth=s,this.state.moreToolList.length){let n=30+e;for(let e=0;e<t.length;e++)n+=t[e].clientWidth+6;const i=this.moreToolRef.current.querySelectorAll(`.${jg} > div`);let o=null,r=!1;for(let t=0;t<i.length;t++){if(n+=i[t].clientWidth+6,n>s){o=t;break}t===i.length-1&&(o=t,r=!0)}null!==o&&this.setState({defaultToolList:this.state.defaultToolList.concat(this.state.moreToolList.slice(0,r?o+1:o)),moreToolList:r?[]:this.state.moreToolList.slice(o)},(()=>{this.resetUl(),this.forceUpdate()}))}},this.resetLabel=t=>{var e,n,i;const s=null==(e=this.getContext().getPluginManager().getPluginByName("SlideUI"))?void 0:e.getComponentManager();for(let o=0;o<t.length;o++){const e=pd(t[o],this.getLocale.bind(this));if(e.customLabel){const t=null==s?void 0:s.get(e.customLabel.name);if(t){const i=null!=(n=e.customLabel.props)?n:{};e.label=T(t,h({},i))}}if(e.customSuffix){const t=null==s?void 0:s.get(e.customSuffix.name);if(t){const n=null!=(i=e.customSuffix.props)?i:{};e.suffix=T(t,h({},n))}}e.children&&(e.children=this.resetLabel(e.children))}return t},this.setToolbar=t=>{this.setState({toolList:t,defaultToolList:t},(()=>{this.setToolbarListWidth()}))},this.resetUl=()=>{var t;const e=`${(null==(t=this.getContext().getPluginManager().getPluginByName("SlideUI"))?void 0:t.getAppUIController().getSlideContainerController().getContentRef().current).offsetHeight}px`,n=this.toolbarRef.current.querySelectorAll("ul");for(let i=0;i<n.length;i++)n[i].style.maxHeight=e}}initialize(){this.state={showMore:!1,toolList:[],defaultToolList:[],moreToolList:[],toolbarListWidths:[]}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this),window.addEventListener("resize",this.debounceSetToolbarListWidth)}componentWillUnmount(){window.removeEventListener("resize",this.debounceSetToolbarListWidth)}getToolbarList(t){return(t=this.resetLabel(t)).map((t=>{if(t.toolbarType){if(t.show)return T(qu,{title:this.getLocale(t.tooltip),placement:"bottom"},T(gu,{unActive:t.unActive,className:Gg,type:"text",active:t.active,onClick:t.onClick},t.label))}else if(t.show)return T(fg,{tooltip:this.getLocale(t.tooltip),type:t.type,display:t.display,children:t.children,customLabel:t.customLabel,customSuffix:t.customSuffix,label:t.label,onClick:t.onClick,onPressEnter:t.onPressEnter,onMainClick:t.onMainClick,defaultColor:t.defaultColor,hideSelectedIcon:t.hideSelectedIcon,className:t.className});return null}))}render(){const{defaultToolList:t,moreToolList:e,showMore:n}=this.state;return T(yu,{style:{position:"relative"}},T("div",{className:`${Bg} ${Fg}`,ref:this.toolbarRef},this.getToolbarList(t),T("div",{ref:this.moreBtnRef,className:Xg,style:{visibility:e.length?"visible":"hidden"}},T(qu,{title:this.getLocale("toolbar.toolMoreTip"),placement:"bottom"},T(gu,{type:"text",onClick:this.showMore},T("div",{style:{fontSize:"14px"}},this.getLocale("toolbar.toolMore")))))),e.length?T("div",{style:{visibility:n?"visible":"hidden"},className:`${jg} ${Fg}`,ref:this.moreToolRef},this.getToolbarList(e)):"")}}Zg.contextType=Kc;var qg="univer-slide-bar",Qg="univer-slide-bar-content",Jg="univer-slide-bar-item",t_="univer-slide-bar-box",e_="univer-slide-bar-item-active",n_="univer-slide-add-button";class i_ extends qc{constructor(){super(...arguments),this.slideBarRef=f()}initialize(){this.state={slideList:[]}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}isActive(t,e=0){return null==this.state.activePageId&&0===e||this.state.activePageId===t?e_:""}setSlide(t,e){this.setState({slideList:t},e)}activeSlide(t,e){this.state.activePageId!==t&&(this.setState({activePageId:t}),this.props.activeSlide(t))}render(){const{addSlide:t}=this.props,{slideList:e}=this.state;return T("div",{className:qg,ref:this.slideBarRef},T("div",{className:Qg},e.map(((t,e)=>T("div",{className:`${Jg} ${this.isActive(t.id,e)}`,onClick:()=>this.activeSlide(t.id,e)},T("span",null,e+1),T("div",{className:t_}))))),T("div",{className:n_},T(gu,{type:"text",onClick:t},"+")))}}i_.contextType=Kc;class s_ extends qc{constructor(t){super(),this.splitLeftRef=f(),this.contentRef=f(),this.handleSplitBarMouseDown=t=>{var e,n,i,s,o;this.leftContentLeft=null==(e=this.splitLeftRef.current)?void 0:e.getBoundingClientRect().left,this.leftContentTop=null==(n=this.splitLeftRef.current)?void 0:n.getBoundingClientRect().top;const r=null==(i=this.splitLeftRef.current)?void 0:i.parentElement;this.rightBorderX=null==(s=null==r?void 0:r.getBoundingClientRect())?void 0:s.width,this.rightBorderY=null==(o=null==r?void 0:r.getBoundingClientRect())?void 0:o.height,document.addEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.addEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.handleSplitBarMouseMove=t=>{var e;const n=null==(e=this.props.config.layout)?void 0:e.slideContainerConfig;let i=(t=t||window.event).clientX-this.leftContentLeft,s=t.clientY-this.leftContentTop;i=i>=this.rightBorderX?this.rightBorderX:i,s=s>=this.rightBorderY?this.rightBorderY:s,"vertical"===n.contentSplit?this.splitLeftRef.current.style.height=`${s}px`:this.splitLeftRef.current.style.width=`${i}px`},this.handleSplitBarMouseUp=t=>{document.removeEventListener("mousemove",this.handleSplitBarMouseMove,!1),document.removeEventListener("mouseup",this.handleSplitBarMouseUp,!1)},this.changeSkin(t.config.container,"default")}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}getContentRef(){return this.contentRef}getSplitLeftRef(){return this.splitLeftRef}changeSkin(t,e){let n=document.documentElement;const i="string"==typeof t?t:t.id;let s={default:Ig}[e];if(s=Object.fromEntries(Object.keys(s).map((t=>[`--${t.replace(/([A-Z0-9])/g,"-$1").toLowerCase()}`,s[t]]))),z.isIEBrowser())S({rootElement:n,variables:s});else{(function(t){const e="universlide-skin-style";for(let s=0;s<document.styleSheets.length;s++)if(document.styleSheets[s].title===e)return o(document.styleSheets[s],t),document.styleSheets[s];const n=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");return i.title=e,n.appendChild(i),document.styleSheets[document.styleSheets.length-1]})(i).insertRule(`#${i} ${JSON.stringify(s).replace(/"/g,"").replace(/,(?=--)/g,";")}`)}function o(t,e){let n=0;for(let i=0;i<t.cssRules.length;i++){const s=t.cssRules[i];if(s instanceof CSSStyleRule&&s.selectorText===`#${e}`){n=i,t.deleteRule(n);break}}}}render(){const{methods:t}=this.props,{layout:e}=this.props.config,n=null==e?void 0:e.slideContainerConfig;return T(yu,{className:Cg},T(Pu,null,T(Uu,{style:{display:n.outerLeft?"block":"none"}}),T(Pu,{className:yg,style:{position:"relative"}},T(Hu,{style:{display:n.header?"block":"none"}},n.infoBar&&T(kg,h({},t.infoBar)),n.toolbar&&T(Zg,h({},t.toolbar))),T(Pu,null,T(Uu,{style:{width:"300px",display:n.innerLeft?"block":"none"}},T(i_,h({},t.slideBar))),T(Fu,{className:"vertical"===n.contentSplit?Ng:Sg},!!n.contentSplit&&T(yu,{ref:this.splitLeftRef,className:Ag},T("div",{className:wg,onMouseDown:this.handleSplitBarMouseDown})),T(yu,{onContextMenu:t=>t.preventDefault(),ref:this.contentRef,className:Rg})),T(Uu,{style:{display:n.innerRight?"block":"none"}})),T(Bu,{style:{display:n.footer?"block":"none"}})),T(Uu,{style:{display:n.outerRight?"block":"none"},className:Og})))}}class o_ extends qc{constructor(t){super(t),this.state={locale:this.props.locale}}setLocale(t){const e=t.target.value;this.props.changeLocale(e),this.setState({locale:e})}render(){const{context:t,UIConfig:e}=this.props,{locale:n}=this.state;return T(Kc.Provider,{value:{context:t,locale:n}},T("div",{style:{position:"fixed",right:"250px",top:"14px",fontSize:"14px",zIndex:100},className:"univer-dev-operation"},T("span",{style:{display:"inline-block",width:70,margin:"5px 0 0 5px"}},"Language"),T("select",{value:n,onChange:this.setLocale.bind(this),style:{width:70}},T("option",{value:"en"},"English"),T("option",{value:"zh"},"中文"))),T(s_,h({},e)))}}var r_="univer-color-select",a_="univer-color-select-line";class l_ extends qc{componentDidMount(){var t,e,n;const i=null==(t=this.getContext().getPluginManager().getPluginByName("SlideUI"))?void 0:t.getComponentManager();let s=this.props.label;if(this.props.customLabel){const t=null==i?void 0:i.get(this.props.customLabel.name);s=T(t,h({},this.props.customLabel.props))}this.setState({label:s,color:this.props.color}),null==(n=(e=this.props).getComponent)||n.call(e,this)}componentWillReceiveProps(t){this.setState({color:t.color})}setColor(t){this.setState({color:t})}render(){return T("div",{className:r_},T("div",null,this.state.label),T("div",{className:a_,style:{background:this.state.color}}))}}class h_ extends qc{initialize(){this.state={img:""}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}componentWillReceiveProps(t){this.setState({img:t.img})}setImg(t=""){this.setState({img:t})}getImg(t){var e;if(!t)return null;const n={width:document.querySelector(".base-sheets-line-bold").offsetWidth},i=null==(e=this.getContext().getPluginManager().getPluginByName("SlideUI"))?void 0:e.getComponentManager(),s=null==i?void 0:i.get(t);return T(s,h({},n))}render(){const{img:t}=this.state,{label:e}=this.props;return T("div",{style:{paddingBottom:"3px",width:"100%",display:"flex",justifyContent:"space-between",alignItems:"center"}},T("span",{className:"base-sheets-line-bold",style:{position:"relative"}},this.getLocale(e),T("div",{style:{width:"100%",height:0,position:"absolute",left:0,bottom:"14px"}},t.length?this.getImg(t):"")),T(tu,null))}}class c_ extends qc{initialize(){this.state={color:this.props.color}}componentDidMount(){var t,e;null==(e=(t=this.props).getComponent)||e.call(t,this)}componentWillReceiveProps(t){this.setState({color:t.color})}setColor(t){this.setState({color:t})}render(){const{color:t}=this.state,{label:e}=this.props;return T("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},T("span",{style:{display:"inline-block",borderBottom:`3px solid ${t}`}},this.getLocale(e)),T(tu,null))}}class d_{constructor(t){this._initialize(t)}static create(t){return new d_(t)}_initialize(t){let e;const n=t.container;if("string"==typeof n){const t=document.getElementById(n);null==t?(e=document.createElement("div"),e.id=n):e=t}else(i=n)instanceof Element||i instanceof HTMLDocument?e=n:(e=document.createElement("div"),e.id="univer");var i;A(T(o_,h({},t)),e)}}class u_{constructor(t){this._name=t}get name(){return this._name}setName(t){this._name=t}}class g_{constructor(t){this.getComponent=t=>{this._infoBar=t,this._refreshComponent(),this.resetInfoList(this._infoList)},this._plugin=t}resetInfoList(t){const e=this._plugin.getGlobalContext().getLocale();for(let n in t)t[n].locale&&(t[n].label=e.get(t[n].locale));this._infoBar.setInfoList(t)}setSlideName(t){const e=t.target.value;this._infoBarModel.setName(e)}_refreshComponent(){const t="UniverSlide";this._infoBarModel=new u_(t),this._infoList={back:{locale:"info.return"},rename:{locale:"info.tips"},update:{locale:"info.detailUpdate"},save:{locale:"info.detailSave"},slide:{label:t,onBlur:t=>{this.setSlideName(t)}}}}}class __{constructor(t){this._pages=[],this.getComponent=t=>{this._slideBar=t,this.setSlideBar()},this.addSlide=()=>{const t=this._slidePlugin.getContext().getSlide(),e=this._getCanvasView(),n=t.addPage();this._pages.push(n),this._slideBar.setSlide(this._pages,(()=>{var t;const n=null==(t=this._slideBar.slideBarRef.current)?void 0:t.childNodes[0].childNodes;e.createSlidePages(n,this._pages)}))},this.activeSlide=t=>{this._getCanvasView().activePage(t)},this._plugin=t,this._slidePlugin=t.getUniver().getCurrentUniverSlideInstance().context.getPluginManager().getRequirePluginByName(sn.SLIDE),this._initialize()}setSlideBar(){const t=this._getCanvasView();this._slideBar.setSlide(this._pages,(()=>{var e;const n=null==(e=this._slideBar.slideBarRef.current)?void 0:e.childNodes[0].childNodes;t.createSlidePages(n,this._pages)})),t.getSlide().onSlideChangePageByNavigationObservable.add((e=>{this._slideBar.state.activePageId!==e&&null!=e&&(this._slideBar.setState({activePageId:e}),t.activePage(e))}))}_initialize(){this._generateModel()}_getCanvasView(){return this._slidePlugin.getCanvasView()}_generateModel(){const t=this._slidePlugin.getContext().getSlide(),e=t.getPages(),n=t.getPageOrder();e&&n&&n.forEach((t=>{this._pages.push(e[t])}))}}const p_=[{label:"9",value:9},{label:"10",value:10},{label:"11",value:11},{label:"12",value:12},{label:"14",value:14},{label:"16",value:16},{label:"18",value:18},{label:"20",value:20},{label:"22",value:22},{label:"24",value:24},{label:"26",value:26},{label:"28",value:28},{label:"36",value:36},{label:"48",value:48},{label:"72",value:72}],m_=[{labelLocale:"fontFamily.TimesNewRoman",style:{"font-family":"Times New Roman"},value:"Times New Roman",selected:!0},{labelLocale:"fontFamily.Arial",style:{"font-family":"Arial"},value:"Arial"},{labelLocale:"fontFamily.Tahoma",style:{"font-family":"Tahoma"},value:"Tahoma"},{labelLocale:"fontFamily.Verdana",style:{"font-family":"Verdana"},value:"Verdana"},{labelLocale:"fontFamily.MicrosoftAccorblack",style:{"font-family":"微软雅黑"},value:"微软雅黑"},{labelLocale:"fontFamily.SimSun",style:{"font-family":"宋体"},value:"宋体"},{labelLocale:"fontFamily.SimHei",style:{"font-family":"黑体"},value:"黑体"},{labelLocale:"fontFamily.Kaiti",style:{"font-family":"楷体"},value:"楷体"},{labelLocale:"fontFamily.FangSong",style:{"font-family":"仿宋"},value:"仿宋"},{labelLocale:"fontFamily.NSimSun",style:{"font-family":"新宋体"},value:"新宋体"},{labelLocale:"fontFamily.STXinwei",style:{"font-family":"华文新魏"},value:"华文新魏"},{labelLocale:"fontFamily.STXingkai",style:{"font-family":"华文行楷"},value:"华文行楷"},{labelLocale:"fontFamily.STLiti",style:{"font-family":"华文隶书"},value:"华文隶书"},{labelLocale:"fontFamily.HanaleiFill",style:{"font-family":"HanaleiFill"},value:"HanaleiFill"},{labelLocale:"fontFamily.Anton",style:{"font-family":"Anton"},value:"Anton"},{labelLocale:"fontFamily.Pacifico",style:{"font-family":"Pacifico"},value:"Pacifico"}],f_=[{labelLocale:"borderLine.borderTop",customSuffix:{name:"TopBorderIcon"},value:"top"},{labelLocale:"borderLine.borderBottom",customSuffix:{name:"BottomBorderIcon"},value:"bottom"},{labelLocale:"borderLine.borderLeft",customSuffix:{name:"LeftBorderIcon"},value:"left"},{labelLocale:"borderLine.borderRight",customSuffix:{name:"RightBorderIcon"},value:"right",border:!0},{labelLocale:"borderLine.borderNone",customSuffix:{name:"NoneBorderIcon"},value:"none"},{labelLocale:"borderLine.borderAll",customSuffix:{name:"FullBorderIcon"},value:"all",selected:!0},{labelLocale:"borderLine.borderOutside",customSuffix:{name:"OuterBorderIcon"},value:"outside"},{labelLocale:"borderLine.borderInside",customSuffix:{name:"InnerBorderIcon"},value:"inside"},{labelLocale:"borderLine.borderHorizontal",customSuffix:{name:"StripingBorderIcon"},value:"horizontal"},{labelLocale:"borderLine.borderVertical",customSuffix:{name:"VerticalBorderIcon"},value:"vertical"}],T_=[{labelLocale:"borderLine.borderNone",value:Yt.NONE},{customLabel:{name:"BorderThin"},value:Yt.THIN},{customLabel:{name:"BorderHair"},value:Yt.HAIR},{customLabel:{name:"BorderDotted"},value:Yt.DOTTED},{customLabel:{name:"BorderDashed"},value:Yt.DASHED},{customLabel:{name:"BorderDashDot"},value:Yt.DOTTED},{customLabel:{name:"BorderDashDotDot"},value:Yt.DASH_DOT_DOT},{customLabel:{name:"BorderMedium"},value:Yt.MEDIUM},{customLabel:{name:"BorderMediumDashed"},value:Yt.MEDIUM_DASHED},{customLabel:{name:"BorderMediumDashDot"},value:Yt.MEDIUM_DASH_DOT},{customLabel:{name:"BorderMediumDashDotDot"},value:Yt.MEDIUM_DASH_DOT_DOT},{customLabel:{name:"BorderThick"},value:Yt.THICK}],v_=[{labelLocale:"merge.all",value:"all"},{labelLocale:"merge.vertical",value:"vertical"},{labelLocale:"merge.horizontal",value:"horizontal"},{labelLocale:"merge.cancel",value:"cancel"}],E_=[{labelLocale:"align.left",customSuffix:{name:"LeftAlignIcon"},value:1},{labelLocale:"align.center",selected:!0,customSuffix:{name:"CenterAlignIcon"},value:2},{labelLocale:"align.right",customSuffix:{name:"RightAlignIcon"},value:3}],b_=[{labelLocale:"align.top",customSuffix:{name:"TopVerticalIcon"},value:1},{labelLocale:"align.middle",customSuffix:{name:"CenterVerticalIcon"},value:2},{labelLocale:"align.bottom",customSuffix:{name:"BottomVerticalIcon"},value:3}],I_=[{labelLocale:"textWrap.overflow",customSuffix:{name:"OverflowIcon"},value:1},{labelLocale:"textWrap.wrap",customSuffix:{name:"BrIcon"},value:3},{labelLocale:"textWrap.clip",customSuffix:{name:"CutIcon"},value:2}],C_=[{labelLocale:"textRotate.none",customSuffix:{name:"TextRotateIcon"},value:0},{labelLocale:"textRotate.angleUp",customSuffix:{name:"TextRotateAngleUpIcon"},value:-45},{labelLocale:"textRotate.angleDown",customSuffix:{name:"TextRotateAngleDownIcon"},value:45},{labelLocale:"textRotate.vertical",customSuffix:{name:"TextRotateVerticalIcon"},value:"v"},{labelLocale:"textRotate.rotationUp",customSuffix:{name:"TextRotateRotationUpIcon"},value:-90},{labelLocale:"textRotate.rotationDown",customSuffix:{name:"TextRotateRotationDownIcon"},value:90}];var S_,A_;(A_=S_||(S_={}))[A_.SELECT=0]="SELECT",A_[A_.BUTTON=1]="BUTTON";class w_{constructor(t,e){this._textColor="#000",this._background="#fff",this._borderInfo={type:Xt.ALL,color:"#000",style:1},this.getComponent=t=>{this._toolbar=t,this.setToolbar()},this._plugin=t,this._slidePlugin=t.getContext().getUniver().getCurrentUniverSlideInstance().context.getPluginManager().getPluginByName(sn.SLIDE),this._config=z.deepMerge({},Pg,e),this._toolList=[{toolbarType:1,tooltip:"toolbar.undo",name:"undo",unActive:!0,customLabel:{name:"ForwardIcon"},show:this._config.undo,onClick:()=>{this.setUndo(),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.redo",unActive:!0,customLabel:{name:"BackIcon"},name:"redo",show:this._config.redo,onClick:()=>{this.setRedo(),this.hideTooltip()}},{type:0,tooltip:"toolbar.font",className:Ug,name:"font",show:this._config.font,border:!0,onMainClick:()=>{this.hideTooltip()},onClick:t=>{this.setFontFamily(t)},children:m_},{type:1,tooltip:"toolbar.fontSize",label:String(Qe.fs),name:"fontSize",show:this._config.fontSize,onClick:t=>{this.setFontSize(t)},onMainClick:()=>{this.hideTooltip()},onPressEnter:t=>{this.setFontSize(t),this.hideTooltip()},children:p_},{toolbarType:1,tooltip:"toolbar.bold",customLabel:{name:"BoldIcon"},active:!1,name:"bold",show:this._config.bold,onClick:(t,e)=>{this.setFontWeight(e),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.italic",customLabel:{name:"ItalicIcon"},name:"italic",show:this._config.italic,onClick:(t,e)=>{this.setFontStyle(e),this.hideTooltip()}},{toolbarType:1,tooltip:"toolbar.strikethrough",customLabel:{name:"DeleteLineIcon"},name:"strikethrough",show:this._config.strikethrough,onClick:(t,e)=>{this.hideTooltip();const n=this._toolList.find((t=>"strikethrough"===t.name));n&&(n.active=e,this.setStrikeThrough(e))}},{toolbarType:1,tooltip:"toolbar.underline",customLabel:{name:"UnderLineIcon"},name:"underline",show:this._config.underline,onClick:(t,e)=>{this.hideTooltip();const n=this._toolList.find((t=>"underline"===t.name));n&&(n.active=e,this.setUnderline(e))}},{type:5,tooltip:"toolbar.textColor.main",customLabel:{name:"SlideUI"+l_.name,props:{getComponent:t=>{this._colorSelect1=t},color:"#000",customLabel:{name:"TextColorIcon"}}},onClick:()=>{this.hideTooltip();const t=this._toolList.find((t=>"textColor"===t.name));t&&t.customLabel&&t.customLabel.props&&(t.customLabel.props.color=this._textColor,this.changeColor(this._textColor))},hideSelectedIcon:!0,className:Wg,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:"SlideUI"+Nu.name,props:{onClick:(t,e)=>{this._colorSelect1.setColor(t),this._textColor=t}}},className:Vg}],name:"textColor",show:this._config.textColor},{type:5,tooltip:"toolbar.fillColor.main",customLabel:{name:"SlideUI"+l_.name,props:{getComponent:t=>{this._colorSelect2=t},color:"#fff",customLabel:{name:"FillColorIcon"}}},onClick:()=>{this.hideTooltip();const t=this._toolList.find((t=>"fillColor"===t.name));t&&t.customLabel&&t.customLabel.props&&(t.customLabel.props.color=this._background,this.setBackground(this._background))},hideSelectedIcon:!0,className:Wg,children:[{labelLocale:"toolbar.resetColor"},{customLabel:{name:"SlideUI"+Nu.name,props:{onClick:(t,e)=>{this._colorSelect2.setColor(t),this._background=t}}},className:Vg}],name:"fillColor",show:this._config.fillColor},{type:3,display:1,show:this._config.border,tooltip:"toolbar.border.main",className:zg,onClick:t=>{t&&(this._borderInfo.type=t),this.hideTooltip(),this.setBorder()},name:"border",children:[...f_,{name:"borderColor",customLabel:{name:"SlideUI"+c_.name,props:{color:"#000",label:"borderLine.borderColor",getComponent:t=>this._lineColor=t}},unSelectable:!0,className:Wg,children:[{customLabel:{name:"SlideUI"+Nu.name,props:{onClick:(t,e)=>{var n;this._lineColor.setColor(t),this._borderInfo.color=t;const i=this._toolList.find((t=>"border"===t.name)),s=null==(n=null==i?void 0:i.children)?void 0:n.find((t=>"borderColor"===t.name));s&&s.customLabel&&s.customLabel.props&&(s.customLabel.props.color=t)}}},className:Vg,onClick:(...t)=>{t[0].stopPropagation()}}]},{customLabel:{name:"SlideUI"+h_.name,props:{img:0,label:"borderLine.borderSize",getComponent:t=>this._lineBold=t}},onClick:(...t)=>{var e;t[0].stopPropagation(),this._lineBold.setImg(null==(e=T_[t[2]].customLabel)?void 0:e.name),this._borderInfo.style=t[1]},className:Yg,unSelectable:!0,children:T_}]},{type:5,tooltip:"toolbar.mergeCell.main",customLabel:{name:"MergeIcon"},show:this._config.mergeCell,onClick:t=>{this.setMerge(null!=t?t:"all"),this.hideTooltip()},name:"mergeCell",children:v_},{type:3,tooltip:"toolbar.horizontalAlignMode.main",className:zg,display:1,name:"horizontalAlignMode",show:this._config.horizontalAlignMode,onClick:t=>{this.setHorizontalAlignment(t),this.hideTooltip()},children:E_},{type:3,tooltip:"toolbar.verticalAlignMode.main",className:zg,display:1,name:"verticalAlignMode",show:this._config.verticalAlignMode,onClick:t=>{this.setVerticalAlignment(t),this.hideTooltip()},children:b_},{type:3,className:zg,tooltip:"toolbar.textWrapMode.main",display:1,name:"textWrapMode",show:this._config.textWrapMode,onClick:t=>{this.setWrapStrategy(t),this.hideTooltip()},children:I_},{type:3,className:zg,name:"textRotateMode",tooltip:"toolbar.textRotateMode.main",display:1,show:this._config.textRotateMode,onClick:t=>{this.setTextRotation(t),this.hideTooltip()},children:C_}],this._initialize()}addToolbarConfig(t){this._toolList.findIndex((e=>e.name===t.name))>-1||this._toolList.push(t)}deleteToolbarConfig(t){const e=this._toolList.findIndex((e=>e.name===t));e>-1&&this._toolList.splice(e,1)}setToolbar(){var t;null==(t=this._toolbar)||t.setToolbar(this._toolList)}setUIObserve(t){this._plugin.getContext().getObserverManager().requiredObserver("onUIChangeObservable","core").notifyObservers(t)}changeColor(t){var e,n;const i=this._toolList.find((t=>"strikethrough"===t.name)),s=this._toolList.find((t=>"underline"===t.name));this.setFontColor(t),s&&this.setUnderline(null!=(e=s.active)&&e),i&&this.setStrikeThrough(null!=(n=i.active)&&n)}setUndo(){this.setUIObserve({name:"undo"})}setRedo(){this.setUIObserve({name:"redo"})}setFontFamily(t){const e={name:"fontFamily",value:t};this.setUIObserve(e)}setFontSize(t){const e={name:"fontSize",value:t};this.setUIObserve(e)}setFontWeight(t){const e={name:"fontWeight",value:t};this.setUIObserve(e)}setFontStyle(t){const e={name:"fontStyle",value:t};this.setUIObserve(e)}setStrikeThrough(t){const e={name:"strikeThrough",value:t};this.setUIObserve(e)}setUnderline(t){const e={name:"underLine",value:t};this.setUIObserve(e)}setFontColor(t){const e={name:"fontColor",value:t};this.setUIObserve(e)}setBackground(t){const e={name:"background",value:t};this.setUIObserve(e)}setMerge(t){const e={name:"merge",value:t};this.setUIObserve(e)}setTextRotation(t){const e={name:"textRotation",value:t};this.setUIObserve(e)}setWrapStrategy(t){const e={name:"wrapStrategy",value:t};this.setUIObserve(e)}setVerticalAlignment(t){const e={name:"verticalAlignment",value:t};this.setUIObserve(e)}setHorizontalAlignment(t){const e={name:"horizontalAlignment",value:t};this.setUIObserve(e)}setBorder(){const t={name:"borderInfo",value:this._borderInfo};this.setUIObserve(t)}hideTooltip(){this._toolbar.base.querySelectorAll(`.${Kg}.${$g}`).forEach((t=>{t.style.display="none"}))}_initialize(){this._plugin.getComponentManager().register("SlideUI"+l_.name,l_),this._plugin.getComponentManager().register("SlideUI"+Nu.name,Nu),this._plugin.getComponentManager().register("SlideUI"+c_.name,c_),this._plugin.getComponentManager().register("SlideUI"+h_.name,h_),Ii.getCommandObservers().add((({actions:t})=>{}))}}class R_{constructor(t){var e;this.getComponent=t=>{var e;this._slideContainer=t,null==(e=this._plugin.getObserver("onUIDidMount"))||e.notifyObservers(this._slideContainer),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onUIDidMountObservable","core").notifyObservers(!0),this.setSlideContainer()},this.changeLocale=t=>{this._plugin.getContext().getLocale().change(t),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=t,this._config=this._plugin.getConfig(),this._initialize(),this._toolbarController=new w_(this._plugin,null==(e=this._config.layout)?void 0:e.toolbarConfig),this._infoBarController=new g_(this._plugin),this._slideBarController=new __(this._plugin)}getUIConfig(){return{context:this._plugin.getContext(),config:this._config,changeLocale:this.changeLocale,getComponent:this.getComponent,methods:{toolbar:{getComponent:this._toolbarController.getComponent},infoBar:{getComponent:this._infoBarController.getComponent},slideBar:{getComponent:this._slideBarController.getComponent,addSlide:this._slideBarController.addSlide,activeSlide:this._slideBarController.activeSlide}}}}getContentRef(){return this._slideContainer.getContentRef()}getToolbarController(){return this._toolbarController}UIDidMount(t){var e;if(this._slideContainer)return t(this._slideContainer);null==(e=this._plugin.getObserver("onUIDidMount"))||e.add((()=>t(this._slideContainer)))}_initialize(){this._dragManager=new $c(this._plugin)}setSlideContainer(){this._dragManager.handleDragAction(_d(this._slideContainer))}}class N_{constructor(t){this.changeLocale=t=>{this._plugin.getGlobalContext().getLocale().change(t),this._plugin.getGlobalContext().getObserverManager().requiredObserver("onAfterChangeUILocaleObservable","core").notifyObservers()},this._plugin=t,this._slideContainerController=new R_(this._plugin);const e=this._slideContainerController.getUIConfig();d_.create({context:this._plugin.getGlobalContext(),locale:this._plugin.getGlobalContext().getLocale().getCurrentLocale(),changeLocale:this.changeLocale,UIConfig:e,container:this._plugin.getConfig().container})}getSlideContainerController(){return this._slideContainerController}}class y_ extends ko{constructor(t){super("SlideUI"),this._config=z.deepMerge({},Hg,t)}static create(t){return new y_(t)}installTo(t){t.install(this)}initialize(t){this.pushToObserve("onUIDidMount"),this.getLocale().load({en:bg,zh:Eg}),this._componentManager=new cu,this._registerManager=new du(this),this._appUIController=new N_(this),this.UIDidMount((()=>{this.initRender()}))}getConfig(){return this._config}initRender(){var t;const e=null==(t=this.getPluginByName(sn.BASE_RENDER))?void 0:t.getEngine();let n=_d(this._appUIController.getSlideContainerController().getContentRef());e.setContainer(n),this.getUniver().getCurrentUniverSlideInstance().context.getPluginManager().getRequirePluginByName(sn.SLIDE).getCanvasView().scrollToCenter(),window.addEventListener("resize",(()=>{e.resize()})),setTimeout((()=>{e.resize()}),0)}initUI(){}onMounted(t){this.initialize(t)}onDestroy(){}getAppUIController(){return this._appUIController}getComponentManager(){return this._componentManager}getRegisterManager(){return this._registerManager}UIDidMount(t){this._appUIController.getSlideContainerController().UIDidMount(t)}addToolButton(t){this._appUIController.getSlideContainerController().getToolbarController().addToolbarConfig(t)}deleteToolButton(t){this._appUIController.getSlideContainerController().getToolbarController().deleteToolbarConfig(t)}}const O_=new class{constructor(t={}){this._univerSheets=[],this._univerDocs=[],this._univerSlides=[],this._context=new Fo(t),this._context.onUniver(this)}addUniverSheet(t){t.context.onUniver(this),this._univerSheets.push(t)}addUniverDoc(t){t.context.onUniver(this),this._univerDocs.push(t)}addUniverSlide(t){t.context.onUniver(this),this._univerSlides.push(t)}getUniverSheetInstance(t){return this._univerSheets.find((e=>e.getUnitId()===t))}getUniverDocInstance(t){return this._univerDocs.find((e=>e.getUnitId()===t))}getUniverSlideInstance(t){return null}getAllUniverSheetsInstance(){return this._univerSheets}getAllUniverDocsInstance(){return this._univerDocs}getAllUniverSlidesInstance(){return this._univerSlides}getCurrentUniverSheetInstance(){return this._univerSheets[0]}getCurrentUniverDocInstance(){return this._univerDocs[0]}getCurrentUniverSlideInstance(){return this._univerSlides[0]}getGlobalContext(){return this._context}install(t){this._context.getPluginManager().install(t)}uninstall(t){this._context.getPluginManager().uninstall(t)}};O_.install(new rc);const D_=Yo.newInstance(zc);O_.addUniverSlide(D_),O_.install(new vg),D_.installPlugin(new Ic),O_.install(new y_({container:"universlide",layout:{slideContainerConfig:{innerLeft:!0}}}));
